<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298574-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298574</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11431303</doc-number>
<date>20060510</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>7</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>21</main-group>
<subgroup>02</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>58</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>5</main-group>
<subgroup>596</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>15</main-group>
<subgroup>12</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>360 75</main-classification>
<further-classification>360 7701</further-classification>
<further-classification>360 7804</further-classification>
</classification-national>
<invention-title id="d0e53">Servo writing a disk drive using correction values that attenuate phase error propagation</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5576906</doc-number>
<kind>A</kind>
<name>Fisher et al.</name>
<date>19961100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5668679</doc-number>
<kind>A</kind>
<name>Swearingen et al.</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5696639</doc-number>
<kind>A</kind>
<name>Spurbeck et al.</name>
<date>19971200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5754352</doc-number>
<kind>A</kind>
<name>Behrens et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5901003</doc-number>
<kind>A</kind>
<name>Chainer et al.</name>
<date>19990500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5991115</doc-number>
<kind>A</kind>
<name>Chainer et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6069499</doc-number>
<kind>A</kind>
<name>Cho et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6075668</doc-number>
<kind>A</kind>
<name>Chainer et al.</name>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6078450</doc-number>
<kind>A</kind>
<name>Chainer et al.</name>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6091564</doc-number>
<kind>A</kind>
<name>Codilian et al.</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6101055</doc-number>
<kind>A</kind>
<name>Chainer et al.</name>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6191906</doc-number>
<kind>B1</kind>
<name>Buch</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6249395</doc-number>
<kind>B1</kind>
<name>Conway</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6252732</doc-number>
<kind>B1</kind>
<name>Chainer et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6259574</doc-number>
<kind>B1</kind>
<name>Chainer et al.</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6292318</doc-number>
<kind>B1</kind>
<name>Hayashi</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>6304407</doc-number>
<kind>B1</kind>
<name>Baker et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>6307697</doc-number>
<kind>B1</kind>
<name>Chainer et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>6324027</doc-number>
<kind>B1</kind>
<name>Chainer et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>6366225</doc-number>
<kind>B1</kind>
<name>Ozdemir</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>6411453</doc-number>
<kind>B1</kind>
<name>Chainer et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>6429989</doc-number>
<kind>B1</kind>
<name>Schultz et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>6507450</doc-number>
<kind>B1</kind>
<name>Elliott</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>6519107</doc-number>
<kind>B1</kind>
<name>Ehrlich et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>6587293</doc-number>
<kind>B1</kind>
<name>Ding et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>6704156</doc-number>
<kind>B1</kind>
<name>Baker et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>6710951</doc-number>
<kind>B1</kind>
<name>Cloke</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 29</main-classification></classification-national>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>6735031</doc-number>
<kind>B2</kind>
<name>Chainer et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>6738205</doc-number>
<kind>B1</kind>
<name>Moran et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>6771443</doc-number>
<kind>B2</kind>
<name>Szita et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 51</main-classification></classification-national>
</citation>
<citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>6785075</doc-number>
<kind>B2</kind>
<name>Bryant et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>6898035</doc-number>
<kind>B1</kind>
<name>Chainer et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>6924960</doc-number>
<kind>B1</kind>
<name>Melkote et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>6943978</doc-number>
<kind>B1</kind>
<name>Lee</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>6987639</doc-number>
<kind>B1</kind>
<name>Yu</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>7199959</doc-number>
<kind>B1</kind>
<name>Bryant</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 51</main-classification></classification-national>
</citation>
<citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>2002/0101672</doc-number>
<kind>A1</kind>
<name>Chainer et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>2002/0145817</doc-number>
<kind>A1</kind>
<name>Szita et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>2003/0048562</doc-number>
<kind>A1</kind>
<name>Heydari et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>2005/0105200</doc-number>
<kind>A1</kind>
<name>Chainer et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00041">
<document-id>
<country>EP</country>
<doc-number>00199628</doc-number>
<kind>B1</kind>
<date>19890700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00042">
<document-id>
<country>EP</country>
<doc-number>00721184</doc-number>
<kind>B1</kind>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00043">
<othercit>U.S. Appl. No. 09/993,778 entitled “Servo Circuit Having a Synchronous Servo Channel and Method for Synchronously Recovering Servo Data”.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00044">
<othercit>U.S. Appl. No. 10/875,591 entitled “Servo Writing a Disk Drive by Writing Multi-Bit Sync Marks in Spiral Tracks for Improved Servo Writing”.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00045">
<othercit>U.S. Appl. No. 10/911,039 entitled “Servo Writing a Disk Drive by Synchronizing a Servo Write Clock to a Reference Pattern on the Disk and Compensating for Repeatable Phase Error”.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>12</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Melkote</last-name>
<first-name>Hemant</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>McNab</last-name>
<first-name>Robert J.</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Sheerin, Esq.</last-name>
<first-name>Howard H.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Western Digital Technologies, Inc.</orgname>
<role>02</role>
<address>
<city>Lake Forest</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Korzuch</last-name>
<first-name>William</first-name>
<department>2627</department>
</primary-examiner>
<assistant-examiner>
<last-name>Olson</last-name>
<first-name>Jason</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Servo writing a disk of a disk drive is disclosed. A phase locked loop (PLL) is synchronized to first sectors previously written on a first track, and second sectors are written to a second track using the PLL, wherein a plurality of phase errors corresponding to the second sectors are saved. A correction value is computed corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector. The PLL is synchronized to the second sectors using the correction value, a third sector is written to a third track using the PLL, and a phase error is saved corresponding to the third sector.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="162.31mm" wi="256.29mm" file="US07298574-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="211.41mm" wi="154.94mm" file="US07298574-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="274.40mm" wi="179.58mm" orientation="landscape" file="US07298574-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="255.61mm" wi="165.95mm" orientation="landscape" file="US07298574-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="188.38mm" wi="88.98mm" orientation="landscape" file="US07298574-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to disk drives. More particularly, the present invention relates to servo writing a disk drive using correction values that compensate for phase errors.</p>
<p id="p-0004" num="0003">2. Description of the Prior Art</p>
<p id="p-0005" num="0004">Disk drives for computer systems comprise a disk for storing data and a head actuated radially over the disk for writing data to and reading data from the disk. To effectuate the radial positioning of the head over the disk, the head is connected to the distal end of an actuator arm which is rotated about a pivot by a rotary actuator (e.g., a voice coil motor (VCM)). The disk is typically divided into a number of concentric, radially spaced tracks, where each track is divided into a number of data sectors. The disk is typically accessed a data sector at a time by positioning the head over the track which comprises the target data sector. As the disk spins, the head writes transitions (e.g., magnetic transitions) in the data sector to record data, and during read operations senses the transitions to recover the recorded data.</p>
<p id="p-0006" num="0005">Accurate reproduction of the recorded data requires the head to be positioned very close to the centerline of the target data sector during both write and read operations. Thus, accessing a target data sector involves positioning or “seeking” the head to the target track, and then maintaining centerline “tracking” while data is written to or read from the disk. A closed loop servo system typically performs the seeking and tracking operations by controlling the rotary actuator in response to position information generated from the head.</p>
<p id="p-0007" num="0006">A well known technique for generating the head position control information is to record servo information in servo sectors disbursed circumferentially about the disk, “embedded” with the data sectors. This is illustrated in <figref idref="DRAWINGS">FIG. 1</figref> which shows a disk <b>2</b> comprising a number of concentric tracks <b>4</b> and a number of embedded servo sectors <b>6</b><sub>0</sub>-<b>6</b><sub>N</sub>. Each servo sector <b>61</b> comprises a preamble <b>8</b>, a sync mark <b>10</b>, servo data <b>12</b>, and servo bursts <b>14</b>. The preamble <b>8</b> comprises a periodic pattern which allows proper gain adjustment and timing synchronization of the read signal, and the sync mark <b>10</b> comprises a special pattern for symbol synchronizing to the servo data <b>12</b>. The servo data <b>12</b> comprises identification information, such as sector identification data and a track address. The servo control system reads the track address during seeks to derive a coarse position for the head with respect to the target track. The track addresses are recorded using a phase coherent Gray code so that the track addresses can be accurately detected when the head is flying between tracks. The servo bursts <b>14</b> in the servo sectors <b>6</b> comprise groups of consecutive transitions (e.g., A, B, C and D bursts) which are recorded at precise intervals and offsets with respect to the track centerline. Fine head position control information is derived from the servo bursts <b>14</b> for use in centerline tracking while writing data to and reading data from the target track.</p>
<p id="p-0008" num="0007">The embedded servo sectors <b>6</b> are written to the disk <b>2</b> as part of the manufacturing process. Conventionally, an external servo writer has been employed which writes the embedded servo sectors <b>6</b> to the disks by processing each head disk assembly (HDA) in an assembly line fashion. The external servo writers employ very precise head positioning mechanics, such as a laser interferometer, for positioning the head at precise radial locations with respect to previously servo-written tracks so as to achieve very high track densities. A clock track is written at the outer diameter of the disk, and a clock head inserted into the HDA to read the clock track in order to synchronize a phase locked loop (PLL) used to write the servo sectors at the appropriate circumferential location (so that the servo sectors are aligned radially across the disk as in <figref idref="DRAWINGS">FIG. 1</figref>). However, external servo writers are expensive and present a significant bottle neck to the manufacturing process. In addition, inserting a clock head into the HDA requires the servo writing process take place in a clean room environment to prevent particulate contamination.</p>
<p id="p-0009" num="0008">Certain “self-servo writing” techniques have been disclosed wherein components internal to the disk drive are employed to perform the servo writing process which avoids the drawbacks of external servo writers including the need for a clean room since self servo writing occurs within the sealed HDA. One technique for self servo writing propagates sectors (servo sectors and optional timing sectors) from a reference track (e.g., written at the outer diameter) across the disk radius (e.g., toward the inner diameter). While servoing on the reference track, a PLL is synchronized to the sectors written on the reference track which is used to propagate the sectors to an adjacent track. The read element of the head is then placed over the adjacent track and the write element over the next track, the PLL synchronized to the sectors previously written on the adjacent track, and the sectors propagated to the next track. This process is repeated until the sectors are propagated across the entire disk surface. A problem with this propagation technique is that certain components of the phase error (e.g., spindle harmonics, suspension vibration, sensor noise, etc.) are amplified due to the peaking nature of the PLL transfer function. These components of the phase error will propagate from track-to-track and grow unboundedly resulting in “wandering” servo sectors across the disk surface (not radially aligned as in <figref idref="DRAWINGS">FIG. 1</figref>).</p>
<p id="p-0010" num="0009">There is, therefore, a need to attenuate phase error propagation when self servo writing a disk drive by propagating sectors.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">An embodiment of the present invention comprises a method of servo writing a disk of a disk drive, wherein the disk drive comprises the disk and a head actuated over the disk, and the head comprises a read element and a write element. The read element is positioned over a first track on the disk and the write element is positioned over a second track on the disk. A phase locked loop (PLL) is synchronized to first sectors previously written on the first track, and second sectors are written to the second track using the PLL, wherein a plurality of phase errors corresponding to the second sectors are saved. A correction value is computed corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector. The read element is positioned over the second track on the disk and the write element over a third track on the disk, the PLL is synchronized to the second sectors using the correction value, a third sector is written to the third track using the PLL, and a phase error is saved corresponding to the third sector.</p>
<p id="p-0012" num="0011">In one embodiment, the correction value is at least partially computed according to:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α□e(t+m)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where α is a constant and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors. In one embodiment, the correction value is at least partially computed according to:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α<sub>0</sub>□e(t)+α<sub>1</sub>□e(t+1)+ . . . α<sub>N</sub>□e(t+N)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where α-α<sub>N </sub>are a plurality of constants selected to stabilize the PLL while attenuating phase error propagation from track-to-track.
</p>
<p id="p-0013" num="0012">Another embodiment of the present invention comprises a disk drive including a disk and a head actuated over the disk, wherein the head comprises a read element and a write element. The read element is positioned over a first track on the disk and the write element is positioned over a second track on the disk. A phase locked loop (PLL) is synchronized to first sectors previously written on the first track, and second sectors are written to the second track using the PLL, wherein a plurality of phase errors corresponding to the second sectors are saved. A correction value is computed corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector. The read element is positioned over the second track on the disk and the write element over a third track on the disk, the PLL is synchronized to the second sectors using the correction value, a third sector is written to the third track using the PLL, and a phase error is saved corresponding to the third sector.</p>
<p id="p-0014" num="0013">Another embodiment of the present invention comprises control circuitry for servo writing a disk drive, the disk drive including a disk and a head actuated over the disk, wherein the head comprises a read element and a write element. The read element is positioned over a first track on the disk and the write element is positioned over a second track on the disk. A phase locked loop (PLL) is synchronized to first sectors previously written on the first track, and second sectors are written to the second track using the PLL, wherein a plurality of phase errors corresponding to the second sectors are saved. A correction value is computed corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector. The read element is positioned over the second track on the disk and the write element over a third track on the disk, the PLL is synchronized to the second sectors using the correction value, a third sector is written to the third track using the PLL, and a phase error is saved corresponding to the third sector.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> shows a prior art disk format comprising a plurality of radially spaced, concentric servo tracks defined by a plurality of embedded servo sectors.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2A</figref> shows a disk drive according to an embodiment of the present invention comprising control circuitry for servo writing the disk.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2B</figref> is a flow diagram executed by the control circuitry to servo write the disk using correction values computed from phase errors generated for leading sectors.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3A</figref> illustrates the propagation of sectors during the servo writing process.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3B</figref> shows elements of a phase locked loop (PLL) used to propagate the sectors using correction values that compensate for written-in phase errors of previously written servo tracks.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 4</figref> shows an equivalent block diagram for the PLL of <figref idref="DRAWINGS">FIG. 3B</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2A</figref> shows a disk drive according to an embodiment of the present invention including a disk <b>16</b> and a head <b>18</b> actuated over the disk <b>16</b>, wherein the head <b>18</b> comprises a read element <b>20</b>A and a write element <b>20</b>B (<figref idref="DRAWINGS">FIG. 3A</figref>). The disk drive further comprises control circuitry <b>22</b> for executing the flow diagram of <figref idref="DRAWINGS">FIG. 2B</figref> in order to write a plurality of servo sectors <b>24</b><sub>0</sub>-<b>24</b><sub>N </sub>to define a plurality of tracks <b>26</b>. The read element <b>20</b>A is positioned over a first track on the disk <b>16</b> and the write element <b>20</b>B is positioned over a second track on the disk <b>16</b>. At step <b>28</b> a phase locked loop (PLL) is synchronized to first sectors previously written on the first track, and at step <b>30</b> second sectors are written to the second track using the PLL, wherein a plurality of phase errors corresponding to the second sectors are saved. At step <b>32</b> a track index k is initialized to two. At step <b>34</b> a correction value is computed corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector. At step <b>36</b>, the read element <b>20</b>A is positioned over the second track on the disk and the write element over a third track on the disk, and the PLL is synchronized to the second sectors using the correction value. At step <b>38</b> a third sector is written to the third track using the PLL, and a phase error is saved corresponding to the third sector. At step <b>40</b> the track index k is incremented and steps <b>34</b>-<b>40</b> are re-executed until the entire disk <b>16</b> has been servo written.</p>
<p id="p-0022" num="0021">In the embodiment of <figref idref="DRAWINGS">FIG. 2A</figref>, the head <b>18</b> is connected to the distal end of an actuator arm <b>42</b> which is rotated about a pivot by a voice coil motor (VCM) <b>44</b> in order to actuate the head <b>18</b> radially over the disk <b>16</b>. The control circuitry <b>22</b> processes the read signal <b>46</b> emanating from the head <b>18</b> to demodulate the position information recorded in the propagated sectors during the self servo writing operation (as well as the product servo sectors <b>24</b><sub>0</sub>-<b>24</b><sub>N </sub>during normal operation). The control circuitry <b>22</b> generates a control signal <b>48</b> applied to the VCM <b>44</b> in response to the position information in order to maintain the head <b>18</b> over a target radial location.</p>
<p id="p-0023" num="0022">Any suitable control circuitry <b>22</b> may be employed to implement the embodiments of the present invention. In one embodiment, the control circuitry <b>22</b> comprises a microprocessor executing instructions, the instructions being operable to cause the microprocessor to perform the steps of <figref idref="DRAWINGS">FIG. 2B</figref> as well as other functions described herein. The instructions may be stored in any computer-readable medium. In one embodiment, they may be stored on a non-volatile semiconductor memory external to the microprocessor, or integrated with the microprocessor in a system on a chip (SOC). In another embodiment, the instructions are stored on the disk <b>16</b> and read into a volatile semiconductor memory when the disk drive is powered on. In yet another embodiment, the control circuitry <b>22</b> comprises suitable logic circuitry, such as state machine circuitry.</p>
<p id="p-0024" num="0023">In one embodiment, the initial track (track <b>1</b>) is written to the disk using an external servo writer or media writer. As illustrated in <figref idref="DRAWINGS">FIG. 3A</figref>, the initial track (track <b>1</b>) comprises an initial plurality of sectors <b>50</b>, wherein each sector <b>50</b> may comprise any suitable format. In one embodiment, each sector <b>50</b> comprises the same fields as a conventional servo sector <b>6</b> shown in <figref idref="DRAWINGS">FIG. 1</figref>, including a preamble <b>8</b> used to synchronize the PLL as well as servo bursts <b>14</b> for generating radial position information. In one embodiment, the propagated sectors <b>50</b> become the product servo sectors <b>24</b> (<figref idref="DRAWINGS">FIG. 2A</figref>) at the completion of the servo writing operation. In an alternative embodiment, an integer multiple of sectors <b>50</b> (e.g., twice as many product servo sectors <b>24</b>) are propagated during the servo writing operation, wherein the extra sectors <b>50</b> are erased (or ignored) once the servo writing operation is complete. The extra sectors <b>50</b> provide additional timing and radial position information during the servo writing operation. In an alternative embodiment, at least one of the sectors <b>50</b> comprises only timing information for synchronizing the PLL.</p>
<p id="p-0025" num="0024">While propagating the sectors <b>50</b>, the read element <b>20</b>A is positioned over a previously written servo track in order to read the previously written sectors <b>50</b> for servoing the head <b>18</b> as well as synchronize the PLL. In the example of <figref idref="DRAWINGS">FIG. 3A</figref>, the read element <b>20</b>A is positioned over track <b>2</b> while propagating the sectors <b>50</b> to track <b>3</b>. As described in more detail below, when writing sector t to track <b>3</b>, the PLL is synchronized using a correction value that compensates for phase errors written into track <b>2</b>. The correction value is computed in response to a plurality of the phase errors generated while writing the sectors <b>50</b> to track <b>2</b>, including a plurality of the sectors <b>50</b> leading sector t (e.g., t+1, t+2,. etc.).</p>
<p id="p-0026" num="0025">The PLL for servo writing the disk may comprise any suitable circuitry, and may be implemented in hardware or software, or a combination thereof. <figref idref="DRAWINGS">FIG. 3B</figref> shows an embodiment of the PLL including the disturbances due to spindle jitter <b>52</b>, suspension vibration <b>54</b>, and sensor noise <b>56</b>. The PLL of <figref idref="DRAWINGS">FIG. 3B</figref> comprises a voltage controlled oscillator (VCO) <b>58</b> for generating a write clock <b>60</b> used to propagate the sectors <b>50</b> across the disk during the servo writing operation. The spindle jitter <b>52</b> adds phase error to the write clock <b>60</b> while writing the sectors Φ<sub>k+1 </sub>to the next track. The phase reference <b>62</b> for the PLL is generated by reading the sectors Φ<sub>k </sub>from the previously written track. The process of reading the previously written sectors results in sensor noise <b>56</b> which is added to the phase reference <b>62</b>. A difference between the resulting phase reference and output signal <b>64</b> of the PLL generates a phase error <b>66</b> which is adjusted by the correction value <b>68</b> to generate an adjusted phase error e<sub>k </sub><b>70</b>. The adjusted phase error e<sub>k </sub><b>70</b> is filtered by a compensator <b>72</b> to generate a VCO control signal <b>74</b>. The noise generated by the suspension vibration <b>54</b> is represented as a disturbance added to the VCO control signal <b>74</b> resulting in the actual control signal <b>76</b> applied to the VCO <b>58</b>.</p>
<p id="p-0027" num="0026">Denoting the transfer function of the VCO <b>58</b> as P and the transfer function of the compensator <b>72</b> as C, the sensitivity transfer function S is represented as:</p>
<p id="p-0028" num="0027">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mi>S</mi>
  <mo>=</mo>
  <mfrac>
    <mn>1</mn>
    <mrow>
      <mn>1</mn>
      <mo>+</mo>
      <mi>PC</mi>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
The self-servo writing system can be represented equivalently as shown in <figref idref="DRAWINGS">FIG. 4</figref>, where the transfer function from Φ<sub>k </sub>and u<sub>k </sub>to the next written track Φ<sub>k+1 </sub>is the closed loop transfer function (1−S), while the transfer function to the phase error e<sub>k </sub>is the sensitivity function S. The state space for sensitivity function S can be modeled as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sub>k</sub>(<i>t+</i>1)=<i>Ax</i><sub>k</sub>(<i>t</i>)+<i>B{u</i><sub>k</sub>(<i>t</i>)+Φ<sub>k</sub>(<i>t</i>)}<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i><sub>k</sub>(<i>t</i>)=<i>Cx</i><sub>k</sub>(<i>t</i>)+<i>D{U</i><sub>k</sub>(<i>t</i>)+Φ<sub>k</sub>(<i>t</i>)}  (1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
If the next track Φk+<b>1</b> is written on the first revolution while servoing on track Φ<sub>k</sub>, then following the iterative learning control (ILC) method, this system may be represented over one revolution of the disk. Defining:
</p>
<p id="p-0029" num="0028">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <msub>
                  <mi>Φ</mi>
                  <mi>k</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mo>⌊</mo>
                  <mtable>
                    <mtr>
                      <mtd>
                        <mtable>
                          <mtr>
                            <mtd>
                              <mtable>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>Φ</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mn>0</mn>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>Φ</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mn>1</mn>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mtd>
                          </mtr>
                          <mtr>
                            <mtd>
                              <mi>M</mi>
                            </mtd>
                          </mtr>
                        </mtable>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>Φ</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mi>N</mi>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                  <mo>⌋</mo>
                </mrow>
              </mrow>
              <mo>;</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mrow>
                <msub>
                  <mi>e</mi>
                  <mi>k</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mo>⌊</mo>
                  <mtable>
                    <mtr>
                      <mtd>
                        <mtable>
                          <mtr>
                            <mtd>
                              <mtable>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>e</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mn>0</mn>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>e</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mn>1</mn>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mtd>
                          </mtr>
                          <mtr>
                            <mtd>
                              <mi>M</mi>
                            </mtd>
                          </mtr>
                        </mtable>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>e</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mi>N</mi>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                  <mo>⌋</mo>
                </mrow>
              </mrow>
              <mo>;</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msub>
                <mi>u</mi>
                <mi>k</mi>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>⌊</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <mtable>
                        <mtr>
                          <mtd>
                            <mtable>
                              <mtr>
                                <mtd>
                                  <mrow>
                                    <msub>
                                      <mi>u</mi>
                                      <mi>k</mi>
                                    </msub>
                                    <mo>⁡</mo>
                                    <mrow>
                                      <mo>(</mo>
                                      <mn>0</mn>
                                      <mo>)</mo>
                                    </mrow>
                                  </mrow>
                                </mtd>
                              </mtr>
                              <mtr>
                                <mtd>
                                  <mrow>
                                    <msub>
                                      <mi>u</mi>
                                      <mi>k</mi>
                                    </msub>
                                    <mo>⁡</mo>
                                    <mrow>
                                      <mo>(</mo>
                                      <mn>1</mn>
                                      <mo>)</mo>
                                    </mrow>
                                  </mrow>
                                </mtd>
                              </mtr>
                            </mtable>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mi>M</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <msub>
                          <mi>u</mi>
                          <mi>k</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>N</mi>
                            <mo>-</mo>
                            <mn>1</mn>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>⌋</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where N is the number of sectors in track k. The result is:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i><sub>k</sub><i>=H</i><sub>S</sub>(Φ<sub>k</sub><i>+u</i><sub>k</sub>)+Γ<sub>s</sub><i>x</i><sub>k</sub>(0)  (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where:
</p>
<p id="p-0030" num="0029">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>H</mi>
            <mi>s</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mi>D</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>K</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>CB</mi>
                </mtd>
                <mtd>
                  <mi>D</mi>
                </mtd>
                <mtd>
                  <mi>O</mi>
                </mtd>
                <mtd>
                  <mi>M</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>M</mi>
                </mtd>
                <mtd>
                  <mi>O</mi>
                </mtd>
                <mtd>
                  <mi>O</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msup>
                    <mi>CA</mi>
                    <mrow>
                      <mi>N</mi>
                      <mo>-</mo>
                      <mn>2</mn>
                    </mrow>
                  </msup>
                </mtd>
                <mtd>
                  <mi>L</mi>
                </mtd>
                <mtd>
                  <mi>CB</mi>
                </mtd>
                <mtd>
                  <mi>D</mi>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
        <mo>;</mo>
        <mrow>
          <msub>
            <mi>Γ</mi>
            <mi>s</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mi>C</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>CA</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>M</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msup>
                    <mi>CA</mi>
                    <mrow>
                      <mi>N</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
From <figref idref="DRAWINGS">FIG. 4</figref>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Φ<sub>k+1</sub><i>=−e</i><sub>k</sub>+Φ<sub>k</sub><i>+u</i><sub>k</sub>  (5)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0031" num="0030">Substituting equation (3) into equation (5):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Φ<sub>k+1</sub>=(<i>I−H</i><sub>s</sub>)Φ<sub>k</sub>+(<i>I−H</i><sub>s</sub>)<i>u</i><sub>k</sub>−Γ<sub>s</sub><i>x</i><sub>k</sub>(0)  (6)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0032" num="0031">Choosing the correction signal u<sub>k </sub>as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>k</sub><i>=Ke</i><sub>k−1</sub>  (7)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
or equivalently:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>k+1</sub><i>=Ke</i><sub>k</sub>  (8)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Substituting for e<sub>k</sub>:
</p>
<p id="p-0033" num="0032">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mo> </mo>
  <mtable>
    <mtr>
      <mtd>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <msub>
                  <mi>u</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mi/>
                <mo>⁢</mo>
                <mrow>
                  <mi>K</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>{</mo>
                    <mrow>
                      <mrow>
                        <msub>
                          <mi>H</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <msub>
                              <mi>Φ</mi>
                              <mi>k</mi>
                            </msub>
                            <mo>+</mo>
                            <msub>
                              <mi>u</mi>
                              <mi>k</mi>
                            </msub>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>+</mo>
                      <mrow>
                        <msub>
                          <mi>Γ</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mrow>
                          <msub>
                            <mi>x</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mn>0</mn>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>}</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mrow>
                <mo>=</mo>
                <mi/>
                <mo>⁢</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>KH</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msub>
                      <mi>KH</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <msub>
                      <mi>KT</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mn>0</mn>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mtd>
      <mtd>
        <mrow>
          <mo>(</mo>
          <mn>9</mn>
          <mo>)</mo>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
</mrow>
</math>
</maths>
<br/>
Combining equation (6) and equation (8) the dynamics of the system can be represented as:
</p>
<p id="p-0034" num="0033">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>⌊</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>Φ</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>u</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>⌋</mo>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mrow>
              <mo>⌊</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <mi>I</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>H</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <mi>I</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>H</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>KH</mi>
                      <mi>s</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>KH</mi>
                      <mi>s</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>⌋</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>⌊</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>⌋</mo>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>Γ</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mn>0</mn>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <mi>K</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mn>0</mn>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>10</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
To ensure stability while preventing phase error propagation the matrix K is chosen such that the matrix
</p>
<p id="p-0035" num="0034">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>⌊</mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <mi>I</mi>
                <mo>-</mo>
                <msub>
                  <mi>H</mi>
                  <mi>s</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <mrow>
                <mi>I</mi>
                <mo>-</mo>
                <msub>
                  <mi>H</mi>
                  <mi>s</mi>
                </msub>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>KH</mi>
                <mi>s</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>KH</mi>
                <mi>s</mi>
              </msub>
            </mtd>
          </mtr>
        </mtable>
        <mo>⌋</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
is stable.
</p>
<p id="p-0036" num="0035">After seeking from the current track to the next track, it may be necessary to wait for one or more revolutions before commencing the servo track writing to allow the transients to decay. If so, the above equations need to be modified appropriately. For example, if the servo writing commences on the second revolution of the disk, then redefining equation (2) as:</p>
<p id="p-0037" num="0036">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <msub>
                  <mi>Φ</mi>
                  <mi>k</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mo>⌊</mo>
                  <mtable>
                    <mtr>
                      <mtd>
                        <mtable>
                          <mtr>
                            <mtd>
                              <mtable>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>Φ</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mi>N</mi>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>Φ</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mrow>
                                          <mi>N</mi>
                                          <mo>+</mo>
                                          <mn>1</mn>
                                        </mrow>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mtd>
                          </mtr>
                          <mtr>
                            <mtd>
                              <mi>M</mi>
                            </mtd>
                          </mtr>
                        </mtable>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>Φ</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mrow>
                                <mn>2</mn>
                                <mo>⁢</mo>
                                <mi>N</mi>
                              </mrow>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                  <mo>⌋</mo>
                </mrow>
              </mrow>
              <mo>;</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mrow>
                <msub>
                  <mi>e</mi>
                  <mi>k</mi>
                </msub>
                <mo>=</mo>
                <mrow>
                  <mo>⌊</mo>
                  <mtable>
                    <mtr>
                      <mtd>
                        <mtable>
                          <mtr>
                            <mtd>
                              <mtable>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>e</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mi>N</mi>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                                <mtr>
                                  <mtd>
                                    <mrow>
                                      <msub>
                                        <mi>e</mi>
                                        <mi>k</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mrow>
                                          <mi>N</mi>
                                          <mo>+</mo>
                                          <mn>1</mn>
                                        </mrow>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mtd>
                                </mtr>
                              </mtable>
                            </mtd>
                          </mtr>
                          <mtr>
                            <mtd>
                              <mi>M</mi>
                            </mtd>
                          </mtr>
                        </mtable>
                      </mtd>
                    </mtr>
                    <mtr>
                      <mtd>
                        <mrow>
                          <msub>
                            <mi>e</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mrow>
                                <mn>2</mn>
                                <mo>⁢</mo>
                                <mi>N</mi>
                              </mrow>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mtd>
                    </mtr>
                  </mtable>
                  <mo>⌋</mo>
                </mrow>
              </mrow>
              <mo>;</mo>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <msub>
                <mi>u</mi>
                <mi>k</mi>
              </msub>
              <mo>=</mo>
              <mrow>
                <mo>⌊</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <mtable>
                        <mtr>
                          <mtd>
                            <mtable>
                              <mtr>
                                <mtd>
                                  <mrow>
                                    <msub>
                                      <mi>u</mi>
                                      <mi>k</mi>
                                    </msub>
                                    <mo>⁡</mo>
                                    <mrow>
                                      <mo>(</mo>
                                      <mi>N</mi>
                                      <mo>)</mo>
                                    </mrow>
                                  </mrow>
                                </mtd>
                              </mtr>
                              <mtr>
                                <mtd>
                                  <mrow>
                                    <msub>
                                      <mi>u</mi>
                                      <mi>k</mi>
                                    </msub>
                                    <mo>⁡</mo>
                                    <mrow>
                                      <mo>(</mo>
                                      <mrow>
                                        <mi>N</mi>
                                        <mo>+</mo>
                                        <mn>1</mn>
                                      </mrow>
                                      <mo>)</mo>
                                    </mrow>
                                  </mrow>
                                </mtd>
                              </mtr>
                            </mtable>
                          </mtd>
                        </mtr>
                        <mtr>
                          <mtd>
                            <mi>M</mi>
                          </mtd>
                        </mtr>
                      </mtable>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <msub>
                          <mi>u</mi>
                          <mi>k</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mrow>
                              <mn>2</mn>
                              <mo>⁢</mo>
                              <mi>N</mi>
                            </mrow>
                            <mo>-</mo>
                            <mn>1</mn>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>⌋</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
the dynamic model is represented as:
</p>
<p id="p-0038" num="0037">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>⌊</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>Φ</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>u</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>⌋</mo>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mrow>
              <mo>⌊</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <mi>I</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>H</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <mi>I</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>H</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>KH</mi>
                      <mi>s</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>KH</mi>
                      <mi>s</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>⌋</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>⌊</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>⌋</mo>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>Γ</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>N</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <mi>K</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>N</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>13</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where x<sub>k</sub>(N) is the state vector of the sensitivity function on the Nth sample. However, since Φ<sub>k </sub>and u<sub>k </sub>are both repetitive signals, the values of y<sub>k </sub>and u<sub>k </sub>in equation (2) are the same as in equation (12) which means:
</p>
<p id="p-0039" num="0038">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mn>0</mn>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mn>1</mn>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>M</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>N</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>N</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>N</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>M</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mrow>
                          <mn>2</mn>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <mi>N</mi>
                        </mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
        <mo>;</mo>
        <mrow>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mn>0</mn>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mn>1</mn>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>M</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>N</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>N</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>N</mi>
                        <mo>+</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>M</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mrow>
                          <mn>2</mn>
                          <mo>⁢</mo>
                          <mi>N</mi>
                        </mrow>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>14</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
However, the phase error e<sub>k </sub>defined by equation (12) is not the same as in equation (2). The value of the state of the sensitivity function S on the Nth sample of track following is related to the initial condition by:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sub>k</sub>(<i>N</i>)=<i>A</i><sup>N</sup><i>x</i><sub>k</sub>(0)+λ(Φ<sub>k</sub><i>+u</i><sub>k</sub>)  (15)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>λ=<i>[B AB L A</i><sup>N−1</sup><i>B]</i>  (16)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Substituting equation (15) into equation (13), the modified dynamics are:
</p>
<p id="p-0040" num="0039">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>⌊</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>Φ</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>u</mi>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>⌋</mo>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mrow>
              <mo>⌊</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <mi>I</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>H</mi>
                        <mi>s</mi>
                      </msub>
                      <mo>-</mo>
                      <mrow>
                        <msub>
                          <mi>Γ</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mi>λ</mi>
                      </mrow>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <mi>I</mi>
                      <mo>-</mo>
                      <msub>
                        <mi>H</mi>
                        <mi>s</mi>
                      </msub>
                      <mo>-</mo>
                      <mrow>
                        <msub>
                          <mi>Γ</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mi>λ</mi>
                      </mrow>
                    </mrow>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>KH</mi>
                        <mi>s</mi>
                      </msub>
                      <mo>+</mo>
                      <mrow>
                        <mi>K</mi>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>⁢</mo>
                        <msub>
                          <mi>Γ</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mi>λ</mi>
                      </mrow>
                    </mrow>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>KH</mi>
                        <mi>s</mi>
                      </msub>
                      <mo>+</mo>
                      <mrow>
                        <mi>K</mi>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>⁢</mo>
                        <msub>
                          <mi>Γ</mi>
                          <mi>s</mi>
                        </msub>
                        <mo>⁢</mo>
                        <mi>λ</mi>
                      </mrow>
                    </mrow>
                  </mtd>
                </mtr>
              </mtable>
              <mo>⌋</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>⌊</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>Φ</mi>
                      <mi>k</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>u</mi>
                      <mi>k</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>⌋</mo>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mo>⌊</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>Γ</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mn>0</mn>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mrow>
                    <mi>K</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mrow>
                      <msub>
                        <mi>x</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mn>0</mn>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>⌋</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>17</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
In this case, to prevent phase error propagation the matrix K should be selected such that the matrix
</p>
<p id="p-0041" num="0040">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mover>
          <mi>A</mi>
          <mi>_</mi>
        </mover>
        <mo>=</mo>
        <mrow>
          <mo>⌊</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mi>I</mi>
                  <mo>-</mo>
                  <msub>
                    <mi>H</mi>
                    <mi>s</mi>
                  </msub>
                  <mo>-</mo>
                  <mrow>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mi>λ</mi>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi>I</mi>
                  <mo>-</mo>
                  <msub>
                    <mi>H</mi>
                    <mi>s</mi>
                  </msub>
                  <mo>-</mo>
                  <mrow>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mi>λ</mi>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>KH</mi>
                    <mi>s</mi>
                  </msub>
                  <mo>+</mo>
                  <mrow>
                    <mi>K</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mi>λ</mi>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <msub>
                    <mi>KH</mi>
                    <mi>s</mi>
                  </msub>
                  <mo>+</mo>
                  <mrow>
                    <mi>K</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Γ</mi>
                      <mi>s</mi>
                    </msub>
                    <mo>⁢</mo>
                    <mi>λ</mi>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
          <mo>⌋</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>18</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
is stable. For a typical PLL, the following Toeplitz matrix stabilizes the matrix Ā
</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>K</mi>
        <mo>=</mo>
        <mrow>
          <mo>⌊</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>2</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>3</mn>
                </msub>
              </mtd>
              <mtd>
                <mi>L</mi>
              </mtd>
              <mtd>
                <mn>0</mn>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>2</mn>
                </msub>
              </mtd>
              <mtd>
                <mi>O</mi>
              </mtd>
              <mtd>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
              <mtd>
                <mi>O</mi>
              </mtd>
              <mtd>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
              <mtd>
                <mi>O</mi>
              </mtd>
              <mtd>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>M</mi>
              </mtd>
              <mtd>
                <mi>M</mi>
              </mtd>
              <mtd>
                <mi>O</mi>
              </mtd>
              <mtd>
                <mi>O</mi>
              </mtd>
              <mtd>
                <mi>O</mi>
              </mtd>
              <mtd>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>2</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>3</mn>
                </msub>
              </mtd>
              <mtd>
                <mi>L</mi>
              </mtd>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <msub>
                  <mi>α</mi>
                  <mn>0</mn>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>⌋</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>19</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
The matrix K of equation (19) corresponds to the following correction values:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i><sub>k+1</sub>(<i>t</i>)=α<sub>0</sub><i>e</i><sub>k</sub>(<i>t</i>)+α<sub>1</sub><i>e</i><sub>k</sub>(<i>t+</i>1)+α<sub>2</sub><i>e</i><sub>k</sub>(<i>t+</i><sup>2</sup>)+α<sub>3</sub><i>e</i><sub>k</sub>(<i>t+</i><sup>3</sup>)  (20)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0043" num="0042">The above equation means that the correction value for a sector t on track k+1 is generated in response to a plurality of the phase errors e<sub>k </sub>generated for a plurality of the sectors <b>50</b> leading the sector t on the previously servo written track k (see the above description of <figref idref="DRAWINGS">FIG. 3A</figref>). That is, the above equation is non-causal as compared to a conventional compensation filter determined using frequency domain analysis.</p>
<p id="p-0044" num="0043">In one embodiment, the sectors <b>50</b> are propagated in an interleaved manner. For example, referring again to <figref idref="DRAWINGS">FIG. 3A</figref> the even numbered sectors <b>50</b> may be read while writing the odd numbered sectors <b>50</b> during a first revolution of the disk, and then the odd numbered sectors <b>50</b> may be read while writing the even numbered sectors <b>50</b> during a second revolution of the disk. In this embodiment, the sectors in the above equations represent consecutive even numbered sectors or consecutive odd numbered sectors.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298574-20071120-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US07298574-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298574-20071120-M00002.NB">
<img id="EMI-M00002" he="15.16mm" wi="76.20mm" file="US07298574-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298574-20071120-M00003.NB">
<img id="EMI-M00003" he="15.92mm" wi="76.20mm" file="US07298574-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298574-20071120-M00004.NB">
<img id="EMI-M00004" he="7.45mm" wi="76.20mm" file="US07298574-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298574-20071120-M00005.NB">
<img id="EMI-M00005" he="7.45mm" wi="76.20mm" file="US07298574-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298574-20071120-M00006.NB">
<img id="EMI-M00006" he="7.45mm" wi="76.20mm" file="US07298574-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298574-20071120-M00007.NB">
<img id="EMI-M00007" he="15.16mm" wi="76.20mm" file="US07298574-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298574-20071120-M00008.NB">
<img id="EMI-M00008" he="7.45mm" wi="76.20mm" file="US07298574-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298574-20071120-M00009.NB">
<img id="EMI-M00009" he="15.16mm" wi="76.20mm" file="US07298574-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07298574-20071120-M00010.NB">
<img id="EMI-M00010" he="7.45mm" wi="76.20mm" file="US07298574-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07298574-20071120-M00011.NB">
<img id="EMI-M00011" he="7.45mm" wi="76.20mm" file="US07298574-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07298574-20071120-M00012.NB">
<img id="EMI-M00012" he="22.94mm" wi="76.20mm" file="US07298574-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of servo writing a disk of a disk drive, the disk drive comprising the disk and a head actuated over the disk, the head comprising a read element and a write element, the method comprising:
<claim-text>positioning the read element over a first track on the disk and the write element over a second track on the disk;</claim-text>
<claim-text>synchronizing a phase locked loop (PLL) to first sectors previously written on the first track;</claim-text>
<claim-text>writing second sectors to the second track using the PLL, and saving a plurality of phase errors corresponding to the second sectors;</claim-text>
<claim-text>computing a correction value corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector;</claim-text>
<claim-text>positioning the read element over the second track on the disk and the write element over a third track on the disk;</claim-text>
<claim-text>synchronizing the PLL to the second sectors using the correction value; and</claim-text>
<claim-text>writing a third sector to the third track using the PLL, and saving a phase error corresponding to the third sector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the correction value is at least partially computed according to:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α□e(t+m)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where α is a constant and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the correction value is at least partially computed according to:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α<sub>0</sub>□e(t)+α<sub>1</sub>□e(t+1)+ . . . α<sub>N</sub>□e(t+N)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where α-α<sub>N </sub>are a plurality of constants and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as recited in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the constants α-α<sub>N </sub>are selected to stabilize the PLL while attenuating phase error propagation from track-to-track.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A disk drive comprising:
<claim-text>(a) a disk;</claim-text>
<claim-text>(b) a head actuated over the disk, wherein the head comprises a read element and a write element; and</claim-text>
<claim-text>(c) control circuitry operable to servo write the disk by:
<claim-text>positioning the read element over a first track on the disk and positioning the write element over a second track on the disk;</claim-text>
<claim-text>synchronizing a phase locked loop (PLL) to first sectors previously written on the first track;</claim-text>
<claim-text>writing second sectors to the second track using the PLL, and saving a plurality of phase errors corresponding to the second sectors;</claim-text>
<claim-text>computing a correction value corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector;</claim-text>
<claim-text>positioning the read element over the second track on the disk and the write element over a third track on the disk;</claim-text>
<claim-text>synchronizing the PLL to the second sectors using the correction value; and</claim-text>
<claim-text>writing a third sector to the third track using the PLL, and saving a phase error corresponding to the third sector.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The disk drive as recited in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the correction value is at least partially computed according to:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α□e(t+m)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where α is a constant and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The disk drive as recited in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the correction value is at least partially computed according to:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α<sub>0</sub>□e(t)+α<sub>1</sub>□e(t+1)+ . . . α<sub>N</sub>□e(t+N)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where α-α<sub>N </sub>are a plurality of constants and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The disk drive as recited in <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the constants α-α<sub>N </sub>are selected to stabilize the PLL while attenuating phase error propagation from track-to-track.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. Control circuitry for use in a disk drive, the disk drive comprising a disk and a head actuated over the disk, wherein the head comprises a read element and a write element, the control circuitry operable to servo write the disk by:
<claim-text>positioning the read element over a first track on the disk and positioning the write element over a second track on the disk;</claim-text>
<claim-text>synchronizing a phase locked loop (PLL) to first sectors previously written on the first track;</claim-text>
<claim-text>writing second sectors to the second track using the PLL, and saving a plurality of phase errors corresponding to the second sectors;</claim-text>
<claim-text>computing a correction value corresponding to a selected one of the second sectors, wherein the correction value is computed in response to a plurality of the phase errors generated for a plurality of the second sectors leading the selected sector;</claim-text>
<claim-text>positioning the read element over the second track on the disk and the write element over a third track on the disk;</claim-text>
<claim-text>synchronizing the PLL to the second sectors using the correction value; and</claim-text>
<claim-text>writing a third sector to the third track using the PLL, and saving a phase error corresponding to the third sector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The control circuitry as recited in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the correction value is at least partially computed according to:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α□e(t+m)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where α is a constant and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The control circuitry as recited in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the correction value is at least partially computed according to:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>α<sub>0</sub>□e(t)+α<sub>1</sub>□e(t+1)+ . . . α<sub>N</sub>□e(t+N)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where α-α<sub>N </sub>are a plurality of constants and e(t+m) is the phase error generated for one of the second sectors leading the selected sector by m sectors.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The control circuitry as recited in <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the constants α-α<sub>N </sub>are selected to stabilize the PLL while attenuating phase error propagation from track-to-track.</claim-text>
</claim>
</claims>
</us-patent-grant>
