<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298774-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298774</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10362647</doc-number>
<date>20010827</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2000-256526</doc-number>
<date>20000825</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>JP</country>
<doc-number>2000-256527</doc-number>
<date>20000825</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>854</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>H</subclass>
<main-group>7</main-group>
<subgroup>30</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>375147</main-classification>
<further-classification>375232</further-classification>
</classification-national>
<invention-title id="d0e89">Adaptive array device, adaptive array method and program</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6240133</doc-number>
<kind>B1</kind>
<name>Sommer et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375232</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6490007</doc-number>
<kind>B1</kind>
<name>Bouillet et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348614</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6563880</doc-number>
<kind>B1</kind>
<name>Hunsinger et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375260</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6590532</doc-number>
<kind>B1</kind>
<name>Ogawa et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>342378</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2001/0046270</doc-number>
<kind>A1</kind>
<name>Uchiki et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375341</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2002/0032015</doc-number>
<kind>A1</kind>
<name>Kitakado et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4552771</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>EP</country>
<doc-number>0 949 769</doc-number>
<date>19991000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>01-194613</doc-number>
<date>19890400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>11-052988</doc-number>
<date>19990200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>11-127137</doc-number>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>JP</country>
<doc-number>2000-188568</doc-number>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>2000-188568</doc-number>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Jinkuan Wang and Tadashi Takano, “Investigation on Adaptive Antennas Using a Kalman Filter”, IEICE Transaction vol. J75-B-11, No. 11, Nov. 1992, (w/Verification of Translation).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Nobuyoshi Kikuma, “Adaptive Signal Processing Using Array Antennas”, Sep. 1998.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Ahmed I. Sulyman, Azzedine Zerguine, Convergence and Steady-State Analysis of a Variable Step-Size NLMS Algorithm, Signal Processing, Amsterdam, NL vol. 83, NR. 6, pp. 1255-1273.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>Buckflew et al., Weak Convergence and Local Stability Properties of Fixed Step Size Recursive Algorithms, IEEE Transactions on Information Theory, IEEE Inc., New York, US, vol. 39, No. 3 May 1, 1993, pp. 966-978.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>14</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>375140</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375147</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375130</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375224</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375227</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375228</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375229</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375230</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375231</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375233</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375377</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040048581</doc-number>
<kind>A1</kind>
<date>20040311</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Miyata</last-name>
<first-name>Takeo</first-name>
<address>
<city>Gifu</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Doi</last-name>
<first-name>Yoshiharu</first-name>
<address>
<city>Gifu</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Iwami</last-name>
<first-name>Masashi</first-name>
<address>
<city>Anpachi-gun</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sanyo Electric Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kumar</last-name>
<first-name>Pankaj</first-name>
<department>2611</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/JP01/07299</doc-number>
<kind>00</kind>
<date>20010827</date>
</document-id>
<us-371c124-date>
<date>20030804</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO02/17432</doc-number>
<kind>A </kind>
<date>20020228</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An adaptive array apparatus (<b>100</b>) that has a weight converge on an optimal value is provided. The adaptive array apparatus repeatedly adjusts the weight using predetermined calculations so as to minimize a difference between a desired signal and a combined signal which has been weighted with the weight. A parameter control unit (<b>71</b>) judges whether an adjusted weight is located closer to an optimal value than a reference value, and according to the judgment result, changes a step size which is used in the predetermined calculations performed by a reception weight calculating unit (<b>72</b>), to determine the extent to which the weight should be adjusted. With this construction, the adaptive array apparatus can increase convergence stability and speed in calculating a weight, and the weight converges on an optimal value.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="156.97mm" wi="215.31mm" file="US07298774-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="216.49mm" wi="158.41mm" orientation="landscape" file="US07298774-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="113.79mm" wi="143.34mm" file="US07298774-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="185.67mm" wi="144.70mm" file="US07298774-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="215.73mm" wi="157.82mm" file="US07298774-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="107.53mm" wi="123.70mm" file="US07298774-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="186.77mm" wi="148.93mm" file="US07298774-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present invention relates to an adaptive array apparatus that performs SDMA using an adaptive array method.</p>
<heading id="h-0002" level="1">BACKGROUND ART</heading>
<p id="p-0003" num="0002">With the recent increase in the number of subscribers for mobile communication services, the expansion of the capacity of cells covered by each wireless base station has been demanded. One of the multiple access technologies that will help solve this problem is a technology called Space Division Multiple Access, or “SDMA” for short.</p>
<p id="p-0004" num="0003">SDMA is a method used by a wireless base station to communicate with each of a plurality of mobile stations at the same timeslot and frequency, by dividing a communication space. The division of the communication space is realized when the wireless base station forms an optimum directivity pattern separately for each individual mobile station. A directivity pattern shows the direction in which signals are transmitted or received, and the intensity at which those signals are transmitted or received.</p>
<p id="p-0005" num="0004">The wireless base station is equipped with an adaptive array apparatus as a device for forming directivity patterns. The adaptive array apparatus is chiefly composed of a plurality of antennas and a DSP (Digital Signal Processor), and forms any directivity patterns freely by weighting with particular values the amplitude and phase of each signal transmitted or received by each antenna. The adaptive array apparatus then performs transmission and reception of signals using the formed patterns. Hereafter, a value used for weighting is referred to as a weight signal, and a set of weight signals for forming a directivity pattern is referred to as a weight vector.</p>
<p id="p-0006" num="0005">The adaptive array apparatus forms an optimal directivity pattern for a mobile station, by tracking the movements of the mobile station, which sends signals in a direction unforeknown to the adaptive array apparatus. One of the principles on which the adaptive array apparatus operates is MMSE (Minimum Mean Square Error). MMSE requires reference signals. A reference signal serves as a target when weighting received signals and combining them to produce a signal. An adaptive array apparatus that uses MMSE determines a weight vector so as to minimize a difference between the reference signal and the combined signal. Using such a weight vector creates a directivity pattern which is optimal for receiving signals from the mobile station.</p>
<p id="p-0007" num="0006">In TDMA/TDD (Time Division Multiple Access/Time Division Duplex), which is another multiple access technique, each timeslot includes predetermined bit patterns such as a preamble and a unique word at the top and a payload in the following section.</p>
<p id="p-0008" num="0007">This means that when a combination of SDMA, MMSE and TDMA/TDD is used in communication, the adaptive array apparatus can use the preamble, the unique word and the like as reference signals.</p>
<p id="p-0009" num="0008">In more detail, the adaptive array apparatus sets a certain weight vector as an initial value, and compares a reference signal, such as a preamble and a unique word, with a signal that is obtained by weighting using the weight vector. In order to minimize the difference between them, the adaptive array apparatus adjusts the value of the weight vector. By repeating such processing for a bit pattern in symbol units, the weight vector converges on a certain value after a period of time. Following this, signals of the payload is weighted by the converged weight vector and then extracted. After receiving the predetermined bit pattern such as the preamble and the unique word, the adaptive array apparatus identifies the extracted signals and uses them as reference signals on the premise that the identification is correct.</p>
<p id="p-0010" num="0009">However, the conventional adaptive array apparatus described above has problems in that a weight vector converges slowly and unstably. Here, converging unstable means that the value of a weight vector fluctuates and does not settle at a certain value. Converging slowly means that it takes long from the setting of an initial value of a weight vector to the convergence of the weight vector.</p>
<p id="p-0011" num="0010">One reason is that in an algorithm of calculating weight vectors, stability in convergence is an element opposing to convergence speed. Therefore, it is difficult to improve both of them. For instance, in LMS (Least Mean Square), a typical algorithm for MMSE, increasing the speed of convergence leads to deterioration in convergence stability, whereas an improvement in stability slows the convergence.</p>
<p id="p-0012" num="0011">Another reason is associated with the way of setting an initial value of a weight vector. Since the initial value is fixed in the conventional adaptive array apparatus, it takes long for the weight vector value to converge on an optimal value. In fact, in many cases weight vectors cannot converge sufficiently.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> show difference curves. In the actual fact, a weight vector is multidimensional and so the difference curve has a curved surface in a multidimensional space, though the weight vector is illustrated as a one-dimensional vector here for the sake of convenience. In LMS algorithm and RLS (Recursive Least-Squares) algorithm which is also used for MMSE, the weight vector is adjusted consecutively in a direction that decreases the value of the difference curve.</p>
<p id="p-0014" num="0013">As shown in <figref idref="DRAWINGS">FIG. 6A</figref>, it does not take long for an initial value Winit (A) to converge on an optimal value Wopt, as it is close to Wopt. In contrast, it takes long for an initial value Winit (B) to converge, as it is not close to Wopt. If only a single fixed initial value is used, it takes long for the initial value to converge, as it is not close to an optimal value.</p>
<p id="p-0015" num="0014">If a weight vector calculated from the preceding symbol is set as an initial value, however, there is a high probability of the weight vector value being a local minimum value, because it is the point where the weight vector has finally settled as a result of an adjustment to minimize the difference.</p>
<p id="p-0016" num="0015">As shown in <figref idref="DRAWINGS">FIG. 6B</figref>, it is known by experience that Winit may be a local minimum value due to noise or other factors. In that case, it is impossible for the weight vector value to pass a peak and converge on an optimal value Wopt which is a general minimum value.</p>
<p id="p-0017" num="0016">The use of RLS can increase convergence speed, but when an error exists in signals at the beginning, the error is aggravated with successive calculations. This means that if there is a major error in a weight vector calculated from the last symbol, there is a danger that a totally wrong weight vector may be produced in the following reception period.</p>
<heading id="h-0003" level="1">DISCLOSURE OF INVENTION</heading>
<p id="p-0018" num="0017">It is a first object of the present invention to provide an adaptive array apparatus, method and program that increase convergence stability and speed in the weight vector calculation, and thereby enable weight vectors to converge to optimal values, by making improvements to algorithms for calculating weight vectors.</p>
<p id="p-0019" num="0018">It is a second object of the present invention to provide an adaptive array apparatus, method and program that enable weight vectors to converge to optimal values, and thereby increase convergence stability and speed of convergence in the weight vector calculation, by making improvements to a method for defining an initial weight vector value.</p>
<p id="p-0020" num="0019">The first object can be achieved by an adaptive array apparatus which has a weight converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight and combined, the adaptive array apparatus including: a judging unit for judging whether an adjusted weight is located closer to the optimal value than a reference value; and a changing unit for changing a first step size in accordance with the judgment result of the judging unit, the first step size being used to determine the extent to which the weight should be adjusted in the predetermined calculations.</p>
<p id="p-0021" num="0020">Here, the adaptive array apparatus may have a plurality of antennas, wherein the judging unit judges that the adjusted weight is located closer to the optimal value than the reference value when the number of times the weight is adjusted reaches twice the number of antennas, and the changing unit changes the first step size from a first value to a second value when the adjusted weight is judged to be located closer to the optimal value than the reference value, the second value corresponding to a lower rate at which the weight is adjusted than the first value.</p>
<p id="p-0022" num="0021">With the stated construction, it is possible to increase convergence speed and thus reduce the time required for a convergence by adjusting a weight vector at a higher rate, until the number of times the weight vector is adjusted reaches twice the number of the antennas. It is also possible to improve convergence stability by adjusting a weight vector at a lower rate, after the number of times the weight vector is adjusted reaches twice the number of the antennas.</p>
<p id="p-0023" num="0022">Here, the judging unit may judge that the adjusted weight is located closer to the optimal value than the reference value when the difference between the combined signal and the desired signal becomes smaller than a predetermined value, wherein the changing unit changes the first step size from a first value to a second value when the adjusted weight is judged to be located closer to the optimal value than the reference value, the second value corresponding to a lower rate at which the weight is adjusted than the first value.</p>
<p id="p-0024" num="0023">With the stated construction, it is possible to increase convergence speed and thus reduce the time required for a convergence by adjusting a weight vector at a higher rate, until the number of times the weight vector is adjusted reaches twice the number of the antennas. It is also possible to improve convergence stability by adjusting a weight vector at a lower rate, after the number of times the weight vector is adjusted reaches twice the number of the antennas.</p>
<p id="p-0025" num="0024">Here, the judging unit may judge that the adjusted weight is located closer to the optimal value than the reference value when a frequency offset converges at a lower rate than a predetermined value, the frequency offset being adjusted successively, wherein the changing unit changes the first step size from a first value to a second value when the adjusted weight is judged to be located closer to the optimal value than the reference value, the second value corresponding to a lower rate at which the weight is adjusted than the first value.</p>
<p id="p-0026" num="0025">With the stated construction, it is possible to increase convergence speed and thus reduce the time required for a convergence by adjusting a weight vector at a higher rate, until the number of times the weight vector is adjusted reaches twice the number of the antennas. It is also possible to improve convergence stability by adjusting a weight vector at a lower rate, after the number of times the weight vector is adjusted reaches twice the number of the antennas.</p>
<p id="p-0027" num="0026">Here, the changing unit may also change a second step size from a third value to a fourth value, the second step size being used to determine the extent to which the frequency offset should be adjusted, the fourth value corresponding to a lower rate at which the frequency offset should be adjusted than the third value.</p>
<p id="p-0028" num="0027">Here, the judging unit may judge that the adjusted weight is located closer to the optimal value than the reference value when a phase component of the difference becomes smaller than a phase component of the predetermined value.</p>
<p id="p-0029" num="0028">The second object can be achieved by the adaptive array apparatus that further includes: a reception response vector calculating unit for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD (Time Division Multiple Access/Time Division Duplex) reception and transmission cycle; a weight vector calculating unit for calculating a weight vector of the immediately preceding reception timeslot from the reception response vector; and an initial value setting unit for setting the weight vector of the immediately preceding reception timeslot, as an initial value for calculating a weight vector of a present reception timeslot.</p>
<p id="p-0030" num="0029">As a result, the weight vector calculated from a Wiener solution of the preceding reception timeslot is set as an initial value of use in successive calculation of weight vectors, enabling the weight vector to converge on an optimal value in a short period of time.</p>
<p id="p-0031" num="0030">Here, the adaptive array apparatus may include: a reception response vector calculating unit for calculating a reception response vector of an immediately preceding reception timeslot in the TDMA/TDD reception and transmission cycle; a correlation matrix calculating unit for calculating a correlation matrix from the reception response vector; and an initial value setting unit for setting the correlation matrix as an initial value for calculating a weight vector of a present reception timeslot.</p>
<p id="p-0032" num="0031">As a result, the correlation matrix with a fewer error elements in the preceding reception frame is set as an initial value of use in successive calculation of weight vectors, enabling the weight vector to converge on an optimal value in a short period of time.</p>
<p id="p-0033" num="0032">Here, the initial value setting unit may set an adjusted correlation matrix as an initial value instead of the correlation matrix, the adjusted correlation matrix being obtained by adding a predetermined value to diagonal elements of the correlation matrix.</p>
<p id="p-0034" num="0033">As a result, a predetermined value is added to the diagonal elements of the correlation matrix, enhancing the convergency of a weight vector.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing the construction of a wireless base station (which is a main part of an adaptive array apparatus).</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram of a TDMA/TDD frame.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart showing an operational procedure for calculating an initial value by a signal processing unit.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart showing an operational procedure for calculating a weight vector by a weight calculating unit.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 5A</figref> shows an example initial value P(0) of a correlation matrix calculated by a correlation matrix operator <b>303</b>.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 5B</figref> shows an initial value P′(0) of an adjusted version of the correlation matrix.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> show difference curves.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">BEST MODE FOR CARRYING OUT THE INVENTION</heading>
<p id="p-0042" num="0041">The following describes an embodiment of the present invention, with reference to the accompanying drawings.</p>
<p id="h-0006" num="0000">Construction of Wireless Base Station <b>100</b></p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram showing a main part of a wireless base station <b>100</b> corresponding to an adaptive array apparatus.</p>
<p id="p-0044" num="0043">As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the wireless base station <b>100</b> includes antennas <b>11</b> to <b>14</b>, a radio unit <b>20</b> and a signal processing unit <b>38</b>.</p>
<p id="p-0045" num="0044">The radio unit <b>20</b> includes switching units <b>21</b> to <b>24</b> for switching reception and transmission, and reception units <b>31</b> to <b>34</b> for converting high-frequency signals, which are sent from the antennas <b>11</b> to <b>14</b>, into low-frequency signals and outputting them to the signal processing unit <b>38</b>. The radio unit <b>20</b> further includes transmission units <b>61</b> to <b>64</b> for converting low-frequency signals that are input from the signal processing unit <b>38</b> into high-frequency signals, and amplifying and outputting them to the antennas <b>11</b> to <b>14</b>.</p>
<p id="p-0046" num="0045">The signal processing unit <b>38</b> is chiefly composed of a programmable digital signal processor, and performs signal processing on signals that travel between the wireless base station <b>100</b> and each mobile station, with which the wireless base station <b>100</b> performs multiplex communication using TDMA/TDD and SDMA.</p>
<p id="p-0047" num="0046">The following is an explanation of the multiplex communication, with reference to <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 2</figref> shows a TDMA/TDD frame of 5 ms taken along a time axis, which is a unit of a transmission and reception cycle. The TDMA/TDD frame consists of four transmission timeslots (T<b>0</b> to T<b>3</b>) and four reception timeslots (R<b>0</b> to R<b>3</b>), which are each 625 μs long. With this construction, the wireless base station <b>100</b> can compress 5 ms of information to 625 μs of information and transmit them to a maximum of four mobile stations in each of the timeslots T<b>0</b> to T<b>3</b>. In each reception timeslot that comes 2.5 ms after the corresponding transmission timeslot, the wireless base station <b>100</b> receives from each mobile station 5 ms of information that has been compressed into 625 μs of information. In addition, the wireless base station <b>100</b> performs spatial multiplexing for two mobile stations in each timeslot using the adaptive array method. Thus, the use of TDMA/TDD and SDMA enables the wireless base station <b>100</b> to perform spatial multiplexing for a plurality of mobile stations. For instance, the wireless base station <b>100</b> communicates with first and second mobile stations in the transmission timeslot T<b>0</b> and reception timeslot R<b>0</b>, and communicates with third and fourth mobile stations in the transmission timeslot T<b>1</b> and reception timeslot R<b>1</b>.</p>
<p id="p-0049" num="0048">The signal processing unit <b>38</b> realizes such multiplex communication, and processes reception/transmission signals for two mobile stations in each timeslot of a TDMA/TDD frame.</p>
<p id="h-0007" num="0000">Detailed Construction of the Signal Processing Unit <b>38</b></p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 1</figref> shows the construction of the signal processing unit <b>38</b> in terms of function. The signal processing unit <b>38</b> includes a user I signal processing unit <b>39</b>, a user II signal processing unit <b>40</b> and adders <b>56</b> to <b>59</b>.</p>
<p id="p-0051" num="0050">The user I signal processing unit <b>39</b>, in a reception timeslot, weights four signals input from the reception units <b>31</b> to <b>34</b> with predetermined weight signals, and thereby extracts signals sent from a mobile station to the wireless base station <b>100</b>. In a transmission timeslot that comes 2.5 ms after that reception timeslot, the user I signal processing unit <b>39</b> adds weights to signals that are to be transmitted from the wireless base station <b>100</b> to the mobile station with the same weight signals, and then distributes the weighted signals to the transmission units <b>61</b> to <b>64</b>, which outputs the weighted signals. More detailed explanation of their operation will be given later.</p>
<p id="p-0052" num="0051">The user II signal processing unit <b>40</b> carries out the same processing as the user I signal processing unit <b>39</b> on a mobile station, which is different from a mobile station that the processing of the user I signal processing unit <b>39</b> is dealing with.</p>
<p id="p-0053" num="0052">The adders <b>56</b> to <b>59</b>, in a transmission timeslot, each add signals that are output from the user I signal processing unit <b>39</b> and user II signal processing unit <b>40</b> respectively, and output the results to the corresponding transmission units <b>61</b> to <b>64</b>.</p>
<p id="h-0008" num="0000">Detailed Construction of the User I Signal Processing Unit <b>39</b></p>
<p id="p-0054" num="0053">The user I signal processing unit <b>39</b> includes multipliers <b>41</b> to <b>44</b>, an adder <b>45</b>, a demodulation circuit <b>46</b>, an adaptive processor <b>70</b>, a modulation circuit <b>55</b> and multipliers <b>51</b> to <b>54</b>.</p>
<p id="p-0055" num="0054">The multipliers <b>41</b> to <b>44</b> and the adder <b>45</b>, in a reception timeslot, weight and combine each signal sent from the corresponding reception units <b>31</b> to <b>34</b> with particular weight signals calculated by a reception weight calculating unit <b>72</b>.</p>
<p id="p-0056" num="0055">The demodulation circuit <b>46</b> demodulates the combined symbol waved signals sent from the adder <b>45</b> and outputs the resulting bit data sequence.</p>
<p id="p-0057" num="0056">The modulation circuit <b>55</b> modulates a bit data sequence to be transmitted in a transmission timeslot into a symbol waved signals.</p>
<p id="p-0058" num="0057">The multipliers <b>51</b> to <b>54</b> multiply the modulated signals provided by the modulation circuit <b>55</b> by weight signals, and output the results. These weight signals have the same values as those calculated in a preceding reception timeslot.</p>
<p id="p-0059" num="0058">The adaptive processor <b>70</b> is a primary construction element of the present invention, and provides a weight signal to each of the multipliers <b>41</b> to <b>44</b> in a reception timeslot while adjusting the weight signal so as to minimize a difference between a reference signal and the weight signal which is obtained through weighting and combining performed by the multipliers <b>41</b> to <b>44</b> and the adder <b>45</b>. In a transmission timeslot, the adaptive processor <b>70</b> provides a weight signal, calculated in a reception timeslot that comes 2.5 ms earlier, to the multipliers <b>51</b> to <b>54</b>.</p>
<p id="p-0060" num="0059">Note that the reference signal is used as a target when weighting and combining received signals. In the first half of a reception timeslot, a sequence of given signals transmitted from a mobile station, such as a preamble and unique word, serves as reference signals. In the second half, a sequence of signals demodulated by the demodulation circuit <b>46</b> from combined signals serves as reference signals.</p>
<p id="h-0009" num="0000">Detailed Construction of the Adaptive Processor <b>70</b></p>
<p id="p-0061" num="0060">The adaptive processor <b>70</b> includes a remodulation circuit <b>47</b>, a memory <b>48</b>, a switch <b>49</b>, a counter <b>50</b>, a parameter control unit <b>71</b>, the reception weight calculating unit <b>72</b>, a correlation matrix operator <b>303</b>, an initial weight operator <b>304</b>, a reception response vector calculator <b>305</b> and an initial value memory <b>309</b>.</p>
<p id="p-0062" num="0061">The remodulation circuit <b>47</b> remodulates a bit data sequence sent from the demodulation circuit <b>46</b> into symbol waved signals, and outputs them to the switch <b>49</b>. These signals are used as reference signals by the reception weight calculating unit <b>72</b> to calculate weight signals.</p>
<p id="p-0063" num="0062">The memory <b>48</b> stores given bit patterns such as a preamble and unique word, and outputs a symbol waved signals of the bit pattern through the switch <b>49</b>. Under the PHS(Personal Handyphone System) standard, other given bit pattern includes a rampbit and a start symbol. The memory <b>48</b> stores a part or all of those given bit patterns and outputs their symbol waved signals. Such signals are also used as reference signals by the reception weight calculating unit <b>72</b>.</p>
<p id="p-0064" num="0063">The counter <b>50</b> counts the number of symbols in a symbol waved signal that is sent from the remodulation circuit <b>47</b> or the memory <b>48</b> to the switch <b>49</b>.</p>
<p id="p-0065" num="0064">The switch <b>49</b> uses the number of symbols to distinguish a reception period for a given bit pattern from a reception period for the remaining signals contained in a reception timeslot. The switch <b>49</b> selects an output from the memory <b>48</b> in the former period and an output from the remodulation circuit <b>47</b> in the latter period, and then outputs a selected output to the reception weight calculating unit <b>72</b>.</p>
<p id="p-0066" num="0065">The parameter control unit <b>71</b> adjusts a parameter that is used to determine a rate of adjusting a weight signal, according to the extent at which the weight signal converges on an ideal weight signal after successive modification. More detailed explanation of such modifications will be given later.</p>
<p id="p-0067" num="0066">The reception weight calculating unit <b>72</b> calculates weight signals to provide to the multipliers <b>41</b> to <b>44</b> and multipliers <b>51</b> to <b>54</b>. More specifically, in a reception period of a reception timeslot where a given bit pattern is received, initial weight signal values stored in the initial value memory <b>309</b> are provided to the multipliers <b>41</b> to <b>44</b>, respectively. Then, combined signals, which is obtained by weighting and combining by the multipliers <b>41</b> to <b>44</b> and the adder <b>45</b>, are input to the reception weight calculating unit <b>72</b>. The reception weight calculating unit <b>72</b> calculates a difference between each of the combined signals and a respective reference signal which has been provided by the memory <b>48</b> through the switch <b>49</b>. The reception weight calculating unit <b>72</b> adjusts the initial weight signal so as to minimize the difference, calculates a new weight signal and sends it to the multiplier again. By repeatedly adjusting the weight signal in a specific period of time, around the time the reception of the given bit pattern is completed, a weight signal has converged nearly on an ideal value. After the reception is completed, the reception weight calculating unit <b>72</b> calculates a difference between the combined signal and the reference signal which is input from the remodulation circuit <b>47</b> through the switch <b>49</b>, and makes precise adjustment for the weight signal on the basis of the difference.</p>
<p id="h-0010" num="0000">Calculation of an Initial Value</p>
<p id="p-0068" num="0067">The reception response vector calculator <b>305</b> calculates an ensemble average of a product of reception signals and user signals contained in the entire reception frame. Reception response vectors are calculated using the following expressions, where a reception response vector calculated from a signal S<b>1</b>, which is sent from a first mobile station (hereafter referred to as a user I), is RV1 and a reception response vector calculated from a signal S<b>2</b>, which is sent from a second mobile station (hereafter referred to as a user II), is RV2;
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0068">RV1=[RV<sub>11</sub>, RV<sub>12</sub>, RV<sub>13</sub>, RV<sub>14</sub>]<sup>T </sup></li>
        <li id="ul0002-0002" num="0069">RV2=[RV<sub>21</sub>, RV<sub>22</sub>, RV<sub>23</sub>, RV<sub>24</sub>]<sup>T </sup></li>
        <li id="ul0002-0003" num="0070">RV<sub>11</sub>=E [X<sub>1</sub>(t)S<b>1</b>*(t)]</li>
        <li id="ul0002-0004" num="0071">RV<sub>12</sub>=E [X<sub>2</sub>(t)S<b>1</b>*(t)]</li>
        <li id="ul0002-0005" num="0072">RV<sub>13</sub>=E [X<sub>3</sub>(t)S<b>1</b>*(t)]</li>
        <li id="ul0002-0006" num="0073">RV<sub>14</sub>=E [X<sub>4</sub>(t)S<b>1</b>*(t)]</li>
        <li id="ul0002-0007" num="0074">RV<sub>21</sub>=E [X<sub>1</sub>(t)S<b>2</b>*(t)]</li>
        <li id="ul0002-0008" num="0075">RV<sub>22</sub>=E [X<sub>2</sub>(t)S<b>2</b>*(t)]</li>
        <li id="ul0002-0009" num="0076">RV<sub>23</sub>=E [X<sub>3</sub>(t)S<b>2</b>*(t)]</li>
        <li id="ul0002-0010" num="0077">RV<sub>24</sub>=E [X<sub>4</sub>(t)S<b>2</b>*(t)]</li>
        <li id="ul0002-0011" num="0078">here E [ ] shows an expected value, * indicates conjugate and <sup>T </sup>indicates transpose.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0069" num="0079">RV1 is calculated by the user I signal processing unit <b>39</b> and RV2 is calculated by the user II signal processing unit <b>40</b>. The resulting values provided by any one of the units are sent to the other and shared between the two units.</p>
<p id="p-0070" num="0080">The initial value memory <b>309</b> stores an initial value P(0) of a correlation matrix calculated by the correlation matrix operator <b>303</b> and an initial value W(0) of a weight vector calculated by the initial weight operator <b>304</b>.</p>
<p id="p-0071" num="0081">A reference signal memory <b>310</b> stores a reference signal d(t).</p>
<p id="p-0072" num="0082">The correlation matrix operator <b>303</b> calculates an initial value P(0) of a correlation matrix by applying reception response vectors RV1 and RV2 of a preceding frame to the following expressions, and stores the results in the initial value memory <b>309</b>.
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0083">P(0)=[p<sub>ij</sub>](i, j=1˜4)</li>
        <li id="ul0004-0002" num="0084">p<sub>11</sub>=RV<sub>11</sub>*×RV<sub>11</sub>+RV<sub>21</sub>*×RV<sub>21 </sub></li>
        <li id="ul0004-0003" num="0085">p<sub>22</sub>=RV<sub>12</sub>*×RV<sub>12</sub>+RV<sub>22</sub>*×RV<sub>22 </sub></li>
        <li id="ul0004-0004" num="0086">p<sub>33</sub>=RV<sub>13</sub>*×RV<sub>13</sub>+RV<sub>23</sub>*×RV<sub>23 </sub></li>
        <li id="ul0004-0005" num="0087">p<sub>44</sub>=RV<sub>14</sub>*×RV<sub>14</sub>+RV<sub>24</sub>*×RV<sub>24 </sub></li>
        <li id="ul0004-0006" num="0088">p<sub>12</sub>=RV<sub>11</sub>*×RV<sub>12</sub>+RV<sub>21</sub>*×RV<sub>22 </sub></li>
        <li id="ul0004-0007" num="0089">p<sub>13</sub>=RV<sub>11</sub>*×RV<sub>13</sub>+RV<sub>21</sub>*×RV<sub>23 </sub></li>
        <li id="ul0004-0008" num="0090">p<sub>14</sub>=RV<sub>11</sub>*×RV<sub>14</sub>+RV<sub>21</sub>*×RV<sub>24 </sub></li>
        <li id="ul0004-0009" num="0091">p<sub>23</sub>=RV<sub>12</sub>*×RV<sub>13</sub>+RV<sub>22</sub>*×RV<sub>23 </sub></li>
        <li id="ul0004-0010" num="0092">p<sub>24</sub>=RV<sub>12</sub>*×RV<sub>14</sub>+RV<sub>22</sub>*×RV<sub>24 </sub></li>
        <li id="ul0004-0011" num="0093">p<sub>34</sub>=RV<sub>13</sub>*×RV<sub>14</sub>+RV<sub>22</sub>*×RV<sub>24 </sub></li>
        <li id="ul0004-0012" num="0094">p<sub>ij=p</sub><sub>ij*(i≠j) </sub></li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0073" num="0095">The initial weight operator <b>304</b> calculates an initial value W(0) of a weight vector by applying the reception response vector RV1 of the preceding frame and the initial value P(0) of the correlation matrix to the following expression,
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0096">W(0)=P(0)<sup>−1</sup>RV1</li>
        <li id="ul0006-0002" num="0097">and stores the result in the initial value memory <b>309</b>.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0074" num="0098">Using such calculated initial values of a weight vector and correlation matrix gives the following advantages;</p>
<p id="p-0075" num="0099">(1) Since little change is expected between the preceding frame and the present frame, using the initial values of the weight vector and the correlation matrix, which are calculated from the preceding frame, can reduce the time required for the weight vector to converge on an optimal value.
<br/>
(2) A weight vector is calculated from a Wiener solution based on reception response vectors contained in the entire frame, not just the last symbol of the preceding frame. Unlike a weight vector calculated only from the last symbol, such a weight vector is not a local minimum value and so converges on an optimal weight value.
<br/>
(3) For the weight vector and correlation matrix calculated from a Wiener solution of the preceding frame, there is only a small difference between an initial weight signal value and a reference signal, with a factor of the difference being leveled off. This being so, RLS algorithm can be used as a weight calculating means, though it is difficult to apply when there is a large difference between an initial weight signal value and an optimal value. With the use of RLS, the convergence speed of a weight vector increases, and thereby the time required for the convergence is reduced.
</p>
<p id="p-0076" num="0100">The reception weight calculating unit <b>72</b> calculates a reception weight vector using LMS and RLS, and adjusts the reception weight vector in each reception timeslot by successively calculating new weight vectors. More specifically, the reception weight calculating unit <b>72</b> calculates weights Wr×1to Wr×4 using sequences of symbols X<sub>1 </sub>to X<sub>4</sub>, which are sent from the radio unit <b>20</b>, a sequence of symbols d(t), which are reference signals stored in the memory <b>48</b> or signals generated by the radio unit itself, and initial values W(0) and P(0), which are stored in the initial value memory <b>309</b>. The reception weight calculating unit <b>72</b> then outputs the resulting weights Wr×1 to Wr×4.</p>
<p id="p-0077" num="0101">The multipliers <b>41</b> to <b>44</b> and the adder <b>45</b> generate a user I signal S<b>1</b> (=Wr×1×X<sub>1</sub>+Wr×2×X<sub>2</sub>+Wr×3×X<sub>3</sub>+Wr×4×X<sub>4</sub>), which is sent to a modem unit.</p>
<p id="h-0011" num="0000">Operational Procedure for Calculating an Initial Value</p>
<p id="p-0078" num="0102">The following describes how to calculate an initial value.</p>
<p id="p-0079" num="0103"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart showing the operational procedure for calculating an initial value by the signal processing unit <b>38</b>.</p>
<p id="p-0080" num="0104">First, after a user signal S(t) is calculated from the last reception signal X(t) of a reception frame, the reception response vector calculator <b>305</b> calculates reception response vectors RV1=[RV<sub>11</sub>, RV<sub>12</sub>, RV<sub>13</sub>, RV<sub>14</sub>]<sup>T </sup>and RV2=[RV<sub>21</sub>, RV<sub>22</sub>, RV<sub>23</sub>, RV<sub>24</sub>]<sup>T </sup>using the ensemble average of a product of the reception signal X(t) and user signal S(t). In other words, RV<sub>1i</sub>=E[X<sub>i</sub>(t)S<b>1</b>*(t)], RV<sub>2i</sub>=E[X<sub>i</sub>(t)S<b>2</b>*(t)] (step S<b>401</b>).</p>
<p id="p-0081" num="0105">Secondly, the correlation matrix operator <b>303</b> calculates an initial value P(0) of a correlation matrix from the reception response vectors RV1 and RV2, and stores it in the initial value memory <b>309</b>. Therefore, when P(0)=[p<sub>ij</sub>] (i, j=1˜4), p<sub>ij</sub>=RV<sub>1i</sub>*×RV<sub>1j</sub>+RV<sub>2i</sub>*×RV<sub>2j </sub>(step S<b>402</b>).</p>
<p id="p-0082" num="0106">Finally, the initial weight operator <b>304</b> calculates an initial value W(0) of a weight vector. That is, an initial value of a weight vector in the user I signal processing unit is calculated by the expression, W(0)=P(0)<sup>−1</sup>RV1 (step S<b>403</b>).</p>
<p id="h-0012" num="0000">Operational Procedure for Calculating a Weight Signal</p>
<p id="p-0083" num="0107"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart showing the detailed procedure for calculating a weight signal, centering on the reception weight calculating unit <b>72</b>. The reception weight calculating unit <b>72</b> and other units perform the processing described in <figref idref="DRAWINGS">FIG. 4</figref> in each timeslot.</p>
<p id="p-0084" num="0108">When a reception timeslot begins, the reception weight calculating unit <b>72</b> sets the time at t=1 (step S<b>201</b>) and sets an initial value (step S<b>203</b>). To set the initial value, an initial value W(0) of a weight vector and an initial value P(0) of a correlation matrix are read from the initial value memory <b>309</b>, and a forgetting coefficient λ and a step size μ are read from a memory situated inside the reception weight calculating unit <b>72</b>.</p>
<p id="p-0085" num="0109">After step S<b>205</b>, the weight vector is repeatedly adjusted in symbol units, starting from t=1 till t reaches the end of the timeslot.</p>
<p id="p-0086" num="0110">The reception weight calculating unit <b>72</b> has the parameter control unit <b>71</b> execute processing of adjusting parameters (step S<b>205</b>). More detailed explanation of this processing will be given later.</p>
<p id="p-0087" num="0111">While t is within a preamble section, the reception weight calculating unit <b>72</b> adjusts the weight vector using expressions that are based on RLS (Recursive Least Squares) algorithm (steps S <b>209</b> to S<b>219</b>). After the preamble section, the reception weight calculating unit <b>72</b> adjusts the weight vector using expressions that are based on LMS algorithm (steps S <b>225</b> to S <b>229</b>). Note that the preamble section here refers to a period for receiving the given bit pattern such as a unique word.</p>
<p id="p-0088" num="0112">In step S<b>207</b>, the reception weight calculating unit <b>72</b> compensates for frequency offset while t is within the preamble section (step S<b>209</b>). Put another way, X(t)e <sup>−jθt </sup>is determined and regarded as being X(t).</p>
<p id="p-0089" num="0113">Then, the reception weight calculating unit <b>72</b> calculates a Kalman gain vector K(t) (step S<b>211</b>). More specifically, the reception weight calculating unit <b>72</b> calculates T(t)=λP(t−1) X(t), and based on that, calculates K(t)=T(t)/(1+X<sup>H</sup>(t) T(t)). <sup>H </sup>refers to conjugate transpose. When t=1, P(0) is read from the initial value memory <b>309</b> and used as a reference signal.</p>
<p id="p-0090" num="0114">The reception weight calculating unit <b>72</b> reads a reference signal d(t) for the preamble section from the memory <b>48</b> (step S<b>213</b>) and calculates an error e(t)=d(t)−W<sup>H</sup>(t−1)X(t) (step S<b>215</b>). When t=1, W(0) is read from the initial value memory <b>309</b> and used as a reference signal.</p>
<p id="p-0091" num="0115">The reception weight calculating unit <b>72</b> adjusts the weight vector (step S<b>217</b>), by performing the calculation W(t)=W (t−1)+e*(t)K(t).</p>
<p id="p-0092" num="0116">The reception weight calculating unit <b>72</b> adjusts the correlation matrix P(t) (step S<b>219</b>), by performing the calculation P(t)=λP(t−1)−K(t)<sup>H</sup>T(t).</p>
<p id="p-0093" num="0117">During the preamble section, the reception weight calculating unit <b>72</b> carries out the processing described in steps S<b>209</b> through <b>219</b>. After that, the reception weight calculating unit <b>72</b> estimates frequency offset θ(t) (step S<b>223</b>). To do so, either of the following expressions
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0118">θ(t)=θ(t−1)+γ′[Re{e(t)}*Im{d(t)}−Im{e(t)}*Re{d(t)}] or</li>
        <li id="ul0008-0002" num="0119">θ(t)=θ(t−1)+γ′[a tan(W<sup>H</sup>(t−1)X(t))−a tan(d (t))]</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0094" num="0120">is used.</p>
<p id="p-0095" num="0121">The reception weight calculating unit <b>72</b> ends the series of processing if t has reached the end of the reception timeslot, and if not, repeats the processing from step S<b>205</b> (step S<b>203</b>).</p>
<p id="p-0096" num="0122">When t passes the preamble section and goes beyond, since any reference signals are stored in the memory <b>48</b> for the following section, the reception weight calculating unit <b>72</b> begins to generate reference signals on its own. Which is to say, the reception weight calculating unit <b>72</b> either calculates a reference signal, d(t)=De t [W(t−1)<sup>H</sup>X(t)] (step S<b>225</b>) or employs a signal sent from the remodulation circuit <b>47</b> as a reference signal d(t).</p>
<p id="p-0097" num="0123">Then, the reception weight calculating unit <b>72</b> calculates an error, e(t)=d(t)−W<sup>H</sup>(t−1) X(t) (step S<b>227</b>).</p>
<p id="p-0098" num="0124">The reception weight calculating unit <b>72</b> then adjusts the weight vector, by performing the calculation, W(t)=W(t−1)+μe*(t)X(t) (step S<b>229</b>).</p>
<p id="p-0099" num="0125">Finally, the reception weight calculating unit <b>72</b> performs step S<b>221</b>, repeats the processing from step S<b>205</b> and ends the processing when t reaches the end of a reception timeslot (step S<b>223</b>).</p>
<p id="p-0100" num="0126">Such frequency offset processing may be saved after step S<b>219</b>, and performed only after step S<b>229</b>.</p>
<p id="h-0013" num="0000">Modification of a Parameter</p>
<p id="p-0101" num="0127">In step S<b>205</b>, the parameter control unit <b>71</b> adjusts a parameter that determines to which extent a weight vector should be adjusted, depending on whether the adjusted weight vector is located closer to an optimal weight vector than a reference value as a result of the processing from steps S<b>207</b> through <b>223</b>.</p>
<p id="p-0102" num="0128">There are five methods for the modification 1 to 5, as described below, in respect of how to judge the extent of convergence and which kind of parameter is to be adjusted. The parameter control unit <b>71</b> carriers out one of the adjusting methods 1 to 5. Any combination of these methods may also be used.</p>
<p id="h-0014" num="0000">Adjusting Method 1</p>
<p id="p-0103" num="0129">The parameter control unit <b>71</b> judges that an adjusted weight is located closer to an optimal value than a reference value when the number of times a weight vector is adjusted, t, reaches twice the number of antennas, which is 4 antennas×2=8. The parameter control unit <b>71</b> then changes an initial value of at least one of the forgetting coefficient λ, step size μ and frequency offset step size γ, so that the weight vector is adjusted at a lower rate. This means that an initial value of the forgetting coefficient λ is raised, while initial values of the step size μ and frequency offset step size γ are decreased.</p>
<p id="p-0104" num="0130">Being adjusted successively, a weight vector in theory converges to some extent by the time the number of times it is adjusted reaches twice the number of antennas. Accordingly, when the number of times the weight vector is adjusted reaches twice the number of antennas, by adjusting one of the parameters so that the weight vector is adjusted at a lower rate, both the convergence speed and stability can be enhanced. Which is to say, the time required for the convergence can be reduced with an increase in the convergence speed, by adjusting the weight vector at a higher rate when the number of times the weight vector is adjusted is smaller than twice the number of antennas. Also, the convergence stability can be improved by lowering the rate at which the weight vector is adjusted when the number of times the weight vector is adjusted is greater than twice the number of antennas.</p>
<p id="h-0015" num="0000">Adjusting Method 2</p>
<p id="p-0105" num="0131">The parameter control unit <b>71</b> judges that an adjusted weight is located closer to an optimal value than a reference value when a phase error of an error e(t) becomes smaller than a predetermined value stored in the memory. At that time, the parameter control unit <b>71</b> changes an initial value of at least one of the forgetting coefficient λ, step size μ and frequency offset step size γ, so that the weight vector is adjusted at a lower rate. Note that the phase error refers to a difference between a phase component of a reference signal d(t) and a phase component of a combined signal W<sup>H</sup>(t−1)X(t), and that the error e(t) is calculated in step S<b>215</b> or step S<b>227</b>. As a result, when the phase error becomes greater than a predetermined value, the time required for convergence can be reduced with an increase in the convergence speed, and when the phase error becomes smaller than the predetermined value, the convergence stability can be enhanced with a fall in the rate at which the weight vector is adjusted.</p>
<p id="h-0016" num="0000">Adjusting Method 3</p>
<p id="p-0106" num="0132">The parameter control unit <b>71</b> judges that an adjusted weight is located closer to an optimal value than a reference value when an error e(t) becomes smaller than a predetermined value stored in the memory. At that time, the parameter control unit <b>71</b> changes an initial value of at least one of the forgetting coefficient λ, step size μ and frequency offset step size γ, so that the weight vector is adjusted at a lower rate. Here, the error e(t) is calculated in step S<b>215</b> or step S<b>227</b>. This being so, when the error e(t) is greater than a predetermined value, the time required for convergence can be reduced with an increase in the convergence speed, and when the error e(t) is smaller than the predetermined value, the convergence stability can be improved with a fall in the rate at which the weight vector is adjusted.</p>
<p id="h-0017" num="0000">Adjusting Method 4</p>
<p id="p-0107" num="0133">The parameter control unit <b>71</b> judges that an adjusted weight is not located closer to an optimal value than a reference value when a phase error of an error e(t) becomes greater than a predetermined value stored in the memory. At that time, the parameter control unit <b>71</b> changes an initial value of at least one of the forgetting coefficient λ, step size μ and frequency offset step size γ, so that the weight vector is adjusted at a higher rate. Note that the phase error refers to a difference between a phase component of a reference signal d(t) and a phase component of a combined signal W<sup>H</sup>(t−1)X(t), and that the error e(t) is calculated in step S<b>215</b> or step S<b>227</b>.</p>
<p id="h-0018" num="0000">Adjusting Method 5</p>
<p id="p-0108" num="0134">The parameter control unit <b>71</b> judges that an adjusted value is not located closer to an optimal value than a reference value when an error e(t) becomes greater than a predetermined value stored in the memory. At that time, the parameter control unit <b>71</b> changes an initial value of at least one of the forgetting coefficient λ, step size μ and frequency offset step size γ, so that the weight vector is adjusted at a higher rate. Here, the error e(t) is calculated in step S<b>215</b> or step S<b>227</b>.</p>
<p id="p-0109" num="0135">As described above, the wireless base station <b>100</b> in this embodiment uses a weight vector and a correlation matrix, which are obtained from a reception response vector of the preceding reception frame, as an initial value to adjust the weight vector, so that the adjusted weight vector converges on an optimal value in a shorter period of time. Also, the parameter control unit <b>71</b> adjusts parameters in accordance with how closer is an adjusted weight located, as described earlier, so that the weight vector converges on an optimal value in a shorter period of time without experiencing diffusion.</p>
<p id="h-0019" num="0000">Modifications</p>
<p id="p-0110" num="0136">Though the adaptive array apparatus of the present invention has been described based on the above embodiments, the invention should not be limited to such. For example, the following modifications are possible.</p>
<p id="h-0020" num="0000">(1) Initial Value</p>
<p id="p-0111" num="0137">In the above embodiments, initial values of both a correlation matrix and a weight vector are calculated, but either of them may be used single. For instance, only an initial value of the weight vector may be calculated as described above while using an identity unit multiplied by a particular constant as an initial value of the correlation matrix, which is a conventional method. Likewise, only an initial value of the correlation matrix may be calculated as described above while using 0 vector as an initial value of the weight vector, which is a conventional method. This is applicable not only to an adaptive array apparatus that operates under the MMSE standard but also to other algorithms for successive weight estimation.</p>
<p id="h-0021" num="0000">(2) Modification of an Initial Value of the Correlation Matrix</p>
<p id="p-0112" num="0138">It is known by experience that the convergence of weight vectors can be further improved (the convergence will become more easily achieved) by adding a predetermined value to diagonal elements of an initial value of a correlation matrix calculated by the correlation matrix operator <b>303</b>. An initial value of such adjusted correlation matrix may also be used.</p>
<p id="p-0113" num="0139"><figref idref="DRAWINGS">FIG. 5A</figref> shows one example of an initial value P(0) of a correlation matrix calculated by the correlation matrix operator <b>303</b>. <figref idref="DRAWINGS">FIG. 5B</figref> shows an initial value P′ (0) of the adjusted correlation matrix. As shown in <figref idref="DRAWINGS">FIG. 5B</figref>, a predetermined value 100 is added to the diagonal elements P<sub>11</sub>, P<sub>22</sub>, P<sub>33 </sub>and P<sub>44 </sub>of P′ (0).</p>
<p id="h-0022" num="0000">(3) LMS and RLS</p>
<p id="p-0114" num="0140">Though RLS algorithm is used to calculate a weight vector in the preamble section and LMS algorithm is used in the section following the preamble section in the above embodiment, the invention should not be limited to such. For instance, either RLS or LMS algorithm may be used single throughout a timeslot to calculate a weight vector. Using RLS algorithm throughout a timeslot to calculate a weight vector can be achieved by having reference signals generated, as in the case of the LMS algorithm, instead of reading pre-stored reference signals from the reference signal memory.</p>
<p id="h-0023" num="0000">(4) Calculation of a Reception Response Vector</p>
<p id="p-0115" num="0141">Though an ensemble average of a product of reception signals and user signals in the entire reception frame is used as a reception response vector in the above embodiment, the invention should not be limited to such. An ensemble average in a particular section, for example in the preamble section, may be used as a reception response vector. Also, the method for calculating a response vector should not be limited to such.</p>
<heading id="h-0024" level="1">INDUSTRIAL APPLICABILITY</heading>
<p id="p-0116" num="0142">The adaptive array apparatus of the present invention is suitable for a communication unit of a base station in a communication system.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An adaptive array apparatus that causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the adaptive array apparatus comprising:
<claim-text>judging means for judging whether an adjusted weight is located closer to the optimal value than a reference value, wherein the judging means judges that the adjusted weight is located closer to the optimal value than the reference value when the difference between the weighted signal and the desired signal becomes smaller than a predetermined value; and</claim-text>
<claim-text>changing means for changing a first step size in accordance with the judgment result of the judging means, the first step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations, wherein the changing means changes the first step size from a first value to a second value when the adjusted weight is judged to be located closer to the optimal value than the reference value, the second value corresponding to a lower rate at which the weight is adjusted than the first value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. An adaptive array apparatus that causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the adaptive array apparatus comprising:
<claim-text>judging means for judging whether an adjusted weight is located closer to the optimal value than a reference value, wherein the judging means judges that the adjusted weight is located closer to the optimal value than the reference value when a frequency offset converges at a lower rate than a predetermined value, the frequency offset being adjusted successively; and</claim-text>
<claim-text>changing means for changing a step size in accordance with the judgment result of the judging means, the step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations, wherein the changing means changes the step size from a first value to a second value when the adjusted weight is judged to be located closer to the optimal value than the reference value, the second value corresponding to a lower rate at which the weight is adjusted than the first value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The adaptive array apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the changing means also changes a second step size from a third value to a fourth value, the second step size being used to determine an extent to which the frequency offset should be adjusted, the fourth value corresponding to a lower rate at which the frequency offset should be adjusted than the third value.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The adaptive array apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the judging means judges that the adjusted weight is located closer to the optimal value than the reference value when a phase component of the difference becomes smaller than a phase component of the predetermined value.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The adaptive array apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>reception response vector calculating means for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD (Time Division Multiple Access/Time Division Duplex) reception and transmission cycle;</claim-text>
<claim-text>weight vector calculating means for calculating a weight vector of the immediately preceding reception timeslot from the reception response vector; and</claim-text>
<claim-text>initial value setting means for setting the weight vector of the immediately preceding reception timeslot, as an initial value for calculating a weight vector of a present reception timeslot.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The adaptive array apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>reception response vector calculating means for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD reception and transmission cycle;</claim-text>
<claim-text>correlation matrix calculating means for calculating a correlation matrix from the reception response vector; and</claim-text>
<claim-text>initial value setting means for setting the correlation matrix as an initial value for calculating a weight vector of a present reception timeslot.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The adaptive array apparatus of Claim <b>6</b>, further comprising:
<claim-text>weight vector calculating means for calculating a weight vector of the immediately preceding reception timeslot, based on the reception response vector,</claim-text>
<claim-text>wherein the initial value setting means also sets the weight vector of the immediately preceding reception timeslot as an initial value for calculating the weight vector of the present reception timeslot.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The adaptive array apparatus of Claim <b>6</b>,
<claim-text>wherein the initial value setting means sets an adjusted correlation matrix as an initial value instead of the correlation matrix, the adjusted correlation matrix being obtained by adding a predetermined value to diagonal elements of the correlation matrix.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The adaptive array apparatus of Claim <b>7</b>,
<claim-text>wherein the initial value setting means sets an adjusted correlation matrix as an initial value instead of the correlation matrix, the adjusted correlation matrix being obtained by adding a predetermined value to diagonal elements of the correlation matrix.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. An adaptive array method used in an adaptive array apparatus that causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the adaptive array method comprising:
<claim-text>a reception response vector calculating step for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD (Time Division Multiple Access/Time Division Duplex) reception and transmission cycle;</claim-text>
<claim-text>a weight vector calculating step for calculating a weight vector of the immediately preceding reception timeslot from the reception response vector;</claim-text>
<claim-text>an initial value setting step for setting the weight vector of the immediately preceding reception timeslot, as an initial value for calculating a weight vector of a present reception timeslot;</claim-text>
<claim-text>a judging step for judging whether an adjusted weight is located closer to the optimal value than a reference value; and</claim-text>
<claim-text>a changing step for changing a step size in accordance with the judgment result of the judging step, the step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. An adaptive array method used in an adaptive array apparatus that causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the adaptive array method comprising:
<claim-text>a reception response vector calculating step for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD (Time Division Multiple Access/Time Division Duplex) reception and transmission cycle;</claim-text>
<claim-text>a correlation matrix calculating step for calculating a correlation matrix from the reception response vector;</claim-text>
<claim-text>an initial value setting step for setting the correlation matrix as an initial value for calculating a weight vector of a present reception timeslot;</claim-text>
<claim-text>a judging step for judging whether an adjusted weight is located closer to the optimal value than a reference value; and</claim-text>
<claim-text>a changing step for changing a step size in accordance with the judgment result of the judging step, the step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A computer readable medium storing a program which when executed by a computer in an adaptive array apparatus causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the program comprising:
<claim-text>a reception response vector calculating step for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD (Time Division Multiple Access/Time Division Duplex) reception and transmission cycle;</claim-text>
<claim-text>a weight vector calculating step for calculating a weight vector of the immediately preceding reception timeslot from the reception response vector;</claim-text>
<claim-text>an initial value setting step for setting the weight vector of the immediately preceding reception timeslot, as an initial value for calculating a weight vector of a present reception timeslot;</claim-text>
<claim-text>a judging step for judging whether an adjusted weight is located closer to the optimal value than a reference value; and</claim-text>
<claim-text>a changing step for changing a step size in accordance with the judgment result of the judging step, the step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A computer readable medium storing a program which when executed by a computer in an adaptive array apparatus causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the program comprising:
<claim-text>a reception response vector calculating step for calculating a reception response vector of an immediately preceding reception timeslot in a TDMA/TDD (Time Division Multiple Access/Time Division Duplex) reception and transmission cycle;</claim-text>
<claim-text>a correlation matrix calculating step for calculating a correlation matrix from the reception response vector;</claim-text>
<claim-text>an initial value setting step for setting the correlation matrix, as an initial value for calculating a weight vector of a present reception timeslot;</claim-text>
<claim-text>a judging step for judging whether an adjusted weight is located closer to the optimal value than a reference value; and a changing step for changing a step size in accordance with the judgment result of the judging step, the step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. An adaptive array apparatus that causes a weight to converge on an optimal value, by repeatedly adjusting the weight using predetermined calculations so as to minimize a difference between a desired signal and a signal which is weighted using the weight, the adaptive array apparatus comprising:
<claim-text>judging means for judging, whether an adjusted weight is located closer to the optimal value than a reference value, wherein the judging means judges that the adjusted weight is located closer to the optimal value than the reference value when a number of times the weight is adjusted reaches twice a number of antennas; and</claim-text>
<claim-text>changing means for changing a first step size in accordance with the judgment result of the judging means, the first step size being used to determine an extent to which the weight should be adjusted in the predetermined calculations, wherein when the adjusted weight is judged to be located closer to the optimal value than the reference value, the changing means (a) changes the first step size from a first value to a second value, the second value corresponding to a lower rate at which the weight is adjusted than the first value, and (b) changes a second step size from a third value to a fourth value, the second step size being used to determine an extent to which a frequency offset should be adjusted, the fourth value corresponding to a lower rate at which the frequency offset should be adjusted than the third value.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
