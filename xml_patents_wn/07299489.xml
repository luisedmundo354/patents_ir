<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299489-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299489</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>09578633</doc-number>
<date>20000525</date>
</document-id>
</application-reference>
<us-application-series-code>09</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>02</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>06</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726  2</main-classification>
<further-classification>726  3</further-classification>
<further-classification>726  6</further-classification>
<further-classification>726 14</further-classification>
<further-classification>713168</further-classification>
<further-classification>713169</further-classification>
<further-classification>713161</further-classification>
<further-classification>709225</further-classification>
<further-classification>709224</further-classification>
</classification-national>
<invention-title id="d0e43">Method and apparatus for host probing</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6108782</doc-number>
<kind>A</kind>
<name>Fletcher et al.</name>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6182226</doc-number>
<kind>B1</kind>
<name>Reid et al.</name>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6205551</doc-number>
<kind>B1</kind>
<name>Grosse</name>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6212561</doc-number>
<kind>B1</kind>
<name>Sitaraman et al.</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709225</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6253337</doc-number>
<kind>B1</kind>
<name>Maloney et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714 38</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6298445</doc-number>
<kind>B1</kind>
<name>Shostack et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6321264</doc-number>
<kind>B1</kind>
<name>Fletcher et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709224</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6324585</doc-number>
<kind>B1</kind>
<name>Zhang et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709245</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6502135</doc-number>
<kind>B1</kind>
<name>Munger et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709225</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6546493</doc-number>
<kind>B1</kind>
<name>Magdych et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6654882</doc-number>
<kind>B1</kind>
<name>Froutan et al.</name>
<date>20031100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6658565</doc-number>
<kind>B1</kind>
<name>Gupta et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713153</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6725378</doc-number>
<kind>B1</kind>
<name>Schuba et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 13</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6826172</doc-number>
<kind>B1</kind>
<name>Augart</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370351</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2001/0050903</doc-number>
<kind>A1</kind>
<name>Vanlint</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370252</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>23</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713201</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>2</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Branigan</last-name>
<first-name>Steven</first-name>
<address>
<city>Tinton Falls</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Burch</last-name>
<first-name>Hal Joseph</first-name>
<address>
<city>Pittsburgh</city>
<state>PA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Cheswick</last-name>
<first-name>William R.</first-name>
<address>
<city>Bernardsville</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Dinella</last-name>
<first-name>Donald P.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Lucent Technologies Inc.</orgname>
<role>02</role>
<address>
<city>Murray Hill</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zia</last-name>
<first-name>Syed A.</first-name>
<department>2131</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method and apparatus for analyzing the perimeter security of communications networks. More particularly, information is identified which defines a particular communications network, e.g., an intranet, and identifying the connected hosts thereto. Utilizing such information, a determination is made with respect to identifying the routes that define the network. Utilizing the routing information, the connectivity of the hosts within the network, e.g., an intranet, is probed to ascertain the integrity of the network and thereby identifying potential security risks across the perimeter defense of the network.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="132.59mm" wi="161.12mm" file="US07299489-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="237.57mm" wi="181.10mm" file="US07299489-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="255.78mm" wi="179.32mm" file="US07299489-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates to communications network security and, more particularly, to verifying and analyzing the security measures employed in such networks.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Advances in communications technology and the availability of powerful desktop computer hardware has increased the use of computers to access a variety of publicly available computer networks. Today, a tremendous amount of information is exchanged between individual users located around the world via public computer networks, e.g., the well-known Internet. One class of users includes private individuals and professional users interconnected via a private network, e.g., a corporate intranet. The Internet, an expansive international public network of computer networks, is fast becoming an important source of information, electronic communications and electronic commerce for personal computer users in homes and businesses around the world. For example, a significant amount of information is available on a network called the World Wide Web (WWW) or the “Web”. The well-known WWW is a graphical subnetwork of the Internet. Essentially, the WWW is a collection of formatted hypertext pages located in numerous computers around the world that are logically connected by the Internet. Information, i.e., content, available on the Web is displayed in the form of so-called “web pages” which are accessed by user interface programs called “web browsers”. The increased exchange of information between private and public computer networks has presented a variety of critical security issues for the protection of information on private computer networks and the overall functionality of the private computer network itself.</p>
<p id="p-0004" num="0003">Computer network security, at a minimum, is directed to ensuring the reliable operation of computing and networking resources, and protecting information within the network from unauthorized disclosure or access. Various security threats exist which pose increasingly difficult challenges to such network security. In particular, some of the most sophisticated types of security threats are posed by programs which exploit certain vulnerabilities within network computing systems. To name a few, these program-related security threats include well-known logic bombs, trapdoors, trojan horses, viruses and worms. Such well-known software program threats either work independently (e.g., worms) to achieve their desired security breach, or require the invocation of a host program to be invoked to perform the desired disruptive actions (e.g., trapdoors, logic bombs, trojan horses or viruses.) Indeed, there are numerous well publicized accounts of such programs being used to improperly breach the security of private computer networks and cause severe damage. Such damage has included the destruction of electronic files, alteration of databases, or the disabling of the computer network itself or computer hardware connected to the affected network.</p>
<p id="p-0005" num="0004">Network administrators responsible for the operation of private computer networks employ a variety of security measures to protect the network from external security breaches such as the introduction of computer viruses. One technique uses so-called firewalls. This security scheme essentially places a separate computer system, i.e., the firewall, between the private network, e.g., corporate intranet, and the public network, e.g., the Internet. These firewalls are software-based gateways that are typically installed to protect computers on a local area network (“LAN”) from attacks by outsiders, i.e., unauthorized users. The firewall maintains control over communications from and to the private network. Essentially, the firewall imposes certain security measures on all users employing the private network. For example, firewalls may block access to new Internet services or sites on the WWW because the security consequences are unknown or not accounted for by the present firewall configuration. One potential installation configuration of a firewall is that WWW clients can no longer directly contact WWW servers. Typically, this proves too restrictive, and network administrators employ so-called “proxy servers”. Proxy servers are designed with certain features which provide for the forwarding of requests from WWW clients through the firewall thereby providing communication flow to and from servers on the Internet.</p>
<p id="p-0006" num="0005">However, network security problems are further exacerbated by the relative ease at which new host machines or new communications links can be added to access the Internet. In particular, in the context of well-known intranets such additional new host machines and/or links can be added without consultation with the network administrator or compliance with the communications security measures on the particular intranet. As will be appreciated, such intranet security risks are especially catastrophic in the context of corporate intranets which have become integral in the computing fabric of most major corporations. As such, host machines or communications channels added to the intranet which are unregistered or unrecognizable by the security shield of the network represent tremendous opportunities for so-called “attacks” by external, unauthorized parties, e.g., so-called “hackers”. Further, there exist numerous well publicized accounts of attacks launched by hackers who have improperly breached the security of private computer networks over the Internet and caused severe damage.</p>
<p id="p-0007" num="0006">For example, prevention of so-called “denial of service (DOS)” attacks is becoming increasingly important as the use of the Internet becomes pervasive and this expansive network is strategically placed in the critical path of many commercial applications, e.g., electronic commerce. As will be appreciated, DOS attacks are different than the security risks discussed above, e.g., viruses, in that DOS attacks are not primarily designed to damage computer files or misappropriate an innocent party's information, but rather, such DOS attacks are primarily launched to disable a particular Internet site from operating. Essentially, DOS attacks take advantage of the inherent communications design of the Internet, in particular, the feature that messages exchanged across the Internet or WWW are presumed valid and originating from valid sources. As such, attackers launching the DOS attack use this principle to their advantage to inundate a particular Internet site with messages thereby overloading the site's ability to respond and disabling the site from operating.</p>
<p id="p-0008" num="0007">To combat such network security risks, network administrators typically employ a variety of security measures to establish a so-called “self-defending network”. For example, well understood filtering techniques are employed as filtering tools on routers within a network that are used to limit the amount and type of Internet protocol messages allowed to be exchanged through the communications network at any one time. Further, so-called “reverse-address lookup” is employed on routers at the edge of a communications network, e.g., a specific company's communications network, to check outgoing traffic to ensure that such traffic originates from that particular network.</p>
<p id="p-0009" num="0008">Further, so-called “perimeter defenses” are employed to monitor communications networks. Essentially a perimeter defense consists of the deployment of limited connectivity to the Internet and other external networks coupled with protection of the deployed connections with firewalls. Such perimeter defenses prove very effective when used in conjunction with a limited number of hosts (e.g., 50) and are relatively straightforward to install and monitor. However, the scalability of a perimeter defense mechanism proves difficult when the number of host becomes large as is typical in the case of large size corporate intranets. This lack of scalability makes such networks employing perimeter defenses susceptible to security breaches in a variety of forms such as ad hoc links, unsecure hosts added to the network, misconfigured firewalls or connections, or “rogue” connections established without corporate security approval or detection. Thus, perimeter defenses while proving to be effective under certain circumstances and network configurations are still subject to failure and in not preventing security breaches in a variety of manners.</p>
<p id="p-0010" num="0009">A need exists therefore for improving the robustness of security measures and ensuring that network security features are universally configured throughout a communications network.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">An aspect of the present invention is directed to analyzing the security of communications networks. More particularly, in accordance with an aspect of the invention, information is identified which defines a particular communications network, e.g., an intranet, and identifying the connected hosts thereto. Utilizing such information, a determination is made with respect to identifying the routes that define the network. Utilizing the routing information, in accordance with an aspect of the invention, the connectivity of the hosts within the network, e.g., an intranet, is probed to ascertain the integrity of the network and thereby identifying potential security risks across the perimeter defense of the network.</p>
<p id="p-0012" num="0011">In accordance with the preferred embodiment of the invention, the perimeter of a intranet is analyzed and potential security holes are identified by (i) determining the routes which define the intranet; (ii) performing a census of the hosts defining the intranet; (iii) probing, as a function of the census results, the connectivity of particular hosts to analyze the overall connectivity of such host thereby identifying potential security risks across the perimeter defense of the intranet.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> a flowchart of illustrative operations for analyzing the security of communications networks in accordance with the principles of the invention;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> shows an illustrative communications network arrangement for analyzing network security in accordance the illustrative operations of <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of illustrative operations for probing host connectivity as shown in <figref idref="DRAWINGS">FIG. 1</figref>; and</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 4</figref> shows illustrative results from analyzing the security of a corporate intranet in accordance the principles of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0017" num="0016">Throughout this disclosure, unless otherwise noted, like elements, blocks, components or sections in the figures are denoted by the same reference designations.</p>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0018" num="0017">An aspect of the present invention is directed to analyzing the security of communications networks. More particularly, in accordance with an aspect of the invention, information is identified which defines a particular communications network, e.g., an intranet, and identifying the connected hosts thereto. Utilizing such information, a determination is made with respect to identifying the routes that define the network. Utilizing the routing information, in accordance with an aspect of the invention, the connectivity of the hosts within the network, e.g., an intranet, is probed to ascertain the integrity of the network and thereby identifying potential security risks across the perimeter defense of the network.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> a flowchart of illustrative operations <b>100</b> for analyzing the security of communications networks in accordance with the principles of the invention. More particularly, in accordance with the preferred embodiment, routes which define the communications networks (see, <figref idref="DRAWINGS">FIG. 1</figref>, block <b>110</b>) are identified and verified. For example, as will be appreciated an intranet may be composed of at least four types of networks: (1) networks that are directly attached to the Internet; (2) Demilitarized Zone Networks (DMZ networks) which provide limited function, high security connections between the Internet and specific intranets; (3) networks that are protected by firewalls; and (4) direct network connections with external third party networks.</p>
<p id="p-0020" num="0019">As such, the intranet is operationally defined by the core routes that are distributed by the so-called backbone routers of the network, e.g., a corporate network, in which the intranet resides. For example, in a corporate network, the core routes may be distributed throughout the corporation via the well-known Open Shortest Path First (OSPF) routing protocol for communicating routing changes. As such, the core routes inform internal routers with respect to routes that are “reachable” in the internal network, and which routes are not available on the intranet. Therefore, when a destination is requested that is not advertised (i.e., reachable) by the intranet, it will be forwarded to a default route. For example, in a corporate intranet, such a default route may be to the Internet through a corporate firewall. In such an illustrative case, where the Internet is the default route, it is critical that the internal routing definition completely identify all internal routes to preserve the separation between the intranet and the Internet. Two possible failure modes in such circumstances are routing so-called “black holes” which are a range of addresses that are unreadable by the intranet, and routing so-called “leaks” to the intranet which are routes from the intranet to other networks (including, but not limited to, the Internet) that bypass the perimeter. Corporate backbone routers, through the intranet definition and firewalls, define the separation of the intranet from the Internet.</p>
<p id="p-0021" num="0020">In accordance with the preferred embodiment of the invention, identification and verification of the intranet routes (see, <figref idref="DRAWINGS">FIG. 1</figref>, block <b>110</b>) leads to the identification of the hosts, i.e. computers, in the communications network (see, <figref idref="DRAWINGS">FIG. 1</figref>, block <b>120</b>) which is illustratively accomplished by (i) looking up so-called “announced” routes in publicly available route ownership databases to determine network ownership, i.e., ownership of the announced networks; (ii) checking for internally-announced routes that are also present in the Internet's list of announced routes; (iii) executing a conventional traceroute-like program to each announced network and collecting a listing of interior routers; and (iv) pinging the interior routers to obtain a list of routers known to each of the interior routers. The result of performing the aforementioned operations, in accordance with an embodiment of the invention, results in an output file of Classless Inter Domain Routing (CIDR) (a well-known mechanism for defining subnetworks) defining the intranet under consideration.</p>
<p id="p-0022" num="0021">In looking up the announced routes, i.e., a group of IP addresses that are available via a particular router, to determine announced network ownership in accordance with the preferred embodiment, certain publicly available route ownership databases are employed as available from: the Route Arbiter Database (RADB), MCI Inc., Canet, RIPE and ANS routing information database, “whois.arin.net” for systems registered in the Americas, “whois.apnic.net” for systems registered in the Asia Pacific region, “whois.nic.ad.jp” for systems registered in Japan, “whois.aunic.net” for systems registered in Australia, and “whois.ripe.net” for systems registered in Europe, Africa and the Middle East.</p>
<p id="p-0023" num="0022">Having identified the routes and hosts which define the communications network under study, e.g., intranet, a census is performed on the hosts (see, <figref idref="DRAWINGS">FIG. 1</figref>, block <b>130</b>) of such network to establish and verify the overall size, i.e., topology, of the network itself. That is, a census is performed to count the number of systems active on the network. In accordance with an embodiment of the invention, the census is performed by (i) pinging all possible IP addresses derived from the route list, e.g., intranet route list as described above, and also probing the host located on the intranet; (ii) performing well understood DNS lookups of all the internal hosts identified in the route list; and (iii) performing further DNS lookups originating from an interface to the Internet to identify hosts internal to the intranet that are overtly exposed outside the intranet or systems that are directly connected to the Internet without firewall protection.</p>
<p id="p-0024" num="0023">Utilizing the communications network definition gathered as detailed above, the perimeter security of the network is determined, in accordance with the preferred embodiment of the invention, by probing the connectivity (see, <figref idref="DRAWINGS">FIG. 1</figref>, block <b>140</b>) of the network. That is, in accordance with an aspect of the invention, analysis of the network identifies overt penetrations of intranet perimeter and security measures thereof. For example, so-called “dual-homed hosts” can present significant security risks to a communications network. As will be appreciated, a dual-home host is a host that serves connections with a public network, e.g., the Internet, and a private network, e.g., corporate intranet. For example, a telecommuting employee of a company working at home may have a simultaneous open connection to the Internet and a virtual private network connection to the corporate intranet. As will be appreciated, such dual-homed hosts present significant security risks in such an illustrative arrangement because such hosts provide a way to bypass the security measures provided by the firewall.</p>
<p id="p-0025" num="0024">As discussed above, an aspect of the present invention is directed to analyzing the security of communications networks. More particularly, in accordance with an aspect of the invention, information is identified which defines a particular communications network, e.g., an intranet, and identifying the connected hosts thereto. Utilizing such information, a determination is made with respect to identifying the routes that define the network. Utilizing the routing information, in accordance with an aspect of the invention, the connectivity of certain hosts within the network, e.g., an intranet, is probed to ascertain the integrity of the network and thereby identifying potential security risks across the perimeter defense of the network. Thus, by probing the connectivity (see, <figref idref="DRAWINGS">FIG. 1</figref>, block <b>140</b>) of such hosts within the network, in accordance with an aspect of the invention, an analysis of the network can be made to identify potential security risks.</p>
<p id="p-0026" num="0025">More particularly, turning our attention to <figref idref="DRAWINGS">FIG. 2</figref> and <figref idref="DRAWINGS">FIG. 3</figref>, <figref idref="DRAWINGS">FIG. 2</figref> shows an illustrative communications network arrangement <b>200</b> for analyzing network security in accordance the preferred embodiment of the invention, and <figref idref="DRAWINGS">FIG. 3</figref> is a flowchart of illustrative operations <b>300</b> further detailing the probing of host connectivity as described above (i.e., <figref idref="DRAWINGS">FIG. 1</figref>, block <b>140</b>). The illustrative communications network arrangement <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> includes intranet <b>205</b> which may be a corporate intranet consisting of a number of host computers, e.g., host <b>220</b>, <b>225</b> <b>230</b> and <b>235</b>, respectively. Such hosts may have, inter alia., authorized access to Internet <b>210</b> (e.g., across communications channel <b>240</b>) or may present security risks if any such host is not configured in accordance with the security parameters of intranet <b>205</b>. As detailed above, the identification of such potential security risks is an important aspect of the present invention. For example, using the results of the census conducted in accordance with the preferred embodiment of the invention, the IP address of a particular test host (i.e., a computer which will be examined for proper security configuration and alternatively referred to herein as “the probed host”) is identified (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>310</b>). For example, IP address <b>225</b>-<b>1</b> (TH<sub>IP</sub>) of test host <b>225</b> of intranet <b>205</b> is identified in the census as a host machine which will be examined in accordance with the principles of the invention. As will be understood, host <b>220</b> having IP address <b>220</b>-<b>1</b> (H<sub>IP</sub>) could also be the test host under examination. Thus, the security of test host <b>225</b> will be examined in accordance with an aspect of the invention to determine whether this host is a potential security risk to intranet <b>205</b> thereby also providing an indication with respect to the security of the entire topology of the network.</p>
<p id="p-0027" num="0026">More particularly, in accordance with this embodiment of the invention, the IP address of the test host, e.g., test host <b>225</b>, is determined from the census results gathered with respect to the network, e.g., intranet <b>205</b>. That is, in accordance with an aspect of the invention, a so-called “spoofed probe packet” is generated (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>320</b>) as a function of the test host IP address (e.g., test host IP address <b>225</b>-<b>1</b>) and the IP address of a so-called collector host. The collector host of the current embodiment is a host machine configured for use in the security examination with respect to the test host as is further discussed below. The spoofed probe packet, in accordance with an embodiment of the invention, includes a return address to the collector host within the external network. In accordance with an aspect of the invention, the probe packet includes at least a source address which is determined as a function of the topology of the network. That is, the source address is selected using the topology to select a source address (and an associated host) which is external to that of the test host's network. The probe packet is said to be “spoofed” because the supplied originator address of the packet is false or derived, i.e., does not originate from an actual host request. As will appreciated, the spoofed probe packets can be configured in a variety of protocols for applying the various security aspects of the invention in a variety of network configurations. For example, the spoofed probe packet of the preferred embodiment of the invention may be configured as a TCP probe packet or a UDP probe packet depending upon, e.g., the firewall policies of the network under study.</p>
<p id="p-0028" num="0027">In this way, if it can be shown that the spoofed probe packet reaches the probed host this will identify a potential unsecure and/or “rogue” connection between the intranet, i.e., the probe host, and the Internet, i.e., the collector host. More particularly, if in response to receipt of the spoofed packet by test host <b>225</b> the actions of test host <b>225</b> are monitored (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>330</b>). Such monitoring includes determining whether test host <b>225</b> thereafter transmits, in response to receipt of spoofed packet <b>245</b>, regular packet <b>255</b> to security host <b>235</b> (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>340</b>). As will be appreciated regular packet <b>255</b> is a packet generated in the normal course of transmission, for example, a well-known Internet Control Message Protocol (ICMP) echo request packet. In accordance with the preferred embodiment, the collector host is another host machine, e.g., security host <b>235</b>, to which the spoofed packet will be addressed. As such, regular packet <b>255</b> includes a return IP address to test host <b>225</b>, i.e., IP address <b>225</b>-<b>1</b> and IP address <b>235</b>-<b>1</b> (SH<b>2</b><sub>IP</sub>) of security host <b>235</b>. Of course, if no packet is transmitted across communications link <b>260</b> upon receipt of spoofed packet <b>245</b> at test host <b>225</b> this serves as confirmation that the security measures of intranet <b>205</b> are functioning properly and that the integrity of test host (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>370</b>) is sound.</p>
<p id="p-0029" num="0028">In contrast, transmission of regular packet <b>255</b> across communications link <b>260</b> through Internet <b>210</b> is indicative of a potential security risk (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>350</b>) and a notification of such a security risk is generated and sent to the security administrator (see, <figref idref="DRAWINGS">FIG. 3</figref>, block <b>360</b>). In particular, link <b>260</b> may not be an authorized external connection recognized by the security measures of intranet <b>205</b> thereby potentially subjecting the entire corporate network to catastrophic failure from attacks across Internet <b>210</b>. As will be appreciated, the notifications to the security administrator can be in a variety of forms, electronic or otherwise.</p>
<p id="p-0030" num="0029">The illustrative embodiment discussed above is directed to a determination of the security of a test host from an internal to external perspective. That is, the probe packet transmitted (e.g., spoofed packet <b>245</b>), in accordance with an aspect of the invention, is generated internally to intranet <b>205</b>. In accordance with a further embodiment of the invention, the security of a test host is further determined from an external to internal perspective. More particularly, security host <b>235</b> generates a probe packet, e.g. spoofed packet <b>265</b>, to IP address of <b>225</b>-<b>1</b> of test host <b>225</b> with the spoofed return address, i.e., IP address <b>230</b>-<b>1</b> (SH<b>1</b><sub>IP</sub>) of security host <b>230</b>. In this further embodiment of the invention, security host <b>230</b> serves as the collector host. Thus, as before, the generation and transmission of regular packet <b>270</b> by test host <b>225</b> upon receipt of spoofed packet <b>265</b> is an indication of a potential security risk. That is, communications link <b>275</b> which carried spoofed packet <b>265</b> from the external network, i.e., Internet <b>210</b>, to the internal network, i.e., intranet <b>205</b>, may not be an authorized external connection recognized by the security measures (e.g., the firewall) of intranet <b>205</b>. Thus, in accordance with an aspect of the invention, the potential security risk is identified to the security administrator of the network.</p>
<p id="p-0031" num="0030">For example, <figref idref="DRAWINGS">FIG. 4</figref> shows illustrative results <b>400</b> from analyzing the security of a portion of a particular corporate intranet in accordance the principles of the invention. In particular, perimeter security results <b>400</b> show results for three different host machines, i.e., host results <b>410</b>, host results <b>420</b> and host results <b>430</b>, respectively. For example, probe test <b>410</b>-<b>1</b> revealed that the operation “iad <b>2</b>” <b>440</b> executed service “BBN IAD” service <b>450</b> thereby presenting a potential security. Similarly, probe <b>420</b>-<b>1</b> revealed that operation “exec” <b>460</b> executed service “remote process execution” <b>470</b> also presenting a potential security risk due to the fact that such service is a commonly exploited network service.</p>
<p id="p-0032" num="0031">As detailed above, the present invention can be embodied in the form of methods and apparatuses for practicing those methods. The invention can also be embodied in the form of program code embodied in tangible media, such as floppy diskettes, CD-ROMs, hard drives, or any other machine-readable storage medium, wherein, when the program code is loaded into and executed by a machine, such as a computer, the machine becomes an apparatus for practicing the invention. The invention can also be embodied in the form of program code, for example, in a storage medium, loaded into and/or executed by a machine, or transmitted over some transmission medium, such as over electrical wiring or cabling, through fiber optics, or via electromagnetic radiation, wherein, when the program code is loaded into and executed by a machine, such as a computer, the machine becomes an apparatus for practicing the invention. When implemented on a general-purpose processor, the program code segments combine with the processor to provide a unique device that operates analogously to specific logic circuits.</p>
<p id="p-0033" num="0032">Furthermore, all examples and conditional language recited herein are principally intended expressly to be only for pedagogical purposes to aid the reader in understanding the principles of the invention and the concepts contributed by the Applicants to furthering the art, and are to be construed as being without limitation to such specifically recited examples and conditions. Moreover, all statements herein reciting principles, aspects, and embodiments of the invention, as well as specific examples thereof, are intended to encompass both structural and functional equivalents thereof. Additionally, it is intended that such equivalents include both currently known equivalents as well as equivalents developed in the future, i.e., any elements developed that perform the same function, regardless of structure.</p>
<p id="p-0034" num="0033">Thus, for example, it will be appreciated by those skilled in the art that the block diagrams herein represent conceptual views of illustrative circuitry embodying the principles of the invention. Similarly, it will be appreciated that any flowcharts, flow diagrams, state transition diagrams, pseudocode, program code, and the like represent various processes which may be substantially represented in computer readable medium and so executed by a computer, machine, or processor, whether or not such computer, machine, or processor, is explicitly shown.</p>
<p id="p-0035" num="0034">The foregoing merely illustrates the principles of the present invention. It will thus be appreciated that those skilled in the art will be able to devise various arrangements which, although not explicitly described or shown herein, embody the principles of the invention and are included within its spirit and scope.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A communications network security method for ascertaining the integrity of a first communications network and identifying potential security risks across a perimeter of the first communications network, the method comprising:
<claim-text>identifying a plurality of routes that define the first communications network;</claim-text>
<claim-text>identifying a plurality of hosts associated with the first communications network as a function of the plurality of routes;</claim-text>
<claim-text>receiving a census of the first communications network as a function of the plurality of hosts to determine a topology of the first communications network;</claim-text>
<claim-text>probing at least one first host of the plurality hosts of the first communications network by generating and transmitting a packet to the first host, the first host being selected from the census results and the packet having at least a source address of a second host which is associated with a second communications network, wherein the source address is selected independent of any request from the second host to the first host; and</claim-text>
<claim-text>determining a security characteristic of the probed first host as a function of a response by the probed first host in receiving the packet, the security characteristic being a measure of connectivity between the first communications network and the second communications network, the measure of connectivity being an indication of connectivity between the first communications network and the second communications network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the source address of the second host is a return IP address external to the first communications network.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the response of the probed first host to the receipt of the packet includes transmitting a second packet, the second packet being derived using at least a portion of information from the received packet.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the measure of connectivity is determined by the further operation of:
<claim-text>monitoring the probed first host to determine the response, and if the response includes a transmission of a second packet from the probed first host to the second host at the return IP address, generating a security alert message identifying the probed first host as a security risk.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the first communications network and the second communications network have different security levels.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the transmitted packet is a TCP packet which returns a TCP packet in response thereto.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein the second packet is a UDP packet or an ICMP packet, which returns either a UDP packet or ICMP packet in response thereto.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method for analyzing network security across a perimeter of a first communications network utilizing a security host, the method comprising:
<claim-text>receiving a census of the first communications network;</claim-text>
<claim-text>generating and transmitting, from the security host, a packet associated with a host of a second communications network to a particular one host of a plurality of hosts internal to the first communications network, the internal host being selected from the census, and the packet having an IP source address associated with the host of the second communications network, wherein the IP source address is selected independent of any request from the host of the second communications network to the internal host of the first communications network; and</claim-text>
<claim-text>determining a security characteristic of the particular one internal host of the first communications network as a function of a response by the internal host to the receipt of the packet, the security characteristic being a measure of connectivity between the first communications network and the second communications network, the measure of connectivity being an indication of connectivity between the first communications network and the second communications network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the measure of connectivity is a function of whether the internal host of the first communications network communicates with the host of the second communications network, and the measure of connectivity being determined by the further operation of:
<claim-text>monitoring the internal host to determine the response, and if the response includes a transmission of a second packet, utilizing the IP source address, from the internal host to the host of the second communications network, generating a security alert message identifying the internal host as a security risk.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the second packet is derived using at least a portion of information from the transmitted packet.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein the internal host is a dual-homed host.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the security characteristic includes an indication that the internal host is outside any security measures provided by a firewall associated with the first communications network.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A communications system for ascertaining the integrity of a first communications network and identifying potential security risks across a perimeter of the first communications network, the communications system comprising:
<claim-text>a first plurality of computers associated with the first communications network;</claim-text>
<claim-text>a second plurality of computers associated with a second communications network; and</claim-text>
<claim-text>a security host computer which determines a security characteristic of a first computer from the first plurality of computers, the security characteristic being a measure of connectivity between the first communications network and the second communications network by probing the first computer by generating and transmitting a packet to the first computer, the first computer being selected from a census of the first communications network and the packet being generated as a function of both an IP source address associated with a second computer of the second plurality of computers, wherein said IP source address is selected independent of any request from the second computer to the first computer, and an IP address associated with the first computer, and determining the measure of connectivity as a function of a response of the first computer to receiving the packet, the measure of connectivity being an indication of connectivity between the first communications network and the second communications network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The communications system of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the security host computer is associated with the first communications network.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The communications system of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the response of the first computer to the receipt of the packet includes transmitting a second packet, the second packet being derived using at least a portion of information from the received packet.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The communications system of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein the security host computer determines the measure of connectivity by monitoring the probed first computer to determine the response, and if the response includes the transmission of the second packet from the probed host, generating a security alert message identifying the first computer as a security risk.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The communications system of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the first communications network is an intranet and the second communications network is an Internet, and the first communications network and the second communications network have different security levels.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A security host computer for ascertaining the integrity of a first communications network and identifying potential security risks across a perimeter of the first communications network, the security host computer comprising:
<claim-text>means for performing a census of the first communications network and determining a topology of the first communications network, the topology being defined by at least one computer,</claim-text>
<claim-text>means for probing the at least one computer by generating and transmitting a packet to the computer, the computer being selected from the census results and the packet being generated as a function of (i) the topology, (ii) an IP source address associated with a particular host computer associated with a second communications network, wherein the IP source address is selected independent of any request from the second computer to the first computer, and (iii) an IP address associated with the computer, die second communications network being separate from the first communications network; and</claim-text>
<claim-text>a monitor for determining a security level of the computer as a function of a response by the computer to the receipt of the packet, and the security level being a measure of connectivity between the first communications network and the second communications network, the measure of connectivity being an indication of connectivity between the first communications network and the second communications network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The security host computer of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the measure of connectivity is determined by monitoring the computer's response, and if the response includes a transmission of a second packet, utilizing the IP source address, from the computer, a security alert message identifying the computer as a security risk is generated.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The security host computer of <claim-ref idref="CLM-00019">claim 19</claim-ref> wherein the first communications network and the second communications network have different security levels.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A machine-readable medium having stored thereon a plurality of instructions, the plurality of instructions including instructions that, when executed by a machine, cause the machine to perform of a method for analyzing a first communications network's integrity and identifying potential security risks across a perimeter of the first communications network by receiving a census of the first communications network; probing a first host of the first communications network by generating and transmitting a packet to the first host, the host being selected from the census results and the packet being derived as a function of a topology of the first communications network and the packet having a source address which is associated with a second host of a second communications network, wherein the source address is selected independent of any request from the second host to the first host; and determining the first communications network's integrity as a function of a response by the probed host in receiving the packet wherein the response indicates a measure of connectivity between the first communications network communicates and the second communications network, and the measure of connectivity being an indication of connectivity between the first communications network and the second communications network.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The machine-readable medium of <claim-ref idref="CLM-00021">claim 21</claim-ref> wherein the response of the probed first host to the receipt of the packet includes transmitting a second packet, the second packet being derived using at least a portion of information from the received packet.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The machine-readable medium of <claim-ref idref="CLM-00022">claim 22</claim-ref> wherein the first communications network is an intranet, and the second communications network is an Internet.</claim-text>
</claim>
</claims>
</us-patent-grant>
