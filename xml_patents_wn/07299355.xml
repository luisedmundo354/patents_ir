<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299355-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299355</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10042019</doc-number>
<date>20020108</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>759</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>K</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713168</main-classification>
<further-classification>380 28</further-classification>
<further-classification>380 30</further-classification>
<further-classification>380229</further-classification>
<further-classification>380232</further-classification>
<further-classification>708710</further-classification>
<further-classification>708711</further-classification>
<further-classification>708712</further-classification>
<further-classification>708252</further-classification>
</classification-national>
<invention-title id="d0e53">Fast SHA1 implementation</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5276635</doc-number>
<kind>A</kind>
<name>Naini et al.</name>
<date>19940100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708713</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5297206</doc-number>
<kind>A</kind>
<name>Orton</name>
<date>19940300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5299319</doc-number>
<kind>A</kind>
<name>Vassiliadis et al.</name>
<date>19940300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>712221</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5375081</doc-number>
<kind>A</kind>
<name>Anderson</name>
<date>19941200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708712</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5548544</doc-number>
<kind>A</kind>
<name>Matheny et al.</name>
<date>19960800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708497</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5796836</doc-number>
<kind>A</kind>
<name>Markham</name>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>5870474</doc-number>
<kind>A</kind>
<name>Wasilewski et al.</name>
<date>19990200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>5877973</doc-number>
<kind>A</kind>
<name>Kato et al.</name>
<date>19990300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708711</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>5936967</doc-number>
<kind>A</kind>
<name>Baldwin et al.</name>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>5940877</doc-number>
<kind>A</kind>
<name>Eickemeyer et al.</name>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711220</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>5943338</doc-number>
<kind>A</kind>
<name>Duclose et al.</name>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>5951631</doc-number>
<kind>A</kind>
<name>Hwang</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708710</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6111858</doc-number>
<kind>A</kind>
<name>Greaves et al.</name>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6216167</doc-number>
<kind>B1</kind>
<name>Momirov</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6304657</doc-number>
<kind>B1</kind>
<name>Yokota et al.</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380 28</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6334190</doc-number>
<kind>B1</kind>
<name>Silverbrook et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713500</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>2001/0021253</doc-number>
<kind>A1</kind>
<name>Furuya et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380259</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2003/0145033</doc-number>
<kind>A1</kind>
<name>Bradley et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708710</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>WO</country>
<doc-number>WO 01/80483</doc-number>
<kind>A</kind>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Sait, S.M.; Farooqui, A.A.; Beckhoff, G.F.; A novel technique for fast multiplication, Computers and Communications, Conference Proceedings of the 1995 IEEE Fourteenth Annual International Phoenix Conference on Mar. 28-31, 1995 pp. 109-114.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Hao-Yung Lo; Sha-Fen Ling; Chun-Ming Shie; A high-speed of self-timing carry-completion for direct two's complement multipliers, Circuits and Systems IEEE APCCAS 1998. The 1998 IEEE Asia-Pacific Conference on Nov. 24-27, 1998 pp. 643-646.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00022">
<othercit>Ragab, A.H.M.; Ismail, N.A.; Allah, O.S.F.; An efficient message digest algorithm (MD) for data security, Electrical and Electronic Technology, TENCON. Proceedings of IEEE Region 10 international Conference on vol. 1, Aug. 19-22, 2001 pp. 191-197.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00023">
<othercit>Deepakumara, J.; Heys, H.M.; Venkatesan, R.; FPGA implementation of MD5 hash algorithm Electrical and Computer Engineering, 2001. Canadian Conference on May 13-16, 2001 pp. 919-924 vol. 2.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00024">
<othercit>Yong Kyu Kang, Dae Won Kim, Taek Won Kwon, and Jun Rim Choi; “An Efficient Implementation of Hash Function Processor for IPSEC”; ACM 2000; pp. 1-4.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>Ravichandran Ramachandran and Shih-Lien Lu; “Carry Logic”; 1999 by John Wiley &amp; Sons, Inc; pp. 49-54.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00026">
<othercit>“Applied Cryptography, Second Edition”, Schneider, B., 1996, John Wiley &amp; Sons, New York, XP002184521, cited in the application, p. 442, paragraph 18.7—p. 445.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00027">
<othercit>“SHA: The Secure Hash Algorithm Putting Message Digests to Work”, Stallings, W., Dr. Dobbs Journal, Redwood City, CA, Apr. 1, 1994, p. 32-34, XP000570561.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00028">
<othercit>Schneier B, “Applied Cryptography, Second Edition”, 1996, John Wiley &amp; Sons, New York US XP002184521, pp. 436-445.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00029">
<othercit>Stallings W., “SHA: The Secure Hash Algorithm Putting Message Digests to Work”, Dr. Dobbs Journal, Redwood City, CA, US, Apr. 1, 1994, XP00570561, p. 32-33.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00030">
<othercit>Analog Devices: “ADSP2141 SafeNetDPS User's Manual, Revision 6” Analog Devices Technical Specifications, Mar. 2000, XP002163401, 87 Pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00031">
<othercit>C. Madson, R. Glenn: “RFC 2403- The Use of HMAC-MD5-96 within ESP and AH”, IETF Request for Comments, Nov. 1998, XP002163402, Retrieved from Internet on Mar. 20, 2001, http://www.faqs.org/rfcs/frc2403.html, 87 Pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00032">
<othercit>S. Kent, R. Atkinson: “RFC 2406-IP Encapsulating Security Payload (ESP)” IETF Request for Comments, Nov. 1998, XP002163400, Retrieved from the Internet on Mar. 20, 2001, http://www.faqs.org/rfcs/frc2406.html, 5 Pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00033">
<othercit>Keromytis, et al., “Implementing IPsec”, Global Telecommunications Conference (Globecom), IEEE, Nov. 3, 1997, pp. 1948-1952.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00034">
<othercit>Pierson, et al., “Context-Agile Encryption for High Speed Communication Networks”, Computer Communications Review, Association for Computing Machinery, vol. 29, No. 1, Jan. 1999, pp. 35-49.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00035">
<othercit>Sholander, et al., “The Effect of Algorithm-Agile Encryption on ATM Quality of Service”, Global Telecommunications Conference (Globecom), IEEE, Nov. 3, 1997, pp. 470-474.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00036">
<othercit>Smirni, et al., “Evaluation of Multiprocessor Allocation Policies,” Technical Report, Vanderbilt University, Online, 1993, pp. 1-21.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00037">
<othercit>Tarman, et al., “Algorithm-Agile Encryption in ATM Networks”, IEEE Computer, Sep. 1998, vol. 31, No. 1, pp. 57-64.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00038">
<othercit>Wassal, et al., “A VLSI Architecture for ATM Algorithm-Agile Encryption”, Proceedings Ninth Great Lakes Symposium on VLSI, Mar. 4-6, 1999, pp. 325-328.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00039">
<othercit>Analog Devices: “Analog Devices and IRE Announce First DSP-Based Internet Security System-On-A-Chip”, Analog Devices Press Release, Online, Jan. 19, 1999, pp. 1-3. http://content.analog.com/pressrelease/prdisplay/0,1622,16,00.html.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00040">
<othercit>3Com: “3Com Launces New Era of Network Connectivity”, 3Com Press Release, Jun. 14, 1999, pp. 1-3.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00041">
<othercit>“Secure Products VMS115”, VLSI Technology, Inc., Printed in USA, Document Control: VMS115, VI, 0, Jan. 99, pp. 1-2.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00042">
<othercit>“VMS115 Data Sheet”, VLSI Technology, Inc., a subsidiary of Philips Semiconductors, Revision 2:3, Aug. 10, 1999, pp. 1-64.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00043">
<othercit>“Data Sheet 7751 Encryption Processor”, Network Security Processors, Jun. 1999, pp. 1-84.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00044">
<othercit>Senie, D., “NAT Friendly Application Design Guidelines”, Amaranth Networks, Inc., NAT Working Group, Internet-Draft, Sep. 1999, pp. 1-7.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00045">
<othercit>Floyd, Sally, et al., “Random Early Detection Gateways for Congestion Avoidance”, Lawrence Berkeley Laboratory, University of California, IEEE/ACM Transactions on Networking, Aug. 1993, pp. 1-32.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00046">
<othercit>Egevang, K., et al., “The IP Network Address Translator (NAT)”, Network Working Group, May 1994, pp. 1-10.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00047">
<othercit>Pall, G. S., et al., “Microsoft Point-To-Point Encryption (MPPE) Protocol”, Microsoft Corporation, Network Working Group, Internet Draft, Oct. 1999, pp. 1-12.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00048">
<othercit>Deutsch, P., “DEFLATE Compressed Data Format Specification Version 1.3”, Aladdin Enterprises, Network Working Group, May 1996, pp. 1-17.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00049">
<othercit>Kent, S., “IP Authentication Header”, Network Working Group, Nov. 1998, pp. 1-22.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00050">
<othercit>Kent, S., et al., “IP Encapsulating Security Payload (ESP)”, Network Working Group, Nov. 1998, pp. 1-22.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00051">
<othercit>Maughan, D, et al., “Internet Security Association and Key Management Protocol (ISAKMP)”, Network Working Group, Nov. 1998, pp. 1-20.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00052">
<othercit>Harkins, D., et al., “The Internet Key Exchange (IKE)”, Cisco Systems, Network Working Group, Nov. 1998, pp. 1-12.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00053">
<othercit>Srisuresh, P., “Security Model with Tunnel-mode Ipsec for NAT Domains”, Lucent Technologies, Network Working Group, Oct. 1999, pp. 1-11.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00054">
<othercit>Shenker, S., “Specification of Guaranteed Quality of Service”, Network Working Group, Sep. 1997, pp. 1-20.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00055">
<othercit>Srisuresh, P., et al., “IP Network Address Translator (NAT) Terminology and Considerations”, Lucent Technologies, Network Working Group, Aug. 1999, pp. 1-30.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00056">
<othercit>Kent, S., et al., “Security Architecture for the Internet Protocol”, Network Working Group, Nov. 1998, pp. 1-66.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00057">
<othercit>“Compression for Broadband Data Communications”, BlueSteel Networks, Inc., Sep. 8, 1999, pp. 1-9.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00058">
<othercit>“Securing and Accelerating e-Commerce Transactions”, BlueSteel Networks, Inc., Revision 2.0, Oct. 20, 1999, pp. 1-7.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00059">
<othercit>“Securing Broadband Communications” BlueSteel Networks, Inc., Sep. 8, 1999, pp. 1-10.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00060">
<othercit>R. Sedgewick, “Algorithms in C—Third Edition”, 1998, Addison Wesley XP002163543, pp. 573-608.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>24</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713200</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 28</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 30</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380229</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>708710</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>708711</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>708712</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>708524</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>708252</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60261425</doc-number>
<kind>00</kind>
<date>20010112</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20020184498</doc-number>
<kind>A1</kind>
<date>20021205</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Qi</last-name>
<first-name>Zheng</first-name>
<address>
<city>Milpitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Sterne Kessler Goldstein &amp; Fox, P.L.L.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Broadcom Corporation</orgname>
<role>02</role>
<address>
<city>Irvine</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Moazzami</last-name>
<first-name>Nasser</first-name>
<department>2136</department>
</primary-examiner>
<assistant-examiner>
<last-name>Colin</last-name>
<first-name>Carl</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Provided is an architecture (hardware implementation) for an authentication engine to increase the speed at which SHA1 multi-loop and/or multi-round authentication algorithms may be performed on data packets transmitted over a computer network. As described in this application, the invention has particular application to the variant of the SHA1 authentication algorithms specified by the IPSec cryptography standard. In accordance with the IPSec standard, the invention may be used in conjunction with data encryption/encryption architecture and protocols. However it is also suitable for use in conjunction with other non-IPSec cryptography algorithms, and for applications in which encryption/decryption is not conducted (in IPSec or not) and where it is purely authentication that is accelerated. Among other advantages, an authentication engine in accordance with the present invention provides improved performance with regard to the processing of short data packets.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="162.90mm" wi="82.89mm" file="US07299355-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="111.76mm" wi="117.26mm" file="US07299355-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="224.79mm" wi="172.38mm" file="US07299355-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="175.68mm" wi="129.96mm" orientation="landscape" file="US07299355-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="226.31mm" wi="120.73mm" orientation="landscape" file="US07299355-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="162.22mm" wi="162.48mm" file="US07299355-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="87.63mm" wi="109.05mm" file="US07299355-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="90.76mm" wi="96.52mm" file="US07299355-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="92.29mm" wi="116.76mm" file="US07299355-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="105.24mm" wi="79.33mm" file="US07299355-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="188.89mm" wi="84.33mm" file="US07299355-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims priority under 35 U.S.C. §119(e) from U.S. Provisional Application No. 60/261,425, entitled UBIQUITOUS BROADBAND SECURITY CHIP, filed Jan. 12, 2001, the disclosure of which is herein incorporated by reference herein for all purposes.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present invention relates generally to the field of message authentication, and more specifically to an authentication implementation which may be applied for cryptography acceleration. In particular, the invention is directed to a hardware implementation to increase the speed at which SHA1 authentication procedures may be performed on data packets transmitted over a computer network.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">Message authentication is generally discussed in conjunction with cryptography. Cryptography relates to enciphering and deciphering data. Authentication is concerned with data integrity, including confirming the identity of the transmitting party and ensuring that a message (e.g., a data packet) has not been tampered with en route to the recipient. Many cryptography protocols typically incorporate both encryption/decryption and authentication functionalities. Many methods of practicing both operations are well known in the art and are discussed, for example, in <i>Applied Cryptography, </i>Bruce Schneier, John Wiley &amp; Sons, Inc. (1996, 2<sup>nd </sup>Edition), herein incorporated by reference.</p>
<p id="p-0007" num="0006">In order to improve the speed of cryptography and/or authentication processing of data transmitted over a computer network, specialized chips have been developed, for example, the BCM 5805 available from Broadcom Corporation, Irvine, Calif. It is known that by incorporating both cryptography and authentication functionalities in a single accelerator chip, over-all system performance can be enhanced. Cryptography accelerator chips may be included in routers or gateways, for example, in order to provide automatic IP packet encryption/decryption and/or authentication. By embedding cryptography and/or authentication functionality in network hardware, both system performance and data security are enhanced.</p>
<p id="p-0008" num="0007">Examples of cryptography protocols which incorporate encryption/decryption and authentication functionalities include the IP layer security standard protocol, IPSec (RFC2406), and other network security protocols including Secure Socket Layer (SSL) (v3) (Netscape Communications Corporation) (referred to herein as SSL) and Transport Layer Security (TLS) (RFC 2246), all commonly used in electronic commerce transactions. IPSec (RFC2406) specifies two standard algorithms for performing authentication operations, HMAC-MD5-96 (RFC2403) and HMAC-SHA1-96 (RFC2404). SSL and TLS use a MAC and an HMAC, respectively, for authentication. The underlying hash algorithm in either case can be either MD5 (RFC1321) or SHA1 (NIST (FIPS 180-1)). SSL and TLS deploy such well-known algorithms as RC4, DES, triple DES for encryption/decryption operations. These network protocols are also described in detail in E. Rescorla, <i>SSL and TLS: Designing and Building Secure Systems </i>(Addison-Wesley, 2001) and S. A. Thomas, <i>SSL </i>&amp; <i>TLS Essentials: Securing the Web </i>(John Wiley &amp; Sons, Inc. 2000), both of which are incorporated by reference herein for all purposes. These protocols and their associated algorithms are well known in the cryptography and authentication arts and are described in detail in the noted National Institute of Standards and Technology (NIST), IETF (identified by RFC number) and other noted sources and specifications, incorporated herein by reference for all purposes.</p>
<p id="p-0009" num="0008">Both MD5 and SHA1 authentication algorithms specify that data is to be processed in 512-bit blocks. If the data in a packet to be processed is not of a multiple of 512 bits, padding is applied to round up the data length to a multiple of 512 bits. Thus, if a data packet that is received by a chip for an authentication is larger then 512 bits, the packet is broken into 512-bits data blocks for authentication processing. If the packet is not a multiple of 512 bits, the data left over following splitting of the packet into complete 512 bit blocks must be padded in order to reach the 512-bit block processing size. The same is true if a packet contains fewer than 512 bits of data. For reference, a typical Ethernet packet is up to 1,500 bytes. When such a packet gets split into 512-bit blocks, only the last block gets padded and so that overall a relatively small percentage of padding overhead is required. However for shorter packets, the padding overhead can be much higher. For example, if a packet has just over 512 bits it will need to be divided into two 512-bit blocks, the second of which is mostly padding so that padding overhead approaches 50% of the process data. The authentication of such short data packets is particularly burdensome and time consuming using the conventionally implemented MD5 and SHA1 authentication algorithms.</p>
<p id="p-0010" num="0009">For each 512-bit data block, a set of operations including non-linear functions, shift functions and additions, called a “round,” is applied to the block repeatedly. MD5 and SHA1 specify 64 rounds and 80 rounds, respectively, based on different non-linear and shift functions, as well as different operating sequences. In every round, the operation starts with certain hash states (referred to as “context”) held by hash state registers (in hardware) or variables (in software), and ends with a new set of hash states (i.e., an initial “set” of hash states and an end set; a “set” may be of 4 or 5 for the number of registers used by MD5 and SHA1, respectively). MD5 and SHA1 each specify a set of constants as the initial hash states for the first 512-bit block. The following blocks use initial hash states resulting from additions of the initial hash states and the ending hash states of the previous blocks.</p>
<p id="p-0011" num="0010">Typically, MD5 and SHA1 rounds are translated into clock cycles in hardware implementations. The addition of the hash states, to the extent that they cannot be performed in parallel with other round operations, requires overhead clock cycles in the whole computation. The computation of the padded portion of the data is also generally considered performance overhead because it is not part of the true data. Accordingly, the performance of MD5 and SHA1 degrade the most when the length of the padding is about the same as the length of the data (e.g., as described above, when a packet has just fewer than 512 bits of data and the padding logic requires an extra 512-bit to be added for holding the pad values).</p>
<p id="p-0012" num="0011">Moreover, the HMAC-MD5-96 and HMAC-SHA1-96 algorithms used in IPSec expand MD5 and SHA1, respectively, by performing two loops of operations. The HMAC algorithm for either MD5 or SHA1 (HMAC-x algorithm) is depicted in <figref idref="DRAWINGS">FIG. 1</figref>. The inner hash (inner loop) and the outer hash (outer loop) use different initial hash states. The outer hash is used to compute a digest based on the result of the inner hash. Since the result of the inner hash is 128 bits long for MD5 and 160 bits long for SHA1, the result must always be padded up to 512 bits and the outer hash only processes the one 512-bit block of data. HMAC-MD5-96 and HMAC-SHA1-96 provide a higher level of security, however additional time is needed to perform the outer hash operation. This additional time becomes significant when the length of the data to be processed is short, in which case, the time required to perform the outer hash operation is comparable to the time required to perform the inner hash operation.</p>
<p id="p-0013" num="0012">Authentication represents a significant proportion of the time required to complete cryptography operations in the application of cryptography protocols incorporating both encryption/decryption and MD5 and/or SHA1 authentication functionalities. In the case of IPSec, authentication is often the time limiting step, particularly for the processing of short packets, and thus creates a data processing bottleneck. In particular, of the two algorithms supported by the IPSec protocol, HMAC-SHA1-96 is about twenty-five percent slower than HMAC-MD5-96 in terms of the total computation rounds. Accordingly, techniques to accelerate authentication and relieve this bottleneck would be desirable. Further, accelerated implementations of SHA-1 would benefit any application of this authentication algorithm.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0014" num="0013">In general, the present invention provides an architecture (hardware implementation) for an authentication engine to increase the speed at which SHA1 multi-loop and/or multi-round authentication algorithms may be performed on data packets transmitted over a computer network. As described in this application, the invention has particular application to the variant of the SHA1 authentication algorithms specified by the IPSec cryptography standard. In accordance with the IPSec standard, the invention may be used in conjunction with data encryption/decryption architecture and protocols. However it is also suitable for use in conjunction with other non-IPSec cryptography algorithms, and for applications in which encryption/decryption is not conducted (in IPSec or not) and where it is purely authentication that is accelerated. Among other advantages, an authentication engine in accordance with the present invention provides improved performance with regard to the processing of short data packets.</p>
<p id="p-0015" num="0014">In one aspect, the present invention pertains to an authentication engine architecture for an SHA-1 multi-round authentication algorithm. The authentication architecture includes a hash engine configured to implement hash round logic for an SHA1 authentication algorithm. The hash round logic implementation includes a combined adder tree with a timing critical path having a single 32-bit carry look-ahead adder (CLA). The required additions are done in a single clock cycle by rearranging the order of the CLA and circular shift operations.</p>
<p id="p-0016" num="0015">As noted above, of the two algorithms supported by the IPSec protocol, HMAC-SHA1-96 is about twenty-five percent slower</p>
<p id="p-0017" num="0016">In another aspect, the invention pertains to a method of authenticating data transmitted over a computer network. The method involves receiving a data packet stream, splitting the packet data stream into fixed-size data blocks, and processing the fixed-size data blocks using a multi-round authentication engine architecture. The architecture implements hash round logic for a SHA1 multi-round authentication algorithm having a combined adder tree with a timing critical path having a single 32-bit carry look-ahead adder (CLA). The additions are done in a single clock cycle by rearranging the order of the CLA and circular shift operations.</p>
<p id="p-0018" num="0017">These and other features and advantages of the present invention will be presented in more detail in the following specification of the invention and the accompanying figures which illustrate by way of example the principles of the invention.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0018">The present invention will be readily understood by the following detailed description in conjunction with the accompanying drawings, wherein like reference numerals designate like structural elements, and in which:</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is a high-level block diagram depicting the HMAC-x algorithm (HMAC for either MD5 or SHA1) implemented in the IPSec standard protocol.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2</figref> is a high-level block diagram of an authentication engine architecture in accordance with one embodiment the present invention.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 3</figref> is a time study diagram illustrating the critical path of the conventional round logic of the SHA1 authentication algorithm.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 4</figref> is a time study diagram illustrating the critical path of the round logic of the SHA1 authentication algorithm in accordance with one embodiment the present invention.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 5</figref> is a high-level block diagram of an SHA1 hash engine illustrating the major elements of a round logic design in accordance with one embodiment the present invention.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> illustrate block diagrams of a full-adder cell (FA) and a half-adder cell (HA), respectively.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a block diagram of a carry save adder cell.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a block diagram of a carry look-ahead adder cell.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIGS. 9A and 9B</figref> illustrate block diagrams of the add5to1 and add4to1 comprehensive addition modules, respectively.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 10</figref> is a lower-level block diagram illustrating details of the ordering of the additions in a combined adder tree within the round logic design of <figref idref="DRAWINGS">FIG. 5</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF EMBODIMENTS OF THE INVENTION</heading>
<p id="p-0030" num="0029">Reference will now be made in detail to some specific embodiments of the invention including the best modes contemplated by the inventors for carrying out the invention. Examples of these specific embodiments are illustrated in the accompanying drawings. While the invention is described in conjunction with these specific embodiments, it will be understood that it is not intended to limit the invention to the described embodiments. On the contrary, it is intended to cover alternatives, modifications, and equivalents as may be included within the spirit and scope of the invention as defined by the appended claims. In the following description, numerous specific details are set forth in order to provide a thorough understanding of the present invention. The present invention may be practiced without some or all of these specific details. In other instances, well known process operations have not been described in detail in order not to unnecessarily obscure the present invention.</p>
<p id="p-0031" num="0030">In general, the present invention provides an architecture (hardware implementation) for an authentication engine to increase the speed at which SHA-1 authentication algorithms (including multi-loop implementation (e.g., HMAC)) may be performed on data packets transmitted over a computer network. Authentication engines in accordance with the present invention apply a variety of techniques that may include, in various applications, collapsing two SHA-1 authentication algorithm processing rounds into one; reducing operational overhead by ordering the additions required by an SHA-1 authentication algorithm in such a manner as to reduce the overall critical timing path (“hiding the adds”); and, for an HMAC (multi loop) variant of an SHA-1 authentication algorithm, pipelining the inner and outer loops. Among other advantages, an authentication engine in accordance with the present invention provides improved performance with regard to the processing of short data packets.</p>
<p id="p-0032" num="0031">In this specification and the appended claims, the singular forms “a,” “an,” and “the” include plural reference unless the context clearly dictates otherwise. Unless defined otherwise, all technical and scientific terms used herein have the same meaning as commonly understood to one of ordinary skill in the art to which this invention belongs.</p>
<p id="p-0033" num="0032">The present invention may be implemented in a variety of ways. As described in this application, the invention has particular application to the variants of the SHA1 authentication algorithm specified by the IPSec cryptography standard. In the following description, the invention is discussed primarily in connection with the IPSec protocol. In this regard, while the present invention is directed towards acceleration of the SHA-1 authentication algorithm, the description also includes reference to the MD5 algorithm, which is also available in IPSec, to provide context in which the present invention may be implemented. Further, one of skill in the art will recognize that various aspects of the invention may also be applied to other applications of the SHA-1 authentication algorithm generally, whether or not used with IPSec or in conjunction with cryptography operations at all. Further, while the aspects of the present invention described below are used together in a preferred embodiment of the invention, some aspects may be used independently to accelerate authentication operations. For example, the pipelining operations are particularly applicable to multi-loop, multi-round authentication algorithms; while the round-collapsing and ordering of the additions operations are particularly applicable to SHA1 and variant authentication algorithms. In particular, the present invention provides a method and logic for conducting the required additions in a single clock cycle using a single 32-bit CLA by rearranging the order of the CLA and circular shift operations performed.</p>
<p id="p-0034" num="0033">Pipelining Inner and Outer Hash Operations</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 2</figref> is a high-level block diagram of an authentication engine architecture in accordance with one embodiment the present invention. The engine architecture implements a pipelined structure to hide the time required for performing the outer hash operation when multiple data payloads are fed to the engine continuously. The engine architecture includes a core having two instantiations of the hash round logic; in this instance, inner and outer hash engines (inner and outer loops) for each of the MD5 hash round logic and the SHA1 hash round logic supported by the IPSec protocol. Pipeline control logic ensures that the outer hash operation for one data payload is performed in parallel with the inner hash operation of the next data payload in the packet stream fed to the authentication engine. A dual-frame input buffer is used for the inner hash engine, allowing one new 512-bit block to be loaded while another one is being processed, and the initial hash states are double buffered for concurrent inner hash and outer hash operations. In addition, dual-ported ROM is used for concurrent constant lookups by both inner and outer hash engines.</p>
<p id="p-0036" num="0035">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, the engine <b>200</b> includes a dual-frame input data payload buffer <b>201</b>, in this instance having left frame <b>202</b>, and a right frame <b>204</b>. Input data payloads received by the engine <b>200</b>, for example from data packets received off a network by a chip on which the engine architecture is implemented, are distributed between the frames <b>202</b>, <b>204</b> of the input data buffer <b>201</b> so that one data block may be loaded into the buffer while another one is being processed downstream in the data flow. Since <figref idref="DRAWINGS">FIG. 2</figref> illustrates an implementation of the present invention for processing IPSec packets, the architecture includes hash engines for the MD5 and SHA1 authentication protocols supported by IPSec. In accordance with the MD5 and SHA1 protocols, the input data payloads are loaded into the dual frames of the input data buffer <b>201</b>, split into 512-bit data blocks, padded if necessary (i.e., where the data block is less than 512 bits) and stored prior to being passed to an inner hash engine for processing. A multiplexer <b>206</b> controls the flow of 512-bit data blocks from the frames of the input buffer to an inner hash engine.</p>
<p id="p-0037" num="0036">Initial hash states are needed on per packet basis for the first data block of each packet. Initial hash states, are generated by software based on the authentication key and some default constant states based on the HMAC algorithm (pre-hashed), in accordance the specifications for these algorithms. This is typically done once per key. Alternatively, the initial states may be derived from the default constant states and the authentication key using the same hardware for every packet that requires authentication.</p>
<p id="p-0038" num="0037">The initial hash states for the inner hash of a given data block are loaded into a buffer <b>214</b> associated with the inner hash engine(s) <b>210</b>, <b>212</b>. The initial hash states for the outer hash of that data block are loaded into the first <b>215</b> of a pair of buffers <b>215</b>, <b>216</b> (referred to as an HMAC state buffer) associated with the outer hash engine(s) <b>220</b>, <b>222</b>. When the initial hash states are passed to the inner hash engine for processing of the data block, the outer hash states for that block are loaded into the second buffer <b>216</b>, and the inner and outer initial hash states for the next packet to be processed are loaded into the buffers <b>214</b>, <b>215</b>, respectively. In this way, the synchronization of the inner and outer hash states for a given data block is maintained, and the initial hash states are available for concurrent inner hash and outer hash operations. Further, the double buffering of the hash states allows initial hash states of the second packet to be loaded while the first packet is being processed so that the data processing is continuous from packet to packet, thereby maximizing the efficiency and processing power of the hash engine.</p>
<p id="p-0039" num="0038">The engine <b>200</b>, further includes a dual-ported ROM <b>218</b>. The dual-ported ROM <b>218</b> further facilitates the parallel inner and outer has operations by allowing for concurrent constant lookups by both inner and outer hash engines.</p>
<p id="p-0040" num="0039">The inner hash is conducted on all 512 bit blocks of a given data packet. The result of the inner hash is 128 bits long for MD5 and 160 bits long for SHAl. The result is padded up to 512 bits and the outer hash processes the one 512 bit block of data to compute a digest based or the result of the inner hash. An output buffer <b>230</b> stores the digest and outputs it through a multiplexer <b>232</b>.</p>
<p id="p-0041" num="0040">Collapsing SHA-1 Authentication Algorithm Processing Rounds</p>
<p id="p-0042" num="0041">As noted above, of the two algorithms supported by the IPSec protocol, HMAC-SHA1-96 is about twenty-five percent slower than HMAC-MD5-96 in terms of the total computation rounds. One way to improve HMAC-SHA1-96 in an IPSec-supporting hardware implementation is to collapse multiple rounds of logic into a single clock cycle thus the total number of clocks required for HMAC-SHA1-96 operation is reduced. The same approach may be applied to any multi-round authentication algorithm. However, simply collapsing the logic for multiple rounds into a single clock cycle can cause the delay to compute the collapsed logic to increase, therefore reducing the maximum clock frequency.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 3</figref> is a time study diagram illustrating the timing critical path of the conventional round logic of the SHA1 authentication algorithm. Registers a, b, c, d and e hold the intermediate hash states between rounds. They are duplicated in this figure to demonstrate the ending points of the logic paths clearly. In the actual design, the paths are fed back to the same set of registers because the round logic is reused 80 times. The “+” symbols identify standard adders implemented as carry look-ahead adders (CLAs). W<sub>i </sub>represents the incoming payload. K<sub>i </sub>represents a constant, obtained from ROM used in the authentication computations. It is shown in the figure that the timing critical paths are from registers b, c and d, going through the non-linear function (defined by the SHA1 specification) and the adders and ending at register a. Registers b, c, d and e each receives a non-critical input (b receives a, etc.).</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 4</figref> is a time study diagram illustrating the timing critical path of the collapsed round logic of the SHA1 authentication algorithm in accordance with one embodiment the present invention. The SHA1 algorithm specifies five registers. As illustrated above, the data path of four of the five registers in any SHA1 round are not critical (time limiting). In accordance with this invention, in successive SHA1 rounds the registers having the critical path are alternative so that four registers worth of data may always be passed on to the next round prior to completion of the critical path in the current round. Thus, when two rounds of SHA1 are put together, the critical path computation of the second round is independent of that of the first round, since the receiving register of the critical path of the first round (i.e., register a) is not the driving register of the critical path of the second round (i.e., register e). This approach demonstrates how two SHA1 rounds may be collapsed together while maintaining the same amount of delay for the timing critical path, and how by alternating the critical path from register to register between rounds in this way, the adding operations may be “hidden.”</p>
<p id="p-0045" num="0044">In a preferred embodiment, the eighty rounds of an SHA1 loop are collapsed into forty rounds. As described and illustrated above, the collapsing of rounds is accomplished by having a single set of registers (the preferred embodiment has 5 registers as defined by the IPSec protocol) with two rounds of logic. It is contemplated that the techniques of invention described herein can also be applied to further collapse the number of SHA1 rounds in an SHA1 loop into twenty or even fewer rounds.</p>
<p id="p-0046" num="0045">Ordering the Additions</p>
<p id="p-0047" num="0046">As described above, both MD5 and SHA1 algorithms specify that the final hash states of every 512-bit block are to be added together with the initial hash states. The results are then used as the initial states of the next 512 bit block. In MD5, values of four pairs of 32-bit registers need to be added and in SHA1, five pairs. Considering that each 32-bit addition takes one clock cycle, a typical hardware implementation would use four extra cycles in MD5 and five extra cycles in SHA1 to perform these additions if hardware resources are limited.</p>
<p id="p-0048" num="0047">As noted above with reference to <figref idref="DRAWINGS">FIGS. 3 and 4</figref>, in both MD5 and SHA1, only one state register is re-computed every round. The rest of the state registers use shifted or non-shifted contents from neighboring registers. Thus, the final hash states are not generated in the final round, but rather in the last four consecutive MD5 rounds or five SHA1 rounds, respectively. The present invention exploits this observation by providing architecture and logic enabling the ordering of the additions as early as the final hash state is available, hiding the computation time completely behind the round operations. This is illustrated in the following scheduling tables in which ‘Ti’ represents one clock cycle and ‘rnd i’ represents round operation. The initial hash states are represented by ia, ib, ic, id and ie. Parallel operations are listed in the same column.</p>
<p id="p-0049" num="0048">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>MD5</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="9">
<colspec colname="1" colwidth="14pt" align="center"/>
<colspec colname="2" colwidth="14pt" align="center"/>
<colspec colname="3" colwidth="14pt" align="center"/>
<colspec colname="4" colwidth="35pt" align="center"/>
<colspec colname="5" colwidth="28pt" align="center"/>
<colspec colname="6" colwidth="28pt" align="center"/>
<colspec colname="7" colwidth="28pt" align="center"/>
<colspec colname="8" colwidth="28pt" align="center"/>
<colspec colname="9" colwidth="28pt" align="center"/>
<tbody valign="top">
<row>
<entry>T1</entry>
<entry>T2</entry>
<entry>T3</entry>
<entry>-----------</entry>
<entry>T61</entry>
<entry>T62</entry>
<entry>T63</entry>
<entry>T64</entry>
<entry>T1</entry>
</row>
<row>
<entry namest="1" nameend="9" align="center" rowsep="1"/>
</row>
<row>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>—</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
</row>
<row>
<entry>1</entry>
<entry>2</entry>
<entry>3</entry>
<entry/>
<entry>61</entry>
<entry>62</entry>
<entry>63</entry>
<entry>64</entry>
<entry>1</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>a + ia</entry>
<entry>d + id</entry>
<entry>c + ic</entry>
<entry>b + ib</entry>
</row>
<row>
<entry namest="1" nameend="9" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<tbody valign="top">
<row>
<entry>original SHA1</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="9">
<colspec colname="1" colwidth="14pt" align="center"/>
<colspec colname="2" colwidth="14pt" align="center"/>
<colspec colname="3" colwidth="14pt" align="center"/>
<colspec colname="4" colwidth="35pt" align="center"/>
<colspec colname="5" colwidth="28pt" align="center"/>
<colspec colname="6" colwidth="28pt" align="center"/>
<colspec colname="7" colwidth="28pt" align="center"/>
<colspec colname="8" colwidth="28pt" align="center"/>
<colspec colname="9" colwidth="28pt" align="center"/>
<tbody valign="top">
<row>
<entry>T1</entry>
<entry>T2</entry>
<entry>T3</entry>
<entry>-----------</entry>
<entry>T77</entry>
<entry>T78</entry>
<entry>T79</entry>
<entry>T80</entry>
<entry>T1</entry>
</row>
<row>
<entry namest="1" nameend="9" align="center" rowsep="1"/>
</row>
<row>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>—</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
</row>
<row>
<entry>1</entry>
<entry>2</entry>
<entry>3</entry>
<entry/>
<entry>77</entry>
<entry>78</entry>
<entry>79</entry>
<entry>80</entry>
<entry>1</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>e + ie</entry>
<entry>d + id</entry>
<entry>c + ic</entry>
<entry>b + ib</entry>
<entry>a + ia</entry>
</row>
<row>
<entry namest="1" nameend="9" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<tbody valign="top">
<row>
<entry>collapsed SHA1</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="9">
<colspec colname="1" colwidth="14pt" align="center"/>
<colspec colname="2" colwidth="14pt" align="center"/>
<colspec colname="3" colwidth="14pt" align="center"/>
<colspec colname="4" colwidth="35pt" align="center"/>
<colspec colname="5" colwidth="28pt" align="center"/>
<colspec colname="6" colwidth="28pt" align="center"/>
<colspec colname="7" colwidth="28pt" align="center"/>
<colspec colname="8" colwidth="28pt" align="center"/>
<colspec colname="9" colwidth="28pt" align="center"/>
<tbody valign="top">
<row>
<entry>T1</entry>
<entry>T2</entry>
<entry>T3</entry>
<entry>-----------</entry>
<entry/>
<entry>T38</entry>
<entry>T39</entry>
<entry>T40</entry>
<entry>T1</entry>
</row>
<row>
<entry namest="1" nameend="9" align="center" rowsep="1"/>
</row>
<row>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>—</entry>
<entry/>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
<entry>rnd</entry>
</row>
<row>
<entry>1</entry>
<entry>2</entry>
<entry>3</entry>
<entry/>
<entry/>
<entry>38</entry>
<entry>39</entry>
<entry>40</entry>
<entry>1</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>e + ie</entry>
<entry>d + id</entry>
<entry>b + ib</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>c + ic</entry>
<entry>a + ia</entry>
</row>
<row>
<entry namest="1" nameend="9" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0050" num="0049">In one embodiment of the invention, a plurality of adds with the final hash states may be accomplished in a single clock cycle. An example is shown in the “collapsed SHA1” table, in which the five adds are performed in just three clock cycles T39, T40 and T1 of the next loop. One of skill in the art will recognize that, consistent with the principles of this invention described herein, it is possible to perform more than two adds in parallel in one clock cycle. Moreover, it should be noted that, as illustrated in the tables, this aspect of the present invention is applicable to both collapsed and non-collapsed multi-round authentication algorithms. Implementation of this aspect of the present invention in conjunction with a collapsed multi-round algorithm is particularly advantageous since hiding of adding steps becomes increasingly important as the number of rounds is decreased. Adds that are not hidden in the manner of this aspect of the present invention would represent an even larger proportion of overhead in a collapsed round implementation than in an implementation with a higher number of rounds.</p>
<p id="p-0051" num="0050">Logic Design</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 5</figref> is a high-level block diagram of an SHA1 hash engine illustrating the major elements of a collapsed round logic design in accordance with one embodiment the present invention consistent with the timing critical path study of <figref idref="DRAWINGS">FIG. 4</figref>. Hardware implementation of addition operations may be carried out using a variety of operators, referred to as adders, well known to those of skill in the art. The main types of multi-bit adders are carry propagate adder (CPA), carry save adder (CSA) and carry look-ahead adder (CLA). CPAs, CSAs and CLAs are generally composed of single bit adders referred to as full-adder (FA) and half-adder (HA). Referring to <figref idref="DRAWINGS">FIGS. 6 through 8</figref>, the various adders noted above are described, considering two k-bit integers A and B as two inputs to the adders: Let A<sub>i </sub>and B<sub>i </sub>for i=1, 2, . . . , k−1 represent the bits of the integer A and B, respectively.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIGS. 6A and 6B</figref> illustrate block diagrams of a full-adder cell (FA) and a half-adder cell (HA), respectively. The difference between these two is that the FA has an additional carry input (Ci). The Boolean functions of the adder outputs can be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>i+1</sub><i>=A</i><sub>i</sub><i>B</i><sub>i</sub><i>+A</i><sub>i</sub><i>C</i><sub>i</sub><i>+B</i><sub>i</sub><i>C</i><sub>i</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>S<sub>i</sub>=A<sub>i</sub>^B<sub>i</sub>^C<sub>i</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0054" num="0053">where the symbol ‘^’ represents logic exclusive-OR.</p>
<p id="p-0055" num="0054">A carry propagate adder is a multi-bit adder containing a serially connected FA chain. The carry output of each FA stage can propagate up through all the higher order stages. The CPA is a simple representation of the logic concept of multi-bit addition operations, but due to the long propagation delay of the carry, it has little practical value in designing wide adders.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a block diagram of a carry save adder cell. A CSA is a multi-bit adder made out of an array of FAs. A CSA does not propagate the carry upstream. Instead, it saves the carry together with the intermediate sum. A CSA has three inputs (Ai, Bi, Ci) and two outputs (Ci+1, Si). When a CSA is used to add up multiple operands, it can quickly reduce the total number of operands. CSAs are widely used in multiplier design where a large number of partial sums need to be added together.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a block diagram of a carry look-ahead adder cell. A CLA is designed to reduce the carry propagation delay. It uses specially designed logic to compute carry prior to the summation. The module ‘Carry Look-ahead Logic’ in <figref idref="DRAWINGS">FIG. 8</figref> represents the logic that generates C<b>1</b>, C<b>2</b> . . . based on P and G in the equations that follow. Once the carries are generated, on a per bit basis, there will be the two inputs Ai and Bi as well as the final carry input. The sum (S<b>1</b>, S<b>1</b>) is an XOR result of all three inputs.</p>
<p id="p-0058" num="0057">According to the carry computing logic, two variables are defined, the generation (G) and the propagation (P). The generation represents whether or not a specific bit or bit groups based on the input values can produce a carry. The propagation represents whether or not a carry can ripple though a specific bit or bit groups.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>G<sub>i</sub>=A<sub>i</sub>B<sub>i</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>P</i><sub>i</sub><i>=A</i><sub>i</sub><i>+B</i><sub>i </sub>(logical OR)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>i+1</sub><i>=G</i><sub>i</sub><i>+C</i><sub>i</sub><i>P</i><sub>i</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0059" num="0058">By applying this logic all the carries can be computed as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>1</sub><i>=G</i><sub>0</sub><i>+C</i><sub>0</sub>P<sub>0</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>2</sub><i>=G</i><sub>1</sub><i>+G</i><sub>0</sub><i>P</i><sub>1</sub><i>+C</i><sub>0</sub><i>P</i><sub>0</sub><i>P</i><sub>1</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>3</sub><i>=G</i><sub>2</sub><i>+G</i><sub>1</sub><i>P</i><sub>2</sub><i>+G</i><sub>0</sub><i>P</i><sub>1</sub><i>P</i><sub>2</sub><i>+C</i><sub>0</sub><i>P</i><sub>0</sub><i>P</i><sub>1</sub><i>P</i><sub>2</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C</i><sub>4</sub><i>=G</i><sub>3</sub><i>+G</i><sub>2</sub><i>P</i><sub>3</sub><i>+G</i><sub>1</sub><i>P</i><sub>2</sub><i>P</i><sub>3</sub><i>+G</i><sub>0</sub><i>P</i><sub>0</sub><i>P</i><sub>1</sub><i>P</i><sub>2</sub><i>+C</i><sub>0</sub><i>P</i><sub>0</sub><i>P</i><sub>1</sub><i>P</i><sub>2</sub><i>P</i><sub>3</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and so on.
<br/>
The sum of each bit can be computed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i><sub>i</sub><i>=A</i><sub>i</sub><i>^B</i><sub>i</sub><i>^C</i><sub>i</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0060" num="0059">Returning to <figref idref="DRAWINGS">FIG. 5</figref>, the design, in accordance with the present invention, makes use of carry save adders (CSA; delay is equivalent to 1-bit adder) and carry look-ahead adders (CLAs) to achieve best speed. As noted above, CSAs efficiently add multiple quantities together to generate partial products which are not propagated, and CLAs are designed to reduce the carry propagation delay. The circular shift is a re-map of the bits. It does not consume any time. In accordance with the present invention, the additions are done in a single clock cycle by rearranging the order of the CLA and circular shift operations such that only a single CLA is needed in the critical path.</p>
<p id="p-0061" num="0060">Two comprehensive addition modules, add5to1 and add4to1, in the architecture each use several stages of CSA followed-by a carry look-ahead (CLA) adder, as illustrated and described in more detail with reference to <figref idref="DRAWINGS">FIG. 10</figref>, below. <figref idref="DRAWINGS">FIGS. 9A and 9B</figref> illustrate block diagrams of the add5to1 and add4to1 comprehensive addition modules, respectively. The add 5to 1 module includes three CSA adders followed by a CLA. The add4to1 module includes two CSA adders followed by a CLA.</p>
<p id="p-0062" num="0061">The hash engine has five registers, A, B, C, D and E. The initial hash state in register A (a<sub>i</sub>) is added to the initial hash state in register E (e<sub>1</sub>), the payload data (W<sub>i</sub>), a constant (K<sub>i</sub>), and the result of a function (F<sub>t</sub>) of the initial hash states in registers B, C and D by a combination of CSA and CLA adders in a combined adder tree (<figref idref="DRAWINGS">FIG. 10</figref>). The initial hash state in register D (d<sub>1</sub>) is added to the payload data (W<sub>i+1</sub>), a constant (K<sub>i+1</sub>), and the result of a function (F<sub>t</sub>) of the initial hash states in registers A, B (which passes through a 30-bit circular shift) and C by the combined adder tree (<figref idref="DRAWINGS">FIG. 10</figref>).</p>
<p id="p-0063" num="0062">The adder modules conclude with a carry look-ahead (CLA) adder. The sum of each adder module is added by a CLA adder to generate and propagate a final sum for the round which is then fed back into register A for the next round. As shown more clearly in <figref idref="DRAWINGS">FIG. 10</figref>, the most timing critical input of these two modules (add5to1 and add4to1) goes through the last CSA reduction and the CLA stage.</p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 10</figref> is a lower-level block diagram illustrating details of the ordering of the additions in a combined adder tree within the round logic design of <figref idref="DRAWINGS">FIG. 5</figref>. It is observed that the logic of the combined two SHA1 rounds contains the summation of multiple register values (a through e) with inputs W and K and a circular shift operation (&lt;&lt;&lt;5). The most time consuming (i.e., critical path) computation in the unrolled SHA1 rounds can be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S=</i>((<i>a&lt;&lt;&lt;</i>5)+<i>f</i>(<i>b, c, d</i>)+<i>e+w[i]+k[i])&lt;&lt;&lt;</i>5<i>+f</i>(<i>b, c, d</i>)+<i>e+w[i</i>+1<i>]+k[i+</i>1]<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where, a, b, c, d, e, w and k are 32-bit quantities.
</p>
<p id="p-0065" num="0064">The operation may logically be performed in two steps: Step <b>1</b> using module add5to1 to generate,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Si=</i>(<i>a&lt;&lt;&lt;</i>5)+<i>f</i>(<i>b, c, d</i>)+<i>e+w[i]+k[i],</i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and Step <b>2</b> using module add4to1 and a 32-bit carry look-ahead adder (CLA) to generate,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S=Si&lt;&lt;&lt;</i>5<i>+f</i>(<i>b, c, d</i>)+<i>e+w[i+</i>1]<i>+k[i+</i>1].<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0066" num="0065">In each step, carry save adders (CSAs) are used to perform 3-to-2 reductions on the total number of operands, as illustrated in <figref idref="DRAWINGS">FIG. 9</figref>. CSAs are applied as much as possible in both steps. Using A and B to represent the outputs of cascaded CSAs (3 levels) in Step <b>1</b> and C and D to represent the outputs of cascaded CSAs (2 levels) in Step <b>2</b>, the final result, S, may be expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>(<i>A+B</i>)&lt;&lt;&lt;5<i>+C+D.</i><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0067" num="0066">In the implementation described above, a circular shift is performed on Si of Step <b>1</b>, so a CLA is required in Step <b>1</b> to compute Si before the shift operation. A second CLA is required in Step <b>2</b> to compute the final result. Therefore, the overall delay of both steps is equivalent to two 32-bit CLA delays plus one 32-bit CSA delay plus the delay for function ‘f’ for the most timing critical path. The reason that only one CSA delay is counted is because the most time-critical input is fed into the last CSA stage rather than propagated through multiple CSAs.</p>
<p id="p-0068" num="0067">Logic implementation according to the present invention extends the effectiveness of CSA across both steps. In so doing, the partial results of Step <b>1</b> can be saved without applying CLA, removing one CLA from the critical path (CLA is always time-consuming due to the carry propagation). This is achieved by manipulating the position of the circular shift, normally happening at a fixed bit location in SHA1. In accordance with the present invention, the order of the circular shift operation is switched with the last CLA addition (A+B) in Step <b>1</b>, thereby replacing the CLA operation in Step <b>1</b> with more CSAs.</p>
<p id="p-0069" num="0068">In order to perform circular shift operations on A and B before they are summed together, the following is derived:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>0<i>={A[</i>26:0], 5<i>′b</i>0}+{<i>B[</i>26:0], 5<i>′b</i>0}+<i>C+D+{</i>27<i>′b</i>0, <i>E}</i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>1<i>={A[</i>26:0], 5<i>′b</i>0}+{<i>B[</i>26:0], 5<i>′b</i>0}+<i>C+D+{</i>27<i>′b</i>0, <i>F}</i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where E and F are 5-bit quantities derived from:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E=A[</i>31:27<i>]+B[</i>31:27]<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F=A[</i>31:27<i>]+B[</i>31:27]+5<i>′b</i>01<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The need to have E and F is due to the fact that a carry may be generated from A[26:0]+B[26:0]. Since A and B are not summed up first, it is not known if the upper five bits will receive a carry from the lower bits. Therefore two cases are computed, one with carry input (F), and the other without (E).
</p>
<p id="p-0070" num="0069">S0 and S1 are computed using the module add5to 1 since the constraint of the circular shift is removed from the equations. During this computation, only one CLA is needed at the last step. In order to select between SO and SI as the final result, the highest carry output of (A[26:0]+B[26:0]) is computed in parallel with the CLA. This can be done slightly faster than the CLA step, because there are only 27-bits to compute and only the most significant carry output is needed since that carry output will be used to select between the two sets of results. There is no need to compute the sum in this case. Therefore, it never becomes timing critical.</p>
<p id="p-0071" num="0070">The overall delay of the unrolled SHA1 rounds now becomes the delay to compute S0 or S1 plus the delay to select between them (using a multiplexer (MUX)). A 32-bit CSA is an array of FAs. The delay associated with a 32-bit CSA is the same as the delay for a FA. Since E and F are the outputs of 5-bit adders based on A[3 1:27] and B[3 1:27], this delay is on the order of two FAs, based on the complexity to compute the carries and sum of 5-bit adders using P and G. Either the delay of two CSAs (FAs) or the delay of a 5-bit adder should be significantly smaller than that of a 32-bit CLA. Thus, the delay to obtain S0 or S1 is equivalent to one 5-bit addition, plus one 32-bit CSA, plus a multiplexer operation (the MUX delay associated with selecting between S0 and S1), plus one 32-bit CLA, assuming the 5-bit addition needed to generate E and F is slower than the delay of two 32-bit CSAs. Otherwise, the critical timing path goes through three 32-bit CSAs, plus a multiplexer operation (the MUX delay associated with selecting between S0 and S1), plus 1 32-bit CLA. In either case, the delay is much less than a timing critical path that includes two CLAs.</p>
<p id="p-0072" num="0071">Thus, the approach of the present invention trades off one 32-bit CLA delay with the worse of one 5-bit CLA or two 32-bit CSAs, plus the additional MUX delay. The design results in significant acceleration due to the time saved by eliminating the 32-bit CLA.</p>
<p id="p-0073" num="0072">Implementations of the invention using this logic design in an authentication engine using the HMAC-SHA1 algorithm of the IPSec protocol, collapsing of the conventional 80 SHA1 rounds into 40 rounds, hiding the adds, and pipelining the inner and outer loops may enable HMAC-SHA1 to be conducted in approximately the same time as conventional SHA1, or less. Conclusion</p>
<p id="p-0074" num="0073">Although the foregoing invention has been described in some detail for purposes of clarity of understanding, those skilled in the art will appreciate that various adaptations and modifications of the just-described preferred embodiments can be configured without departing from the scope and spirit of the invention. For example, while the present invention has been described primarily in connection with the IPSec protocol, the principles of many aspects of the invention may also be applied to multi-round authentication algorithms generally, whether or not used in conjunction with cryptography operations. Therefore, the described embodiments should be taken as illustrative and not restrictive, and the invention should not be limited to the details given herein but should be defined by the following claims and their full scope of equivalents.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An authentication engine architecture for a SHA-1 multi-round authentication algorithm, comprising:
<claim-text>a hash engine configured to implement hash round logic for a SHA-1 authentication algorithm, the SHA-1 hash round logic including,</claim-text>
<claim-text>a combined adder tree having:
<claim-text>a timing critical path configured to produce a first output, the timing critical path having a single 32-bit carry look-ahead adder (CLA),</claim-text>
<claim-text>a second path, parallel to the timing critical path, configured to produce a second output, the second path having a single CLA, and</claim-text>
</claim-text>
<claim-text>a selector configured to select an output from the output of the timing critical path and theoutput of the second path.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said hash round logic implementation has a timing critical path equivalent to:
<claim-text>thee 32-bit CSAs, a multiplexer operation, and one 32-bit CLA.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the additions performed by the combined adder tree are preceded by a 5-bit circular shifter.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The authentication engine architecture of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein combined adder tree includes add 5tol and add 4tol adders.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the combined adder tree is configured such that addition computations are conducted in parallel with round operations.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the architecture is implemented as an authentication engine architecture for a multi-loop, SHA-1 authentication algorithm, comprising:
<claim-text>a first instantiation of a SHA-1 authentication algorithm hash round logic in an inner hash engine;</claim-text>
<claim-text>a second instantiation of a SHA-1 authentication algorithm hash round logic in an outer hash engine;</claim-text>
<claim-text>a dual-frame payload data input buffer configured for loading one new data block while another data block one is being processed in the inner hash engine;</claim-text>
<claim-text>an initial hash state input buffer configuration for loading initial hash states to the inner and outer hash engines for concurrent inner hash and outer hash operations; and</claim-text>
<claim-text>a dual-ported ROM configured for concurrent constant lookups for both inner and outer hash engines.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The authentication engine architecture of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the multi-loop, multi-round authentication algorithm is HMAC-SHA-1.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said hash round logic is implemented such that eighty rounds of a SHA-1 loop are collapsed into forty rounds.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said hash engine is configured to implement hash round logic comprising:
<claim-text>five hash state registers;</claim-text>
<claim-text>one critical and four non-critical data paths associated with the five registers, such that in successive SHA-1 rounds, registers having the critical path are alternative.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The authentication engine architecture of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising a multiplexer to select an output of the combined adder tree.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method of authenticating data transmitted over a computer network, comprising:
<claim-text>receiving a data packet stream;</claim-text>
<claim-text>splitting the packet data stream into fixed-size data blocks; and</claim-text>
<claim-text>processing the fixed-size data blocks using a SHA-1 multi-round authentication engine architecture, said architecture implementing hash round logic for a SHA-1 authentication algorithm, the SHA-1 hash round logic including:</claim-text>
<claim-text>a combined adder tree having:
<claim-text>a timing critical path configured to produce a first output, the timing critical path having a single 32-bit carry look-ahead adder (CLA),</claim-text>
<claim-text>a second path, parallel to the timing critical path, configured to produce a second output, the second path having a single CLA, and</claim-text>
<claim-text>a selector configured to select an output from the output of the timing critical path and the output of the second path.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the hash round logic implementation has a timing critical path equivalent to:
<claim-text>three 32-bit CSAs, a multiplexer operation, and one 32-bit CLA.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein additions performed by the combined adder tree are preceded by a 5-bit circular shifter.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising:
<claim-text>providing five hash state registers; and</claim-text>
<claim-text>providing data paths from said five state registers such that four of the five data paths from the registers in any SHA-1 round are not timing critical.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein, in successive SHA-1 rounds, registers having the critical path are alternative.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein eighty rounds of a SHA-1 loop are collapsed into forty rounds.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein addition computations are conducted in parallel with round operations.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein said authentication engine is a multi-loop, multi-round authentication engine architecture having a hash engine core comprising an inner hash engine and an outer hash engine, said architecture configured to,
<claim-text>pipeline hash operations of said inner hash and outer hash engines,</claim-text>
<claim-text>collapse and rearrange multi-round logic to reduce rounds of hash operations, and</claim-text>
<claim-text>implement multi-round logic such that addition computations are conducted in parallel with round operations.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the multi-loop, multi-round authentication algorithm is HMAC-SHA-1.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein said pipelining comprises performance of an outer hash operation for one data payload in parallel with an inner hash operation of a second data payload in a packet stream fed to the authentication engine.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The method of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein a dual-frame input buffer is used for the inner hash engine.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein initial hash states for the hash operations are double buffered for concurrent inner hash and outer hash operations.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein concurrent constant lookups are performed from a dual-ported read only memory (ROM) by both inner and outer hash engines.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref>, comprising performing a multiplexing operation to provide an output of the combined adder tree.</claim-text>
</claim>
</claims>
</us-patent-grant>
