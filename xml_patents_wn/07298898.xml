<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298898-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298898</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10413378</doc-number>
<date>20030415</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>800</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>34</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382173</main-classification>
<further-classification>382168</further-classification>
<further-classification>382171</further-classification>
<further-classification>382172</further-classification>
</classification-national>
<invention-title id="d0e53">System and method for image segmentation</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6017309</doc-number>
<kind>A</kind>
<name>Washburn et al.</name>
<date>20000100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600454</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6126605</doc-number>
<kind>A</kind>
<name>Washburn et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600454</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6130967</doc-number>
<kind>A</kind>
<name>Lee et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>382302</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6162176</doc-number>
<kind>A</kind>
<name>Washburn et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600454</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6379306</doc-number>
<kind>B1</kind>
<name>Washburn et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600454</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6738496</doc-number>
<kind>B1</kind>
<name>Van Hall</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382101</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00007">
<othercit>N. Otsu, “A Threshold Selection Method from Gray-Level Histograms”, <i>IEEE Transactions on Systems, Man, and Cybernetics</i>, vol. SMC-9, No. 1, pp. 62-66, Jan. (1979).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>Zhang et al., “Resotration of Images Scanned from Thick Bound Documents”, <i>IEEE</i>, pp. 1074-1077 (2001).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>27</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>382260</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382171</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382172</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382266</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382101</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382302</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382104</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382103</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382173</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600454</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600455</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>340937</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>348149</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>2</number-of-drawing-sheets>
<number-of-figures>2</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040208364</doc-number>
<kind>A1</kind>
<date>20041021</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Haque</last-name>
<first-name>Jamal</first-name>
<address>
<city>Tampa</city>
<state>FL</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Parker</last-name>
<first-name>James D.</first-name>
<address>
<city>Tarpon Springs</city>
<state>FL</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Wilcox</last-name>
<first-name>Michelle S.</first-name>
<address>
<city>Largo</city>
<state>FL</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Prado</last-name>
<first-name>Edward R.</first-name>
<address>
<city>Palm Harbor</city>
<state>FL</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="005" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Prewitt</last-name>
<first-name>John P.</first-name>
<address>
<city>St. Petersburg</city>
<state>FL</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fogg &amp; Powers LLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Honeywell International Inc.</orgname>
<role>02</role>
<address>
<city>Morristown</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Do</last-name>
<first-name>Anh Hong</first-name>
<department>2624</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An image segmentation apparatus, preferably integrally implemented in a device such as an FPGA, including a buffer memory for storing pixel data, a digital filter in communication with the buffer memory, the digital filter having programmable coefficients, a histogram generating module in communication with the buffer memory that generates a histogram of the pixel data, a statistics generating module in communication with the buffer memory that generates statistics regarding the pixel data, a threshold select module for selecting one of a plurality thresholds and an apply threshold module for applying the selected threshold to data stored in the buffer to generate exceedance data that exceed the selected threshold. In a preferred embodiment, a control module controls each of the buffer, histogram, statistics and threshold modules to control data flow, program filter coefficients and select the appropriate threshold.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="131.40mm" wi="236.81mm" file="US07298898-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="237.49mm" wi="149.86mm" orientation="landscape" file="US07298898-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="219.03mm" wi="138.68mm" file="US07298898-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates generally to digital signal processing. More specifically, the present invention relates to systems and methods for performing image segmentation using a plurality of functional units or modules, preferably implemented in an integrated electronic device, such as a field programmable gate array (FPGA) or application specific integrated circuit (ASIC).</p>
<p id="p-0004" num="0003">2. Background of the Invention</p>
<p id="p-0005" num="0004">Digital signal processing (DSP) is employed in many fields, one of which is image segmentation. Image segmentation is the ability to distinguish between, for example, an object of interest and a background, or another object that is not of interest. For example, image segmentation is often used in an image processing application that tracks or detects a particular object, such as lane markings on a road to perform automatic steering of a vehicle. In automatic steering, image processing must be rapid, especially if the vehicle is traveling at a relatively high speed.</p>
<p id="p-0006" num="0005">Also, image processing in an automatic steering application preferably should be able to handle varying weather conditions and environments, such as rain, bright sunlight and night time driving. Such a range of possible driving conditions, however, poses significant problems to known image segmentation processes that rely on static processing techniques.</p>
<heading id="h-0002" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0007" num="0006">To improve digital signal processing techniques, the present invention is directed to systems and methods for facilitating and improving the digital signal processing of an image received from a camera. The present invention is particularly useful for performing image segmentation, e.g., distinguishing between an object of interest and a background. In a preferred embodiment of the present invention, the system is implemented in a field programmable gate array (FPGA), which allows for substantial control over the individual functional units of the invention, as well as substantial control over the data flow between those functional units.</p>
<p id="p-0008" num="0007">More specifically, the present invention preferably allows data to be passed through different functional units at different times such that data may actually pass through functional units several times before finally being output from the FPGA to an external device for further processing, as may be desired. One advantage of the present invention it that it is possible to apply different algorithms to incoming data using the same overall device. It is also possible, in accordance with the present invention, to implement real-time programming of coefficients that may be used in, e.g., filtering to smooth out or detect edges of an image.</p>
<p id="p-0009" num="0008">In a preferred embodiment of the present invention, incoming pixel data is stored in memory, such as an external RAM, that operates as a buffer. In addition, a histogram of the received image data is generated to clearly identify the range and magnitude of pixel intensities. In a preferred implementation, the histogram is implemented with 1,024 bins and each pixel is represented by a 16 bit word.</p>
<p id="p-0010" num="0009">Optionally, depending on how the FPGA is programmed to operate, the pixel data from the buffer is filtered using one or more different techniques known in the art. Advantageously, in accordance with the present invention, filter coefficients can be changed “on the fly” such that filter processing can be modified depending on the nature of incoming data.</p>
<p id="p-0011" num="0010">After storage in memory and histogram generation (and possibly filtering), the image data from the memory (or that has been filtered) is preferably transferred to a statistics module that generates a set of statistics, including a mean and standard deviation, with respect to the respective pixel intensities. These statistics are subsequently used for threshold calculations.</p>
<p id="p-0012" num="0011">Threshold calculations include determining, in one of several possible ways (as will be described in more detail later herein), a threshold that is appropriate for the data at hand and the level or type of image segmentation that is desired. After a threshold (or set of thresholds) is determined, it is employed in a threshold comparison module to determine which of the pixels in the image data exceed the threshold. Preferably, only those pixels that exceed the threshold are maintained and other pixels are reset to a predetermined intensity, e.g., zero, such that subsequent digital signal processing need not have to act on those pixels.</p>
<p id="p-0013" num="0012">In a preferred embodiment of the present invention, it is possible to fine tune threshold levels using a real-time programmable control register. That is, it is possible to control a main control module via a general purpose processor to cause the main control module to update registers and thereby set variables in one or more modules to control the flow of data and/or operation of any given module.</p>
<p id="p-0014" num="0013">The present invention, when implemented in an FPGA or, ultimately, an application specific integrated circuit (ASIC), has the capability to interface to an outside image collection system and process the received image to separate a background from a particular object of interest for, e.g., tracking. The present invention offers versatility in the sense that there are, as will be explained in more detail below, multiple thresholding capabilities that can be changed in real-time on a per frame basis. In addition, the present invention offers spatial filtering capabilities that can be implemented in several different ways since filter coefficients are preferably programmable.</p>
<p id="p-0015" num="0014">The features of the present invention along with the attendant advantages thereof will be more fully appreciated upon a reading of the following detailed description in combination with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an exemplary implementation of a system in accordance with the present invention.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> is a flow diagram illustrating a typical image segmentation operation in accordance with a preferred embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0018" num="0017">A significant aspect of the present invention is that data is passed through one or more modules multiple times such that different algorithms can be applied to incoming pixel data received from, e.g., a camera. Real time programmable filter coefficients and multiple passes there through allows a filter to be used in different modes for, e.g., smoothing or edge detection. <figref idref="DRAWINGS">FIG. 1</figref> shows the several modules that act upon received pixel data in accordance with the present invention. A main controller <b>8</b>, including one or more registers (not shown), preferably controls each of the modules by controlling the routing of data, by enabling the modules and by setting or selecting coefficients or other variables associated with the several modules. Although not shown, main control <b>8</b> is preferably connected to each of the modules described below to effect its control functions. Also, a general purpose processor <b>6</b> would typically operate in conjunction with the system of the present invention and would, therefore, be in communication with main control <b>8</b> using well-known techniques.</p>
<p id="p-0019" num="0018">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, in a first pass, streaming serial pixel data <b>10</b> are stored in buffer RAM <b>12</b>, shown in <figref idref="DRAWINGS">FIG. 1</figref>. Optionally, pixel data <b>10</b> is passed through a filter <b>14</b>. In a preferred embodiment, filter <b>14</b> comprises a spatial filter with a 5×5 kernel and programmable coefficients. Filter <b>14</b> is described more fully below.</p>
<p id="p-0020" num="0019">In a preferred implementation, buffer RAM <b>12</b> is not implemented directly in a collective FPGA device since storing significant amounts of image data inside an FPGA would take limited FPGA resources away from the FPGA's overall processing capabilities. Internal FPGA storage of image data would also put limits on the size of an image that a given FPGA chip can handle. Having intermediate external storage capability (namely, buffer <b>12</b>) allows the chip to be used with varying image sizes. Processing larger (N×N) images then only requires additional external ram.</p>
<p id="p-0021" num="0020">After storage of the data in buffer RAM <b>12</b>, histogram module <b>16</b> generates a histogram of the data. In a preferred implementation, the histogram comprises 1024 equally spaced bins into which are assigned the individual pixels based on their respective intensities/color. The intensities may be represented by a 16 bit word, but other sized variables could also be used to represent individual pixels.</p>
<p id="p-0022" num="0021">Simultaneously with (or at least very near the time of) histogram generation, statistics regarding the data are generated in statistics module <b>18</b>. In a preferred implementation, at least a mean μ and standard deviation σ are calculated. In addition, an offset β may also be set at this stage by direct input from general purpose processor <b>6</b> with which main control <b>8</b> interacts. These values are then employed in threshold calculations as explained next.</p>
<p id="p-0023" num="0022">Threshold calculations are preferably implemented in threshold calculation &amp; select module <b>20</b> and apply threshold module <b>22</b>. In a preferred embodiment of the present invention, three different image segmentation threshold values can be implemented. A first value is one that is set to a pre-calculated value and received from general purpose processor <b>6</b>.</p>
<p id="p-0024" num="0023">A second and third type of threshold value can be calculated based on current real-time statistics received from statistics module <b>18</b>. Specifically, a single pixel comparison can be implemented with the following formula:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>T</i>=σ+β*μ (mean, std deviation &amp; offset)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0025" num="0024">Similarly, a threshold with respect to four neighboring pixels (a 2×2 array) may be implemented with the following formula:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>T=</i>4*σ+β*μ (mean, std deviation &amp; offset)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0026" num="0025">As indicated in each of the above threshold values, the present invention preferably supports the possibility of employing an offset β to the threshold value such that for each image frame processed, there can be two sets of data that represent exceedance pixels vis-à-vis the threshold value.</p>
<p id="p-0027" num="0026">With a threshold value selected, the apply threshold module <b>22</b> receives image data from buffer <b>12</b> and applies the threshold value that was selected. Resulting exceedance pixels are then preferably written to an external ram (not shown). In the preferred embodiment of the present invention, calculation &amp; select threshold module <b>20</b> is controllable via a register for fine tuning the threshold depending on the particular environment or nature of the image data that is being processed.</p>
<p id="p-0028" num="0027">As mentioned previously, filter <b>14</b> may be employed to smooth image data or to detect edges of an image. In a preferred implementation, filter <b>14</b> is a spatial filter having a 5×5 image mask with 25 programmable coefficients. Such filters are well known in the art and will not be described herein except to say that 25 parallel and pipelined multipliers with adders allow the filter to run in optimum cycles. The programmable filter coefficient allows the filter to be used in virtually any type of spatial filtering operation, such as Smoothing filtering, Convolutional filtering for image de-blurring, and the like. A fixed point full precision arithmetic filter is preferably implemented to accommodate the full precision needed for the fourteen or sixteen bit pixel size and sixteen bit coefficient math. For each addition operation a separate adder is used to avoid throughput delays and intermediate overflows.</p>
<p id="p-0029" num="0028">As will be appreciated by those skilled in the art, the present invention provides an image processing system that is particularly useful for tracking or object detection, which might be a critical functional component of an automatic steering system for a vehicle. For an automatic steering system, incoming fast imagery must be processed to extract objects of distinct characteristics such as a lane dividing line that can then be used to determine which direction to steer the vehicle.</p>
<p id="p-0030" num="0029">The image processing system according to the present invention has the capability to interface to such a system, process the image, and separate the background from the object of interest for tracking. The present invention provides multiple thresholding capabilities that can be changed in real-time on a per frame basis in view of the continuous generation of statistics and their use in threshold calculation processes. In addition, spatial filtering is provided in such a way that different modes of the filter can be implemented by programming the filter with different coefficients. The following is an instance in which it is desirable to have dynamic threshold calculation.</p>
<p id="p-0031" num="0030">Change of threshold: For case where an object of interest is moving toward or away from the camera, the energy in each pixel will change accordingly. This requires that the system, on a real time basis, be able to adjust its threshold. Such is the case for the real time calculation of thresholds based on background statistics.</p>
<p id="p-0032" num="0031">The following is an example of filter selection, which is typically a function of the application at hand. The following is an example of uniform smoothing filter:</p>
<p id="p-0033" num="0032">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mtable>
    <mtr>
      <mtd>
        <mrow>
          <mi>Uniform</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>Smoothing</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>filter</mi>
        </mrow>
      </mtd>
    </mtr>
    <mtr>
      <mtd>
        <mrow>
          <mo>(</mo>
          <mtable>
            <mtr>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
              <mtd>
                <mn>0.04</mn>
              </mtd>
            </mtr>
          </mtable>
          <mo>)</mo>
        </mrow>
      </mtd>
    </mtr>
  </mtable>
  <mo> </mo>
</mrow>
</math>
</maths>
</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0034" num="0033">While the present invention has been impliedly described thus far as operating filter <b>14</b> only once per frame, it is also possible to employ filter <b>14</b> multiple times before a histogram or statistics are generated, by looping data output from filter <b>14</b> back to buffer <b>12</b> and then re-inputting that buffer data back to filter <b>14</b>. Accordingly, the filter can be employed multiple times for a single image segmentation process. For example, in the case of edge detection, two different filter coefficients are preferably run to get a single result. The Sobel filter which enhances edges in all directions is a good example. It is implemented through two independent convolutions (spatial filtering) with the coefficient kernel. The following are the two filter that would be used, once with no rotation and then by 90 degrees rotation. The results of each kernel run are combined to form the final result.</p>
<p id="p-0035" num="0034">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
  <mstyle>
    <mtext>Sobel fitler (0 degrees)</mtext>
  </mstyle>
</math>
</maths>
<maths id="MATH-US-00002-2" num="00002.2">
<math overflow="scroll">
  <mrow>
    <mo> </mo>
    <mrow>
      <mo>(</mo>
      <mtable>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>1.00</mn>
          </mtd>
          <mtd>
            <mn>2.00</mn>
          </mtd>
          <mtd>
            <mn>1.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>-</mo>
              <mn>1.00</mn>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>-</mo>
              <mn>2.00</mn>
            </mrow>
          </mtd>
          <mtd>
            <mrow>
              <mo>-</mo>
              <mn>1.00</mn>
            </mrow>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
      </mtable>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</maths>
</p>
<p id="p-0036" num="0035">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
  <mstyle>
    <mtext>Sobel fitler (90 degrees)</mtext>
  </mstyle>
</math>
</maths>
<maths id="MATH-US-00003-2" num="00003.2">
<math overflow="scroll">
  <mrow>
    <mo> </mo>
    <mrow>
      <mo>(</mo>
      <mtable>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>1.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>-</mo>
              <mn>1.00</mn>
            </mrow>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>2.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>-</mo>
              <mn>2.00</mn>
            </mrow>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>1.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mrow>
              <mo>-</mo>
              <mn>1.00</mn>
            </mrow>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
          <mtd>
            <mn>0.00</mn>
          </mtd>
        </mtr>
      </mtable>
      <mo>)</mo>
    </mrow>
  </mrow>
</math>
</maths>
</p>
<p id="p-0037" num="0036">Thus, the present invention, by incorporating several components together as shown, and controlling when and how those components operate on data, enables increased image processing speed, which is particularly useful in real time applications where image data is preferably acted upon on a frame-by-frame basis.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 2</figref> is a flow diagram illustrating a typical image segmentation operation in accordance with a preferred embodiment of the present invention. The process is generally shown by reference <b>200</b> and comprises the following steps. At step <b>210</b> pixel data is stored, preferably in a buffer. Then, at step <b>212</b>, the data stored in the buffer is filtered either, e.g., to smooth the image or to detect edges of an image. Then, at step <b>214</b> it is determined whether additional filtering might be desirable. For example, in accordance with the present invention, it is possible to programmatically modify the coefficients of the filter so that the filter can be used again to filter data, but in a different manner. For example, if the first filtering step smoothed an image, then a second pass through the filter might be operable to detect edges of an image. If no more filtering is desired, then at step <b>216</b> a histogram of the data is generated. At step <b>218</b> the histogram is output, typically, to a general purpose processor that is operating in conjunction with the apparatus of the present invention.</p>
<p id="p-0039" num="0038">Substantially simultaneously, at step <b>220</b> a set of statistics is generated with respect to the data stored in the buffer. These statistics can be based on the original data stored in the buffer or on post filtering data which is again preferably stored in the buffer. After statistics are generated, a threshold is calculated and selected at step <b>222</b>. In accordance with the present invention, a threshold can be based on the statistics just generated, or may be instead programmatically set by the general purpose processor via registers in a control module or mechanism. Once the desired threshold is selected it is applied, at step <b>224</b>, to the data stored in the buffer. The results of the application of the threshold to this data are what are termed “exceedance data,” which is output together with the histogram to the general purpose processor or another DSP stage separate from the general purpose processor. The histogram data can be used by the general purpose processor as may be desired.</p>
<p id="p-0040" num="0039">As will be readily appreciated by those skilled in the art, the present invention is particularly efficient in performing an image segmentation process due to the facility with which the filter can be employed and the fact that different thresholds can be applied. More particularly, by enabling multiple passes of the data through an FPGA by controlling data flow from and to buffer <b>12</b>, it is possible to maximize FPGA resources that are allocated to image processing and maximize flexibility with respect to image size.</p>
<p id="p-0041" num="0040">The foregoing disclosure of the preferred embodiments of the present invention has been presented for purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many variations and modifications of the embodiments described herein will be apparent to one of ordinary skill in the art in light of the above disclosure. The scope of the invention is to be defined only by the claims appended hereto, and by their equivalents.</p>
<p id="p-0042" num="0041">Further, in describing representative embodiments of the present invention, the specification may have presented the method and/or process of the present invention as a particular sequence of steps. However, to the extent that the method or process does not rely on the particular order of steps set forth herein, the method or process should not be limited to the particular sequence of steps described. As one of ordinary skill in the art would appreciate, other sequences of steps may be possible. Therefore, the particular order of the steps set forth in the specification should not be construed as limitations on the claims. In addition, the claims directed to the method and/or process of the present invention should not be limited to the performance of their steps in the order written, and one skilled in the art can readily appreciate that the sequences may be varied and still remain within the spirit and scope of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298898-20071120-M00001.NB">
<img id="EMI-M00001" he="23.96mm" wi="35.64mm" file="US07298898-20071120-M00001.TIF" alt="embedded image " img-content="table" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002 MATH-US-00002-2" nb-file="US07298898-20071120-M00002.NB">
<img id="EMI-M00002" he="24.72mm" wi="76.20mm" file="US07298898-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003 MATH-US-00003-2" nb-file="US07298898-20071120-M00003.NB">
<img id="EMI-M00003" he="24.72mm" wi="76.20mm" file="US07298898-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A digital signal processing apparatus, comprising:
<claim-text>a buffer memory operable to store pixel data;</claim-text>
<claim-text>a histogram generating module in communication with the buffer memory, the histogram generating module operable to generate a histogram of the pixel data;</claim-text>
<claim-text>a statistics generating module in communication with the buffer memory, the statistics generating module operable to generate statistics regarding the pixel data;</claim-text>
<claim-text>a threshold select module for selecting one of a plurality of thresholds and an apply threshold module for applying the selected threshold to data stored in the buffer; and</claim-text>
<claim-text>a control module for controlling each of the buffer, histogram, statistics and threshold modules by updating registers in at least one of the buffer, histogram, statistics and threshold modules to cause a re-flow of the data through at least one of the buffer, histogram, statistics and threshold modules, wherein a portion of the data is passed through at least one of the buffer, histogram, statistics and threshold modules at least twice based on the statistics generated for the portion of the re-flowed data, wherein a histogram and exceedance data that exceed the selected threshold are provided to a downstream general purpose processor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a filter.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the filter is a spatial filter.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the filter comprises programmable coefficients.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the filter is operable to be at least one of a smoothing filter and an edge detecting filter.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the histogram is comprised of 1024 bins.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the statistics generating module is operable to calculate at least a mean and standard deviation.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the selected threshold is settable by the general purpose processor.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the selected threshold is based on the generated statistics.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein two sets of exceedance data are provided to the downstream general purpose processor.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein a difference between a first set and a second set of exceedance data is based on an application of an offset value associated with the threshold.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. An image segmentation apparatus, comprising:
<claim-text>a buffer memory operable to store pixel data;</claim-text>
<claim-text>a digital filter in communication with the buffer memory;</claim-text>
<claim-text>a histogram generating module in communication with the buffer memory, the histogram generating module operable to generate a histogram of the pixel data;</claim-text>
<claim-text>a statistics generating module in communication with the buffer memory, the statistics generating module operable to generate statistics regarding the pixel data;</claim-text>
<claim-text>a threshold select module for selecting one of a plurality of thresholds and an apply threshold module for applying the selected threshold to data stored in the buffer; and</claim-text>
<claim-text>a control module for controlling each of the buffer, histogram, statistics and threshold modules by updating registers in at least one of the buffer, histogram, statistics and threshold modules to cause a re-flow of the data through at least one of the buffer, histogram, statistics and threshold modules, wherein a portion of the data is passed through at least one of the buffer, histogram, statistics and threshold modules at least twice based on the statistics generated for the portion of the re-flowed data,</claim-text>
<claim-text>wherein a histogram and exceedance data that exceed the selected threshold are provided to a downstream general purpose processor.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the filter is a spatial filter.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the filter has programmable coefficients.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the filter is operable to be at least one of a smoothing filter and an edge detecting filter.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the histogram is comprised of 1024 bins.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the statistics generating module is operable to calculate at least a mean and standard deviation.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the selected threshold is settable by the general purpose processor.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the selected threshold is based on the generated statistics.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The apparatus of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the two set of exceedance data are provided to the downstream general purpose processor.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The apparatus of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein a difference between a first set and a second set of exceedance data is based on an application of an offset value associated with the threshold.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A method of performing image segmentation, comprising:
<claim-text>storing pixel data;</claim-text>
<claim-text>controlling and setting programmable filter coefficients and digitally filtering the data at least one time;</claim-text>
<claim-text>generating a histogram of the data;</claim-text>
<claim-text>generating statistics based on the data;</claim-text>
<claim-text>selecting one of a plurality of thresholds, at least one of the plurality of thresholds being calculated based on the statistics;</claim-text>
<claim-text>applying a selected threshold to the data;</claim-text>
<claim-text>outputting the histogram; and</claim-text>
<claim-text>outputting exceedance data that exceed the selected threshold, the exceedance data representing, at least partially, an image segmented from the pixel data, wherein controlling and setting programmable filter coefficients and digitally filtering the data at least one time comprises:
<claim-text>resetting the programmable filter coefficients based on the statistics;</claim-text>
<claim-text>re-inputting the data back to a filter; and</claim-text>
<claim-text>filtering the re-input data with the reset programmable filter coefficients.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, further comprising modifying the threshold level on a per pixel frame basis.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, further comprising calculating exceedance data based on an offset value added to the selected threshold.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The method of <claim-ref idref="CLM-00024">claim 24</claim-ref>, wherein two sets of exceedance data are output.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, further comprising receiving instructions from a general purpose processor.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the number of coefficients is 25 for a filter having a 5×5 pixel mask.</claim-text>
</claim>
</claims>
</us-patent-grant>
