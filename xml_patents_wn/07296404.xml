<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07296404-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07296404</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11299926</doc-number>
<date>20051212</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>137</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>F</section>
<class>16</class>
<subclass>D</subclass>
<main-group>31</main-group>
<subgroup>02</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification> 60327</main-classification>
<further-classification> 60469</further-classification>
<further-classification> 91361</further-classification>
</classification-national>
<invention-title id="d0e53">Apparatus for controlling deceleration of hydraulically powered equipment</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4757685</doc-number>
<kind>A</kind>
<name>Burckhartzmeyer</name>
<date>19880700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5025626</doc-number>
<kind>A</kind>
<name>Crosser et al.</name>
<date>19910600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5510987</doc-number>
<kind>A</kind>
<name>Song</name>
<date>19960400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5832730</doc-number>
<kind>A</kind>
<name>Mizui</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 60469</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6705079</doc-number>
<kind>B1</kind>
<name>Tabor et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6880332</doc-number>
<kind>B2</kind>
<name>Pfaff et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6883532</doc-number>
<kind>B2</kind>
<name>Rau</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 91361</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0272325</doc-number>
<kind>A1</kind>
<name>Moon</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 60426</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2007/0130933</doc-number>
<kind>A1</kind>
<name>Yoshino</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 60469</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>DE</country>
<doc-number>10163066</doc-number>
<kind>A1</kind>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>EP</country>
<doc-number>1174384</doc-number>
<kind>A1</kind>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>9041428</doc-number>
<kind>A</kind>
<date>19970200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>21</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification> 60327</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 60461</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 60469</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 91361</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>3</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070130927</doc-number>
<kind>A1</kind>
<date>20070614</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Pfaff</last-name>
<first-name>Joseph L.</first-name>
<address>
<city>Wauwatosa</city>
<state>WI</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Quarles &amp; Brady</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Haas</last-name>
<first-name>George E.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>HUSCO International Inc.</orgname>
<role>02</role>
<address>
<city>Waukesha</city>
<state>WI</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Leslie</last-name>
<first-name>Michael</first-name>
<department>3745</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A machine member driven by a hydraulic actuator may oscillate, or wag, when the hydraulic actuator decelerates or stops. The degree of oscillation is a function of the machine member's ability to track a deceleration command, which ability varies with changes in the position of the machine member and the load force acting thereon. To reduce the oscillation, a command that controls operation of the hydraulic actuator is filtered using a filter function that changes with the machine member's load. The load force exerted on the hydraulic actuator which in turn can be designated by fluid pressure that results from the hydraulic actuator. Preferably, the frequency of the filter function is varied inversely with the magnitude of the actuator load force.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="221.15mm" wi="146.39mm" file="US07296404-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="244.77mm" wi="185.59mm" file="US07296404-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="224.79mm" wi="180.76mm" file="US07296404-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="223.35mm" wi="149.61mm" file="US07296404-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">Not Applicable</p>
<heading id="h-0002" level="1">STATEMENT REGARDING FEDERALLY SPONSORED RESEARCH OR DEVELOPMENT</heading>
<p id="p-0003" num="0002">Not Applicable</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">1. Field of the Invention</p>
<p id="p-0005" num="0004">The present invention relates to hydraulically powered equipment, such as off-road construction and agricultural vehicles, and more particularly to apparatus for reducing oscillation or wag when a hydraulically driven member on the equipment is decelerating, stopping, or reversing direction.</p>
<p id="p-0006" num="0005">2. Description of the Related Art</p>
<p id="p-0007" num="0006">With reference to <figref idref="DRAWINGS">FIG. 1</figref>, a backhoe <b>2</b> is a common type of earth moving equipment that has a boom assembly <b>3</b> comprising a bucket <b>4</b> attached to the end of an arm <b>5</b> which in turn is coupled by a boom <b>6</b> to the frame of a tractor <b>7</b>. Three hydraulic cylinders <b>11</b> form actuators that are operated independently to move the bucket, arm, and boom. A pivot joint <b>8</b> allows the boom assembly <b>3</b> to swing left and right with respect to the rear end of the tractor <b>7</b>. A hydraulic boom swing cylinder <b>9</b> is attached to the boom <b>6</b> on one side of the tractor <b>8</b> and provides the driving force that swings the boom assembly. On larger backhoes, a pair of hydraulic cylinders are attached on opposite sides of the tractor <b>7</b> to swing the boom. Hydraulic fluid is supplied to the boom swing cylinder <b>9</b> through valves that are controlled by the backhoe operator.</p>
<p id="p-0008" num="0007">As the boom swings in one direction, pressurized fluid is introduced into one chamber of the boom swing cylinder <b>9</b>, designated as the “driving chamber”, and fluid is exhausted from the other cylinder chamber, referred to as the “exhausting chamber”. When the boom swings in the opposite direction, the designation of the driving and exhausting chambers is reversed. When the operator suddenly stops the boom swing, inertia causes the motion of the backhoe boom assembly <b>3</b> to continue in the previously commanded direction. The amount of inertia is a function of the mass and extension position of the boom assembly <b>3</b> and the mass of any material carried in the bucket <b>4</b>. This continued movement due to inertia compresses the hydraulic fluid in the previous exhausting chamber of the boom swing cylinder <b>9</b> and may produce cavitation in the previous driving cylinder chamber. Anti-cavitation valves typically are provided in the hydraulic system to overcome this latter problem.</p>
<p id="p-0009" num="0008">Because the control valves for the cylinder are now closed, pressure in the previous exhausting chamber eventually increases to a magnitude that causes the boom assembly <b>3</b> motion to stop and recoil by moving in the opposite swing direction. This subsequent movement produces a reversal of the pressure conditions, wherein the previous driving chamber of the boom swing cylinder <b>9</b> becomes pressurized. When the boom motion in the opposite swing direction creates a sufficiently high pressure in the previous driving chamber, another reversal of the swing motion occurs. As a result, the boom assembly swing oscillates until inherent dampening provided by other forces ultimately brings the assembly to a stop. This phenomenon is known as “bounce” or “wag” and increases the time required to properly position the boom <b>6</b>, thereby adversely affecting equipment productivity. The wag also is disconcerting to the machine operator. A similar motion phenomenon occurs when other types of hydraulically driven members stop.</p>
<p id="p-0010" num="0009">In essence, the wag is a manifestation of the inability of the boom velocity to promptly respond to, or track, changes in the position of the valve that controls the flow of fluid to the swing cylinder. In other words, the valve closes when motion of the boom is to terminate, however the load force acting on the boom does not allow the velocity of the boom to decrease fast enough.</p>
<p id="p-0011" num="0010">Various approaches have been utilized to minimize this wag. For example, U.S. Pat. No. 4,757,685 employs a separate relief valve for each hydraulic conduit connected to the swing cylinder chambers to vent fluid to a tank line when excessive pressure occurs in the associated chamber. Additional fluid is supplied from the supply line through makeup valves to counteract cavitation in the cylinder as the swing stops.</p>
<p id="p-0012" num="0011">U.S. Pat. No. 5,025,626 describes a cushioned swing circuit which also has relief and make-up valves connected to the hydraulic lines for the boom swing cylinder. This circuit also incorporates a cushion valve which in an open position provides a fluid path between the cylinder hydraulic lines. That path includes a flow restriction orifice. The cushion valve is resiliently biased into the shut position by a spring and a mechanism opens the cushion valve for a predetermined time period when the pressure differential between the cylinder chambers exceeds a given threshold. Both of these previous solution attempts required additional valves and other components.</p>
<p id="p-0013" num="0012">U.S. Pat. No. 6,705,079 describes another solution to the swing wag problem in which a sensor detects pressure in the hydraulic actuator. This pressure signal from the sensor is employed to determine the rate at which the pressure in the hydraulic actuator changes. When the rate of change of the pressure is less than a defined threshold after receiving a stop command, pressure in the hydraulic actuator is relieved, such as by opening a control valve connected to the hydraulic actuator.</p>
<p id="p-0014" num="0013">However, there still is a desire to improve the responsiveness of the boom velocity to changes in the position of the valve and the resultant flow of fluid to the associated hydraulic cylinder, and in particular to provide a simplified mechanism for reducing wag.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0015" num="0014">The present method controls deceleration of a hydraulically driven machine member. Motion of a hydraulic actuator connected to the machine member is designated by a command, which may specify a desired velocity for example. A parameter value is produced that indicates the ability of the machine member motion to respond to change in fluid flow applied to the hydraulic actuator, which change results from alteration of the position of a valve controlling that flow. That ability is represented by the magnitude of a load force that is exerted on the hydraulic actuator by the machine member, and in particular is denoted by fluid pressure from the hydraulic actuator. The parameter value is used to configure a variable filter function applied to the command to produce a filtered command which is employed to control flow of fluid to the hydraulic actuator. The filter function controls the rate at which the motion command goes to zero to stop the machine member so that the command does not close the related valve faster than a rate the actuator and machine member are able to operate.</p>
<p id="p-0016" num="0015">In one aspect of the control method, the amount of load force acting on the hydraulic actuator is employed to derive a filter frequency that defines the rate the motion command decreases to zero. The filter frequency varies inversely with changes in the load force. However, the filter frequency is preferably set to a predefined constant value when the magnitude of the load force is less than a first threshold. The filtering frequency may also be set to another predefined constant value when the magnitude of the load force is greater than a second threshold.</p>
<p id="p-0017" num="0016">Another aspect is to utilize a digital filter, in which case configuring the filter involves determining a set of filter coefficients. In the preferred embodiment, the filter coefficients are derived in response to the selected filtering frequency.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 1</figref> is a side view of a backhoe incorporating the present invention;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram of the hydraulic system for the backhoe;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 3</figref> is a control diagram for the hydraulic system;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 4</figref> graphically depicts a filter function that is applied to a backhoe boom swing command to prevent the boom wag upon stopping; and</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart of a software routine that implements the filter function.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0023" num="0022">Although the present invention is being described in the context of use on a backhoe as shown in <figref idref="DRAWINGS">FIG. 1</figref>, it has application on other types of machines in which large inertia machine functions are attached to the hydraulic actuator and exhibit controllability difficulties.</p>
<p id="p-0024" num="0023">With initial reference to <figref idref="DRAWINGS">FIG. 2</figref>, the elements of the boom assembly <b>3</b> of the backhoe <b>2</b> are moved by a novel hydraulic system <b>10</b> that includes the hydraulic actuators, such as the boom swing cylinder <b>9</b>. The hydraulic system <b>10</b> has a positive displacement pump <b>12</b> that is driven by a motor or engine (not shown) to draw fluid from a tank <b>15</b> and furnish the fluid under pressure to a supply conduit <b>14</b>. An unloader valve <b>17</b> (such as a proportional pressure relief valve) is connected between the supply conduit <b>14</b> and a tank return conduit <b>18</b> that leads to the system tank <b>15</b>. Operation of the unloader valve <b>17</b> regulates pressure in the supply conduit <b>14</b>. The novel technique for reducing wag described herein also can be implemented on a hydraulic system that employs a variable displacement pump or other types of hydraulic actuators.</p>
<p id="p-0025" num="0024">The supply conduit <b>14</b> and the tank return conduit <b>18</b> are connected to a plurality of hydraulic functions <b>19</b> and <b>20</b> on the backhoe. Separate hydraulic functions are provided for swinging the boom <b>6</b>, raising the boom, moving the arm <b>5</b> and pivoting the bucket <b>4</b>. The hydraulic function <b>20</b> for swinging the boom is illustrated in detail and other functions <b>19</b> have similar components and operation. The hydraulic system <b>10</b> is a distributed type in that the valves for each function and control circuitry for operating those valves are located adjacent to the associated hydraulic actuator. For example, those components for controlling boom swing are located at or near the swing cylinder <b>9</b> or the pivot joint <b>8</b>.</p>
<p id="p-0026" num="0025">In the boom swing function <b>20</b>, the supply conduit <b>14</b> is connected to node “s” of a valve assembly <b>25</b>, which also has a node “t” that is connected to the tank return conduit <b>18</b>. The valve assembly <b>25</b> includes a workport node “a” connected by a first hydraulic conduit <b>30</b> to the head chamber <b>26</b> of the boom swing cylinder <b>9</b>, and has another workport node “b” coupled by a second conduit <b>32</b> to the rod chamber <b>27</b> of boom swing cylinder <b>9</b>. Four electrohydraulic proportional (EHP) valves <b>21</b>, <b>22</b>, <b>23</b>, and <b>24</b> control the flow of hydraulic fluid between the nodes of the valve assembly <b>25</b> and thus control fluid flow to and from the boom swing cylinder <b>9</b>. The first EHP valve <b>21</b> is connected between nodes “s” and “a”, and controls fluid flow between the supply conduit <b>14</b> and the head chamber <b>26</b> of the boom swing cylinder <b>9</b>. The second EHP valve <b>22</b>, is connected between nodes “s” and “b” and controls flow of fluid between the supply conduit <b>14</b> and the cylinder rod chamber <b>27</b>. The third EHP valve <b>23</b> is connected between node “a” and node “t” and controls EHP flow between the head chamber <b>26</b> and the return conduit <b>18</b>. The fourth EHP valve <b>24</b>, between nodes “b” and “t”, controls fluid flow between the rod chamber <b>27</b> and the return conduit <b>18</b>.</p>
<p id="p-0027" num="0026">The hydraulic components for the boom swing function <b>20</b> also include two pressure sensors <b>36</b> and <b>38</b> which detect the pressures Pa and Pb within the head and rod chambers <b>26</b> and <b>27</b>, respectively, of boom swing cylinder <b>9</b>. Another pressure sensor <b>40</b> measures the pump supply pressure Ps at node “s”, while pressure sensor <b>42</b> detects the return conduit pressure Pr at node “t”. Pressure sensors <b>40</b> and <b>42</b> may not be present on all the hydraulic functions.</p>
<p id="p-0028" num="0027">The pressure sensors <b>36</b>, <b>38</b>, <b>40</b> and <b>42</b> for the boom swing function <b>20</b> provide input signals to a function controller <b>44</b> which produces signals that operate the four electrohydraulic proportional valves <b>21</b>-<b>24</b>. The function controller <b>44</b> is a microcomputer based circuit which receives other input signals from a computerized system controller <b>46</b>, as will be described. A software program executed by the function controller <b>44</b> responds to those input signals by producing output signals that selectively open the four electrohydraulic proportional valves <b>21</b>-<b>24</b> by desired amounts to properly operate the boom swing cylinder <b>9</b>.</p>
<p id="p-0029" num="0028">The system controller <b>46</b> supervises the overall operation of the hydraulic system by receiving operator input signals from joysticks <b>47</b> and exchanging signals with the function controllers <b>44</b> and a pressure controller <b>48</b>. The signals are exchanged among those controllers over a communication network <b>55</b> using a conventional message protocol. This enables the control functions for the hydraulic system <b>10</b> to be distributed among the different controllers <b>44</b>, <b>46</b> and <b>48</b>.</p>
<p id="p-0030" num="0029">With reference to <figref idref="DRAWINGS">FIG. 3</figref> and the boom swing function <b>20</b>, the machine operator manipulates a joystick <b>47</b> to indicate desired swing motion for the boom assembly <b>3</b>. The output signal from the joystick <b>47</b> is applied to an input of a mapping routine <b>50</b> in the system controller <b>46</b>, which converts the signal indicating the joystick position into a signal denoting a desired velocity for the hydraulic actuator being controlled. The mapping function can be linear or have other shapes as desired. The mapping routine may be implemented by an arithmetic expression that is solved by the computer within system controller <b>46</b>, or the mapping may be accomplished by a look up table stored in the system controller's memory. The output of the mapping routine <b>50</b> is a velocity command indicating the direction and speed at which the swing cylinder <b>9</b> is desired to move the boom assembly.</p>
<p id="p-0031" num="0030">The velocity commands for the swing cylinder <b>9</b> and the other hydraulic actuators <b>11</b> are sent to a setpoint routine <b>62</b> that determines the desired pressures for the supply and return conduits <b>14</b> and <b>18</b>. Specifically, the setpoint routine <b>62</b> ascertains a supply pressure required by each hydraulic function <b>19</b> and <b>20</b> and selects the greatest of those pressures as the supply conduit pressure setpoint Ps. The setpoint routine <b>62</b> also determines a return conduit pressure setpoint Pr in a similar manner. These pressure setpoints Ps and Pr are applied as inputs to the pressure controller <b>48</b> that also receives signals from a supply conduit pressure sensor <b>49</b> at the outlet of the pump, a return conduit pressure sensor <b>51</b>, and a tank pressure sensor <b>53</b>. The pressure controller <b>48</b> responds to those inputs by operating the unloader valve <b>17</b> to regulate supply conduit pressure and the tank control valve <b>16</b> to control the return conduit pressure to achieve the desires setpoint pressures.</p>
<p id="p-0032" num="0031">The velocity command for the swing cylinder <b>9</b> also is sent from the mapping routine <b>50</b> to the associated function controller <b>44</b> where it is applied to a valve opening program <b>56</b> comprises software that determines how to operate the EHP valves <b>21</b>-<b>24</b> in assembly <b>25</b> to achieve the commanded velocity of the piston rod <b>43</b>. The swing direction designated by the velocity command denotes which two of the valves EHP valves <b>21</b>-<b>24</b> are activated and an amount that those valves are to open to convey fluid to and from the swing cylinder <b>9</b>. Specifically valves <b>21</b> and <b>24</b> are opened to extend the piston rod <b>43</b> from the swing cylinder, and valves <b>22</b> and <b>22</b> are opened to retract the piston rod.</p>
<p id="p-0033" num="0032">The magnitude of the velocity command and the measured pressures (Pa, Pb, Pr, Ps) are utilized by the valve opening routine to determine the amount that each of the selected valves is to be opened to convey the amount of fluid flow necessary achieve the desired velocity of the piston <b>28</b>. U.S. Pat. No. 6,775,974 describes one embodiment of the valve opening program <b>56</b>. The resultant signals, indicating the amount that the EHP valves <b>21</b>-<b>24</b> are to open, are supplied to a set of valve drivers <b>58</b> which apply the appropriate magnitude of electric current to operate each of the two selected valves.</p>
<p id="p-0034" num="0033">The valve opening program <b>56</b> includes a software routine that mitigates wag of the boom assembly <b>3</b> that otherwise could occur when swing cylinder is desired to stop. With reference to <figref idref="DRAWINGS">FIGS. 2 and 3</figref>, assume that the backhoe operator has been swinging the boom assembly <b>3</b> in one direction. In this case, the signal from the joystick <b>47</b> for this machine operation indicates a desired velocity for the swing action. The velocity command is transmitted from the system controller <b>46</b> to the function controller <b>44</b> which controls the operation of the swing hydraulic cylinder <b>9</b>. Thus, the function controller <b>44</b> is producing signals that open either the first and fourth EHP valves <b>21</b> and <b>24</b> or the second and third EHP valves <b>22</b> and <b>23</b>, depending upon the direction of the swing.</p>
<p id="p-0035" num="0034">When the backhoe operator desires to stop the boom swing, the joystick <b>47</b> is released and allowed to return to its center, neutral position. In this position, the mapping routine <b>50</b> produces a zero velocity command which is transmitted to the function controller <b>44</b> for the swing operation. If the function controller <b>44</b> simply responded to the zero velocity command by immediately shutting the valves, a swing wag could occur, especially if the boom assembly <b>3</b> had a relatively large inertia. That function controller <b>44</b>, however, is programmed to reduce swing wag by low pass filtering the velocity command and thereby control the rate at which the EHP valves close in response to the velocity command. A dynamically varying filter function is utilized so that the swing decelerates in a controlled fashion under both relatively small and very large loads. Preferably a digital second order filter function is used.</p>
<p id="p-0036" num="0035">In order that the filtering performs satisfactorily over a wide range of load force, the filter is disabled if the increasing pressure in the cylinder chamber, which tends to brake the swing motion, exceeds a predefined threshold level. When this happens the frequency of the low pass filter is decreased to almost a frozen state which has the effect of maintaining the EHP valves <b>21</b>-<b>24</b> in the existing open position. The filter and thus the EHP valves stay in the “frozen state” until the breaking cylinder chamber pressure falls below the predefined threshold level, at which time the filter is re-enabled and continues to decay to zero. By disabling the filter while the hydraulic function is going over a relief pressure setting for the hydraulic cylinder, the position of the EHP valves are closely coupled to the speed of the piston <b>28</b>. In other words, the valves only close at a rate the machine system will support. A major advantage is that this solution to the swing wag problem does not require any additional components for the hydraulic system <b>10</b> and merely involves programming the function controller with the appropriate software routine.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 4</figref> graphically depicts the filter function <b>68</b> in terms of a relationship between the filter frequency and a load pressure differential (ΔP LOAD) between the two chambers <b>26</b> and <b>27</b> of the swing cylinder <b>9</b>. Those cylinder chamber pressures are measured by sensors <b>36</b> and <b>38</b> in <figref idref="DRAWINGS">FIG. 2</figref>. This pressure differential corresponds to the load force that the boom assembly <b>3</b> exerts on the swing cylinder <b>9</b>, which in turn corresponds to the responsiveness of the boom motion to variations in the fluid flow applied to a hydraulic actuator due to changes in the position of the respective control valve. As will be described, the filter frequency is varied as a function of changes in the load pressure differential as defined by the function for the filter depicted in <figref idref="DRAWINGS">FIG. 4</figref>. However, it should be understood that the illustrated filter function merely is exemplary and other functions and breakpoints can be utilized without departing from the concept of the present invention. In that regard, the upper and lower limits of the filter frequency have been selected as 1.1 Hz and 0.05 Hz, respectively. Applying these frequency boundaries to the filter function, defines two pressure differential thresholds. The first is a lower pressure threshold, ΔP LOAD<b>1</b>, below which the filter frequency remains constant at the maximum filter frequency (FREQ MAX). The second pressure threshold, designated ΔP LOAD<b>2</b>, is an upper threshold limit above which the filter frequency remains constant at a minimum frequency (FREQ MIN). For values of the load pressure differential between the first and second thresholds, the filter frequency varies as designated by the curved line in the graph.</p>
<p id="p-0038" num="0037">With reference to <figref idref="DRAWINGS">FIG. 5</figref>, upon the receipt of a velocity command, the function controller <b>44</b> applies an anti-wag filter routine <b>70</b> to that command. It should be understood that swing of the boom assembly <b>3</b> in one direction is arbitrarily defined as having a positive velocity, whereas swing movement in the opposite direction is designated as a negative velocity. Knowing the direction of the swing is necessary in order to determine a cylinder pressure differential value which has the proper arithmetic sign for use in subsequent calculations by the filter function. The filter routine <b>70</b> commences at step <b>71</b> where the direction of the present swing is ascertained by determining whether the velocity command is less than the prior filtered velocity command produced by the filter routine <b>70</b>. If that relationship is true, the program execution branches to step <b>72</b> at which the value of the measured pressure Pb within the rod chamber <b>27</b> of the swing cylinder is subtracted from the measured pressure Pa within the head chamber <b>26</b> to produce a differential pressure value, ΔP LOAD. Otherwise, if the expression within step <b>71</b> is false, the program execution branches to step <b>74</b> at which the measured head chamber pressure Pa is subtracted from the rod chamber pressure Pb to produce the differential pressure value, ΔP LOAD.</p>
<p id="p-0039" num="0038">Then at step <b>76</b> a determination is made whether the newly calculated value for ΔP LOAD is less than the first, or lower, threshold ΔP LOAD<b>1</b> (see <figref idref="DRAWINGS">FIG. 4</figref>). If that is the case, the program execution branches to step <b>78</b> at which a value for the anti-wag filter frequency (AWFREQ) is set to the maximum frequency value (FREQ MAX), which for example is 1.1 Hz. The program execution then jumps to step <b>86</b>. However, if the value of ΔP LOAD is not less than the first threshold, the program execution advances to step <b>80</b> at which a determination is made whether that value is greater than the second, or upper, threshold ΔP LOAD<b>2</b>. In this latter case, the program execution branches to step <b>82</b> at which the anti-wag filter frequency (AWFREQ) is set to the minimum frequency value (FREQ MIN), which for example is 0.05 Hz. Thereafter the program execution jumps to step <b>86</b>.</p>
<p id="p-0040" num="0039">However, if neither expression at step <b>76</b> or <b>80</b> is true, meaning that the value of ΔP LOAD is between the two pressure differential thresholds inclusively, the program execution advances to step <b>84</b> to calculate a value for the filter frequency. That frequency is produced by solving a series of equations, the first of which produces a value designated TEMP<b>1</b> which is equal to the value of ΔP LOAD minus the first threshold value ΔP LOAD<b>1</b>. Another value designated TEMP<b>2</b> equals the difference between the two pressure differential thresholds and is derived by subtracting the first threshold ΔP LOAD<b>1</b> from the second threshold ΔP LOAD<b>2</b>. Next a ratio is calculated by dividing TEMP<b>2</b> into TEMP<b>1</b> and squaring the result. A temporary frequency value, (FREQ TEMP) is produced by first subtracting the maximum frequency value (FREQ MAX) from the minimum frequency value (FREQ MIN) which produces a negative value that then is multiplied by the previously calculated ratio. The anti-wag frequency (AWFREQ) is produced at the final calculation step by summing the maximum frequency (FREQ MAX) with the negative value of the variable FREQ TEMP. The program execution then advances to step <b>86</b>. As the hydraulic actuator (e.g. swing cylinder <b>9</b>) slows, the pressure differential ΔP LOAD changes and step <b>84</b> dynamically changes the anti-wag frequency (AWFREQ) in a corresponding manner until the boom assembly <b>3</b> stops.</p>
<p id="p-0041" num="0040">Upon entering step <b>86</b> of the filter function <b>68</b>, the newly derived value for the anti-wag frequency (AWFREQ) is used to determine the coefficients for the filter function. Preferably, a biquadratic digital filter is employed to filter the velocity command. The filter function for a biquadratic filter is given by the expression:</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>y</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>n</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <mrow>
              <mi>B</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>0</mn>
              <mo>*</mo>
              <mrow>
                <mi>x</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>n</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mrow>
              <mi>B</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>1</mn>
              <mo>*</mo>
              <mrow>
                <mi>x</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mrow>
              <mi>B</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>2</mn>
              <mo>*</mo>
              <mrow>
                <mi>x</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mrow>
            <mrow>
              <mi>A</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>1</mn>
              <mo>*</mo>
              <mrow>
                <mi>y</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mrow>
              <mi>A</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>2</mn>
              <mo>*</mo>
              <mrow>
                <mi>y</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where y(n) is the filter function output referred to as a filtered velocity command, terms A<b>1</b>, A<b>2</b>, B<b>0</b>, B<b>1</b> and B<b>2</b> are filter coefficients, x(n) is the present value of the velocity command, x(n−1) and x(n−2) are the previous two values of the velocity command, and y(n−1) and y(n−2) are the previous two values of the output of the filter.
</p>
<p id="p-0043" num="0042">The filter coefficients are defined according to the equations provided at that step <b>86</b> in <figref idref="DRAWINGS">FIG. 5</figref>. Specifically the value for coefficient A<b>0</b> is produced by multiplying the anti-wag frequency (AWFREQ) by a gain factor and adding an offset. However, it will be understood by those skilled in the art, that not only can the filter coefficients for a biquadratic filter be defined in a other manners, other types of filters and filter functions may be utilized to reduce the effects of swing wag. Next the defined filter coefficients are passed to the conventional digital biquadratic filter at step <b>88</b> to configure that filter. Then at step <b>90</b>, the filter function is applied to the present velocity command to produce the filtered velocity command, which is utilized by the valve opening program <b>56</b> in <figref idref="DRAWINGS">FIG. 2</figref> to produce the signals for operating the four electrohydraulic valves <b>21</b>-<b>24</b>.</p>
<p id="p-0044" num="0043">Thus, the filter routine varies the filter frequency depending upon the load force that the backhoe boom assembly <b>3</b> exerts on the hydraulic actuator, i.e. the swing cylinder <b>9</b> and piston <b>28</b>. This frequency variation conforms to the filter function graphically depicted in <figref idref="DRAWINGS">FIG. 4</figref>, such that the greater the load force, the lower the filter frequency and hence, the slower the response of the valve assembly <b>25</b> to changes of the velocity command. By adapting, the filter function to the magnitude of the load force acting on the swing cylinder <b>9</b>, the command filtering is optimized. Under relatively small load force conditions, which produce a commensurate low amount of inertia, a relatively high filter frequency is employed. As the load force and resultant inertia increases, the filter frequency decreases to adequately control the valve assembly <b>25</b> to decelerate the boom sufficiently fast to avoid the wag.</p>
<p id="p-0045" num="0044">The foregoing description was primarily directed to a preferred embodiment of the invention. Although some attention was given to various alternatives within the scope of the invention, it is anticipated that one skilled in the art will likely realize additional alternatives that are now apparent from disclosure of embodiments of the invention. Accordingly, the scope of the invention should be determined from the following claims and not limited by the above disclosure.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07296404-20071120-M00001.NB">
<img id="EMI-M00001" he="7.03mm" wi="76.20mm" file="US07296404-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for controlling motion of a machine member that is driven by fluid applied to a hydraulic actuator connected to the machine member, the method comprising:
<claim-text>producing a command that designates desired motion of the machine member;</claim-text>
<claim-text>producing a parameter value that denotes responsiveness of the motion of the machine member to changes in flow of the fluid applied to the hydraulic actuator;</claim-text>
<claim-text>configuring a filter function that varies in response to the parameter value;</claim-text>
<claim-text>applying the filter function to the command to produce a filtered command; and</claim-text>
<claim-text>controlling the flow of fluid to the hydraulic actuator in response to the filtered command.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the parameter value corresponds to magnitude of a load force that acts on the hydraulic actuator.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein producing a parameter value comprises sensing fluid pressure resulting from the machine member acting on hydraulic actuator.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the hydraulic actuator comprises a cylinder having two chambers; and the parameter value is a function of a difference in pressures in the two chambers.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein configuring a filter function comprises utilizing a constant filter function when the parameter value is less than a threshold level.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein configuring a filter function comprises utilizing a constant filter function when the parameter value is greater than a threshold level.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein configuring a filter function comprises deriving a filtering frequency which varies in response to the parameter value.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method as recited in <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the filtering frequency varies inversely with change in a magnitude of the parameter value.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein applying the filter function employs a biquadratic filter function.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein applying the filter function controls a rate at which the flow of fluid to the hydraulic actuator changes in response to the command.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein controlling flow of fluid to the hydraulic actuator comprises operating a hydraulic valve assembly.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A method for controlling deceleration of a machine member that is driven by a hydraulic actuator, the method comprising:
<claim-text>producing a velocity command that designates a desired velocity for the hydraulic actuator;</claim-text>
<claim-text>determining magnitude of a load force that acts on the hydraulic actuator;</claim-text>
<claim-text>configuring a filter in response to the magnitude of the load force;</claim-text>
<claim-text>filtering the velocity command to produce a filtered command; and</claim-text>
<claim-text>controlling flow of fluid to the hydraulic actuator in response to the filtered command.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein determining the magnitude of the load force comprises sensing fluid pressure that results from the load force acting on hydraulic actuator.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein the hydraulic actuator comprises a cylinder having two chambers; and determining the magnitude of the load force comprises determining a difference in pressures in the two chambers.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein configuring a filter comprises deriving a filtering frequency which varies in response to the magnitude of the load force.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein deriving a filtering frequency comprises setting the filtering frequency to a predefined constant value when the magnitude of the load force is less than a threshold.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein deriving a filtering frequency comprises setting the filtering frequency to a predefined constant value when the magnitude of the load force is greater than a threshold.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein configuring the filter further comprises defining a set of filter coefficients in response to the filtering frequency.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein the filter comprises a digital filter; and configuring the filter comprises defining a set of filter coefficients in response to the magnitude of the load force.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein filtering the velocity command employs a biquadratic filter.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The method as recited in <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein filtering the velocity command controls a rate at which the flow of fluid to the hydraulic actuator changes in response to the velocity command.</claim-text>
</claim>
</claims>
</us-patent-grant>
