<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299136-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299136</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11207398</doc-number>
<date>20050819</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>N</subclass>
<main-group>31</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>702 22</main-classification>
</classification-national>
<invention-title id="d0e43">Method and apparatus for estimating of fluid contamination downhole</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5223715</doc-number>
<kind>A</kind>
<name>Taylor</name>
<date>19930600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>250343</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6274865</doc-number>
<kind>B1</kind>
<name>Schroer et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>2502691</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6343507</doc-number>
<kind>B1</kind>
<name>Felling et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 7315219</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6350986</doc-number>
<kind>B1</kind>
<name>Mullins et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>2502691</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6714872</doc-number>
<kind>B2</kind>
<name>DiFoggio et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>702 12</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6956204</doc-number>
<kind>B2</kind>
<name>Dong et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>250256</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2004/0000400</doc-number>
<kind>A1</kind>
<name>Fujisawa et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>16625001</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00008">
<othercit>Lee et al., Fluid Sampling From Damaged Formations, SPE 39817, 1998, pp. 565-570.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Sarkar et al., Adverse Effects Of Poor Mud Cake Quality: A Supercharging And Fluid Sampling Study, SPE 48958, 1998, pp. 1-12.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Mullins et al., Real-Time Quantification Of OBM Filtrate Contamination During Openhole Wireline Sampling By Optical Spectroscopy, SPWLA 41<sup>st </sup>Annual Logging Symposium, Jun. 4-7, 2000, pp. 1-10.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>19</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>702  9</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 11</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 12</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 14</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 22- 25</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 30</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 35</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 50</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 66</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 73</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 79</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702100</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702116</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702141</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702183</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>250256</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>2502691</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 7315204</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 7315205</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 7315208</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 7315209</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>13</number-of-figures>
</figures>
<us-related-documents>
<continuation-in-part>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>11112626</doc-number>
<kind>00</kind>
<date>20050422</date>
</document-id>
<parent-status>ABANDONED</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>11207398</doc-number>
</document-id>
</child-doc>
</relation>
</continuation-in-part>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060236758</doc-number>
<kind>A1</kind>
<date>20061026</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>DiFoggio</last-name>
<first-name>Rocco</first-name>
<address>
<city>Houston</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Pohl</last-name>
<first-name>Bernardo</first-name>
<address>
<city>Houston</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Madan, Mossman &amp; Sriram, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Baker Hughes Incorporated</orgname>
<role>02</role>
<address>
<city>Houston</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Wachsman</last-name>
<first-name>Hal</first-name>
<department>2857</department>
</primary-examiner>
<assistant-examiner>
<last-name>Charioui</last-name>
<first-name>Mohamed</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention provides method and apparatus for quantifying sample clean up in real time by providing curve-fitting measurements of optical or other physical properties of fluid downhole. Fluid is extracted from the formation surrounding a borehole. As fluid continues to be extracted the composition of the extracted fluid changes, altering the measured values of optical and physical properties of the fluid. Measurements are made of optical or physical properties of the sampled fluid, analysis is performed on the acquired measured data points.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="51.73mm" wi="125.90mm" file="US07299136-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="209.13mm" wi="85.01mm" orientation="landscape" file="US07299136-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="205.99mm" wi="113.71mm" file="US07299136-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="227.92mm" wi="136.23mm" file="US07299136-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="226.31mm" wi="125.05mm" file="US07299136-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="212.34mm" wi="128.61mm" file="US07299136-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="224.45mm" wi="144.70mm" orientation="landscape" file="US07299136-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application is a Continuation-In-Part of the U.S. patent application Ser. No. 11/112,626 filed on Apr. 22, 2005, now abandoned.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The invention relates generally to a method and apparatus for quantifying fluid contamination as an indication of sample cleanup in real time in a wellbore environment. Specifically, the invention is a method and apparatus for measurement of physical properties of fluid being pumped from a formation surrounding a wellbore by a wireline or monitoring while drilling tool to estimate sample cleanup or to predict the time at which a sample having a desired purity can be obtained.</p>
<p id="p-0005" num="0004">2. Summary of the Related Art</p>
<p id="p-0006" num="0005">In wellbore exploration, typically drilling muds such as oil-based muds and synthetic-based muds or water-based muds are used. The filtrates from these muds generally invade the formation through the borehole wall to an extent, meaning that this filtrate must be removed from the formation in order to access the formation fluids. Open hole sampling is an effective way to acquire representative reservoir fluids. Sample acquisition allows determination of critical information for assessing the economic value of reserves. In addition, optimal production strategies can be designed to handle these complex fluids. In openhole sampling, initially, the flow from the formation contains considerable filtrate, but as this filtrate is drained from the formation, the flow increasingly becomes richer in formation fluid. That is, the sampled flow from the formation contains a higher percentage of formation fluid as pumping continues.</p>
<p id="p-0007" num="0006">It is well known that fluid being pumped from a wellbore undergoes a clean-up process in which the purity of the sample increases over time as filtrate is gradually removed from the formation and less filtrate appears in the sample. Here, f<sub>p </sub>is defined to be the fraction of purity and f<sub>c </sub>to be the fraction of contamination, where f<sub>p</sub>+f<sub>c</sub>=1. As the composition of the sampled formation fluid changes, so do the optical and physical properties of the sampled fluid, such as optical absorption, fluorescence, refractive index, viscosity, density, sound speed, and bulk modulus. A number of different measurements are used to determine various optical and physical properties of a fluid downhole in real time. Measuring these properties of the fluid therefore provides qualitative insight into a fluid sample's purity but does not provide a quantitative value, f<sub>p</sub>, for the fluid sample's purity. There has been a mistaken notion that, after pumping for a long time, the fraction of fluid contamination necessarily drops to zero. Actually, in many cases where, after a long pumping time, some optical or physical property was not substantially changing yet the fraction of contamination (as subsequently determined in a surface lab) was far from zero and was even as high as 45%. In that case, the terminal purity was only 55%.</p>
<p id="p-0008" num="0007">At long pumping times, a dynamic equilibrium can be reached in which a fluid sample being withdrawn from a tapped zone cleans up at the same rate that it is being recontaminated from above and below that tapped zone. Thus, even though a downhole measured property (OD, etc.) has substantially stopped changing, the sample is still not at 100% purity. This dynamic equilibrium depends on various factors such as the ratio of the vertical to horizontal permeability. Therefore, we define f<sub>tp </sub>to be the fraction of the terminal purity, where the terminal purity is the purity achieved at very long pumping times and is usually less than 100%. All that we can estimate by monitoring changes in OD or some other property over time (or over volume pumped) is the fraction of the terminal purity, f<sub>tp</sub>, but not the fraction of formation-fluid purity, f<sub>p</sub>.</p>
<p id="p-0009" num="0008">When extracting fluids from a formation, it is desirable to quantify the cleanup progress, that is, the degree of filtrate contamination in real time. If it is known that there is too much filtrate contamination in the sample (more than about 5% or 10%), then there is no reason to collect the formation fluid sample in a sample tank until the contamination level drops to an acceptable level. On the other hand, if by pumping for a very long time, it is possible to achieve only slightly better contamination level, an operator ends up wasting very expensive rig time and also risks the very costly possibility of allowing a tool to become stuck in the wellbore. Thus, there is a need to determine how long one must pump to obtain a suitable purity sample from the formation.</p>
<p id="p-0010" num="0009">When pumping first begins, the fluid being pumped contains a large amount of mud filtrate contamination and the fluid filtrate percentage is decreasing at the fastest rate. This process of decreasing fluid filtrate contamination is referred to as sample clean up. Later, the pumped fluid contains less contamination and the fluid filtrate percentage decreases at a slower rate. Mullins, et. al. published paper on curve fitting of a sample's absorbance versus time to monitor clean up in real time, entitled “Real Time Determination of Filtrate Contamination During Openhole Wireline Sampling by Optical Spectroscopy,” SPWLA, 41<sup>st </sup>Annual Meeting, Dallas, Tex., June, 2000. The U.S. Pat. Nos. 6,274,865 and 6,350,986 also discuss such curve fitting.</p>
<p id="p-0011" num="0010">In this paper, Mullins et al. assume that the rate of sample cleanup as measured by observing optical density progresses as t<sup>−5/12 </sup>where t is time. This clean up rate is based on empirical experience in the Gulf of Mexico and elsewhere. However, Mullins et al. also states that, for extended pumping durations, that the sample cleanup rate for shallow invasion progresses as t<sup>−1/3 </sup>and that the cleanup rate for deeper invasions progresses as t<sup>−2/3</sup>. Clearly, an assumption of a sample clean rate of t<sup>−5/12 </sup>can be rigid and inapplicable to real time situations. Moreover, using time as a fitting parameter necessarily assumes a constant pumping rate. Another problem with monitoring sample clean up over time by looking at optical absorption over time is that sand particles and other particulates can cause considerable scattering, which causes the absorption values measured over time to “jump” and appear noisy. Thus, there is a need for a more flexible model regarding the estimation of formation cleanup based on fluid properties and characteristics for downhole pumping in real time.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0012" num="0011">The present invention provides a method and apparatus of quantifying sample clean up in real time from measurement data over time (or over volume) of some optical or physical properties of fluid samples taken from a formation surrounding a borehole. Sample fluid is extracted from the formation surrounding the borehole. As fluid continues to be extracted from the formation, the composition of the sampled fluid changes, altering the measured values of an optical or physical property for the sampled fluid.</p>
<p id="p-0013" num="0012">In a first aspect of the present invention, a method and apparatus are provided that fit fluid measurement data to a non-asymptotic curve. One example of a non-asymptotic curve is a curve (e.g., a power series approximation), which provides an improved fit to the data over the typical pumping time and, which can also be successfully extrapolated to several times that pumping time, but which approaches plus or minus infinity at infinite times. Another example of a non-asymptotic curve is an equation that has an oscillatory component such as a sine wave, which never reaches a fixed limit. The sine wave can be adjusted in frequency, phase and amplitude to provide an improved fit to pulses in the monitored response that are associated with each stroke of the pump. In a third aspect of the invention, a method and apparatus are provided that perform pattern recognition of a straight line to a best fit of the measured data in log-log space.</p>
<p id="p-0014" num="0013">For best performance, spikes in the data are removed first. The remaining data are piecewise smoothed over a rolling interval of 100 or more neighboring points using a smoothing function. For example, a fit can be performed for absorbance over a rolling time segment using a non-asymptotic fitting equation such as, A=b<sub>0</sub>+b<sub>1</sub>t+b<sub>2</sub>t<sup>2</sup>. Then, by calculus, A′=dA/dt=b<sub>1</sub>+2b<sub>2</sub>t and A′/A=(b<sub>1</sub>+2b<sub>2</sub>t)/(b<sub>0</sub>+b<sub>1</sub>t+b<sub>2</sub>t<sup>2</sup>). Then, for an equation of the form, A(t)=A<sub>0</sub>−A<sub>1</sub>t<sup>−p</sup>, one can do a linear regression of ln(dA/dt) against ln(t) to obtain the slope and intercept and from these calculate, −p=(1+Slope) and −A<sub>1</sub>=exp(Intercept−ln(1+Slope)). In this way, there is not an assumption of a value of − 5/12, of −⅔, or of any other fixed value for −p. Instead, one can estimate f<sub>tp</sub>=A/A<sub>0 </sub>from the best-fit values for p and A<sub>1</sub>, and from twice the average of A(t) and A<sub>1</sub>t<sup>−p </sup>at a plurality of times.</p>
<p id="p-0015" num="0014">The method and apparatus of the present invention can use a data-fitting equation such as log(1−f<sub>tp</sub>)=(−p)log(t)+log(A<sub>1</sub>/A<sub>0</sub>), which is the equation of a straight line that has no (Y=constant) asymptote, except for the meaningless case of p=0. The method and apparatus perform a series of regressions using different estimates of A<sub>0 </sub>but do not actually calculate A<sub>0</sub>, itself. For example, one can start with the current value, A, at a time t, as the first estimate of A<sub>0</sub>, then proceed to a slightly higher value of A+ε, then to an even higher value of A+2ε, and so on. The A<sub>0 </sub>value for which the fit to the measured data is closest to the shape of a straight line (based on the highest coefficient of determination, or R-squared value) then becomes the best estimate of an A<sub>0 </sub>value. In a third aspect the method and apparatus of the present invention a method and apparatus are provided that fit a differentiable curve to measurement data or physical property data derived from the measurement data. The present invention then estimates f<sub>tp </sub>from the ratio of (dA/dt) to A. In a fifth aspect of the present invention a method and apparatus are provided that fit an asymptotic curve to difference of two responses such as the difference of two absorbances associated with different wavelengths (optical channels) rather than to an absorbance itself. Using an absorbance difference removes the baseline offsets caused by passing sand particles or bubbles.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE FIGURES</heading>
<p id="p-0016" num="0015">Other objects and advantages of the invention will become apparent upon reading the following detailed description and upon reference to the accompanying drawings in which:</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram of the Fluid Characterization Module;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref> is an illustration an embodiment of the present invention deployed in a borehole using a plurality of sources and sensors;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIGS. 3-10</figref> are charts of functions performed in embodiments of the invention;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 11</figref> is an illustration of an embodiment of the invention using an acoustic transducer;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 12</figref> is an illustration of an embodiment of the invention using a pyroelectric array; and</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 13</figref> is an illustration of an illustration of a function performed in another embodiment of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a schematic representation for a downhole fluid characterization module for obtaining and analyzing optical measurement data. A light source <b>101</b> (e.g. tungsten light bulb) emits light toward a fluid <b>110</b>. The light can be collimated by a collimating lens device <b>103</b> lying between the light source and the fluid <b>110</b>. The collimated light <b>111</b> is incident generally perpendicular to a first sapphire window <b>301</b> adjacent sample <b>110</b>. Sapphire windows <b>301</b> and <b>303</b> lie generally perpendicular to the collimated beam of light and are separated by a gap or channel <b>304</b> enabling a fluid <b>110</b> to flow between them. An optical property of the fluid, for example, including but not limited to reflectance, absorbance and fluorescence of light from the fluid is measured over time by an optical sensor, such as but not limited to a spectrometer <b>105</b>. A processor is provided to estimate fluid properties in the processor <b>113</b> from the optical measurements. The processor <b>113</b> includes memory. The existing tools (<figref idref="DRAWINGS">FIG. 1</figref>) can be fitted with a UV or infrared light source <b>112</b>, which can be turned on when the tungsten light source <b>101</b> is turned off. The same spectrometer, for example, comprising single wavelength filters over photodiodes, enables collecting the crude oil fluorescence and infrared spectra. The processor <b>113</b> includes memory and performs calculations using equations to estimate fluid properties, such as percent contamination, from the optical measurements for the fluid as described herein.</p>
<p id="p-0024" num="0023">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, additional measurements from additional sources and sensors can be added, including but not limited to a flexural mechanical resonator, acoustic transducer, pyroelectric array and infrared light source. More detailed schematics of the acoustic transducer and the pyroelectric array are shown in <figref idref="DRAWINGS">FIGS. 11 and 12</figref>. These additional sources and sensors can be provided for measurements of fluid parameters including but not limited to viscosity, density, sound speed, fluorescence, attenuated total reflectance, refractive index and bulk modulus. Additional description on the operation of these sources and sensors can be found in co-pending patent application Ser. No. 11/051,388 filed on Feb. 4, 2005, entitled, A Method and Apparatus for Analyzing a Downhole Fluid Using a Thermal Detector, which is hereby incorporated by reference in its entirety; U.S. patent application Ser. No. 10/144,965 filed on May 14, 2002 entitled Method and apparatus for Downhole Fluid Characterization Using Flexural Mechanical Resonators, which is hereby incorporated by reference in its entirety; and Ser. No. 10/051,388 filed on Mar. 16, 2004 entitled Method and Apparatus for Acoustic Pulse Decay Density Determination, which is hereby incorporated by reference in its entirety. These measurements can be monitored over time to estimate fractional terminal purity as discussed below.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an embodiment of the present invention <b>100</b> deployed in a borehole <b>12</b> drilled from the surface <b>15</b> and formed in a formation <b>16</b>. A probe <b>14</b> is provided for extraction of fluid from the formation. The present invention is contained in a downhole tool <b>20</b>. The downhole tool is deployed from a wireline or drill string <b>18</b>. One of the problems with monitoring the cleanup over time by looking at the optical absorption over time (over a 2 mm path length) is that sand particles and other particulates cause considerable scattering, which makes the absorption over time “jump” a lot and look very noisy. Monitoring cleanup over time by monitoring refractive index (which is an interface-based technique) is less sensitive to particulates in the fluid stream because one is only looking at a thin layer of fluid that is in direct contact (at the interface) with the sapphire window. Similarly, for crude oils, fluorescence only sees a thin layer of crude oil near the window and therefore, it is very insensitive to particulates in the stream.</p>
<p id="p-0026" num="0025">Prior systems used the functional form for the cleanup approximated by ln(OD)=C−D/t<sup>p </sup>discussed below. Some prior systems calculated the percentage of contamination by assuming that, upon reaching asymptotic optical absorbance, the sample had achieved zero contamination. Other prior systems, however, assumed that a dynamic equilibrium can be reached between fluid clean up and continued filtrate incursion, depending on the ratio of vertical to horizontal permeability and other factors. Thus, the contamination may not drop to zero, but only to some minimum value, even after very long pumping times. That is, the terminal contamination level represents the minimum contamination but, not necessarily, zero contamination.</p>
<p id="p-0027" num="0026">As the composition of the sampled formation fluid properties change, so do the optical and physical properties of the sampled fluid, such as optical absorption, fluorescence, refractive index, viscosity, density, sound speed, and bulk modulus. These properties can be monitored to estimate the fraction of terminal purity, which is the degree of formation fluid clean up. As an example of formation fluid clean-up, simulation results and actual field data for optical density can be fitted to forms such as, Y=mX<sup>−p</sup>+b or ln(Y)=mX<sup>−p</sup>+b. Using the sample contamination concentration as Y and the pumping time as X, simulation results fit these forms well, especially the logarithmic form. Because the optical density (OD) is an indicator of clean-up, the OD data can be used as Y and the pumping time can be used as X. If the pumping speed changes many times during the course of clean-up, the cumulative volume pumped is used as X instead of time.</p>
<p id="p-0028" num="0027">A small p value indicates that clean-up process is slow and it will take longer to obtain a quality sample, while a large p value indicates that the clean-up process will be faster and the chance for obtaining a sample of the desired purity is high. The value of b is used as an indicator for clean-up to the best sample quality achievable (the asymptotic value). By comparing the current OD value with the b value, the current sample contamination percentage is obtained. The future sample quality is estimated using the fitted values of m, p, and b, and a decision can be made as to whether to continue or to stop the pumping process if the estimated future sample quality is deemed insufficient.</p>
<p id="p-0029" num="0028">The power of X, which is −p, (where p is a positive number) can be used as an indicator of the rapidity of the clean-up process. Consequently, when the p value is small, and the calculated current contamination is high, there will be little chance of obtaining a high quality sample and it will take a long time, perhaps too long to obtain the desired sample purity.</p>
<p id="p-0030" num="0029">When the invasion profile is gradual, meaning a transition zone is present instead of sharp invasion boundary, the value of p decreases below 1.0. The value of p depends on the thickness of the transition zone between the region of filtrate and region of formation fluid. The thicker the transition zone, the lower the p value. This gradual transition has a similar effect to that of deep invasion. When the invasion is deep, then the clean fluid from the fresh zone will be mixed with the filtrate while it flows toward the probe. Hence a deep invasion will have a thick transition zone, and clean-up for that zone will take a long time.</p>
<p id="p-0031" num="0030">Formation damage can also affect the clean-up process. The clean-up can be improved when the formation near the wellbore is damaged or when the near wellbore formation permeability is less than the true formation permeability due to the small particle invasion.</p>
<p id="p-0032" num="0031">The functional form (see, e.g., U.S. Pat. No. 6,714,872) that is a best fit to simulation data regardless of invasion depth or formation damage is OD=exp(mt<sup>−p</sup>+b), so that at longer times, the OD stops changing because the time-dependent term goes to zero as time goes to infinity. That form is equivalent to the form, ln(OD)=C−D/t^p where C=b,</p>
<p id="h-0005" num="0000">m=−D, and p is a positive number. Curve fitting of sample clean-up using the form of
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>ln(<i>Y</i>)=<i>mX</i><sup>−p</sup><i>+B</i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where Y=optical or physical properties such as absorbance or fluorescence at some wavelength as the sample as it cleans up, X=Time since started pumping sample or, more correctly, the cumulative volume pumped, when the volumetric flow rate is not constant.
</p>
<p id="p-0033" num="0032">Applying the functional form ln(OD)=A*1/Time<sup>n</sup>+B to simulation results, shows that: a) In a simple system with no permeability damage and a sharply-defined filtration zone (100% filtrate zone followed by 0% zone), the n value is 1.1; b) Adding permeability damage to system, speeds up the cleaning process, and the n value is 1.3; c) Using a gradual filtrate contamination, in which contamination decreases as moving away from wellbore (that is 100, 80, 60 . . . and 0%) then the n value is 0.75; d) Adding damage to the system (c), then the n value is 1.0; and e) Adding a permeability change due to formation damage, then the n value can vary from 0.25 to 0.5. Fitting formation clean-up simulation results and some field data (optical density) to the above functional form, the following findings are provided.</p>
<p id="p-0034" num="0033">Using the sample contamination concentration as Y and the cumulative pump-volume as X, simulation results fit the form very well. Because the optical density (OD) is an indicator of clean-up, the OD data can be used as Y and pump-time can be used as X. If the pumping speed changes many times during the course of clean-up, the cumulative volume pumped should be used as X instead of time. The power of X, which is −p (where p is a positive number), can be used as an indicator for the clean-up process. For a nominal invasion of 6 inches or less, p is near 1.0-1.1. When the invasion profile is gradual, this indicates that there is a transition zone instead of a sharp invasion boundary, and p decreases below 1.0. The p value will depend on the thickness of the transition zone, the thicker the zone, the lower the p value. A similar effect is found for deep invasion. When the invasion is deep, then the clean fluid from the fresh zone will be mixed with the filtrate while it flows toward the probe. Hence the deep invasion will have a thick transition zone, and it will take a longer time to clean-up that zone.</p>
<p id="p-0035" num="0034">When the formation near the wellbore is damaged, that is the near wellbore formation permeability is less than the true formation permeability due to the small particle invasion, the clean-up can be improved as discussed in papers in the Society for Petroleum Engineers, papers SPE 39817 and SPE 48958. The formation anisotropy also helps the clean-up process (see SPE papers, SPE 39817 and SPE 48958). When there is a damage or a formation anisotropy, the p value increases above 1.0-1.1 up to 1.3-1.4. Hence a small p value indicates that the clean-up process will be slow and will take longer to get a quality sample of the desired purity.</p>
<p id="p-0036" num="0035">A high p value indicates that the clean-up process will occur quickly and the chance for a good quality sample is high. The B value can be used as the best sample quality achieved. By taking the ratio of the current OD value to the B value, the fraction of the cleanest possible sample is obtained. Using the fitted values of m, p, and B, the future sample quality can be estimated and a decision as to whether to continue or stop the sample pumping process can be made. When the p value is small, and the calculated current contamination is high, there will be little chance of obtaining a high quality sample of the desired purity and it will take an infeasible amount of time to obtain the desired sample.</p>
<p id="p-0037" num="0036">It is primarily the aromatic and polynuclear aromatics molecules that fluoresce. That is why, crude oil usually fluoresces much more than does the filtrate of oil based mud (OBM). For environmental reasons, synthetic OBMs are designed to be as aromatic free as possible but they may pick up some aromatic contamination from drilling or they may have small amounts of aromatic emulsifiers or fluid loss control materials added to them. Also, the filtrate of water-based mud has little or no fluorescence because water itself is non-fluorescing. Some compounds that dissolve in water may fluoresce. Furthermore, one could deliberately add fluorescent compounds to water based or oil based mud as fluorescent tracers.</p>
<p id="p-0038" num="0037">In the specific case where the property being fit is a function of the optical absorption, certain particularly useful functions can be selected for the absorption. One such function is the ratio of a baseline-adjusted oil peak to a baseline-adjusted water peak or its inverse. This function is particularly useful in monitoring the cleanup from water based mud filtrate to native crude oil. Its inverse is particularly useful in monitoring the cleanup from oil based much filtrate to connate water, when it is desired to collect a sample of water.</p>
<p id="p-0039" num="0038">The baseline-adjusted oil peak is an oil peak channel (near 1740 nm) minus a nearby low-absorbance “baseline reference” channel (e.g. channels at 1300 or 1600 nm). The baseline-adjusted water peak is a water peak channel (near 1420 or 1935 nm) minus a nearby low-absorbance “baseline reference” channel (e.g. channels at 1300 or 1600 nm). Substituting time equals infinity into our forecasting model enables estimation of the limiting value of property, P, at infinite time. Dividing the current value of property, P, by its forecasted terminal value yields the fraction of terminal purity.</p>
<p id="p-0040" num="0039">In a first embodiment of the present invention, the method and apparatus of the present invention fit fluid measurement data to a non-asymptotic curve. One example of a non-asymptotic curve is a curve which provides an improved fit to the data over the typical pumping time and, which can also be successfully extrapolated to several times that pumping time, but which approaches plus or minus infinity at infinite times, such as a power series approximation. Another example of a non-asymptotic curve is an equation that has an oscillatory component such as a sine wave, which never reaches a fixed limit. The sine wave can be adjusted in frequency, phase and amplitude to provide an improved fit to pulses in the monitored response that are associated with each stroke of the pump.</p>
<p id="p-0041" num="0040">In a second embodiment, the method and apparatus use pattern recognition. That is, the method and apparatus of the present invention use an equation such as log(1−f<sub>tp</sub>)=(−p)log(t)+log(A<sub>1</sub>/A<sub>0</sub>). The method and apparatus then perform a series of different estimates of the terminal purity or terminal value for a physical property of the fluid is represented by A<sub>0</sub>, where A<sub>0 </sub>starting with A<sub>1</sub>, A+ε, A+2ε, etc. The A<sub>0 </sub>value for which the fit to the data is closest to the shape of a straight line (based on the R-squared value) becomes the best estimate of A<sub>0</sub>. In a third embodiment the method and apparatus of the present invention fits a differentiable curve to measurement data or physical property data derived from the measurement data. The present invention then estimates A/A<sub>0 </sub>from the ratio of (dA/dt) to A. In a fourth embodiment, the present invention fits an asymptotic curve to absorbance differences of nearby optical channels (wavelengths) rather than to absorbance itself. The absorbance differences remove baseline offsets caused by passing sand particles or bubbles.</p>
<p id="p-0042" num="0041">In the conventional approach to formation contamination, equations 1 and 3 are applicable.</p>
<p id="p-0043" num="0042">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>A</mi>
          <mo>=</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>A</mi>
                <mn>0</mn>
              </msub>
              <mo>-</mo>
              <mrow>
                <msub>
                  <mi>A</mi>
                  <mn>1</mn>
                </msub>
                <mo>⁢</mo>
                <msup>
                  <mi>t</mi>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <mn>5</mn>
                    </mrow>
                    <mo>/</mo>
                    <mn>12</mn>
                  </mrow>
                </msup>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>where</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <msub>
                  <mi>A</mi>
                  <mn>0</mn>
                </msub>
              </mrow>
            </mrow>
            <mo>&gt;</mo>
            <mn>0</mn>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>A</mi>
            <mn>1</mn>
          </msub>
          <mo>&gt;</mo>
          <mn>0</mn>
        </mrow>
        <mo>,</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <munder>
              <mi>lim</mi>
              <mrow>
                <mi>t</mi>
                <mo>→</mo>
                <mi>∞</mi>
              </mrow>
            </munder>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>A</mi>
          </mrow>
          <mo>=</mo>
          <msub>
            <mi>A</mi>
            <mn>0</mn>
          </msub>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>1</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Instead of time, t, volume, V could be used. One could also generalize to the case where the best fitting power, p, is calculated instead of assumed.
</p>
<p id="p-0044" num="0043">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>A</mi>
            <mo>=</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>A</mi>
                  <mn>0</mn>
                </msub>
                <mo>-</mo>
                <mrow>
                  <msub>
                    <mi>A</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>⁢</mo>
                  <msup>
                    <mi>t</mi>
                    <mrow>
                      <mo>-</mo>
                      <mi>p</mi>
                    </mrow>
                  </msup>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.8em" height="0.8ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>where</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.8em" height="0.8ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>A</mi>
                    <mn>0</mn>
                  </msub>
                </mrow>
              </mrow>
              <mo>&gt;</mo>
              <mn>0</mn>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
            <msub>
              <mi>A</mi>
              <mn>1</mn>
            </msub>
            <mo>&gt;</mo>
            <mn>0</mn>
          </mrow>
          <mo>,</mo>
          <mrow>
            <mi>p</mi>
            <mo>&gt;</mo>
            <mn>0</mn>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <munder>
              <mi>lim</mi>
              <mrow>
                <mi>t</mi>
                <mo>→</mo>
                <mi>∞</mi>
              </mrow>
            </munder>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>A</mi>
          </mrow>
          <mo>=</mo>
          <msub>
            <mi>A</mi>
            <mn>0</mn>
          </msub>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>2</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>tp</sub><i>=A/A</i><sub>0</sub>=fraction of terminal absorbance, <i>A</i><sub>0</sub>, which is achieved when absorbance is <i>A.</i>  Eq. 3<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="h-0006" num="0000">Only in those cases where A<sub>0 </sub>is the absorbance of pure crude oil does f<sub>tp</sub>=fraction of terminal purity also equal f<sub>p</sub>=fraction of purity.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>1<i>−f</i><sub>tp</sub>=[1−(<i>A/A</i><sub>0</sub>)]=fraction away from terminal absorbance.  Eq. 4<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
For Eq. 1, the conventional approach finds best A<sub>0</sub>, A<sub>1 </sub>using a linear least squares fit to the N data points, (A<sub>i</sub>, t<sub>i</sub><sup>−5/12</sup>), where i=1, N. For Eq. 2, one finds best A<sub>0</sub>, A<sub>1 </sub>using a linear least squares fit to the N data points, (A<sub>i</sub>, t<sub>i</sub><sup>−p</sup>), where i=1, N after one assumes or finds a best fit value for p as described elsewhere in this invention.
</p>
<p id="p-0045" num="0044">Turning now to <figref idref="DRAWINGS">FIGS. 3-10</figref>, various functions performed in embodiments for the invention are depicted. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, in one example of the present invention fluid is extracted from a formation <b>310</b>. A property of the fluid is measure <b>320</b> from which an estimate of fluid contamination is made from a fit of the property with a non-asymptotic curve including fits performed to obtain data slope <b>330</b>.</p>
<p id="p-0046" num="0045">Although the discussion below uses elapsed time as the dependent variable, it is understood that the volume of pumped fluid or some other parameter could also be used. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, in an embodiment of the present invention the present invention performs a piecewise non-asymptotic curve fit to data to determine smoothed values and data slopes at centers of each segment. A regression is performed on the logarithm of the derivative of the data over time against the logarithm of time to obtain a straight-line regression slope and intercept. A value for fractional terminal purity ftp is estimated from the straight-line regression slope and intercept and from averages of A(t) and A<sub>1</sub>t<sup>−p </sup>at a plurality of times. For example, a method and apparatus are provided to fit absorbance over a rolling time segment using a non-asymptotic equation such as the power series, A=b<sub>0</sub>+b<sub>1</sub>t+b<sub>2</sub>t<sup>2</sup>. Then, by calculus, A′=dA/dt=b<sub>1</sub>+2b<sub>2</sub>t and A′/A=(b<sub>1</sub>+2b<sub>2</sub>t)/(b<sub>0</sub>+b<sub>1</sub>t+b<sub>2</sub>t<sup>2</sup>). For an equation of the form, A(t)=A<sub>0</sub>−A<sub>1</sub>t<sup>−p</sup>, one can perform a straight-line regression of ln(dA/dt) against ln(t) to obtain the best-fit line's slope and intercept and calculate best-fit values, −p=(1+Slope) and −A<sub>1</sub>=exp(Intercept−ln(1+Slope)). In this way, one does not need to assume a value of − 5/12, or −⅔, or of any other fixed value for −p. Instead, one can estimate f<sub>tp</sub>=A/A<sub>0 </sub>from the best-fit values for p and A<sub>1</sub>, and from twice the average of A(t) and A<sub>1</sub>t<sup>−p </sup>at a plurality of times <b>410</b>.</p>
<p id="p-0047" num="0046">As shown in <figref idref="DRAWINGS">FIG. 5</figref>, in the second embodiment of the present invention, a method and apparatus are provided that use a non-asymptotic curve to fit the data <b>510</b>. In this embodiment, the method and apparatus fit a modified version of Eq. 1 to data, wherein the modified equation does not approach an asymptote at infinite time such as the examples shown in Equations 8 and 9 below, using the form A=A<sub>0</sub>−h(t) where t→∞ and h(t) does not go to zero.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>A=A</i><sub>0</sub><i>−A</i><sub>1</sub><i>Σt</i><sup>x</sup>,where <i>x=−n </i>to +<i>m</i>, where <i>m</i>&gt;0.  Eq. 8<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>A=A</i><sub>0</sub><i>−A</i><sub>1</sub><i>[t</i><sup>−p</sup><i>+k</i><sup>−1</sup>sin(ω<i>t</i>)].  Eq. 9<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0048" num="0047">The sin(ωt) term can provide a better fit to data that has periodic spikes in response that commonly occur with every pump stroke as particulates are stirred up. Of course, this oscillating term prevents the curve from ever stabilizing to a fixed value no matter how long the time so it is not an asymptotic curve. The value of ω can be chosen to coincide with the pump-stroke frequency.</p>
<p id="h-0007" num="0000">For Eq. 9, the present invention finds best A<sub>0</sub>, A<sub>1 </sub>using a linear least squares fit to the N data points, (A<sub>i</sub>, t<sub>i</sub><sup>−5/12</sup>+k<sup>−1</sup>sin(ωt)).</p>
<p id="p-0049" num="0048">As shown in <figref idref="DRAWINGS">FIG. 6</figref>, in a third embodiment, the present invention provides for a pattern recognition <b>610</b>. As shown in <figref idref="DRAWINGS">FIG. 6</figref>, the present invention performs a pattern recognition for a trial-and-error estimate of A<sub>0</sub>, rather than a direct calculation of A<sub>0</sub>. In this embodiment, the pattern to be observed is the closest resemblance to a straight line as determined by the highest correlation coefficient, R, for a linear least squares fit. The method and apparatus performs a series of linear least squares fits to the absorbance data using a series of different estimates of A<sub>0 </sub>starting with, A+ε, A+2ε, up to A+Nε, where A+Nε&lt;3.5 OD, where 3.5 is used as an example for the upper dynamic range limit of the tool. The A<sub>0 </sub>value for which the fit is closest to a straight line in log-log space then becomes the best estimate of A<sub>0</sub>. Closeness of the fit to a straight-line shape is determined by the closeness of R<sup>2 </sup>to unity, where R<sup>2 </sup>is the correlation coefficient squared that ranges from 0 (no correlation) to 1 (perfect correlation). That is, for a series of A<sub>0 </sub>guesses, find the best A<sub>0 </sub>based on the best R<sup>2 </sup>in a linear least squares fit to N measured data points, (log [t<sub>i</sub>], log [1−(A(t<sub>i</sub>)/A<sub>0</sub>)]).</p>
<p id="p-0050" num="0049">An example of the slope of such as line would be (−pA<sub>1</sub>/A<sub>0</sub>), which for any fixed value of p, also allows immediate determination of A<sub>1</sub>. One can assume a fixed value for p or one can calculate a best-fit value for p from the slope of the straight-line regression of ln(dA/dt) versus ln(t). Note that A<sub>0 </sub>is not calculated here. Only R<sup>2 </sup>is calculated for different guesses (estimates) of A<sub>0</sub>. That is, different estimates of A<sub>0</sub>=A+nε, are tried and the one that produces the best R<sup>2 </sup>is used. To estimate A<sub>0 </sub>to a finer resolution than ε, one could use binary convergence to iteratively test A<sub>0 </sub>values between the best two previously-determined A<sub>0 </sub>values.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>log(1<i>−f</i><sub>tp</sub>)=(−<i>p</i>)log(<i>t</i>)+log(<i>A</i><sub>1</sub><i>/A</i><sub>0</sub>)  Eq. 10<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
For Eq. 10, for a series of different A<sub>0 </sub>guesses, the present invention finds the best R<sup>2 </sup>using a linear least squares fit to the N data points.
</p>
<p id="p-0051" num="0050">In a fourth embodiment, the method and apparatus of the present invention fits a differentiable curve to the measured data. The present invention estimates f<sub>tp </sub>from (dA/dt)/A by fitting a continuously differentiable curve to the absorbance data (or smoothed absorbance data). A piecewise fit to various segments of the data can also be performed. Note that this fitting curve need not approach a terminal value itself. Its purpose is simply to provide a smooth fitting function over a large enough time interval of data points so that fitted values of both A(t) and dA(t)/dt can be calculated for any time, t, within the interval and then substituted into equations 14-16.</p>
<p id="p-0052" num="0051">As shown in equations 14-16, the terminal absorbance value can now be determined from the ratio of the current slope, dA(t)/dt, to the current value, A(t). The local fitting and smoothing functions used for calculating dA(t)/dt and A(t) do not need to have terminal values themselves. They can even tend to plus or minus infinity, at infinite time, as would occur with a power series fit or a group of power series fits.</p>
<p id="p-0053" num="0052">Therefore, as shown in <figref idref="DRAWINGS">FIGS. 7</figref>, <b>8</b> and <b>9</b>, without ever calculating A<sub>0 </sub>or fitting an asymptotic curve to the absorbance data, it is possible to determine the fraction of terminal purity, f<sub>tp</sub>, that is achieved at time, t from ratio of the rate of change of the absorbance to the absorbance.</p>
<p id="p-0054" num="0053">For example, let</p>
<p id="p-0055" num="0054">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>A</mi>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>A</mi>
              <mn>0</mn>
            </msub>
            <mo>-</mo>
            <mrow>
              <msub>
                <mi>A</mi>
                <mn>1</mn>
              </msub>
              <mo>⁢</mo>
              <mrow>
                <mi>h</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>where</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <munder>
                <mi>lim</mi>
                <mrow>
                  <mi>t</mi>
                  <mo>→</mo>
                  <mi>∞</mi>
                </mrow>
              </munder>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>h</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mn>0</mn>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>11</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Take first derivative with respect to time,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>(<i>dA/dt</i>)=−<i>A</i><sub>1</sub>(<i>dh/dt</i>) therefore <i>A</i><sub>1</sub>=−(<i>dA/dt</i>)/(<i>dh/dt</i>)  Eq. 12<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>tp</sub><i>=A/[A+A</i><sub>1</sub><i>h</i>(<i>t</i>)]=1/[1<i>+A</i><sub>1</sub><i>h</i>(<i>t</i>)/<i>A</i>]=1/[1−(<i>dA/dt</i>)(<i>dh/dt</i>)<sup>−1</sup><i>h</i>(<i>t</i>)<i>A</i><sup>−1</sup>]  Eq. 13<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
so
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>tp</sub>=[1<i>−A</i><sup>−1</sup>(<i>dA/ht</i>)<i>g</i>(<i>t</i>)(<i>dh/dt</i>)<sup>−1</sup>]<sup>−1</sup>  Eq. 14<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Example: Let h(t)=t<sup>−p </sup>so that dh/dt=−pt<sup>−p</sup>t<sup>−1 </sup>Then,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>tp</sub>=[1<i>+A</i><sup>−1</sup>(<i>dA/dt</i>)tp<sup>−1</sup>]<sup>−1</sup>  Eq. 15<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
For the special case where p= 5/12,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>tp</sub>=[1+( 12/5)<i>A</i><sup>−1</sup>(<i>dA/dt</i>)<i>t]</i><sup>−1</sup>  Eq. 16<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0056" num="0055">In a fifth embodiment, as shown in <figref idref="DRAWINGS">FIG. 10</figref>, the method and apparatus of the present invention, finds terminal values of absorbance differences data rather than of absorbance itself. Absorbance differences of neighboring channels are plotted to remove baseline offsets caused by sand particles or bubbles <b>1010</b>. The method and apparatus of the present invention perform a fit to absorbance differences rather than to absorbances themselves. The channel differences are forecast, for example, the difference between optical channels, OD16−OD15, corresponding to different optical wavelengths out to their terminal values, rather than forecasting a single OD channel out to its terminal value. The absorbance difference data is used independently or in conjunction with the approaches described in <figref idref="DRAWINGS">FIGS. 3-9</figref> to determine fractional terminal purity, f<sub>tp</sub>.</p>
<p id="p-0057" num="0056">In a sixth embodiment, as shown in <figref idref="DRAWINGS">FIG. 13</figref>, we do not assume that “m” is a negative number, which is why the recursion formula is written as [1+m(1+t/Δt)] instead of being written as [1−m(1+t/Δt)]. In the sixth embodiment, the closeness of the intercept “b” to zero is used. Closeness of the intercept to “b” is used because it is much more sensitive than the closeness of R<sup>2 </sup>to unity for finding a best fit line when it is known that the intercept of that line should be zero. Also a recursive formula for predicting absorbance at future times is used. For data that falls and levels off over time, we use the absorbance at the left edge of the user-selected window as the starting absorbance rather than using zero as the starting absorbance as is done when the data rises and levels off.</p>
<p id="p-0058" num="0057">In the sixth embodiment, as shown in <figref idref="DRAWINGS">FIG. 13</figref>, the present invention fits a continuously-differentiable, non-asymptotic curve <b>1302</b> to the raw data. The fit can be to the elapsed time or fit to the volume of fluid pumped. The present invention uses, for example, but is not limited to, fitting a non-asymptotic curve to the raw data points such as A(t)=c<sub>1</sub>+c<sub>2</sub>t<sup>1/2</sup>+c<sub>3</sub>t<sup>1/3</sup>+c<sub>4</sub>t<sup>1/4</sup>. Using calculus, we analytically calculate the first derivative as dA/dt=(c<sub>2</sub>/2)t<sup>−1/2</sup>+(c<sub>3</sub>/3)t<sup>−2/3</sup>+(c<sub>4</sub>/4)t<sup>−3/4</sup>. We call A<sub>0 </sub>the “terminal” absorbance at some very long time (e.g., 24 hours) which is much longer than a time (2 hours) at which one would normally terminate pumping to achieve sample cleanup. As time progresses, both (A<sub>0</sub>−A) and t (dA/dt) decrease, where A is absorbance at time t. Assuming that they decrease at the same rate, then they are proportional, which means (A<sub>0</sub>−A)=mt(dA/dt) where “m” is a constant. The present invention tries various guesses for A<sub>0 </sub>until it finds a guess that produces the best linear, least-squares fit between y=(A−A<sub>0</sub>) and x=[t(dA/dt)]. The best fit is given by y=mx+b where the intercept, b, is closest to zero, which we found to be more sensitive than finding the maximum R<sup>2 </sup>for linear fits between two variables that are directly proportional. The present invention selects a raw data point at some time, t, (preferably, the latest time, t) at which the actual data intersects (or gets closest to) the best fit line. To forecast absorbance at a slightly later time, t+Δt, we use ΔA=(A<sub>0</sub>−A)/[1+m(1+t/Δt)] which is obtained by replacing dA/dt by ΔA/Δt, replacing t by t+Δt, and replacing A by A+ΔA in (A<sub>0</sub>−A)=mt(dA/dt). We recursively apply this ΔA formula to forecast the absorbance at t+Δt and then use our newly-calculated absorbance to compute the absorbance at some slightly later time, t+2Δt, and so on, for all future times.</p>
<p id="p-0059" num="0058">If the slope <b>1304</b>, m, of this fit is positive, it means a bad or undesirable section of raw data has been selected, which is curving upward or downward towards plus or minus infinity. Select a raw data point at some time, t, (preferably, the latest time, t) at which the actual data intersects (or gets closest to) the best fit line. The present invention then calculates the absorbance at some slightly later time, A(t+Δt)=A(t)+ΔA, in terms of t, A(t), A<sub>0</sub>, and m using ΔA=(A<sub>0</sub>−A)/[1+m(1+t/Δt)]. The present invention then recursively applies this ΔA formula forward to generate future forecasts, A(t), of the raw data. For data that is rising and leveling off over time, the fraction of terminal purity at any future time, t, is given by A(t)/A<sub>0</sub>. For data that is falling and leveling off over time, the fraction of terminal purity at any future time, t, is given by [A<sub>S</sub>−A(t)]/[A<sub>S</sub>−A<sub>0</sub>]. Here, A<sub>S </sub>is the starting absorbance at the left edge (the earliest time) of the user-selected data window.</p>
<p id="p-0060" num="0059">Turning now to <figref idref="DRAWINGS">FIG. 11</figref>, a more detailed schematic of the pyroelectric array for determining mid-infrared spectra for the fluid is illustrated. In one embodiment, the present invention provides a light source <b>402</b>, such as an infrared light source which can be a steady state light source or a modulated or pulsed light source. In the case of a steady state light source a light modulator is provided. The modulator can be any suitable device which varies the intensity of the light source, including but not limited to an electronic pulser circuit, well known in the art, that varies the intensity of the light source or an electromechanical chopper <b>404</b> that interrupts the path of the light source to the downhole fluid. The modulator is provided to modulate the intensity of light from the light source that impinges on the fluid and the photodetector. A reflector or collimator <b>403</b> can be provided to focus and/or concentrate light from the light source <b>402</b>. A chamber or conduit <b>406</b> is provided for presentation of a downhole fluid for exposure of the downhole fluid to light from the light source. An optical window <b>408</b> is provided, through which the downhole fluid <b>407</b> is exposed to the light. For purposes of the present application, the term “fluid” includes liquids, gases and solids that may precipitate from a fluid or a gas.</p>
<p id="p-0061" num="0060">The present invention further includes a detector such as a pyroelectric detector <b>412</b>. The pyroelectric detector <b>412</b> can also comprise a pyroelectric detector array. A spectrometer <b>414</b> and processor <b>422</b> are provided for analyzing signals from the pyroelectric detector to determine a property of the fluid <b>407</b> downhole. A mid-infrared linear variable filter <b>416</b> is provided and interposed between light radiating <b>440</b> from the downhole fluid and the pyroelectric detector <b>412</b>. A high gain amplifier <b>420</b> is provided to amplify the signal from the pyroelectric detector <b>412</b> when desired. The spectrometer <b>414</b> includes a processor <b>422</b> with memory. The processor <b>422</b> includes programs that implement soft modeling techniques for applying a chemometric equation, neural network or other soft modeling programs to the measurements of infrared light detected by the pyroelectric detector to estimate other physical and chemical properties of the downhole fluid from the pyroelectric detector signal. The spectrometer output responsive to the pyroelectric signal is also input to the soft modeling program, neural network or chemometric equation to estimate properties of the downhole fluid.</p>
<p id="p-0062" num="0061">Turning now to <figref idref="DRAWINGS">FIG. 12</figref>, a more detailed schematic of the acoustic transducer for determining sound speed in the fluid is illustrated. The present invention provides a transducer <b>701</b>, a sample flow line <b>703</b> or sample flow path <b>705</b> containing a fluid sample for measuring fluid density and sound speed of the fluid <b>708</b> inside of the tube or sample flow path or sample tank <b>711</b>. The thickness <b>707</b> of the flow line wall <b>706</b> is known. A processor <b>702</b> and pulsing electronics <b>704</b> are provided to send an acoustic pulse from pulser <b>701</b><i>a </i>through wall <b>706</b> into fluid <b>705</b> in flow path <b>705</b> or from pulse <b>701</b><i>b </i>through wall <b>706</b> of thickness <b>707</b><i>b </i>to sample chamber <b>711</b>. The transducer <b>701</b> receives echoes from the acoustic pulse, which are monitored by the processor. The present invention further comprises a wall standoff, which is an acoustic spacer interposed between the transducer and the wall that is made of the same material as the wall. This spacer simply increases the round trip distance and corresponding travel time for pulse-echo reverberations within the combined standoff plus near-wall material. It serves to lengthen the time between successive decaying echo pulses and so it serves to improve pulse separation, to avoid overlap of pulses and to improve quantification of energy in each pulse.</p>
<p id="p-0063" num="0062">The processor determines the density of the fluid in the sample flow line. The present invention captures a fluid sample in a flow line from the formation or the borehole. The present invention then sends an acoustic pulse into the fluid sample in the flow line or sample tank. The processor of the present invention then monitors the echo returns within the wall of the flow line or sample tank and integrates the energy of each acoustic echo pulse. The processor determines the slope of the decay of the integrated acoustic echo pulses bouncing inside of the wall of the flow line. The present invention then determines the reflection coefficient for the inner wall/fluid interface. The present invention determines the speed of sound in the fluid. The present invention determines the density of the fluid in the line as described above. The present invention determines the viscosity of the fluid in the flow line as described above.</p>
<p id="p-0064" num="0063">The present invention has been described as method and apparatus operating in a down hole environment in the preferred embodiment, however, the present invention may also be embodied as a set of instructions on a computer readable medium, comprising ROM, RAM, CD ROM, Flash or any other computer readable medium, now known or unknown that when executed cause a computer to implement the method of the present invention. While a preferred embodiment of the invention has been shown by the above invention, it is for purposes of example only and not intended to limit the scope of the invention, which is defined by the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07299136-20071120-M00001.NB">
<img id="EMI-M00001" he="9.14mm" wi="76.20mm" file="US07299136-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07299136-20071120-M00002.NB">
<img id="EMI-M00002" he="9.14mm" wi="76.20mm" file="US07299136-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07299136-20071120-M00003.NB">
<img id="EMI-M00003" he="9.14mm" wi="76.20mm" file="US07299136-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for estimating a parameter of formation fluid downhole, comprising:
<claim-text>extracting the fluid from a formation;</claim-text>
<claim-text>making a plurality of measurements for a property, A, of the fluid;</claim-text>
<claim-text>fitting a non-asymptotic curve to the plurality of measurements;</claim-text>
<claim-text>taking a first derivative of the fitted curve; and</claim-text>
<claim-text>selecting a terminal value of the property, A<sub>0</sub>, that produces a best fit between y and x, wherein y=A at time t minus the terminal value, A<sub>0</sub>, and x=t(dA/dt) at time, t; and</claim-text>
<claim-text>estimating the parameter of the formation fluid using the best fit between y and x.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the best fit is given by y=mx+b, where intercept, b is closest to zero and m is a slope.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> further comprising:</claim-text>
<claim-text>selecting a data point which is close to the fitted curve and using its value, A, at time, t, for forecasting a future value of the property, A, at a later time, t+Δt.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein forecasting the property, A, at the later time further comprises determining ΔA=(A<sub>0</sub>−A)/[1+m(1+t/Δt)].</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref> further comprising:
<claim-text>recursively determining ΔA for forecasting the property, A, at the later time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the property, A, is one of: (i) absorbance; (ii) fluorescence; (iii) refractive index; (iv) viscosity; (v) density; (vi) sound speed; and (vii) bulk modulus.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the property of the fluid is formation fluid contamination.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. An apparatus for use downhole, comprising:
<claim-text>a probe for receiving a fluid from a formation;</claim-text>
<claim-text>an optical sensor that makes a plurality of measurements of an optical property, A, of the fluid; and</claim-text>
<claim-text>a processor configured to (i) fit the plurality of measurements of the optical property of the fluid to a non-asymptotic curve; (ii) take a first derivative of the fitted curve, and (iii) use one or more values of a terminal value of the optical property A<sub>0</sub>, to produce a best fit between y and x, where y=the optical property, A, at time t, minus the terminal value, A<sub>0</sub>, and x=t(dA/dt), at time t, and (iv) estimate a parameter of the formation fluid using the best fit between y and x.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the best fit is given by y=mx+b, and where intercept, b, is closest to zero and m is a slope.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the processor is further configured to select a data point which is close to the fitted curve and to use its value, A, at time, t, to forecast a future value of the optical property at a later time, t+Δt.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the processor is further configured to use ΔA =(A<sub>0</sub>−A)/[1+m(1+t/Δt)] to forecast the future value of the optical property.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the processor is further configured to recursively determine ΔA to forecast the future value of the optical property.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the optical property, A, is one of: (i) absorbance; (ii) fluorescence; and (iii) refractive index.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A computer-readable-medium containing instructions that when executed by a computer perform a method for estimating formation fluid contamination downhole, comprising:
<claim-text>extracting the fluid from a formation;</claim-text>
<claim-text>making a plurality of measurements for a property, A, of the fluid over time; and</claim-text>
<claim-text>fitting a non-asymptotic curve to the plurality of measurements of the property of the fluid;</claim-text>
<claim-text>taking a first derivative of the fitted curve;</claim-text>
<claim-text>using a terminal value of the property, Ao, to produce a best fit between y and x, wherein y=A, at time t, minus the terminal value, A<sub>0</sub>, and x=t(dA/dt), and t=time; and</claim-text>
<claim-text>estimating the formation fluid contamination at time, t, from the best fit between y and x.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer-readable-medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein in the method the best fit is given by y=mx+b, where intercept, b is closest to zero and m is a slope.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The computer-readable-medium of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein the method further comprises:</claim-text>
<claim-text>selecting a data point which is close to the fitted curve and using its value, A, at time, t, for forecasting a future value of the property, A, at a later time, t+Δt.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer-readable-medium of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein forecasting the property, A, further comprises determining ΔA=(A<sub>0</sub>−A)/[1+m(1+t/Δt)].</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer-readable-medium of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein the method further comprises:
<claim-text>recursively determining ΔA to forecast the value of the property, A, for the future time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer-readable-medium of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the property, A, is one of: (i) absorbance; (ii) fluorescence; (iii) refractive index; (iv) viscosity; (v) density; (vi) sound speed; and (vii) bulk modulus.</claim-text>
</claim>
</claims>
</us-patent-grant>
