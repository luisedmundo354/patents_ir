<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298294-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298294</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10765431</doc-number>
<date>20040126</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>64</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>M</subclass>
<main-group>5</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>341 58</main-classification>
</classification-national>
<invention-title id="d0e53">Filter driven DC-free codes</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4027335</doc-number>
<kind>A</kind>
<name>Miller</name>
<date>19770500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4775985</doc-number>
<kind>A</kind>
<name>Busby</name>
<date>19881000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>4833471</doc-number>
<kind>A</kind>
<name>Tokuume et al.</name>
<date>19890500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5198813</doc-number>
<kind>A</kind>
<name>Iaozaki</name>
<date>19930300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5341134</doc-number>
<kind>A</kind>
<name>Benjauthrit</name>
<date>19940800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5469162</doc-number>
<kind>A</kind>
<name>Chaki et al.</name>
<date>19951100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 58</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>5477222</doc-number>
<kind>A</kind>
<name>Kahlman et al.</name>
<date>19951200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 95</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>5506581</doc-number>
<kind>A</kind>
<name>Ino et al.</name>
<date>19960400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>5508701</doc-number>
<kind>A</kind>
<name>Nose et al.</name>
<date>19960400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 58</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>5608397</doc-number>
<kind>A</kind>
<name>Soljanin</name>
<date>19970300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 58</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>5699061</doc-number>
<kind>A</kind>
<name>Shimpuku</name>
<date>19971200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>5854596</doc-number>
<kind>A</kind>
<name>Schouhamer Immink</name>
<date>19981200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>5929794</doc-number>
<kind>A</kind>
<name>Hayakawa et al.</name>
<date>19990700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6175317</doc-number>
<kind>B1</kind>
<name>Ordentlich et al.</name>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6265994</doc-number>
<kind>B1</kind>
<name>Kahlman</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>2005/0244003</doc-number>
<kind>A1</kind>
<name>Nagai et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>102</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>341 58</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>341 87</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>341 94</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>341 95</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>369 47</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>369 48</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>360 32</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>386112</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>386109</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>16</number-of-figures>
</figures>
<us-related-documents>
<continuation-in-part>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>10155777</doc-number>
<kind>00</kind>
<date>20020524</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>6917313</doc-number>
<kind>A </kind>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>10765431</doc-number>
</document-id>
</child-doc>
</relation>
</continuation-in-part>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60349895</doc-number>
<kind>00</kind>
<date>20020116</date>
</document-id>
</us-provisional-application>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60352776</doc-number>
<kind>00</kind>
<date>20020128</date>
</document-id>
</us-provisional-application>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Oberg</last-name>
<first-name>Mats</first-name>
<address>
<city>Cupertino</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Sutardja</last-name>
<first-name>Pantas</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Burd</last-name>
<first-name>Gregory</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Marvell International Ltd.</orgname>
<role>03</role>
<address>
<city>Hamilton</city>
<country>BM</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Young</last-name>
<first-name>Brian</first-name>
<department>2819</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An encoder for encoding a communication signal includes a signal buffer to buffer data associated with the communication signal. A DC-Check circuit to compute a metric as a function of the data. A DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state. A flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="85.85mm" wi="128.19mm" file="US07298294-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="215.73mm" wi="173.74mm" file="US07298294-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="206.42mm" wi="118.36mm" file="US07298294-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="223.10mm" wi="156.21mm" file="US07298294-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="195.92mm" wi="162.73mm" file="US07298294-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="112.69mm" wi="159.77mm" file="US07298294-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="205.74mm" wi="129.12mm" file="US07298294-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="224.54mm" wi="147.49mm" file="US07298294-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="226.74mm" wi="159.94mm" file="US07298294-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation-in-part of U.S. non-provisional application Ser. No. 10/155,777, filed May 24, 2002, is now U.S. Pat. No. 6,917,313, which claims the benefit of the filing date of U.S. provisional applications No. 60/349,895 filed Jan. 16, 2002, and No. 60/352,776 filed Jan. 28, 2002, the content of each of which is herein incorporated by reference in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">This invention relates to block coding for communication signals.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Communication systems generally employ modulation coding to convert data bits into symbols that are optimized for transmission through the communication channel. Modulation coding can be used to ensure the presence of sufficient information for timing recovery, gain control, and adaptive equalization. Some communication channels such as perpendicular recording channels may inherently include a DC component in the read back signal. The DC component may complicate and degrade the decoding of the signal requiring tracking of the DC offset. In some cases, the performance of DC offset tracking circuits may degrade by as much as two dB in comparison to the average case.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0005" num="0004">In one aspect, a modulation code is presented that minimizes data patterns that may inhibit the performance of a DC offset tracking loop. An encoder for encoding a communication signal with the modulation code includes a signal buffer to buffer data associated with the communication signal. A DC-Check circuit to compute a metric as a function of the data. A DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state. A flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero.</p>
<p id="p-0006" num="0005">The details of one or more embodiments of the invention are set forth in the accompanying drawings and the description below. Other features, objects, and advantages of the invention will be apparent from the description and drawings, and from the claims.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">DESCRIPTION OF DRAWINGS</heading>
<p id="p-0007" num="0006"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of an aspect of a harddisk assembly.</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of an aspect of an encoder.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of an aspect of a decoder</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of an aspect of an encoder.</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of an aspect of a DC tracking block.</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of an aspect of an encoder.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of an aspect of a 30/31 RLL encoder.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram of an aspect of an encoder.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of an aspect of a DC tracking block.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram of an aspect of a DC tracking block.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram of an aspect of a DC tracking block.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 12</figref> is a flow diagram of an aspect of an encoding scheme.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 13</figref> is a block diagram of an aspect of a DC limited encoder.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 14</figref> is a flow diagram of an aspect of bit insertion and scheduling in a DC limited encoder.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 15</figref> is a block diagram of an aspect of a DC-Check circuit.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 16</figref> is a block diagram of an aspect of another DC-Check circuit.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0023" num="0022">Like reference symbols in the various drawings, indicate like elements.</p>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> shows a storage assembly <b>10</b> for storing data. The storage assembly <b>10</b> includes media <b>12</b> to which data may be written and read. Perpendicular recording is preferably employed to write and read data to the media <b>12</b> and may be included in any known storage device such as hard drives and optical disks. In a writing operation, a signal processor <b>14</b> may apply compression and error correction schemes to an input signal. An RLL encoder <b>17</b> converts the processed input signal to a format suitable for storage by the storage unit <b>12</b>. A DC-free encoder <b>16</b> employs an encoding scheme to control DC offset in the read back signal when perpendicular recording is used for writing the signal to the media <b>12</b>. The DC-free code implemented by the encoder <b>16</b> may locally limit the average DC level over an interval extending beyond one codeword, one sector, or any portion of the communication over which the code is applied. The code rate may be L/(L+1) and the error propagation due to a DC free decoder <b>22</b> is about 1 bit for some aspects. The code may preserve an RLL constraint. A preamp <b>18</b> amplifies and writes the encoded signal to the media <b>12</b>. A readhead amplifier <b>20</b> detects and generates the read back signal by reading data from the media <b>12</b>. The readhead amplifier <b>20</b> may include a read equalizer and detector for equalizing and detecting the data. The read back signal may be decoded by the DC-free decoder <b>22</b> that is suitable for decoding signals that are encoded by the DC-free encoder <b>16</b>. An RLL decoder <b>21</b> may decompress the decoded signal. The signal processor <b>14</b> may apply error correction to the decompressed signal to generate an output signal representing the recovered data.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 2</figref> shows an encoder <b>30</b> to apply dc-free modulation code to a communication signal. The communication signal may be any signal that communicates information between two assemblies, although the invention is particularly suitable when applied to communication signals that inherently have a DC component such as signals associated with perpendicular recording of storage devices. The encoder <b>30</b> may include a multiplexer <b>32</b> to insert a zero bit into the first position of the communication signal to form a codeword c(0:L). A precoder <b>34</b> precodes the codeword with 1/(1+D). A buffer <b>36</b> stores the precoded output from the precoder <b>34</b>. The buffer <b>36</b> may be any type of buffer such as a first-in-first-out (FIFO) buffer. A DC tracking block <b>38</b> computes the DC component associated with the first half of the codeword and generates a flip signal based on the computation and the DC component of the second half of the previous codeword. A flip unit <b>40</b>, in response to the flip signal, may flip the output of the buffer <b>36</b> or output the buffer output unflipped. The DC tracking block <b>38</b> may also generate a state signal to cause the precoder <b>34</b> to flip state before processing the second half of the codeword. The state signal may be active in response to the flip signal causing the buffer output to be flipped.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 3</figref> shows a DC-free decoder <b>50</b> to decode a communication signal that is encoded with DC-free code. The DC-free decoder <b>50</b> includes a postcoder <b>52</b> to postcode the communication signal. The postcoder <b>52</b> preferably postcodes the signal with “1+D”. A demultiplexer <b>54</b> strips off the first bit of each codeword that is postcoded to recover the data that was encoded.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 4</figref> shows another DC-free encoder <b>60</b> for encoding a communication signal. The communication signal preferably includes Run Length Limited (RLL) encoding although RLL encoding is not required. A multiplexer <b>62</b> and buffer <b>68</b> both receive the RLL encoded signal. The multiplexer <b>62</b> inserts a zero bit into the communication signal to form a codeword. A first precoder <b>64</b> precodes the codeword with 1/(1+D). A DC tracking block <b>66</b> computes the DC component associated with the first half of the codeword and generates a flip signal based on the computation and the DC-level in the second half of the previous codeword. The buffer <b>68</b> stores the received communication signal. The buffer <b>68</b> may be any type of buffer such as a FIFO buffer. A flip unit <b>70</b> receives the output of the buffer <b>68</b> and, in response to the flip signal, inserts a 1 or 0 into the buffer output to form a codeword. A second precoder <b>72</b> precodes the codeword with 1/(1+D).</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 5</figref> shows a DC tracking block <b>80</b> for computing the DC component of a communication signal. The DC tracking block <b>80</b> may compute the DC component over any portion of the communication signal including a half codeword, a full codeword, and a sector. The output of a feed back loop, dc(t), is sampled at time t<sub>k</sub>=k[(L+1)/2], k=1,2 . . . and the sign, sgn(2dc(t<sub>k</sub>)−[(L+1)/2)]=sgn(t<sub>k</sub>), is stored in a register <b>84</b>. The sampling times may correspond to the middle and end of each dc free codeword. An accumulator <b>82</b> of a feed back filter may be reset to zero following each sampling time. A decision unit <b>86</b> may determine whether to flip the n-th code-word n=1,2,3 . . . after sgn(t<sub>2(n−1)+1</sub>) becomes available. In that instance the decision to flip is made if sgn(t<sub>2(n−1)+1</sub>)=sdc(t<sub>2(n−1)</sub>); otherwise we do not flip. If the decision to flip is made, then the state signal is generated to flip the precoder state and sgn(t<sub>2(n−1)+1</sub>) is inverted to −sgn(t<sub>2(n−1)+1</sub>) to account for the change in DC when the codeword is flipped (or inverted).</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 6</figref> shows a communication system <b>90</b> including a 33/34 DC-free encoder <b>92</b> for encoding a communication signal. The input bits of the communication system <b>90</b> may first be passed through a 32/33 RLL encoder <b>94</b>. The 32/33 code in the example is designed in the interleaved non-return to zero invert (INRZI) domain, the data may then be passed through a 1/(1+D) precoder <b>96</b> to convert the codeword into non-return to zero invert (NRZI) domain. Finally, the 33/34 dc-free encoder <b>92</b> is used to limit the DC fluctuations of the coded data. The RLL constraint of the code may be (0, 23/15).</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIGS. 7 and 8</figref> show another communication system <b>100</b> including a 30/31 dc-free encoder <b>102</b> to encode a communication signal. The DC limited code implemented in the 30/31 dc-free encoder <b>102</b> may be used with 30/31 non-return to zero (NRZ) RLL code. Since 30/31 code is typically constructed in NRZ domain, the construct for the DC limited code shown in <figref idref="DRAWINGS">FIGS. 2–6</figref> may not be preferable since the dc-free code shown in <figref idref="DRAWINGS">FIGS. 2–6</figref> operates in NRZI. Using the code construct shown in <figref idref="DRAWINGS">FIGS. 2-6</figref> with 30/31 NRZ RLL code may cause error propagation. Therefore, the construct shown in <figref idref="DRAWINGS">FIGS. 7 and 8</figref> may be advantageous when employed with RLL code designed in the NRZ domain.</p>
<p id="p-0031" num="0030">30/31 RLL code generally is designed in NRZ domain and does not have error propagation across 10-bit Error Correction Circuit (ECC) byte boundaries. An RLL encoder <b>104</b> takes in three 10-bit symbols <b>106</b> and encodes the middle one with 10/11 RLL code <b>107</b>, where the encoding depends on the last two bits of the first symbol (however these bits are not altered by the encoder).</p>
<p id="p-0032" num="0031">The 30/31 dc-free encoder <b>102</b> may include a multiplexer <b>108</b> to take in 30 bits, w(0:29), and form a 31-bit codeword c=(0,w) by inserting a 0 at the beginning. A buffer <b>110</b> stores a portion of the codeword. A comparator <b>112</b> may then compare the dc content of the last 10 bits of the previous codeword with the dc content of the first 11 bits of the current one. If these quantities have the same sign, a flip unit <b>114</b> may flip the first 11 bits of the current codeword. Next, c(1:30) is sent to the 30/31 RLL encoder <b>104</b> to be encoded. The 30/31 dc-free code has no error propagation across ECC symbol boundaries while preserving the RLL constraint of the 30/31 code. In addition, the DC content in 2 bytes spanning the last byte of previous codeword and the first byte of the current codeword is controlled. The DC content of the middle byte may also be controlled by RLL constraints imposed by the 10/11 RLL code.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIGS. 9–11</figref> each show aspects of DC tracking blocks that are not limited to operating on specific types of code such as 32/33 code and 30/31 code.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 9</figref> shows an aspect of a DC tracking block <b>130</b> that takes the DC level of a current code-word and compares it with the accumulated DC-level of the n last codewords.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 10</figref> shows another aspect of a DC tracking block <b>140</b> that uses a weighted average of the DC level of previous codewords and compares that to the DC level of a current codeword. In one aspect, the weighting may be exponentially decreasing for older codewords. For example, when codeword i is the current codeword, then the weighting for codeword k, k&lt;i, will be a<sup>i-k</sup>, for 0&lt;a&lt;1. The extension to individual weights for codewords j codewords prior to the current is straightforward, up to a predetermined number of codewords.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 11</figref> shows another aspect of a DC tracking block <b>150</b> that uses a weighted average of bits, rather than codewords. The DC level of the current codewords is compared to a weighted average of previous codesymbols, using weights that may be exponentially decreasing. The weighted average of all the codesymbols prior to the current codeword may be computed in two steps. First the weighted average of each individual codeword may be computed by accumulator A as the bits arrive. At the end of each codeword, the accumulator value may be passed to accumulator B, and accumulator A is reset. If the codeword is flipped, then the accumulator A value may be inverted prior to being passed to accumulator B. Using this two step process may simplify the handling of flipped codewords.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 12</figref> shows a process of encoding a communication signal. Beginning at block <b>170</b>, a codeword c(0:L) is formed by inserting a zero bit, c=(0,w), into an input w(0:L−1). Continuing at block <b>172</b>, the codeword may be precoded with a 1/(1+D) precoder. At block <b>174</b>, the precoded codeword may be stored in a buffer. At block <b>176</b>, the DC component of a portion of the precoded codeword may be computed. Based on the computed portion, a determination is made whether to flip the codeword and whether all or a portion of the codeword should be flipped, block <b>178</b>. Continuing to blocks <b>180</b> and <b>182</b>, if all or a portion of the codeword is to be flipped, then the precoder state is flipped. Alternatively continuing to block <b>180</b>, if the codeword is not flipped, then control passes to block <b>184</b> at which the remaining portion of the codeword is processed.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 13</figref> shows an encoder <b>200</b> to encode a communication signal. The encoder <b>200</b> includes a DC-Check circuit <b>202</b> to compute one or more metrics as a function of NRZ data. A flip unit <b>204</b> may select the value of a flip bit as a function of the data metrics. Also, a decoder (not shown) may include the DC-Check circuit <b>202</b> to decode data. The data metrics may include, but are not limited to 1) limiting the maximum of the absolute value of the running digital sum, 2) limiting the maximum DC offset introduced by some filtering operation, 3) the same as metric #2 except including a DC correction circuit, 4) limiting the maximum absolute value of the filtered output with or without a correction circuit, 5) limiting the maximum DC offset slope change, with or without a DC correction circuit and, 6) similar to 1–5 above, but observing the number of times the values are above and/or below a threshold. The DC-Check circuit <b>202</b> may be implemented in any manner including hardware, software, firmware, and combinations thereof.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 14</figref> shows a flow diagram for bit insertion and scheduling in a DC limited encoder such as encoder <b>200</b>. The DC limited encoder may insert a flip bit after every k input bits for a code rate of k/(k+1). The encoder input may be encoded such as in either NRZI, or NRZ domain. If the input is in NRZI domain, the encoder may precode the sequence before further processing. The criteria for selecting the value of the current flip bit may include past encoder outputs as well as different possible future encoder outputs. The future outputs may include the current flip bit, but they may also include more than one flip bit. First the case with only one flip bit in the possible future outputs will be described, then a general description with more than one flip bit will be described.</p>
<p id="p-0040" num="0039">Two DC-Check circuits, DCCO and DCC<b>1</b>, may be used for the case where there is only one flip bit in the possible future outputs. Starting at decision block <b>302</b>, the data prior to the first codeword may be passed through DC-Check circuit <b>0</b>, DCCO. The DC-Check Circuit <b>0</b> may compute one or more metrics as a function of the data. When the first data word enters the DC limited encoder, the word may be passed through the precoder (if applicable), block <b>304</b>. For example, if the input is in NRZI domain, the sequence may be passed through the precoder before further processing. At block <b>308</b>, the state of DCC<b>1</b> is set to be the same as DCCO. Continuing to block <b>310</b>, the precoded word is passed to the output buffer.</p>
<p id="p-0041" num="0040">Returning to decision block <b>302</b>, the next word is passed to the encoder. At block <b>312</b>, a 0 is inserted in front of the word, and at block <b>314</b> the new word may be passed through the precoder (if applicable), such as to precode data that is in the NRZI domain. At block <b>316</b>, the new word may be buffered in a buffer. At block <b>318</b>, the new word may be passed to DCCO, and at blocks <b>320</b> to <b>322</b> the binary complement of the new word may be determined and passed to DCC<b>1</b>. The DC-Check Circuit <b>1</b>, DCC<b>1</b>, may compute one or more metrics as a function of the binary complement of the new word. At block <b>324</b>, the output of DCCO, word <b>0</b>, and the output of DCC<b>1</b>, word <b>1</b>, are compared and one of the words is selected based on the comparing. At decision block <b>326</b>, the processing flow for the selected word is determined based on which word is selected. At blocks <b>328</b> to <b>330</b>, if the output of DCC<b>1</b> (word <b>0</b>) is the selected one of the DC Check Circuit outputs, then the state value of DCC<b>1</b> is set equal to the state value of DCCO and the word in the buffer is passed to the encoder output. At blocks <b>332</b> to <b>336</b>, if the output of DCC<b>1</b> (word <b>1</b>) is better, the state value of DCCO is set equal to the state value of DCC<b>1</b>, the precoder state may be inverted (if applicable), and the inverse of the word in the buffer is passed to the encoder output. At decision block <b>338</b>, the loop continues until the last word has been encoded.</p>
<p id="p-0042" num="0041">In this section, the case when the value of a flip bit is based on future data containing at least one more flip bit is described. When a single flip bit is used as described in <figref idref="DRAWINGS">FIG. 14</figref>, two sequences may generated, and one of the two sequences may be selected. For each extra flip bit, the number of sequences to choose from doubles and the number of DC-Check circuits doubles. For example with two extra flip bits for a total of 3 flip bits, 8 sequences may be generated and 8 DC-Check circuits employed. Each of the sequences may be passed into its corresponding DC-Check circuit. Generally, only the value of the first flip bit will be chosen. If the sequence with the best output from DCCi (where i denotes which DC-Check circuit) is chosen, it might turn out to be a less desirable choice if future choices of flip bits are different from what that particular sequence had. In other words, if a flip bit, fk, at time k is chosen assuming a certain value of flip bits fk+1 and fk+2, and the selected value of flip bit at time k+1 (fk+1) is different from the assumption, the choice at time k might not be the best any longer. Therefore, the flip bit at time k is preferably selected assuming the worst possible choice of any future flip bit parts of the sequences used in selecting flip bit fk. For each pair of sequences that differs in the last word, the one with the worst metric for the last word is preferably selected as the survivor, and the other sequence is discarded. Then each pair of sequences that differ in the last two words may be compared, and the one with worst metric may be selected. This continues until there are only two sequences left, and the one with the best metric is selected. The DC-Check circuit states are then set to correspond to the sequences that begin with the selected sequence.</p>
<p id="p-0043" num="0042">In one aspect, a DC-Check circuit may limit the maximum of the absolute value of a running digital sum. The running digital sum (RDS(n)) may be defined as the sum of encoder outputs up to time n. Assuming the encoder outputs, x, are 0,1; RDS(n) may be defined as follows:</p>
<p id="p-0044" num="0043">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mrow>
              <mi>RDS</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>T</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <mi>n</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <msub>
                    <mi>T</mi>
                    <mn>0</mn>
                  </msub>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mrow>
            <mi>where</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>∞</mi>
                </mrow>
                <mo>&lt;</mo>
                <msub>
                  <mi>T</mi>
                  <mn>0</mn>
                </msub>
                <mo>&lt;</mo>
                <mn>0</mn>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mi>RDS</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>T</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <mi>n</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mrow>
                <mi>RDS</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mi>T</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>,</mo>
                    <mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mi>RDS</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mn>0</mn>
                      <mo>,</mo>
                      <mi>n</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>and</mi>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mtext>
</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>RDS0</mi>
            <mo>=</mo>
            <mrow>
              <mi>RDS</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>T</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <mrow>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>EQ</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>1</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0045" num="0044">The flip bit (precoded if applicable) may have a value which should be determined as xo. The state of the DC-Check circuit before new data is entered is defined to be RDSO. The output from DCCi for an input sequence may be given as follows:</p>
<p id="p-0046" num="0045">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>max</mi>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munder>
            <mi>max</mi>
            <mrow>
              <mn>0</mn>
              <mo>≤</mo>
              <mi>n</mi>
              <mo>≤</mo>
              <mi>k</mi>
            </mrow>
          </munder>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo></mo>
              <mrow>
                <mrow>
                  <munderover>
                    <mo>∑</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>0</mn>
                    </mrow>
                    <mi>n</mi>
                  </munderover>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mn>2</mn>
                        <mo>⁢</mo>
                        <msub>
                          <mi>x</mi>
                          <mi>i</mi>
                        </msub>
                      </mrow>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>+</mo>
                <mi>RDS0</mi>
              </mrow>
              <mo></mo>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>EQ</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>2</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 15</figref> shows an aspect of another DC-Check circuit <b>400</b>. The DC-Check circuit <b>400</b> may limit the maximum DC offset introduced by some filtering operation. The main source of baseline wander in many systems is from AC coupling circuits, or other high pass filtering circuits. The DC-Check circuit <b>400</b> may estimate the amount of baseline wander caused by a code sequence. In one aspect, the DC-Check circuit <b>400</b> may pass the sequence through a model of the high pass filter, and subtract the output of the filter from the input sequence. In another aspect shown in <figref idref="DRAWINGS">FIG. 15</figref>, the DC-Check circuit <b>400</b> may pass the code sequence, x, through a low pass filter <b>402</b> with a transfer function that complements the high pass filter. For example, if the high pass filter model has transfer function H(z), then the low pass filter should have transfer function F(z)=[1−H(z)], <b>402</b>, with a filter output, y. In each of these aspects, the state of the DC-Check circuit <b>400</b> is approximately the same as the filter state. An absolute value module <b>404</b> may determine the absolute value of y. A maximum determiner <b>406</b> may determine a maximum output, w, that is the largest absolute value of the low pass filter output, y, for the input sequence xo, xl, . . . , xk.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 16</figref> shows another aspect of a DC-Check circuit <b>500</b> for a channel detector that may include a DC correction circuit. The DC-Check circuit <b>500</b> may model DC correction in addition to modeling DC offset. By modeling the DC correction, the encoder may select the sequence that gives the smallest DC offset after correction. Assuming that the DC correction in the channel detector is delayed with respect to the actual DC offset, then the correction circuit can be modeled by a low pass filter <b>502</b> similar to the low pass filter <b>402</b> shown in <figref idref="DRAWINGS">FIG. 15</figref>, but with some delay. Here the state of the DC-Check circuit <b>500</b> may be given by the state of the low pass filter <b>502</b> and the state of an offset estimation filter <b>503</b>. An absolute value module <b>504</b> may determine the absolute value of y. A maximum determiner <b>506</b> may determine a maximum output, w, that is the largest absolute value y, for the input sequence xo, xl, . . . , xk. Any technique for modeling the DC correction circuit may be used.</p>
<p id="p-0049" num="0048">In another aspect, the DC-Check circuit <b>500</b> may limit the number of times an RDS is above a threshold or below another threshold. In addition, threshold limiting may be applied to any type of RDS technique such as limiting the maximum of the absolute value of an RDS, and limiting the maximum DC offset introduced by some filtering operation. For example, the DC-Check circuit <b>500</b> may limit the number of times the maximum of an absolute value of the RDS occurs. A threshold detector <b>508</b> may compare the RDS to a predetermined value and generate a detect output as a function of the comparison. The detect output may indicate the RDS is either above or below a threshold value. A counter <b>510</b> may count the number of times the RDS is either greater than a threshold, or the number of times the RDS is less than a threshold. Instead of using EQ. 2 to determine RDS, the following equations may be used:</p>
<p id="p-0050" num="0049">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mi>L</mi>
      <mo>=</mo>
      <mrow>
        <mi>max</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <msubsup>
                <mi>I</mi>
                <mi>i</mi>
                <mi>N</mi>
              </msubsup>
            </mrow>
            <mo>,</mo>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <msubsup>
                <mi>I</mi>
                <mi>i</mi>
                <mi>P</mi>
              </msubsup>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mi>where</mi>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00003-2" num="00003.2">
<math overflow="scroll">
  <mrow>
    <msubsup>
      <mi>I</mi>
      <mi>i</mi>
      <mi>P</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
      <mo>{</mo>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mn>1</mn>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>if</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mi>RDS</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>i</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>&gt;</mo>
              <msub>
                <mi>t</mi>
                <mi>P</mi>
              </msub>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mn>0</mn>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>Otherwise</mi>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
      <mo>}</mo>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00003-3" num="00003.3">
<math overflow="scroll">
  <mrow>
    <msubsup>
      <mi>I</mi>
      <mi>i</mi>
      <mi>N</mi>
    </msubsup>
    <mo>=</mo>
    <mrow>
      <mo>{</mo>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mn>1</mn>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>if</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mi>RDS</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>i</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>&gt;</mo>
              <msub>
                <mi>t</mi>
                <mi>N</mi>
              </msub>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mn>0</mn>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>Otherwise</mi>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
      <mo>}</mo>
    </mrow>
  </mrow>
</math>
</maths>
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0050">and t<sub>p </sub>and t<sub>N</sub>, are the positive and negative thresholds. In one aspect L may be kept small. In another aspect, for filtered systems such as shown in <figref idref="DRAWINGS">FIGS. 15 and 16</figref>, the filter outputs, y, may be used instead of RDS.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0051" num="0051">In another aspect, a DC-check circuit may limit the maximum slope change of any of the described measuring techniques such as the limiting DC offset technique, the maximum of the absolute value of an RDS, limiting the maximum DC offset introduced by some filtering operation, with or without a DC correction circuit, and combinations thereof. For example, in one aspect the DC-check circuit may determine the slope change spanning more than a number k of bits as follows:</p>
<p id="p-0052" num="0052">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mi>i</mi>
  <mo>,</mo>
  <mstyle>
    <mspace width="0.3em" height="0.3ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <munder>
      <mi>max</mi>
      <mrow>
        <mi>Δ</mi>
        <mo>&gt;</mo>
        <mi>k</mi>
      </mrow>
    </munder>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mo></mo>
        <mfrac>
          <mrow>
            <mrow>
              <mi>RDS</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>i</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>RDS</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>-</mo>
                  <mi>Δ</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mi>Δ</mi>
        </mfrac>
        <mo></mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0053" num="0053">A number of embodiments of the invention have been described. Nevertheless, it will be understood that various modifications may be made without departing from the spirit and scope of the invention. Accordingly, other embodiments are within the scope of the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298294-20071120-M00001.NB">
<img id="EMI-M00001" he="16.93mm" wi="76.20mm" file="US07298294-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298294-20071120-M00002.NB">
<img id="EMI-M00002" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003 MATH-US-00003-2 MATH-US-00003-3" nb-file="US07298294-20071120-M00003.NB">
<img id="EMI-M00003" he="24.72mm" wi="76.20mm" file="US07298294-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298294-20071120-M00004.NB">
<img id="EMI-M00004" he="6.35mm" wi="76.20mm" file="US07298294-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298294-20071120-M00005.NB">
<img id="EMI-M00005" he="16.59mm" wi="76.20mm" file="US07298294-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298294-20071120-M00006.NB">
<img id="EMI-M00006" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298294-20071120-M00007.NB">
<img id="EMI-M00007" he="16.59mm" wi="76.20mm" file="US07298294-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298294-20071120-M00008.NB">
<img id="EMI-M00008" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298294-20071120-M00009.NB">
<img id="EMI-M00009" he="16.59mm" wi="76.20mm" file="US07298294-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07298294-20071120-M00010.NB">
<img id="EMI-M00010" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07298294-20071120-M00011.NB">
<img id="EMI-M00011" he="16.59mm" wi="76.20mm" file="US07298294-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07298294-20071120-M00012.NB">
<img id="EMI-M00012" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013" nb-file="US07298294-20071120-M00013.NB">
<img id="EMI-M00013" he="16.59mm" wi="76.20mm" file="US07298294-20071120-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US07298294-20071120-M00014.NB">
<img id="EMI-M00014" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US07298294-20071120-M00015.NB">
<img id="EMI-M00015" he="16.59mm" wi="76.20mm" file="US07298294-20071120-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016" nb-file="US07298294-20071120-M00016.NB">
<img id="EMI-M00016" he="8.47mm" wi="76.20mm" file="US07298294-20071120-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such than an average DC value of the data approaches zero, wherein the metric is selected from a group consisting of a maximum absolute value of a running digital sum of the data, a maximum DC offset introduced by a filtering operation, a maximum DC offset of a DC correction circuit, a maximum absolute value of a filtered output of the data, a maximum DC offset slope change of the running digital sum of the data, a count of the quantity of times the metric is above or below a threshold, and combinations thereof.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The encoder of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising a precoder to generate the data from the communication signal.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The encoder of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the data includes sectors; and
<claim-text>the metric being a function of the data sectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The encoder of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the data includes codewords; and
<claim-text>the metric being a function of the data codewords.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero, wherein the data includes past encoder outputs and possible future encoder outputs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero, wherein the flip bit is at least two flip bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The encoder of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the flip bit is inserted after every k input bits of the data.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The encoder of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein there are two DC Check circuits corresponding to each flip bit.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero, wherein the DC-Check circuit includes limiting a maximum of an absolute value of a running digital sum.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The encoder of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the running digital sum up to time n is defined as;</claim-text>
<claim-text>
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>∑</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>x</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>where</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mi>∞</mi>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>T</mi>
          <mn>0</mn>
        </msub>
        <mo>&lt;</mo>
        <mn>0</mn>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>RDS</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>T</mi>
              <mi>o</mi>
            </msub>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>RDS0</mi>
    <mo>=</mo>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>o</mi>
          </msub>
          <mo>,</mo>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>represents encoder outputs, and RDS0 is a state of the DC-Check circuit before new data is entered.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The encoder of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein an output of the DC-Check circuit for an input sequence of the data is;</claim-text>
<claim-text>
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>max</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munder>
        <mi>max</mi>
        <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>n</mi>
          <mo>≤</mo>
          <mi>k</mi>
        </mrow>
      </munder>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo></mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>RDS0</mi>
          </mrow>
          <mo></mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>wherein the flip bit is inserted after k input bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero, wherein the DC-Check circuit includes limiting a maximum DC offset of a filtering operation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The encoder of <claim-ref idref="CLM-00012">claim 12</claim-ref> wherein the DC-Check circuit includes a low pass filter having a transfer function that complements the filtering operation; and
<claim-text>an absolute value determiner to determine an absolute value of an output of the low pass filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero, wherein the DC-Check circuit includes limiting for a DC correction circuit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The encoder of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the DC-Check circuit includes a low pass filter to model the DC correction circuit; and
<claim-text>an offset estimation filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. An encoder to encode a communication signal, comprising:
<claim-text>a signal buffer to buffer data associated with the communication signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the DC-Check circuit includes threshold limiting.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A disk drive comprising:
<claim-text>a signal processor to process a perpendicular recording input signal;</claim-text>
<claim-text>a DC-free encoder to generate an encoded signal as a function of the perpendicular recording input signal, the DC-free encoder including;</claim-text>
<claim-text>a signal buffer to buffer data associated with the perpendicular recording input signal;</claim-text>
<claim-text>a DC-Check circuit to compute a metric as a function of the data;</claim-text>
<claim-text>a DC tracking block to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>a flip unit, responsive to the flip signal, to control a flip bit of an output of the signal buffer such that an average DC value of the data approaches zero;</claim-text>
<claim-text>a preamplifier to transmit the encoded signal; and</claim-text>
<claim-text>media to store the encoded signal as first data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The disk drive of <claim-ref idref="CLM-00017">claim 17</claim-ref> further including a read head amplifier to read the first data from the media;
<claim-text>a DC-free decoder to decode the first data; and</claim-text>
<claim-text>the signal processor to generate an output signal as a function of the decoded first data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the metric is selected from a group consisting of a maximum absolute value of a running digital sum of the data, a maximum DC offset introduced by a filtering operation, a maximum DC offset of a DC correction circuit, a maximum absolute value of a filtered Express
<claim-text>output of the data, a maximum DC offset slope change of the running digital sum of the data, a count of the quantity of times the metric is above or below a threshold, and combinations thereof.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> further comprising a precoder to generate the data from the communication signal.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the data includes sectors; and
<claim-text>the metric being a function of the data sectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the data includes codewords; and
<claim-text>the metric being a function of the data codewords.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the data includes past encoder outputs and possible future encoder outputs.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the flip bit is at least two flip bits.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the flip bit is inserted after every k input bits of the data.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein there are two DC-Check circuits corresponding to each flip bit.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the DC-Check circuit includes limiting a maximum of an absolute value of a running digital sum.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The disk drive of <claim-ref idref="CLM-00027">claim 27</claim-ref> wherein the running digital sum up to time n is defined as;</claim-text>
<claim-text>
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>∑</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>x</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>where</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mi>∞</mi>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>T</mi>
          <mn>0</mn>
        </msub>
        <mo>&lt;</mo>
        <mn>0</mn>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>RDS</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>T</mi>
              <mi>o</mi>
            </msub>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>RDS0</mi>
    <mo>=</mo>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>o</mi>
          </msub>
          <mo>,</mo>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>represents encoder outputs, and RDS0 is a state of the DC-Check circuit before new data is entered.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The disk drive of <claim-ref idref="CLM-00028">claim 28</claim-ref> wherein an output of the DC-Check circuit for an input sequence of the data is;</claim-text>
<claim-text>
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>max</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munder>
        <mi>max</mi>
        <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>n</mi>
          <mo>≤</mo>
          <mi>k</mi>
        </mrow>
      </munder>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo></mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>RDS0</mi>
          </mrow>
          <mo></mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>wherein the flip bit is inserted after k input bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the DC-Check circuit includes limiting a maximum DC offset of a filtering operation.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The disk drive of <claim-ref idref="CLM-00030">claim 30</claim-ref> wherein the DC-Check circuit includes a low pass filter having a transfer function that complements the filtering operation; and
<claim-text>an absolute value determiner to determine an absolute value of an output of the low pass filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the DC-Check circuit includes limiting for a DC correction circuit.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The disk drive of <claim-ref idref="CLM-00032">claim 32</claim-ref> wherein the DC-Check circuit includes a low pass filter to model the DC correction circuit; and
<claim-text>an offset estimation filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The disk drive of <claim-ref idref="CLM-00018">claim 18</claim-ref> wherein the DC-Check circuit includes threshold limiting.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the computing the metric includes;
<claim-text>providing at least two DC-Check circuits including a first DC-Check circuit and a second DC-Check circuit; initializing the at least two DC-Check circuits;</claim-text>
<claim-text>inserting a zero before a new codeword of the data;</claim-text>
<claim-text>buffering the new codeword;</claim-text>
<claim-text>generating words in each of the DC-Check circuits; and</claim-text>
<claim-text>selecting a winning word of the words.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The method of <claim-ref idref="CLM-00035">claim 35</claim-ref> wherein the initializing includes;
<claim-text>determining whether the data is prior to a first codeword;</claim-text>
<claim-text>for data prior to the first codeword;
<claim-text>a) passing the data through the first DC-Check circuit;</claim-text>
<claim-text>b) setting a state of the second DC-Check circuit to a state of the first DC-Check circuit.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the controlling the flip bit includes;</claim-text>
<claim-text>if the winning word is from the first DC-Check circuit; setting the state of the first DC-Check circuit to the state of the second DC-Check circuit; and</claim-text>
<claim-text>passing an inverse of the new codeword to the output; and</claim-text>
<claim-text>if the winning word is from the second DC-Check circuit;</claim-text>
<claim-text>setting the state of the second DC-Check circuit to the state of the first DC-Check circuit; and</claim-text>
<claim-text>passing the new codeword to the output.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The method of <claim-ref idref="CLM-00035">claim 35</claim-ref> further comprising precoding the new codeword.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the metric is selected from a group consisting of a maximum absolute value of a running digital sum of the data, a maximum DC offset introduced by a filtering operation, a maximum DC offset of a DC correction circuit, a maximum absolute value of a filtered output of the data, a maximum DC offset slope change of the running digital sum of the data, a count of the quantity of times the metric is above or below a threshold, and combinations thereof.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the data includes past encoder outputs and possible future encoder outputs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the flip bit is at least two flip bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. The method of <claim-ref idref="CLM-00035">claim 35</claim-ref> further comprising inserting the flip bit after every k input bits of the data.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. The method of <claim-ref idref="CLM-00035">claim 35</claim-ref> further comprising comprising providing two DC-Check circuits corresponding to each flip bit.</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the metric includes limiting a maximum of an absolute value of a running digital sum.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. The method of <claim-ref idref="CLM-00044">claim 44</claim-ref> wherein the running digital sum up to time n is defined as;</claim-text>
<claim-text>
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>∑</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>x</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>where</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mi>∞</mi>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>T</mi>
          <mn>0</mn>
        </msub>
        <mo>&lt;</mo>
        <mn>0</mn>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>RDS</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>T</mi>
              <mi>o</mi>
            </msub>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>RDS0</mi>
    <mo>=</mo>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>o</mi>
          </msub>
          <mo>,</mo>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>represents encoder outputs, and RDS0 is a state of a DC-Check circuit before new data is entered.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. The method of <claim-ref idref="CLM-00045">claim 45</claim-ref> wherein an output of the DC-Check circuit for an input sequence of the data is;</claim-text>
<claim-text>
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>max</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munder>
        <mi>max</mi>
        <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>n</mi>
          <mo>≤</mo>
          <mi>k</mi>
        </mrow>
      </munder>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo></mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>RDS0</mi>
          </mrow>
          <mo></mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>wherein the flip bit is inserted after k input bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the metric includes limiting a maximum DC offset of a filtering operation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. The method of <claim-ref idref="CLM-00047">claim 47</claim-ref> further comprising providing a DC-Check circuit including a low pass filter having a transfer function that complements the filtering operation; and
<claim-text>an absolute value determiner to determine an absolute value of an output of the low pass filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00049" num="00049">
<claim-text>49. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the metric includes limiting for a DC correction circuit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00050" num="00050">
<claim-text>50. The method of <claim-ref idref="CLM-00049">claim 49</claim-ref> further comprising providing a DC-Check circuit including a low pass filter to model the DC correction circuit; and
<claim-text>an offset estimation filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00051" num="00051">
<claim-text>51. A method of encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal;</claim-text>
<claim-text>computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero,</claim-text>
<claim-text>wherein the metric includes threshold limiting.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00052" num="00052">
<claim-text>52. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the metric is selected from a group consisting of a maximum absolute value of a running digital sum of the data, a maximum DC offset introduced by a filtering operation, a maximum DC offset of a DC correction circuit, a maximum absolute value of a filtered output of the data, a maximum DC offset slope change of the running digital sum of the data, a count of the quantity of times the metric is above or below a threshold, and combinations thereof.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00053" num="00053">
<claim-text>53. The encoder of <claim-ref idref="CLM-00052">claim 52</claim-ref> further comprising means for precoding to generate the data from the communication signal.</claim-text>
</claim>
<claim id="CLM-00054" num="00054">
<claim-text>54. The encoder of <claim-ref idref="CLM-00052">claim 52</claim-ref> wherein the data includes sectors; and
<claim-text>the metric being a function of the data sectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00055" num="00055">
<claim-text>55. The encoder of <claim-ref idref="CLM-00052">claim 52</claim-ref> wherein the data includes codewords; and
<claim-text>the metric being a function of the data codewords.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00056" num="00056">
<claim-text>56. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the data includes past encoder outputs and possible future encoder outputs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00057" num="00057">
<claim-text>57. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the flip bit is at least two flip bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00058" num="00058">
<claim-text>58. The encoder of <claim-ref idref="CLM-00052">claim 52</claim-ref> wherein the flip bit is inserted after every k input bits of the data.</claim-text>
</claim>
<claim id="CLM-00059" num="00059">
<claim-text>59. The encoder of <claim-ref idref="CLM-00052">claim 52</claim-ref> wherein there are two means for metric computing corresponding to each flip bit.</claim-text>
</claim>
<claim id="CLM-00060" num="00060">
<claim-text>60. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the means for metric computing includes limiting a maximum of an absolute value of a running digital sum.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00061" num="00061">
<claim-text>61. The encoder of <claim-ref idref="CLM-00060">claim 60</claim-ref> wherein the running digital sum up to time n is defined as;</claim-text>
<claim-text>
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>∑</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>x</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>where</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mi>∞</mi>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>T</mi>
          <mn>0</mn>
        </msub>
        <mo>&lt;</mo>
        <mn>0</mn>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>RDS</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>T</mi>
              <mi>o</mi>
            </msub>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>RDS0</mi>
    <mo>=</mo>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>o</mi>
          </msub>
          <mo>,</mo>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>represents encoder outputs, and RDS0 is a state of the metric computing means before new data is entered.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00062" num="00062">
<claim-text>62. The encoder of <claim-ref idref="CLM-00061">claim 61</claim-ref> wherein an output of the metric computing means for an input sequence of the data is;</claim-text>
<claim-text>
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>max</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munder>
        <mi>max</mi>
        <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>n</mi>
          <mo>≤</mo>
          <mi>k</mi>
        </mrow>
      </munder>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo></mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>RDS0</mi>
          </mrow>
          <mo></mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>wherein the flip bit is inserted after k input bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00063" num="00063">
<claim-text>63. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the metric computing means includes limiting a maximum DC offset of a filtering operation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00064" num="00064">
<claim-text>64. The encoder of <claim-ref idref="CLM-00063">claim 63</claim-ref> wherein the metric computing means includes means for low pass filtering having a transfer function that complements the filtering operation; and
<claim-text>an absolute value determiner to determine an absolute value of an output of the means for low pass filtering.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00065" num="00065">
<claim-text>65. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the metric computing means includes limiting for a DC correction circuit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00066" num="00066">
<claim-text>66. The encoder of <claim-ref idref="CLM-00065">claim 65</claim-ref> wherein the metric computing means includes means for filtering to model the DC correction circuit; and
<claim-text>an offset estimation filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00067" num="00067">
<claim-text>67. An encoder to encode a communication signal, comprising:
<claim-text>means for buffering to buffer data associated with the communication signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero, wherein the metric computing means includes threshold limiting.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00068" num="00068">
<claim-text>68. A disk drive comprising:
<claim-text>means for signal processing to process a perpendicular recording input signal;</claim-text>
<claim-text>a DC-free encoder to generate an encoded signal as a function of the perpendicular recording input signal, the DC-free encoder including;</claim-text>
<claim-text>means for buffering to buffer data associated with the perpendicular recording input signal;</claim-text>
<claim-text>means for metric computing to compute a metric as a function of the data;</claim-text>
<claim-text>means for DC tracking to generate a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and</claim-text>
<claim-text>means for flipping, responsive to the flip signal, to control a flip bit of an output of the buffering means such that an average DC value of the data approaches zero;</claim-text>
<claim-text>means for preamplifying to transmit the encoded signal; and</claim-text>
<claim-text>media to store the encoded signal as first data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00069" num="00069">
<claim-text>69. The disk drive of <claim-ref idref="CLM-00068">claim 68</claim-ref> further including a read head amplifier to read the first data from the media;
<claim-text>means for DC-free decoding to decode the first data; and</claim-text>
<claim-text>the signal processing means to generate an output signal as a function of the decoded first data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00070" num="00070">
<claim-text>70. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the metric is selected from a group consisting of a maximum absolute value of a running digital sum of the data, a maximum DC offset introduced by a filtering operation, a maximum DC offset of a DC correction circuit, a maximum absolute value of a filtered output of the data, a maximum DC offset slope change of the running digital sum of the data, a count of the quantity of times the metric is above or below a threshold, and combinations thereof.</claim-text>
</claim>
<claim id="CLM-00071" num="00071">
<claim-text>71. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> further comprising means for preceding to generate the data from the communication signal.</claim-text>
</claim>
<claim id="CLM-00072" num="00072">
<claim-text>72. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the data includes sectors; and
<claim-text>the metric being a function of the data sectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00073" num="00073">
<claim-text>73. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the data includes codewords; and
<claim-text>the metric being a function of the data codewords.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00074" num="00074">
<claim-text>74. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the data includes past encoder outputs and possible future encoder outputs.</claim-text>
</claim>
<claim id="CLM-00075" num="00075">
<claim-text>75. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the flip bit is at least two flip bits.</claim-text>
</claim>
<claim id="CLM-00076" num="00076">
<claim-text>76. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the flip bit is inserted after every k input bits of the data.</claim-text>
</claim>
<claim id="CLM-00077" num="00077">
<claim-text>77. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein there are two means for metric computing corresponding to each flip bit.</claim-text>
</claim>
<claim id="CLM-00078" num="00078">
<claim-text>78. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the means for metric computing includes limiting a maximum of an absolute value of a running digital sum.</claim-text>
</claim>
<claim id="CLM-00079" num="00079">
<claim-text>79. The disk drive of <claim-ref idref="CLM-00078">claim 78</claim-ref> wherein the running digital sum up to time n is defined as;</claim-text>
<claim-text>
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>∑</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>x</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>where</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mi>∞</mi>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>T</mi>
          <mn>0</mn>
        </msub>
        <mo>&lt;</mo>
        <mn>0</mn>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>RDS</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>T</mi>
              <mi>o</mi>
            </msub>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>RDS0</mi>
    <mo>=</mo>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>o</mi>
          </msub>
          <mo>,</mo>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>represents encoder outputs, and RDS0 is a state of the means for metric computing before new data is entered.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00080" num="00080">
<claim-text>80. The disk drive of <claim-ref idref="CLM-00079">claim 79</claim-ref> wherein an output of the means for metric computing for an input sequence of the data is;</claim-text>
<claim-text>
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>max</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munder>
        <mi>max</mi>
        <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>n</mi>
          <mo>≤</mo>
          <mi>k</mi>
        </mrow>
      </munder>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo></mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>RDS0</mi>
          </mrow>
          <mo></mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>wherein the flip bit is inserted after k input bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00081" num="00081">
<claim-text>81. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the means for metric computing includes limiting a maximum DC offset of a filtering operation.</claim-text>
</claim>
<claim id="CLM-00082" num="00082">
<claim-text>82. The disk drive of <claim-ref idref="CLM-00081">claim 81</claim-ref> wherein the means for metric computing includes means for low pass filtering having a transfer function that complements the filtering operation; and
<claim-text>an absolute value determiner to determine an absolute value of an output of the means for low pass filtering.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00083" num="00083">
<claim-text>83. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the means for metric computing includes limiting for a DC correction circuit.</claim-text>
</claim>
<claim id="CLM-00084" num="00084">
<claim-text>84. The disk drive of <claim-ref idref="CLM-00083">claim 83</claim-ref> wherein the means for metric computing includes means for low pass filtering to model the DC correction circuit; and
<claim-text>an offset estimation filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00085" num="00085">
<claim-text>85. The disk drive of <claim-ref idref="CLM-00069">claim 69</claim-ref> wherein the means for metric computing includes threshold limiting.</claim-text>
</claim>
<claim id="CLM-00086" num="00086">
<claim-text>86. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the computing the metric includes;</claim-text>
<claim-text>providing at least two DC-Check circuits including a first DC-Check circuit and a second DC-Check circuit; initializing the at least two DC-Check circuits;</claim-text>
<claim-text>inserting a zero before a new codeword of the data; buffering the new codeword;</claim-text>
<claim-text>generating words in each of the DC-Check circuits; and selecting a winning word of the words.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00087" num="00087">
<claim-text>87. The computer program of <claim-ref idref="CLM-00086">claim 86</claim-ref> wherein the initializing includes;
<claim-text>determining whether the data is prior to a first codeword;
<claim-text>for data prior to the first codeword;
<claim-text>a) passing the data through the first DC-Check circuit;</claim-text>
<claim-text>b) setting a state of the second DC-Check circuit to a state of the first DC-Check circuit.</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00088" num="00088">
<claim-text>88. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the controlling the flip bit includes;</claim-text>
<claim-text>if the winning word is from the first DC-Check circuit;
<claim-text>setting the state of the first DC-Check circuit to the state of the second DC-Check circuit; and</claim-text>
<claim-text>passing an inverse of the new codeword to the output; and</claim-text>
</claim-text>
<claim-text>if the winning word is from the second DC-Check circuit;
<claim-text>setting the state of the second DC-Check circuit to the state of the first DC-Check circuit; and</claim-text>
<claim-text>passing the new codeword to the output.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00089" num="00089">
<claim-text>89. The computer program of <claim-ref idref="CLM-00086">claim 86</claim-ref> further comprising preceding the new codeword.</claim-text>
</claim>
<claim id="CLM-00090" num="00090">
<claim-text>90. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the metric is selected from a group consisting of a maximum absolute value of a running digital sum of the data, a maximum DC offset introduced by a filtering operation, a maximum DC offset of a DC correction circuit, a maximum absolute value of a filtered output of the data, a maximum DC offset slope change of the running digital sum of the data, a count of the quantity of times the metric is above or below a threshold, and combinations thereof.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00091" num="00091">
<claim-text>91. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the data includes past encoder outputs and possible future encoder outputs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00092" num="00092">
<claim-text>92. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the flip bit is at least two flip bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00093" num="00093">
<claim-text>93. The computer program of <claim-ref idref="CLM-00086">claim 86</claim-ref> further comprising inserting the flip bit after every k input bits of the data.</claim-text>
</claim>
<claim id="CLM-00094" num="00094">
<claim-text>94. The computer program of <claim-ref idref="CLM-00086">claim 86</claim-ref> further comprising providing two DC-Check circuits corresponding to each flip bit.</claim-text>
</claim>
<claim id="CLM-00095" num="00095">
<claim-text>95. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the metric includes limiting a maximum of an absolute value of a running digital sum.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00096" num="00096">
<claim-text>96. The computer program of <claim-ref idref="CLM-00095">claim 95</claim-ref> wherein the running digital sum up to time n is defined as;</claim-text>
<claim-text>
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munderover>
        <mo>∑</mo>
        <mrow>
          <mi>i</mi>
          <mo>=</mo>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
        </mrow>
        <mi>n</mi>
      </munderover>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>x</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>where</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mi>∞</mi>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>T</mi>
          <mn>0</mn>
        </msub>
        <mo>&lt;</mo>
        <mn>0</mn>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mn>0</mn>
          </msub>
          <mo>,</mo>
          <mi>n</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mi>RDS</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msub>
              <mi>T</mi>
              <mi>o</mi>
            </msub>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mrow>
          <mi>RDS</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mtext>
</mtext>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>RDS0</mi>
    <mo>=</mo>
    <mrow>
      <mi>RDS</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>T</mi>
            <mi>o</mi>
          </msub>
          <mo>,</mo>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where x<sub>i </sub>represents encoder outputs, and RDS0 is a state of a DC-Check circuit before new data is entered.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00097" num="00097">
<claim-text>97. The computer program of <claim-ref idref="CLM-00096">claim 96</claim-ref> wherein an output of the DC-Check circuit for an input sequence of the data is;</claim-text>
<claim-text>
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>RDS</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>max</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <munder>
        <mi>max</mi>
        <mrow>
          <mn>0</mn>
          <mo>≤</mo>
          <mi>n</mi>
          <mo>≤</mo>
          <mi>k</mi>
        </mrow>
      </munder>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo></mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>0</mn>
                </mrow>
                <mi>n</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <msub>
                      <mi>x</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>RDS0</mi>
          </mrow>
          <mo></mo>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>wherein the flip bit is inserted after k input bits.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00098" num="00098">
<claim-text>98. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the metric includes limiting a maximum DC offset of a filtering operation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00099" num="00099">
<claim-text>99. The computer program of <claim-ref idref="CLM-00098">claim 98</claim-ref> further comprising providing a DC-Check circuit including a low pass filter having a transfer function that complements the filtering operation; and
<claim-text>an absolute value determiner to determine an absolute value of an output of the low pass filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00100" num="00100">
<claim-text>100. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such that an average DC value of the data approaches zero, wherein the metric includes limiting for a DC correction circuit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00101" num="00101">
<claim-text>101. The computer program of <claim-ref idref="CLM-00100">claim 100</claim-ref> further comprising providing a DC-Check circuit including a low pass filter to model the DC correction circuit; and
<claim-text>an offset estimation filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00102" num="00102">
<claim-text>102. A computer program stored on a computer-readable medium to configure a general purpose computer to perform a method for encoding a communication signal, comprising:
<claim-text>buffering data associated with the communication signal; computing a metric as a function of the data;</claim-text>
<claim-text>generating a flip signal as a function of the metric, the flip signal having a flip state and a nonflip state; and responsive to the flip signal, controlling a flip bit of the data such than an average DC value of the data approaches zero, wherein the metric includes threshold limiting. </claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
