<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298319-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298319</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10826270</doc-number>
<date>20040419</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>127</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>S</subclass>
<main-group>5</main-group>
<subgroup>14</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>C</subclass>
<main-group>21</main-group>
<subgroup>20</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>34235702</main-classification>
<further-classification>701213</further-classification>
</classification-national>
<invention-title id="d0e53">Automatic decorrelation and parameter tuning real-time kinematic method and apparatus</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5748145</doc-number>
<kind>A</kind>
<name>Talbot et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>34235704</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6181274</doc-number>
<kind>B1</kind>
<name>Pratt et al.</name>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>34235704</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2005/0190103</doc-number>
<kind>A1</kind>
<name>Rapoport et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>34235704</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00004">
<othercit>Direections Magazine“Thales Navigation Z-Max Gives Professional Surveyors Maximum Productivity with Unique, Modular Design and Superior RTK Positioning” Aug. 28, 2003 Press Release.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00005">
<othercit>Thales Navigation, “Z-Max Surveying System,” Product Sheet from www.thalesnavigation.com. Aug. 18, 2003.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>Abousalem et al, “Ashtech Instant-RTK: A Revolutionary Solution for Surveying Professionals,” Presented at the 3rd International Symposium on Mobile Mapping Technology, Cairo, Egypt, Jan. 2001, pp. 1-13.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00007">
<othercit>Dai, Liwen et al, “A Multiple Outlier Detection Algorithm for Instantaneous Ambiguity Resolution for Carrier Phase-Based GNSS Positioning,” Proceedings of the International Symposium on Digital Earth, 1999, pp. 1-12.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>Park, Chansik et al, “Efficient Ambiguity Resolution Using Constraint Equation,” IEEE PLANS 1996, pp. 277-284.□□.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Teunissen, P.J.G., “A New Method for Fast Carrier Phase Ambigutiy Estimation,” IEEE PLANS 1994, pp. 562-573.□□.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
</references-cited>
<number-of-claims>4</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>34235702</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>34235704</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>701213</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050231423</doc-number>
<kind>A1</kind>
<date>20051020</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Han</last-name>
<first-name>Shaowei</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Dai</last-name>
<first-name>Liwen</first-name>
<address>
<city>Pomona</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Ward</last-name>
<first-name>John P.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>Greenberg Traurig, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Magellan Navigation, Inc.</orgname>
<role>02</role>
<address>
<city>Santa Clara</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Issing</last-name>
<first-name>Gregory C.</first-name>
<department>3662</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method of and computer-readable medium containing instructions for high accuracy, reliable position determination. The ADAPT-RTK Technology (Automatic Decorrelation and Parameter Tuning Real-Time Kinematic technology) is described using an innovative decorrelation algorithm to decorrelate the correlation between L1 and L2 measurements through a functional model and a stochastic model reducing the impact on performance of distance dependent biases.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="149.69mm" wi="79.93mm" file="US07298319-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="114.05mm" wi="146.56mm" file="US07298319-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="157.56mm" wi="80.52mm" file="US07298319-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="113.54mm" wi="143.17mm" file="US07298319-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="197.78mm" wi="175.01mm" file="US07298319-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="205.49mm" wi="175.85mm" file="US07298319-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="252.65mm" wi="193.12mm" orientation="landscape" file="US07298319-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The present application is related to co-pending U.S. patent application Ser. No. 10/610,544 entitled, “Accurate and Fast RTK,” and co-pending U.S. patent application Ser. No. 10/610,541 entitled, “Enhanced Real Time Kinematics Determination Method and Apparatus,” both assigned to the present assignee, both hereby incorporated herein by reference in their entirety, and both filed on Jul. 2, 2003.</p>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a method of and apparatus for an improved decorrelation and parameter tuning capability for real time kinematics (RTK) determination.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">High precision GPS kinematic positioning is widely used for many surveying and navigation applications on land, at sea and in the air. The distance from the mobile receiver to the nearest reference receiver may range from a few kilometers to hundreds of kilometers. As the receiver separation increases, the problem of accounting for distance-dependent biases grows and, as a consequence, reliable ambiguity resolution becomes an even greater challenge.</p>
<p id="p-0005" num="0004">The standard mode of precise differential positioning uses one reference receiver located at a station whose coordinates are known, while determining a second receiver's coordinates relative to the reference receiver. In addition, the second receiver may be static or moving, and carrier phase measurements must be used to assure high positioning accuracy. This is the basis for pseudo-range-based differential global positioning system (GPS) (DGPS for short) techniques. However, for high precision applications, the use of carrier phase data comes at a cost in terms of overall system complexity because the measurements are ambiguous, requiring that ambiguity resolution (AR) algorithms be incorporated as an integral part of the data processing software.</p>
<p id="p-0006" num="0005">Such high accuracy techniques result from progressive research and development (R&amp;D) innovations, subsequently implemented by GPS manufacturers in top-of-the-line “GPS surveying” products. Over the last decade, several significant developments have resulted in the high accuracy performance also being available in “real-time”—that is, in the field, immediately following measurement, and after the data from the reference receiver has been received by the (second) field receiver for processing via a data communication link (e.g., very high frequency (VHF) or ultra high frequency (UHF) radio, cellular telephone, frequency modulation (FM) radio sub-carrier or satellite communication link). Real-time precise positioning is even possible when the GPS receiver is in motion through the use of “on-the-fly” (OTF) AR algorithms. These systems are commonly referred to as “real-time kinematic” (RTK) systems, and make feasible the use of GPS-RTK for many time-critical applications, e.g., machine control, GPS-guided earthworks/excavations, automated haul truck operations, and other autonomous robotic navigation applications.</p>
<p id="p-0007" num="0006">If the GPS signals were continuously tracked (loss-of-lock never occurred), the integer ambiguities resolved at the beginning of a survey would be valid for the whole GPS kinematic positioning span. However, the GPS satellite signals are occasionally shaded (e.g. due to buildings in “urban canyon” environments), or momentarily blocked (e.g. when the receiver passes under a bridge or through a tunnel), and in these circumstances the integer ambiguity values are “lost” and must be re-determined or re-initialized. This process can take from a few tens of seconds up to several minutes with present OTF AR techniques. During this “re-initialization” period, the GPS carrier-range data cannot be obtained and there is “dead” time until sufficient data has been collected to resolve the ambiguities. If GPS signal interruptions occur repeatedly, ambiguity re-initialization is, at the very least, an irritation, and, at worst, a significant weakness of commercial GPS-RTK positioning systems. In addition, the longer the period of tracking required to ensure reliable OTF AR, the greater the risk that cycle slips occur during the crucial (re-)initialization period. A loss of lock of a receiver phase lock loop causing a sudden integer number of cycles jump in a carrier phase observable is known as a cycle slip. Receiver tracking problems or an interrupted ability of the antenna to receive satellite signals causes the loss of lock. As the receiver separation increases, the problems of accounting for distance-dependent biases grow and, as a consequence, reliable ambiguity resolution (or re-initialization) becomes an even greater challenge due to:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0007">Residual biases or errors;</li>
        <li id="ul0002-0002" num="0008">Observation span determination; and</li>
        <li id="ul0002-0003" num="0009">Kinematic positioning results quality control.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0008" num="0010">Residual biases or errors after double-differencing can only be neglected for AR purposes when the distance between two receivers is less than about 10 km. For distances greater than 10 km, the distance-dependent biases, such as orbit bias, ionospheric delay and tropospheric delay, become significant problems.</p>
<p id="p-0009" num="0011">Determining how long an observation span should be for reliable AR is a challenge for real-time GPS kinematic positioning. The longer the observation span required, the longer the “dead” time during which precise position determination is not possible. This can happen at the ambiguity initialization step if a GPS survey is just starting, or at the ambiguity re-initialization step if the GPS signals are blocked, such as due to cycle slips or data interruptions.</p>
<p id="p-0010" num="0012">Quality control of GPS kinematic positioning results is a critical issue and is necessary during all processes: data collection, data processing and data transmission. Quality control procedures are not only applied for carrier phase-based GPS kinematic positioning, but also for pseudo-range-based DGPS positioning. However, quality control or validation criteria for AR, for precise GPS kinematic positioning, is a significant challenge.</p>
<p id="p-0011" num="0013">There is a need in the art for an improved method of processing GPS signals to improve decorrelation and parameter tuning capabilities for high accuracy, reliable position determination.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0012" num="0014">It is therefore an object of the present invention to provide a method of processing GPS signals to improve decorrelation and parameter tuning capabilities for high accuracy, reliable position determination.</p>
<p id="p-0013" num="0015">In an embodiment according to the present application, the ADAPT-RTK Technology (Automatic Decorrelation and Parameter Tuning Real-Time Kinematic technology) is described using an innovative decorrelation algorithm to decorrelate the correlation between L<b>1</b> and L<b>2</b> measurements through a functional model and a stochastic model reducing the impact on performance of distance dependent biases. Therefore, the ADAPT-RTK Technology improves GPS RTK performance to exceed other products in the market, especially on long-range applications.</p>
<p id="p-0014" num="0016">The present inventors have successfully implemented the present decorrelation approach in a Z-Max RTK engine from Thales Navigation. After extensive testing using Z-Xtreme and Z-Max receivers, the most exciting results have been derived.</p>
<p id="p-0015" num="0017">The decorrelation approach has significant advantages: (1) it more closely describes the measurement natural features, especially in long-range applications; (2) it is a rigorous approach from a Kalman filtering implementation point of view; (3) all other approaches, e.g., widelane/iono-free approach, widelane only approach, become special cases in theory and in practice, and; (4) it significantly improves RTK performance, especially for long-range applications.</p>
<p id="p-0016" num="0018">The functional model includes determining the reference satellite, residuals, and design matrix. The stochastic model includes variance-covariance matrix determination for measurements and the variance-covariance matrix for dynamic noise in Kalman filtering.</p>
<p id="p-0017" num="0019">The RTK technique requires available dual frequency pseudo-range and carrier phase measurements. On-the-fly RTK might not necessarily need pseudo-range measurements because the float solution can be derived by the change of carrier phase measurements between epochs (or Doppler measurements). However, the float solution using data from a single epoch must be derived by pseudo-range measurements. The integrated function model means modeling carrier phase measurements and also pseudo-range measurements and their stochastic features are included. The stochastic model for carrier phase measurements and pseudo-range measurements, especially the ratio between standard deviations of carrier phase and pseudo-range, significantly affects the float solution and subsequently affects the RTK performance. The present invention provides appropriate stochastic models for both carrier phase and pseudo-range to enhance RTK performance.</p>
<p id="p-0018" num="0020">Still other objects and advantages of the present invention will become readily apparent to those skilled in the art from the following detailed description, wherein the preferred embodiments of the invention are shown and described, simply by way of illustration of the best mode contemplated of carrying out the invention. As will be realized, the invention is capable of other and different embodiments, and its several details are capable of modifications in various obvious respects, all without departing from the invention.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0021">The present invention is illustrated by way of example, and not by limitation, in the figures of the accompanying drawings, wherein elements having the same reference numeral designations represent like elements throughout and wherein:</p>
<p id="p-0020" num="0022"><figref idref="DRAWINGS">FIG. 1</figref> is a graph of coefficients for a correlation approach according to an embodiment of the present invention;</p>
<p id="p-0021" num="0023"><figref idref="DRAWINGS">FIG. 2</figref> is a flow diagram of a decorrelation approach according to an embodiment of the present invention;</p>
<p id="p-0022" num="0024"><figref idref="DRAWINGS">FIG. 3</figref> is a graph of standard deviation for carrier phase and pseudorange according to an embodiment of the present invention;</p>
<p id="p-0023" num="0025"><figref idref="DRAWINGS">FIG. 4</figref> is a high level flow diagram of a process according to an embodiment of the present invention;</p>
<p id="p-0024" num="0026"><figref idref="DRAWINGS">FIG. 5</figref> is a flow diagram of a portion of the <figref idref="DRAWINGS">FIG. 4</figref> flow diagram according to an embodiment of the present invention; and</p>
<p id="p-0025" num="0027"><figref idref="DRAWINGS">FIG. 6</figref> is a computer system on which an embodiment of the present invention may be used.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0026" num="0028">The functional model of the present invention includes a Double Differenced Model. The double-differenced observable in units of meters can be formed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>λ<sub>j</sub>Δφ<sub>j</sub>−λ<sub>k</sub>Δφ<sub>k</sub>=∇Δρ<sub>k,j</sub>+λ<sub>j</sub><i>·ΔN</i><sub>j</sub>−λ<sub>k</sub><i>·ΔN</i><sub>k</sub><i>+ΔI/f</i><sub>j</sub><sup>2</sup><i>−ΔI/f</i><sub>k</sub><sup>2</sup>+ε<sub>∇Δφ</sub><sub><sub2>k,j</sub2></sub>  (1-1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
if the four reference satellites for GPS L<b>1</b>, GPS L<b>2</b>, GLONASS L<b>1</b> and GLONASS L<b>2</b> are chosen. In this case, four receiver clock term and inter-channel biases can be removed.
</p>
<p id="p-0027" num="0029">The integer ambiguity terms can also be re-arranged in the following way:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>λ<sub>j</sub>Δφ<sub>j</sub>−λ<sub>k</sub>Δφ<sub>k</sub>=∇Δρ<sub>k,j</sub>+λ<sub>j</sub><i>·∇ΔN</i><sub>k,j</sub>+(λ<sub>j</sub>−λ<sub>k</sub>)·ΔN<sub>k</sub><i>+ΔI/f</i><sub>j</sub><sup>2</sup><i>−ΔI/f</i><sub>k</sub><sup>2</sup>+ε∇Δφ<sub>k,j</sub>  (1-2)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0028" num="0030">For GPS carrier phase measurements, the third term on the lefthand side of equation (1-2) disappears because λ<sub>j </sub>and λ<sub>k </sub>are equal. For GLONASS carrier phase measurements, the third term, or the single-differenced integer ambiguity for the reference satellite, must be estimated prior to estimating the double-differenced integer ambiguities. The remaining errors from the third term can cause systematic model errors and may result in incorrect double-differenced ambiguity resolution, and hence degraded positioning accuracy.</p>
<p id="p-0029" num="0031">An alternative approach is to form the double-differenced observable after the single-differenced observables are expressed in units of cycles as in equation 1-3, as follows:</p>
<p id="p-0030" num="0032">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>∇</mo>
          <msub>
            <mi>Δϕ</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msub>
                    <mi>λ</mi>
                    <mn>1</mn>
                  </msub>
                </mfrac>
                <mo>⁢</mo>
                <msub>
                  <mi>Δρ</mi>
                  <mi>j</mi>
                </msub>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msub>
                    <mi>λ</mi>
                    <mi>k</mi>
                  </msub>
                </mfrac>
                <mo>⁢</mo>
                <msub>
                  <mi>Δρ</mi>
                  <mi>k</mi>
                </msub>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mrow>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>f</mi>
                    <mi>j</mi>
                  </msub>
                  <mo>-</mo>
                  <msub>
                    <mi>f</mi>
                    <mi>k</mi>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>·</mo>
              <mi>Δ</mi>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <msub>
              <mi>dT</mi>
              <mi>k</mi>
            </msub>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mrow>
              <mo>∇</mo>
              <mi>Δ</mi>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <msub>
              <mi>N</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
            </msub>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mi>Δ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mi>I</mi>
                  <mo>/</mo>
                  <mrow>
                    <mo>(</mo>
                    <msub>
                      <mi>ef</mi>
                      <mi>j</mi>
                    </msub>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>Δ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mi>I</mi>
                  <mo>/</mo>
                  <mrow>
                    <mo>(</mo>
                    <msub>
                      <mi>ef</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msub>
                    <mi>λ</mi>
                    <mi>j</mi>
                  </msub>
                </mfrac>
                <mo>⁢</mo>
                <mi>Δ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <msubsup>
                  <mi>d</mi>
                  <mi>j</mi>
                  <mi>trop</mi>
                </msubsup>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <msub>
                    <mi>λ</mi>
                    <mi>k</mi>
                  </msub>
                </mfrac>
                <mo>⁢</mo>
                <mi>Δ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <msubsup>
                  <mi>d</mi>
                  <mi>k</mi>
                  <mi>trop</mi>
                </msubsup>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>+</mo>
          <msub>
            <mi>ɛ</mi>
            <mrow>
              <mrow>
                <mo>∇</mo>
                <mi>Δ</mi>
              </mrow>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>ϕ</mi>
            </mrow>
          </msub>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>1</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>3</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where ΔdT<sub>k </sub>are different for GPS L<b>1</b>, GPS L<b>2</b>, GLONASS L<b>1</b> and GLONASS L2 signals. The differenced receiver clock bias (or inter-channel biases) cannot be eliminated in equation (1-3). The fourth term (ionospheric delay) and the fifth term (tropospheric delay) become slightly larger than in the case when the two frequencies are the same. Using GPS and GLONASS pseudo-range measurements, the difference between the two receiver clock biases is estimated. The estimate could be used to correct the second term for ambiguity resolution purposes; however, the receiver clock bias significantly degrades positioning accuracy.
</p>
<p id="p-0031" num="0033">In an embodiment according to the present invention, the proposed approach estimates ΔdT<sub>k </sub>using pseudorange and the second term is corrected prior to ambiguity resolution by using equation (1-3). After fixing the ambiguity, equation (1-2) is used for position fixing where the third term on the right side of equation (1-2) is estimated. For a GPS-only positioning system, the third term on the right side of equation (1-2) is always zero because the frequencies for satellite j and k are the same. The ionosphere delay is corrected by a GPS broadcast model (Klobuchar Model). The troposphere delay is corrected by the Hopfield model known to persons of skill in the art.</p>
<p id="h-0007" num="0000">Kalman Filtering State Vector</p>
<p id="p-0032" num="0034">For a GPS-only RTK system, the following states in a Kalman filter have been implemented:</p>
<p id="p-0033" num="0035">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="133pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="42pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>Elements in State Vector</entry>
<entry>Dimension</entry>
<entry>Notes</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Position component X (or Easting)</entry>
<entry>1</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry>Velocity component X (or Easting)</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Acceleration component X (or Easting)</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Position component Y (or Northing)</entry>
<entry>1</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry>Velocity component Y (or Northing)</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Acceleration component Y (or Northing)</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Position component Z (or Height)</entry>
<entry>1</entry>
<entry>Mandatory</entry>
</row>
<row>
<entry>Velocity component Z (or Height)</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Acceleration component Z (or Height)</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Zenith troposphere delay scale factor</entry>
<entry>1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>Residual DD ionosphere delay</entry>
<entry>Nsat-1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>L1 DD ambiguity</entry>
<entry>Nsat-1</entry>
<entry>Optional</entry>
</row>
<row>
<entry>L2 DD ambiguity</entry>
<entry>Nsat-1</entry>
<entry>Optional</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry namest="1" nameend="3" align="left" id="FOO-00001">Notes:</entry>
</row>
<row>
<entry namest="1" nameend="3" align="left" id="FOO-00002">Nsat is the number of visible satellites.</entry>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0034" num="0036">The ionosphere delay and the zenith troposphere delay scale factor are estimated after model correction although they operate without model corrections.</p>
<p id="h-0008" num="0000">Transition Matrix and Dynamic Noise</p>
<p id="h-0009" num="0000">Position Parameters</p>
<p id="p-0035" num="0037">When an observer is nearly stationary, such as a buoy drifting at sea, or crustal deformation monitoring, the position is assumed to be a random-walk process. In this case, three coordinate parameters are enough to employ the Kalman state vector. The transition matrix and dynamic noise are determined based on random walk model, such as equations 1-4 and 1-5:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>φ<sub>k,k-1</sub><i>=e</i><sup>F(t</sup><sup><sub2>k</sub2></sup><sup>−t</sup><sup><sub2>k-1)</sub2></sup>=1  (1-4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>k</sub>=σ<sub>u</sub><sup>2</sup>(<i>t</i><sub>k</sub><i>−t</i><sub>k-1</sub>)  (1-5)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0036" num="0038">which is called the Position model.</p>
<p id="p-0037" num="0039">When the observer is not stationary, but moving with nearly constant velocity, the velocity is not white noise but a random-walk process. In this case, three coordinate parameters and three velocity parameters must be included in the Kalman state vector. The transition matrix and dynamic noise can be determined based on integrated random walk model, such as equations 1-6 and 1-7:</p>
<p id="p-0038" num="0040">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>ϕ</mi>
          <mrow>
            <mi>k</mi>
            <mo>,</mo>
            <mrow>
              <mi>k</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mo>[</mo>
          <mtable>
            <mtr>
              <mtd>
                <mn>1</mn>
              </mtd>
              <mtd>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mi>t</mi>
                      <mi>k</mi>
                    </msub>
                    <mo>-</mo>
                    <msub>
                      <mi>t</mi>
                      <mrow>
                        <mi>k</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <mn>1</mn>
              </mtd>
            </mtr>
          </mtable>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>1</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>6</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>Q</mi>
          <mi>k</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msubsup>
            <mi>σ</mi>
            <mi>u</mi>
            <mn>2</mn>
          </msubsup>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mfrac>
                    <msup>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <msub>
                            <mi>t</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>-</mo>
                          <msub>
                            <mi>t</mi>
                            <mrow>
                              <mi>k</mi>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                          </msub>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mn>3</mn>
                    </msup>
                    <mn>3</mn>
                  </mfrac>
                </mtd>
                <mtd>
                  <mfrac>
                    <msup>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <msub>
                            <mi>t</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>-</mo>
                          <msub>
                            <mi>t</mi>
                            <mrow>
                              <mi>k</mi>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                          </msub>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mn>2</mn>
                    </msup>
                    <mn>2</mn>
                  </mfrac>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mfrac>
                    <msup>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <msub>
                            <mi>t</mi>
                            <mi>k</mi>
                          </msub>
                          <mo>-</mo>
                          <msub>
                            <mi>t</mi>
                            <mrow>
                              <mi>k</mi>
                              <mo>-</mo>
                              <mn>1</mn>
                            </mrow>
                          </msub>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                      <mn>2</mn>
                    </msup>
                    <mn>2</mn>
                  </mfrac>
                </mtd>
                <mtd>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <msub>
                        <mi>t</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>-</mo>
                      <msub>
                        <mi>t</mi>
                        <mrow>
                          <mi>k</mi>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>1</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>7</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0039" num="0041">which is called the Position-Velocity model.</p>
<p id="p-0040" num="0042">The Position-Velocity model also becomes inadequate for cases where the near-constant velocity assumption is incorrect, that is, in the presence of severe accelerations. To accommodate acceleration in the process model, it is appropriate to add another degree of freedom for each position state which becomes Position-Velocity-Acceleration model or Gauss-Markov process is perhaps more appropriate than the non-stationary random walk for acceleration.</p>
<p id="p-0041" num="0043">Determination of the spectral amplitude for position random processes is a best “guess” based on expected vehicle dynamics. In many vehicular applications, random perturbations are greater in the horizontal plane than in the vertical plane. These perturbations are accounted for by selecting a value for spectral amplitude which is lesser for the altitude channel, i.e., vertical plane, than for the two horizontal ones, i.e., horizontal plane.</p>
<p id="h-0010" num="0000">Troposphere Delay</p>
<p id="p-0042" num="0044">The troposphere delay includes a wet component and a dry component. Whereas the dry component can be modeled with a high degree of accuracy, the wet component cannot be so modeled. A solution is to scale the wet component by a scale factor, i.e., (1+ε). After troposphere delay modeling correction, the estimation part is</p>
<p id="p-0043" num="0045">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>ɛ</mi>
    <mo>·</mo>
    <mi>Δ</mi>
  </mrow>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.3em" height="0.3ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <msubsup>
      <mi>d</mi>
      <mrow>
        <mi>i</mi>
        <mo>,</mo>
        <mi>wet</mi>
      </mrow>
      <mi>trop</mi>
    </msubsup>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
Therefore, the design matrix element is
</p>
<p id="p-0044" num="0046">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mi>Δ</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.3em" height="0.3ex"/>
  </mstyle>
  <mo>⁢</mo>
  <msubsup>
    <mi>d</mi>
    <mrow>
      <mi>i</mi>
      <mo>,</mo>
      <mi>wet</mi>
    </mrow>
    <mi>trop</mi>
  </msubsup>
</mrow>
</math>
</maths>
<br/>
and ε represents the changing percentage of the wet component from the modeled value. Satellite elevation has no impact as the wet component for all satellites is scaled by the same factor for a given location. Empirically, the scale factor is modeled as a Gauss-Markov process. The transition matrix and dynamic model is then derived as in equations 1-8 and 1-9, as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>φ<sub>k,k-1</sub><i>=e</i><sup>−β</sup><sup><sub2>trop</sub2></sup><sup>(t</sup><sup><sub2>k</sub2></sup><sup>−t</sup><sup><sub2>k-1)</sub2></sup>  (1-8)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>k</sub>=σ<sub>trop</sub><sup>2</sup>(1<i>−e</i><sup>−2β</sup><sup><sub2>trop</sub2></sup><sup>(t</sup><sup><sub2>k</sub2></sup><sup>-t</sup><sup><sub2>k-1)</sub2></sup>)  (1-9)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0045" num="0047">where 1/β<sub>trop </sub>is the correlation time of the troposphere wet component and σ<sub>trop</sub><sup>2 </sup>represents the wet component changing level, both of which are functions of the baseline length and the height difference. The correlation time is set based on empirical data. The default value is set at 600 seconds. The initial variance for zenith troposphere scale factor is set as a default value of 0.1 (unitless) and dynamic noise is set as a default value of 0.1 ppm.</p>
<p id="h-0011" num="0000">Ionosphere Delay Parameters</p>
<p id="p-0046" num="0048">The design matrix element of an ionosphere delay parameter is a mapping function of the satellite elevation and the difference of the ionosphere zenith delays on two intersections between the receiver-satellite rays from both ends of a baseline and an equivalent ionosphere layer. However, a part of the ionosphere delay is also corrected based on the ionosphere delay model.</p>
<p id="p-0047" num="0049">The ionosphere zenith delay, Δd<sub>ion</sub><sup>2</sup>, is a function of the local time, ionosphere activities, distance and direction of two intersections of receiver-satellite rays with equivalent ionosphere layer from both ends of a baseline. The parameters of the empirical model to approximate an ionosphere delay have been broadcast by GPS satellites in real-time, which can be used for compensating for ionosphere delay. This model provides at least a 50% reduction in the single-frequency user's root mean square (RMS) due to ionosphere propagation effects. The model is widely used in a high-precision carrier phase-based RTK engine. The remaining part of the ionosphere delay is estimated in Kalman filtering as a state vector element and is empirically estimated using a Gauss-Markov model. The transition matrix and dynamic model are expressed using equations 1-10 and 1-11, as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>φ<sub>k,k-1</sub><i>=e</i><sup>−β</sup><sup><sub2>ion</sub2></sup><sup>(t</sup><sup><sub2>k</sub2></sup><sup>-t</sup><sup><sub2>k-1)</sub2></sup>  (1-10)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i><sub>k</sub>=σ<sub>ion</sub><sup>2</sup>(1<i>−e</i><sup>−2β</sup><sup><sub2>ion</sub2></sup><sup>(t</sup><sup><sub2>k</sub2></sup><sup>-t</sup><sup><sub2>k-1)</sub2></sup>  (1-11)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0048" num="0050">where 1/β<sub>ion </sub>is the correlation time of Δd<sub>ion</sub><sup>z </sup>after ionosphere broadcast model corrections, and σ<sub>ion</sub><sup>2 </sup>represents variation level of the Δd<sub>ion</sub><sup>z</sup>.</p>
<p id="p-0049" num="0051">The initial standard deviation for residual ionosphere parameters is set to a default value of 0.5 ppm*distance. The dynamic noise for residual ionosphere parameters is 0.01 ppm*sqrt(distance) and the weighting function for the different satellite elevation angle is 1.0/sqrt(sqrt(cos(90−elev))).</p>
<p id="h-0012" num="0000">Decorrelation Approach and Implementation</p>
<p id="h-0013" num="0000">Decorrelation</p>
<p id="p-0050" num="0052">The measurement and modeling errors consist of measurement noise, multipath, ionosphere delay, troposphere delay, orbit bias, inter-channel bias and antenna offset and additional error sources indicated from warning messages. These errors, or biases, are classified into two categories, e.g. distance-dependent biases and distance-independent biases, and represented by equations 2-1 and 2-2 as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>non-dist</sub><sup>2</sup><i>=R</i><sub>noise</sub><sup>2</sup><i>+R</i><sub>MP</sub><sup>2</sup><i>+R</i><sub>wrn</sub><sup>2</sup>  (2-1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>dist</sub><sup>2</sup><i>=R</i><sub>ion</sub><sup>2</sup><i>+R</i><sub>trop</sub><sup>2</sup><i>+R</i><sub>orb</sub><sup>2</sup>  (2-2)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0051" num="0053">The errors from inter-channel bias, antenna offset etc. are assumed to be cancelled through double difference. Only the errors remaining in double differenced measurements are taken into account.</p>
<p id="p-0052" num="0054">Due to the distance-dependent errors such as ionosphere, troposphere and orbit bias, the L<b>1</b> and L<b>2</b> carrier phase measurements become highly correlated when baseline length increases and the errors are not processed independently as performed in the short range case. Therefore, the co-variance matrix between L<b>1</b> and L<b>2</b> must be taken into account. The detailed implementation is as follows in equations 2-3, 2-4, and 2-5:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>1</sub><i>=H</i><sub>1</sub><i>X+L</i><sub>1</sub>  (2-3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>V</i><sub>2</sub><i>=H</i><sub>2</sub><i>X+L</i><sub>2</sub>  (2-4)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0053" num="0055">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>D</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>L</mi>
                <mn>1</mn>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>L</mi>
                <mn>2</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mo>[</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>D</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>D</mi>
                  <mn>12</mn>
                </msub>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <msub>
                  <mi>D</mi>
                  <mn>21</mn>
                </msub>
              </mtd>
              <mtd>
                <msub>
                  <mi>D</mi>
                  <mn>2</mn>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>5</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0054" num="0056">where L<sub>1 </sub>is pre-fit residuals for the L1 measurement vector (the difference between the computed vector and the measurement vector), H<sub>1 </sub>is a design matrix, D<sub>1 </sub>is a variance-covariance matrix of the L<b>1</b> measurement vector, and X represents the Kalman filter state vector. V<sub>1 </sub>is a post-fit residual vector. L<sub>2</sub>, H<sub>2</sub>, D<sub>2</sub>, V<sub>2 </sub>have similar meanings for the L<b>2</b> measurement vector. D<sub>12 </sub>or D<sub>21 </sub>is a co-variance matrix between the L<b>1</b> and L<b>2</b> measurement vectors.</p>
<p id="p-0055" num="0057">Due to the correlation of the L<b>1</b> and L<b>2</b> measurement vectors, L<b>1</b> block and L<b>2</b> block are not updated independently. The correlation approach orthogonalizes the L<b>2</b> measurement vector and forms a new measurement vector <o ostyle="single">L</o><sub>2 </sub>which is independent from the L<b>1</b> measurement vector. The new measurement is as follows in equation 2-6:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i> <o ostyle="single">V</o></i><sub>2</sub><i>= <o ostyle="single">H</o></i><sub>2</sub><i>X+ <o ostyle="single">L</o></i><sub>2</sub>  (2-6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i> <o ostyle="single">L</o></i><sub>2</sub><i>=L</i><sub>2</sub><i>−D</i><sub>21</sub><i>D</i><sub>1</sub><sup>−1</sup><i>L</i><sub>1</sub>  (2-7)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i> <o ostyle="single">H</o></i><sub>2</sub><i>H</i><sub>2</sub><i>−D</i><sub>21</sub><i>D</i><sub>1</sub><sup>−1</sup><i>H</i><sub>1</sub>  (2-8)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i> <o ostyle="single">D</o></i><sub>2</sub><i>=D</i><sub>2</sub><i>−D</i><sub>21</sub><i>D</i><sub>1</sub><sup>−1</sup><i>D</i><sub>12</sub>, and  (2-9)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0056" num="0058">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>D</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>L</mi>
                <mn>1</mn>
              </msub>
              <mo>,</mo>
              <msub>
                <mover>
                  <mi>L</mi>
                  <mi>_</mi>
                </mover>
                <mn>2</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mo>[</mo>
          <mtable>
            <mtr>
              <mtd>
                <msub>
                  <mi>D</mi>
                  <mn>1</mn>
                </msub>
              </mtd>
              <mtd>
                <mn>0</mn>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <msub>
                  <mover>
                    <mi>D</mi>
                    <mi>_</mi>
                  </mover>
                  <mn>2</mn>
                </msub>
              </mtd>
            </mtr>
          </mtable>
          <mo>]</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>10</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0057" num="0059">After the new measurement vector <o ostyle="single">L</o><sub>2</sub>, design matrix <o ostyle="single">H</o><sub>2 </sub>and variance matrix <o ostyle="single">D</o><sub>2 </sub>are formed, L<b>1</b> block and <o ostyle="single">L</o><sub>2 </sub>block are updated independently. However, there is some additional computation load, as described in detail below.</p>
<p id="h-0014" num="0000">Implementation</p>
<p id="p-0058" num="0060">The zenith variances R<sub>L1</sub><sup>2</sup>, R<sub>L2</sub><sup>2 </sup>for single differenced (between receivers) L<b>1</b> and L<b>2</b> measurements consist of non-distance dependent errors and distance dependent errors, e.g., ionosphere delay, troposphere delay, and orbit bias, as follows in equations 2-11 and 2-12:</p>
<p id="p-0059" num="0061">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mrow>
            <mi>L</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mn>1</mn>
          </mrow>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>λ</mi>
              <mn>1</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msubsup>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>non</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mtext>-</mtext>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>dist</mi>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <mi>L</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msubsup>
                      <mi>R</mi>
                      <mi>ion</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>·</mo>
                <msup>
                  <mi>B</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>11</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mrow>
            <mi>L</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mn>2</mn>
          </mrow>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>λ</mi>
              <mn>2</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msubsup>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>non</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mtext>-</mtext>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>dist</mi>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <mi>L</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mn>2</mn>
                  </mrow>
                </mrow>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mfrac>
                        <msubsup>
                          <mi>f</mi>
                          <mn>1</mn>
                          <mn>4</mn>
                        </msubsup>
                        <msubsup>
                          <mi>f</mi>
                          <mn>2</mn>
                          <mn>4</mn>
                        </msubsup>
                      </mfrac>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>R</mi>
                        <mi>ion</mi>
                        <mn>2</mn>
                      </msubsup>
                    </mrow>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>·</mo>
                <msup>
                  <mi>B</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>12</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0060" num="0062">where B is the baseline length. The correlated errors R<sub>L1,L2 </sub>between L1 and L<b>2</b> zenith is as follows in equation 2-13:</p>
<p id="p-0061" num="0063">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>R</mi>
          <mrow>
            <mrow>
              <mi>L</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>1</mn>
            </mrow>
            <mo>,</mo>
            <mrow>
              <mi>L</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>2</mn>
            </mrow>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mrow>
              <msub>
                <mi>λ</mi>
                <mn>1</mn>
              </msub>
              <mo>⁢</mo>
              <msub>
                <mi>λ</mi>
                <mn>2</mn>
              </msub>
            </mrow>
          </mfrac>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msubsup>
                  <mi>R</mi>
                  <mi>ion</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <msubsup>
                  <mi>R</mi>
                  <mi>trop</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <msubsup>
                  <mi>R</mi>
                  <mi>orb</mi>
                  <mn>2</mn>
                </msubsup>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>·</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mfrac>
                    <msubsup>
                      <mi>f</mi>
                      <mn>1</mn>
                      <mn>4</mn>
                    </msubsup>
                    <msubsup>
                      <mi>f</mi>
                      <mn>2</mn>
                      <mn>4</mn>
                    </msubsup>
                  </mfrac>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>R</mi>
                    <mi>ion</mi>
                    <mn>2</mn>
                  </msubsup>
                </mrow>
                <mo>+</mo>
                <msubsup>
                  <mi>R</mi>
                  <mi>trop</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <msubsup>
                  <mi>R</mi>
                  <mi>orb</mi>
                  <mn>2</mn>
                </msubsup>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>·</mo>
            <msup>
              <mi>B</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>13</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0062" num="0064">The variance at other elevation angles is mapped by a function, e.g., equation 2-14:</p>
<p id="p-0063" num="0065">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>W</mi>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mn>1.0</mn>
                  <mo>+</mo>
                  <mrow>
                    <mn>2.5</mn>
                    <mo>·</mo>
                    <msup>
                      <mi>ⅇ</mi>
                      <mrow>
                        <mrow>
                          <mo>-</mo>
                          <mi>E</mi>
                        </mrow>
                        <mo>/</mo>
                        <mn>15</mn>
                      </mrow>
                    </msup>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi/>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>for</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.8em" height="0.8ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>pseudorange</mi>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <mn>1.0</mn>
                  <mo>+</mo>
                  <mrow>
                    <mn>7.5</mn>
                    <mo>·</mo>
                    <msup>
                      <mi>ⅇ</mi>
                      <mrow>
                        <mrow>
                          <mo>-</mo>
                          <mi>E</mi>
                        </mrow>
                        <mo>/</mo>
                        <mn>15</mn>
                      </mrow>
                    </msup>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi/>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>for</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.8em" height="0.8ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>carrier</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.8em" height="0.8ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>phase</mi>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>14</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0064" num="0066">The variance and co-variance matrix for the single difference measurement vectors is represented as follows using equation 2-15:</p>
<p id="p-0065" num="0067">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>SD</mi>
          <mo>=</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>SD</mi>
                    <mn>11</mn>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>SD</mi>
                    <mn>12</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>SD</mi>
                    <mn>21</mn>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>SD</mi>
                    <mn>22</mn>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mi>where</mi>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>15</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>SD</mi>
          <mn>11</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mrow>
            <msubsup>
              <mi>R</mi>
              <mrow>
                <mi>L</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mn>1</mn>
              </mrow>
              <mn>2</mn>
            </msubsup>
            <mo>⁡</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mn>1</mn>
                    </msub>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mn>2</mn>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋰</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>n</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>16</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>SD</mi>
          <mn>22</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mrow>
            <msubsup>
              <mi>R</mi>
              <mrow>
                <mi>L</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mn>2</mn>
              </mrow>
              <mn>2</mn>
            </msubsup>
            <mo>⁡</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mn>1</mn>
                    </msub>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mn>2</mn>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋰</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mn>0</mn>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>n</mi>
                    </msub>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>17</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>SD</mi>
          <mn>12</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <msub>
            <mi>SD</mi>
            <mn>21</mn>
          </msub>
          <mo>=</mo>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>L</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mn>1</mn>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <mi>L</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mn>2</mn>
                  </mrow>
                </mrow>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>[</mo>
                <mtable>
                  <mtr>
                    <mtd>
                      <msub>
                        <mi>W</mi>
                        <mn>1</mn>
                      </msub>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mi>⋯</mi>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <msub>
                        <mi>W</mi>
                        <mn>2</mn>
                      </msub>
                    </mtd>
                    <mtd>
                      <mi>⋯</mi>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mi>⋮</mi>
                    </mtd>
                    <mtd>
                      <mi>⋮</mi>
                    </mtd>
                    <mtd>
                      <mi>⋰</mi>
                    </mtd>
                    <mtd>
                      <mi>⋮</mi>
                    </mtd>
                    <mtd>
                      <mi>⋮</mi>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mi>⋯</mi>
                    </mtd>
                    <mtd>
                      <msub>
                        <mi>W</mi>
                        <mrow>
                          <mi>n</mi>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <mi>⋯</mi>
                    </mtd>
                    <mtd>
                      <mn>0</mn>
                    </mtd>
                    <mtd>
                      <msub>
                        <mi>W</mi>
                        <mi>n</mi>
                      </msub>
                    </mtd>
                  </mtr>
                </mtable>
                <mo>]</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>18</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0066" num="0068">The variance and co-variance matrix for double difference measurements (between receivers and satellites) is represented as follows using equation 2-19:</p>
<p id="p-0067" num="0069">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>DD</mi>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <msub>
                    <mi>DD</mi>
                    <mn>11</mn>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>DD</mi>
                    <mn>12</mn>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>DD</mi>
                    <mn>21</mn>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>DD</mi>
                    <mn>22</mn>
                  </msub>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>where</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>19</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>DD</mi>
          <mn>11</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mrow>
            <msubsup>
              <mi>R</mi>
              <mi>L1</mi>
              <mn>2</mn>
            </msubsup>
            <mo>⁡</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>W</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>W</mi>
                        <mi>ref</mi>
                      </msub>
                    </mrow>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mn>2</mn>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋰</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>W</mi>
                        <mrow>
                          <mi>n</mi>
                          <mo>-</mo>
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>W</mi>
                        <mi>ref</mi>
                      </msub>
                    </mrow>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>…</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>W</mi>
                        <mrow>
                          <mi>n</mi>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>W</mi>
                        <mi>ref</mi>
                      </msub>
                    </mrow>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>20</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>DD</mi>
          <mn>22</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mrow>
            <msubsup>
              <mi>R</mi>
              <mi>L2</mi>
              <mn>2</mn>
            </msubsup>
            <mo>⁡</mo>
            <mrow>
              <mo>[</mo>
              <mtable>
                <mtr>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>W</mi>
                        <mn>1</mn>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>W</mi>
                        <mi>ref</mi>
                      </msub>
                    </mrow>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mn>2</mn>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋰</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                  <mtd>
                    <mi>⋮</mi>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>⋯</mi>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>W</mi>
                        <mrow>
                          <mi>n</mi>
                          <mo>-</mo>
                          <mn>2</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>W</mi>
                        <mi>ref</mi>
                      </msub>
                    </mrow>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                </mtr>
                <mtr>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mi>…</mi>
                  </mtd>
                  <mtd>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mtd>
                  <mtd>
                    <mrow>
                      <msub>
                        <mi>W</mi>
                        <mrow>
                          <mi>n</mi>
                          <mo>-</mo>
                          <mn>1</mn>
                        </mrow>
                      </msub>
                      <mo>+</mo>
                      <msub>
                        <mi>W</mi>
                        <mi>ref</mi>
                      </msub>
                    </mrow>
                  </mtd>
                </mtr>
              </mtable>
              <mo>]</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>21</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>DD</mi>
              <mn>12</mn>
            </msub>
            <mo>=</mo>
            <mrow>
              <msub>
                <mi>DD</mi>
                <mn>12</mn>
              </msub>
              <mo>=</mo>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <msub>
                  <mi>R</mi>
                  <mrow>
                    <mi>L1</mi>
                    <mo>,</mo>
                    <mi>L2</mi>
                  </mrow>
                </msub>
              </mrow>
            </mrow>
          </mrow>
          <mo> </mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo> </mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>⋯</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
                <mtd>
                  <mi>⋯</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋰</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>⋯</mi>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>22</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0068" num="0070">Equation 2-23 for calculating DD<sub>12</sub>DD<sub>11</sub><sup>−1 </sup>is:</p>
<p id="p-0069" num="0071">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>DD</mi>
            <mn>12</mn>
          </msub>
          <mo>⁢</mo>
          <msubsup>
            <mi>DD</mi>
            <mn>11</mn>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </msubsup>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mn>2</mn>
              <mo>⁢</mo>
              <msub>
                <mi>R</mi>
                <mrow>
                  <mi>L1</mi>
                  <mo>,</mo>
                  <mi>L2</mi>
                </mrow>
              </msub>
            </mrow>
            <mrow>
              <mn>2</mn>
              <mo>⁢</mo>
              <msubsup>
                <mi>R</mi>
                <mi>L1</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mn>1</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>1</mn>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋰</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <mn>1</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <mn>0</mn>
                </mtd>
                <mtd>
                  <mn>1</mn>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>23</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0070" num="0072">Hence, computation is simplified to a coefficient associated with a preset setting and baseline length as in equation 2-24 as follows:</p>
<p id="p-0071" num="0073">
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>Coef</mi>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mn>2</mn>
              <mo>⁢</mo>
              <msub>
                <mi>R</mi>
                <mrow>
                  <mi>L1</mi>
                  <mo>,</mo>
                  <mi>L2</mi>
                </mrow>
              </msub>
            </mrow>
            <mrow>
              <mn>2</mn>
              <mo>⁢</mo>
              <msubsup>
                <mi>R</mi>
                <mi>L1</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
          </mfrac>
          <mo>⁢</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msubsup>
                      <mi>R</mi>
                      <mi>ion</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>⁢</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mfrac>
                          <msubsup>
                            <mi>f</mi>
                            <mn>1</mn>
                            <mn>4</mn>
                          </msubsup>
                          <msubsup>
                            <mi>f</mi>
                            <mn>2</mn>
                            <mn>4</mn>
                          </msubsup>
                        </mfrac>
                        <mo>⁢</mo>
                        <msubsup>
                          <mi>R</mi>
                          <mi>ion</mi>
                          <mn>2</mn>
                        </msubsup>
                      </mrow>
                      <mo>+</mo>
                      <msubsup>
                        <mi>R</mi>
                        <mi>trop</mi>
                        <mn>2</mn>
                      </msubsup>
                      <mo>+</mo>
                      <msubsup>
                        <mi>R</mi>
                        <mi>orb</mi>
                        <mn>2</mn>
                      </msubsup>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>·</mo>
                  <msup>
                    <mi>B</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mrow>
              <mrow>
                <msubsup>
                  <mi>R</mi>
                  <mrow>
                    <mrow>
                      <mi>non</mi>
                      <mo>-</mo>
                      <mi>dist</mi>
                    </mrow>
                    <mo>,</mo>
                    <mi>L1</mi>
                  </mrow>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <msubsup>
                        <mi>R</mi>
                        <mi>ion</mi>
                        <mn>2</mn>
                      </msubsup>
                      <mo>+</mo>
                      <msubsup>
                        <mi>R</mi>
                        <mi>trop</mi>
                        <mn>2</mn>
                      </msubsup>
                      <mo>+</mo>
                      <msubsup>
                        <mi>R</mi>
                        <mi>orb</mi>
                        <mn>2</mn>
                      </msubsup>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>·</mo>
                  <msup>
                    <mi>B</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mrow>
            </mfrac>
            <mo>·</mo>
            <mfrac>
              <msub>
                <mi>λ</mi>
                <mn>1</mn>
              </msub>
              <msub>
                <mi>λ</mi>
                <mn>2</mn>
              </msub>
            </mfrac>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>24</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0072" num="0074">There are three special cases for the coefficient factor, each of which is described in detail below.</p>
<p id="h-0015" num="0000">Case 1: Ionosphere-Free Combination</p>
<p id="p-0073" num="0075">Assuming there is no non-distance dependent error, no troposphere delay and no orbit bias</p>
<p id="p-0074" num="0076">
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mrow>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mrow>
            <mrow>
              <mi>non</mi>
              <mo>⁢</mo>
              <mstyle>
                <mtext>-</mtext>
              </mstyle>
              <mo>⁢</mo>
              <mi>dist</mi>
            </mrow>
            <mo>,</mo>
            <mi>L1</mi>
          </mrow>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mi>trop</mi>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mi>orb</mi>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mn>0</mn>
      </mrow>
    </mrow>
    <mo>)</mo>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
Coef of equation 2-24 is as follows:
</p>
<p id="p-0075" num="0077">
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
  <mi>Coef</mi>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mfrac>
        <mrow>
          <msqrt>
            <mrow>
              <mrow>
                <msubsup>
                  <mi>R</mi>
                  <mi>ion</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>·</mo>
                <mfrac>
                  <msubsup>
                    <mi>f</mi>
                    <mn>1</mn>
                    <mn>4</mn>
                  </msubsup>
                  <msubsup>
                    <mi>f</mi>
                    <mn>2</mn>
                    <mn>4</mn>
                  </msubsup>
                </mfrac>
              </mrow>
              <mo>⁢</mo>
              <msubsup>
                <mi>R</mi>
                <mi>ion</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
          </msqrt>
          <mo>·</mo>
          <msup>
            <mi>B</mi>
            <mn>2</mn>
          </msup>
        </mrow>
        <mrow>
          <msubsup>
            <mi>R</mi>
            <mi>ion</mi>
            <mn>2</mn>
          </msubsup>
          <mo>·</mo>
          <msup>
            <mi>B</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>·</mo>
      <mfrac>
        <msub>
          <mi>λ</mi>
          <mn>1</mn>
        </msub>
        <msub>
          <mi>λ</mi>
          <mn>2</mn>
        </msub>
      </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <msub>
          <mi>λ</mi>
          <mn>2</mn>
        </msub>
        <msub>
          <mi>λ</mi>
          <mn>1</mn>
        </msub>
      </mfrac>
      <mo>=</mo>
      <mn>1.283</mn>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0076" num="0078">This means the orthogonalized measurement</p>
<p id="p-0077" num="0079">
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mrow>
  <mo>(</mo>
  <mrow>
    <mrow>
      <mi>L2</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>cycle</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
      <mfrac>
        <msub>
          <mi>λ</mi>
          <mn>2</mn>
        </msub>
        <msub>
          <mi>λ</mi>
          <mn>1</mn>
        </msub>
      </mfrac>
      <mo>*</mo>
      <mrow>
        <mi>L1</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>cycle</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>)</mo>
</mrow>
</math>
</maths>
<br/>
is the ionosphere free combination.
<br/>
Case 2: L1 and L2 Independent Measurements
</p>
<p id="p-0078" num="0080">Assuming the distance-dependent biases are ignored, (R<sub>ion</sub><sup>2</sup>=0, R<sub>orb</sub><sup>2</sup>=0 and R<sub>trop</sub><sup>2</sup>=0), Coef of equation 2-24 is as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Coef=0<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0079" num="0081">This means the orthogonalized measurement is the L<b>2</b> measurement.</p>
<p id="h-0016" num="0000">Case 3: Geometry-Free Combination</p>
<p id="p-0080" num="0082">Assuming the non-distance dependent error and ionosphere delay are zero</p>
<p id="p-0081" num="0083">
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
<mrow>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mrow>
            <mrow>
              <mi>non</mi>
              <mo>⁢</mo>
              <mstyle>
                <mtext>-</mtext>
              </mstyle>
              <mo>⁢</mo>
              <mi>dist</mi>
            </mrow>
            <mo>,</mo>
            <mi>L1</mi>
          </mrow>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mrow>
            <mrow>
              <mi>non</mi>
              <mo>⁢</mo>
              <mstyle>
                <mtext>-</mtext>
              </mstyle>
              <mo>⁢</mo>
              <mi>dist</mi>
            </mrow>
            <mo>,</mo>
            <mi>L2</mi>
          </mrow>
          <mn>2</mn>
        </msubsup>
        <mo>=</mo>
        <mn>0</mn>
      </mrow>
      <mo>,</mo>
      <mrow>
        <mrow>
          <mi>and</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <msubsup>
            <mi>R</mi>
            <mi>trop</mi>
            <mn>2</mn>
          </msubsup>
        </mrow>
        <mo>=</mo>
        <mn>0</mn>
      </mrow>
    </mrow>
    <mo>)</mo>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
frequency independent errors from distance-dependent errors such orbit errors and troposphere delay make up the dominator. Coef of equation 2-24 is as follows:
</p>
<p id="p-0082" num="0084">
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
<mrow>
  <mi>Coef</mi>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>λ</mi>
        <mn>1</mn>
      </msub>
      <msub>
        <mi>λ</mi>
        <mn>2</mn>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mn>0.7792</mn>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0083" num="0085">This means the orthogonalized measurement will be</p>
<p id="p-0084" num="0086">
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>L2</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>cycle</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
      <mfrac>
        <msub>
          <mi>λ</mi>
          <mn>1</mn>
        </msub>
        <msub>
          <mi>λ</mi>
          <mn>2</mn>
        </msub>
      </mfrac>
      <mo>*</mo>
      <mrow>
        <mi>L1</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>cycle</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
which is the geometry free combination.
</p>
<p id="p-0085" num="0087">The decorrelation approach has been implemented in a Z-Xtreme-type and Z-Max-type receiver and the inventors have observed that the decorrelation approach selects the best L<b>1</b> and L<b>2</b> combination according to preset settings. Based on the decorrelation approach, any combination between L<b>1</b> and L<b>2</b> is easily implemented as follows from equation 2-25:</p>
<p id="p-0086" num="0088">The new combination is formed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>{tilde over (V)}</i><sub>2</sub><i>={tilde over (H)}</i><sub>2</sub><i>X+{tilde over (L)}</i><sub>2</sub>  (2-25)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>{tilde over (L)}</i><sub>2</sub><i>=L</i><sub>2</sub><i>−αL</i><sub>1</sub>,  (2-26)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>{tilde over (H)}</i><sub>2</sub><i>=H</i><sub>2</sub><i>−αH</i><sub>1</sub>,  (2-27)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0087" num="0089">
<maths id="MATH-US-00020" num="00020">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mover>
                <mi>D</mi>
                <mo>~</mo>
              </mover>
              <mn>2</mn>
            </msub>
            <mo>=</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msubsup>
                  <mi>R</mi>
                  <mi>L2</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <mrow>
                  <msup>
                    <mi>α</mi>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>R</mi>
                    <mi>L1</mi>
                    <mn>2</mn>
                  </msubsup>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <mn>2</mn>
                  <mo>⁢</mo>
                  <mi>α</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>R</mi>
                    <mrow>
                      <mi>L1</mi>
                      <mo>,</mo>
                      <mi>L2</mi>
                    </mrow>
                  </msub>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo> </mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo> </mo>
          <mrow>
            <mo>[</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>⋯</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mn>2</mn>
                  </msub>
                </mtd>
                <mtd>
                  <mi>⋯</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋰</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>⋯</mi>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>28</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0088" num="0090">However, the correlation between L<b>1</b> and {tilde over (L)}<sub>2 </sub>has not been taken into account although all combination options are implemented based on the subroutine for correlation approach.</p>
<p id="p-0089" num="0091">
<maths id="MATH-US-00021" num="00021">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>α</mi>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mi/>
                  <mo>⁢</mo>
                  <mn>1</mn>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi/>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>widelane</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.8em" height="0.8ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>combination</mi>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>λ</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>/</mo>
                  <msub>
                    <mi>λ</mi>
                    <mn>2</mn>
                  </msub>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi>geometry</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mtext>-</mtext>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>free</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.8em" height="0.8ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>combination</mi>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <msub>
                    <mi>λ</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>/</mo>
                  <msub>
                    <mi>λ</mi>
                    <mn>1</mn>
                  </msub>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi>ionosphere</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mtext>-</mtext>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>free</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.8em" height="0.8ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>combination</mi>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mn>0</mn>
              </mtd>
              <mtd>
                <mrow>
                  <mi>L</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mn>2</mn>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.8em" height="0.8ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>independent</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.8em" height="0.8ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>measurement</mi>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <mi/>
                  <mo>⁢</mo>
                  <mrow>
                    <msub>
                      <mi>R</mi>
                      <mrow>
                        <mrow>
                          <mi>L</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <mn>1</mn>
                        </mrow>
                        <mo>,</mo>
                        <mrow>
                          <mi>L</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <mn>2</mn>
                        </mrow>
                      </mrow>
                    </msub>
                    <mo>/</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mrow>
                        <mi>L</mi>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>⁢</mo>
                        <mn>1</mn>
                      </mrow>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mi/>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>the</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.8em" height="0.8ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>correlation</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.8em" height="0.8ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mi>approach</mi>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>-</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>29</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0090" num="0092">The coefficients for the decorrelation approach have been plotted in <figref idref="DRAWINGS">FIG. 1</figref>. The Kalman filtering update for the decorrelation approach is illustrated in <figref idref="DRAWINGS">FIG. 2</figref>, wherein the switch to determine α is determined based on equation (2-29).</p>
<p id="h-0017" num="0000">Stochastic Model</p>
<p id="p-0091" num="0093">The measurement and modeling errors consist of measurement noise, multipath, ionosphere delay, troposphere delay and orbit bias as described by equations 2-11 and 2-12 above.</p>
<p id="p-0092" num="0094">The remaining errors based on the ionosphere delay, troposphere and orbit bias are represented by distance-dependent functions for their standard deviations, eg. 0.5 ppm, 10−4* HeightDiff+2 ppm, and 0.1 ppm, respectively. If the ionosphere parameters are estimated in the Kalman filtering state vector, the standard deviation for ionosphere delay is scaled by a factor, e.g., 1−dt/dTIono, where dt is the time shift from filtering start, dTIono is the time to turn off ionosphere. If the troposphere scale parameter is estimated, or a default standard troposphere model is applied, troposphere errors are turned off.</p>
<p id="p-0093" num="0095">By default, ionosphere (one for each Sat) and troposphere (one scale parameter) are modeled in Kalman filtering. In correspondence with the above paragraph, the troposphere term is not applied to the stochastic model. The ionosphere term is applied to the stochastic model even when the ionosphere is modeled. There is not any theoretical foundation behind the formula 1−dt/dTiono; this solution is heuristic and the inventors have found that the formula provides good results. Here, dt is the elapsed time from starting estimation given ionosphere, dTiono is set between from 200 seconds to 1,000 seconds. The default value is set as 600 seconds.</p>
<p id="p-0094" num="0096">The standard deviation for constant errors from multipath and noise depends on a multipath template index. The index is defined as a value from 1 to 3 representing the multipath status (1=minor multipath, 2=medium, and 3=strong multipath).</p>
<p id="p-0095" num="0097">The default standard deviation for medium multipath have a default value of 2.25 meters for pseudo-range and 0.05 cycles for carrier phase. The mapping function is determined by the empirical exponential function of equation 2-14.</p>
<p id="p-0096" num="0098">The standard deviation for non-distance dependent errors is depicted in <figref idref="DRAWINGS">FIG. 3</figref> when the zenith default standard deviations are set at 0.05 cycle for phase and 2.25 meters for code.</p>
<p id="h-0018" num="0000">Ambiguity Resolution Validation</p>
<p id="p-0097" num="0099">The ratio smoothing algorithm and ambiguity stability function are only used for the long range widelane/ionosphere-free combination. Both functions increase positioning reliability and increase time-to-first-fix.</p>
<p id="h-0019" num="0000">Instant Ambiguity Fixing</p>
<p id="p-0098" num="0100">The methods claimed in the pending patent applications entitled, “Accurate and Fast RTK” and “Enhanced Real Time Kinematics Determination Method and Apparatus” and having application Ser. Nos. 10/610,544 and 10/610,541, respectively, have been used for instant ambiguity fixing for baselines shorter than 10 km.</p>
<p id="h-0020" num="0000">Ratio Smoothing Algorithm for Long Range Applications</p>
<p id="p-0099" num="0101">{tilde over (R)}atio=Ratio+{tilde over (R)}atio*(N−1)/N where N is the width of the moving window (1 second per km, if the baseline length is longer than 10 km). Both {tilde over (R)}atio and Ratio, described in more detail in co-pending U.S. patent application Ser. Nos. 10/610,544 and 10/610,541, are required to pass validation tests for ambiguity fixing.</p>
<p id="p-0100" num="0102">A ratio smoothing algorithm increases reliability for long range; however, the same algorithm decreases instant-fix significantly.</p>
<p id="h-0021" num="0000">Ambiguity Repeatability Function for Long Range</p>
<p id="p-0101" num="0103">The ambiguity repeatability check is for determining whether all double-difference ambiguities remain the same for N continuous epochs, e.g., 30, and whether all passed the ratio test mentioned above. If the ambiguity repeatability check is passed, the ambiguity is fixed. This function has a problem when cycle slips occur. The ambiguity stability counter is defined as a counter to count how many continuous epochs with the same ambiguity set or another ambiguity set with a difference larger than 50 cycles. This means that the ambiguity stability counter is not reset if the ambiguity difference is larger than 50 cycles. In this manner, the influence of cycle slips is minimized. This is reasonable because double differenced (DD) ambiguity is impossibly fixed to a wrong integer with such large difference values. However, the DD ambiguity stability counter is reset to a value of 1 if the ambiguity difference is not zero and less than 50 cycles for any given satellite pair.</p>
<p id="p-0102" num="0104">The Ambiguity Repeatability Check increases reliability for long range applications; however, the same function makes instant-fix impossible.</p>
<p id="h-0022" num="0000">Partial Fixing Scheme</p>
<p id="p-0103" num="0105">The partial fixing scheme has been implemented based on the functional model improvement by removing measurements and ambiguity searching adaptation by removing ambiguity, as described in co-pending U.S. patent application Ser. Nos. 10/610,544 and 10/610,541.</p>
<p id="h-0023" num="0000">Process Flow</p>
<p id="p-0104" num="0106"><figref idref="DRAWINGS">FIG. 4</figref> depicts the process flow of an RTK method according to an embodiment of the present invention. Low rate, nominally 1 Hz, base station measurements output from a base data decoder <b>400</b> are output to a polynomial fitting function executed in a phase predictor process <b>402</b>, e.g. second order or higher order polynomial, and a Kalman filter process <b>408</b>. Base data decoder <b>400</b> decodes raw GPS measurements received from a base GPS receiver (not shown). The sampling rate (or update rate) of base data decoder <b>400</b> is nominally 1 Hz. Higher sampling rates may be used with a proportional increase in cost and baud rate for the data link. In one embodiment of the present invention, the update rate does not exceed 1 Hz. If a higher sampling rate is required, an embodiment according to the description embodied in co-pending patent application titled, “Enhanced Rapid Real-Time Kinematic Determination Method and Apparatus,” by the present inventors and assigned to the present assignee would be used.</p>
<p id="p-0105" num="0107">In order to reduce the position update time delay, phase predictor process <b>402</b> predicts corrections for the position calculation using available corrections transmitted from the base GPS receiver as decoded and output from base data decoder <b>400</b> in conjunction with polynomial filtering. The positioning accuracy degrades depending on the length of the predicted period.</p>
<p id="p-0106" num="0108">Kalman filter process <b>408</b>, described in detail below with reference to <figref idref="DRAWINGS">FIG. 5</figref>, calculates optimal solutions, i.e. position and/or velocity, based on currently available measurements from base data decoder <b>400</b> and rover data decoder <b>404</b>. An ambiguity resolution process <b>410</b> is a part of Kalman filter process <b>408</b> and is described in detail below with reference to <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0107" num="0109">A rover data decoder <b>404</b> decodes raw GPS measurements and ephemeris received from the rover GPS receiver (not shown) and provides time tagged carrier phase measurements to a carrier phase process <b>406</b>. The sampling rate (or update rate) of rover data decoder <b>404</b> can be up to 10 Hz or higher.</p>
<p id="p-0108" num="0110">Output estimated polynomial parameters from phase predictor <b>402</b> are used by carrier phase process <b>406</b> to predict the base station measurement at a rate matching the RTK update rate, typically 10 Hz or higher. The RTK solution latency is primarily determined by the rover measurement data collection time and the RTK position computation time. The base station prediction time is a negligible delay. Typically, RTK solution latency is less than 20 milliseconds depending on microprocessor speed.</p>
<p id="p-0109" num="0111">For embodiments requiring an update rate in time-tagged mode of 1 Hz or lower, carrier phase process <b>406</b> uses the output from Kalman filter <b>408</b> to calculate and output the rover GPS receiver position and/or velocity. For embodiments requiring an update rate in RTK mode of 1 Hz or lower, carrier phase process <b>406</b> uses the most recent measurements from rover data decoder <b>404</b> and the predicted correction output from phase predictor <b>402</b> to calculate and output the most recent position and/or velocity of the rover GPS receiver.</p>
<p id="p-0110" num="0112">To reduce the RTK position computation time, only an L<b>1</b> carrier phase measurement output from a rover data decoder <b>404</b> is used. The rover L<b>1</b> carrier phase measurement and the predicted base station L<b>1</b> carrier phase measurement output from phase predictor <b>402</b> are then used to derive L<b>1</b> double difference measurements in <b>406</b>. The estimated L<b>1</b> integer ambiguities, residual ionosphere delay, residual troposphere delay and other bias parameters are used to correct the double difference measurement in <b>406</b>. The corrected double difference measurement is output into a least squares (LSQ) estimator to calculate a rover position in <b>406</b>. The velocity is calculated in a similar manner using rover L<b>1</b> Doppler measurements and predicted base L<b>1</b> carrier phase rate. Because of the requirement of base station measurement prediction, the RTK solution accuracy is degraded in comparison to a matched time-tag RTK solution. With Selective Availability (S/A), the rate of degradation increases due to the inability to predict S/A. Selective availability is known to persons of skill in the art and refers to the intentional degradation of the absolute positioning performance capabilities of the GPS for civilian use accomplished by artificial “dithering” of satellite clock error.</p>
<p id="p-0111" num="0113">With reference to <figref idref="DRAWINGS">FIG. 5</figref>, details of Kalman filter process <b>408</b> and ambiguity resolution process <b>410</b> in <figref idref="DRAWINGS">FIG. 4</figref> are now described. Data from both a base GPS receiver (not shown) and a rover GPS receiver (not shown) is received, decoded, and output by base data decoder <b>400</b> and rover data decoder <b>404</b>, respectively. Base data <b>500</b> and rover data <b>502</b> time tags are matched in match time tag step <b>504</b>, thereby matching the time when the respective measurements were made.</p>
<p id="p-0112" num="0114">After the time tags are matched, the matched data output from match time tag step <b>504</b> is input to a Kalman filter. In step <b>506</b>, if the matched data output is in the first epoch or if a reset of the Kalman filter is required, the Kalman filter is initialized in step <b>506</b>. In step <b>508</b>, a reference satellite is selected to determine the double differenced measurement. Further, cycle slips are checked using cycle slip flags and a stochastic model is calculated.</p>
<p id="p-0113" num="0115">The flow proceeds to step <b>510</b> for the preparation of the design matrix, variance-covariance matrix (stochastic model) and calculation of pre-fit residuals for all measurements, e.g. C/A pseudo-range, P<b>1</b> pseudo-range, P<b>2</b> pseudo-range, L<b>1</b> Doppler, L<b>2</b> Doppler, L<b>1</b> carrier phase and L<b>2</b> ca output of the pre-fit residual calculation is input to a Receiver Autonomous Integrity Monitoring (RAIM) algorithm to detect outliers. RAIM is a form of receiver self-checking using redundant pseudo-range observations to detect if a problem with any of the measurements exists.</p>
<p id="p-0114" num="0116">The output of step <b>510</b> is provided as input to a Kalman filter measurement update step <b>512</b> to sequentially filter all measurements and provide filtered output measurements to an ambiguity resolution step <b>514</b>. <figref idref="DRAWINGS">FIG. 2</figref> illustrates the detailed procedure implementing the decorrelation approach in Step <b>512</b>. The update step provides the optimal estimation results using all available measurements.</p>
<p id="p-0115" num="0117">The validation criteria are calculated using the above-described method in step <b>514</b> and a determination of whether the integer ambiguities can be fixed or not is performed in step <b>516</b>. If the step <b>516</b> determination is positive (the integer ambiguities can be fixed), the float solution is updated to the fix solution in step <b>518</b>. If the step <b>516</b> determination is negative (the integer ambiguities cannot be fixed), the above-described adaptive fix procedure is performed in step <b>520</b> to attempt to fix ambiguities and a second determination of whether the integer ambiguities can be fixed or not is performed in step <b>522</b>. If the step <b>522</b> determination is positive (the integer ambiguities can be fixed), the float solution is updated to the fix solution in step <b>518</b> and the flow proceeds to step <b>524</b> wherein the post-fit residuals are updated and possible outliers are detected. If the step <b>522</b> determination is negative (the integer ambiguities cannot be fixed), the flow proceeds to step <b>524</b> described above.</p>
<p id="p-0116" num="0118">The output of step <b>524</b> is provided to a Kalman filtering time update <b>526</b>, which is a Kalman filtering prediction step. In step <b>528</b>, all necessary information is outputted and in step <b>530</b> the measurements are stored and the processing information is updated based on the above-described method. The flow proceeds to process the next epoch of data returning to step <b>504</b>.</p>
<p id="p-0117" num="0119">In coordination with the above-described technique, an embodiment of the present invention provides an improved method of and apparatus for an improved decorrelation and parameter tuning capability for determining real time kinematics.</p>
<p id="p-0118" num="0120"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram illustrating an exemplary computer <b>600</b> upon which an embodiment of the invention may be implemented. The present invention is usable with currently available handheld and embedded devices, e.g. GPS receivers, and is also applicable to personal computers, mini-mainframes, servers and the like.</p>
<p id="p-0119" num="0121">Computer <b>600</b> includes a bus <b>602</b> or other communication mechanism for communicating information, and a processor <b>604</b> coupled with the bus <b>602</b> for processing information. Computer <b>600</b> also includes a main memory <b>606</b>, such as a random access memory (RAM) or other dynamic storage device, coupled to the bus <b>602</b> for storing GPS data signals according to an embodiment of the present invention and instructions to be executed by processor <b>604</b>. Main memory <b>606</b> also may be used for storing temporary variables or other intermediate information during execution of instructions to be executed by processor <b>604</b>. Computer <b>600</b> further includes a read only memory (ROM) <b>608</b> or other static storage device coupled to the bus <b>602</b> for storing static information and instructions for the processor <b>604</b>. A storage device <b>610</b> (dotted line), such as a compact flash, smart media, or other storage device, is optionally provided and coupled to the bus <b>602</b> for storing instructions.</p>
<p id="p-0120" num="0122">Computer system <b>600</b> may be coupled via the bus <b>602</b> to a display <b>612</b>, such as a cathode ray tube (CRT) or a flat panel display, for displaying an interface to the user. An input device <b>614</b>, including alphanumeric and function keys, is coupled to the bus <b>602</b> for communicating information and command selections to the processor <b>604</b>. Another type of user input device is cursor control <b>616</b>, such as a mouse, a trackball, or cursor direction keys for communicating direction information and command selections to processor <b>604</b> and for controlling cursor movement on the display <b>612</b>. This input device typically has two degrees of freedom in two axes, a first axes (e.g., x) and a second axis (e.g., y) allowing the device to specify positions in a plane.</p>
<p id="p-0121" num="0123">The invention is related to the use of computer <b>600</b>, such as the depicted computer of <figref idref="DRAWINGS">FIG. 6</figref>, to perform accurate, real-time, kinematics determination. According to one embodiment of the invention, data signals are received via a navigation interface <b>619</b>, e.g. a GPS receiver, and processed by computer <b>600</b> and processor <b>604</b> executes sequences of instructions contained in main memory <b>606</b> in response to input received via input device <b>614</b>, cursor control <b>616</b>, or communication interface <b>618</b>. Such instructions may be read into main memory <b>606</b> from another computer-readable medium, such as storage device <b>610</b>. A user interacts with the system via an application providing a user interface displayed on display <b>612</b>.</p>
<p id="p-0122" num="0124">However, the computer-readable medium is not limited to devices such as storage device <b>610</b>. For example, the computer-readable medium may include a floppy disk, a flexible disk, hard disk, magnetic tape, or any other magnetic medium, a compact disc-read only memory (CD-ROM), any other optical medium, punch cards, paper tape, any other physical medium with patterns of holes, a random access memory (RAM), a programmable read only memory (PROM), an erasable PROM (EPROM), a Flash-EPROM, any other memory chip or cartridge, a carrier wave embodied in an electrical, electromagnetic, infrared, or optical signal, or any other medium from which a computer can read. Execution of the sequences of instructions contained in the main memory <b>606</b> causes the processor <b>604</b> to perform the process steps described above. In alternative embodiments, hard-wired circuitry may be used in place of or in combination with computer software instructions to implement the invention. Thus, embodiments of the invention are not limited to any specific combination of hardware circuitry and software.</p>
<p id="p-0123" num="0125">Computer <b>600</b> also includes a communication interface <b>618</b> coupled to the bus <b>602</b> and providing two-way data communication as is known in the art. For example, communication interface <b>618</b> may be an integrated services digital network (ISDN) card, a digital subscriber line (DSL) card, or a modem to provide a data communication connection to a corresponding type of telephone line. As another example, communication interface <b>618</b> may be a local area network (LAN) card to provide a data communication connection to a compatible LAN. Wireless links may also be implemented. In any such implementation, communication interface <b>618</b> sends and receives electrical, electromagnetic or optical signals which carry digital data streams representing various types of information. Of particular note, the communications through interface <b>618</b> may permit transmission or receipt of instructions and data to be processed according to the above method. For example, two or more computers <b>600</b> may be networked together in a conventional manner with each using the communication interface <b>618</b>.</p>
<p id="p-0124" num="0126">Network link <b>620</b> typically provides data communication through one or more networks to other data devices. For example, network link <b>620</b> may provide a connection through local network <b>622</b> to a host computer <b>624</b> or to data equipment operated by an Internet Service Provider (ISP) <b>626</b>. ISP <b>626</b> in turn provides data communication services through the world wide packet data communication network now commonly referred to as the “Internet” <b>628</b>. Local network <b>622</b> and Internet <b>628</b> both use electrical, electromagnetic or optical signals which carry digital data streams. The signals through the various networks and the signals on network link <b>620</b> and through communication interface <b>618</b>, which carry the digital data to and from computer <b>600</b>, are exemplary forms of carrier waves transporting the information.</p>
<p id="p-0125" num="0127">Computer <b>600</b> can send messages and receive data, including program code, through the network(s), network link <b>620</b> and communication interface <b>618</b>. In the Internet example, a server <b>630</b> might transmit a requested code for an application program through Internet <b>628</b>, ISP <b>626</b>, local network <b>622</b> and communication interface <b>618</b>.</p>
<p id="p-0126" num="0128">The received code may be executed by processor <b>604</b> as it is received, and/or stored in storage device <b>610</b>, or other non-volatile storage for later execution. In this manner, computer <b>600</b> may obtain application code in the form of a carrier wave.</p>
<p id="p-0127" num="0129">It will be readily seen by one of ordinary skill in the art that the present invention fulfills all of the objects set forth above. After reading the foregoing specification, one of ordinary skill will be able to affect various changes, substitutions of equivalents and various other aspects of the invention as broadly disclosed herein. It is therefore intended that the protection granted hereon be limited only by the definition contained in the appended claims and equivalents thereof.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298319-20071120-M00001.NB">
<img id="EMI-M00001" he="14.14mm" wi="76.20mm" file="US07298319-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298319-20071120-M00002.NB">
<img id="EMI-M00002" he="22.61mm" wi="76.20mm" file="US07298319-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298319-20071120-M00003.NB">
<img id="EMI-M00003" he="4.23mm" wi="76.20mm" file="US07298319-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298319-20071120-M00004.NB">
<img id="EMI-M00004" he="4.23mm" wi="76.20mm" file="US07298319-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298319-20071120-M00005.NB">
<img id="EMI-M00005" he="7.45mm" wi="76.20mm" file="US07298319-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298319-20071120-M00006.NB">
<img id="EMI-M00006" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298319-20071120-M00007.NB">
<img id="EMI-M00007" he="16.26mm" wi="76.20mm" file="US07298319-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298319-20071120-M00008.NB">
<img id="EMI-M00008" he="7.79mm" wi="76.20mm" file="US07298319-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298319-20071120-M00009.NB">
<img id="EMI-M00009" he="8.81mm" wi="76.20mm" file="US07298319-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07298319-20071120-M00010.NB">
<img id="EMI-M00010" he="74.08mm" wi="76.20mm" file="US07298319-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07298319-20071120-M00011.NB">
<img id="EMI-M00011" he="80.09mm" wi="76.20mm" file="US07298319-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07298319-20071120-M00012.NB">
<img id="EMI-M00012" he="19.39mm" wi="76.20mm" file="US07298319-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013" nb-file="US07298319-20071120-M00013.NB">
<img id="EMI-M00013" he="16.59mm" wi="76.20mm" file="US07298319-20071120-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US07298319-20071120-M00014.NB">
<img id="EMI-M00014" he="5.67mm" wi="76.20mm" file="US07298319-20071120-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US07298319-20071120-M00015.NB">
<img id="EMI-M00015" he="11.68mm" wi="76.20mm" file="US07298319-20071120-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016" nb-file="US07298319-20071120-M00016.NB">
<img id="EMI-M00016" he="6.35mm" wi="76.20mm" file="US07298319-20071120-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00017" nb-file="US07298319-20071120-M00017.NB">
<img id="EMI-M00017" he="5.67mm" wi="76.20mm" file="US07298319-20071120-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00018" nb-file="US07298319-20071120-M00018.NB">
<img id="EMI-M00018" he="6.35mm" wi="76.20mm" file="US07298319-20071120-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00019" nb-file="US07298319-20071120-M00019.NB">
<img id="EMI-M00019" he="6.35mm" wi="76.20mm" file="US07298319-20071120-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00020" nb-file="US07298319-20071120-M00020.NB">
<img id="EMI-M00020" he="26.84mm" wi="76.20mm" file="US07298319-20071120-M00020.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00021" nb-file="US07298319-20071120-M00021.NB">
<img id="EMI-M00021" he="21.17mm" wi="76.20mm" file="US07298319-20071120-M00021.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00022" nb-file="US07298319-20071120-M00022.NB">
<img id="EMI-M00022" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00022.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00023" nb-file="US07298319-20071120-M00023.NB">
<img id="EMI-M00023" he="20.83mm" wi="76.20mm" file="US07298319-20071120-M00023.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00024" nb-file="US07298319-20071120-M00024.NB">
<img id="EMI-M00024" he="20.83mm" wi="96.69mm" file="US07298319-20071120-M00024.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00025" nb-file="US07298319-20071120-M00025.NB">
<img id="EMI-M00025" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00025.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00026" nb-file="US07298319-20071120-M00026.NB">
<img id="EMI-M00026" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00026.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00027" nb-file="US07298319-20071120-M00027.NB">
<img id="EMI-M00027" he="7.79mm" wi="76.20mm" file="US07298319-20071120-M00027.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00028" nb-file="US07298319-20071120-M00028.NB">
<img id="EMI-M00028" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00028.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00029" nb-file="US07298319-20071120-M00029.NB">
<img id="EMI-M00029" he="20.83mm" wi="76.20mm" file="US07298319-20071120-M00029.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00030" nb-file="US07298319-20071120-M00030.NB">
<img id="EMI-M00030" he="20.83mm" wi="96.69mm" file="US07298319-20071120-M00030.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00031" nb-file="US07298319-20071120-M00031.NB">
<img id="EMI-M00031" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00031.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00032" nb-file="US07298319-20071120-M00032.NB">
<img id="EMI-M00032" he="8.13mm" wi="76.20mm" file="US07298319-20071120-M00032.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00033" nb-file="US07298319-20071120-M00033.NB">
<img id="EMI-M00033" he="7.79mm" wi="76.20mm" file="US07298319-20071120-M00033.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of determining a position estimate based on an updated Kalman filter, comprising:
<claim-text>receiving a first measurement L<sub>1 </sub>based on a first signal with wavelength λ<sub>1 </sub>and frequency f<sub>1</sub>;</claim-text>
<claim-text>receiving a second measurement L<sub>2 </sub>based on a second signal with wavelength λ<sub>2 </sub>and frequency f<sub>2</sub>;</claim-text>
<claim-text>selecting a model α of distance dependent and distance independent errors in the first and second measurements, wherein the model α is selected from α=λ<sub>1</sub>/λ<sub>2</sub>, α=λ<sub>2</sub>/λ<sub>1</sub>, and α=1;</claim-text>
<claim-text>based on the model α, calculating a double differenced variance matrix:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00022" num="00022">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>D</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>L</mi>
            <mn>1</mn>
          </msub>
          <mo>,</mo>
          <msub>
            <mi>L</mi>
            <mn>2</mn>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mo></mo>
      <mtable>
        <mtr>
          <mtd>
            <msub>
              <mi>D</mi>
              <mn>11</mn>
            </msub>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <msub>
              <mover>
                <mi>D</mi>
                <mi>_</mi>
              </mover>
              <mn>22</mn>
            </msub>
          </mtd>
        </mtr>
      </mtable>
      <mo></mo>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00023" num="00023">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>D</mi>
      <mn>11</mn>
    </msub>
    <mo>=</mo>
    <mrow>
      <mn>2</mn>
      <mo>⁢</mo>
      <msubsup>
        <mi>R</mi>
        <mi>L2</mi>
        <mn>2</mn>
      </msubsup>
      <mo>⁢</mo>
      <mrow>
        <mo></mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mn>2</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋰</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
        <mo></mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00024" num="00024">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mover>
          <mi>D</mi>
          <mi>_</mi>
        </mover>
        <mn>22</mn>
      </msub>
      <mo>=</mo>
    </mrow>
    <mo> </mo>
  </mrow>
  <mo>⁢</mo>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mrow>
        <msubsup>
          <mi>R</mi>
          <mi>L2</mi>
          <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <mrow>
          <msup>
            <mi>α</mi>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <msubsup>
            <mi>R</mi>
            <mi>L1</mi>
            <mn>2</mn>
          </msubsup>
        </mrow>
        <mo>-</mo>
        <mrow>
          <mrow>
            <mo> </mo>
            <mrow>
              <mn>2</mn>
              <mo>⁢</mo>
              <mi>α</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>R</mi>
                <mrow>
                  <mi>L1</mi>
                  <mo>,</mo>
                  <mi>L2</mi>
                </mrow>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.em" height="0.ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo></mo>
            <mstyle>
              <mspace width="0.em" height="0.ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mtable>
              <mtr>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mn>1</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mn>2</mn>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋰</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
                <mtd>
                  <mi>⋮</mi>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>2</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
              </mtr>
              <mtr>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mi>…</mi>
                </mtd>
                <mtd>
                  <msub>
                    <mi>W</mi>
                    <mi>ref</mi>
                  </msub>
                </mtd>
                <mtd>
                  <mrow>
                    <msub>
                      <mi>W</mi>
                      <mrow>
                        <mi>n</mi>
                        <mo>-</mo>
                        <mn>1</mn>
                      </mrow>
                    </msub>
                    <mo>+</mo>
                    <msub>
                      <mi>W</mi>
                      <mi>ref</mi>
                    </msub>
                  </mrow>
                </mtd>
              </mtr>
            </mtable>
            <mo></mo>
          </mrow>
        </mrow>
      </mrow>
      <mo>;</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00025" num="00025">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>R</mi>
      <mi>L1</mi>
    </msub>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>λ</mi>
              <mn>1</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msubsup>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>non</mi>
                    <mo>-</mo>
                    <mi>dist</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>L1</mi>
                </mrow>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msubsup>
                      <mi>R</mi>
                      <mi>ion</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>·</mo>
                <msup>
                  <mi>B</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mn>1</mn>
        <mn>2</mn>
      </mfrac>
    </msup>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00026" num="00026">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>R</mi>
      <mi>L2</mi>
    </msub>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>λ</mi>
              <mn>2</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msubsup>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>non</mi>
                    <mo>-</mo>
                    <mi>dist</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>L2</mi>
                </mrow>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msubsup>
                      <mi>R</mi>
                      <mi>ion</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>·</mo>
                <msup>
                  <mi>B</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mn>1</mn>
        <mn>2</mn>
      </mfrac>
    </msup>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00027" num="00027">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>R</mi>
      <mrow>
        <mi>L1</mi>
        <mo>,</mo>
        <mi>L2</mi>
      </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <msub>
            <mi>λ</mi>
            <mn>1</mn>
          </msub>
          <mo>⁢</mo>
          <msub>
            <mi>λ</mi>
            <mn>2</mn>
          </msub>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mrow>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msubsup>
              <mi>R</mi>
              <mi>ion</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>trop</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>orb</mi>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>·</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <mfrac>
                <msubsup>
                  <mi>f</mi>
                  <mn>1</mn>
                  <mn>4</mn>
                </msubsup>
                <msubsup>
                  <mi>f</mi>
                  <mn>2</mn>
                  <mn>4</mn>
                </msubsup>
              </mfrac>
              <mo>⁢</mo>
              <msubsup>
                <mi>R</mi>
                <mi>ion</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>trop</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>orb</mi>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>·</mo>
        <msup>
          <mi>B</mi>
          <mn>2</mn>
        </msup>
      </mrow>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein R<sub>non-dist,L1 </sub>is a non-distance dependant measurement error for the L<sub>1 </sub>measurement;</claim-text>
<claim-text>wherein R<sub>non-dist,L2 </sub>is a non-distance dependant measurement error for the L<sub>2 </sub>measurement;</claim-text>
<claim-text>wherein R<sub>ion </sub>is measurement error due to ionospheric delay;</claim-text>
<claim-text>wherein R<sub>trop </sub>is measurement error due to tropospheric delay;</claim-text>
<claim-text>wherein R<sub>orb </sub>is measurement error due to orbit bias;</claim-text>
<claim-text>wherein each W is: W<sub>n</sub>=1.0+7.5e<sup>−E/15</sup>;</claim-text>
<claim-text>wherein n is a satellite ordinal of a plurality of satellites;</claim-text>
<claim-text>wherein W<sub>ref </sub>corresponds to a reference satellite of the plurality of satellites;</claim-text>
<claim-text>wherein E is the elevation angle of each satellite of the plurality of satellites;</claim-text>
</claim-text>
<claim-text>updating a Kalman filter with the calculated variance matrix; and</claim-text>
<claim-text>determining a present position estimate based on the updated Kalman filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the updated Kalman filter with the calculated variance matrix is K=D(L<sub>1</sub>,L<sub>2</sub>)<sub>new</sub>H<sub>2</sub><sup>T</sup>{H<sub>2</sub><sup>T</sup>D(L<sub>1</sub>,L<sub>2</sub>)<sub>new</sub>H<sub>2</sub><sup>T</sup>+V<sub>2</sub>}<sup>−1</sup>;
<claim-text>wherein H<sub>2</sub><sup>T </sup>is a transpose of a design matrix H<sub>2 </sub>for the measurement L<sub>2</sub>;</claim-text>
<claim-text>wherein V<sub>2 </sub>is a residual measurement of measurement L<sub>2</sub>;</claim-text>
<claim-text>wherein D(L<sub>1</sub>,L<sub>2</sub>)<sub>new</sub>=D(L<sub>1</sub>,L<sub>2</sub>)<sub>old</sub>−K<sub>old</sub>H <sub>2</sub>D(L<sub>1</sub>,L<sub>2</sub>)<sub>old</sub>;</claim-text>
<claim-text>wherein D(L<sub>1</sub>,L<sub>2</sub>)<sub>new </sub>is the calculated variance matrix including the received measurements L<sub>1 </sub>and L<sub>2</sub>;</claim-text>
<claim-text>wherein D(L<sub>1</sub>,L<sub>2</sub>)<sub>old </sub>is a previous calculated variance matrix which was calculated before receiving both of the received measurements L<sub>1 </sub>and L<sub>2</sub>; and</claim-text>
<claim-text>wherein K<sub>old </sub>is a previous Kalman filter which was calculated before receiving both of the received measurements L<sub>1 </sub>and L<sub>2</sub>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A computer readable medium having computer-executable instructions, comprising:
<claim-text>receiving a first measurement L<b>1</b> based on a first signal with wavelength λ<b>1</b> and frequency f<b>1</b>;</claim-text>
<claim-text>receiving a second measurement L<b>2</b> based on a second signal with wavelength λ<b>2</b> and frequency f<b>2</b>;</claim-text>
<claim-text>selecting a model α of distance dependent and distance independent errors in the first and second measurements, wherein the model α is selected from α=λ1/λ2, α=λ2/λ1, and α=1;</claim-text>
<claim-text>based on the model α, calculating a double differenced variance matrix:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00028" num="00028">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>D</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>L</mi>
            <mn>1</mn>
          </msub>
          <mo>,</mo>
          <msub>
            <mi>L</mi>
            <mn>2</mn>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mo></mo>
      <mtable>
        <mtr>
          <mtd>
            <msub>
              <mi>D</mi>
              <mn>11</mn>
            </msub>
          </mtd>
          <mtd>
            <mn>0</mn>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mn>0</mn>
          </mtd>
          <mtd>
            <msub>
              <mover>
                <mi>D</mi>
                <mi>_</mi>
              </mover>
              <mn>22</mn>
            </msub>
          </mtd>
        </mtr>
      </mtable>
      <mo></mo>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00029" num="00029">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>D</mi>
      <mn>11</mn>
    </msub>
    <mo>=</mo>
    <mrow>
      <mn>2</mn>
      <mo>⁢</mo>
      <msubsup>
        <mi>R</mi>
        <mi>L2</mi>
        <mn>2</mn>
      </msubsup>
      <mo>⁢</mo>
      <mrow>
        <mo></mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mn>2</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋰</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>…</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
        <mo></mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00030" num="00030">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mover>
        <mi>D</mi>
        <mi>_</mi>
      </mover>
      <mn>2</mn>
    </msub>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msubsup>
            <mi>R</mi>
            <mrow>
              <mi>L</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mn>2</mn>
            </mrow>
            <mn>2</mn>
          </msubsup>
          <mo>+</mo>
          <mrow>
            <msup>
              <mi>α</mi>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <msubsup>
              <mi>R</mi>
              <mrow>
                <mi>L</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mn>1</mn>
              </mrow>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>αR</mi>
              <mrow>
                <mrow>
                  <mi>L</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mn>1</mn>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mi>L</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mn>2</mn>
                </mrow>
              </mrow>
            </msub>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mo>⁢</mo>
      <mrow>
        <mo></mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mn>1</mn>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>⋯</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mn>2</mn>
              </msub>
            </mtd>
            <mtd>
              <mi>⋯</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋰</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
            <mtd>
              <mi>⋮</mi>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>⋯</mi>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mi>⋯</mi>
            </mtd>
            <mtd>
              <msub>
                <mi>W</mi>
                <mi>ref</mi>
              </msub>
            </mtd>
            <mtd>
              <mrow>
                <msub>
                  <mi>W</mi>
                  <mrow>
                    <mi>n</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </msub>
                <mo>+</mo>
                <msub>
                  <mi>W</mi>
                  <mi>ref</mi>
                </msub>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
        <mo></mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00031" num="00031">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>R</mi>
      <mi>L1</mi>
    </msub>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>λ</mi>
              <mn>1</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msubsup>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>non</mi>
                    <mo>-</mo>
                    <mi>dist</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>L1</mi>
                </mrow>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msubsup>
                      <mi>R</mi>
                      <mi>ion</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>·</mo>
                <msup>
                  <mi>B</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mn>1</mn>
        <mn>2</mn>
      </mfrac>
    </msup>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00032" num="00032">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>R</mi>
      <mi>L2</mi>
    </msub>
    <mo>=</mo>
    <msup>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>λ</mi>
              <mn>2</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>⁡</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <msubsup>
                <mi>R</mi>
                <mrow>
                  <mrow>
                    <mi>non</mi>
                    <mo>-</mo>
                    <mi>dist</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>L2</mi>
                </mrow>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msubsup>
                      <mi>R</mi>
                      <mi>ion</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>trop</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <msubsup>
                      <mi>R</mi>
                      <mi>orb</mi>
                      <mn>2</mn>
                    </msubsup>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>·</mo>
                <msup>
                  <mi>B</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mn>1</mn>
        <mn>2</mn>
      </mfrac>
    </msup>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00033" num="00033">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>R</mi>
      <mrow>
        <mi>L1</mi>
        <mo>,</mo>
        <mi>L2</mi>
      </mrow>
    </msub>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <msub>
            <mi>λ</mi>
            <mn>1</mn>
          </msub>
          <mo>⁢</mo>
          <msub>
            <mi>λ</mi>
            <mn>2</mn>
          </msub>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mrow>
        <mrow>
          <mo>(</mo>
          <mrow>
            <msubsup>
              <mi>R</mi>
              <mi>ion</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>trop</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>orb</mi>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>·</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mrow>
              <mfrac>
                <msubsup>
                  <mi>f</mi>
                  <mn>1</mn>
                  <mn>4</mn>
                </msubsup>
                <msubsup>
                  <mi>f</mi>
                  <mn>2</mn>
                  <mn>4</mn>
                </msubsup>
              </mfrac>
              <mo>⁢</mo>
              <msubsup>
                <mi>R</mi>
                <mi>ion</mi>
                <mn>2</mn>
              </msubsup>
            </mrow>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>trop</mi>
              <mn>2</mn>
            </msubsup>
            <mo>+</mo>
            <msubsup>
              <mi>R</mi>
              <mi>orb</mi>
              <mn>2</mn>
            </msubsup>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>·</mo>
        <msup>
          <mi>B</mi>
          <mn>2</mn>
        </msup>
      </mrow>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>wherein R<sub>non-dist,L1 </sub>is a non-distance dependant measurement error for the L<sub>1 </sub>measurement;</claim-text>
<claim-text>wherein R<sub>non-dist,L2 </sub>is a non-distance dependant measurement error for the L<sub>2 </sub>measurement;</claim-text>
<claim-text>wherein R<sub>ion </sub>is measurement error due to ionospheric delay;</claim-text>
<claim-text>wherein R<sub>trop </sub>is measurement error due to tropospheric delay;</claim-text>
<claim-text>wherein R<sub>orb </sub>is measurement error due to orbit bias;</claim-text>
<claim-text>wherein each W is: W<sub>n</sub>=1.0 +7.5e<sup>−E/15</sup>;</claim-text>
<claim-text>wherein n is a satellite ordinal of a plurality of satellites;</claim-text>
<claim-text>wherein W<sub>ref </sub>corresponds to a reference satellite of the plurality of satellites;</claim-text>
<claim-text>wherein E is the elevation angle of each satellite of the plurality of satellites;</claim-text>
</claim-text>
<claim-text>updating a Kalman filter with the calculated variance matrix; and</claim-text>
<claim-text>determining a present position estimate based on the updated Kalman filter.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer readable medium of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein the updated Kalman filter with the calculated variance matrix is:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>K=D</i>(<i>L</i><sub>1</sub><i>,L</i><sub>2</sub>)<sub>new</sub><i>H</i><sub>2</sub><sup>T</sup><i>{H</i><sub>2</sub><sup>T</sup><i>D</i>(<i>L</i><sub>1</sub><i>,L</i><sub>2</sub>)<sub>new</sub><i>H</i><sub>2</sub><sup>T</sup><i>+V</i><sub>2</sub>}<sup>−1</sup>;<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>wherein H<sub>2</sub><sup>T </sup>is a transpose of a design matrix H<sub>2 </sub>for the measurement L<sub>2</sub>;</claim-text>
<claim-text>wherein V<sub>2 </sub>is a residual measurement of measurement L<sub>2</sub>;</claim-text>
<claim-text>wherein D(L<sub>1</sub>,L<sub>2</sub>)<sub>new</sub>=D(L<sub>1</sub>,L<sub>2</sub>)<sub>old</sub>−K<sub>old</sub>H<sub>2</sub>D(L<sub>1</sub>,L<sub>2</sub>)<sub>old</sub>;</claim-text>
<claim-text>wherein D(L<sub>1</sub>,L<sub>2</sub>)<sub>new </sub>is the calculated variance matrix including the received measurements L<sub>1 </sub>and L<sub>2</sub>;</claim-text>
<claim-text>wherein D(L<sub>1</sub>,L<sub>2</sub>)<sub>old </sub>is a previous calculated variance matrix which was calculated before receiving both of the received measurements L<sub>1 </sub>and L<sub>2</sub>; and</claim-text>
<claim-text>wherein K<sub>old </sub>is a previous Kalman filter which was calculated before receiving both of the received measurements L<sub>1 </sub>and L<sub>2</sub>.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
