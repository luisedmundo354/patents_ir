<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299023-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299023</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11382380</doc-number>
<date>20060509</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>455255</main-classification>
<further-classification>4551822</further-classification>
<further-classification>4551922</further-classification>
<further-classification>375344</further-classification>
<further-classification>375326</further-classification>
</classification-national>
<invention-title id="d0e51">Method and apparatus for automatic frequency correction with a frequency error signal generated by block correlation of baseband samples with a known code sequence</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5818882</doc-number>
<kind>A</kind>
<name>Komatsu</name>
<date>19981000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375344</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6067292</doc-number>
<kind>A</kind>
<name>Huang et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370342</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6625197</doc-number>
<kind>B1</kind>
<name>Lundby et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375130</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6728326</doc-number>
<kind>B1</kind>
<name>Fulghum</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375365</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7035234</doc-number>
<kind>B2</kind>
<name>Toskala et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7058378</doc-number>
<kind>B2</kind>
<name>Grieco et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455255</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2001/0008838</doc-number>
<kind>A1</kind>
<name>Toskala et al.</name>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455458</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2003/0081656</doc-number>
<kind>A1</kind>
<name>Buehrer et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375142</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0086482</doc-number>
<kind>A1</kind>
<name>Shimizu et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375147</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2004/0057505</doc-number>
<kind>A1</kind>
<name>Valio</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375148</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2004/0114551</doc-number>
<kind>A1</kind>
<name>Gavillero et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370324</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2004/0190603</doc-number>
<kind>A1</kind>
<name>Dabak et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375148</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2005/0047484</doc-number>
<kind>A1</kind>
<name>He et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375148</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2005/0078771</doc-number>
<kind>A1</kind>
<name>Oh et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375317</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>27</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>455255</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455257</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455259</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455260</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 20</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4554221</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551613</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455139</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551921</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551922</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551541</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551612</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551821</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551811</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551832</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551831</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551731</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551861</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551642</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4551641</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4555751</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4555541</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455424</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455425</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455561</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 631</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 65</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 661</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455227</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 6711</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 6713</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 6714</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 6715</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 68</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 71</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 75</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 76</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455119</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455135</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455136</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375344</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375375</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375343</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375365</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375362</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375367</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375354</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375148</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375150</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375130</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375136</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375147</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375145</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375152</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375142</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375144</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375143</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375260</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370480</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370491</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370514</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370509</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370512</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370208</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370342</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370444</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370479</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370324</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370317</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370203</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370210</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370516</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>9</number-of-figures>
</figures>
<us-related-documents>
<continuation>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>10977053</doc-number>
<kind>00</kind>
<date>20041029</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>7058378</doc-number>
<kind>A </kind>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>11382380</doc-number>
</document-id>
</child-doc>
</relation>
</continuation>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60523051</doc-number>
<kind>00</kind>
<date>20031118</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070032213</doc-number>
<kind>A1</kind>
<date>20070208</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Grieco</last-name>
<first-name>Donald M.</first-name>
<address>
<city>Manhassett</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bultan</last-name>
<first-name>Aykut</first-name>
<address>
<city>Bayside</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Volpe and Koenig, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>InterDigital Technology Corporation</orgname>
<role>02</role>
<address>
<city>Wilmington</city>
<state>DE</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Urban</last-name>
<first-name>Edward F.</first-name>
<department>2618</department>
</primary-examiner>
<assistant-examiner>
<last-name>Chow</last-name>
<first-name>Charles</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention is related to a method and apparatus for automatic frequency correction of a local oscillator. The apparatus receives a carrier signal. The carrier signal includes a code sequence known to the apparatus. The apparatus downconverts the carrier signal to a baseband signal using the local oscillator. The apparatus performs a block correlation of the samples of the baseband signal with the known code sequence to generate a frequency error signal. The frequency error signal is fed back to the local oscillator to correct the frequency error.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="73.49mm" wi="115.74mm" file="US07299023-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="174.84mm" wi="127.59mm" file="US07299023-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="192.19mm" wi="112.52mm" orientation="landscape" file="US07299023-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="175.18mm" wi="120.99mm" orientation="landscape" file="US07299023-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="183.56mm" wi="130.64mm" file="US07299023-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="192.79mm" wi="132.93mm" file="US07299023-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="192.87mm" wi="115.99mm" orientation="landscape" file="US07299023-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application is a continuation of U.S. application Ser. No. 10/977,053, filed Oct. 29, 2004, now U.S. Pat. No. 7,058,378 which claims the benefit of U.S. provisional application No. 60/523,051 filed Nov. 18, 2003, which is incorporated by reference as if fully set forth.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF INVENTION</heading>
<p id="p-0003" num="0002">The present invention is related to wireless communications. More particularly, the present invention is related to a method and apparatus for automatic frequency correction (AFC).</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">In a wireless communication system, a transmitter modulates a baseband signal with a high frequency carrier to transmit to a receiver. The modulated signal is received and demodulated at the receiver. For modulation and demodulation, both a transmitter and a receiver include a local oscillator for generating the same frequency carrier signal. To effectively demodulate the modulated signal, the frequency of the local oscillator at the receiver should be same as that of the transmitter. Therefore, it is important to remove phase errors between the transmitter and the receiver local oscillators.</p>
<p id="p-0005" num="0004">Although the nominal frequencies of a wireless transmit/receive unit (WTRU) and a base station local oscillator are the same, they are different in practice. There are two main reasons for the difference. The first reason is an initial frequency error due to manufacturing tolerances of the oscillator. The second reason is a drift of the oscillator frequency over time. This happens due to various reasons such as temperature effects and aging. This cumulatively results in different oscillator frequencies between a WTRU and a base station.</p>
<p id="p-0006" num="0005">The frequency difference of local oscillators between a WTRU and a base station causes system degradation. For example, in a Universal Terrestrial Radio Access/Time Division Duplex (UTRA/TDD) system, the frequency difference between a base station local oscillator and a WTRU local oscillator can be as large as ±3 ppm. With a transmitter and receiver carrier frequency of about 2 GHz, 3 ppm corresponds to a frequency error of 6,000 Hz. Since the local oscillator is synthesized from the same local oscillator that is used for sampling, sampling at the receiver can drift as much as 1 chip every 8.7 frames for a TDD system.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0007" num="0006">The present invention is related to a method and apparatus for AFC of a local oscillator. The method of the present invention utilizes differences in successive phase estimates to maintain the frequency of the WTRU local oscillator within a desired or predetermined range relative to a base station local oscillator. A WTRU receives a carrier signal from a base station. The carrier signal includes a code sequence known to the WTRU. The WTRU downconverts the carrier signal into a baseband signal using the local oscillator. The WTRU performs a block correlation of the samples of the baseband signal with the known code sequence to generate a frequency error signal. The frequency error signal is fed back to the local oscillator to correct the frequency error.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0008" num="0007">A more detailed understanding of the invention may be obtained from the following description of preferred embodiments, provided by way of example and to be understood in conjunction with the accompanying drawings in which:</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a process including inputs and outputs for an automatic frequency correction process operating in accordance with a preferred embodiment of the present invention;</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of an apparatus for implementing automatic frequency correction in accordance with a preferred embodiment of the present invention;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of a frequency estimation block utilized in an apparatus of <figref idref="DRAWINGS">FIG. 2</figref>;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram of block correlators utilized in the frequency estimation block of <figref idref="DRAWINGS">FIG. 3</figref>;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of an exemplary first block correlation;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of a conjugate product and sum unit utilized in the frequency estimation block of <figref idref="DRAWINGS">FIG. 3</figref>;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of an integrator for integrating the estimated frequency error;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 8</figref> is a flow diagram of a process for automatic frequency correction in accordance with the present invention; and</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of another embodiment of a frequency estimation block utilized in an apparatus of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0018" num="0017">The present invention will be described with reference to the drawing figures wherein like numerals represent like elements throughout.</p>
<p id="p-0019" num="0018">The features of the present invention may be incorporated into an integrated circuit (IC) or be configured in a circuit comprising a multitude of interconnecting components.</p>
<p id="p-0020" num="0019">Hereafter, the terminology “WTRU” includes, but is not limited to, a user equipment, a mobile station, a fixed or mobile subscriber unit, a pager, or any other type of device capable of operating in a wireless environment. When referred to hereafter, the terminology “base station” includes, but is not limited to, a Node-B, a site controller, an access point or any other type of interfacing device in a wireless environment.</p>
<p id="p-0021" num="0020">Hereinafter, for simplicity, the present invention will be described with reference to a TDD system. However, it would be understood by a person skilled in the art that the teachings of the present invention are applicable to a general code division multiple access (CDMA) communication system, including frequency division duplex (FDD), time division synchronous CDMA (TDSCDMA), and CDMA 2000, or any other CDMA system.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a process <b>100</b> including inputs and outputs for an AFC processor <b>102</b> operating in accordance with a preferred embodiment of the present invention. The AFC processor <b>102</b> in accordance with the present invention utilizes several inputs, including a sampled received baseband signal, (preferably two times (2×) over-sampled), a location of a code sequence, (preferably in the form of a primary common control physical channel (P-CCPCH) midamble position), a cell parameter in the form of a basic midamble code number, an odd/even frame indicator, an RF carrier frequency, and an initial voltage controlled oscillator (VCO) digital-to-analog converter (DAC) control voltage. Optionally, the initial VCO DAC control voltage may be based upon a user defined value or a previously stored value. The outputs <b>104</b> of the AFC processor <b>102</b> include any of: (a) a control voltage for the VCO, (b) an estimated frequency error, and (c) an indicator of convergence.</p>
<p id="p-0023" num="0022">The AFC is performed after completion of an initial cell search procedure. No channel estimation or equalization is required for the AFC to execute. The present invention will be explained hereinafter with reference to a midamble code in a P-CCPCH. However, it should be understood that any other pilot sequence can be used instead of P-CCPCH. The only required information for AFC is the location of a midamble of a P-CCPCH, which is provided after the initial cell search procedure. Initially, the AFC process uses the midamble of the P-CCPCH. Once a dedicated channel (DCH) is established, the AFC process may further use a midamble contained in the DCH.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of an apparatus <b>200</b> for implementing AFC in accordance with a preferred embodiment of the present invention. The apparatus <b>200</b> comprises a VCO <b>202</b>, a mixer <b>204</b>, an analog-to-digital converter (ADC) <b>206</b>, a frequency estimation block <b>208</b>, a cell searching block <b>210</b>, a loop filter <b>212</b>, and a DAC <b>214</b>. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the signal generated by the VCO <b>202</b> may also be used for a transmit process for mixing transmit data converted by a DAC <b>215</b>, although this is not required.</p>
<p id="p-0025" num="0024">A carrier signal includes a known code sequence, preferably a midamble code, and the known code sequence is used for estimating frequency error of the local oscillator. A received carrier signal is mixed by the mixer <b>204</b> with a signal generated by the VCO <b>202</b> to be converted to a baseband signal. The baseband signal is converted to a digital signal by the ADC <b>206</b>. The ADC <b>206</b> over-samples the baseband signal, preferably at 2× the chip rate. The digital samples are input to the frequency estimation block <b>208</b> and the cell searching block <b>210</b>.</p>
<p id="p-0026" num="0025">The cell searching block <b>210</b> performs an initial cell searching procedure using any known method. After the cell searching procedure is performed, the cell searching block <b>210</b> outputs the location of a first significant path of the midamble code of a P-CCPCH. The 2× over-sampled received signal and the midamble position of the first significant path are input into the frequency estimation block <b>208</b>. The frequency estimation block <b>208</b> generates a frequency error signal, which will be explained in detail hereinafter. The frequency error signal generated by the frequency estimation block <b>208</b> enters into the loop filter <b>212</b> that generates a correction signal for the VCO <b>202</b>. This correction signal drives the measured frequency error to zero in a steady state. The correction signal may or may not be digital. If the correction signal is digital, it is converted to an analog signal by the DAC <b>214</b> before being applied to the VCO <b>202</b>.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of a frequency estimation block <b>208</b> utilized in the apparatus of <figref idref="DRAWINGS">FIG. 2</figref>. It should be understood that the configuration illustrated in <figref idref="DRAWINGS">FIG. 3</figref> is provided only as an example, and any other types of architecture may be used in frequency estimation. Pursuant to a preferred embodiment of the present invention, the frequency estimation block <b>208</b> comprises at least one block correlator bank <b>220</b>, at least one conjugate product and sum unit <b>230</b>, and an angle calculation unit <b>250</b>. The block correlator bank <b>220</b> performs correlation of the samples with the midamble to generate correlation results. The block correlator bank <b>220</b> comprises a plurality of block correlators as will be explained in detail hereinafter. The conjugate product and sum unit <b>230</b> receives the correlation results and generates an estimate of the phase change from one block correlator to the next block correlator in the block correlator bank <b>220</b>. The angle calculation unit <b>250</b> generates a frequency estimate from the output of the conjugate product and sum unit <b>230</b>. The frequency estimator <b>208</b> may further comprise an accumulator <b>240</b> for accumulating the output of the conjugate product and sum unit <b>230</b> over a predetermined time, a multipath detection unit <b>241</b> and a multipath combiner <b>248</b> for detecting and combining multipath components.</p>
<p id="p-0028" num="0027">The frequency estimation block <b>208</b> may comprise more than one block correlator bank <b>220</b> and more than one conjugate product and sum unit <b>230</b> to process additional midambles. For example, as shown in <figref idref="DRAWINGS">FIG. 9</figref>, two midambles, m<sub>1</sub>, and m<sub>2 </sub>(j=0,1) may be used. Thus, in this embodiment, the frequency estimation block <b>208</b> comprises two block correlator banks <b>220</b>′, <b>220</b>″ and two conjugate product and sum units <b>230</b>′, <b>230</b>″. A first block correlator bank <b>220</b>′ and conjugate product and sum unit <b>230</b>′ process the first midamble, m<sub>1</sub>, and the second block correlator bank <b>220</b>″ and conjugate product and sum unit <b>230</b>″ process the second midamble, m<sub>2</sub>. This allows for diversity gains when space code transmit diversity (SCTD) is employed.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram of an example configuration of the block correlator bank <b>220</b> of <figref idref="DRAWINGS">FIG. 3</figref> using sliding window block correlation. The block correlator bank <b>220</b> comprises a plurality of block correlators <b>220</b><i>a</i>-<b>220</b><i>d</i>. Each block correlator <b>220</b><i>a</i>-<b>220</b><i>d </i>performs correlation of the received baseband samples with the midamble to generate a correlation result. The size of the block, and hence number of blocks, is chosen to prevent excessive correlation loss before the AFC has corrected the initial error, but the specific size shown in the figure is not required.</p>
<p id="p-0030" num="0029">As an example, if the AFC procedure processes a midamble of a P-CCPCH transmitted in a burst type 1, the transmission is 2× over-sampled, and the searching window includes 10 leading chips (20 samples), 49 lagging chips (98 samples), and 512 midamble chips (1024 samples), the total number of samples required for the sliding window is 1142 (r<sub>0</sub>-r<sub>1141</sub>). The leading samples provide margin for any undetected paths. The lagging samples provide margin for the maximum expected multipath spread. At each lag, four (4) correlations at each block correlator <b>220</b><i>a</i>-<b>220</b><i>d </i>are performed. At each lag, 128 samples are input into each of four block correlators <b>220</b><i>a</i>-<b>220</b><i>d</i>. For example, the first 128 even samples (r<sub>0</sub>, r<sub>2</sub>, . . . r<sub>254</sub>) are input to the first block correlator <b>220</b><i>a</i>, the next 128 even samples (r<sub>256</sub>, r<sub>258</sub>, . . . r<sub>510</sub>) are input to the second block correlator <b>220</b><i>b</i>, the next 128 even samples (r<sub>512</sub>, r<sub>514</sub>, . . . r<sub>766</sub>) are input to the third block correlator <b>220</b><i>c</i>, and the last 128 even samples (r<sub>768</sub>, r<sub>770</sub>, . . . r<sub>1022</sub>) are input to the fourth block correlator <b>220</b><i>d</i>. Each block correlator performs a correlation with a different portion of midamble code. In the foregoing example that 512 bits of midamble code and four (4) block correlators are used, each block correlator performs a correlation with 128 bits of midamble. The first block correlator <b>220</b><i>a </i>uses the first 128 bits of midamble, the second block correlator <b>220</b><i>b </i>uses the second 128 bits, the third and the fourth block correlators <b>220</b><i>c</i>, <b>220</b><i>d </i>use the third and the fourth 128 bits, respectively. Each block correlator <b>220</b><i>a</i>-<b>220</b><i>d </i>generates a correlation result, R<sub>0,i,j</sub>, R<sub>1,i,j</sub>, R<sub>2,i,j</sub>, and R<sub>3,i,j</sub>, respectively.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of the first block correlator <b>220</b><i>a </i>in the block correlator bank <b>220</b>. The first block correlator <b>220</b><i>a </i>receives 128 samples and performs a correlation of the samples with the first 128 bits of midamble, and produces R<sub>0,i,j</sub>. In general, the output from the k'th block correlator at lag i is defined by:</p>
<p id="p-0032" num="0031">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>R</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
          </msub>
          <mo>=</mo>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>n</mi>
                <mo>=</mo>
                <mn>0</mn>
              </mrow>
              <mrow>
                <mi>B</mi>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>r</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>+</mo>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <mi>kB</mi>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <mn>2</mn>
                    <mo>⁢</mo>
                    <mi>n</mi>
                  </mrow>
                </mrow>
              </msub>
              <mo>⁢</mo>
              <msubsup>
                <mi>m</mi>
                <mrow>
                  <mi>j</mi>
                  <mo>,</mo>
                  <mrow>
                    <mi>kB</mi>
                    <mo>+</mo>
                    <mi>n</mi>
                  </mrow>
                </mrow>
                <mo>*</mo>
              </msubsup>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>1</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where, for the foregoing example, 0≦i≦118, 0≦k≦3, B=128, and j, (0≦j≦1), corresponds to the midamble shift used for the correlation. The results of the sliding window correlation block (R<sub>0,i,j</sub>, R<sub>1,i,j</sub>, R<sub>2,i,j</sub>, and R<sub>3,i,j</sub>) are passed to the conjugate product and sum unit <b>230</b>.
</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram of a conjugate product and sum unit <b>230</b> utilized in the frequency estimation block <b>208</b> of <figref idref="DRAWINGS">FIG. 3</figref>. The correlator output is a complex number that represents the centroid of the received samples with the midamble modulation removed. The conjugate product and sum unit <b>230</b> generates an estimate of the phase change from one block correlator to the next block correlator. This is accomplished by computing the conjugate product of successive correlator outputs. Conjugate of output R<sub>0,i,j</sub>* from the first block correlator <b>220</b><i>a </i>is multiplied to an output R<sub>1,i,j </sub>of a second block correlator <b>220</b><i>b</i>, conjugate of output R<sub>1,i,j</sub>* of the second block correlator <b>220</b><i>b </i>is multiplied to an output R<sub>2,i,j </sub>of a third block correlator <b>220</b><i>c</i>, and conjugate of output R<sub>2,i,j</sub>* of the third block correlator <b>220</b><i>c </i>is multiplied to an output R<sub>3,i,j </sub>of a fourth block correlator <b>220</b><i>d</i>. Each output from a conjugate product operation is a complex vector with angle approximating the phase change from the center of one correlation to the next. The three conjugate products for each midamble, m<sub>1 </sub>and m<sub>2</sub>, are then summed together to produce a lower variance estimate of the phase change from one block correlator to the next. Conjugate products associated with m<sub>1 </sub>are summed together and stored in D(i,0), and conjugate products associated with m<sub>2 </sub>are summed together and stored in D(i,1). The equation defining the output of the conjugate product and sum block is:</p>
<p id="p-0034" num="0033">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>D</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>∑</mo>
            <mrow>
              <mi>k</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mn>3</mn>
          </munderover>
          <mo>⁢</mo>
          <mrow>
            <msub>
              <mi>R</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <msubsup>
              <mi>R</mi>
              <mrow>
                <mrow>
                  <mi>k</mi>
                  <mo>-</mo>
                  <mn>1</mn>
                </mrow>
                <mo>,</mo>
                <mi>i</mi>
                <mo>,</mo>
                <mi>j</mi>
              </mrow>
              <mo>*</mo>
            </msubsup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>2</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0035" num="0034">The frequency estimation block <b>208</b> preferably comprises an accumulator <b>240</b>. The accumulator <b>240</b> accumulates the output of the conjugate product and sum unit <b>230</b> over N midambles. The resulting accumulated complex numbers are defined as:</p>
<p id="p-0036" num="0035">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mover>
            <mi>D</mi>
            <mi>_</mi>
          </mover>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>i</mi>
              <mo>,</mo>
              <mi>j</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munder>
            <mo>∑</mo>
            <mrow>
              <mi>N</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>Midambles</mi>
            </mrow>
          </munder>
          <mo>⁢</mo>
          <mrow>
            <mi>D</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>j</mi>
                <mo>,</mo>
                <mi>i</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>3</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0037" num="0036">The accumulation time, N, is initially set to 2 and is subsequently determined based on the most recent estimate of the absolute value of a frequency error. Table 1 provides exemplary values of N as a function of the frequency error. The values chosen for N guarantee that less than one quarter chip movement can occur between frequency updates, in order to prevent paths from crossing into adjacent samples.</p>
<p id="p-0038" num="0037">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="center"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Absolute frequency error (Hz)</entry>
<entry>Number of midambles (N)</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="char" char="."/>
<tbody valign="top">
<row>
<entry/>
<entry>(4000, ∞)</entry>
<entry>2</entry>
</row>
<row>
<entry/>
<entry>(2000, 4000)</entry>
<entry>4</entry>
</row>
<row>
<entry/>
<entry>(1000, 2000)</entry>
<entry>6</entry>
</row>
<row>
<entry/>
<entry>(100, 1000)</entry>
<entry>12</entry>
</row>
<row>
<entry/>
<entry>(0, 100)</entry>
<entry>30</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0039" num="0038">Referring back to <figref idref="DRAWINGS">FIG. 3</figref>, the frequency estimation block <b>208</b> may further comprise a multipath detection unit <b>241</b> and a multipath combiner <b>248</b>. The multipath detection unit <b>241</b> comprises a magnitude calculation unit <b>242</b>, a searching unit <b>244</b>, and a threshold calculator <b>246</b>. In order to combine multipath components, after N midambles have been processed through the sliding window block correlators <b>220</b>, the multipath detection unit <b>241</b> searches to find several, (for example six (6)), accumulated value <o ostyle="single">D</o>(i,j) with the largest magnitudes. The accumulated values, <o ostyle="single">D</o>(i,j), are input to the magnitude calculation unit <b>242</b> and the searching unit <b>244</b>. The magnitude calculation unit <b>242</b> calculates the magnitude of each accumulated value, <o ostyle="single">D</o>(i,j), and outputs the magnitude of each accumulated value, <o ostyle="single">D</o>(i,j), to the searching unit <b>244</b>.</p>
<p id="p-0040" num="0039">The searching unit <b>244</b> locates six (6) of the largest absolute values, (D<b>0</b> (largest) through D<b>5</b>). The following equations precisely define the relationship between the accumulated values, <o ostyle="single">D</o>(i,j), and the six (6) resolved paths:</p>
<p id="p-0041" num="0040">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>i</mi>
                <mn>0</mn>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>j</mi>
                <mn>0</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <munder>
              <mrow>
                <mi>Arg</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>Max</mi>
              </mrow>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>j</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </munder>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo></mo>
                <mrow>
                  <mover>
                    <mi>D</mi>
                    <mi>_</mi>
                  </mover>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo></mo>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>;</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>4</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>D</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mn>0</mn>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mover>
              <mi>D</mi>
              <mi>_</mi>
            </mover>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>i</mi>
                  <mn>0</mn>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>j</mi>
                  <mn>0</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>;</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>5</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>i</mi>
                <mn>1</mn>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>j</mi>
                <mn>1</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <munder>
              <mrow>
                <mi>Arg</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>Max</mi>
              </mrow>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>,</mo>
                    <mi>j</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>≠</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mi>i</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>,</mo>
                    <msub>
                      <mi>j</mi>
                      <mn>0</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </munder>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo></mo>
                <mrow>
                  <mover>
                    <mi>D</mi>
                    <mi>_</mi>
                  </mover>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo></mo>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>;</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>6</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>D</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mn>1</mn>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mover>
              <mi>D</mi>
              <mi>_</mi>
            </mover>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>i</mi>
                  <mn>1</mn>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>j</mi>
                  <mn>1</mn>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>;</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>7</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>i</mi>
                <mi>n</mi>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>j</mi>
                <mi>n</mi>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>=</mo>
          <mrow>
            <munder>
              <mrow>
                <mi>Arg</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>Max</mi>
              </mrow>
              <munder>
                <mrow>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>,</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>≠</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msub>
                          <mi>i</mi>
                          <mn>0</mn>
                        </msub>
                        <mo>,</mo>
                        <msub>
                          <mi>j</mi>
                          <mn>0</mn>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>,</mo>
                </mrow>
                <mtable>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mi>i</mi>
                              <mo>,</mo>
                              <mi>j</mi>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                          <mo>≠</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <msub>
                                <mi>i</mi>
                                <mn>1</mn>
                              </msub>
                              <mo>,</mo>
                              <msub>
                                <mi>j</mi>
                                <mn>1</mn>
                              </msub>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                        <mo>,</mo>
                        <mi>…</mi>
                        <mo>,</mo>
                      </mrow>
                    </mtd>
                  </mtr>
                  <mtr>
                    <mtd>
                      <mrow>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>i</mi>
                            <mo>,</mo>
                            <mi>j</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                        <mo>≠</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <msub>
                              <mi>i</mi>
                              <mrow>
                                <mi>n</mi>
                                <mo>-</mo>
                                <mn>1</mn>
                              </mrow>
                            </msub>
                            <mo>,</mo>
                            <msub>
                              <mi>j</mi>
                              <mrow>
                                <mi>n</mi>
                                <mo>-</mo>
                                <mn>1</mn>
                              </mrow>
                            </msub>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mtd>
                  </mtr>
                </mtable>
              </munder>
            </munder>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo></mo>
                <mrow>
                  <mover>
                    <mi>D</mi>
                    <mi>_</mi>
                  </mover>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo></mo>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>;</mo>
        <mstyle>
          <mspace width="0.6em" height="0.6ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>and</mi>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>8</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>Dn</mi>
          <mo>=</mo>
          <mrow>
            <mover>
              <mi>D</mi>
              <mi>_</mi>
            </mover>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>i</mi>
                  <mi>n</mi>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>j</mi>
                  <mi>n</mi>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>;</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>9</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where i<sub>n </sub>and j<sub>n </sub>are the lag and midamble shift, respectively, associated with multi-path component Dn, and 0≦n≦5. A total of six (6) paths are combined in the foregoing example, which corresponds to twice (for transmit diversity) the expected maximum number of significant multi-paths, which is three (3). It should be noted that other values may be used instead of six (6).
</p>
<p id="p-0042" num="0041">The threshold calculator <b>246</b> determines a detection threshold based on the magnitude of the peak (D<b>0</b>), and compares it to D<b>1</b>-D<b>5</b>. D<b>1</b>-D<b>5</b> are considered significant if they are greater than β|D<b>0</b>| in magnitude. Otherwise they are rejected as noise:</p>
<p id="p-0043" num="0042">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>Dn</mi>
          <mi>′</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mo>{</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mi>Dn</mi>
                  <mo>,</mo>
                </mrow>
              </mtd>
              <mtd>
                <mrow>
                  <mrow>
                    <mo></mo>
                    <mi>Dn</mi>
                    <mo></mo>
                  </mrow>
                  <mo>≥</mo>
                  <mrow>
                    <mi>β</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo></mo>
                      <mrow>
                        <mi>D</mi>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>⁢</mo>
                        <mn>0</mn>
                      </mrow>
                      <mo></mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mrow>
                  <mn>0</mn>
                  <mo>,</mo>
                </mrow>
              </mtd>
              <mtd>
                <mi>Otherwise</mi>
              </mtd>
            </mtr>
          </mtable>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>10</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
The detection threshold coefficient, β, is a configurable parameter.
</p>
<p id="p-0044" num="0043">If the magnitudes of D<b>1</b>-D<b>5</b> exceed the detection threshold, they are deemed sufficiently large to be included in the frequency estimation computation. After D<b>1</b>-D<b>5</b> are compared to the detection threshold, the multipath combiner <b>248</b> combines the surviving multipath components into a single complex vector whose angle is an estimate of the phase change of the carrier offset over one correlator block time period. This complex resultant is given by:</p>
<p id="p-0045" num="0044">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>D</mi>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mi>D</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mn>0</mn>
          </mrow>
          <mo>+</mo>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>n</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mn>5</mn>
            </munderover>
            <mo>⁢</mo>
            <msup>
              <mi>Dn</mi>
              <mi>′</mi>
            </msup>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>11</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0046" num="0045">The angle calculation unit <b>250</b> determines a frequency estimate of the complex resultant. A trigonometric calculation can be employed in calculating the frequency estimate. However, the frequency estimate is preferably computed using two approximations. In order to extract the angle information from the multipath combiner <b>248</b> output, the complex vector is scaled to have unit magnitude and an approximation of the complex absolute value function is utilized in a magnitude calculation unit <b>252</b> and a complex error normalization unit <b>254</b>. The complex absolute value approximation is as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Abs</i><sub>approx</sub><i>{z</i>}=Max (|<i>Re{z}|,|Im {z</i>}|)+½ Min (|<i>Re{z}|,|Im{z</i>}|)  Equation (12)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
It is necessary to make use of a small angle approximation for the angle of a complex unit vector. The approximation is as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Im{z</i>}≈Arg(<i>z</i>)=θ,if θ&lt;&lt;1, and |<i>z|=</i>1  Equation (13)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Therefore, the equation that relates the estimated angle, θ, with the complex output of the multipath combiner <b>248</b>, D, is:
</p>
<p id="p-0047" num="0046">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>θ</mi>
        <mo>=</mo>
        <mrow>
          <mi>Im</mi>
          <mo>⁢</mo>
          <mrow>
            <mo>{</mo>
            <mfrac>
              <mi>D</mi>
              <mrow>
                <msub>
                  <mi>Abs</mi>
                  <mi>approx</mi>
                </msub>
                <mo>⁢</mo>
                <mrow>
                  <mo>{</mo>
                  <mi>D</mi>
                  <mo>}</mo>
                </mrow>
              </mrow>
            </mfrac>
            <mo>}</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>14</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0048" num="0047">The definition of frequency is the rate of change of phase with respect to time. The time interval of the differential phase estimate is fixed at BT<sub>c</sub>. Therefore estimated frequency error, ε, is simply a scaled version of θ:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>ε=αθ  Equation (15)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0049" num="0048">Pursuant to a fixed-point implementation of AFC, the desired units of the estimated frequency error must be consistent with the VCO DAC register. As an example, where the VCO DAC has 10-bits of resolution and a dynamic range of ±7.275 ppm (≈29.1 kHz) which implies the LSB, δ, represents a change of about 28 Hz. The constant α is provided by:</p>
<p id="p-0050" num="0049">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>α</mi>
          <mo>=</mo>
          <mfrac>
            <mn>1</mn>
            <mrow>
              <mn>4</mn>
              <mo>⁢</mo>
              <mi>δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>BT</mi>
                <mi>c</mi>
              </msub>
            </mrow>
          </mfrac>
        </mrow>
        <mo>;</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mn>16</mn>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>δ=<i>f</i><sub>c</sub>·7.275×10<sup>−6</sup>.  Equation (17)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The LSB δ, and therefore α, are dependant upon the RF frequency to which the radio is tuned. It is, therefore, necessary for the AFC algorithm to be provided the RF carrier frequency in order to appropriately scale the estimated frequency error.
</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of an illustrative integrator for integrating the estimated frequency error generated by the frequency estimator. The loop filter <b>212</b> takes the estimated frequency error ε as an input and the estimated frequency error is scaled by λ<b>262</b> and performs an integration operation through a delay and feedback unit <b>264</b> in order to obtain the VCO DAC register, v:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>v</i>(<i>t</i>)=<i>v</i>(<i>t−</i>1)+λ<i>e</i>(<i>t</i>).  Equation (18)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
The integration is performed only when the error ε is dumped from the previous block. Therefore the value of v changes after N midambles are processed.
</p>
<p id="p-0052" num="0051">Upon initialization of AFC, the convergence indicator <b>104</b> is cleared. When an estimate of frequency error is smaller than a predetermined value, (for example 100 Hz in absolute value), the convergence indicator is set. If, after convergence, an estimated frequency error is computed that is larger than a predetermined value, for example 1 kHz in absolute value, the convergence indicator is cleared which indicates loss of frequency synchronization.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 8</figref> is a flow diagram of a process <b>300</b> for AFC in accordance with the present invention. A WTRU receives a carrier signal (step <b>302</b>). The carrier signal includes a known code sequence, for example a midamble code. The WTRU downconverts the carrier signal into a baseband signal using a local oscillator (step <b>304</b>). The WTRU performs sampling of the baseband signal preferable at 2× the chip rate (step <b>306</b>). The samples are input into a plurality of block correlators to generate a plurality of correlation results (step <b>308</b>). Correlation results of each block correlator are multiplied and summed in conjugate sense to generate a single conjugate product and sum (step <b>310</b>). The conjugate product and sum are accumulated over N midambles. If N midambles are not accumulated, the process returns to step <b>302</b> to receive another carrier signals (step <b>312</b>).</p>
<p id="p-0054" num="0053">If it is determined that N midambles are accumulated at step <b>312</b>, multipath components are detected and combined together (step <b>314</b>). If it is determined that N midamble are not yet accumulated, the process <b>300</b> returns to step <b>302</b>. In detecting the multipath components, several largest accumulated products are selected and compared to a detection threshold. The detection threshold may be set in accordance with the largest accumulated conjugate product and sum. An angle value, which is a frequency estimate, is calculated from the combined conjugate product and sum (step <b>316</b>). In calculating the angle value, an approximation method may be utilized. A frequency error signal is generated from the angle value (step <b>318</b>), and the frequency error signal is feed back to the local oscillator to correct the frequency error (step <b>320</b>).</p>
<p id="p-0055" num="0054">Although the features and elements of the present invention are described in the preferred embodiments in particular combinations, each feature or element can be used alone without the other features and elements of the preferred embodiments or in various combinations with or without other features and elements of the present invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07299023-20071120-M00001.NB">
<img id="EMI-M00001" he="8.81mm" wi="76.20mm" file="US07299023-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07299023-20071120-M00002.NB">
<img id="EMI-M00002" he="9.14mm" wi="76.20mm" file="US07299023-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07299023-20071120-M00003.NB">
<img id="EMI-M00003" he="7.03mm" wi="76.20mm" file="US07299023-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07299023-20071120-M00004.NB">
<img id="EMI-M00004" he="43.77mm" wi="76.20mm" file="US07299023-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07299023-20071120-M00005.NB">
<img id="EMI-M00005" he="7.45mm" wi="76.20mm" file="US07299023-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07299023-20071120-M00006.NB">
<img id="EMI-M00006" he="8.81mm" wi="76.20mm" file="US07299023-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07299023-20071120-M00007.NB">
<img id="EMI-M00007" he="7.45mm" wi="76.20mm" file="US07299023-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07299023-20071120-M00008.NB">
<img id="EMI-M00008" he="6.69mm" wi="76.20mm" file="US07299023-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for automatically correcting a frequency error of a local oscillator in a receiver, the method comprising:
<claim-text>receiving a carrier signal, the carrier signal including a code sequence known to the receiver;</claim-text>
<claim-text>down-converting the carrier signal to a baseband signal;</claim-text>
<claim-text>sampling the baseband signal to generate samples;</claim-text>
<claim-text>performing a correlation of the samples and the code sequence with a plurality of block correlators to generate a plurality of correlation values, each of the block correlators performing a correlation of a portion of the samples and a corresponding portion of the code sequence;</claim-text>
<claim-text>generating a conjugate product and sum of the plurality of correlation values by multiplying correlation values generated by consecutive block correlators in a conjugate sense to generate a plurality of conjugate products and summing the conjugate products;</claim-text>
<claim-text>computing an angle value of the conjugate product and sum;</claim-text>
<claim-text>computing a frequency error estimate by multiplying a constant to the angle value;</claim-text>
<claim-text>generating a correction signal based on the frequency error estimate; and</claim-text>
<claim-text>feeding the correction signal to the local oscillator to correct the frequency error.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>accumulating the conjugate product and sum over N code sequences, whereby the angle value is generated from the accumulated conjugate product and sum.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the number N is adjusted in accordance with the frequency error estimate.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>performing a plurality of correlations of the samples and the code sequence at each of a plurality of lags to generate a plurality of correlation values at each of the lags;</claim-text>
<claim-text>computing a plurality of conjugate product and sums of the correlation values at the lags;</claim-text>
<claim-text>combining the conjugate product and sums; and</claim-text>
<claim-text>computing the angle value from the combined conjugate product and sums.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref> further comprising:
<claim-text>computing a magnitude of each of the conjugate product and sums; and</claim-text>
<claim-text>selecting a predetermined number of largest conjugate product and sums, whereby only the selected largest conjugate product and sums are combined.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> further comprising:
<claim-text>comparing each of the selected conjugate product and sums with a threshold; and</claim-text>
<claim-text>removing a conjugate product and sum which is less than the threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein the threshold is determined based on a peak magnitude among the selected conjugate product and sums.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the baseband signal is sampled at twice the chip rate.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the angle value is computed using an approximation method.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the code sequence is a midamble code.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein the midamble code is detected in a primary common control physical channel.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein midamble codes contained in a DCH are further utilized in calculating the angle value.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein multiple code sequences are simultaneous transmitted via the carrier signal, whereby the frequency error estimate is computed using the multiple code sequences.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>comparing the frequency error signal with a threshold; and</claim-text>
<claim-text>generating a convergence indication signal when the frequency error signal is less than the threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. An automatic frequency correction (AFC) processor for automatically correcting a frequency error of a local oscillator in a receiver, the AFC unit comprising:
<claim-text>a bank of block correlators configured to perform a correlation of samples of received signal and a code sequence which is known to the receiver to generate a plurality of correlation values, each of the block correlators performing a correlation of a portion of the samples and a corresponding portion of the code sequence;</claim-text>
<claim-text>a conjugate product and sum unit configured to generate a conjugate product and sum of the plurality of correlation values by multiplying correlation values generated by consecutive block correlators in a conjugate sense to generate a plurality of conjugate products and summing the conjugate products; and</claim-text>
<claim-text>an angle extraction unit configured to compute an angle value of the conjugate product and sum and a frequency error estimate by multiplying a constant to the angle value, and generate a correction signal based on the frequency error estimate, whereby the correction signal is fed to the local oscillator to correct the frequency error.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The AFC processor of <claim-ref idref="CLM-00015">claim 15</claim-ref> further comprising:
<claim-text>an accumulator for accumulating the conjugate product and sum over N code sequences, whereby the angle extraction unit computes the angle value from the accumulated conjugate product and sum.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The AFC processor of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the number N is adjusted in accordance with the frequency error estimate.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The AFC processor of <claim-ref idref="CLM-00016">claim 16</claim-ref> further comprising:
<claim-text>a plurality of bank of block correlators for performing a plurality of correlations of the samples and the code sequence at each of a plurality of lags to generate a plurality of correlation values at each of the lags;</claim-text>
<claim-text>a plurality of conjugate product and sum units for computing a plurality of conjugate product and sums of the correlation values at the lags; and</claim-text>
<claim-text>a combiner for combining the conjugate product and sums, whereby the angle extraction unit computes the angle value from the combined conjugate product and sums.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The AFC processor of <claim-ref idref="CLM-00018">claim 18</claim-ref> further comprising:
<claim-text>a magnitude calculator for computing a magnitude of each of the conjugate product and sums; and</claim-text>
<claim-text>a selection unit for selecting a predetermined number of largest conjugate product and sums, whereby only the selected largest conjugate product and sums are combined.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The AFC processor of <claim-ref idref="CLM-00019">claim 19</claim-ref> further comprising:
<claim-text>a threshold unit for comparing each of the selected conjugate product and sums with a threshold and removing a conjugate product and sum which is less than the threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The AFC processor of <claim-ref idref="CLM-00020">claim 20</claim-ref> wherein the threshold unit determines the threshold a peak magnitude among the selected conjugate product and sums.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The AFC processor of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein the angle extraction unit computes the angle value using an approximation method.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The AFC processor of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein the code sequence is a midamble code.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The AFC processor of <claim-ref idref="CLM-00023">claim 23</claim-ref> wherein the midamble code is detected in a primary common control physical channel (P-CCPCH).</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The AFC processor of <claim-ref idref="CLM-00024">claim 24</claim-ref> wherein midamble codes contained in a DCH are further utilized in calculating the angle value.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The AFC processor of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein multiple code sequences are simultaneous transmitted via the carrier signal, whereby the frequency error estimate is computed using the multiple code sequences.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The AFC processor of <claim-ref idref="CLM-00015">claim 15</claim-ref> further comprising:
<claim-text>a comparator for comparing the frequency error signal with a threshold and generating a convergence indication signal when the frequency error signal is less than the threshold.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
