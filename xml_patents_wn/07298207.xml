<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298207-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298207</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10966981</doc-number>
<date>20041015</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>255</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>04</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>F</subclass>
<main-group>3</main-group>
<subgroup>68</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>330133</main-classification>
<further-classification>330310</further-classification>
<further-classification>330311</further-classification>
<further-classification>330278</further-classification>
<further-classification>330285</further-classification>
<further-classification>330254</further-classification>
<further-classification>327560</further-classification>
<further-classification>333 18</further-classification>
</classification-national>
<invention-title id="d0e53">Automatic gain control for a multi-stage gain system</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6480068</doc-number>
<kind>B1</kind>
<name>Mujica et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>330279</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6498927</doc-number>
<kind>B2</kind>
<name>Kang et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4552452</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6744330</doc-number>
<kind>B1</kind>
<name>Jones et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>333 28 R</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6927628</doc-number>
<kind>B2</kind>
<name>Oshima et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>330133</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2003/0076906</doc-number>
<kind>A1</kind>
<name>Mujica</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>28</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>330133</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330310</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330311</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330  3</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330278</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330150</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330279</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330285</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330254</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>327560</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>333 28 R</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>333 18</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552411</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552452</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552511</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552532</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60529414</doc-number>
<kind>00</kind>
<date>20031211</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050127993</doc-number>
<kind>A1</kind>
<date>20050616</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yim</last-name>
<first-name>Susan</first-name>
<address>
<city>Plano</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Dasgupta</last-name>
<first-name>Udayan</first-name>
<address>
<city>Irving</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Oswal</last-name>
<first-name>Sandeep</first-name>
<address>
<city>Kamataka</city>
<country>IN</country>
</address>
</addressbook>
<nationality>
<country>IN</country>
</nationality>
<residence>
<country>IN</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ali</last-name>
<first-name>Murtaza</first-name>
<address>
<city>Plano</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Shaw</last-name>
<first-name>Steven A.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Brady</last-name>
<first-name>W. James</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="03" rep-type="attorney">
<addressbook>
<last-name>Telecky, Jr.</last-name>
<first-name>Frederick J.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Texas Instruments Incorporated</orgname>
<role>02</role>
<address>
<city>Dallas</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Shingleton</last-name>
<first-name>Michael B</first-name>
<department>2817</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Systems and methods are disclosed for providing automatic gain control of a multi-stage system. A method can include defining at least one parameter that is adapted to at least one of maximize hardware capacity of each of a plurality of gain stages and mitigate part-to-part variations of the multi-stage system. An order is selected for training the plurality of stages based on relative noise dominance for the plurality of stage. For a given stage of the plurality of stages, which is selected according to the selected order, output signals of the multi-stage system are measured over a plurality of gain settings for the given stage. A gain setting of the given stage of the multi-stage system also is configured based on the measured output signals relative to the at least one parameter defined for the given stage. The plurality of gain stages can include an analog equalizer as well programmable gain amplifiers connected in series.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="84.33mm" wi="159.51mm" file="US07298207-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="228.77mm" wi="170.52mm" file="US07298207-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="206.76mm" wi="153.16mm" file="US07298207-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="204.13mm" wi="149.94mm" file="US07298207-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="229.19mm" wi="168.99mm" file="US07298207-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application claims the benefit of U.S. Provisional Patent Application No. 60/529,414, which was filed Dec. 11, 2003, and which is incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">This invention relates generally to amplification of signals, and more specifically relates to a system and method to facilitate automatic gain control for a multi-stage gain system.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Multi-stage gain amplifiers are widely utilized in telecommunications and other applications where signals are transmitted and received. The applications can include both wireless and wired transmission and reception of signals.</p>
<p id="p-0005" num="0004">Research and development in telecommunications applications have been expanding to meet the increasing popularity in the Internet. One particular application relates to digital subscriber line (DSL) technologies, including both symmetric DSL (SDSL) and asymmetric DSL (ADSL). ADSL is a modem technology that converts existing telephone lines into access paths for multimedia and high speed data communications. ADSL utilizes advanced digital signal processing and creative algorithms to provide greater amounts of information through twisted-pair telephone lines than was conventionally feasible. The ADSL standard calls for a specifically designed modem at each end of a twisted pair copper line, one at a home and the other at a central office of the phone company. Although the conventional telephone voice circuit has only a 4 KHz bandwidth, the physical wire connection bandwidth exceeds 1 MHz.</p>
<p id="p-0006" num="0005">ADSL exploits the extra bandwidth to send data to the central office where it can connect to a phone company's high capacity fiber optic network. ADSL modems increase the amount of information that conventional phone lines can carry buy using discrete multi-tone technology (DMT). DMT divides the bandwidth into independent subbands, then transmits data on all of the subbands simultaneously. Echo cancellation techniques allow upstream and downstream data to overlap. ADSL is particularly attractive for consumer Internet applications where most of the data traffic is downloaded to the customer. Upstream bandwidth for uploading data can be reduced to increase downstream bandwidth since most Internet traffic is downstream.</p>
<p id="p-0007" num="0006">Terminals employed at the central office typically communicate over several channels. These terminals employ modems or other communication devices for data transmissions. These modems or other communication devices can employ a digital processor, a coder/decoder component, line drivers and other peripheral devices to support transmitting and receiving of analog signal transmissions. The central office line driver drives the ADSL signal onto telephone lines. The ADSL signal includes data streams that are carried over tones that are amplitude, phase modulated and frequency separated by about 4 KHz. Conventional ADSL modem designs include functions referred to as analog front ends in which operations, such as digital-to-analog and analog-to-digital conversion, amplification/attenuation and filtering, are performed. Because of the frequencies involved in ADSL technology, which can range from tens of KHz to MHz frequencies, and because of the large dynamic range required in order to accommodate the wide variations in length and schemes for subscriber loops, the amplification and filtering can be very complex, particularly in an integrated circuit.</p>
<p id="p-0008" num="0007">Analog amplification or attenuation is typically needed in the received path of most digital modems to fully utilize the available digital dynamic range. Typically, the gain adjustment depends on the particular channel conditions and loop characteristics. Therefore, automatic gain control is preferable. When the PGA and filtering stages are interleaved, as in typical integrated analog front ends, the automatic gain control process becomes more complicated since, in most environments, the intermediate points in the receive path are inaccessible.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0009" num="0008">One aspect of the present invention provides a method for providing automatic gain control of a multi-stage system. The method includes defining at least one parameter associated with at least some of a plurality of gain stages of the multi-stage system. An order is selected for training the plurality of stages based on relative noise dominance for the plurality of stage. For a given stage of the plurality of stages selected according to the selected order, output signals of the multi-stage system are measured over a plurality of gain settings for the given stage. A gain setting of the given stage of the multi-stage system also is configured based on the measured output signals relative to the at least one parameter defined for the given stage. The plurality of gain stages can include an analog equalizer as well programmable gain amplifiers connected in series. By treating the analog equalizer as a gain stage, automatic gain control is facilitated so as to achieve a maximum hardware capacity and to mitigate part-to-part variations in the multi-stage system.</p>
<p id="p-0010" num="0009">Another aspect of the present invention provides a digital signal processor programmed to perform an automatic gain control algorithm for a plurality of gain stages of a multi-stage gain system. The automatic gain control algorithm selects an order for training the plurality of stages of the multi-stage system based on relative noise dominance among the plurality of stages. Each of the plurality of stages is configured according to the selected order. The configuration of a given stage of the plurality of stages includes incrementing a gain setting for the given stage, measuring output signals over a plurality of frames at the incremented gain setting of the given stage and evaluating the measured output signals relative to a parameter limit defined for the given stage for the incremented gain setting for the given stage. The incrementing, measuring and evaluating can be repeated for a next gain setting of the given stage based on based on the evaluation (e.g., determining that the incremented gain setting does not at least afford a maximum hardware capacity for the given stage and mitigate part-to-part variations). The gain setting of the given stage is then set based on determining that the incremented gain setting affords a maximum hardware capacity for the given stage.</p>
<p id="p-0011" num="0010">Still another aspect of the present invention provides a programmable gain system that includes a plurality of serially coupled stages, each of the plurality of gain stages having an associated programmable gain setting. A control system, during a training phase, sets the associated gain setting of each of the plurality of gain stages in an order. The associated gain setting being set to maximize hardware capacity and to mitigate part-to-part variation in the gain system based on at least one predetermined parameter.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 1</figref> depicts a block diagram of a multi-stage gain system that can be implemented in accordance with an aspect of the present invention.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 2</figref> depicts an example of another of a multi-stage gain system that can be implemented in accordance with an aspect of the present invention.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> is a graph depicting noise characteristics referred to the system input associated with variations in a component of a multi-stage system.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 4</figref> is a graph depicting noise characteristics referred to the system input associated with different components of a multi-stage system for a first setting of a given one of the components of the system.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 5</figref> is a graph, similar to <figref idref="DRAWINGS">FIG. 4</figref>, depicting noise characteristics referred to the system input associated with different components of a multi-stage system for a second setting of the given component of the system.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 6</figref> depicts an example of a method for implementing automatic gain control in accordance with aspect of the present invention.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 7</figref> depicts an example of a method for implementing a first phase of automatic gain control in accordance with aspect of the present invention.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 8</figref> depicts an example of a method for implementing a second phase of automatic gain control in accordance with aspect of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> depicts an example of a programmable amplifier system <b>10</b> that can be implemented according to an aspect of the present invention. The amplifier system <b>10</b> includes a multi-stage gain system <b>12</b> including in a plurality of stages <b>14</b>, <b>16</b> and <b>18</b>. The stages <b>14</b>, <b>16</b> and <b>18</b> are connected in series to receive an INPUT signal at an input thereof and to provide the corresponding OUTPUT signal at an output portion thereof. While three stages <b>14</b>, <b>16</b>, and <b>18</b> are illustrated in the example of <figref idref="DRAWINGS">FIG. 1</figref>, those skilled in the art will understand and appreciate that the multi-stage system <b>12</b> can include any plurality of two or more stages coupled between the input and outputs thereof. Additionally, one or more filters can be interleaved in the system <b>10</b> to mitigate noise from the INPUT signal as well as noise attributable to the stages <b>14</b>, <b>16</b> and <b>18</b>.</p>
<p id="p-0021" num="0020">Each of the stages <b>14</b>, <b>16</b> and <b>18</b> can include a plurality of settings, each of which can provide a gain for each respective stage. Each of the stages <b>14</b>, <b>16</b> and <b>18</b> may also have an associated variation in gain that can differ between devices, such as due to analog process variations among devices. One or more of the stages <b>14</b>, <b>16</b> and <b>18</b> can be implemented as a programmable gain amplifier (PGA) stage.</p>
<p id="p-0022" num="0021">Additionally or alternatively, another of the stages <b>14</b>, <b>16</b> or <b>18</b> can be implemented as an analog equalizer (AEQ). The AEQ is a device operative to partially equalize the channel, and also has an associated gain, which gain can vary as a function of frequency (e.g., dB/MHz). Accordingly, an AEQ is treated as a gain stage for purposes of implementing automatic gain control for the multi-stage system <b>10</b> in accordance with an aspect of the present invention. That is, the approach described herein trains the AEQ stage of the multi-stage system <b>12</b> using a criterion based on power gain instead of the more conventional channel slope. This is in contrast to a more traditional approach in which the AEQ is selected based on channel slope. When the AEQ is selected based on channel slope, the AEQ setting contributes to some power gain at some loop configurations, and hence the gain control might have to scale back the gains of other stages to compensate for the gain contribution from the AEQ.</p>
<p id="p-0023" num="0022">According to one example, the INPUT signal can be provided by a hybrid circuit (not shown). In a typical Asymmetric Digital Subscriber Line (ADSL) system, for example, a hybrid circuit is used within the central office modem (in parallel with the subscriber loop interface circuit) to separate transmit signal from the receive signal path. The hybrid circuit characteristics are typically designed to match the transfer function associated with a subscriber loop. The degree to which it achieves this matching dictates the effectiveness of the hybrid circuit. The OUTPUT signal can be provided to an analog-to-digital converter (ADC) that converts the analog output signal to a corresponding digital signal that can be processed in a manner according to the particular context in which the amplifier system <b>10</b> is implemented.</p>
<p id="p-0024" num="0023">A switch system <b>20</b> can be coupled to one or more selected nodes between respective stages <b>14</b>, <b>16</b> and <b>18</b>. A control system <b>22</b> can control the switch system <b>20</b> for monitoring and measuring signal characteristics of a selected portion of a path including one or more of the stages <b>14</b>, <b>16</b> and <b>18</b>. The switch system <b>20</b> can include one or more switches coupled to intermediate nodes, which switches can be activated and deactivated by the control system <b>22</b> to monitor internal nodes as well as to isolate selected stages from the multi-stage system <b>12</b>, such that a selected portion of the path can be monitored.</p>
<p id="p-0025" num="0024">The control system <b>22</b> also includes an automatic gain control (AGC) algorithm <b>24</b> to control gain settings for at least some of the stages <b>14</b>, <b>16</b> and <b>18</b> of the multi-stage system <b>12</b>. The AGC algorithm <b>24</b> includes parameters <b>26</b> that are utilized to program gain for each of the respective stages <b>14</b>, <b>16</b>, and <b>18</b> according to an aspect of the present invention. The control system <b>22</b> can employ the AGC algorithm during a training phase, which can be implemented periodically or intermittently during operation.</p>
<p id="p-0026" num="0025">As described herein, the AGC algorithm <b>24</b> is operative to configure the multi-stage system <b>12</b> to achieve a maximum hardware capacity. The maximum hardware capacity can vary according to the context or environment in which the system <b>10</b> is implemented. As used herein, the term “maximum hardware capacity” is meant to include a substantially maximum performance capability (e.g., maximum average data rate) for the multi-stage system <b>12</b>, minimum part-to-part variations associated with the system <b>12</b>, as well as a combination of maximum data rate that affords minimum variations.</p>
<p id="p-0027" num="0026">The control system <b>22</b> thus employs the AGC algorithm <b>24</b> during a training phase to distribute gains across the respective stages <b>14</b>, <b>16</b>, and <b>18</b>. The AGC algorithm <b>24</b> operates to distribute the gains so as to maximize the dynamic range of the multi-stage system <b>12</b> without saturation as well as to minimize the overall noise floor, for the multi-stage system <b>12</b>. As mentioned above, the AGC algorithm <b>24</b> also operates to mitigate capacity variations among devices, such as may arise from analog process variations in the components that form the respective stages.</p>
<p id="p-0028" num="0027">The AGC algorithm <b>24</b> operates on the stages <b>14</b>, <b>16</b>, and <b>18</b> according to an order that varies depending on the relative noise dominance of the respective stages over a range of operating conditions. As used herein, “noise dominance” corresponds to a relative effectiveness of the plurality of stages <b>14</b>, <b>16</b> and <b>18</b> to reduce noise in the signal path that includes the respective stages. Thus, a most noise dominant stage has a gain setting that can be selected to most effectively reduce noise in the signal path. Depending on the relative noise dominance of the respective stages <b>14</b>, <b>16</b> and <b>18</b>, the AGC algorithm <b>24</b> can implement multiple iterations for configuring the more dominant stages to facilitate achieving maximum hardware capacity. One or more dominant stages in the system <b>12</b> can be determined from simulation. The simulation can include ascertaining noise characteristics, such as an input referred noise floor for the different noise-contributing components in the system <b>12</b>. Based on an analysis of the noise characteristics for the multi-stage system <b>12</b>, one or more stages that are most effective to reduce noise are determined, which effectiveness determines the order for configuring the stages. The AGC algorithm <b>24</b> utilizes the order to distribute the respective gains in the stages <b>14</b>, <b>16</b> and <b>18</b>. In this way, the AGC algorithm <b>24</b> can achieve an overall maximum gain that maximizes the hardware capacity for the multi-stage system <b>12</b>. This also can mitigate part-to-part variations in the system <b>12</b>.</p>
<p id="p-0029" num="0028">By way of further example, the parameters <b>26</b> of the AGC algorithm <b>24</b> can be predetermined as limits or threshold values that establish a maximum hardware capacity for the stages <b>14</b>, <b>16</b>, and <b>18</b> of the multi-stage gain system <b>12</b>. For instance, a maximum gain limit parameters for an AEQ can be determined by performing computer simulations on a design or model representing the multi-stage system <b>12</b>. A user interface (not shown) can be employed to provide a program signal (PROG) to set the parameters <b>26</b> based on the simulations for the multi-stage system <b>12</b>. For example, offline by simulations, such as circuit simulations employing SPICE software or other design tools, can be employed to determine maximum hardware capacity for the multi-stage system <b>12</b>. As part of the offline process, hardware capacity and corresponding parameter limits can be determined for each stage <b>14</b>, <b>16</b> and <b>18</b> over a plurality of test cases. Each test case can characterize a subscriber loop or other test circuit with which the system <b>10</b> may be implemented. The test cases can also consider a number of different analog process corners for each subscriber loop or test circuit.</p>
<p id="p-0030" num="0029">Thus, the parameters <b>26</b> can include a maximum gain limit for achieving a minimum variation in the hardware capacity that can be achieved within a limit of gain for another stage, such as an analog equalizer stage. The parameters <b>26</b> also can include a value for a target output signal that can be achieved for each of the respective stages <b>14</b>, <b>16</b> and <b>18</b>.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 2</figref> depicts an example of a programmable gain system <b>50</b> that can be implemented according to an aspect of the present invention. The programmable gain system <b>50</b> includes a plurality of programmable gain amplifier PGA stages <b>52</b>, <b>54</b> and <b>56</b> connected in series between an INPUT and an OUTPUT. A plurality of filters (e.g., high pass filters) <b>58</b>, and <b>60</b> are interleaved in series with the respective PGAs <b>52</b> and <b>54</b> to attenuate upstream signals. An analog equalizer (AEQ) <b>62</b> is coupled between PGA <b>54</b> and PGA <b>56</b>. Each of the filters <b>58</b>, <b>60</b> and possibly the AEQ <b>62</b> implement respective transfer functions for attenuating or emphasizing selected frequency components from the signal path, including noise generated by the respective PGAs <b>52</b>, <b>54</b> and <b>56</b>. The plurality of switches <b>64</b> and <b>66</b> are connected between various points along the signal path of the system <b>50</b> for selectively monitoring and/or isolating selected gain stages including the PGAs <b>52</b>, <b>54</b> and <b>56</b> and the AEQ <b>62</b>.</p>
<p id="p-0032" num="0031">A digital signal processor (DSP) <b>68</b> is coupled to each of the respective PGAs <b>52</b>, <b>54</b> and <b>56</b> and the AEQ <b>62</b>. The DSP <b>68</b> is also connected to the respective switches <b>64</b> and <b>66</b>. The DSP <b>68</b> is programmed to implement an automatic gain control algorithm (AGC) <b>70</b>. The DSP <b>68</b> employs the AGC algorithm <b>70</b> to configure the gain for each of the respective PGAs <b>52</b>, <b>54</b> and <b>56</b> and the AEQ <b>62</b>, such as in connection with a training process for the system <b>50</b>. To facilitate setting the gains for the each of the respective PGAs <b>52</b>, <b>54</b> and <b>56</b> and the AEQ <b>62</b>, the DSP <b>68</b> can control the switches <b>64</b> and <b>66</b> to selectively isolate different stages of the system <b>50</b>.</p>
<p id="p-0033" num="0032">As an example, the system <b>50</b> can be implemented as part of an analog front end that forms at least part of a receiver in a digital subscriber line (DSL) modem. The DSP <b>68</b> employs the AGC algorithm <b>70</b> according to the received time domain INPUT signal at the INPUT and determines appropriate gain settings for each of the respective gain stages <b>52</b>, <b>54</b> and <b>56</b> by measuring the RMS (Root Mean Square) of the INPUT signal. For instance, during a training sequence, such as defined by ITU standard G.992.1, a client modem of which the system <b>50</b> is being implemented can transmit a signal REVERB (e.g., REVERB<b>1</b>, REVERB<b>2</b>, REVERB<b>3</b>) and receive a corresponding REVERB.</p>
<p id="p-0034" num="0033">As part of the training sequence, the AGC algorithm <b>70</b> sets the gains of the PGAs <b>52</b>, <b>54</b>, <b>56</b> and the AEQ <b>62</b> in the order according to the noise dominance of the respective stages (e.g., the relative effectiveness in reducing dominant noise in the system <b>50</b>). The noise dominance of the respective stages <b>52</b>, <b>54</b>, <b>56</b> and <b>62</b> can be determined by performing offline simulation, by implementing online modem diagnostics as well as according to known process corners, which also may be derived from design data. Those skilled in the art may understand and appreciate other ways in which relative noise dominance between the respective stages <b>52</b>, <b>54</b>, <b>56</b> and <b>62</b> can be characterized based on the teachings contained herein.</p>
<p id="p-0035" num="0034">In one example, noise dominance can be ascertained from an input referred received noise floor for the system <b>50</b> over various gain settings of the respective stages <b>52</b>, <b>54</b>, <b>56</b> and <b>62</b>. Examples of selected noise characteristics referred to the system input for the system <b>50</b> are depicted in <figref idref="DRAWINGS">FIGS. 3</figref>, <b>4</b>, and <b>5</b>. While, for ease of explanation, three such graphs are depicted in <figref idref="DRAWINGS">FIGS. 3</figref>, <b>4</b>, and <b>5</b>, those skilled in the art will understand and appreciate that typically a greater number of plots over an increased number of gain settings are utilized to ascertain relative noise dominance among the respective stages <b>52</b>, <b>54</b>, <b>56</b> and <b>62</b>.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 3</figref> depicts a plot of the input referred noise floor for various gain settings for the PGA <b>52</b> that is shown in <figref idref="DRAWINGS">FIG. 2</figref>. In particular, <figref idref="DRAWINGS">FIG. 3</figref> depicts the noise as a function of frequency for five incremental gain settings of the PGA <b>52</b> (<figref idref="DRAWINGS">FIG. 2</figref>). For example, a first curve <b>80</b> depicts an input referred received noise floor for a gain setting of −15 dB for the PGA <b>52</b>, curve <b>82</b> represents the noise floor for a 0 dB gain setting, curve <b>84</b> represents the noise floor for a 9 dB gain setting, curve <b>86</b> represents the noise floor for an 18 dB gain setting, and curve <b>88</b> represents the noise floor for a 27 dB gain setting. For each of the curves <b>80</b> through <b>88</b> shown in <figref idref="DRAWINGS">FIG. 3</figref>, the other PGAs <b>54</b> and <b>56</b> in the system <b>50</b> of <figref idref="DRAWINGS">FIG. 2</figref> were provided with a fixed 0 dB gain, and the AEQ is set to a fixed gain setting of 25 dB per MHz.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIGS. 4 and 5</figref> depict the input referred noise floor for different noise-contributing components in the system <b>50</b> according to two example gain settings for the AEQ <b>62</b> and fixed gain settings for PGAs <b>52</b>, <b>54</b> and <b>56</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>. <figref idref="DRAWINGS">FIG. 4</figref> includes a set of curves <b>90</b>, <b>92</b>, <b>94</b>, <b>96</b> and <b>98</b> corresponding to input referred received noise floors associated with various components for an AEQ setting of 0 dB per MHz. In particular, the curve <b>90</b> represents the noise floor for the total received noise, such as at the INPUT signal provided to the filter <b>58</b>. Curve <b>92</b> represents the noise floor for an ADC referred to the system input with some gain settings for PGAs <b>52</b>, <b>54</b>, <b>56</b> and AEQ <b>62</b> (e.g., 0 dB per MHz). The curves <b>94</b> and <b>96</b> represent input referred received noise floors associated with the respective filters <b>58</b> and <b>60</b> for the system of <figref idref="DRAWINGS">FIG. 2</figref>. The input referred received noise floor for the AEQ <b>62</b> is represented by curve <b>98</b> in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0038" num="0037">In <figref idref="DRAWINGS">FIG. 5</figref>, the input referred received noise floor associated with various components is depicted as curves <b>100</b>, <b>102</b>, <b>104</b>, <b>106</b> and <b>108</b> for an AEQ setting of 25 dB per MHz. The set of curves <b>100</b>, <b>102</b>, <b>104</b>, <b>106</b> and <b>108</b> are analogous to the curves <b>90</b>, <b>92</b>, <b>94</b>, <b>96</b> and <b>98</b> in <figref idref="DRAWINGS">FIG. 4</figref>. In <figref idref="DRAWINGS">FIG. 5</figref>, curve <b>100</b> corresponds to the input referred received noise floor for the total received noise. The curve <b>102</b> represents the input referred received noise floor associated with the ADC. Curves <b>104</b> and <b>106</b> represent the input referred received noise floor associated with the respective filters <b>58</b> and <b>60</b>. Finally, the input referred received noise floor associated with the AEQ <b>62</b> is represented by the curve <b>108</b>. A comparison of <figref idref="DRAWINGS">FIGS. 4 and 5</figref> demonstrates that the input referred received noise floor associated with the ADC, which is depicted as curve <b>92</b> in <figref idref="DRAWINGS">FIG. 4</figref> and as curve <b>102</b> in <figref idref="DRAWINGS">FIG. 5</figref>, becomes a non-dominating source for the case of <figref idref="DRAWINGS">FIG. 5</figref> in which the AEQ setting is at 25 dB per MHz.</p>
<p id="p-0039" num="0038">Those skilled in the art will understand and appreciate that different stages can have different effects on the overall received noise floor. A maximum amount of gain can be applied to a system depending on the received signal, echo signal or both depending on channel conditions. Therefore, as the gain of one stages varied the distribution of gains between the respective stages <b>52</b>, <b>54</b>, <b>56</b> and <b>62</b> can affect the overall noise floor. Accordingly, the AGC algorithm <b>70</b> in <figref idref="DRAWINGS">FIG. 2</figref> is programmed so as to set the gain for the respective stages for achieving an optimal gain, with order for the stages selected according to the noise relative contributions and noise characteristics of the respective stages.</p>
<p id="p-0040" num="0039">The following example assumes that the ADC at the output of the PGA <b>56</b> and the PGA <b>52</b> represent dominant noise sources, such as based on an analysis of noise characteristics (e.g., including the noise floor information provided by <figref idref="DRAWINGS">FIGS. 3-5</figref>). The AGC algorithm <b>70</b> configures the gain stages that are most effective on dominant noise sources, namely AEQ <b>62</b> and the PGA <b>52</b>, before setting gains for the non-dominant noise sources, PGAs <b>54</b> and <b>56</b>. The AGC algorithm <b>70</b> is pre-programmed with parameters that enable the AGC algorithm to set gains for the AEQ <b>62</b> and the PGAs <b>52</b>-<b>56</b> so that a maximum hardware capacity can be achieved. The parameters can include a gain limit value for the AEQ <b>62</b> and a RMS threshold value for the PGA stages <b>52</b>-<b>56</b>. Some or all of such parameters can be determined as part of an offline process. For instance, the RMS threshold can be ascertained by the modem developer and the gain limit value can be determined in an offline design process.</p>
<p id="p-0041" num="0040">By way of example, a gain limit (GMaxLimit) for the AEQ can be determined by simulation with a design for the system <b>50</b> over a plurality of test cases. The set of test cases can be derived to implementing the system <b>50</b> in a set of N representative test loops and include M analog process corners over K AEQ hardware settings, where each of N, M and K are positive integers (N denoting the number of test loops, M denoting the number of process corners and K denoting the number of AEQ settings).</p>
<p id="p-0042" num="0041">For each test loop and analog process corner, a hardware capacity, denoted by R<sub>n </sub>(i) kbps, is determined for each AEQ setting. An AEQ gain G<sub>n </sub>(i)dB also is determined for each test case, where i represents an incremental AEQ setting and n denotes the test case number. The test loop number and analog process corner can be combined and represented by a corresponding test case number. For example, if there are 5 test loops and 4 analog process corner, then there will be 20 test cases (n=20).</p>
<p id="p-0043" num="0042">The simulations can be performed for the set of AEQ settings for each test case. For instance, the process can be implementing by initializing the AEQ <b>62</b> to its minimum hardware setting. PGA <b>52</b> (the next dominant noise source) is selected to meet the predetermined RMS threshold for the initial AEQ setting. Then, PGA <b>54</b> and PGA <b>56</b> (the non-dominant stages) are selected to meet the target RMS threshold, also for the initial AEQ setting. The target RMS can be a predetermined target RMS value or, alternatively, it can be adaptively determined during a configuration process. For each test case, the hardware capacity R<sub>n </sub>(i) can be recorded, such as stored in suitable memory or storage device. After the hardware capacity R<sub>n </sub>(i) has been determined and stored for the initial AEQ setting, the AEQ setting can be incremented (e.g., by one step) and the hardware capacity R<sub>n </sub>(i) be determined based on selecting the other PGAs according to the RMS threshold, as described above. This process can be repeated until the hardware capacity R<sub>n </sub>(i) has been determined for all AEQ settings (ranging from 0 to K) for each test case.</p>
<p id="p-0044" num="0043">After the hardware capacity values have been determined for each of the test cases, a maximum hardware capacity RMax<sub>n </sub>kbps and the corresponding AEQ gain GMax<sub>n </sub>dB can be determined for each test case over the set of K AEQ settings. For example, RMax<sub>n </sub>and GMax<sub>n </sub>can be determined through simulations, which can be represented as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i>Max<sub>n</sub><i>, G</i>Max<sub>n</sub>=max(<i>R</i><sub>n</sub>(<i>i</i>))   Eq. 1<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0044">where: 0≦i&lt;K, where K is a maximum AEQ setting; and
        <ul id="ul0003" list-style="none">
            <li id="ul0003-0001" num="0045">n=positive integer denoting a given test case.
<br/>
For each test case, a selected hardware capacity RSel<sub>n </sub>is also determined as the maximum capacity in which the AEQ gain G<sub>n</sub>(i) is less than a gain limit GLim dB. The gain limit GLim spans from a minimum gain to the maximum gain of GMax<sub>n </sub>for the N test cases with x dB steps. That is, GLim can be expressed as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>GLim</i>(<i>l</i>)=min(<i>G</i>Max<sub>n</sub>)+<i>l×x </i>  Eq. 2<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
        </ul>
        </li>
        <li id="ul0002-0002" num="0046">where l denotes an incremental gain setting for 0≦l≦X,
        <ul id="ul0004" list-style="none">
            <li id="ul0004-0001" num="0047">X denotes the total number of gain steps, and where</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0045" num="0048">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>x</mi>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mrow>
                <mi>max</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Max</mi>
                      <mi>n</mi>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>min</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>G</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>Max</mi>
                      <mi>n</mi>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mi>X</mi>
          </mfrac>
          <mo>⁢</mo>
          <mi>d</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>B</mi>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Eq</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.6em" height="0.6ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>3</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
The selected hardware capacity RSel<sub>n </sub>for each gain setting I can further be expressed as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>RSel</i><sub>n</sub>(<i>l</i>)=max[<i>R</i><sub>n</sub>(<i>i</i>), <i>G</i><sub>n</sub>(<i>i</i>)≦<i>GLim</i>(<i>l</i>)]  Eq. 4<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0046" num="0049">for 0≦i&lt;K, 0≦l≦X.</p>
<p id="p-0047" num="0050">A maximum delta (or difference) DMax(l) between the selected capacity RSel<sub>n </sub>and the maximum capacity for RMax<sub>n </sub>is determined over the N test cases for each gain limit GLim(l). The difference Delta<sub>n</sub>(l) between the selected capacity RSel<sub>n </sub>and the maximum capacity for RMax<sub>n </sub>can be determined for each gain step over the set of N test cases, as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Delta<sub>n</sub>(<i>l</i>)=<i>abs</i>(<i>R</i>Max<sub>n</sub><i>−RSel</i><sub>n</sub>(<i>l</i>))   Eq. 5<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0051">for 0≦l≦X
<br/>
From the foregoing, the maximum delta DMax(l) can be determined as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>D</i>Max(<i>l</i>)=max[Delta<sub>n</sub>(<i>l</i>)]  Eq. 6<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
        <li id="ul0006-0002" num="0052">for 0≦l≦X</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0048" num="0053">The maximum gain limit GMaxLim for the AEQ <b>62</b> corresponds to the maximum AEQ gain limit GLim that provides a minimum value for the maximum delta DMax(l), which can be expressed as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>G</i>Max<i>Lim=GLim</i>(<i>l</i>), min[<i>D</i>Max(<i>l</i>)].   Eq. 7<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0049" num="0054">The AGC <b>70</b> is further programmed to perform training based on the maximum gain limit GMaxLim and one or more other parameters, including, the RMS threshold (e.g., target RMS). The AGC algorithm <b>70</b> utilizes these parameters during a training sequence to set gains for the AEQ <b>62</b> and the PGAs <b>52</b> through <b>56</b>. An order for configuring and training the respective programmable gain stages <b>52</b> through <b>56</b> and <b>62</b> is determined based on relative noise dominance of the respective components, such as described herein. For purposes of explanation and by way of example, the following order is employed: AEQ <b>62</b> first, the PGA <b>52</b> next, which are then followed by the non-dominant stages including the PGAs <b>54</b> and <b>56</b>. The particular order of the remaining PGAs <b>54</b> and <b>56</b> can vary when the noise dominance attributable to such more noise dominant components is relatively insignificant when compared to the noise dominance of the other components <b>52</b> and <b>62</b>. That is, according to this example order, setting the gain of the AEQ <b>62</b> and the PGA <b>52</b> is considered more effective in reducing dominant noise in the system <b>50</b> than the other stages <b>52</b> and <b>62</b>.</p>
<p id="p-0050" num="0055">The AGC algorithm <b>70</b> can be implemented to set gains of the stages <b>52</b>-<b>56</b> and <b>62</b> based on the predetermined parameters, which can include the GMaxLim for the AEQ and RMS thresholds for the PGAs <b>52</b>-<b>56</b>. That is, the AEQ <b>62</b> is configured without exceeding GMaxLim dB. The AGC algorithm <b>70</b> also sets the PGA <b>52</b> to meet the target RMS parameter without saturating such component, such that sufficient headroom is maintained for the AEQ <b>62</b> to meet substantially the maximum gain limit GMaxLim. The other PGAs <b>54</b> and <b>56</b> are selected also to meet the targetRMS. The targetRMS can be set to a value such that the available digital headroom can accommodate the PAR (peak-to-average ratio) difference between REVERB signal (during AGC training) and Showtime signals (e.g., higher PAR during normal operation).</p>
<p id="p-0051" num="0056">By way of further example, the AGC algorithm <b>70</b> can begin a training (or re-training) sequence for distributing gains among the stages <b>52</b>-<b>56</b> and <b>62</b> by initializing all PGAs to their minimum gain settings. Once the stages have been initialized to their minimum settings, the DSP <b>68</b> can employ the AGC algorithm <b>70</b> to measure signal RMS for a number of frames and calculate an average (e.g., median or mean) RMS signal value from the measurements, denoted as X. X thus corresponds to average RMS value for the system <b>50</b> when all gain stages are set to minimum settings. According to the order for noise dominance and to corresponding gain limits mentioned above, the AGC algorithm <b>70</b> then sets the gain for the AEQ <b>62</b> based on measurements performed over range of AEQ settings.</p>
<p id="p-0052" num="0057">For example, the AGC algorithm <b>70</b> can increment to a next AEQ setting and for this setting measure signal RMS for a number of frames. The AGC algorithm <b>70</b> determines an average RMS signal Y for this AEQ setting based on the measurements. The AGC algorithm <b>70</b> determines whether the present gain setting for the AEQ exceeds the maximum gain limit GMaxLim as a function of the average RMS values X and Y. If 20*log10(Y/X)≦GMaxLim dB and the AEQ setting is not at maximum hardware setting, the AGC algorithm <b>70</b> can increment a step to a next AEQ setting. The AGC algorithm <b>70</b> can then measure signal RMS for a number of frames at this next incremental AEQ setting and determine a corresponding average RMS value Y. The AGC algorithm <b>70</b> can repeat this loop until an AEQ setting provides an average RMS value Y that meets the condition 20*log10(Y/X)&gt;GMaxLim dB. If the GMaxLim is exceeded, the AGC algorithm <b>70</b> can decrement the AEQ setting by one incremental step, to provide an AEQ setting that affords a maximum hardware capacity for the system <b>50</b>. After the AEQ <b>62</b> has been configured to such setting, the remaining stages can be configured in order of their relative ability to reduce dominant noise (e.g., PGA <b>52</b>, followed by PGAs <b>54</b> and <b>56</b>). Alternatively or additionally, a parameter of the AEQ <b>62</b>, such as channel slope, can be configured based on the comparison.</p>
<p id="p-0053" num="0058">The AGC algorithm <b>70</b> thus increments a PGA setting for the PGA <b>52</b> and measure the signal RMS for a number of frames at this setting. The AGC algorithm <b>70</b> then determines an averageRMS value based on the measurements. The AGC algorithm <b>70</b> ascertains whether the averageRMS value is within an expected operating parameter, namely the targetRMS (described above). For example, so long as averageRMS≦targetRMS and PGA setting is not at maximum hardware setting, the AGC algorithm repeats the foregoing process by incrementing the PGA setting for the PGA <b>52</b>, measuring the signal RMS and determining a corresponding averageRMS value. If averageRMS&gt;targetRMS, however, the AGC algorithm decrements PGA setting to a previous (e.g., lower) setting to complete selection and configuration of the PGA <b>52</b>. The AGC algorithm <b>70</b> can perform a similar process to set gains for the remaining PGAs <b>54</b> and <b>56</b>.</p>
<p id="p-0054" num="0059">Those skilled in the art will understand and appreciate that the adaptation of the PGA stage, described above, can be repeated for multiple iterations if necessary. In the example described above, the first PGA stage <b>52</b> and the AEQ <b>62</b> have the most effect on the dominant noise in the receive path. Accordingly, multiple (e.g. two) iterations can be applied to selection of the PGA <b>52</b>. For example, during the first iteration, the AGC algorithm <b>70</b> can set the PGA <b>52</b> to a maximum setting without saturation at the output of the PGA <b>52</b>. During the second iteration, the AGC algorithm <b>70</b> sets the PGA <b>52</b> so that, when AEQ gain is set to GMaxLim dB, the receive signal RMS (including all stages) at AEQ output does not exceed targetRMS and the PGA <b>52</b> does not exceed the maximum gain setting (determined in first iteration). In this way, the GMaxLim dB required for the AEQ <b>62</b> will be mostly sacrificed by PGA <b>54</b> instead of PGA <b>52</b>.</p>
<p id="p-0055" num="0060"><figref idref="DRAWINGS">FIGS. 6</figref>, <b>7</b>, and <b>8</b> depict methods that can be performed in connection with implementing automatic gain control for a multi-stage system according to an aspect of the present invention. While, for purposes of simplicity of explanation, the methodologies are shown and described as executing serially, it is to be understood and appreciated that the present invention is not limited by the orders shown, as some aspects may, in accordance with the present invention, occur in different orders or concurrently from that shown and described herein. Moreover, not all features shown or described may be needed to implement a method in accordance with the present invention. Additionally, such methods can be implemented in hardware (e.g., analog circuitry, digital circuitry or a combination thereof), software (e.g., running on a DSP or ASIC) or a combination of hardware and software. Those skilled in the art will understand how to program appropriate components (e.g., a DSP implemented in a DSL modem) to implement the methods based on the teachings contained herein.</p>
<p id="p-0056" num="0061"><figref idref="DRAWINGS">FIG. 6</figref> depicts a flow diagram for an example method <b>200</b> that can be performed to configure a programmable gain system. The programmable gain system includes a plurality of stages, such as may be interleaved with one or more filters. The method <b>200</b> begins at <b>210</b> after a circuit design for the programmable gain system has been developed. Associated design data or a model for the design can also be provided (e.g., by the developer) for the programmable gain system, which design data can characterize system components, interconnectivity and operating parameters to achieve maximum hardware capacity thereof. The design data can also characterize process variations for the design, such as part-to-part variations and process corners.</p>
<p id="p-0057" num="0062">At <b>220</b>, relative noise dominance is determined for the plurality of stages. The noise dominance, for example, can be determined by evaluating input referred noise floors associated with the various stages of the multi-stage system, and determining which stages have a greater effect on the dominant noise in the signal path. An order for configuring the plurality of stages thus can be established. At <b>230</b>, simulations can be performed for a plurality of test cases. The simulations can be implemented based on the design data to ascertain parameter limits for establishing operating characteristics for each of the plurality of stages. As described herein, the plurality of stages can include programmable gain stages as well as an analog equalizer, also having an associated gain. At <b>240</b>, a gain limit is determined based on the simulations performed at <b>230</b>. The gain limit (see, e.g., GMaxLim of Eq. 7) corresponds to a gain for an analog equalizer that maximizes hardware capacity and minimizes a maximum delta (see, e.g., DMax(l) of Eq. 6) for a hardware capacity.</p>
<p id="p-0058" num="0063">At <b>250</b>, a target RMS value is determined for the entire system. The target RMS can be determined to be a target RMS value. For the example of a DSL communications protocol, the target RMS value can correspond to a signal value, such that the available digital headroom can accommodate peak-to-average ratio differences between the REVERB signals and Showtime signals.</p>
<p id="p-0059" num="0064">At <b>260</b>, the various stages are set during a training process. The training process is implemented on stages selected according to an order determined at <b>220</b> based on the relative noise dominance of the stages. For example, the stages can be configured an order beginning with the stage(s) most effective to reduce dominant noise and ending with the stage(s) having the least effect on noise. After the more noise dominant stages have been successfully configured, the remaining less noise dominant stages can be programmed. The result is a multi-stage gain system configured to operate at a maximum hardware capacity that also mitigates part-to-part variations.</p>
<p id="p-0060" num="0065"><figref idref="DRAWINGS">FIG. 7</figref> depicts an example of a method <b>300</b> that can be utilized to establish a maximum gain limit for configuring the most effective stage (or stages), an analog equalizer (AEQ). The method <b>300</b> begins at <b>310</b> in which test parameters are defined. The test parameters, for example, can include identifying a number of test cases. The test cases can vary based on a number of test loops, a number of analog process corners and a number of available hardware settings for the AEQ.</p>
<p id="p-0061" num="0066">At <b>320</b>, the AEQ is set to an initial setting Setting<sub>K</sub>, where K is an integer denoting an incremental gain setting for the AEQ. At <b>330</b>, the stages are configured, such as to meet a target threshold. At <b>340</b>, the hardware capacity (e.g., data rate) of the system is measured and stored for the corresponding test case. At <b>350</b>, a determination is made as to whether any additional AEQ settings exist. If additional AEQ settings do exist (YES), the method proceeds to <b>360</b>. At <b>360</b>, the incremental variable K is incremented and the method returns to <b>320</b> for repeating <b>320</b> through <b>350</b> for the next AEQ setting (e.g, K=K+1). If no additional AEQ settings exist (NO), the method proceeds from <b>350</b> to <b>370</b>.</p>
<p id="p-0062" num="0067">At <b>370</b>, a maximum hardware capacity RMAX and MAX gain are determined for each of the test cases. It is to be appreciated that the determination of the capacity and gain for the respective test cases, alternatively, may be determined as part of the loop from <b>320</b> to <b>360</b>. At <b>380</b>, a selected maximum hardware capacity RSEL is determined for a condition when the AEQ setting is less than a gain threshold determined for each of the test cases. The gain threshold, for example, spans from the minimum to the maximum of the maximum gain limit for the respective test case.</p>
<p id="p-0063" num="0068">At <b>390</b>, a maximum difference between the RMAX and RSEL is determined for each of the respective test cases. At <b>400</b>, a maximum gain limit is determined for the AEQ the maximum gain limit thus defines a value for the AEQ setting that minimizes the maximum difference determined at <b>390</b>.</p>
<p id="p-0064" num="0069"><figref idref="DRAWINGS">FIG. 8</figref> depicts a method <b>450</b> that can be utilized to program a multi-stage system, such as the systems shown and described herein. The method <b>450</b> begins at <b>460</b> in which training parameters are defined. The training parameters can include a maximum gain limit for an analog equalizer (AEQ) as well as a target RMS value associated with a plurality of programmable gain stages. The training parameters can also include available ranges of incremental gain settings for each of the respective stages in the multi-stage system. The parameters can be determined as part of an offline process, although some (or all) parameters could also be determined or adjusted based on the context in which the system is being implemented.</p>
<p id="p-0065" num="0070">At <b>480</b>, an order is set for the various stages, which order varies depending on the relative noise dominance for each of the respective stages. The noise dominance of one or more stages can be determined by online measurements or based on previous measurements or design data. At <b>490</b>, each of the stages is set to its initial settings, which can include the minimum incremental settings for the respective stages. At <b>500</b>, a signal RMS for the respective stages is measured such as for a plurality of frames. An average RMS value is then determined based on the signal RMS measurements. For a multi-stage system that does not include an analog equalizer, the measurements and determination of the average RMS value for the minimal gain settings can be omitted from the method <b>450</b>. At <b>510</b>, the hardware setting (SETTING<sub>i</sub>) for the respective stage (STAGE<sub>j</sub>) being configured is incremented to a next incremental setting at <b>510</b>, where i denotes an incremental setting and j denotes a selected stage. The signal RMS is then measured and a corresponding RMS value (RMS<sub>ij</sub>) is determined for the current SETTING<sub>i </sub>and STAGE<sub>j</sub>. The signal RMS<sub>ij </sub>value for the current SETTING<sub>i </sub>and STAGE<sub>j </sub>can be an average signal value, such as a mean or median value.</p>
<p id="p-0066" num="0071">At <b>530</b>, a determination is made as to whether the average RMS value (RMS<sub>ij</sub>) is within an expected operating parameter for such stage (such as defined at <b>460</b>). If the determination at <b>530</b> is negative, the method returns to <b>510</b> in which the setting (SETTING<sub>i</sub>) for the present STAGE<sub>j </sub>(according to the order) is incremented to its next hardware setting (i=i+1). At <b>530</b>, if the average RMS is determined to be within the expected maximum operating parameter (YES), the methodology proceeds to <b>540</b>. At <b>540</b>, a determination is made as to whether any additional stages need to be configured during the training sequence. If additional stages do exist (YES), the method proceeds to <b>550</b> in which the next stage is selected (e.g., by incrementing j=j+1) for training according to the order set at <b>480</b>.</p>
<p id="p-0067" num="0072">From <b>550</b> the method <b>450</b> returns to <b>510</b> to repeat <b>510</b> through <b>540</b> for the next stage STAGE<sub>j </sub>in the order. In this way, each stage is configured such that the most noise dominant stages are set first. The interdependence and distribution of gains for the respective stages thus can be programmed to maximize hardware capacity as well as to minimize analog process variations associated with the multi-stage system. After each of the stages has been appropriately configured, the methodology ends at <b>560</b>. The method <b>450</b> can be repeated periodically, such as for retraining the multi-stage system. For the example when the method <b>450</b> is utilized for training a multi-stage system implemented in a receive path of a DSL modem, the retraining can be performed to accommodate changes in loop characteristics.</p>
<p id="p-0068" num="0073">What have been described above are examples of the present invention. It is, of course, not possible to describe every conceivable combination of components or methodologies for purposes of describing the present invention, but one of ordinary skill in the art will recognize that many further combinations and permutations of the present invention are possible. For example, while the systems and methods herein have generally been described in the context of modems for digital subscriber lines, the systems and methods can be applied to various other types of systems employing multi-stage amplifiers. Accordingly, the present invention is intended to embrace all such alterations, modifications, and variations that fall within the spirit and scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298207-20071120-M00001.NB">
<img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US07298207-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for providing automatic gain control of a multi-stage system, comprising:
<claim-text>defining at least one parameter associated with at least some of a plurality of gain stages of the multi-stage system;</claim-text>
<claim-text>selecting an order for training the plurality of stages based on relative noise dominance for the plurality of stages;</claim-text>
<claim-text>for a given stage of the plurality of stages selected according to the selected order, at least one given stage comprising an analog equalizer having a programmable gain setting which can vary as a function of frequency;</claim-text>
<claim-text>training the analog equalizer stage using a criterion based on power gain;</claim-text>
<claim-text>measuring output signals of the multi-stage system over a plurality of gain settings for the given stage; and</claim-text>
<claim-text>configuring a gain setting of the given stage of the multi-stage system based on the measured output signals relative to the at least one parameter defined for the given stage, wherein the defined parameter for the analog equalizer comprising a maximum gain limit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the measuring and the configuring are performed for each of the plurality of stages according to the selected order.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the configuring is performed to distribute gain among the plurality of stages according to a relative effectiveness of each of the plurality of stages to reduce noise in a path that includes the multi-stage system.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the maximum gain limit is determined based on simulations performed on a design of the multi-stage system over a plurality of test cases, the maximum gain limit being operative to at least one of maximize the hardware capacity and mitigate part-to-part variations of the multi-stage system.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the measuring and configuring further comprise:
<claim-text>incrementing the gain setting of the analog equalizer to a next gain setting;</claim-text>
<claim-text>measuring the output signal values of the multi-stage system over a plurality of frames;</claim-text>
<claim-text>determining an average signal value for the multi-stage system based on the measured signal values for the analog equalizer at the next gain setting;</claim-text>
<claim-text>comparing the maximum gain limit relative to a value functionally related to the average signal value; and</claim-text>
<claim-text>setting at least one of the gain setting and a channel slope of the analog equalizer based on the comparison.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the value functionally related to the average signal value comprises a logarithmic function proportional to the average signal value associated with the next gain setting and an average signal value of the multistage system associated with the plurality of stages when set at respective minimum gain settings.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the given stage further comprises at least one other gain stage having a programmable gain setting, the defined parameter for the at least one other gain stage comprising a target threshold value for the output signal.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the target threshold comprises a target RMS (root mean square) threshold for the output signal.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the measuring and configuring further comprise:
<claim-text>measuring RMS (root mean square) signal values for the output signals of the multi-stage system over a plurality of frames for at least a portion of the plurality of gain settings of the at least one other gain stage;</claim-text>
<claim-text>determining average RMS values for the output signals associated with each of the at least a portion of the plurality of gain settings; and</claim-text>
<claim-text>setting the gain setting of the at least one other gain stage based on the average RMS values relative to the target threshold value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A digital signal processor programmed to perform an automatic gain control algorithm for a plurality of gain stages of a multi-stage gain system, the automatic gain control algorithm comprising:
<claim-text>selecting an order for training the plurality of stages of the multi-stage system based on relative noise dominance among the plurality of stages;</claim-text>
<claim-text>configuring each of the plurality of stages according to the selected order, the configuring of a given stage of the plurality of stages, wherein at least one given stage comprising an analog equalizer having a programmable gain setting which can vary as a function of frequency, comprising:
<claim-text>training the analog equalizer stage using a criterion based on power gain;</claim-text>
<claim-text>incrementing a gain setting for the given stage;</claim-text>
<claim-text>measuring output signals over a plurality of frames at the incremented gain setting of the given stage;</claim-text>
<claim-text>evaluating the measured output signals relative to a parameter limit defined for the given stage for the incremented gain setting for the given stage, wherein the predetermined parameter limit associated with the analog equalizer comprising a maximum gain limit;</claim-text>
<claim-text>repeating the incrementing, measuring and evaluating for a next gain setting of the given stage based on the evaluation; and</claim-text>
<claim-text>setting the gain setting of the given stage based on determining that the incremented gain setting affords a maximum hardware capacity for the given stage.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The digital signal processor of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the configuring of the analog equalizer further comprise:
<claim-text>measuring output signal values of the multi-stage system over a plurality of frames for the incremented gain setting of the analog equalizer;</claim-text>
<claim-text>determining an average output signal value for the multi-stage system based on the measured output signal values associated with the incremented gain setting of the analog equalizer;</claim-text>
<claim-text>comparing the maximum gain limit relative to a value functionally related to the average signal value; and</claim-text>
<claim-text>setting the gain setting of the analog equalizer based on the comparison.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The digital signal processor of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein, prior to the configuring of the given stage, the automatic gain control algorithm further comprises:
<claim-text>measuring output signal values of the multi-stage system over a plurality of frames with the plurality of stages at respective initial gain settings; and</claim-text>
<claim-text>determining an average signal value of the multi-stage system for the initialized gain settings, the value functionally related to the average signal value comprising a logarithmic function comprising a ratio of the average signal value of the multi-stage system associated with the incremented gain setting of the analog equalizer and the average signal value of the multi-stage system associated with the initial gain settings.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The digital signal processor of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the given stage further comprises at least one programmable gain amplifier having a programmable gain setting, the parameter limit for the at least one programmable gain amplifier comprising a target threshold value for the output signal.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The digital signal processor of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the given stage further comprises at least one programmable gain amplifier having a programmable gain setting, the parameter limit for the at least one programmable gain amplifier comprising a target threshold value for the output signal.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The digital signal processor of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the target threshold comprises a target value for the output signal of the multi-stage gain system.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The digital signal processor of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the configuring of the at least one programmable gain amplifier further comprises:
<claim-text>measuring output signal RMS (root mean square) values of the multi-stage system over a plurality of frames for at least a portion of the plurality of gain settings of the at least one programmable gain amplifier;</claim-text>
<claim-text>determining an average RMS value for the output signal associated with each of the at least a portion of the plurality of gain settings; and</claim-text>
<claim-text>setting the gain setting of the at least one programmable gain amplifier based on the average RMS value relative to the target threshold value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The digital signal processor of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the gain setting of each of the plurality of stages is set so that gain is distributed among the plurality of stages according to a relative effectiveness of each of the plurality of stages to reduce noise in a path that includes the multi-stage gain system.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A programmable gain system, comprising:
<claim-text>a plurality of serially coupled stages, each of the plurality of gain stages having an associated programmable gain setting, wherein at least one of the plurality of pain stages comprises an analog equalizer having a programmable gain setting which can vary as a function of frequency and at least one other stage of the plurality of gain stages comprises a programmable gain amplifier; and</claim-text>
<claim-text>a control system that, during a training phase, sets the associated gain setting of each of the plurality of gain stages in an order, the associated gain setting being set to maximize hardware capacity and to mitigate part-to-part variation in the gain system based on at least one predetermined parameter, the pain the analog equalizer stage is set using a criterion based on power gain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The programmable gain system of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein the control system comprises a digital signal processor programmed with an automatic gain control algorithm to set the associated gain settings of the plurality of gain stages, the automatic gain control algorithm operating to set the gain of each stage in the order, which is determined according to relative noise dominance of the plurality of gain stages.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The programmable gain system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising a switch system that includes at least one switch connected to at least one node along a path defined by the plurality of gain stages, the digital signal processor controlling the switch system for, according to the automatic gain control algorithm, measuring signal characteristics of a selected portion of the path during the training phase.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The programmable gain system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising at least one analog filter interleaved in a path that includes the plurality of gain stages.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The programmable gain system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the at least one parameter associated with the analog equalizer comprises a maximum gain limit for the analog equalizer that affords substantially maximum hardware capacity with reduced part-to-part variations for the gain system.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The programmable gain system of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein the digital signal processor employs the automatic gain control algorithm to configure the analog equalizer by performing a method that comprises:
<claim-text>incrementing a gain setting for the analog equalizer;</claim-text>
<claim-text>measuring output signal values of the multi-stage system over a plurality of frames for the incremented gain setting of the analog equalizer;</claim-text>
<claim-text>determining an average signal value for the multi-stage system based on the measured signal values associated with the incremented gain setting of the analog equalizer;</claim-text>
<claim-text>comparing the maximum gain limit relative to a value functionally related to the average signal value associated with the incremented gain setting of the analog equalizer; and</claim-text>
<claim-text>setting the gain setting of the analog equalizer based on the comparison.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The programmable gain system of <claim-ref idref="CLM-00023">claim 23</claim-ref>, wherein, prior to setting the associated gain settings of the plurality of gain stages, the automatic gain control algorithm performing a method that further comprises:
<claim-text>measuring output signal values of the multi-stage system over a plurality of frames with the plurality of gain stages set at respective initial gain settings; and</claim-text>
<claim-text>determining an average signal value of the multi-stage system for the initial gain settings of the plurality of gain stages, wherein the value functionally related to the average signal value further comprises a logarithmic function comprising a ratio of the average signal value of the multi-stage system associated with the incremented gain setting of the analog equalizer and the average signal value of the multi-stage system associated with the initial gain settings of the plurality of gain stages.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The programmable gain system of <claim-ref idref="CLM-00024">claim 24</claim-ref>, wherein the initial gain settings of the plurality of gain stages further comprise minimum gain settings for each of the plurality of gain stages.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The programmable gain system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the digital signal processor employs the automatic gain control algorithm to configure the at least one other gain stage by performing a method that comprises:
<claim-text>measuring output signal RMS (root mean square) values of the multi-stage system over a plurality of frames for at least a portion of the plurality of gain settings of the at least one other gain stage;</claim-text>
<claim-text>determining an average RMS value for the output signal associated with each of the at least a portion of the plurality of gain settings; and</claim-text>
<claim-text>setting the gain setting of the at least one other gain stage based on the average RMS value relative to a target threshold value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The programmable gain system of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the target threshold value comprises a target RMS value for the output signal.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The programmable gain system of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the automatic gain control algorithm is operative to configure each given stage of the plurality of gain stages according to the order by performing a method that comprises:
<claim-text>incrementing a gain setting for the given stage;</claim-text>
<claim-text>measuring output signals for a plurality of frames with the given stage at the incremented gain setting;</claim-text>
<claim-text>determining whether the incremented gain setting provides a maximum hardware capacity that mitigates part-to-part variations based on the measured output signals relative to the at least one predetermined parameter defined for the given stage;</claim-text>
<claim-text>repeating the incrementing, measuring and determining for a next gain setting of the given stage based on determining that the incremented gain setting does not provide at least the maximum hardware capacity for the given stage; and</claim-text>
<claim-text>setting the gain setting of the given stage based on determining that the incremented gain setting provides at least the maximum hardware capacity for the given stage.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
