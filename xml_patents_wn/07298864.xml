<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298864-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298864</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>09784391</doc-number>
<date>20010215</date>
</document-id>
</application-reference>
<us-application-series-code>09</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1090</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382100</main-classification>
<further-classification>715751</further-classification>
<further-classification>715752</further-classification>
<further-classification>713176</further-classification>
</classification-national>
<invention-title id="d0e53">Digital watermarks as a gateway and control mechanism</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5841978</doc-number>
<kind>A</kind>
<name>Rhoads</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>39520047</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5862260</doc-number>
<kind>A</kind>
<name>Rhoads</name>
<date>19990100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382232</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5956716</doc-number>
<kind>A</kind>
<name>Kenner et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>707 10</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5958005</doc-number>
<kind>A</kind>
<name>Thorne et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709202</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6122403</doc-number>
<kind>A</kind>
<name>Rhoads</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6141753</doc-number>
<kind>A</kind>
<name>Zhao et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713176</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6243480</doc-number>
<kind>B1</kind>
<name>Zhao et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6421070</doc-number>
<kind>B1</kind>
<name>Ramos et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6615348</doc-number>
<kind>B1</kind>
<name>Gibbs</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713162</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6868498</doc-number>
<kind>B1</kind>
<name>Katsikas</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 14</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7000186</doc-number>
<kind>B1</kind>
<name>Gropper et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715537</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2001/0005837</doc-number>
<kind>A1</kind>
<name>Kojo</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2001/0026377</doc-number>
<kind>A1</kind>
<name>Ikegami</name>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>358401</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2001/0056468</doc-number>
<kind>A1</kind>
<name>Okayasu et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2003/0023682</doc-number>
<kind>A1</kind>
<name>Brown et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709204</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>EP</country>
<doc-number>0375138</doc-number>
<kind>A2</kind>
<date>19900600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>EP</country>
<doc-number>1 063 833</doc-number>
<kind>A2</kind>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>EP</country>
<doc-number>1193925</doc-number>
<kind>A2</kind>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>JP</country>
<doc-number>2000-057327</doc-number>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>JP</country>
<doc-number>2003-092605</doc-number>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>WO</country>
<doc-number>WO02/27617</doc-number>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00022">
<othercit>Matsutani et al., “Tghe Construction of Copyright-Protected Image Data”, Technical Report of IEICE, ISEC94-58, Mar. 17, 1995, 20 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>12</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>382100</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713176</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 50- 80</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 62</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  328</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>283112</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>283113</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715751-752</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60183681</doc-number>
<kind>00</kind>
<date>20000219</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20010046069</doc-number>
<kind>A1</kind>
<date>20011129</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Jones</last-name>
<first-name>Kevin C.</first-name>
<address>
<city>Portland</city>
<state>OR</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Digimarc Corporation</orgname>
<role>02</role>
<address>
<city>Beaverton</city>
<state>OR</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Bella</last-name>
<first-name>Matthew C.</first-name>
<department>2624</department>
</primary-examiner>
<assistant-examiner>
<last-name>Patel</last-name>
<first-name>Shefali</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An electronic e-mail system where messages contain information carried by digital watermarks. The digital watermarks are used to control the transmission and/or receipt of documents transmitted over system. The invention can be used to prevent the accidental dissemination of information to unauthorized receivers. Furthermore, while no security system is fool-proof, the present invention helps guards against the intentional, but unauthorized, dissemination of confidential information to unauthorized receivers.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="158.67mm" wi="230.89mm" file="US07298864-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="182.46mm" wi="145.03mm" file="US07298864-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="114.13mm" wi="154.77mm" file="US07298864-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="232.83mm" wi="165.61mm" orientation="landscape" file="US07298864-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="217.34mm" wi="173.31mm" file="US07298864-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATION</heading>
<p id="p-0002" num="0001">Applicant claims priority of co-pending application 60/183,681 filed Feb. 19, 2000 entitled “Digital Watermarks as a Gateway and Control Mechanism”.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to Internet communication and more particularly to using digital watermarks as control elements in Internet communication.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">The Internet presents security challenges to corporations and others who have computers that store confidential information and that have connections to the Internet. Traditionally, documents containing confidential information are marked with a legend or other visual indicia with words such a “CONFIDENTIAL”, “PROPRIETARY”, etc. The presence of these marks alert anyone handling such documents that they should only be transferred outside of company under special precautions. It is relatively difficult and unusual for someone to manually send such a document to an unauthorized receiver inadvertently. However, the use of Internet communication changes the situation.</p>
<p id="p-0005" num="0004">The Internet and electronic mail speeds the communications process; however, the Internet and electronic mail also make it much easier to inadvertently or accidentally send a confidential document to an unauthorized receiver. A single accidental or inadvertent keystroke can have wide ranging unintended consequences. The Internet and other electronic communication systems make it easy to communicate; however, these systems and networks also make it easy to mistakenly or inadvertently send a document to the wrong party.</p>
<heading id="h-0004" level="1">SUMMARY OF THE PRESENT INVENTION</heading>
<p id="p-0006" num="0005">The present invention utilizes digital watermarks to control the transmission and/or receipt of documents transmitted over computer networks such as the Internet. The invention can be used to prevent the accidental dissemination of information to unauthorized receivers. Furthermore, while no security system is fool-proof, the present invention helps guard against the intentional, but unauthorized, dissemination of confidential information to unauthorized receivers.</p>
<p id="p-0007" num="0006">Most electronically transmitted messages contain text. However, electronic mail systems generally allow images (i.e. pictures) or sound bites to be embedded into and form part of a message. For example, a message can contain a “stamp” with the word “confidential” or a message can contain a sound clip with the word “confidential”. An image or sound clip that forms part of an electronic message can carry a digital watermark that can be detected and read by conventional watermark reading programs.</p>
<p id="p-0008" num="0007">The “payload” or digital data in a digital watermark typically has a number of different fields. One or more of these fields can be dedicated to a flags which indicates that the document or image containing the watermark is confidential or otherwise classified and that it should only be disseminated in a particular manor.</p>
<p id="p-0009" num="0008">Typically, e-mail enters a transmission network by way of an e-mail server. Programs that can detect and read watermarks are well known and commercially available. With the present invention, the e-mail server passes each e-mail messages through a watermark detection and reading program prior to sending the message out over a network. If the watermark program detects a watermark, it interrogates certain flag bits to determine how the message should be handled. For example, if the watermark reading program finds that a particular flag is set, it can take action such as alerting both the sender and a network administrator. If the watermark program finds no watermark or finds that a particular flag is not set, the message is sent over the network in a conventional manner. Alternately, the message can be sent only if a particular flag is set.</p>
<p id="p-0010" num="0009">Thus, the present invention can serve as a control mechanism for controlling the dissemination and receipt of electronic messages.</p>
<p id="p-0011" num="0010">Messages and documents also enter the Internet and other electronic networks from servers such as Web servers and FTP servers. In a similar fashion a watermark detection program can interrogate documents on servers such as Web and FTP servers and take action as described above.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE FIGURES</heading>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram with an image containing the words “Confidential”.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 2</figref> is diagram of the fields in a typical watermark.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram of a typical e-mail system.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 4</figref> is a more detailed diagram of the watermark reading and detection program shown in <figref idref="DRAWINGS">FIG. 3</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DESCRIPTION OF PREFERRED EMBODIMENTS</heading>
<p id="p-0016" num="0015">The embodiments of the invention described herein relate to systems for transmitting e-mail messages over the Internet. This first embodiment has the ability to prevent the accidental dissemination of confidential e-mail messages and documents to unauthorized users. That is, the first embodiment of the invention prevents the transmission of confidential e-mail or documents to anyone. An alternate embodiment merely prevent the transmission of confidential documents to “unauthorized” users. That is, if a message is sent to two recipients, one of whom is authorized and one of whom is not authorized, the documents are transmitted to authorized user and not transmitted to unauthorized user. It is very easy to add addressees to an e-mail message. Someone may address an e-mail message which contains confidential information to a large group of people without realizing the one of the addressee is not authorized to receive confidential information. The system of the present invention will prevent such an e-mail from being transmitted to the unauthorized person even though the sender included the address of that person in the list of addressee. Another alternative embodiment can take a variety of actions such as logging messages or sending them to an administrator in addition to preventing them from being disseminated.</p>
<p id="p-0017" num="0016">A typical confidential document <b>10</b> is represented in <figref idref="DRAWINGS">FIG. 1</figref>. The document <b>10</b> can either be an e-mail message, or alternatively it may be a document that is attached to an e-mail message. The document <b>10</b> includes a confidentiality stamp <b>11</b> and lines of text. The confidentiality stamp <b>11</b> is an image that has the word “confidential” superimposed over a background that has a variety of lines. That is, the background in image <b>11</b> contains lines the width of which are varied to carry a watermark in accordance with the teachings of U.S. application Ser. No. 09/074,034, filed May 6, 1998, now U.S. Pat. No. 6,449,377, (which corresponds to PCT application PCT/US99/08252 (WO99/53428)), and US application Ser. No. 09/127,502, filed Jul. 31, 1998 now U.S. Pat. No. 6,345,104 (which corresponds to PCT application PCT/US99/14532 (WO00/07356)). The disclosures of the above referenced patent applications are hereby incorporated herein in their entireties by reference. Alternatively the background of image <b>11</b> may comprise a weave or tint pattern that carries a watermark. In still another alternative embodiment, instead of having an image <b>11</b> embedded in the message, the message may contain an audio clip with the word confidential. The audio clip would be watermarked using conventional audio watermarking techniques. However, in the first embodiment described herein, the image <b>11</b> has both a human readable word “Confidential” and a digital watermark that can be read by a watermark detection and reading program.</p>
<p id="p-0018" num="0017">The data fields and flags in a typical watermark payload are shown in <figref idref="DRAWINGS">FIG. 2</figref>. It should be understood that the fields and flags shown are merely representative and they can take may alternative forms. The first embodiment of the invention utilizes one of the flag fields to indicate that a particular document is confidential. The other fields can be used in a conventional manner. Alternate embodiments can use a number of flags to indicate actions that should be taken with a particular message.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3</figref> shows a typical e-mail system. A relatively large number of individual user terminal <b>301</b> are connected to an e-mail server <b>302</b>. Only five representative terminals designated <b>301</b><i>a </i>to <b>301</b><i>x </i>are shown for convenience of illustration. The terminals <b>301</b> are connected to server <b>302</b> by conventional connections such as by an Ethernet LAN or by dial up modems. The e-mail server <b>302</b> has a conventional interface <b>303</b> to the Internet and it receives and sends messages from the individual users to the Internet. The e-mail server <b>302</b> is conventional and the details of the e-mail server <b>302</b> forms no part of the present invention. However, with the present invention, before the e-mail server <b>302</b> transmits a message from one of the individual user terminals <b>301</b><i>a </i>to <b>301</b><i>x </i>to the Internet, the e-mail server passes the message through a watermark detection and reading program <b>305</b>. Both the e-mail message itself and any attached documents are passed through the watermark reading program. The watermark detection and reading program <b>305</b> determines if a message contains a watermark. If a watermark is detected, the confidentiality flag bit is interrogated. If the watermark reading program <b>305</b> determines that the flag bit is set to “confidential”, the first embodiment of the invention merely informs the e-mail server <b>302</b> to return the message to the sender. Thus, the first embodiment of the invention prohibits any confidential information from being transmitted as part of an e-mail message.</p>
<p id="p-0020" num="0019">A second embodiment of the invention provides for a wider array of alternative. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the second embodiment of the invention includes a database <b>401</b>. The database <b>401</b> contains a list of different potential message senders, a list showing different groups of potential message recipients, and a set of possible categories indicated by the setting of the various flags in a message. For example, the senders may fall into three groups designated sender groups S<b>1</b>, S<b>2</b> and S<b>3</b>. The potential recipients can fall into three groups designated R<b>1</b>, R<b>2</b>, and R<b>3</b>. The database <b>401</b> and the associated logic <b>402</b> can implement logic rules such as indicated by the following table:</p>
<p id="p-0021" num="0020">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="35pt" align="center"/>
<colspec colname="3" colwidth="35pt" align="center"/>
<colspec colname="4" colwidth="119pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
<row>
<entry>Sender</entry>
<entry>Recipient</entry>
<entry>Flag</entry>
<entry/>
</row>
<row>
<entry>Group</entry>
<entry>Group</entry>
<entry>Conditions</entry>
<entry>Action</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>S1</entry>
<entry>R1</entry>
<entry>011</entry>
<entry>Send message</entry>
</row>
<row>
<entry>S1</entry>
<entry>R2</entry>
<entry>110</entry>
<entry>Do not sent message notify the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>administrator</entry>
</row>
<row>
<entry>S1</entry>
<entry>R2</entry>
<entry>001</entry>
<entry>Send message, and log fact that S1 sent</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>a message to R2.</entry>
</row>
<row>
<entry>S1</entry>
<entry>R2</entry>
<entry>101</entry>
<entry>Return message to sender</entry>
</row>
<row>
<entry>S2</entry>
<entry>R1</entry>
<entry>011</entry>
<entry>Send message</entry>
</row>
<row>
<entry>S2</entry>
<entry>R3</entry>
<entry>110</entry>
<entry>Do not sent message and notify the</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>system administrator</entry>
</row>
<row>
<entry namest="1" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0022" num="0021">It should be clearly noted that the above is merely a simplified example of the rules and combinations that could be in database <b>401</b>. The database could include hundreds or thousands of users and it could include dozens of rules. The system can be complex or simple as desired for a particular application. A system can include many alternatives in addition to those shown above or a system might include only a very few alternatives. For example, the system could include only a list of addresses which are authorized to receive messages which have a confidentiality flag set to “confidential”. Such a system would allow confidential documents to be only sent to selected addresses. Alternatively or in addition the system could include a list of individuals authorized to send confidential documents. The system could merely check the sender against this list or alternatively, the system could require that a password be entered when such messages are encountered. The table above shows only three flag bits. A system could have more or less flag bits as the needs of the particular system require.</p>
<p id="p-0023" num="0022">The import point is that the system considers the message sender, the message recipient and the condition of the flags in the data carried by a digital watermark to determine what action should be taken. The digital watermark can be carried by the message using any of the known ways of watermarking a document. For example, it can be carried by modulating the width of lines or by modulating the luminosity of pixels in an image or by a watermark in audio data.</p>
<p id="p-0024" num="0023">In alternate embodiments of the invention, the confidentiality stamp could include a watermark in an image by means other than using line width modulation as described with respect to the first embodiment of the invention. The background of the stamp could include a conventional image carrying a conventional watermark.</p>
<p id="p-0025" num="0024">In an alternative embodiment of the invention, rather than checking for a digital watermark, the system could check for a text string such as “confidential” and take action in response to locating such a text string.</p>
<p id="p-0026" num="0025">The above described embodiments relate to controlling the dissemination of information; however, it should be understood that the invention could be applied in similar manner to control the receipt of confidential information or to control the action taken when messages containing watermarks are received.</p>
<p id="p-0027" num="0026">While the previously described embodiments apply to e-mail systems, similar precautions could be taken with FTP servers or with Web servers.</p>
<p id="p-0028" num="0027">While the invention has been shown and described with respect to various preferred embodiments, it should be understood that various changes in form and detail could be made without departing from the scope and spirit of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>I claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An electronic messaging system including a mail server which sends and receives messages, said mail server including a watermark reading program that reads watermarks in said messages, the program operable to read watermarks in documents that form at least part of the messages and operable to read watermarks in documents attached to the messages, and the program operable to control distribution of said messages in response to data in said watermarks.</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A system that includes an e-mail server connected to the Internet, the system comprising:
<claim-text>means for transmitting messages from an individual user to said e-mail server, watermark detecting means for detecting and reading watermarks in e-mail messages at the server after the messages are sent from the user but before such messages are transmitted from said e-mail server to the Internet,</claim-text>
<claim-text>means for preventing the transmission of messages from said e-mail server to the Internet if said watermark detecting means detects a watermark which has an indication that the message including said watermark is confidential.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A system for controlling the distribution of electronic messages that include confidential information, each electronic message having confidential information including a digital watermark carrying data that indicates that the message is confidential, a server which transmits and receives messages, said server including a watermark reading program that reads watermarks in messages and controls the distribution of such messages in accordance with the data carried by watermarks in the messages, the program operable to read watermarks in documents that form at least part of the messages and operable to read watermarks in documents attached to the messages.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The system recited in <claim-ref idref="CLM-00003">claim 3</claim-ref> where the messages are transmitted over the Internet.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method of controlling the distribution of electronic messages that include confidential information, said messages carrying digital watermarks that carry data indicating that the message includes confidential information,
<claim-text>passing messages to a watermark detecting process prior to transmission of said messages including passing documents in and attached to the messages to the watermark detecting process for detecting watermarks in the documents, and</claim-text>
<claim-text>controlling the distribution of an electronic message which includes a watermark in response to the data carried by the watermark in the message.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method recited in <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein said messages are transmitted over the Internet.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method recited in <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein a database is interrogated to determine an action to take with a particular message based at least in part on the data carried by the watermark.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method recited in <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the action taken with respect to a particular message is dependent on the identity of the sender, the identity of the receiver and information carried by the watermark.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method recited in <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein an action taken with respect to a particular message is dependent on the identity of the sender, the identity of the receiver, information carried by the watermark, and information stored in a database.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A method of transmitting electronic messages from a sender to a receiver which comprises,
<claim-text>detecting and reading digital watermarks carried in such messages to determine how flags in such watermarks are set,</claim-text>
<claim-text>interrogating a database to determine what action should be taken with a message based upon the identity of the sender, the identity of the receiver and the flag settings in the watermark in the message.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method recited in <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein said messages are transmitted over the Internet.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method recited in <claim-ref idref="CLM-00010">claim 10</claim-ref> where the data carried by said watermark indicates if the message includes confidential information.</claim-text>
</claim>
</claims>
</us-patent-grant>
