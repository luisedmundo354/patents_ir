<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298915-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298915</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10835766</doc-number>
<date>20040430</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2003-127409</doc-number>
<date>20030502</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>736</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>36</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>9</main-group>
<subgroup>46</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>382248</main-classification>
<further-classification>382251</further-classification>
</classification-national>
<invention-title id="d0e71">Image encoding apparatus and method</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6157746</doc-number>
<kind>A</kind>
<name>Sodagar et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382240</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6549674</doc-number>
<kind>B1</kind>
<name>Chui et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382240</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>12</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>382240</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382247</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382251</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>35842614</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37524011</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37524019</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3483981</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>14</number-of-drawing-sheets>
<number-of-figures>20</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050002574</doc-number>
<kind>A1</kind>
<date>20050106</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Fukuhara</last-name>
<first-name>Takahiro</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kimura</last-name>
<first-name>Seiji</first-name>
<address>
<city>Chiba</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Finnegan, Henderson, Farabow, Garrett &amp; Dunner, L.L.P.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sony Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Tran</last-name>
<first-name>Phuoc</first-name>
<department>2624</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">In an image encoder (<b>1</b>), a quantizer (<b>11</b>) makes a quantization-step size set for each of low-frequency subbands whose resolution level belongs to a predetermined resolution level coincide with a quantization-step size set for each subband to encode an original image having the resolution level as it is. A low-pass rate controller (<b>17</b>) provides a rate control for the bit rate of arithmetic code D<b>16</b> in all code blocks in a low-frequency subband to be less than a predetermined target bit rate. A high-pass rate controller (<b>18</b>) provides such a rate control that the bit rate of arithmetic code D<b>17</b> in all code blocks in other subbands than the low-frequency subbands will be less than a target bit rate, that is, a bit rate resulted from subtraction of a bit rate D<b>18</b> having actually occurred in the low-frequency subbands from a final target bit rate.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="132.08mm" wi="181.69mm" file="US07298915-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="182.88mm" wi="142.16mm" orientation="landscape" file="US07298915-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="157.73mm" wi="148.93mm" file="US07298915-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="224.54mm" wi="147.40mm" orientation="landscape" file="US07298915-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="224.37mm" wi="150.20mm" orientation="landscape" file="US07298915-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="203.62mm" wi="125.98mm" orientation="landscape" file="US07298915-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="163.07mm" wi="149.94mm" file="US07298915-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="197.61mm" wi="149.01mm" orientation="landscape" file="US07298915-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="181.53mm" wi="129.20mm" orientation="landscape" file="US07298915-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="177.46mm" wi="132.93mm" orientation="landscape" file="US07298915-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="240.28mm" wi="161.88mm" file="US07298915-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="112.69mm" wi="119.97mm" file="US07298915-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="181.10mm" wi="154.18mm" file="US07298915-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="218.44mm" wi="155.02mm" orientation="landscape" file="US07298915-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="260.01mm" wi="184.74mm" orientation="landscape" file="US07298915-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention generally relates to an image encoding apparatus and method, for compressing an input image according to the JPEG-2000 Standard, for example.</p>
<p id="p-0004" num="0003">This application claims the priority of the Japanese Patent Application No. 2003-127409 filed on May 2, 2003, the entirety of which is incorporated by reference herein.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">One of the typical techniques of image compression is defined in the JPEG (Joint Photographic Experts Group) standardized by the ISO (International Standards Organization). The JPEG uses the DCT (discrete cosine transform) to provide quality encoded images and decoded images in case a relatively high bit rate is assigned for the encoding. However, if the bit rate for encoding is smaller than necessary, the block distortion peculiar to the DCT will be remarkable and a resultant image will appear noticeably degraded in quality.</p>
<p id="p-0007" num="0006">On the other hand, many researches have recently been done of the techniques of dividing an image into a plurality of frequency bands by a so-called filter bank including a high-pass filter and low-pass filter in combination and encoding each of the frequency bands. Of such techniques, the wavelet-transform coding is considered as a new promising technique which will take the place of the DCT (discrete cosine transform) because even a high compression results in no considerable block distortion as in the DCT.</p>
<p id="p-0008" num="0007">For example, the JPEG-2000 Standard established as an international standard in January, 2001 adopts a combination of the wavelet transform and a high-efficiency entropy coding (bit modeling and arithmetic coding, both in bit planes), and has attained a greater improvement in efficiency of coding than the conventional JPEG (cf. Japanese Published Unexamined Patent Application No. 2002-165098).</p>
<p id="p-0009" num="0008">These international standards defines only the design requirement for the decoder, not any for the encoder. Therefore, the encoder can freely be designed. On the other hand, since there exists no standard for any effective rate-control means to attain a target compression ratio, so it is most important to establish a technical know-how for attaining a target compression ratio.</p>
<p id="p-0010" num="0009">In encoding an image whose resolution is 2000×1000 for example in the encoder defined in the JPEG-2000, however, it is common to control the bit rate for a minimum distortion of the entire image. On the other hand, in similar coding of n image whose resolution of 1000×500, which is a square of the above-mentioned resolution, the bit rate is also controlled for a minimum distortion of the entire image. This is a rate control based on the RD (rate-distortion) characteristic. Such rate control is versatile but disadvantageous in that the load of calculation is very great. Also, the technique of controlling a bit rate for a minimum numerical distortion is disadvantageous in that it cannot assure a highest quality of an image when viewed by the human being.</p>
<p id="p-0011" num="0010">Further, for compressing an image of 2000×1000 for example to a size of 1000 kilobytes as an application of the bit-rate control, and image of 1000×500 as a low-frequency component of 2000×1000 in resolution can be compressed simultaneously to a size of 500 kilobytes using the feature of the wavelet transform. However, the image resulted from compression of an image as the low-frequency component of 1000×500 to 500 kilobytes is normally lower in quality than an image resulted from compression, to 500 kilobytes, of an original image whose resolution is 1000×500.</p>
<heading id="h-0002" level="1">OBJECT AND SUMMARY OF THE INVENTION</heading>
<p id="p-0012" num="0011">It is therefore an object of the present invention to overcome the above-mentioned drawbacks of the related art by providing an image encoding apparatus and method, capable of controlling the quality of an image resulted from compression of an image having a predetermined resolution (corresponding to the aforementioned image whose resolution is 1000×500) and that is a part of an original image (corresponding to the image whose resolution is 2000×1000) and maintaining the quality of the image resulted from compression of the original image at a high level.</p>
<p id="p-0013" num="0012">The above object can be attained by providing an image encoding apparatus and method, in which an input image is filtered to generate a plurality of subbands different in resolution level, the coefficient of each of the subbands resulted from the filtering of the input image is quantized by dividing it by a quantization-step size set for each of the subbands, the subband is divided to generate a code block having a predetermined size, a bit plane including bits from an MSB to an LSB is generated for each of the code blocks, a coding pass generated for each of the bit planes is arithmetically encoded, a packet being formed from the arithmetic code to generate an encoded stream of codes, the quantization-step size set, during the quantization, for the subband whose resolution level belongs to the predetermined resolution is made to coincide with the quantization-step size set for each subband to quantize the predetermined resolution level as a resolution level of an original image.</p>
<p id="p-0014" num="0013">In the above image encoding apparatus and method, the quantization-step size set, during the quantization, for the subband whose resolution level belongs to the predetermined resolution is made to coincide with the quantization-step size set for each subband to quantize the predetermined resolution level as that of an original image. Thus, by controlling the quality of a compressed image of a subband whose resolution level belongs to the predetermined resolution level to approximate that of a compressed image resulted from compression of an image having initially the resolution level, it is possible to maintain the quality of a compressed image resulted from compression of an original image at a high level.</p>
<p id="p-0015" num="0014">These objects and other objects, features and advantages of the present invention will become more apparent from the following detailed description of the preferred embodiments of the present invention when taken in conjunction with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic block diagram of an image encoder as an embodiment of the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> explains subbands wavelet-transformed down to a second level;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> shows subbands resulted from wavelet transform of an actual image, in which <figref idref="DRAWINGS">FIG. 3A</figref> shows an example of wavelet transform made down to a first level and <figref idref="DRAWINGS">FIG. 3B</figref> shows an example of wavelet transform made down to a third level;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> shows a quantization-step size Q assigned to each band in the conventional image encoder, in which <figref idref="DRAWINGS">FIG. 4A</figref> shows an image example whose resolution is 1000×500 and <figref idref="DRAWINGS">FIG. 4B</figref> shows an image example whose resolution is 2000×1000;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 5</figref> shows a quantization-step size Q assigned to each band in the embodiment of the present invention, in which <figref idref="DRAWINGS">FIG. 5A</figref> shows an example of image whose resolution is 1000×500 and <figref idref="DRAWINGS">FIG. 5B</figref> shows an example of image whose resolution is 2000×1000;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> shows the relation between code blocks and subbands;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7</figref> explains a bit plane, in which <figref idref="DRAWINGS">FIG. 7A</figref> shows a quantization coefficient including a total of 16 coefficients, <figref idref="DRAWINGS">FIG. 7B</figref> shows a bit plane of the absolute values of the coefficient, and <figref idref="DRAWINGS">FIG. 7C</figref> shows a bit plane of codes;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 8</figref> explains a procedure of processing via a coding pass in the code block;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> explains a procedure of scanning the coefficients in the code block;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> shows examples of subbands processed in low- and high-pass rate controllers in the image encoder as the embodiment of the present invention;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 11</figref> shows a flow of operations of the low- and high-pass rate controllers;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 12</figref> explains the priority of subbands in the low- and high-pass rate controllers;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 13</figref> shows a flow of operations of the low- and high-pass rate controllers, showing the operating procedure in detail;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 14</figref> explains the operations in the low-pass rate controller in detail from the standpoint of the bit plane; and</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 15</figref> explains a packet generated by a packet generator in the image encoder as the embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0031" num="0030">The present invention will be described in detail below concerning an embodiment thereof with reference to the accompanying drawings.</p>
<p id="p-0032" num="0031">Referring now to <figref idref="DRAWINGS">FIG. 1</figref>, there is schematically illustrated in the form of a block diagram an image encoder according to an embodiment of the present invention. As shown in <figref idref="DRAWINGS">FIG. 1</figref>, the image encoder, generally indicated with a reference <b>1</b>, includes a wavelet transformer <b>10</b>, quantizer <b>11</b>, code blocking unit <b>12</b>, bit plane decomposer <b>13</b>, bit modeling unit <b>14</b>, arithmetic encoder <b>15</b>, low-pass rate controller <b>17</b>, high-pass rate controller <b>18</b>, and a packet generator <b>19</b>. The bit modeling unit <b>14</b> and arithmetic encoder <b>15</b> form together an EBCOT (embedded coding with optimized truncation) unit <b>16</b>.</p>
<p id="p-0033" num="0032">The wavelet transformer <b>10</b> is normally a filter bank including a low-pass filter and a high-pass filter. It should be noted that a digital filter has to be pre-buffered with a sufficient amount of input images for filtering since it normally shows an impulse response (filter factor) for a plurality of tap lengths. However, no digital filter is illustrated in <figref idref="DRAWINGS">FIG. 1</figref> because its configuration is simple.</p>
<p id="p-0034" num="0033">The wavelet transformer <b>10</b> is supplied with a minimum necessary amount of cross-faded image D<b>10</b> for filtering, and filters it for wavelet transform to generate a wavelet transform coefficient D<b>11</b>.</p>
<p id="p-0035" num="0034">In the above wavelet transform, a low-frequency component is normally transformed repeatedly as shown in <figref idref="DRAWINGS">FIG. 2</figref> because the majority of the image energy is concentrated to the low-frequency component, which will also be seen from the fact that as the division level is shifted from the division level of 1 (one) as in <figref idref="DRAWINGS">FIG. 3A</figref> to the division level of 3 (three) as in <figref idref="DRAWINGS">FIG. 3B</figref>, subbands will be formed as in <figref idref="DRAWINGS">FIG. 3</figref>. That is, the level number of the wavelet transform in <figref idref="DRAWINGS">FIG. 2</figref> is 2 (two), and thus a total of seven subbands is generated. More specifically, the horizontal size X_SIZE and vertical size Y_SIZE are halved by a first filtering to provide four subbands LL<b>2</b>, LH<b>2</b>, HL<b>2</b> and HH<b>2</b>. The subband LL<b>1</b> is quartered by a second filtering to provide four subbands LL<b>1</b>, LH<b>1</b>, HL<b>1</b> and HH<b>1</b>. It should be noted that in <figref idref="DRAWINGS">FIG. 2</figref>, “L” and “H” indicate a low-frequency band and high-frequency band, respectively, and numbers suffixed to “L” and “H”, respectively, indicate numbers of wavelet-transform divisions, respectively. That is, “LH<b>1</b>”, for example, indicates a subband having a wavelet-transform division level of 1 (one) in which a low-frequency band extends horizontally while a high-frequency band extends vertically.</p>
<p id="p-0036" num="0035">The quantizer <b>11</b> makes irreversible compression of the wavelet transform coefficient D<b>1</b> supplied from the wavelet transformer <b>10</b>. Normally, the quantizer <b>11</b> adopts a scalar quantization to divide the wavelet transform coefficient D<b>11</b> by a quantization-step size. It should be noted here that the JPEG-2000 Standard prescribes that in case an irreversible 9×7 wavelet-transform filter is used for the above-mentioned irreversible compression, the scalar quantization shall automatically be used in combination. On the other hand, in case a reversible 5×3 wavelet-transform filter is used, no quantization is done but the bit rate is controlled by the low-pass rate controller <b>17</b> and high-pass rate controller <b>18</b> provided downstream. Therefore, the quantizer <b>11</b> in <figref idref="DRAWINGS">FIG. 1</figref> actually operates only when the irreversible 9×7 wavelet-transform filter is used. The embodiment of the present invention will further be described below on the assumption that the irreversible 9×7 wavelet-transform filter is used.</p>
<p id="p-0037" num="0036">Note here that ones of the subbands generated via the wavelet transform, of which the number of wavelet-transform divisions is larger, that is, of which the resolution level is lower, will have a larger influence on the image quality, while ones of the subbands, of which the number of wavelet-transform divisions is smaller, namely, of which the resolution level is higher, will have a smaller influence on the image quality. Therefore, this fact can be utilized to encode an image by making a finer quantization of the wavelet transform coefficient with the quantization-step size being set smaller in the low-frequency band while making a coarser quantization with the quantization-step size being set larger in the high-frequency band. Thus, it is possible to encode an image on the basis of the human visual characteristic.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 4</figref> shows a relation between the number of wavelet-transform divisions and quantization-step size Q for each subband by way of example. These factors can be related with each other as given by the following formula (1):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Q<sub>LL5</sub>&lt;Q<sub>HL5</sub>=Q<sub>LH5</sub>&lt;Q<sub>HH5</sub>&lt;Q<sub>HL4</sub>=Q<sub>LH4</sub>&lt;Q<sub>HH4</sub>&lt;Q<sub>HL3=Q</sub><sub>LH3</sub>&lt;Q<sub>HH3</sub>&lt;Q<sub>HL2</sub>=Q<sub>LH2</sub>&lt;Q<sub>HH2</sub>&lt;Q<sub>HL1</sub>=Q<sub>LH1</sub>&lt;Q<sub>HH1</sub>  (1)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 4A</figref> shows a quantization-step size Q assigned to each subband in order to encode an image whose resolution is 1000×500, and <figref idref="DRAWINGS">FIG. 4B</figref> shows a quantization-step size Q assigned to each subband in order to encode an image whose resolution is 2000×1000.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 4A</figref> shows all the subbands (shown as smudged) generated via four times of wavelet transform of an original image of 1000×500 in resolution, while <figref idref="DRAWINGS">FIG. 4B</figref> shows ones (shown as smudged) of 1000×500 in resolution, of subbands generated via five times of wavelet transform of an original image of 2000×1000 in resolution. Namely, the subbands shown in <figref idref="DRAWINGS">FIG. 4A</figref> have been wavelet-transformed a number of times one smaller than the subbands in <figref idref="DRAWINGS">FIG. 4B</figref> and hence different in quantization-step size from the latter. That is, the image of 1000×500 in resolution shown in <figref idref="DRAWINGS">FIG. 4A</figref> is encoded as it is, while the low-frequency subbands of 1000×500 in resolution shown in <figref idref="DRAWINGS">FIG. 4B</figref> are assigned Q<sub>HH2 </sub>in place of Q<sub>HH1</sub>, for example.</p>
<p id="p-0041" num="0040">In case an image of 1000×500, as a low-frequency component of an image of 2000×1000, is compressed to 500 kilobytes with the use of the feature of the wavelet transform technique when compressing the image of 2000×1000 to 1000 kilobytes, emphasis will be given to the quality of the high-frequency subbands because of its small quantization-step size since Q<sub>HH2</sub>&lt;Q<sub>HH1 </sub>as will be known the formula (1). That is, the bit rate assigned to the low-frequency component will be reduced so that a visual distortion called “flicker noise” will be detected and thus the image of 1000×500 will be lower in quality than the original image of 1000×500.</p>
<p id="p-0042" num="0041">On this account, the quantizer <b>11</b> included in the embodiment of the present invention provides a quantization control to make the quantization-step size for low-frequency subbands whose resolution level belongs to the predetermined one, for example, for low-frequency subbands of 1000×500 of an original image of 2000×1000, coincide with that set for each subband to encode an original image of 1000×500, as shown in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0043" num="0042">The description will be made with reference to <figref idref="DRAWINGS">FIG. 1</figref> again. The code blocking unit <b>12</b> divides the quantization coefficient D<b>12</b> for each of the subbands generated by the quantizer <b>11</b> into code blocks that are defined as a unit of coding in the JPEG-2000 Standard. More specifically, as shown in <figref idref="DRAWINGS">FIG. 6</figref>, code blocks each having a size of about 64×64 for example are generated in each of the subbands after the division, and the encoding will be done of each of these code blocks in the downstream part of the image encoder <b>1</b>. It should be noted that the code block size shall be represented by a power of 2 (two) in both horizontal and vertical directions as defined in the JPEG-2000 Standard and it is 32×32 or 64×64 in many cases. The code blocking unit <b>12</b> supplies the quantization coefficient D<b>13</b> for each code block to the bit plane decomposer <b>13</b>.</p>
<p id="p-0044" num="0043">The bit plane decomposer <b>13</b> expands the quantization coefficient D<b>13</b> for each of the code blocks supplied from the code blocking unit <b>12</b> to a bit plane, and supplies the quantization coefficient D<b>14</b> for each bit plane to the bit modeling unit <b>14</b>. The concept of this bit plane will be described below with reference to <figref idref="DRAWINGS">FIG. 7</figref>. <figref idref="DRAWINGS">FIG. 7A</figref> shows an assumed quantization coefficient including a total of 16 coefficients (=4 vertical coefficients by 4 horizontal ones). The largest absolute-value one of these 16 quantization coefficients is 13 (thirteen) that is binary-notated as “1101”. Therefore, the bit planes defined by the coefficient absolute-values include four as shown in <figref idref="DRAWINGS">FIG. 7B</figref>. It should be noted that all elements of each bit plane take a number 0 (zero) or 1 (one). On the other hand, the only one of the quantization coefficients which has a negative sign is “−6”, while all the other quantization coefficients are 0 (zero) and positive-signed ones. Therefore, the bit plane of signs is as shown in <figref idref="DRAWINGS">FIG. 7C</figref>.</p>
<p id="p-0045" num="0044">The bit modeling unit <b>14</b> makes bit modeling of the quantization coefficient D<b>14</b> for each bit plane as will be described below, and supplies a context D<b>15</b> to the arithmetic encoder <b>15</b>. It should be noted here that according to this embodiment, there is used an entropy coding called “EBCOT” defined in the JPEG-2000 Standard. The EBCOT is such that an entropy coding is done while measuring a statistic amount of the quantization coefficients in each code block. It should be noted that the EBCOT (embedded coding with optimized truncation) is described in detail in the document “ISO/IEC 15444-1, Information Technology—JPEG 2000, Part 1: Core Coding System” and the like.</p>
<p id="p-0046" num="0045">Each of the code blocks is encoded bit plane by bit plane independently in a direction from the most significant bit (MSB) to least significant bit (LSB). A quantization coefficient is expressed by a signed binary number of n bits, and bits <b>0</b> to (n−2) represent the bits, respectively, included between LSB and MSB. It should be noted that the remaining one bit is a sign. The code blocks are sequentially encoded starting with the MSB-side bit plane via three types of coding passes as shown below:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0046">(a) Significant propagation pass (also called SP pass)</li>
        <li id="ul0002-0002" num="0047">(b) Magnitude refinement pass (also called MR pass)</li>
        <li id="ul0002-0003" num="0048">(c) Clean-up pass (also called CU pass)</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0047" num="0049">The three types of coding passes are used in a sequence as shown in <figref idref="DRAWINGS">FIG. 8</figref>. As shown in <figref idref="DRAWINGS">FIG. 8</figref>, a bit plane (n−2) at the MSB side is first encoded via the CU pass. Next, bit planes are sequentially encoded toward the LSB side. The bit planes are encoded via the SP pass, MR pass and CU pass in this order.</p>
<p id="p-0048" num="0050">Actually, however, it is written in a header in which bit plane counted from the MSB “1” will appear, and all-zero bit planes will not be encoded. The three types of coding passes are repeatedly used in this order to encode the bit planes, and the encoding is ceased after an arbitrary bit plane is encoded via an arbitrary one of the coding passes. Thereby, a tradeoff can be made between the bit rate and image quality, namely, the bit rate can be controlled.</p>
<p id="p-0049" num="0051">The coefficients are scanned as will be described below with reference to <figref idref="DRAWINGS">FIG. 9</figref>. The code blocks are grouped at each height of four coefficients into a stripe. The stripe is as wide as the width of the code block. The “scanning sequence” means a sequence in which all coefficients in one code block are scanned. In a code block, the coefficients are scanned in a sequence from the upper to lower stripe. In each stripe, the coefficients are scanned in a sequence from the left to right row. In each of the rows, the coefficients are scanned in a sequence from the top to bottom. It should be noted that in each coding pass, all the coefficients in a code block are scanned in these sequences of scanning.</p>
<p id="p-0050" num="0052">The above three types of coding passes will be described below:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0053">(a) Significance propagation pass (SP pass)</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0051" num="0054">The SP pass via which a bit plane is encoded is intended to arithmetically encode the value of a bit plane of non-significant coefficients of which at least one near “eight” is significant. In case the bit plane thus encoded has a value of 1 (one), whether the sign of the code is positive or negative is arithmetically encoded.</p>
<p id="p-0052" num="0055">The “significance” referred to herein indicates a state the encoder has for each coefficient. The initial value of the “significance” is 0 (zero) indicating that the bit plane is non-significant. When the coefficient of the bit plane, which is 1 (one), is encoded, the initial value changes to 1 (one) which indicates that the encoder state is significant, and then will always be 1 (one). Therefore, the “significance” can be said to be a flag indicative of whether valid-digit information has already been encoded.
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0056">(b) Magnitude refinement pass (MR pass)</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0053" num="0057">The MR pass via which a bit plane is encoded is intended to arithmetically encode the value of a bit plane of significant coefficients, not encoded via the SP pass via which a bit plane is to be encoded.
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0058">(c) Clean-up pass (CU pass)</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0054" num="0059">The CU pass via which a bit plane is encoded is intended to arithmetically encode the value of a bit plane of nonsignificant coefficients, not encoded by the SP pass via which a bit plane is to be encoded. In case the bit plane thus encoded has a value of 1 (one), it is continuously encoded arithmetically whether the sign of the code is positive or negative.</p>
<p id="p-0055" num="0060">Note that in the arithmetic coding made via the above three types of coding passes, any of ZC (zero coding), RLC (run-length coding), SC (side coding) and MR (magnitude refinement) is selectively used to select a context of the coefficients. Then, a context selected via an arithmetic coding called “MQ coding” is encoded. The “MQ coding” is a learning type binary arithmetic coding defined in the JBIG2. The “MQ coding” is described in the document “ISO/IEC FDIS 14492, “Lossy/Lossless Coding of Bi-level Images”, March 2000”. In the JPEG-2000 Standard, a total of 19 types of contexts is defined for all the coding passes.</p>
<p id="p-0056" num="0061">The bit modeling unit <b>14</b> decomposes the quantization coefficient D<b>14</b> for each bit plane into three coding passes to generate a coefficient context D<b>15</b> for each coding pass. The arithmetic encoder <b>15</b> makes arithmetic coding of the context D<b>15</b>, supplies arithmetic code D<b>16</b> in a predetermined low-frequency subband having the quantization-step size thereof changed by the quantizer <b>11</b> to the low-pass controller <b>17</b>, and also arithmetic code D<b>17</b> in other high-frequency subbands to the high-pass rate controller <b>18</b>.</p>
<p id="p-0057" num="0062">The low-pass rate controller <b>17</b> processes at least a part of the coding passes, then adds together the bit rates of the arithmetic codes D<b>16</b> supplied from the arithmetic encoder <b>15</b>, that is, the bit rates of the arithmetic codes D<b>16</b> in all the code blocks existent in low-frequency subbands (RL<b>0</b> to RL<b>4</b>) whose resolution levels (RL) are 0 to 4, respectively, as shown in <figref idref="DRAWINGS">FIG. 10</figref>, in a predetermined sequence which will be described in detail later, and truncates the arithmetic codes D<b>16</b> appearing after a predetermined target bit rate has been reached. By truncating the arithmetic codes D<b>16</b> just before the predetermined target bit rate has been reached as above, the bit rate can positively be set to less than a target bit rate. The low-pass rate controller <b>17</b> supplies arithmetic code D<b>18</b> having the bit rate thereof controlled to the packet generator <b>19</b>, and a bit rate D<b>19</b> to the high-pass rate controller <b>18</b>.</p>
<p id="p-0058" num="0063">The high-pass rate controller <b>18</b> adds together the bit rates of the arithmetic codes D<b>17</b> supplied from the arithmetic encoder <b>15</b>, that is, the bit rates of the arithmetic codes D<b>17</b> in each of the code blocks existent in a high-frequency subband (RL<b>5</b>) whose resolution level is 5 (five), as shown in <figref idref="DRAWINGS">FIG. 10</figref>, and controls the bit rate to less than the target one. The high-pass rate controller <b>18</b> supplies arithmetic code D<b>20</b> having the bit rate thereof controlled to the packet generator <b>19</b>. It should be noted the target bit rate in the high-pass rate controller <b>18</b> is a result of subtraction of the bit rate D<b>18</b> in the low-frequency subbands from the target bit rate in all the final subbands.</p>
<p id="p-0059" num="0064">The operations of the low- and high-pass bit controllers <b>17</b> and <b>18</b> will be explained with reference to the flow chart shown in <figref idref="DRAWINGS">FIG. 11</figref>. First in step S<b>1</b>, the target bit rate for the low-frequency subbands (RL<b>0</b> to RL<b>4</b>) as in <figref idref="DRAWINGS">FIG. 10</figref> is set to T<sub>low</sub>, and the target bit rate for all the subbands (RL<b>0</b> to RL<b>5</b>) is set to T<sub>high</sub>.</p>
<p id="p-0060" num="0065">Next in step S<b>2</b>, a rate control is made so the total sum of bit rates in all the code blocks existent in the low-frequency subbands (RL<b>0</b> to RL<b>4</b>) will be less than T<sub>low</sub>. It is assumed that as the result of the rate control, the total sum of bit rates has become C<sub>low</sub>.</p>
<p id="p-0061" num="0066">Further in step S<b>3</b>, a rate control is made so that the total sum of bit rates in all the block codes existent in the high-frequency subband (RL<b>5</b>) will be less than (T<sub>high</sub>−C<sub>low</sub>). On the assumption that as the result of this rate control, the total sum of bit rates in all the subbands (RL<b>0</b> to RL<b>5</b>) has become C<sub>high</sub>, the total sum C<sub>high </sub>will meet C<sub>high</sub>&lt;T<sub>high</sub>, so that the bit rate can positively be set to less than the target one.</p>
<p id="p-0062" num="0067">Thus, the low- and high-pass rate controllers <b>17</b> and <b>18</b> included in the embodiment of the present invention control the bit rate of the high-frequency subband (RL<b>5</b>) with a priority over the low-frequency subbands (RL<b>0</b> to RL<b>4</b>), to thereby permitting to maintain or assure the image quality within at least the range of resolution level.</p>
<p id="p-0063" num="0068">Note that the low- and high-pass rate controllers <b>17</b> and <b>18</b> add together bit rates for each coding pass or bit plane in a sequence which will be described below. That is, each subband is selected in the order from the most significant bit (MSB) plane to the least significant bit (LSB) plane.</p>
<p id="p-0064" num="0069">Also, bit planes taking the same bit positions in the subbands, respectively, are selected in the order from the lowest-frequency subband to highest-frequency subband. As shown in <figref idref="DRAWINGS">FIG. 12</figref> for example, in case wavelet transform has been done three times, the low-pass rate controller <b>17</b> selects bit planes <b>0</b>LL, <b>1</b>HL, <b>1</b>LH, <b>1</b>HH, <b>2</b>HL, <b>2</b>LH and <b>2</b>HH in this order, while the high-pass rate controller <b>18</b> selects bit planes <b>3</b>HL, <b>3</b>LH and <b>3</b>HH in this order, because important parts of an image are concentrated in low-frequency subbands rather than in high-frequency subbands. It should be noted that of bit planes HL and LH having the same resolution level, LH is given priority, not HL as shown in <figref idref="DRAWINGS">FIG. 12</figref>.</p>
<p id="p-0065" num="0070">Also, bit planes in the same bit positions in three components Y (brightness), U and V (color difference), respectively, are selected in this order because the human sense of vision is normally more sensitive to the brightness information rather than to the color-difference information. It should be noted that the priority should preferably be varied since the importance level of U and V as equal color-difference information depends upon an input image.</p>
<p id="p-0066" num="0071"><figref idref="DRAWINGS">FIG. 13</figref> shows a flow of operations made in adding the bit planes. First in step S<b>10</b>, there are held information on all the coding passes, encoded by the EBCOT unit <b>16</b> and having a predetermined resolution level or other resolution level, and a bit rate for each bit plane.</p>
<p id="p-0067" num="0072">Next in step S<b>11</b>, a bit rate Y to be added is initialized to 0. Then in step S<b>12</b>, there are selected a bit plane of the most significant bits (MSB) among the first subband, component and code block.</p>
<p id="p-0068" num="0073">Further in step S<b>13</b>, a bit rate T(Ns, Nc, C, B) for the selected bit plane, where Ns, Nc, C and B indicate a subband number, component number, code block number and bit plane number, is added to the bit rate Y (brightness).</p>
<p id="p-0069" num="0074">In step S<b>14</b>, it is judged whether the bit rate Y to be added is larger than the target one. If the bit rate Y to be added is determined to be larger than the target one, namely, if the result of judgment is affirmative (YES), the low- and high-pass rate controllers <b>17</b> and <b>18</b> exit the operation of bit rate addition. On the contrary, if the bit rate Y is smaller than the target one, that is, if the result of judgment is negative (NO), the low- and high-pass rate controllers <b>16</b> and <b>17</b> go to step S<b>15</b>.</p>
<p id="p-0070" num="0075">In step S<b>15</b>, it is judged whether bit planes in the same bit positions exist. If there exist bit planes in the same bit positions, namely, if the result of judgment is affirmative (YES), the low- and high-pass rate controllers <b>17</b> and <b>18</b> go to step S<b>16</b>, select a next bit plan and return to step S<b>13</b>. On the contrary, if there exist no bit planes in the same bit positions, namely, if the result of judgment is negative (NO), the low- and high-pass rate controllers <b>17</b> and <b>18</b> go to step S<b>17</b>.</p>
<p id="p-0071" num="0076">In step S<b>17</b>, it is judged whether the bit is LSB. If the bit is determined to be the least significant bit LSB (YES), the low- and high-pass rate controllers <b>17</b> and <b>18</b> exit the operation of addition. If the result of judgment is negative (NO), the low-and high-pass rate controllers <b>17</b> and <b>18</b> select the first bit plane in the position of a bit next to the least significant bit (LSB) in step S<b>18</b>, and return to step S<b>13</b>.</p>
<p id="p-0072" num="0077">Next, the operations made of the low-pass rate controller <b>17</b> will be described in detail from the viewpoint of the bit plane with reference to <figref idref="DRAWINGS">FIG. 14</figref>. <figref idref="DRAWINGS">FIG. 14</figref> shows a bit plane for each of code blocks (CB) in each subband for three components including Y (brightness), U and V (color difference). In <figref idref="DRAWINGS">FIG. 14</figref>, the blank area indicates a zero bit plane, hatched area indicate a bit plane finally included in an encoded stream of codes, and smudged area indicates a bit plane not used as a result of rate control.</p>
<p id="p-0073" num="0078">As shown in <figref idref="DRAWINGS">FIG. 14</figref>, the low-pass rate controller <b>17</b> selects a bit plane by going through a cod block, subband and component in the order from a bit plane of most significant bit (MSB) to least significant bit (LSB). Namely, the low-pass rate controller <b>17</b> selects a bit plane of subbands in the same bit positions in the order from lowest-frequency subband to highest-frequency subband and a bit plane of components in the order of Y, U and V. More specifically, as shown in <figref idref="DRAWINGS">FIG. 14</figref>, the low-pass rate controller selects bit planes in the order of subbands Y-<b>0</b>LL, . . . , Y-<b>2</b>HH, U-<b>0</b>LL, . . . , U-<b>2</b>HH, V-<b>0</b>LL, . . . , V-<b>2</b>HH as shown in <figref idref="DRAWINGS">FIG. 14</figref>, and bit planes in the order of CB<sub>0</sub>, . . . , CB<sub>n </sub>in each subband starting at the most significant bit (MSB). When the total sum of the bit rates in a bit plane has arrived at a predetermined target bit rate, the low-pass rate controller <b>17</b> stops the addition.</p>
<p id="p-0074" num="0079">Note that in this embodiment, bit planes are selected for subbands with priority over components. However, the present invention is not limited to this manner of selection but bit planes may be selected for components more preferentially for subbands.</p>
<p id="p-0075" num="0080">Similarly, the high-pass rate controller <b>18</b> selects bit planes in the order of subbands Y-<b>3</b>HL, . . . , Y-<b>3</b>HH, U-<b>3</b>HL, . . . , U-<b>3</b>HH, V-<b>3</b>HL, . . . , V-<b>3</b>HH, and bit planes are selected in the order of CB<sub>0</sub>, . . . , CB<sub>n </sub>in each subband starting with the most significant bit (MSB).</p>
<p id="p-0076" num="0081">In the low- and high-pass rate controllers <b>17</b> and <b>18</b> included in the embodiment of the present invention, the number of bit planes finally truncated, not selected, is only different a maximum of one bit plane counted from the least significant bit (LSB) from all the code blocks in one frame. So, there is no difference in image quality between the subbands and thus an image of totally high quality can be assured.</p>
<p id="p-0077" num="0082">The description will be made with reference to <figref idref="DRAWINGS">FIG. 1</figref> again. The packet generator <b>19</b> adds a header to each of the arithmetic code D<b>18</b> supplied from the low-pass rate controller <b>17</b> and arithmetic code D<b>20</b> supplied from the high-pass rate controller <b>18</b> to form packets, and outputs them as an encoded stream of codes D<b>21</b>. At this time, the packet generator <b>19</b> generates individual packets at the same resolution level as shown in <figref idref="DRAWINGS">FIG. 15</figref>. That is, of the packets, a lowest-frequency packet −0 includes only subbands whose resolution level is 0 (RL<b>0</b>), packets −1 include only subbands whose resolution level is 1 (RL<b>1</b>), packets −2 include only subbands whose resolution level is 2 (RL<b>2</b>) and packets −3 include only subbands whose resolution level is 3 (RL<b>3</b>). The packet generator <b>19</b> outputs the encoded stream of codes D<b>21</b> packet by packet.</p>
<p id="p-0078" num="0083">As having been described in the foregoing, in the image encoder <b>1</b> as the embodiment of the present invention, the quantizer <b>11</b> can control the quantization to make a quantization-step size for each low-frequency subband whose resolution level belongs to a predetermined resolution level, for example, a low-frequency subband whose resolution level is 1000×500, of an original image whose resolution level is 2000×1000, coincide with a quantization-step size set for each subband to encode an original image whose resolution level is 1000×500, and the low-pass rate controller <b>17</b> can control the quality of a compressed image of a low-frequency subband to approximate that of a compressed image resulted from compression of an original image having originally that resolution by controlling the bit rate of a low-frequency subband with priority over the bit rate of a high-frequency subband, and maintain a high quality of the compressed image resulted from compression of the original image.</p>
<p id="p-0079" num="0084">Also, the low- and high-pass rate controllers <b>17</b> and <b>18</b> can select bit planes by going through the code block, subband and component in the order from the most significant bit (MSB) to least significant bit (LSB) and add the bit rates for the bit planes for comparison with the target bit rate, and exit the bit-control operation immediately when the target bit rate has been reached. Moreover, since the number of bit planes not finally selected and which are to be truncated is different by a maximum of one bit plane from all the code blocks in one frame even if counted from the least significant bit (LSB), so there is no difference in quality between the subbands and an image having a high quality as a whole can be provided.</p>
<p id="p-0080" num="0085">In the foregoing, the present invention has been described in detail concerning certain preferred embodiments thereof as examples with reference to the accompanying drawings. However, it should be understood by those ordinarily skilled in the art that the present invention is not limited to the embodiments but can be modified in various manners, constructed alternatively or embodied in various other forms without departing from the scope and spirit thereof as set forth and defined in the appended claims.</p>
<p id="p-0081" num="0086">For example, although a special quantization control and rate control are made of low-frequency subbands subjected to wavelet transform once, that is, low-frequency subbands (RL<b>0</b> to RL<b>4</b>) in <figref idref="DRAWINGS">FIG. 10</figref>, in the aforementioned embodiment, the present invention is not limited to this embodiment but quantization control and rate control may of course be made of low-frequency subbands (RL<b>0</b> to RL<b>3</b>) subjected to wavelet transform twice, low-frequency subbands (RL<b>0</b> to RL<b>2</b>) subjected to wavelet transform three times, or the like.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An image encoding apparatus comprising:
<claim-text>a filtering means for filtering an input image to generate a plurality of subbands different in resolution level;</claim-text>
<claim-text>a quantizing means for quantizing each coefficient of the filtered input image by dividing it by a quantization-step size set for each of the subbands;</claim-text>
<claim-text>a code block generating code blocks each having a predetermined size by dividing the subband;</claim-text>
<claim-text>a bit plane generating means for generating a bit plane including bits from an MSB to an LSB for each of the code blocks;</claim-text>
<claim-text>an encoding means for making arithmetic coding of the coding pass generated for each of the bit planes; and</claim-text>
<claim-text>a means for generating an encoded stream of codes by forming a packet from the arithmetic code generated by the encoding means,</claim-text>
<claim-text>the quantizing means making the quantization-step size set for the subband whose resolution level belongs to a predetermined resolution level coincide with the quantization-step size set for each subband to quantize the predetermined resolution level as that of an original image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a first bit rate controlling means for controlling, based on the arithmetic code generated by the encoding means, the bit rate for assignment to all the code blocks whose resolution level belongs to the predetermined resolution level to less than a first bit rate; and</claim-text>
<claim-text>a second bit rate controlling means for controlling, based on the arithmetic code generated by the encoding means, the bit rate for assignment to all the code blocks whose resolution level belongs to a resolution level other than the predetermined resolution level to less than a second bit rate after the bit rate is controlled by the first bit rate controlling means.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the second bit rate is a result of subtraction of the bit rate actually assigned to all the code blocks whose resolution level belongs to the predetermined resolution level from a target bit rate for the entire input image.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the first and second bit rate controlling means compare a cumulative bit rate with the first and second bit rates while sequentially adding together the bit rates assigned to the bit planes or coding passes, respectively, in an order from the bit plane of the most significant bit to that of the least significant bit, and stops the addition when the cumulative bit rate exceeds the first and second bit rates.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the first and second bit rate controlling means add, for the bit planes in the same bit positions, the bit rates assigned to the bit planes or coding passes, respectively, in the order of the lowest-frequency subband to the highest-frequency subband.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the subbands whose resolution level belongs to the predetermined resolution level are low-frequency ones of four subbands generated by making low- and high-pass filtering of the input image once in each of vertical and horizontal directions.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. An image encoding method comprising the steps of:
<claim-text>filtering an input image to generate a plurality of subbands different in resolution level;</claim-text>
<claim-text>quantizing each coefficient of the filtered input image by dividing it by a quantization-step size set for each of the subbands;</claim-text>
<claim-text>generating code blocks each having a predetermined size by dividing the subband;</claim-text>
<claim-text>generating a bit plane including bits from an MSB to an LSB for each of the code blocks;</claim-text>
<claim-text>making arithmetic coding of the coding pass generated for each of the bit planes; and</claim-text>
<claim-text>generating an encoded stream of codes by forming a packet from the arithmetic code generated by the encoding means,</claim-text>
<claim-text>the quantization-step size set for the subband whose resolution level belongs to a predetermined resolution level being made in the quantizing step to coincide with the quantization-step size set for each subband to quantize the predetermined resolution level as that of an original image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising:
<claim-text>a first bit rate step of controlling, based on the arithmetic code generated in the encoding step, the bit rate for assignment to all the code blocks whose resolution level belongs to the predetermined resolution level to less than a first bit rate; and</claim-text>
<claim-text>a second bit rate controlling step of controlling, based on the arithmetic code generated in the encoding step, the bit rate for assignment to all the code blocks whose resolution level belongs to a resolution level other than the predetermined resolution level to less than a second bit rate after the bit rate is controlled in the first bit rate controlling step.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the second bit rate is a result of subtraction of the bit rate actually assigned to all the code blocks whose resolution level belongs to the predetermined resolution level from a target bit rate for the entire input image.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein in the first and second bit rate controlling steps, a cumulative bit rate is compared with the first and second bit rates while the bit rates assigned to the bit planes or coding passes, respectively, are sequentially added together in an order from the bit plane of the most significant bit to that of the least significant bit, and the addition is stopped when the cumulative bit rate exceeds the first and second bit rates.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method according to <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein in the first and second bit rate controlling steps, the bit rates assigned to the bit planes or coding passes, respectively, are added, for the bit planes in the same bit positions, in the order of the lowest-frequency subband to the highest-frequency subband.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the subbands whose resolution level belongs to the predetermined resolution level are low-frequency ones of four subbands generated by making low- and high-pass filtering of the input image once in each of vertical and horizontal directions.</claim-text>
</claim>
</claims>
</us-patent-grant>
