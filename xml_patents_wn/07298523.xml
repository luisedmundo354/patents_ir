<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298523-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298523</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10265791</doc-number>
<date>20021008</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2001-311956</doc-number>
<date>20011009</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>784</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>K</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>358  16</main-classification>
<further-classification>358  19</further-classification>
</classification-national>
<invention-title id="d0e71">Printing apparatus, control method therefor, and storage medium</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5293481</doc-number>
<kind>A</kind>
<name>Mita et al.</name>
<date>19940300</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>395163</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5422738</doc-number>
<kind>A</kind>
<name>Ishihara et al.</name>
<date>19950600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358500</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6052207</doc-number>
<kind>A</kind>
<name>Takagi et al.</name>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>358452</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6058465</doc-number>
<kind>A</kind>
<name>Nguyen</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6351314</doc-number>
<kind>B1</kind>
<name>Nakagiri</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>358  111</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6354752</doc-number>
<kind>B1</kind>
<name>Nakagiri</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>400 76</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6493472</doc-number>
<kind>B1</kind>
<name>Takagi et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>382317</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6552743</doc-number>
<kind>B1</kind>
<name>Rissman</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3482072</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6570664</doc-number>
<kind>B2</kind>
<name>Nakagiri</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>358  111</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6753903</doc-number>
<kind>B1</kind>
<name>Lin</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3482072</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6831755</doc-number>
<kind>B1</kind>
<name>Narushima et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  19</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6882440</doc-number>
<kind>B1</kind>
<name>Nitta</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358  116</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7202975</doc-number>
<kind>B2</kind>
<name>Narushima et al.</name>
<date>20070400</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>358  19</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2003/0174351</doc-number>
<kind>A1</kind>
<name>Kawanabe et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>358  19</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>CN</country>
<doc-number>1137649</doc-number>
<date>19961200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>CN</country>
<doc-number>1152747</doc-number>
<date>19970600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>EP</country>
<doc-number>0 860 980</doc-number>
<date>19980800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>EP</country>
<doc-number>0 938 041</doc-number>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>EP</country>
<doc-number>0 949 804</doc-number>
<date>19991000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>EP</country>
<doc-number>1 087 607</doc-number>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>EP</country>
<doc-number>1 119 177</doc-number>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>JP</country>
<doc-number>60-146574</doc-number>
<date>19850800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>JP</country>
<doc-number>05-318845</doc-number>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>JP</country>
<doc-number>2000-52605</doc-number>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>JP</country>
<doc-number>2000-177210</doc-number>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>JP</country>
<doc-number>2000-198240</doc-number>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>JP</country>
<doc-number>2001-88374</doc-number>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>JP</country>
<doc-number>2001-282470</doc-number>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>JP</country>
<doc-number>2001-290615</doc-number>
<date>20011000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>WO</country>
<doc-number>PCT/JP02/10878</doc-number>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>8</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>358  19</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358504</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  118</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  115</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>358  116</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>18</number-of-drawing-sheets>
<number-of-figures>19</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20030067620</doc-number>
<kind>A1</kind>
<date>20030410</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Masumoto</last-name>
<first-name>Kazuyuki</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kamada</last-name>
<first-name>Masashi</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yano</last-name>
<first-name>Kentaro</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yamada</last-name>
<first-name>Akitoshi</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fitzpatrick, Cella, Harper &amp; Scinto</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Tran</last-name>
<first-name>Douglas Q.</first-name>
<department>2625</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A print apparatus which receives image data from a digital camera, PC card, or PC to print an image on a storage medium outputs print data based on image data from the PC to a printer engine via a USB hub, and prints an image. The apparatus has a DSP which receives compressed image data from the digital camera or PC card, decodes the received data, and parallelly executes, for the decoded image data, at least color space conversion processing, size change processing, and color conversion processing. The apparatus generates print data on the basis of the image data processed by the DSP, outputs the generated print data to the printer engine, and prints an image.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="79.08mm" wi="229.62mm" file="US07298523-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="205.40mm" wi="149.01mm" orientation="landscape" file="US07298523-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="156.04mm" wi="140.55mm" file="US07298523-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="214.04mm" wi="159.17mm" file="US07298523-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="227.75mm" wi="155.11mm" orientation="landscape" file="US07298523-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="218.02mm" wi="156.46mm" orientation="landscape" file="US07298523-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="243.76mm" wi="119.21mm" orientation="landscape" file="US07298523-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="248.92mm" wi="162.48mm" orientation="landscape" file="US07298523-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="221.49mm" wi="146.05mm" orientation="landscape" file="US07298523-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="190.50mm" wi="129.37mm" file="US07298523-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="98.55mm" wi="92.46mm" file="US07298523-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="130.13mm" wi="94.74mm" file="US07298523-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="99.23mm" wi="96.69mm" file="US07298523-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="206.42mm" wi="159.00mm" file="US07298523-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="221.83mm" wi="159.00mm" file="US07298523-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="182.03mm" wi="158.92mm" file="US07298523-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="188.98mm" wi="156.46mm" file="US07298523-20071120-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="254.00mm" wi="166.54mm" orientation="landscape" file="US07298523-20071120-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="222.50mm" wi="144.44mm" file="US07298523-20071120-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates to a printing apparatus which receives image data from an image sensing apparatus such as a digital camera, a memory, or the like and prints the image data on a print medium, a control method therefor, and a storage medium.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">In recent years, digital cameras (image sensing apparatuses) capable of photographing an image by a simple operation and converting the image into digital image data have been widely used. To print an image photographed by this camera and use the print as a photograph, the photographed digital image data is input from the digital camera to a PC (computer), and undergoes image processing by the PC. Then, the processed data is output to a color printer, which prints the data.</p>
<p id="p-0004" num="0003">To the contrary, there have been developed color print systems capable of directly transferring digital image data from a digital camera to a color printer and printing the image data by the color printer without using any PC, and so-called photo-direct (PD) printers capable of directly mounting in a color printer a memory card which is mounted in a digital camera and stores a sensed image, and printing the photographed image stored in the memory card by the color printer.</p>
<p id="p-0005" num="0004">In such a conventional printer apparatus, a CPU which controls the entire apparatus executes processing which requires a long time, e.g., image processing such as decoding/expansion and color conversion of received image data. This prolongs a time required for the processing, resulting in a long time required for printing.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0006" num="0005">The present invention has been made in consideration of the above prior art, and has as its object to provide a printing apparatus capable of processing and printing input image data at a high speed, a control method of the printing apparatus, and a storage medium.</p>
<p id="p-0007" num="0006">It is another object of the present invention to provide a printing apparatus which can selectively print image data from a plurality of image data sources with a high efficiency and prevent an unintended image from printing even when a plurality of devices and memories are connected, a control method of the printing apparatus, and a storage medium.</p>
<p id="p-0008" num="0007">Other features and advantages of the present invention will be apparent from the following description taken in conjunction with the accompanying drawings, in which like reference characters designate the same or similar parts throughout the figures thereof.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0009" num="0008">The accompanying drawings, which are incorporated in and constitute a part of the specification, illustrate embodiments of the invention and, together with the description, serve to explain the principles of the invention.</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> depicts a schematic perspective view showing a photo-direct printer apparatus according to an embodiment of the present invention;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic perspective view showing a print head of the photo-direct printer apparatus according to the embodiment of the present invention;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram showing the arrangement of the main part concerning control of the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram showing the arrangement of the ASIC of the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 5</figref> depicts a view for explaining connection between the photo-direct printer apparatus and a digital camera according to the embodiment;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 6</figref> is a functional block diagram showing interfaces and the arrangement of functions for image processing control of the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 7</figref> is a functional block diagram showing the arrangement of the functions for image processing control of the photo-direct printer apparatus according to the embodiment in more detail;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram showing a multitask structure in which a task is created for each functional module in a control program of the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 9</figref> is a flow chart schematically showing processing executed by a DSP according to the embodiment;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 10</figref> is a flow chart for explaining image processing <b>1</b> in step S<b>2</b> of <figref idref="DRAWINGS">FIG. 9</figref>;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 11</figref> is a flow chart for explaining image processing <b>2</b> in step S<b>3</b> of <figref idref="DRAWINGS">FIG. 9</figref>;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 12</figref> is a flow chart for explaining image processing <b>3</b> in step S<b>4</b> of <figref idref="DRAWINGS">FIG. 9</figref>;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 13</figref> is a flow chart showing processing when the photo-direct printer apparatus and digital camera according to the embodiment are connected;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 14</figref> is a flow chart for explaining processing along with mounting/dismounting of a PC card in the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 15</figref> is a flow chart for explaining processing of receiving and printing print data from a PC in the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 16</figref> is a flow chart for explaining access request processing from the PC to a PC card in the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 17</figref> is a table for explaining the relationship between the preceding processes and succeeding processes in the photo-direct printer apparatus according to the embodiment;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 18</figref> is a view for explaining an example of RGB color conversion processing in step S<b>23</b> of <figref idref="DRAWINGS">FIG. 11</figref>; and</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 19</figref> is a view for explaining an example of error diffusion processing in step S<b>32</b> of <figref idref="DRAWINGS">FIG. 12</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
<p id="p-0029" num="0028">A preferred embodiment of the present invention will be described in detail below with reference to the accompanying drawings.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic perspective view showing a photo-direct printer apparatus <b>1000</b> according to the embodiment of the present invention. The photo-direct printer has a general PC printer function of receiving data from a host computer (PC) and printing the data, and a function of directly reading and printing image data stored in a storage medium such as a memory card, or receiving image data from a digital camera connected to the printer apparatus and printing the data.</p>
<p id="p-0031" num="0030">In <figref idref="DRAWINGS">FIG. 1</figref>, the main body which defines the casing of the photo-direct printer apparatus <b>1000</b> according to this embodiment has casing members: a lower case <b>1001</b>, upper case <b>1002</b>, access cover <b>1003</b>, and discharge tray <b>1004</b>. The lower case <b>1001</b> forms almost the lower half of the apparatus <b>1000</b>, whereas the upper case <b>1002</b> forms almost the upper half of the main body. A combination of these cases forms a hollow structure with a storage space where each mechanism (to be described later) is accommodated. The upper and front surfaces have openings. The discharge tray <b>1004</b> is rotatably held at one end by the lower case <b>1001</b>, and the opening in the front surface of the lower case <b>1001</b> is opened/closed by rotating the discharge tray <b>1004</b>. To execute print operation, the discharge tray <b>1004</b> is rotated toward the front side to open the opening. Print sheets can be discharged from the opening, and the discharged print sheets can be sequentially stacked. The discharge tray <b>1004</b> houses two auxiliary trays <b>1004</b><i>a </i>and <b>1004</b><i>b</i>. These trays are selectively pulled out to enlarge/reduce the paper support area in three stages, as needed.</p>
<p id="p-0032" num="0031">The access cover <b>1003</b> is rotatably held at one end by the upper case <b>1002</b> so as to open/close the opening formed in the upper surface. Opening the access cover <b>1003</b> enables exchanging a print head cartridge (not shown), ink tank (not shown), or the like accommodated in the main body. Although not shown, a projection formed on the back surface of the access cover <b>1003</b> rotates a cover opening/closing lever when the access cover <b>1003</b> is opened/closed. The lever rotation position is detected by a microswitch or the like, thereby detecting the open/closed state of the access cover.</p>
<p id="p-0033" num="0032">A power switch <b>1005</b> is provided with the upper surface of the upper case <b>1002</b>. An operation panel <b>1010</b> having a liquid crystal display <b>1006</b>, various key switches, and the like is arranged on the right side of the upper case <b>1002</b>. The structure of the operation panel <b>1010</b> will be described in detail with reference to <figref idref="DRAWINGS">FIG. 2</figref>. Reference numeral <b>1007</b> denotes an automatic feeder which automatically feeds print sheets into the apparatus main body; numeral <b>1008</b> denotes a paper interval selection lever for adjusting the interval between the print head and the print sheet; and numeral <b>1009</b> denotes a card slot into which an adapter capable of mounting a memory card is inserted. Image data stored in a memory card can be directly received and printed via the adapter. The memory card (PC) includes, e.g., a compact flash memory™, smart media, and memory stick. Reference numeral <b>1011</b> denotes a viewer (liquid crystal display) which is detachable from the apparatus main body and is used to display an image of one frame, an index image, and the like when images stored in the PC card are searched for an image to be printed; and numeral <b>1012</b> denotes a terminal (input terminal for inputting image data) for connecting a digital camera (to be described later). A USB bus connector <b>1013</b> in <figref idref="DRAWINGS">FIG. 4</figref> for connecting a personal computer (PC) is provided with the back side of the apparatus main body.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic perspective view showing the arrangement of the print head of the photo-direct printer apparatus <b>1000</b> according to the embodiment.</p>
<p id="p-0035" num="0034">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, a print head cartridge <b>1200</b> in this embodiment has ink tanks <b>1300</b> which accommodates inks, and a print head <b>1301</b> which discharges inks supplied from the ink tanks <b>1300</b> from nozzles in accordance with print information. The print head <b>1301</b> employs a so-called cartridge scheme, which is detachably mounted in a carriage <b>1102</b>. In printing, the print head cartridge <b>1200</b> is reciprocated and scanned along a carriage shaft, and a color image is printed on a print sheet along with the operation of the print head cartridge <b>1200</b>. To achieve high-quality color printing like a photograph, for example, the black, light cyan (LC), light magenta (LM), cyan, magenta, and yellow ink tanks are independently set in the print head cartridge <b>1301</b> shown in <figref idref="DRAWINGS">FIG. 2</figref>. Each ink tank is detachable from the print head <b>1301</b>.</p>
<p id="p-0036" num="0035">In this embodiment, the apparatus using the above-described six color inks will be described. However, the present invention is not limited to this, and may be applied to an ink-jet printer which prints using four color inks, black, cyan, magenta, and yellow. In this case, each of four independent ink tanks may be detachably set in the print head <b>1301</b>.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> is a schematic view showing the operation panel <b>1010</b> according to this embodiment.</p>
<p id="p-0038" num="0037">In <figref idref="DRAWINGS">FIG. 3</figref>, the liquid crystal display <b>1006</b> displays menu items for various settings of data on items printed on the right and left of the display <b>1006</b>. The displayed items are the first photograph number of a print range, a designated frame number (start/designate), the last photograph number of the print range (end), the number of prints (number of copies), the type of paper (print sheet) used for printing (paper type), setting of the number of photographs to be printed on one paper sheet (layout), designation of the print quality (quality), designation whether to print a photographing date (date printing), designation whether to correct and print a photograph (image correction), and display of the number of paper sheets necessary for printing (number of paper sheets). These items are selected or designated with cursor keys <b>2001</b>. Reference numeral <b>2002</b> denotes a mode key which allows switching the type of printing (index printing, printing of all frames, printing of one frame, or the like) every time the key is pressed; numeral <b>2004</b> denotes a maintenance key for performing printer maintenance such as cleaning of the printer head; numeral <b>2005</b> denotes a print start key which is pressed to designate the start of printing or establish maintenance setting; and numeral <b>2006</b> denotes a stop key which is pressed to stop printing or designate to stop a maintenance processing.</p>
<p id="p-0039" num="0038">The arrangement of the main part concerning control of the photo-direct printer apparatus according to this embodiment will be explained with reference to <figref idref="DRAWINGS">FIG. 4</figref>. In <figref idref="DRAWINGS">FIG. 4</figref>, the same reference numerals as in the foregoing drawings denote the same parts, and a description thereof will be omitted.</p>
<p id="p-0040" num="0039">In <figref idref="DRAWINGS">FIG. 4</figref>, reference numeral <b>3000</b> denotes a controller (control board); numeral <b>3001</b> denotes an ASIC (application specific LSD whose arrangement will be described in detail below with reference to the block diagram of <figref idref="DRAWINGS">FIG. 4</figref>; numeral <b>3002</b> denotes a DSP (Digital Signal Processor) which incorporates a CPU and performs various control processes (to be described later), and image processes such as conversion from an RGB signal (RGB signal indicates three primary color signals for display and is also called a luminance signal) to a CMYK signal (CMY signal indicates three primary color signal for printing and a CMYK signal including a black signal is called a density signal), scaling, gamma conversion, and error diffusion; numeral <b>3003</b> denotes a memory having a program memory <b>3003</b><i>a </i>which stores the control program of the CPU of the DSP <b>3002</b>, a RAM area which stores variables and the like in executing a program, and a memory area functioning as a work memory which stores image data and various data; numeral <b>3004</b> denotes a printer engine which is an ink-jet print type printer engine for printing a color image by using a plurality of color inks in this embodiment; numeral <b>3005</b> denotes a connector serving as a port for connecting a digital camera <b>3012</b>; numeral <b>3006</b> denotes a connector for connecting the viewer <b>1011</b>; and numeral <b>3008</b> denotes a USB bus hub which transmits data from a PC <b>3010</b> and outputs the data to the printer engine <b>3004</b> via a USB bus <b>3021</b> when the printer apparatus <b>1000</b> performs printing based on image data from the PC <b>3010</b>. The connected PC <b>3010</b> can directly exchange data and signals with the printer engine <b>3004</b> and execute printing (functions as a general PC printer). Reference numeral <b>3009</b> denotes a power connector which receives from a power supply <b>3013</b> a DC voltage converted from a commercial AC voltage. The PC <b>3010</b> is a general personal computer. Reference numeral <b>3011</b> denotes a memory card (PC card) described above; and <b>3012</b>, the digital camera.</p>
<p id="p-0041" num="0040">Signal exchange between the controller <b>3000</b> and the printer engine <b>3004</b> is performed via the USB bus <b>3021</b> or an IEEE 1284 bus <b>3022</b>.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram mainly showing the arrangement of the ASIC <b>3001</b>. Also in <figref idref="DRAWINGS">FIG. 5</figref>, the same reference numerals as in the foregoing drawings denote the same parts, and a description thereof will be omitted.</p>
<p id="p-0043" num="0042">Reference numeral <b>4001</b> denotes a PC card interface which reads image data stored in the mounted PC card <b>3011</b> or writes data in the PC card <b>3011</b>; and numeral <b>4002</b> denotes an IEEE 1284 interface which exchanges data with the printer engine <b>3004</b>. The IEEE 1284 interface is a bus used to print image data stored in the digital camera <b>3012</b> or PC card <b>3011</b>. Reference numeral <b>4003</b> denotes a USB interface which exchanges data with the PC <b>3010</b>; numeral <b>4004</b> denotes a USB host interface which exchanges data with the digital camera <b>3012</b>; numeral <b>4005</b> denotes an operation panel interface which receives various operation signals from the operation panel <b>1010</b> or outputs display data to the display <b>1006</b>; numeral <b>4006</b> denotes a viewer interface which controls display of image data on the viewer <b>1011</b>; numeral <b>4007</b> denotes an interface which controls an interface between various switches, an LED <b>4009</b>, and the like; numeral <b>4008</b> denotes a CPU interface which controls data exchange between these interfaces and the DSP <b>3002</b>; and numeral <b>4010</b> denotes an internal bus (ASIC bus) which is connected to these units. The DSP <b>3002</b> parallelly performs control of the photo-direct printer apparatus <b>1000</b> and image processing such as conversion from a luminance signal (RGB) to a density signal (CMYK), scaling, gamma conversion, and error diffusion. The control of the photo-direct printer apparatus <b>1000</b> includes processing of accessing the PC card <b>3011</b> and digital camera <b>3012</b> by controlling, e.g., the PC card I/F <b>4001</b> and USB host I/F <b>4004</b>.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 6</figref> is a functional block diagram showing the interfaces and the arrangement of functions for image processing control of the photo-direct printer apparatus <b>1000</b> according to the embodiment. Also in <figref idref="DRAWINGS">FIG. 6</figref>, the same reference numerals as in the foregoing drawings denote the same parts, and a description thereof will be omitted.</p>
<p id="p-0045" num="0044">Reference numeral <b>6000</b> corresponds to a host (image data source) when seen from the photo-direct printer apparatus <b>1000</b>. The host <b>6000</b> includes the PC <b>3010</b> serving as the host computer, the digital camera <b>3012</b>, and the PC card <b>3011</b> described above, and a game machine, television device (neither is shown), and the like. The host <b>6000</b> is connected via an interface such as a USB bus, IEEE 1284, or IEEE 1394. As the interface, Bluetooth or the like may be used.</p>
<p id="p-0046" num="0045">The function of the control board <b>3000</b> described above further includes a data input/storage processor <b>6001</b> and a printer interface <b>6004</b> for outputting print data to the printer engine <b>3004</b>, which are implemented by the ASIC <b>3001</b>, and a multi-renderer section <b>6002</b> and image processing and process section <b>6003</b> executed by the DSP <b>3002</b>.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 7</figref> is a functional block diagram showing the arrangement of the functions for image processing control in the photo-direct printer apparatus <b>1000</b> according to the embodiment in more detail. Also in <figref idref="DRAWINGS">FIG. 7</figref>, the same reference numerals as in the foregoing drawings denote the same parts, and a description thereof will be omitted.</p>
<p id="p-0048" num="0047">In <figref idref="DRAWINGS">FIG. 7</figref>, image data or JPEG-compressed image data input from the PC card <b>3011</b>, camera <b>3012</b>, or PC <b>3010</b> via an interface <b>7005</b> such as a USB bus interface is temporarily stored in an image buffer <b>7000</b>. If the stored data is compressed data, it is decompressed in a JPEG decompressor <b>7006</b>, the decompressed data is converted from Y, Cb, and Cr signals into R, G, and B signals, and the converted signal is then stored in an RGB buffer <b>7001</b>. A 3D3 (<b>7007</b>) converts the color space of RGB data by looking up a look-up table <b>7009</b>. A 3D6 (<b>7008</b>) converts R, G, and B signals into signals for six colors of C, M, Y, K, LC (light cyan), and LM (light magenta) by looking up the look-up table <b>7009</b>. Reference numeral <b>7010</b> denotes an X-Y scaling unit which changes image sizes in the X and/or Y direction. Reference numeral <b>7011</b> denotes a 1D output unit which executes color processing such as γ conversion by looking up a one-dimensional table <b>7012</b>. Reference numeral <b>7012</b> denotes an error diffusion (ED) unit which executes error diffusion processing for multilevel image data to generate binarized image data (or multilevel data) for each color. The binarized (or multilevel) image data generated in this manner is stored in an ED buffer <b>7003</b>. Reference numeral <b>7004</b> denotes a work buffer which stores print data corresponding to each of a plurality of print heads discharging inks of respective colors. The generated print data corresponding to each print head is transmitted to the printer engine <b>3004</b> via a printer interface <b>7013</b>, and printing is performed.</p>
<p id="p-0049" num="0048">In <figref idref="DRAWINGS">FIG. 7</figref>, the X-Y scaling unit <b>7010</b> performs size change processing for an image in the X and/or Y direction after processing by the 3D6 (<b>7008</b>). However, the present invention is not limited to this, and as will be described later with reference to <figref idref="DRAWINGS">FIG. 11</figref>, the size change processing may be performed before color conversion to RGB data.</p>
<p id="p-0050" num="0049">As described above, in the photo-direct printer apparatus <b>1000</b>, the DSP <b>3002</b> executes control of each unit of the apparatus <b>1000</b> in addition to image processing. The DSP <b>3002</b> also has a parallel processing function and can parallelly execute the 3D3 processing, 3D6 processing, X-Y scaling, 1D output processing, error diffusion processing, and the like. The DSP <b>3002</b> is, e.g., TMS320DSP available from Texas Instruments (TI), which executes control (to be described later) in accordance with a control program stored in the program memory <b>3003</b><i>a </i>shown in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0051" num="0050">This control program is arranged in a multitask form in which a task is created for each functional module. <figref idref="DRAWINGS">FIG. 8</figref> shows a main task structure.</p>
<p id="p-0052" num="0051">In <figref idref="DRAWINGS">FIG. 8</figref>, reference numeral <b>8000</b> denotes a system control task which arbitrates an entire system, e.g., issues each event between tasks, controls a sequence at the end of an event, and performs exclusive processing. Reference numeral <b>8001</b> denotes a key event task <b>8001</b> which analyzes a pressed key on the basis of key operation in the operation panel <b>1010</b>. Reference numeral <b>8002</b> denotes a display task for the LCD <b>1006</b>, which is activated at the time when a UI control request, message display request, or the like is made on the display <b>1006</b>, and executes display control to the display <b>1006</b>. Reference numeral <b>8003</b> denotes tasks activated by reading/writing data from/in the PC card <b>3011</b> or inputting/outputting to/from data via IEEE 1304 interface or Bluetooth. Reference numeral <b>8004</b> denotes a USB printer task activated by data transfer from the PC <b>3010</b> connected via the USB bus. The USB printer task <b>8004</b> is activated by a printer interrupt sent via a USB bus and executes a function serving as a PC printer. A USB storage task <b>8005</b> is activated by the system control task <b>8005</b> starts/ends a USB control task and USB bulk task which are lower tasks in accordance with a message from the system control task <b>8000</b>. A pseudo USB host task <b>8006</b> is activated by the USB task and executes data read from the digital camera <b>3012</b> connected via a USB bus and various types of communication controls. Reference numeral <b>8007</b> denotes a file task which performs input/output control such as file open, file close, file read, and file write. Reference numeral <b>8008</b> denotes a task activated from a Centronics interface connected to the printer engine <b>3004</b>. The task <b>8008</b> executes DMA transmission of print data, status reply, and the like. Reference numeral <b>8009</b> denotes an image processing task which receives RGB data, generates YMCK data by 3D processing, tetrahedron interpolation, color conversion, scaling, and error diffusion described above, and finally generates raster image data which is to be output to the printer engine <b>3004</b>. Reference numeral <b>8010</b> denotes a page create task which expands JPEG data to convert it into image data, generates image data from data in a BMP format, or generates image data from an HTML document. In addition, the page create task <b>8010</b> performs image processing such as photograph data correction and grayscale correction and generates RGB data. Reference numeral <b>8011</b> denotes a viewer task which executes display control to the viewer <b>1011</b> when the viewer <b>3011</b> has been connected.</p>
<p id="p-0053" num="0052">The outline of processing performed by the DSP <b>3002</b> of the photo-direct printer apparatus <b>1000</b> according to the embodiment will be described with reference to the flow charts in <figref idref="DRAWINGS">FIGS. 9 to 12</figref>. Note that since this processing by the DSP <b>3002</b> is executed in the multi-task, the flow of whole processing will be described here.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 9</figref> is a flow chart showing the outline of processing performed by the DSP <b>3002</b> according to the embodiment.</p>
<p id="p-0055" num="0054">This processing is started by receiving image data from the PC card <b>3011</b> or digital camera <b>3012</b> and inputting the received data. In step S<b>1</b>, the CPU performs page create processing. In the page create processing, the CPU sets the format of page data. The process proceeds to step S<b>2</b> and the image processing <b>1</b> is executed. Then image processing <b>2</b> is executed in step S<b>3</b>, and image processing <b>3</b> is executed in step S<b>4</b>. The image processing <b>1</b> to image processing <b>3</b> will be described later with reference to <figref idref="DRAWINGS">FIGS. 10 to 12</figref>, which are executed in parallel. The processing unit of the image data to be processed herein is 16 rasters.</p>
<p id="p-0056" num="0055">After image processing has ended and print data is generated, the process proceeds to step S<b>5</b> and the generated print data is transferred to the printer engine <b>3004</b> by DMA. The process proceeds to step S<b>6</b>, in order to read out data to be processed next, the address of the image buffer <b>7000</b> is incremented by 16 rasters to update the address. The process proceeds to step S<b>7</b>, it is checked whether image data of one page has been processed. If NO in step S<b>7</b>, the process proceeds to step S<b>2</b> to repeat the above processing. If YES in step S<b>7</b>, the CPU ends the processing.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 10</figref> is a flow chart for explaining the image processing <b>1</b> in step S<b>2</b> of <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0058" num="0057">In step S<b>11</b>, image data of the JPEG or TIFF format is decompressed. For example, in general decompression processing for JPEG data, decoding the Huffman code, inverse quantization, and inverse discrete cosine transformation are sequentially executed, resulting in generating Y, Cb, and Cr data. The process proceeds to step S<b>12</b> and the Y, Cb, and Cr data are converted into R, G, and B data. This conversion is performed by using the conversion formula recommended by ITU-R BT. 601.</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 11</figref> is a flow chart for explaining the image processing <b>2</b> in step S<b>3</b> of <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0060" num="0059">In step S<b>21</b>, enlargement/reduction processing in the X direction (in this case, the X direction is a raster direction) is performed. The process proceeds to step S<b>22</b> and enlargement/reduction processing in the Y direction (the Y direction is the nozzle array direction of the print head <b>1301</b>) is performed. These processes are performed to enlarge/reduce an image by linear interpolation so as to match the image to an actual print region. The process proceeds to step S<b>23</b> and RGB color components are converted into R*G*B* color components. In step S<b>23</b>, 8-bit R, G, and B data are respectively converted into 8-bit R*, G*, and B* data by using the three-dimensional look up table (LUT) <b>7009</b>. This processing is called color space conversion (color preprocessing), which is used for correcting the difference between the color space of an input image and a reproduction color space in the printer engine <b>3004</b>. As shown in <figref idref="DRAWINGS">FIG. 18</figref>, in this color conversion, each color component is represented by, e.g.,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R*=R×C</i><sub>0</sub><i>+d</i><sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>G*=G×C</i><sub>1</sub><i>+d</i><sub>1 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>B*=B×C</i><sub>2</sub><i>+d</i><sub>2 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
This calculation and processing for storing the calculation results in the memory <b>3003</b> are executed by the DSF <b>3002</b> in one instruction (note that these equations are used for explanation, and each of C<sub>0</sub>, C<sub>1</sub>, C<sub>2</sub>, d<sub>0</sub>, d<sub>1</sub>, and d<sub>2 </sub>is a predetermined constant).
</p>
<p id="p-0061" num="0060">In step S<b>24</b>, the RGB color components are converted into CMYK color components. In this processing, 8-bit R*, G*, and B* data obtained by the color space conversion are converted into six, i.e., 8-bit C, M, Y, K, LC, and LM data by using the three-dimensional LUT <b>7009</b>. This processing is color conversion (called as color post-processing) in which the RGB colors of an input system are converted into the CMYK colors of an output system.</p>
<p id="p-0062" num="0061">Such color conversion is performed because the additive three primary colors (RGB) of an illuminant such as a display in most cases are used for image data to be input, but the colorants of the subtractive three primary colors (CMY) are used when colors are represented by the reflection of light from the printer. The three-dimensional LUTs <b>7009</b> used in the color preprocessing and color post-processing hold data discretely, and values between the held data are obtained by interpolation. Such interpolation is well-known and a detailed description thereof will be omitted.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 12</figref> is a flow chart for explaining the image processing <b>3</b> in step S<b>4</b> of <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0064" num="0063">In step S<b>31</b>, gamma conversion is performed to the C, M, Y, K, LC, and LM image data to adjust their densities. In this processing, the 8-bit C, M, Y, K, LC, and LM data undergo γ correction by using the one-dimensional LUT <b>7012</b>. Since the relationship between output characteristics (reflection density and the like) and the number of print dots per unit area does not have any linear relationship in most cases, γ correction is performed to ensure the linear relationship between the input levels of the 8-bit C, M, Y, K, LC, and LM data and the corresponding output characteristics. If a detection means for detecting color misregistration in a print image detects the individual differences of the output characteristics of the print heads which print the respective colorants, color misregistration due to the individual differences can be prevented by changing data used for the γ correction in the one-dimensional LUT <b>7012</b>. For example, if the output characteristic value of a print head which prints a C colorant is larger than an expectation value, the input/output relationship of the one-dimensional LUT <b>7012</b> is changed to reproduce a desired grayscale. This can realize individual difference correction for the print head in each apparatus.</p>
<p id="p-0065" num="0064">The process proceeds to step S<b>32</b> and binarization processing (error diffusion) is executed. The printer engine <b>3004</b> in this embodiment is used for a binary, ternary, or quaternary data printing apparatus (a case using a binary data printing apparatus will be described here) capable of smoothly representing a half-tone image like a photograph, in which 8-bit C, M, Y, K, LC, and LM image data are respectively quantized to 1- or 2-bit C, M, Y, K, LC, and LM data by the error diffusion method.</p>
<p id="p-0066" num="0065">As shown in <figref idref="DRAWINGS">FIG. 19</figref>, an R color component is taken as an example. The DSP <b>3002</b> executes, in one instruction, processing of comparing the grayscale value of R with its threshold (“128” in this case) and processing for storing in the memory <b>3003</b> the results of two calculations of R−D<sub>0 </sub>and R−D<sub>1 </sub>performed to obtain the errors of compared values (where D<sub>0</sub>=0, D<sub>1</sub>=255). In accordance with the comparison results, a smaller one of the results of calculations of R−D<sub>0 </sub>and R−D<sub>1 </sub>is stored in the memory <b>3003</b>. (If the grayscale value is equal to or smaller than “128”, R−D<sub>0 </sub>is stored as the error value, and if the grayscale value is larger than “128”, R−D<sub>1 </sub>is stored as the error value). Such a quantization method using the error diffusion method is well-known, and a detailed description will be omitted.</p>
<p id="p-0067" num="0066">The outline of the operation based on the above arrangement will be described.</p>
<p id="h-0006" num="0000">&lt;General PC Printer Mode&gt;</p>
<p id="p-0068" num="0067">The general PC printer mode is a print mode in which an image is printed on the basis of print data from the PC <b>3010</b>.</p>
<p id="p-0069" num="0068">In this mode, when print data from the PC <b>3010</b> is input via the connector <b>1013</b>, the print data is directly sent to the printer engine <b>3004</b> via the USB bus hub <b>3008</b> and USB bus <b>3021</b>. Printing is executed based on the print data from the PC <b>3010</b>.</p>
<p id="h-0007" num="0000">&lt;Direct Print Mode from PC Card&gt;</p>
<p id="p-0070" num="0069">When the PC card <b>3011</b> is mounted/dismounted in/from the card slot <b>1009</b>, an interrupt occurs, and the DSP <b>3002</b> can detect mounting/dismounting (removal) of the PC card <b>3011</b>. If the PC card <b>3011</b> is mounted, image data which is compressed (e.g., JPEG-compressed) and stored in the PC card <b>3011</b> is read out and stored in the memory <b>3003</b>. The compressed image data is decompressed and stored in the memory <b>3003</b> again. If printing of the stored image data is designated on the operation panel <b>1010</b>, conversion from an RGB signal to a YMCK signal, gamma correction, error diffusion, and the like are executed to convert the data into print data printable by the printer engine <b>3004</b>. The resultant data is output to the printer engine <b>3004</b> via the IEEE 1284 interface <b>4002</b> to print the data.</p>
<p id="h-0008" num="0000">&lt;Direct Print Mode from Camera&gt;</p>
<p id="p-0071" num="0070">By connecting the photo-direct printer apparatus <b>1000</b> according to this embodiment and the digital camera <b>3012</b> via a cable, image data from the digital camera <b>3012</b> can be directly printed by the printer <b>1000</b>.</p>
<p id="p-0072" num="0071">In this case, the display <b>1006</b> of the operation panel <b>1010</b> displays only a camera mark <b>6000</b>. The display and operation on the operation panel <b>1010</b> are invalidated, and display on the viewer <b>1011</b> is also invalidated. As subsequent operation, only key operation on the digital camera <b>3012</b> and image display on the display (not shown) of the digital camera <b>3012</b> are valid. The user can designate printing by using the digital camera <b>3012</b>.</p>
<p id="p-0073" num="0072">Processing in the photo-direct printer apparatus <b>1000</b> according to the embodiment based on the above arrangement will be explained with reference to flow charts shown in <figref idref="DRAWINGS">FIGS. 13 to 16</figref>. This processing is executed by multitask processing by the CPU of the DSP <b>3002</b>.</p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 13</figref> is a flow chart showing processing when the photo-direct printer apparatus <b>1000</b> and digital camera <b>3012</b> are connected.</p>
<p id="p-0075" num="0074">In step S<b>41</b>, it is checked whether the digital camera <b>3012</b> has been connected to the USB bus by the USB host task. If YES in step S<b>41</b>, the process proceeds to step S<b>42</b> and an “ON” camera flag is set in the memory <b>3003</b> to represent that the digital camera <b>3012</b> has been connected. The process proceeds to step S<b>43</b> and it is checked whether the print mode by the PC card <b>3011</b> or the print mode based on data from the PC <b>3010</b> is being executed. If YES in step S<b>43</b>, the process waits until the end of the mode, and advances to step S<b>44</b>. The camera mark <b>6000</b> is displayed on the display <b>1006</b> of the operation panel <b>1010</b>, and it notifies the user of connection of the digital camera <b>3012</b>. The process advances to step S<b>45</b>, image data is received from the digital camera, and printed, in accordance with an operation instruction input from the operation unit of the digital camera <b>3012</b>, an image which is sensed by the digital camera <b>3012</b> and stored in the storage medium of the camera <b>3012</b>.</p>
<p id="p-0076" num="0075">If the digital camera <b>3012</b> is not connected but its connection is canceled, i.e., the digital camera <b>3012</b> is disconnected in step S<b>41</b>, the process proceeds to step S<b>46</b> and it is checked whether the camera flag is ON, i.e., whether the camera <b>3012</b> has been connected and is disconnected first. If YES in step S<b>46</b>, the process proceeds to Step S<b>47</b>, the camera flag is set to OFF, and the camera mark <b>6000</b> displayed on the display <b>1006</b> is removed in step S<b>48</b>. The process proceeds to step S<b>49</b> and it is checked whether a card flag representing mounting of the PC card <b>3011</b> is ON. If YES in step S<b>49</b>, the process advances to step S<b>50</b> for read of image data from the PC card <b>3011</b> which has been invalid, and print processing of the readout image data. The process proceeds to these processes because read of image data from the PC card <b>3011</b> and its print processing may be suspended while the digital camera <b>3012</b> was connected. If NO in step S<b>46</b> or S<b>49</b>, the process is ended.</p>
<p id="p-0077" num="0076"><figref idref="DRAWINGS">FIG. 14</figref> is a flow chart for explaining print processing of PC card data along with mounting of the PC card <b>3011</b> or processing along with dismounting of the PC card <b>3011</b>.</p>
<p id="p-0078" num="0077">Mounting/dismounting of the PC card <b>3011</b> is detected by an interrupt. In step S<b>51</b>, it is checked whether the PC card <b>3011</b> is mounted or dismounted. If the PC card <b>3011</b> is mounted, the process proceeds to step S<b>52</b> and an “ON” card flag representing that the PC card <b>3011</b> is mounted, is set. Then, the process advances to step S<b>53</b> and it is whether the camera <b>3012</b> has been connected, based on the camera flag. If the camera flag is ON, the process is ended without receiving data.</p>
<p id="p-0079" num="0078">If the camera flag is OFF, the process proceeds to step S<b>54</b> and it is checked whether a print job is being executed in the PC mode, i.e., in accordance with a print instruction from the PC <b>3010</b>. If NO in step S<b>54</b>, the process proceeds to step S<b>59</b>; if YES, the process proceeds to step S<b>55</b>, waits until the print job ends, and then advances to step <b>556</b>. In step S<b>59</b>, it is checked whether the PC <b>3010</b> is writing data in the PC card <b>3011</b>. If YES in step S<b>59</b>, the process waits until the end of write processing, and advances to step S<b>56</b>. In step S<b>56</b>, data is read out from the PC card <b>3011</b> in accordance with an operation instruction received from the operation panel <b>1010</b>. In step <b>557</b>, the readout image data is printed in accordance with an instruction from the operation panel <b>1010</b>.</p>
<p id="p-0080" num="0079">If the PC card <b>3011</b> is dismounted in step S<b>51</b>, the process proceeds to step S<b>58</b>, the card flag is set to OFF, and it is stored that the PC card <b>3011</b> is dismounted.</p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 15</figref> is a flow chart for explaining processing of receiving and printing print data from the PC <b>3010</b>.</p>
<p id="p-0082" num="0081">Upon reception of print data from the PC <b>3010</b>, in step S<b>61</b>, it is checked whether the camera flag is ON, i.e., the digital camera <b>3012</b> has been connected. If YES in step S<b>61</b>, the process advances to step S<b>62</b>, and it is checked whether data from the connected digital camera <b>3012</b> is printing. If NO in step S<b>62</b>, or data from the camera <b>3012</b> is being printed in step S<b>62</b>, the process waits until the end of the print processing, advances to step S<b>63</b>, and data is received from the PC <b>3010</b> to execute print processing. The process repeats the processing in steps S<b>63</b> and S<b>64</b> until print processing is ended in step S<b>64</b>. When printing of data from the PC <b>3010</b> ends, the process is ended while keeping ON the camera flag representing connection to the digital camera <b>3012</b> (keeping connection to the digital camera <b>3012</b>).</p>
<p id="p-0083" num="0082">If the camera flag is OFF (the camera <b>3012</b> is disconnected) in step S<b>61</b>, the process advances to step S<b>65</b> and it is checked whether the card flag is ON, i.e., the PC card <b>3011</b> has been connected. If NO in step <b>565</b>, the process proceeds to step S<b>67</b>; if YES, the process proceeds to step S<b>66</b>, and it is checked whether print processing of image data from the PC card <b>3011</b> is being executed. If NO in step S<b>66</b>, the process returns to step S<b>65</b>, and waits until printing of image data from the PC card <b>3011</b> ends. Then, the process proceeds from step S<b>66</b> to step S<b>67</b> and executes a general PC printer operation of receiving and printing image data sent from the PC <b>3010</b>.</p>
<p id="p-0084" num="0083"><figref idref="DRAWINGS">FIG. 16</figref> is a flow chart showing access from the PC <b>3010</b> to the PC card <b>3011</b>.</p>
<p id="p-0085" num="0084">If an access request from the PC <b>3010</b> to the PC card <b>3011</b> is input, the process proceeds to step S<b>71</b> and it is checked whether the card flag is ON. If NO in step S<b>71</b>, this means that the PC card <b>3011</b> is not mounted. The process notifies the PC <b>3010</b> of a message to this effect, and ends the processing. If YES in step S<b>71</b>, the process proceeds to step S<b>72</b> and it is checked whether the camera flag is ON, i.e., the digital camera <b>3012</b> has been connected. If YES in step S<b>72</b>, the process proceeds to step S<b>73</b>, time-divides data exchange with the digital camera <b>3012</b>, and permits access from the PC <b>3010</b> to the PC card <b>3011</b> by the divided time.</p>
<p id="p-0086" num="0085">If NO in step S<b>72</b>, the process advances to step S<b>74</b> and it is checked whether the PC <b>3010</b> outputs an instruction of designating readout of data from the PC card <b>3011</b>. If YES in step S<b>74</b>, the process proceeds to step S<b>77</b> and image data is read out from the PC card <b>3011</b>. This is because readout of the contents of the PC card <b>3011</b> does not influence other processes which are being executed even while the contents of the PC card <b>3011</b> are being printed.</p>
<p id="p-0087" num="0086">If the PC <b>3010</b> does not output an instruction of designating readout of data from the PC card <b>3011</b> in step S<b>74</b>, i.e., the PC <b>3010</b> outputs a data write instruction to the PC card <b>3011</b>, the process proceeds to step S<b>75</b> and it is checked whether data in the PC card <b>3011</b> is being printed. If YES in step S<b>75</b>, no contents in the PC card <b>3011</b> can be changed, and the process is ended. If NO in step S<b>75</b>, the process proceeds to step S<b>76</b> and data writing operation of the PC card <b>3011</b> is executed in accordance with an access request from the PC <b>3010</b>.</p>
<p id="p-0088" num="0087">Thus, even while the digital camera <b>3012</b> is connected, the PC <b>3010</b> can access the PC card <b>3011</b>.</p>
<p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. 17</figref> is a table for explaining each state of processing succeeding the preceding processing, which is based on the above-described contents.</p>
<p id="p-0090" num="0089">For example, referring to a column <b>1701</b>, if a print instruction is received from the PC <b>3010</b> during printing the contents of the PC card <b>3011</b>, the execution of print instruction is suspended until the end of print processing of data from the PC card <b>3011</b>, and then print processing based on the print instruction from the PC <b>3010</b> is executed. If an access request from the PC <b>3010</b> to the PC card <b>3011</b> is received, the access request is executed if the access request is a read request. If the received request is a write request, the write processing based on the write request is suspended until the end of print processing of data from the PC card <b>3011</b>, and then the write processing to the PC card based on the write request is executed. If the digital camera is connected during printing the contents of the PC card <b>3011</b>, and a print instruction from the camera <b>3012</b> is received, the execution of print instruction is suspended until the end of print processing of data from the PC card <b>3011</b>, and then the print processing based on the print instruction from the digital camera <b>3012</b> is executed.</p>
<p id="p-0091" num="0090">Referring to a column <b>1702</b>, if a print instruction for the contents of the PC card is received during printing based on data from the PC <b>3010</b>, the execution of print instruction is suspended until the end of the print processing of the print data from the PC <b>3010</b>, and then the print processing based on the data from the PC card <b>3011</b> is executed. If an access request from the PC <b>3010</b> to the PC card <b>3011</b> is received during print processing based on data from the PC <b>3010</b>, the access request is parallelly executed. This is because the contents of the PC card <b>3011</b> are not being printed, and a change in contents of the PC card <b>3011</b> does not influence other processes. If a print instruction is received from the digital camera <b>3012</b> during printing based on data from the PC <b>3010</b>, the print processing is suspended until the end of the print processing of data from the PC <b>3010</b>, and then the print processing based on the print instruction from the digital camera <b>3012</b> is executed.</p>
<p id="p-0092" num="0091">Referring to a column <b>1703</b>, assume that a print instruction for the contents of the PC card <b>3011</b> is received during reading/writing data from/in the PC card <b>3011</b> on the basis of an access request from the PC <b>3010</b> to the PC card <b>3011</b>. In this case, if the access request from the PC <b>3010</b> to the PC card <b>3011</b> is a read instruction, a print operation of the contents of the PC card <b>3011</b> is immediately executed. If, however, the access request from the PC <b>3010</b> to the PC card <b>3011</b> is a write instruction, the contents of the PC card <b>3011</b> are not printed as long as the write processing has been continued. If a print instruction from the PC <b>3010</b> is received while the PC <b>3010</b> accesses the PC card <b>3011</b>, the access processing of the PC <b>3010</b> for the PC card <b>3011</b> and print processing based on data from the PC <b>3010</b> are parallelly executed. Similarly, if a print instruction from the digital camera <b>3012</b> is received during execution of an access request from the PC <b>3010</b> to the PC card <b>3011</b>, the access processing of the PC <b>3010</b> for the PC card <b>3011</b> and print processing based on data from the digital camera <b>3012</b> are parallelly executed.</p>
<p id="p-0093" num="0092">Referring to a column <b>1704</b>, if a print instruction for the contents of the PC card is received during printing based on data from the digital camera <b>3012</b>, this print instruction is ignored and not executed. If a print request from the PC <b>3010</b> is received during print processing based on data from the digital camera <b>3012</b>, the print processing based on the data from the PC <b>3010</b> is executed after the print processing based on data from the digital camera <b>3012</b> ends. After the end of the print job based on the print request from the PC <b>3010</b>, the connection to the digital camera <b>3012</b> is again enabled. If an access request from the PC <b>3010</b> to the PC card <b>3011</b> is received, the access request is executed. This is because the contents of the PC card <b>3011</b> are not being printed, and a change in contents of the PC card <b>3011</b> does not influence other processes. If an access request from the PC <b>3010</b> to the PC card <b>3011</b> is received during printing based on data from the digital camera <b>3012</b>, the access request is executed. This is because the contents of the PC card <b>3011</b> are not being printed, and a change in contents of the PC card <b>3011</b> does not influence other processes.</p>
<p id="p-0094" num="0093">In the above description, the top priority is given to digital camera operation when the digital camera is connected. For example, which of the digital camera, PC card, and PC is given the top priority may be arbitrarily set.</p>
<p id="p-0095" num="0094">Alternatively, the top priority may be given to the digital camera as a default, and manually given to the PC card or PC by the user.</p>
<p id="p-0096" num="0095">For example, a switch which always enables display on the viewer <b>1011</b> may be arranged, and even when the digital camera is connected, image data from the camera may be displayed on the viewer <b>1011</b>. The switch for this setting may also be arranged on, e.g., the operation panel <b>1010</b>, or may be another switch on the apparatus.</p>
<p id="p-0097" num="0096">The present invention may be applied to a system constituted by a plurality of devices (e.g., a host computer, interface device, reader, and printer) or an apparatus (e.g., a copying machine or facsimile apparatus) formed from a single device.</p>
<p id="p-0098" num="0097">The object of the present invention is also achieved when a storage medium (or recording medium) which stores software program codes for realizing the functions of the above-described embodiment is supplied to a system or apparatus, and the computer (or the CPU or MPU) of the system or apparatus reads out and executes the program codes stored in the storage medium. In this case, the program codes read out from the storage medium realize the functions of the above-described embodiment, and the storage medium which stores the program codes constitutes the present invention. The functions of the above-described embodiment are realized when the computer executes the readout program codes. Also, the functions of the above-described embodiment are realized when an OS (Operating System) running on the computer performs part or all of actual processing on the basis of the instructions of the program codes.</p>
<p id="p-0099" num="0098">The functions of the above-described embodiment are also realized when the program codes read out from the storage medium are written in the memory of a function expansion card inserted into the computer or the memory of a function expansion unit connected to the computer, and the CPU of the function expansion card or function expansion unit performs part or all of actual processing on the basis of the instructions of the program codes.</p>
<p id="p-0100" num="0099">As has been described above, according to the above-described embodiment, a printer apparatus which is connected to a PC, memory card, and digital camera, receives image data from them, and prints the image data can execute image processing at a high speed and perform printing.</p>
<p id="p-0101" num="0100">In the above-described embodiment, a digital camera is exemplified as an image sensing apparatus, but the present invention is not limited to this. In recent years, for example, there is known a cell phone with a function of saving sensed or received image data. Such a cell phone may be connected via a connection cable, instead of a digital camera described in the embodiment.</p>
<p id="p-0102" num="0101">As a portable information terminal, PDAs (Personal Digital Assistants) with a liquid crystal monitor capable of displaying an image and a memory capable of saving a sensed image are recently being available. Such a PDA may be connected to the printer apparatus via a connection cable, and may store image data saved in the PDA, similar to the digital camera of the above-described embodiment.</p>
<p id="p-0103" num="0102">According to the photo-direct printer apparatus of this embodiment, one printer apparatus can implement the functions of a PC printer, camera printer, and memory printer.</p>
<p id="p-0104" num="0103">The present invention is not limited to the above embodiments and various changes and modifications can be made within the spirit and scope of the present invention. Therefore, to apprise the public of the scope of the invention, the following claims are made.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A recording apparatus comprising:
<claim-text>recording means for recording an image on a recording medium on the basis of recording data;</claim-text>
<claim-text>input means for inputting image data from an image data source;</claim-text>
<claim-text>image processing means for decoding the image data input by said input means and executing image processing on the decoded image data to generate recording data; and</claim-text>
<claim-text>control means for outputting the recording data to said recording means to record an image,</claim-text>
<claim-text>wherein said image processing means comprises a digital signal processor and a memory, the digital signal processor comprises means for executing one or more of color space conversion processing, size change processing, color conversion processing, and binarization processing in parallel on a predetermined amount of the image data, and</claim-text>
<claim-text>a program implemented by the digital signal processor is arranged in a multitask form for executing a plurality of tasks, the plurality of tasks including at least a task for executing the image processing of said image processing means and a task for inputting image data of said input means.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said image processing means includes a memory for storing a control program executed by a CPU and the digital signal processor incorporates the CPU.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the predetermined amount of image data is a raster unit of image data.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the plurality of tasks further comprises a task for executing output the recording data of said control means.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a console unit for designating an operation of the recording apparatus, wherein the plurality of tasks further comprises a task for processing an operation using the console unit.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the image data source includes any one of a digital camera, a PC and a host computer.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A recording method comprising:
<claim-text>an input step of inputting image data from an image data source;</claim-text>
<claim-text>an image processing step of decoding the image data input in said input step and executing image processing on the decoded image data to generate recording data; and</claim-text>
<claim-text>a recording step of recording an image on a recording medium on the basis of the recording data,</claim-text>
<claim-text>wherein said image processing step is implemented using a digital signal processor, in said image processing step, one or more of color space conversion processing, size change processing, color conversion processing and binarization processing are executed in parallel on a predetermined amount of the image data, said input step is executed using the digital signal processor, and a program implemented by the digital signal processor is arranged in a multitask form for executing a plurality of tasks including at at least a task for executing the image processing in said image processing step and a task for inputting image data in said input step.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein said image processing step is implemented by a CPU and the digital signal processor incorporates the CPU for executing a control program stored in a memory.</claim-text>
</claim>
</claims>
</us-patent-grant>
