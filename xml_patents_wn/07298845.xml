<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298845-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298845</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11015252</doc-number>
<date>20041217</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>10-295920</doc-number>
<date>19981016</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>JP</country>
<doc-number>10-339027</doc-number>
<date>19981130</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>439</us-term-extension>
<disclaimer>
<text>This patent is subject to a terminal disclaimer.</text>
</disclaimer>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>N</subclass>
<main-group>7</main-group>
<subgroup>167</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>32</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>380201</main-classification>
<further-classification>380201</further-classification>
<further-classification>713189</further-classification>
<further-classification>713193</further-classification>
</classification-national>
<invention-title id="d0e91">Digital content protection system</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5109152</doc-number>
<kind>A</kind>
<name>Takagi et al.</name>
<date>19920400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5703950</doc-number>
<kind>A</kind>
<name>Jovanovich et al.</name>
<date>19971200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5754648</doc-number>
<kind>A</kind>
<name>Ryan et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5754649</doc-number>
<kind>A</kind>
<name>Ryan et al.</name>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5949881</doc-number>
<kind>A</kind>
<name>Davis</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6286008</doc-number>
<kind>B1</kind>
<name>Matsumoto et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6421779</doc-number>
<kind>B1</kind>
<name>Kuroda et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>EP</country>
<doc-number>0 715 242</doc-number>
<kind>A1</kind>
<date>19960600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>JP</country>
<doc-number>2-44389</doc-number>
<date>19990200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>WO</country>
<doc-number>95/12200</doc-number>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>“Trends in Digital Copy Protection Technologies,” by K. Yamanaka et al., NTT Review, JP Telecommunications Association, vol. 11, No. 1, pp. 108-115, Jan. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Bruce Schneier (Applied Cryptography, 1996, John Wiley and Sons, Inc., Second Edition, pp. 52-57).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>“Copyright Protection in Multimedia on Demand Services,” by K. Yamanaka et al., NTT R&amp;D, vol. 44, No. 9, 1995, pp. 813-818 (with partial translation).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>“Guide to Encryption Theory,” by E. Okamoto, Kyoritsu Shuppan Co., Ltd., 1993, p. 110 (with partial translation).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>The First Office Action issued in the corresponding Chinese Patent Application No. 200310119963.5 with English translation, issued May 27, 2005 by the Patent Office of the People's Republic of China.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>380200-201</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380277</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 44</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380281-282</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380284</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 46</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380168-169</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713189</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713193</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713168-169</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>35</number-of-drawing-sheets>
<number-of-figures>35</number-of-figures>
</figures>
<us-related-documents>
<division>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>09419240</doc-number>
<kind>00</kind>
<date>19991015</date>
</document-id>
<parent-grant-document>
<document-id>
<country>US</country>
<doc-number>6859535</doc-number>
<kind>A </kind>
</document-id>
</parent-grant-document>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>11015252</doc-number>
</document-id>
</child-doc>
</relation>
</division>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050102527</doc-number>
<kind>A1</kind>
<date>20050512</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Tatebayashi</last-name>
<first-name>Makoto</first-name>
<address>
<city>Takarazuka</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Nakamura</last-name>
<first-name>Yutaka</first-name>
<address>
<city>Kyoto</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Harada</last-name>
<first-name>Shunji</first-name>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kozuka</last-name>
<first-name>Masayuki</first-name>
<address>
<city>Arcadia</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Matsushita Electric Industrial Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Osaka-Fu</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Song</last-name>
<first-name>Hosuk</first-name>
<department>2135</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The media inherent key storing unit <b>220</b> prestores an inherent key Ki, the conversion unit <b>230</b> generates an encrypted inherent key Ji from the inherent key read from the media inherent key storing unit <b>220</b>, the random number generating unit <b>331</b> generates a random number R<b>1</b>, the encryption unit <b>252</b> generates an encrypted random number S<b>1</b>, the decryption unit <b>333</b> generates a random number R′<b>1</b> from the encrypted random number R<b>1</b>, and the mutual authentication control unit <b>334</b> compares the random number R′<b>1</b> with the random number R<b>1</b> and, if the random number R′<b>1</b> matches the random number R<b>1</b>, judges that the memory card <b>200</b> is an authorized device. If the memory card <b>200</b> and the memory card writer have successfully authenticated each other, the memory card writer encrypts a content using a decrypted inherent key. If the memory card <b>200</b> and the memory card reader have successfully authenticated each other, the memory card reader decrypts an encrypted content using the decrypted inherent key.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="101.77mm" wi="142.41mm" file="US07298845-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="114.38mm" wi="142.66mm" file="US07298845-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="234.61mm" wi="158.58mm" orientation="landscape" file="US07298845-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="182.63mm" wi="156.97mm" file="US07298845-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="229.19mm" wi="156.21mm" orientation="landscape" file="US07298845-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="233.68mm" wi="165.86mm" orientation="landscape" file="US07298845-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="206.84mm" wi="157.56mm" orientation="landscape" file="US07298845-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="206.16mm" wi="126.24mm" file="US07298845-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="237.24mm" wi="126.32mm" file="US07298845-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="213.87mm" wi="166.37mm" file="US07298845-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="233.68mm" wi="142.49mm" orientation="landscape" file="US07298845-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="225.30mm" wi="164.17mm" file="US07298845-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="238.34mm" wi="162.64mm" file="US07298845-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="226.99mm" wi="146.90mm" orientation="landscape" file="US07298845-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="226.48mm" wi="155.79mm" orientation="landscape" file="US07298845-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="236.39mm" wi="161.21mm" orientation="landscape" file="US07298845-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="209.30mm" wi="158.41mm" orientation="landscape" file="US07298845-20071120-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="244.43mm" wi="157.73mm" orientation="landscape" file="US07298845-20071120-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="236.64mm" wi="135.38mm" orientation="landscape" file="US07298845-20071120-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="246.30mm" wi="155.87mm" orientation="landscape" file="US07298845-20071120-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="236.30mm" wi="143.34mm" orientation="landscape" file="US07298845-20071120-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="240.79mm" wi="157.73mm" orientation="landscape" file="US07298845-20071120-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="234.36mm" wi="153.25mm" orientation="landscape" file="US07298845-20071120-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00023" num="00023">
<img id="EMI-D00023" he="244.86mm" wi="158.67mm" orientation="landscape" file="US07298845-20071120-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00024" num="00024">
<img id="EMI-D00024" he="222.50mm" wi="151.89mm" orientation="landscape" file="US07298845-20071120-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00025" num="00025">
<img id="EMI-D00025" he="241.72mm" wi="161.88mm" orientation="landscape" file="US07298845-20071120-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00026" num="00026">
<img id="EMI-D00026" he="239.44mm" wi="163.66mm" orientation="landscape" file="US07298845-20071120-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00027" num="00027">
<img id="EMI-D00027" he="141.31mm" wi="107.70mm" file="US07298845-20071120-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00028" num="00028">
<img id="EMI-D00028" he="114.13mm" wi="112.78mm" file="US07298845-20071120-D00028.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00029" num="00029">
<img id="EMI-D00029" he="246.04mm" wi="159.09mm" orientation="landscape" file="US07298845-20071120-D00029.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00030" num="00030">
<img id="EMI-D00030" he="225.21mm" wi="155.19mm" orientation="landscape" file="US07298845-20071120-D00030.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00031" num="00031">
<img id="EMI-D00031" he="142.24mm" wi="97.79mm" file="US07298845-20071120-D00031.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00032" num="00032">
<img id="EMI-D00032" he="107.44mm" wi="93.81mm" file="US07298845-20071120-D00032.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00033" num="00033">
<img id="EMI-D00033" he="236.98mm" wi="155.70mm" orientation="landscape" file="US07298845-20071120-D00033.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00034" num="00034">
<img id="EMI-D00034" he="241.72mm" wi="156.29mm" orientation="landscape" file="US07298845-20071120-D00034.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00035" num="00035">
<img id="EMI-D00035" he="241.89mm" wi="167.30mm" file="US07298845-20071120-D00035.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application is a divisional application of U.S. Ser. No. 09/419,240, filed on Oct. 15, 1999, now U.S. Pat. No. 6,859,535.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<p id="p-0003" num="0002">This application is based on applications Nos. H10-295920 and H10-339027 filed in Japan, the content of which is hereby incorporated by reference.</p>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">1. Field of the Invention</p>
<p id="p-0005" num="0004">The present invention relates to a system for distributing digital contents, such as digitized documents, audio, images, and programs, via a network to allow users to record the contents on recording media and to reproduce the recorded contents. In particular, the present invention relates to a system for protecting digital contents from unauthorized recording and reproduction.</p>
<p id="p-0006" num="0005">2. Description of the Related Art</p>
<p id="p-0007" num="0006">In recent years, techniques for distributing digital contents, such as digitized documents, audio, images, and programs, via networks, such as the Internet, have been devised. The techniques allow users to easily record and reproduce the distributed contents.</p>
<p id="p-0008" num="0007">While having an advantage that users can easily replicate digital contents, the techniques also have a problem that copyrights owned by authors of the digital contents can be easily infringed.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0009" num="0008">The object of the present invention is to provide a digital content protection system, a digital content protection method, a digital content protection program recorded on a recording medium, and a digital content protection program that is sent via a communication line, each of which prevents unauthorized recording of a digital content obtained from the outside onto a recording medium and unauthorized reproduction of a digital content recorded on a recording medium.</p>
<p id="p-0010" num="0009">The stated object is achieved by a digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area, the digital content protection system operating according to the following phases: an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key.</p>
<p id="p-0011" num="0010">With this construction, the digital content protection system of the present invention prevents the transfer of contents from an authorized apparatus to an unauthorized apparatus. This prevents contents that have been properly obtained from being used without a proper authorization. The transfer of contents from an unauthorized device to an authorized device is also prevented. As a result, the digital content protection system of the present invention prevents illegally obtained contents from being reused.</p>
<p id="p-0012" num="0011">Here, the recording medium apparatus may include a first calculation unit, and the access apparatus may include a first authentication information generating unit and a first authentication unit, where while the access apparatus judges whether the recording medium apparatus is legitimate in the authentication phase, the first authentication information generating unit generates first authentication information and outputs the first authentication information to the recording medium apparatus, the first calculation unit receives the first authentication information, generates first calculated authentication information by performing a first calculation on the received first authentication information using the inherent key, and outputs the first calculated authentication information to the access apparatus, and the first authentication unit judges whether the recording medium apparatus is legitimate from the first authentication information and the first calculated authentication information using the secretly transmitted inherent key.</p>
<p id="p-0013" num="0012">Here, the access apparatus may include a second calculation unit, and the recording medium apparatus may include a second authentication information generating unit and a second authentication unit, where while the recording medium apparatus judges whether the access apparatus is legitimate in the authentication phase, the second authentication information generating unit generates second authentication information and outputs the second authentication information to the access medium apparatus, the second calculation unit receives the second authentication information, generates second calculated authentication information by performing a second calculation on the received second authentication information using the secretly transmitted inherent key, and outputs the second calculated authentication information to the recording medium apparatus, and the second authentication unit judges whether the access apparatus is legitimate from the second authentication information and the second calculated authentication information using the inherent key.</p>
<p id="p-0014" num="0013">With this construction, the recording medium apparatus and the access apparatus perform mutual authentication.</p>
<p id="p-0015" num="0014">Here, the recording medium apparatus may further include a first encryption unit and an inherent key storing unit for prestoring the inherent key, and the access apparatus may further include a first decryption unit, where while the recording medium apparatus secretly transmits the inherent key to the access apparatus in the authentication phase, the first encryption unit generates an encrypted inherent key by applying a first encryption algorithm to the inherent key and outputs the encrypted inherent key to the access apparatus, and the first decryption unit receives the encrypted inherent key and generates a decrypted inherent key by applying a first decryption algorithm to the encrypted inherent key, the first decryption algorithm being used to decrypt cipher text generated with the first encryption algorithm.</p>
<p id="p-0016" num="0015">With this construction, because the inherent key is encrypted and is transferred from the recording medium apparatus to the access apparatus, the possibility that the inherent key is uncovered is reduced.</p>
<p id="p-0017" num="0016">Here, the first key and the second key may be the same master key, and the first decryption unit may decrypt the encrypted inherent key using the second key that is the same as the first key.</p>
<p id="p-0018" num="0017">With this construction, the recording medium apparatus and the access apparatus store the same master key. As a result, the recording medium apparatus and the access apparatus are produced without difficulty.</p>
<p id="p-0019" num="0018">Here, the first key may be a public key that is calculated from the second key according to a public key determination algorithm of a public key cryptosystem, the first encryption algorithm may be an encryption algorithm of the public key cryptosystem, and the first decryption algorithm may be a decryption algorithm of the public key cryptosystem, where the first encryption unit encrypts the inherent key according to the encryption algorithm of the public key cryptosystem using the first key that is the public key, and the first decryption unit decrypts the encrypted inherent key according to the decryption algorithm of the public key cryptosystem using the second key.</p>
<p id="p-0020" num="0019">With this construction, the first key that is a public key differs from the second key that is a secret key. Therefore, even if the secret key stored in a card reader or a card writer is uncovered, it is impossible to obtain the public key from the secret key. This makes it difficult to make the counterfeit of the recording medium apparatus.</p>
<p id="p-0021" num="0020">Here, the second key may be a public key that is calculated from the first key according to a public key determination algorithm of a recovery signature processing method, the first encryption algorithm may be a signature processing algorithm of the recovery signature processing method, the first encryption unit may generate the encrypted inherent key that is a signature text by applying the first encryption algorithm to the inherent key using the first key, the first decryption algorithm may be a verification processing algorithm of the recovery signature processing method, and the first decryption unit may generate the decrypted inherent key by applying the first decryption algorithm to the encrypted inherent key that is the signature text using the second key.</p>
<p id="p-0022" num="0021">With this construction, enormous amounts of calculation need to be performed to obtain the secret key Ks from the public key Kp. As a result, it is very difficult to calculate the secret key Ks from the public key Kp. Therefore, the security level of a digital content service system can be enhanced in total by assigning a secret key to a memory card and assigning a public key to a memory card writer or a memory card reader. This is because the memory card writer and the memory card reader generally have the high possibilities that their internal constructions are analyzed, in comparison with the memory card.</p>
<p id="p-0023" num="0022">Here, the recording medium apparatus may further include: a first master key storing unit for prestoring a first master key group that includes a plurality of master keys; and a first selection unit for selecting a master key out of the first master key group as a first key, and the access apparatus may further include: a second master key storing unit for prestoring a second master key group that includes a plurality of master keys, the first master key group and the second master key group include the same plurality of master keys; and a second selection unit for selecting a master key out of the second master key group as a second key, the second key being the same as the first key, where the first encryption unit encrypts the inherent key using the master key selected as the first key, and the first decryption unit decrypts the encrypted inherent key using the master key selected as the second key.</p>
<p id="p-0024" num="0023">With this construction, each of the recording medium apparatus and the access apparatus stores a plurality of master keys. Therefore, the digital content protection system of the present invention can be applied to a plurality of digital content service systems.</p>
<p id="p-0025" num="0024">Here, the first encryption unit may prestore a first subgroup key, generate a transformed key by performing a first conversion on the inherent key using the first subgroup key, and generate the encrypted inherent key by applying the first encryption algorithm to the transformed key, and the first decryption unit may prestore a second subgroup key that is the same as the first subgroup key, generate a decrypted transformed key by applying the first decryption algorithm to the encrypted inherent key, and generate the decrypted inherent key by performing an inversion operation of the first conversion operation on the decrypted transformed key using the second subgroup key.</p>
<p id="p-0026" num="0025">With this construction, when a digital content service system is run by a plurality of groups, a plurality of subgroup keys whose number is equal to the number of the groups are generated and each of the plurality of subgroup keys is assigned to one of the plurality of groups. This allows each group to provide its own service. Also, in many cases, the number of master keys that can be stored in a memory card is restricted due to the limited storage capacity of the memory card. However, the digital content protection system of the present invention increases the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0027" num="0026">Here, the first encryption unit may prestore a first subgroup key, generate a cipher text by applying the first encryption algorithm to the inherent key, and generate the encrypted inherent key by performing a first conversion operation on the cipher text using the first subgroup key, and the first decryption unit may prestore a second subgroup key that is the same as the first subgroup key, generate a decryption text by performing an inverse operation of the first conversion operation on the encrypted inherent key using the second subgroup key, and generate the decrypted inherent key by applying the first decryption algorithm to the decryption text.</p>
<p id="p-0028" num="0027">With this construction, when a digital content service system is run by a plurality of groups, the digital content protection system of the present invention allows each group to provide its own service in the same manner described above. Also, the digital content protection system of the present invention increases the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0029" num="0028">Here, the recording medium apparatus may further include a first key storing unit for prestoring a first key that is a master key, and the access apparatus may further include a second key storing unit for prestoring a second key that is the same master key as the first key, where the first encryption unit prestores a first subgroup key, generates an encrypted first key by performing a first conversion operation on the first key using the first subgroup key, and generates the encrypted inherent key by applying the first encryption algorithm to the inherent key using the encrypted first key, and the first decryption unit prestores a second subgroup key that is the same as the first subgroup key, generates an encrypted second key by performing a second conversion operation, which is the same as the first conversion operation, on the second key using the second subgroup key, and generates the decrypted inherent key by applying the first decryption algorithm to the encrypted inherent key using the encrypted second key.</p>
<p id="p-0030" num="0029">With this construction, when a digital content service system is run by a plurality of groups, the digital content protection system of the present invention allows each group to provide its own service in the same manner described above. Also, the digital content protection system of the present invention increases the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0031" num="0030">Here, the first calculation unit may prestore a first subgroup key, generate a transformed inherent key by performing a first conversion operation on the inherent key using the subgroup key, and generate the first calculated authentication information by performing the first calculation on the first authentication information using the transformed inherent key, and the third calculation unit may prestore a second subgroup key that is the same as the first subgroup key, generate a decrypted transformed inherent key by performing an inversion operation of the first conversion operation on the secretly transmitted inherent key using the subgroup key, and generate the third calculated authentication information by performing a calculation that is the same as the first calculation on the first authentication information using the decrypted transformed inherent key.</p>
<p id="p-0032" num="0031">With this construction, when a digital content service system is run by a plurality of groups, the digital content protection system of the present invention allows each group to provide its own service in the same manner described above. Also, the digital content protection system of the present invention increases the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0033" num="0032">Here, when the recording medium apparatus and the access apparatus have successfully authenticated each other, in the content transfer phase, the access apparatus may either (c) generate at least one data block by dividing a digital content, generate a data block key for each data block, generate at least one encrypted data block by encrypting each data block using the secretly transmitted inherent key and a data block key that corresponds to the data block, and transfer each encrypted data block to the recording medium, or (d) receive at least one encrypted data block of an encrypted digital content from the recording medium apparatus, generate a data block key for each data block, and generate at least one data block by decrypting each encrypted data block using the secretly transmitted inherent key and a data block key that corresponds to the encrypted data block, where each data block has one of a logical length and a physical length, and each encrypted data block has one of a logical length and a physical length.</p>
<p id="p-0034" num="0033">With this construction, the digital content protection system generates a data block key unique to each data block of a content and encrypts the data block using the data block key. Because this makes it difficult for third parties to intercept data blocks, the digital content protection system of the present invention achieves a high security for the data blocks.</p>
<p id="p-0035" num="0034">Here, when the recording medium apparatus and the access apparatus have successfully authenticated each other, in the content transfer phase, the access apparatus may either (e) generate a file key for a file of a digital content, generate an encrypted file by encrypting the file using the secretly transmitted inherent key and the file key, and transfer the encrypted file and information concerning the file key to the recording medium, or (f) receive, from the recording medium apparatus, an encrypted file of an encrypted digital content and information concerning a file key that corresponds to the encrypted file, generate a decrypted file by decrypting the encrypted file using the secretly transmitted inherent key and the information concerning the file key, and reproduce the decrypted file.</p>
<p id="p-0036" num="0035">With this construction, a file key inherent in each file of a content is generated and the files are encrypted using the file keys. Because this makes it difficult for third parties to intercept the files, the digital content protection system of the present invention achieves a high security for the files.</p>
<p id="p-0037" num="0036">Here, when the recording medium apparatus and the access apparatus have successfully authenticated each other, in the content transfer phase, the access apparatus may either (i) receive a user key from an operator, generates a transformed key from the user key and the secretly transmitted inherent key, generate an encrypted digital content by encrypting a digital content using the transformed key, and transfer the encrypted digital content to the recording medium, or (j) receive an encrypted digital content from the recording medium apparatus, generate a transformed key from a user key inputted from an operator and the secretly transmitted inherent key, and generate a decrypted digital content by decrypting the encrypted digital content using the transformed key.</p>
<p id="p-0038" num="0037">With this construction, a user encrypts a content and decrypt the encrypted content using a user key set by himself/herself. Therefore, the digital content protection system of the present invention protects a content owned by a user from being decoded by others.</p>
<p id="p-0039" num="0038">Here, the digital content protection system may further include an encrypted inherent key generation apparatus, where the digital content protection system further operates according to an encrypted inherent key setting phase where the encrypted inherent key generation apparatus generates an encrypted inherent key by encrypting the inherent key sent from the recording medium apparatus and sends the encrypted inherent key to the recording medium apparatus, and the recording medium apparatus holds the encrypted inherent key sent from the encrypted inherent key generation apparatus, where in the authentication phase, the recording medium apparatus sends the encrypted inherent key to the access apparatus, and the access apparatus generates a decrypted inherent key by decrypting the encrypted inherent key secretly sent from the recording medium apparatus and judges whether the recording medium apparatus is legitimate using the decrypted inherent key.</p>
<p id="p-0040" num="0039">With this construction, the recording medium apparatus does not need to include a conversion unit. As a result, the hardware scale of the recording medium apparatus is reduced.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0041" num="0040">These and other objects, advantages and features of the invention will become apparent from the following description thereof taken in conjunction with the accompanying drawings which illustrate a specific embodiment of the invention. In the drawings:</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of the digital content protection system <b>100</b> of the first embodiment of the present invention;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 2</figref> shows a state where the memory card <b>200</b> is placed in the memory card writer <b>300</b> and the memory card writer <b>300</b> is placed in the personal computer <b>500</b>;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 3</figref> shows a state where the memory card <b>200</b> is placed in the headphone stereo <b>401</b> that is the memory card reader <b>400</b>;</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram showing the construction of the memory card <b>200</b>;</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram showing the construction of the memory card writer <b>300</b>;</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram showing the construction of the memory card reader <b>400</b>;</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart showing the operation outline in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b>;</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 8</figref> is a flowchart showing the operation outline in the case where the memory card <b>200</b> is placed in the memory card reader <b>400</b>;</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 9</figref> shows the authentication operation in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b>;</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 10</figref> shows the authentication operation performed by the memory card writer <b>300</b> to judges whether the memory card <b>200</b> is an authorized device;</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>a </i>of the second embodiment;</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 12</figref> shows the authentication operations in the case where the memory card <b>200</b><i>a </i>is placed in the media inherent key information generating device <b>600</b> and in the case where the memory card <b>200</b><i>a </i>is placed in the memory card writer <b>300</b>;</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 13</figref> shows the authentication operation of the digital content protection system of a modification of the first embodiment in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b>;</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 14</figref> is a block diagram showing the construction of the memory card <b>200</b><i>c </i>in the digital content protection system <b>100</b><i>c </i>of the third embodiment;</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 15</figref> is a block diagram showing the construction of the memory card writer <b>300</b><i>c </i>in the digital content protection system <b>100</b><i>c </i>of the third embodiment;</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 16</figref> is a block diagram showing the construction of the memory card reader <b>400</b><i>c </i>in the digital content protection system <b>100</b><i>c </i>of the third embodiment;</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 17</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>d </i>of the fourth embodiment;</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 18</figref> shows the operation of the digital content protection system <b>100</b><i>d; </i></p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 19</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>e </i>of the fifth embodiment;</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 20</figref> shows the authentication operation of the digital content protection system <b>100</b><i>e; </i></p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 21</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>f </i>of the sixth embodiment;</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 22</figref> shows the authentication operation of the digital content protection system <b>100</b><i>f; </i></p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 23</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>g </i>of the seventh embodiment;</p>
<p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. 24</figref> shows the authentication operation of the digital content protection system <b>100</b><i>g; </i></p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. 25</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>h </i>of the eighth embodiment;</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 26</figref> is another block diagram showing the construction of the digital content protection system <b>100</b><i>h; </i></p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIG. 27</figref> shows the operation outline of the digital content protection system <b>100</b><i>h </i>in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b><i>h; </i></p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIG. 28</figref> shows the operation outline of the digital content protection system <b>100</b><i>h </i>in the case where the memory card <b>200</b> is placed in the memory card reader <b>400</b><i>h; </i></p>
<p id="p-0070" num="0069"><figref idref="DRAWINGS">FIG. 29</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>i </i>of the ninth embodiment;</p>
<p id="p-0071" num="0070"><figref idref="DRAWINGS">FIG. 30</figref> is another block diagram showing the construction of the digital content protection system <b>100</b><i>i; </i></p>
<p id="p-0072" num="0071"><figref idref="DRAWINGS">FIG. 31</figref> shows the operation outline of the digital content protection system <b>100</b><i>i </i>in the case where the memory card <b>200</b><i>i </i>is placed in the memory card writer <b>300</b><i>i; </i></p>
<p id="p-0073" num="0072"><figref idref="DRAWINGS">FIG. 32</figref> shows the operation outline of the digital content protection system <b>100</b><i>i </i>in the case where the memory card <b>200</b><i>i </i>is placed in the memory card reader <b>400</b><i>i; </i></p>
<p id="p-0074" num="0073"><figref idref="DRAWINGS">FIG. 33</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>i </i>of a modification;</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 34</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>i </i>of another modification; and</p>
<p id="p-0076" num="0075"><figref idref="DRAWINGS">FIG. 35</figref> shows the authentication operation in the case where the memory card <b>200</b><i>j </i>is placed in the memory card writer <b>300</b><i>j. </i></p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<heading id="h-0005" level="1">First Embodiment</heading>
<p id="p-0077" num="0076">The following is a description of a digital content protection system <b>100</b> of the first embodiment of the present invention.</p>
<p id="h-0006" num="0000">1. Construction of Digital Content Protection System <b>100</b></p>
<p id="p-0078" num="0077">The digital content protection system <b>100</b> includes a memory card <b>200</b>, a memory card writer <b>300</b>, and a memory card reader <b>400</b>, as shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0079" num="0078">The memory card <b>200</b> is placed in the memory card writer <b>300</b> through a memory card slot <b>301</b>, as shown in <figref idref="DRAWINGS">FIG. 2</figref>. The memory card writer <b>300</b> is placed in a personal computer <b>500</b> through a memory card writer slot <b>501</b>. The personal computer <b>500</b> is connected to a network, such as the Internet, via a communication line <b>10</b>. As a result, the memory card writer <b>300</b> is connected to the outside through the mediation of the personal computer <b>500</b>.</p>
<p id="p-0080" num="0079">The personal computer <b>500</b> includes a display <b>503</b>, a keyboard <b>504</b>, speakers <b>502</b>, a processor, a RAM, a ROM, and a hard disc apparatus. The processor, RAM, ROM, and hard disc apparatus are not shown in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0081" num="0080">The memory card <b>200</b> is placed in the memory card reader <b>400</b>. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the memory card <b>200</b> is placed in a headphone stereo <b>401</b> (the memory card reader <b>400</b> in this embodiment) through a memory card slot <b>403</b>. Buttons <b>404</b><i>a</i>, <b>404</b><i>b</i>, <b>404</b><i>c</i>, and <b>404</b><i>d </i>are provided on the top of the headphone stereo <b>401</b>. Also, the memory card slot is provided on a side of the headphone stereo <b>401</b> and a headphone <b>402</b> is connected to another side of the headphone stereo <b>401</b>.</p>
<p id="p-0082" num="0081">A user places the memory card <b>200</b> in the personal computer <b>500</b> through the mediation of the memory card writer <b>300</b>, receives digital contents, such as music data, from the outside via the Internet and records the received contents on the memory card <b>200</b>. After recording, the user places the memory card <b>200</b> in the headphone stereo <b>401</b> and reproduces the contents recorded on the memory card <b>200</b> using the headphone stereo <b>401</b>.</p>
<p id="h-0007" num="0000">1.1 Construction of Memory Card <b>200</b></p>
<p id="p-0083" num="0082"><figref idref="DRAWINGS">FIG. 4</figref> shows the construction of the memory card <b>200</b>. As shown in this drawing, the memory card <b>200</b> includes a master key storing unit <b>210</b>, a media inherent key storing unit <b>220</b>, a conversion unit <b>230</b>, a media inherent key information storing unit <b>240</b>, an apparatus key storing unit <b>221</b>, an inversion unit <b>222</b>, an apparatus key information storing unit <b>223</b>, a mutual authentication unit <b>250</b>, encrypted content storing unit <b>260</b>, a communication unit <b>270</b>, and a control unit <b>280</b>.</p>
<p id="p-0084" num="0083">When the memory card <b>200</b> is placed in the memory card writer <b>300</b>, the communication unit <b>270</b> is connected to a communication unit <b>340</b> (described later) of the memory card writer <b>300</b>.</p>
<p id="p-0085" num="0084">On the other hand, when the memory card <b>200</b> is placed in the memory card reader <b>400</b>, the communication unit <b>270</b> is connected to a communication unit <b>440</b> (described later) of the memory card reader <b>400</b>.</p>
<p id="h-0008" num="0000">1.1.1 Master Key Storing Unit <b>210</b></p>
<p id="p-0086" num="0085">The master key storing unit <b>210</b> includes a semiconductor memory and prestores a master key Mk that is a 56-bit bit string. Different master keys are assigned to respective digital content service systems. Also, the same master key is prestored in the master key storing units of all memory cards for use in a specific digital content service system even if the memory cards are produced by different manufacturers.</p>
<p id="p-0087" num="0086">Here, the digital content service systems are, for instance, a music delivery system that is cooperatively run by A, B, and C companies and a movie rental system that is cooperatively run by X, Y, and Z companies.</p>
<p id="h-0009" num="0000">1.1.2 Media Inherent Key Storing Unit <b>220</b></p>
<p id="p-0088" num="0087">The media inherent key storing unit <b>220</b> includes a semiconductor memory and prestores an inherent key Ki that is a 56-bit bit string. Different inherent keys are assigned to respective memory cards. The inherent key of each memory card is obtained by performing a given calculation, such as addition, on a production number that is inherent in each memory card and a random number that is randomly generated when each memory card is produced.</p>
<p id="h-0010" num="0000">1.1.3 Conversion Unit <b>230</b></p>
<p id="p-0089" num="0088">The conversion unit <b>230</b> includes a processor, a ROM (Read Only Memory) for storing programs, and a RAM (Random Access Memory) for providing a work area. The conversion unit <b>230</b> reads the inherent key Ki from the media inherent key storing unit <b>220</b> and reads the master key Mk from the master key storing unit <b>210</b>.</p>
<p id="p-0090" num="0089">The conversion unit <b>230</b> also prestores an encryption algorithm E<b>1</b> that conforms to DES (Data Encryption Standard).</p>
<p id="p-0091" num="0090">Here, the size of each encryption key used for the encryption algorithm E<b>1</b> is 56 bits. Also, the length of each plain text that is to be encrypted using the encryption algorithm E<b>1</b> is 64 bits. Furthermore, the length of each cipher text that is generated using the encryption algorithm E<b>1</b> is 64 bits. It should be noted here that in this specification, the encryption algorithm and the decryption algorithm conform to DES, unless otherwise stated. Also, in this specification, the size of each encryption key is 56 bits, the size of each decryption key is 56 bits, the length of each plain text is 64 bits, and the length of each cipher text is 64 bits.</p>
<p id="p-0092" num="0091">The conversion unit <b>230</b> generates an encrypted inherent key Ji by applying the encryption algorithm E<b>1</b> to the inherent key Ki read from the media inherent key storing unit <b>220</b>. Here, the conversion unit <b>230</b> uses the master key Mk read from the master key storing unit <b>210</b> as the key of the encryption algorithm E<b>1</b>. It should be noted here that in this specification, the encrypted inherent key Ji is expressed by Formula 1 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Ji=E</i>1(<i>Mk,Ki</i>)  &lt;Formula 1&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0093" num="0092">Also, in this specification, the generation of a cipher text C by applying an encryption algorithm E to a plain text M using a key K is expressed by Formula 2 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>C=E</i>(<i>K,M</i>)  &lt;Formula 2&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0094" num="0093">Furthermore, in this specification, the generation of the plain text M by applying a decryption algorithm D to the cipher text C using the key K is expressed by Formula 3 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>M=D</i>(<i>K,C</i>)  &lt;Formula 3&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0095" num="0094">As described above, the cipher text C is generated by applying the encryption algorithm E to the plain text M using the key K and the plain text M is generated by applying the decryption algorithm D to the cipher text C using the key K. Therefore, the relation between the encryption algorithm E and the decryption algorithm D can be expressed by Formula 4 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E</i>=crpt(<i>D</i>)  &lt;Formula 4&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0096" num="0095">The conversion unit <b>230</b> outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>240</b>.</p>
<p id="h-0011" num="0000">1.1.4 Media Inherent Key Information Storing Unit <b>240</b></p>
<p id="p-0097" num="0096">The media inherent key information storing unit <b>240</b> includes a semiconductor memory, receives the encrypted inherent key Ji from the conversion unit <b>230</b>, and holds the encrypted inherent key Ji.</p>
<p id="h-0012" num="0000">1.1.5 Mutual Authentication Unit <b>250</b></p>
<p id="p-0098" num="0097">The mutual authentication unit <b>250</b> includes a random number generating unit <b>251</b>, an encryption unit <b>252</b>, a decryption unit <b>253</b>, and a mutual authentication control unit <b>254</b>. Each element of the mutual authentication unit <b>250</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area.</p>
<p id="h-0013" num="0000">(1) Random Number Generating Unit <b>251</b></p>
<p id="p-0099" num="0098">The random number generating unit <b>251</b> generates a random number R<b>2</b> that is a 64-bit bit string, and outputs the random number R<b>2</b> to the communication unit <b>270</b> and the mutual authentication control unit <b>254</b>.</p>
<p id="h-0014" num="0000">(2) Encryption Unit <b>252</b></p>
<p id="p-0100" num="0099">The encryption unit <b>252</b> prestores an encryption algorithm E<b>2</b> that conforms to DES.</p>
<p id="p-0101" num="0100">The encryption unit <b>252</b> first receives a random number R<b>1</b> from the communication unit <b>270</b> and reads the inherent key Ki from the media inherent key storing unit <b>220</b>.</p>
<p id="p-0102" num="0101">The encryption unit <b>252</b> then generates an encrypted random number S<b>1</b> by applying the encryption algorithm E<b>2</b> on the random number R<b>1</b> using the inherent key Ki as the key of the encryption algorithm E<b>2</b>. The encrypted random number S<b>1</b> can be expressed by Formula 5 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>1=<i>E</i>2(<i>Ki,R</i>1)  &lt;Formula 5&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0103" num="0102">The encryption unit <b>252</b> finally outputs the encrypted random number S<b>1</b> to the communication unit <b>270</b>.</p>
<p id="h-0015" num="0000">(3) Decryption Unit <b>253</b></p>
<p id="p-0104" num="0103">The decryption unit <b>253</b> prestores an decryption algorithm D<b>2</b> that conforms to DES.</p>
<p id="p-0105" num="0104">The decryption unit <b>253</b> first receives an encrypted random number S<b>2</b> from the communication unit <b>270</b> and reads an apparatus key A′j from the apparatus key storing unit <b>221</b>.</p>
<p id="p-0106" num="0105">The decryption unit <b>253</b> then generates a random number R′<b>2</b> by applying the decryption algorithm D<b>2</b> to the encrypted random number S<b>2</b> using the apparatus key A′j as the key of the decryption algorithm D<b>2</b>. The generated random number R′<b>2</b> can be expressed by Formula 6 given below.</p>
<p id="p-0107" num="0106">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <msup>
                  <mi>R</mi>
                  <mi>′</mi>
                </msup>
                <mo>⁢</mo>
                <mn>2</mn>
              </mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mi>D2</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>A</mi>
                        <mi>′</mi>
                      </msup>
                      <mo>⁢</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>,</mo>
                    <mi>S2</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mi>D2</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>A</mi>
                        <mi>′</mi>
                      </msup>
                      <mo>⁢</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow>
                      <mi>E2</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mrow>
                            <mi>A</mi>
                            <mo>⁢</mo>
                            <mstyle>
                              <mspace width="0.3em" height="0.3ex"/>
                            </mstyle>
                            <mo>⁢</mo>
                            <mi>j</mi>
                          </mrow>
                          <mo>,</mo>
                          <mi>R2</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>&lt;</mo>
        <mrow>
          <mi>Formula</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mn>6</mn>
        </mrow>
        <mo>&gt;</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0108" num="0107">The decryption unit <b>253</b> finally outputs the random number R′<b>2</b> to the mutual authentication control unit <b>254</b>.</p>
<p id="h-0016" num="0000">(4) Mutual Authentication Control Unit <b>254</b></p>
<p id="p-0109" num="0108">The mutual authentication control unit <b>254</b> first receives the random number R′<b>2</b> from the decryption unit <b>253</b> and receives the random number R<b>2</b> from the random number generating unit <b>251</b>.</p>
<p id="p-0110" num="0109">The mutual authentication control unit <b>254</b> then compares these random numbers. If the random number R′<b>2</b> matches the random number R<b>2</b>, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b> or the memory card reader <b>400</b> in which the memory card <b>200</b> is placed is an authorized device (legitimate); if not, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b> or the memory card reader <b>400</b> is an unauthorized device.</p>
<p id="p-0111" num="0110">The mutual authentication control unit <b>254</b> finally outputs an authentication signal showing whether the memory card writer <b>300</b> or the memory card reader <b>400</b> is an authorized device to the control unit <b>280</b>.</p>
<p id="h-0017" num="0000">1.1.6 Encrypted Content Storing Unit <b>260</b></p>
<p id="p-0112" num="0111">The encrypted content storing unit <b>260</b> includes a semiconductor memory, receives encrypted partial contents Fi (where i=1, 2, 3, . . . ) from the communication unit <b>270</b>, and holds the encrypted partial contents Fi.</p>
<p id="h-0018" num="0000">1.1.7 Communication Unit <b>270</b></p>
<p id="p-0113" num="0112">The communication unit <b>270</b> reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b> and outputs the encrypted inherent key Ji to the communication unit <b>340</b> of the memory card writer <b>300</b> or to the communication unit <b>440</b> of the memory card reader <b>400</b>.</p>
<p id="p-0114" num="0113">The communication unit <b>270</b> also receives the random number R<b>1</b> from the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b> and outputs the random number R<b>1</b> to the encryption unit <b>252</b> of the mutual authentication unit <b>250</b>.</p>
<p id="p-0115" num="0114">The communication unit <b>270</b> further receives the encrypted random number S<b>1</b> from the encryption unit <b>252</b> and outputs the encrypted random number S<b>1</b> to the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b>.</p>
<p id="p-0116" num="0115">The communication unit <b>270</b> also receives an encrypted apparatus key Bj from the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b> and outputs the encrypted apparatus key Bj to the apparatus key information storing unit <b>223</b>.</p>
<p id="p-0117" num="0116">The communication unit <b>270</b> also receives the random number R<b>2</b> from the random number generating unit <b>251</b> and outputs the random number R<b>2</b> to the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b>.</p>
<p id="p-0118" num="0117">The communication unit <b>270</b> also receives the encrypted random number S<b>2</b> from the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b> and outputs the encrypted random number S<b>2</b> to the decryption unit <b>253</b> of the mutual authentication unit <b>250</b>.</p>
<p id="p-0119" num="0118">On receiving a communication termination signal from the control unit <b>280</b>, the communication unit <b>270</b> terminates the communication with the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b>.</p>
<p id="p-0120" num="0119">The communication unit <b>270</b> also receives the encrypted partial contents Fi (where i=1, 2, 3, . . . ) from the communication unit <b>340</b> of the memory card writer <b>300</b> and outputs the encrypted partial contents Fi to the encrypted content storing unit <b>260</b>.</p>
<p id="p-0121" num="0120">The communication unit <b>270</b> furthermore reads the encrypted partial contents Fi from the encrypted content storing unit <b>260</b> and outputs the encrypted partial contents Fi to the communication unit <b>440</b> of the memory card reader <b>400</b>.</p>
<p id="h-0019" num="0000">1.1.8 Apparatus Key Information Storing Unit <b>223</b></p>
<p id="p-0122" num="0121">The apparatus key information storing unit <b>223</b> includes a semiconductor memory, receives the encrypted apparatus key Bj from the communication unit <b>270</b>, and holds the encrypted apparatus key Bj.</p>
<p id="h-0020" num="0000">1.1.9 Inversion Unit <b>222</b></p>
<p id="p-0123" num="0122">The inversion unit <b>222</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area, and prestores a decryption algorithm D<b>3</b> that conforms to DES.</p>
<p id="p-0124" num="0123">The inversion unit <b>222</b> first reads the encrypted apparatus key Bj from the apparatus key information storing unit <b>223</b> and reads the master key Mk from the master key storing unit <b>210</b>.</p>
<p id="p-0125" num="0124">The inversion unit <b>222</b> then generates the apparatus key A′j by applying the decryption algorithm D<b>3</b> to the encrypted apparatus key Bj using the master key Mk as a key of the decryption algorithm D<b>3</b>. The generated apparatus key A′j can be expressed by Formula 7 given below.</p>
<p id="p-0126" num="0125">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <msup>
                  <mi>A</mi>
                  <mi>′</mi>
                </msup>
                <mo>⁢</mo>
                <mi>j</mi>
              </mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mi>D3</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>Mk</mi>
                    <mo>,</mo>
                    <mi>Bj</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mi>D3</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>Mk</mi>
                    <mo>,</mo>
                    <mrow>
                      <mi>E3</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>Mk</mi>
                          <mo>,</mo>
                          <mrow>
                            <mi>A</mi>
                            <mo>⁢</mo>
                            <mstyle>
                              <mspace width="0.3em" height="0.3ex"/>
                            </mstyle>
                            <mo>⁢</mo>
                            <mi>j</mi>
                          </mrow>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>&lt;</mo>
        <mrow>
          <mi>Formula</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mn>7</mn>
        </mrow>
        <mo>&gt;</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0127" num="0126">The inversion unit <b>222</b> finally outputs the generated apparatus key A′j to the apparatus key storing unit <b>221</b>.</p>
<p id="h-0021" num="0000">1.1.10 Apparatus Key Storing Unit <b>221</b></p>
<p id="p-0128" num="0127">The apparatus key storing unit <b>221</b> includes a semiconductor memory and holds the apparatus key A′j outputted from the inversion unit <b>222</b>.</p>
<p id="h-0022" num="0000">1.1.11 Control Unit <b>280</b></p>
<p id="p-0129" num="0128">The control unit <b>280</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area. The control unit <b>280</b> receives an authentication signal from the mutual authentication control unit <b>254</b>. The authentication signal shows whether memory card writer <b>300</b> or the memory card reader <b>400</b> in which the memory card <b>200</b> is placed is an authorized device.</p>
<p id="p-0130" num="0129">When the authentication signal shows that the memory card writer <b>300</b> or the memory card reader <b>400</b> is an unauthorized device, the control unit <b>280</b> outputs a communication termination signal to the communication unit <b>270</b>, which then terminates the communication with the memory card writer <b>300</b> or the memory card reader <b>400</b>.</p>
<p id="h-0023" num="0000">1.2 Construction of Memory Card Writer <b>300</b></p>
<p id="p-0131" num="0130"><figref idref="DRAWINGS">FIG. 5</figref> shows the construction of the memory card writer <b>300</b>. As shown in this drawing, the memory card writer <b>300</b> includes an apparatus key storing unit <b>310</b>, a conversion unit <b>311</b>, an apparatus key information storing unit <b>312</b>, a master key storing unit <b>313</b>, a media inherent key information storing unit <b>320</b>, an inversion unit <b>321</b>, a media inherent key storing unit <b>323</b>, a mutual authentication unit <b>330</b>, a communication unit <b>340</b>, a control unit <b>350</b>, an encryption unit <b>360</b>, a content storing unit <b>370</b>, and a content download unit <b>380</b>.</p>
<p id="p-0132" num="0131">The content download unit <b>380</b> is connected to the outside via the communication line <b>10</b>.</p>
<p id="h-0024" num="0000">1.2.1 Apparatus Key Storing Unit <b>310</b></p>
<p id="p-0133" num="0132">The apparatus key storing unit <b>310</b> includes a semiconductor memory and prestores an apparatus key Aj that is a 56-bit bit string. Different apparatus keys are assigned to respective memory card writers. The apparatus key of each memory card writer is obtained by performing a given calculation, such as addition, on a production number that is inherent in each memory card writer and a random number that is randomly generated when each memory card writer is produced.</p>
<p id="h-0025" num="0000">1.2.2 Conversion Unit <b>311</b></p>
<p id="p-0134" num="0133">The conversion unit <b>311</b> includes a processor, a ROM for storing programs, a RAM for providing a work area. The conversion unit <b>311</b> reads the apparatus key Aj from the apparatus key storing unit <b>310</b> and reads the master key Mk from the master key storing unit <b>313</b>.</p>
<p id="p-0135" num="0134">The conversion unit <b>311</b> also prestores an encryption algorithm E<b>3</b> that conforms to DES.</p>
<p id="p-0136" num="0135">The relation between the decryption algorithm D<b>3</b> prestored in the inversion unit <b>222</b> and the encryption algorithm E<b>3</b> can be expressed by Formula 8 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E</i>3=crpt(<i>D</i><b>3</b>)  &lt;Formula 8&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0137" num="0136">The conversion unit <b>311</b> generates the encrypted apparatus key Bj by applying the encryption algorithm E<b>3</b> to the apparatus key Aj read from the apparatus key storing unit <b>310</b> using the master key Mk read from the master key storing unit <b>313</b> as the key of the encryption algorithm E<b>3</b>. The encrypted apparatus key Bj can be expressed by Formula 9 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Bj=E</i>3(<i>Mk,Aj</i>)  &lt;Formula 9&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0138" num="0137">The conversion unit <b>311</b> outputs the encrypted apparatus key Bj to the apparatus key information storing unit <b>312</b>.</p>
<p id="h-0026" num="0000">1.2.3 Apparatus Key Information Storing Unit <b>312</b></p>
<p id="p-0139" num="0138">The apparatus key information storing unit <b>312</b> includes a semiconductor memory, receives the encrypted apparatus key Bj from the conversion unit <b>311</b>, and holds the encrypted apparatus key Bj.</p>
<p id="h-0027" num="0000">1.2.4 Master Key Storing Unit <b>313</b></p>
<p id="p-0140" num="0139">The master key storing unit <b>313</b> includes a semiconductor and prestores the master key Mk. This master key Mk is the same as that prestored in the master key storing unit <b>210</b> of the memory card <b>200</b>.</p>
<p id="h-0028" num="0000">1.2.5 Media Inherent Key Information Storing Unit <b>320</b></p>
<p id="p-0141" num="0140">The media inherent key information storing unit <b>320</b> includes a semiconductor, receives the encrypted inherent key Ji from the communication unit <b>340</b>, and holds the encrypted inherent key Ji.</p>
<p id="h-0029" num="0000">1.2.6 Inversion Unit <b>321</b></p>
<p id="p-0142" num="0141">The inversion unit <b>321</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area. The inversion unit <b>321</b> reads the encrypted inherent key Ji from the media inherent key information storing unit <b>320</b> and reads the master key Mk from the master key storing unit <b>313</b>.</p>
<p id="p-0143" num="0142">The inversion unit <b>321</b> prestores a decryption algorithm D<b>1</b> that conforms to DES.</p>
<p id="p-0144" num="0143">The relation between the encryption algorithm E<b>1</b> prestored in the conversion unit <b>230</b> of the memory card <b>200</b> and the decryption algorithm D<b>1</b> can be expressed by Formula 10 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E</i>1=crpt(<i>D</i>1)  &lt;Formula 10&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0145" num="0144">The inversion unit <b>321</b> generates an inherent key K′i by applying the decryption algorithm D<b>1</b> to the encrypted inherent key Ji using the master key Mk as the key of the decryption algorithm D<b>1</b>. The inherent key K′i can be expressed by Formula 11 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>K′i=D</i>1(<i>Mk,Ji</i>)  &lt;Formula 11&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>=<i>D</i>1(<i>Mk,E</i>1(<i>Mk,Ki</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0146" num="0145">The inversion unit <b>321</b> outputs the inherent key K′i to the media inherent key storing unit <b>323</b>.</p>
<p id="h-0030" num="0000">1.2.7 Media Inherent Key Storing Unit <b>323</b></p>
<p id="p-0147" num="0146">The media inherent key storing unit <b>323</b> includes a semiconductor, receives the inherent key K′i from the inversion unit <b>321</b>, and holds the inherent key K′i.</p>
<p id="h-0031" num="0000">1.2.8 Mutual Authentication Unit <b>330</b></p>
<p id="p-0148" num="0147">The mutual authentication unit <b>330</b> includes a random number generating unit <b>331</b>, an encryption unit <b>332</b>, a decryption unit <b>333</b>, and a mutual authentication control unit <b>334</b>. Each element of the mutual authentication unit <b>330</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area.</p>
<p id="h-0032" num="0000">(1) Random Number Generating Unit <b>331</b></p>
<p id="p-0149" num="0148">The random number generating unit <b>331</b> generates the random number R<b>1</b> that is a 64-bit bit string and outputs the random number R<b>1</b> to the communication unit <b>340</b> and the mutual authentication control unit <b>334</b>.</p>
<p id="h-0033" num="0000">(2) Encryption Unit <b>332</b></p>
<p id="p-0150" num="0149">The encryption unit <b>332</b> prestores the encryption algorithm E<b>2</b> that conforms to DES.</p>
<p id="p-0151" num="0150">The encryption unit <b>332</b> first receives the random number R<b>2</b> from the communication unit <b>340</b> and reads the apparatus key Aj from the apparatus key storing unit <b>310</b>.</p>
<p id="p-0152" num="0151">The encryption unit <b>332</b> then generates the encrypted random number S<b>2</b> by applying the encryption algorithm E<b>2</b> to the random number R<b>2</b> using the apparatus key Aj as the key of the encryption algorithm E<b>2</b>. The encrypted random number S<b>2</b> can be expressed by Formula 12 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>S</i>2<i>=E</i>2(<i>Aj,R</i>2)  &lt;Formula 12&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0153" num="0152">The encryption unit <b>332</b> finally outputs the encrypted random number S<b>2</b> to the communication unit <b>340</b>.</p>
<p id="h-0034" num="0000">(3) Decryption Unit <b>333</b></p>
<p id="p-0154" num="0153">The decryption unit <b>333</b> prestores the decryption algorithm D<b>2</b>.</p>
<p id="p-0155" num="0154">The relation between the encryption algorithm E<b>2</b> prestored in the encryption unit <b>252</b> and the decryption algorithm D<b>2</b> can be expressed by Formula 13 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E</i>2=crpt(<i>D</i>2)  &lt;Formula 13&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0156" num="0155">The decryption unit <b>333</b> first receives the encrypted random number S<b>1</b> from the communication unit <b>340</b> and reads the inherent key K′i from the media inherent key storing unit <b>323</b>.</p>
<p id="p-0157" num="0156">The decryption unit <b>333</b> then generates a random number R′<b>1</b> by applying the decryption algorithm D<b>2</b> to the encrypted random number S<b>1</b> using the inherent key K′i as the key of the decryption algorithm D<b>2</b>. The random number R′<b>1</b> can be expressed by Formula 14 given below.</p>
<p id="p-0158" num="0157">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <msup>
                  <mi>R</mi>
                  <mi>′</mi>
                </msup>
                <mo>⁢</mo>
                <mn>1</mn>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mi>D2</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>K</mi>
                        <mi>′</mi>
                      </msup>
                      <mo>⁢</mo>
                      <mi>i</mi>
                    </mrow>
                    <mo>,</mo>
                    <mi>S1</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mi>D2</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.8em" height="0.8ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <msup>
                        <mi>K</mi>
                        <mi>′</mi>
                      </msup>
                      <mo>⁢</mo>
                      <mi>i</mi>
                    </mrow>
                    <mo>,</mo>
                    <mrow>
                      <mi>E2</mi>
                      <mo>⁢</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>Ki</mi>
                          <mo>,</mo>
                          <mi>R1</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>&lt;</mo>
        <mrow>
          <mi>Formula</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mn>14</mn>
        </mrow>
        <mo>&gt;</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0159" num="0158">The decryption unit <b>333</b> finally outputs the random number R′<b>1</b> to the mutual authentication control unit <b>334</b>.</p>
<p id="h-0035" num="0000">(4) Mutual Authentication Control Unit <b>334</b></p>
<p id="p-0160" num="0159">The mutual authentication control unit <b>334</b> receives the random number R′<b>1</b> and the random number R<b>1</b> from the decryption unit <b>333</b> and the random number generating unit <b>331</b>, respectively.</p>
<p id="p-0161" num="0160">The mutual authentication control unit <b>334</b> then compares the random number R′<b>1</b> with the random number R<b>1</b>. If the random number R′<b>1</b> matches the random number R<b>1</b>, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b> placed in the memory card writer <b>300</b> is an authorized device; if not, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b> placed in the memory card writer <b>300</b> is an unauthorized device.</p>
<p id="p-0162" num="0161">After this judgement, the mutual authentication control unit <b>334</b> outputs an authentication signal to the control unit <b>350</b>. The authentication signal shows whether the memory card <b>200</b> placed in the memory card writer <b>300</b> is an authorized device.</p>
<p id="h-0036" num="0000">1.2.9 Communication Unit <b>340</b></p>
<p id="p-0163" num="0162">The communication unit <b>340</b> receives the encrypted inherent key Ji from the communication unit <b>270</b> of the memory card <b>200</b> and outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>320</b>.</p>
<p id="p-0164" num="0163">The communication unit <b>340</b> also receives the random number R<b>1</b> from the random number generating unit <b>331</b> and outputs the random number R<b>1</b> to the communication unit <b>270</b> of the memory card <b>200</b>.</p>
<p id="p-0165" num="0164">The communication unit <b>340</b> further receives the encrypted random number S<b>1</b> from the communication unit <b>270</b> of the memory card <b>200</b> and outputs the encrypted random number S<b>1</b> to the decryption unit <b>333</b> of the mutual authentication unit <b>330</b>.</p>
<p id="p-0166" num="0165">The communication unit <b>340</b> also reads the encrypted apparatus key Bj from the apparatus key information storing unit <b>312</b> and outputs the encrypted apparatus key Bj to the communication unit <b>270</b> of the memory card <b>200</b>.</p>
<p id="p-0167" num="0166">The communication unit <b>340</b> also receives the random number R<b>2</b> from the communication unit <b>270</b> of the memory card <b>200</b> and outputs the random number R<b>2</b> to the encryption unit <b>332</b> of the mutual authentication unit <b>330</b>.</p>
<p id="p-0168" num="0167">The communication unit <b>340</b> also receives the encrypted random number S<b>2</b> from the encryption unit <b>332</b> and outputs the encrypted random number S<b>2</b> to the communication unit <b>270</b> of the memory card <b>200</b>.</p>
<p id="p-0169" num="0168">On receiving a communication termination signal from the control unit <b>350</b>, the communication unit <b>340</b> terminates the communication with the communication unit <b>270</b> of the memory card <b>200</b>.</p>
<p id="p-0170" num="0169">The communication unit <b>340</b> further receives the encrypted partial contents Fi (where i=1, 2, 3, . . . ) from the encryption unit <b>360</b> and outputs the encrypted partial contents Fi to the communication unit <b>270</b> of the memory card <b>200</b>.</p>
<p id="h-0037" num="0000">1.2.10 Control Unit <b>350</b></p>
<p id="p-0171" num="0170">The control unit <b>350</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area. The control unit <b>350</b> receives an authentication signal from the mutual authentication control unit <b>334</b>. The authentication signal shows whether the memory card <b>200</b> placed in the memory card writer <b>300</b> is an authorized device.</p>
<p id="p-0172" num="0171">When the authentication signal shows that the memory card <b>200</b> is an unauthorized device, the control unit <b>350</b> outputs a communication termination signal to the communication unit <b>340</b>, which then terminates the communication with the memory card <b>200</b>.</p>
<p id="p-0173" num="0172">When the authentication signal shows that the memory card <b>200</b> is an authorized device, the control unit outputs a download signal to the content download unit <b>380</b>, which then downloads contents from the outside.</p>
<p id="h-0038" num="0000">1.2.11 Content Download Unit <b>380</b></p>
<p id="p-0174" num="0173">The content download unit <b>380</b> receives a download signal from the control unit <b>350</b>.</p>
<p id="p-0175" num="0174">After receiving the download signal from the control unit <b>350</b>, the content download unit <b>380</b> downloads music data from the outside via the communication line <b>10</b> and outputs the music data to the content storing unit <b>370</b>.</p>
<p id="p-0176" num="0175">It should be noted here that in this embodiment, music data is downloaded. However, other contents, such as document, image, and movie data, may be downloaded.</p>
<p id="h-0039" num="0000">1.2.12 Content Storing Unit <b>370</b></p>
<p id="p-0177" num="0176">The content storing unit <b>370</b> includes a semiconductor memory, receives contents from the content download unit <b>380</b>, and holds the contents.</p>
<p id="h-0040" num="0000">1.2.13 Encryption Unit <b>360</b></p>
<p id="p-0178" num="0177">The encryption unit <b>360</b> includes a processor, a ROM for storing programs, and a RAM for providing a work area. The encryption unit <b>360</b> also prestores the encryption algorithm E<b>2</b> that conforms to DES.</p>
<p id="p-0179" num="0178">The encryption unit <b>360</b> first reads a content from the content storing unit <b>370</b> and reads the inherent key K′i from the media inherent key storing unit <b>323</b>.</p>
<p id="p-0180" num="0179">The encryption unit <b>360</b> then divides the content read from the content storing unit <b>370</b> into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which each is a 64-bit bit string and generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the inherent key K′i read from the media inherent key storing unit <b>323</b> as the key of the encryption algorithm E<b>2</b>. The plurality of encrypted partial contents Fi can be expressed by Formula 15 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Fi=E</i>2(<i>K′i,Ci</i>) (where <i>i=</i>1, 2, 3, . . . )  &lt;Formula 15&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0181" num="0180">The encryption unit <b>360</b> finally outputs the encrypted partial contents Fi to the communication unit <b>340</b>.</p>
<p id="h-0041" num="0000">1.3 Construction of Memory Card Reader <b>400</b></p>
<p id="p-0182" num="0181"><figref idref="DRAWINGS">FIG. 6</figref> shows the construction of the memory card reader <b>400</b>. As shown in this drawing, the memory card reader <b>400</b> includes an apparatus key storing unit <b>410</b>, a conversion unit <b>411</b>, an apparatus key information storing unit <b>412</b>, a master key storing unit <b>413</b>, a media inherent key information storing unit <b>420</b>, an inversion unit <b>421</b>, a media inherent key storing unit <b>423</b>, a mutual authentication unit <b>430</b>, a communication unit <b>440</b>, a control unit <b>450</b>, a decryption unit <b>460</b>, a content storing unit <b>470</b>, a reproduction unit <b>480</b>, and an operation unit <b>490</b>.</p>
<p id="p-0183" num="0182">The apparatus key storing unit <b>410</b>, the conversion unit <b>411</b>, the apparatus key information storing unit <b>412</b>, the master key storing unit <b>413</b>, the media inherent key information storing unit <b>420</b>, the inversion unit <b>421</b>, the media inherent key storing unit <b>423</b>, the mutual authentication unit <b>430</b>, and the communication unit <b>440</b> of the memory card reader <b>400</b> are respectively the same as the apparatus key storing unit <b>310</b>, the conversion unit <b>311</b>, the apparatus key information storing unit <b>312</b>, the master key storing unit <b>313</b>, the media inherent key information storing unit <b>320</b>, the inversion unit <b>321</b>, the media inherent key storing unit <b>323</b>, the mutual authentication unit <b>330</b>, and the communication unit <b>340</b> of the memory card writer <b>300</b>. Therefore, the following description omits these elements and centers on the elements that have the different functions and perform the different operations.</p>
<p id="h-0042" num="0000">1.3.1 Control Unit <b>450</b></p>
<p id="p-0184" num="0183">The control unit <b>450</b> receives an authentication signal and, when the authentication signal shows that the memory card <b>200</b> placed in the memory card reader <b>400</b> is an authorized device, outputs a decryption signal to the decryption unit <b>460</b>, which then decrypts the encrypted content received from the communication unit <b>440</b>.</p>
<p id="h-0043" num="0000">1.3.2 Decryption Unit <b>460</b></p>
<p id="p-0185" num="0184">The decryption unit <b>460</b> prestores the decryption algorithm D<b>2</b> that conforms to DES, and receives a decryption signal from the control unit <b>450</b>.</p>
<p id="p-0186" num="0185">On receiving a decryption signal from the control unit <b>450</b>, the decryption unit <b>460</b> receives an encrypted content from the communication unit <b>440</b> and reads the inherent key K′i from the media inherent key storing unit <b>423</b>.</p>
<p id="p-0187" num="0186">The decryption unit <b>460</b> then divides the encrypted content into a plurality of partial encrypted contents Gi (i=1, 2, 3, . . . ) which each are a 64-bit bit string and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each partial encrypted contents Gi using the inherent key K′i read from the media inherent key storing unit <b>423</b> as the key of the decryption algorithm D<b>2</b>. The generated partial contents Hi can be expressed by Formula 16 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Hi=D</i>2(<i>K′i,Gi</i>) (where <i>i=</i>1, 2, 3, . . . )  &lt;Formula 16&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0188" num="0187">The decryption unit <b>460</b> finally outputs the generated partial contents Hi to the content storing unit <b>470</b>.</p>
<p id="h-0044" num="0000">1.3.3 Content Storing Unit <b>470</b></p>
<p id="p-0189" num="0188">The content storing unit <b>470</b> receives the partial contents Hi from the decryption unit <b>460</b> and holds the partial contents Hi.</p>
<p id="h-0045" num="0000">1.3.4 Operation Unit <b>490</b></p>
<p id="p-0190" num="0189">The operation unit <b>490</b> includes a plurality of buttons for allowing a user to input various instructions.</p>
<p id="p-0191" num="0190">When the user pushes a button, the operation unit <b>490</b> outputs a signal corresponding to the pushed button to the reproduction unit <b>480</b>.</p>
<p id="h-0046" num="0000">1.3.5 Reproduction Unit <b>480</b></p>
<p id="p-0192" num="0191">The reproduction unit <b>480</b> receives a signal corresponding to the button pushed by the user from the operation unit <b>490</b>.</p>
<p id="p-0193" num="0192">After receiving the signal, the reproduction unit <b>480</b> reads the music data from the content storing unit <b>470</b> and reproduces the music data.</p>
<p id="h-0047" num="0000">2. Operation of Digital Content Protection System <b>100</b></p>
<p id="p-0194" num="0193">The following is a description of the operation of the digital content protection system <b>100</b>.</p>
<p id="h-0048" num="0000">2.1 Operation Outline in the Case Where Memory Card <b>200</b> is Placed in Memory Card Writer <b>300</b></p>
<p id="p-0195" num="0194">The operation outline in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b> is described below with reference to the flowchart shown in <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0196" num="0195">After the memory card <b>200</b> is placed in the memory card writer <b>300</b>, the memory card writer <b>300</b> judges whether the memory card <b>200</b> is an authorized device (step S<b>110</b>). When the memory card writer <b>300</b> judges that the memory card <b>200</b> is an unauthorized device (step S<b>111</b>), the memory card writer <b>300</b> does not communicate with the memory card <b>200</b> and terminates the operation.</p>
<p id="p-0197" num="0196">When the memory card writer <b>300</b> judges that the memory card <b>200</b> is an authorized device (step S<b>111</b>), the memory card <b>200</b> whether the memory card writer <b>300</b> is an authorized device (step S<b>112</b>). When the memory card <b>200</b> judges that the memory card writer <b>300</b> is an unauthorized device (step S<b>113</b>), the memory card <b>200</b> does not communicate with the memory card writer <b>300</b> and terminates the operation.</p>
<p id="p-0198" num="0197">When the memory card <b>200</b> judges that the memory card writer <b>300</b> is an authorized device (step S<b>113</b>), the memory card writer <b>300</b> downloads a content from the outside, encrypts the downloaded content, and outputs the encrypted content to the memory card <b>200</b> (step S<b>114</b>). The memory card <b>200</b> holds the encrypted content (step S<b>115</b>).</p>
<p id="h-0049" num="0000">2.2 Operation Outline in the Case Where Memory Card <b>200</b> is Placed in Memory Card Reader <b>400</b></p>
<p id="p-0199" num="0198">The operation outline in the case where the memory card <b>200</b> is placed in the memory card reader <b>400</b> is described below with reference to the flowchart shown in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0200" num="0199">After the memory card <b>200</b> is placed in the memory card reader <b>400</b>, the memory card reader <b>400</b> judges whether the memory card <b>200</b> is an authorized device (step S<b>120</b>). When the memory card reader <b>400</b> judges that the memory card <b>200</b> is an unauthorized device (step S<b>121</b>), the memory-card reader <b>400</b> does not communicate with the memory card <b>200</b> and terminates the operation.</p>
<p id="p-0201" num="0200">When the memory card reader <b>400</b> judges that the memory card <b>200</b> is an authorized device (step S<b>121</b>), the memory card <b>200</b> judges whether the memory card reader <b>400</b> is an authorized device (step S<b>122</b>). When the memory card <b>200</b> judges that the memory card reader <b>400</b> is an unauthorized device (step S<b>123</b>), the memory card <b>200</b> does not communicate with the memory card reader <b>400</b> and terminates the operation.</p>
<p id="p-0202" num="0201">When the memory card <b>200</b> judges that the memory card reader <b>400</b> is an authorized device (step S<b>123</b>), the memory card <b>200</b> outputs encrypted contents to the memory card reader <b>400</b> (step S<b>124</b>). The memory card reader <b>400</b> decrypts the encrypted contents outputted from the memory card <b>200</b> (step S<b>125</b>) and reproduces the decrypted contents (step S<b>126</b>).</p>
<p id="h-0050" num="0000">2.3 Authentication Operation in the Case Where Memory Card <b>200</b> is Placed in Memory Card Writer <b>300</b></p>
<p id="p-0203" num="0202">The authentication operation in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b> is described in detail below with reference to <figref idref="DRAWINGS">FIGS. 9 and 10</figref>.</p>
<p id="p-0204" num="0203">The conversion unit <b>230</b> generates the encrypted inherent key E<b>1</b> (Mk,Ki) by applying the encryption algorithm E<b>1</b> to the inherent key Ki using the master key Mk as the key of the encryption algorithm E<b>1</b> (step S<b>130</b>). The communication unit <b>270</b> outputs the encrypted inherent key E<b>1</b> (Mk,Ki) to the inversion unit <b>321</b> via the communication unit <b>340</b> (step S<b>131</b>). The inversion unit <b>321</b> generates the inherent key K′i=D<b>1</b> (Mk,E<b>1</b> (Mk,Ki)) by applying the decryption algorithm D<b>1</b> to the encrypted inherent key E<b>1</b> (Mk,Ki) using the master key Mk as the key of the decryption algorithm D<b>1</b> (step S<b>132</b>). The random number generating unit <b>331</b> generates the random number R<b>1</b> (step S<b>133</b>). The communication unit <b>340</b> outputs the generated random number R<b>1</b> to the encryption unit <b>252</b> via the communication unit <b>270</b> (step S<b>134</b>). The encryption unit <b>252</b> generates the encrypted random number E<b>2</b> (Ki,R<b>1</b>) by applying the encryption algorithm E<b>2</b> to the random number R<b>1</b> using the inherent key Ki as the key of the encryption algorithm E<b>2</b> (step S<b>135</b>). The communication unit <b>270</b> outputs the encrypted random number E<b>2</b> (Ki,R<b>1</b>) to the decryption unit <b>333</b> via the communication unit <b>340</b> (step S<b>136</b>). The decryption unit <b>333</b> generates D<b>2</b> (K′i,E<b>2</b> (Ki,R<b>1</b>)) by applying the decryption algorithm D<b>2</b> to the encrypted random number E<b>2</b> (Ki,R<b>1</b>) using the inherent key K′i as the key of the decryption algorithm D<b>2</b> (step S<b>137</b>). The mutual authentication control unit <b>334</b> compares the random number R<b>1</b> with D<b>2</b> (K′i,E<b>2</b> (Ki,R<b>1</b>)). If the random number R<b>1</b> matches D<b>2</b> (K′i,E<b>2</b> (Ki,R<b>1</b>)), the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b> is an authorized device; if not, the mutual authentication control unit judges that the memory card <b>200</b> is an unauthorized device (step S<b>138</b>).</p>
<p id="p-0205" num="0204">The conversion unit <b>311</b> generates the encrypted key E<b>3</b> (Mk,Aj) by applying the encryption algorithm E<b>3</b> to the apparatus key Aj using the master key Mk as the key of the encryption algorithm E<b>3</b> (step S<b>139</b>). The communication unit <b>340</b> outputs the encrypted apparatus key E<b>3</b> (Mk,Aj) to the inversion unit <b>222</b> via the communication unit <b>270</b> (step S<b>140</b>). The inversion unit <b>222</b> generates the apparatus key A′j=D<b>3</b> (Mk,E<b>3</b> (Mk,Aj)) by applying the decryption algorithm D<b>3</b> to the encrypted apparatus key E<b>3</b> (Mk,Aj) using the master key Mk as the key of the decryption algorithm D<b>3</b> (step S<b>141</b>). The random number generating unit <b>251</b> generates the random number R<b>2</b> (step S<b>142</b>). The communication unit <b>270</b> outputs the generated random number R<b>2</b> to the encryption unit <b>332</b> via the communication <b>340</b> (step S<b>143</b>). The encryption unit <b>332</b> generates the encrypted random number E<b>2</b> (Aj,R<b>2</b>) by applying the encryption algorithm E<b>2</b> to the random number R<b>2</b> using the apparatus key Aj as the key of the encryption algorithm E<b>2</b> (step S<b>144</b>). The communication unit <b>340</b> outputs the encrypted random number E<b>2</b> (Aj,R<b>2</b>) to the decryption unit <b>253</b> via the communication unit <b>270</b> (step S<b>145</b>). The decryption unit <b>253</b> generates D<b>2</b> (A′j,E<b>2</b> (Aj,R<b>2</b>)) by applying the decryption algorithm D<b>2</b> to the encrypted random number E<b>2</b> (Aj,R<b>2</b>) using the apparatus key A′j as the key of the decryption algorithm D<b>2</b> (step S<b>146</b>). The mutual authentication control unit <b>254</b> compares the random number R<b>2</b> with D<b>2</b> (A′j,E<b>2</b> (Aj,R<b>2</b>)). If the random number R<b>2</b> matches D<b>2</b> (A′j,E<b>2</b> (Aj,R<b>2</b>)), the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b> is an authorized device; if not, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b> is an unauthorized device (step S<b>147</b>).</p>
<p id="h-0051" num="0000">2.4 Conclusion</p>
<p id="p-0206" num="0205">As described above, a recording medium device, such as a memory card, that includes an area for holding encrypted digital contents is connected to an access device, such as a memory card writer or a memory card reader, that writes information into or reads information from the area of the recording medium device. Each of these devices then judges whether the other device is an authorized devices. Only if both of these devices judge that the other device is an authorized device, contents are transferred between these devices. With this construction, an authorized device does not transfer contents to an unauthorized device. This prevents contents that have been properly downloaded from being used without a proper authorization. Also, an unauthorized device cannot transfer contents to an authorized device, which prevents illegally obtained contents from being reused. As a result, the digital content protection system of the present embodiment performs a very secure authentication process which prevents replay attacks by an unauthorized recording medium device that imitates the authentication procedure performed by an authorized access device. Also, the present digital content protection system prevents an unauthorized device from circumventing an authorized device to read or to write contents without proper authorization.</p>
<p id="p-0207" num="0206">The recording medium device encrypts its inherent key using a master key and sends the encrypted inherent key to the access device. The access device generates authentication information, which is to say a random number, and sends the authentication information to the recording medium device. The recording medium device encrypts the authentication information using the inherent key and sends the encrypted authentication information to the access device. The access device decrypts the encrypted inherent key using the master key, decrypts the encrypted authentication information using the decrypted inherent key, and judges whether the recording medium device is an authorized device by comparing the original authentication information with the decrypted authentication information. If the original authentication information matches the decrypted authentication information, the access device judges that the recording medium device is an authorized device. This process is also performed when the recording medium device judges whether the access device is an authorized device. Therefore, each of these devices can judge whether the other device is an authorized device. During the authentication process, three information transfers, that is, the transfer of encrypted inherent key, the transfer of authentication information, and the transfer of encrypted authentication information, are performed between these devices. These information transfers make it difficult for an unauthorized device to imitate the authentication procedure. Also, the present digital content protection system performs two types of encryptions, that is, the encryption of the inherent key and the encryption of the authentication information. These encryptions make it difficult for an unauthorized device to decrypt the encrypted information. Furthermore, because the master key is not transferred between the devices, the leakage of the master key is prevented.</p>
<heading id="h-0052" level="1">3. Second Embodiment</heading>
<p id="p-0208" num="0207">The digital content protection system <b>100</b><i>a </i>of the second embodiment is described below.</p>
<p id="h-0053" num="0000">3.1 Digital Content Protection System <b>100</b><i>a </i></p>
<p id="p-0209" num="0208"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing the construction of the digital content protection system <b>100</b><i>a </i>of the second embodiment. As shown in this drawing, the digital content protection system <b>100</b><i>a </i>includes a memory card <b>200</b><i>a</i>, a media inherent key information generating device <b>600</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b>.</p>
<p id="p-0210" num="0209">The memory card writer <b>300</b> and the memory card reader <b>400</b> of the present system are respectively the same as those of the digital content protection system <b>100</b> and are not described here.</p>
<p id="p-0211" num="0210">The memory card <b>200</b><i>a </i>is connected to the media inherent key information generating device <b>600</b>.</p>
<p id="h-0054" num="0000">3.1.1 Media Inherent Key Information Generating Device <b>600</b></p>
<p id="p-0212" num="0211">The media inherent key information generating device <b>600</b> includes a master key storing unit <b>210</b><i>b</i>, a media inherent key storing unit <b>220</b><i>b</i>, a conversion unit <b>230</b><i>b</i>, a media inherent key information storing unit <b>240</b><i>b</i>, and a communication unit <b>270</b><i>b. </i></p>
<p id="p-0213" num="0212">The master key storing unit <b>210</b><i>b</i>, the media inherent key storing unit <b>220</b><i>b</i>, the conversion unit <b>230</b><i>b</i>, and the media inherent key information storing unit <b>240</b><i>b </i>are respectively similar to the master key storing unit <b>210</b>, the media inherent key storing unit <b>220</b>, the conversion unit <b>230</b>, and the media inherent key information storing unit <b>240</b> of the memory card <b>200</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0055" num="0000">(1) Master Key Storing Unit <b>210</b><i>b </i></p>
<p id="p-0214" num="0213">The master key storing unit <b>210</b><i>b </i>prestores the master key Mk, like the master key storing unit <b>210</b>.</p>
<p id="h-0056" num="0000">(2) Media Inherent Key Storing Unit <b>220</b><i>b </i></p>
<p id="p-0215" num="0214">The media inherent key storing unit <b>220</b><i>b </i>receives the inherent key Ki from the communication unit <b>270</b><i>b </i>and holds the inherent key Ki.</p>
<p id="h-0057" num="0000">(3) Conversion Unit <b>230</b><i>b </i></p>
<p id="p-0216" num="0215">The conversion unit <b>230</b><i>b</i>, in the same manner as the conversion unit <b>230</b>, generates the encrypted inherent key Ji using the inherent key Ki held in the media inherent key storing unit <b>220</b><i>b </i>and the master key Mk prestored in the master key storing unit <b>210</b><i>b</i>. The conversion unit <b>230</b><i>b </i>then outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>240</b><i>b. </i></p>
<p id="h-0058" num="0000">(4) Media Inherent Key Information Storing Unit <b>240</b><i>b </i></p>
<p id="p-0217" num="0216">The media inherent key information storing unit <b>240</b><i>b </i>receives the encrypted inherent key Ji from the conversion unit <b>230</b><i>b </i>and holds the encrypted inherent key Ji.</p>
<p id="h-0059" num="0000">(5) Communication Unit <b>270</b><i>b </i></p>
<p id="p-0218" num="0217">The communication unit <b>270</b><i>b </i>receives the inherent key Ki from the communication unit <b>270</b><i>a </i>of the memory card <b>200</b><i>a </i>and outputs the inherent key Ki to the media inherent key storing unit <b>220</b><i>b. </i></p>
<p id="p-0219" num="0218">Also, the communication unit <b>270</b><i>b </i>reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b><i>b </i>and outputs the encrypted inherent key Ji to the communication unit. <b>270</b><i>a </i>of the memory card <b>200</b><i>a. </i></p>
<p id="h-0060" num="0000">3.1.2 Memory Card <b>200</b><i>a </i></p>
<p id="p-0220" num="0219">As shown in <figref idref="DRAWINGS">FIG. 11</figref>, the memory card <b>200</b><i>a </i>includes a master key storing unit <b>210</b>, a media inherent key storing unit <b>220</b>, a media inherent key information storing unit <b>240</b><i>a</i>, an apparatus key storing unit <b>221</b>, an inversion unit <b>222</b>, an apparatus key information storing unit <b>223</b>, a mutual authentication unit <b>250</b>, an encrypted content storing unit <b>260</b>, a communication unit <b>270</b><i>a</i>, and a control unit <b>280</b>.</p>
<p id="p-0221" num="0220">The master key storing unit <b>210</b>, the media inherent key storing unit <b>220</b>, the apparatus key storing unit <b>221</b>, the inversion unit <b>222</b>, the apparatus key information storing unit <b>223</b>, the mutual authentication unit <b>250</b>, the encrypted content storing unit <b>260</b>, and the control unit <b>280</b> of the memory card <b>200</b><i>a </i>are respectively the same as those of the memory card <b>200</b> and are not described here. Therefore, the following description centers on the media inherent key information storing unit <b>240</b><i>a </i>and the communication unit <b>270</b><i>a </i>that are different from the media inherent key information storing unit <b>240</b> and the communication unit <b>270</b> of the memory card <b>200</b>.</p>
<p id="h-0061" num="0000">(1) Media Inherent Key Information Storing Unit <b>240</b><i>a </i></p>
<p id="p-0222" num="0221">The media inherent key information storing unit <b>240</b><i>a </i>receives the encrypted inherent key Ji from the communication unit <b>270</b><i>a </i>and holds the encrypted inherent key Ji.</p>
<p id="h-0062" num="0000">(2) Communication Unit <b>270</b><i>a </i></p>
<p id="p-0223" num="0222">The communication unit <b>270</b><i>a </i>reads the inherent key Ki from the media inherent key storing unit <b>220</b> and outputs the inherent key Ki to the communication unit <b>270</b><i>b </i>of the media inherent key information generating device <b>600</b>.</p>
<p id="p-0224" num="0223">Also, the communication unit <b>270</b><i>a </i>receives the encrypted inherent key Ji from the communication unit <b>270</b><i>b </i>of the media inherent key information generating device <b>600</b> and outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>240</b><i>a. </i></p>
<p id="h-0063" num="0000">3.1.3 Operation in the Case Where Memory Card <b>200</b><i>a </i>is Placed in Media Inherent Key Information Generating Device <b>600</b></p>
<p id="p-0225" num="0224">The operation in the case where the memory card <b>200</b><i>a </i>is placed in the media inherent key information generating device <b>600</b> is described below with reference to <figref idref="DRAWINGS">FIG. 12</figref>.</p>
<p id="p-0226" num="0225">When the memory card <b>200</b><i>a </i>is placed in the media inherent key information generating device <b>600</b>, the communication unit <b>270</b><i>a </i>reads the inherent key Ki from the media inherent key storing unit <b>220</b> and outputs the inherent key Ki to the media inherent key storing unit <b>220</b><i>b </i>via the communication unit <b>270</b><i>b </i>of the media inherent key information generating device <b>600</b> (step S<b>211</b>). The conversion unit <b>230</b><i>b </i>generates the encrypted inherent key Ji using the inherent key Ki held in the media inherent key storing unit <b>220</b><i>b </i>and the master key Mk prestored in the master key storing unit <b>210</b><i>b</i>, and outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>240</b><i>b </i>(step S<b>212</b>). The communication unit <b>270</b><i>b </i>reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b><i>b </i>and outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>240</b><i>a </i>via the communication unit <b>270</b><i>a </i>of the memory card <b>200</b><i>a </i>(step S<b>213</b>).</p>
<p id="h-0064" num="0000">3.1.4 Authentication Operation in the Case Where Memory Card <b>200</b><i>a </i>is Placed in Memory card Writer <b>300</b></p>
<p id="p-0227" num="0226">The authentication operation in the case where the memory card <b>200</b><i>a </i>is placed in the memory card writer <b>300</b> is described in detail below with reference to <figref idref="DRAWINGS">FIG. 12</figref>. The following description centers on the different steps between the authentication operations shown in <figref idref="DRAWINGS">FIG. 9</figref> and <figref idref="DRAWINGS">FIG. 12</figref>.</p>
<p id="p-0228" num="0227">The authentication operation shown in <figref idref="DRAWINGS">FIG. 12</figref> includes steps S<b>201</b>-S<b>206</b>, instead of steps S<b>139</b>-S<b>147</b> in the authentication operation shown in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0229" num="0228">After the random number generating unit <b>251</b> generates a random number R<b>3</b> (steps S<b>201</b>), the communication unit <b>270</b><i>a </i>outputs the generated random number R<b>3</b> to the encryption unit <b>332</b> via the communication <b>340</b> (step S<b>202</b>). The encryption unit <b>332</b> generates the encrypted random number E<b>2</b> (Mk,R<b>3</b>) by applying the encryption algorithm E<b>2</b> to the random number R<b>3</b> using the master key Mk as the key of the encryption algorithm E<b>2</b> (step S<b>203</b>). The communication unit <b>340</b> outputs the encrypted random number E<b>2</b> (Mk,R<b>3</b>) to the decryption unit <b>253</b> via the communication unit <b>270</b> (step S<b>204</b>). The decryption unit <b>253</b> generates D<b>2</b> (Mk,E<b>2</b> (Mk,R<b>3</b>)) by applying the decryption algorithm D<b>2</b> to the encrypted random number E<b>2</b> (Mk,R<b>3</b>) using the master key Mk as the key of the decryption algorithm D<b>2</b> (step S<b>205</b>). The mutual authentication control unit <b>254</b> compares the random number R<b>3</b> with D<b>2</b> (Mk,E<b>2</b> (Mk,R<b>3</b>)). If the random number R<b>3</b> matches D<b>2</b> (Mk,E<b>2</b> (Mk,R<b>3</b>)), the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b> is an authorized device; if not, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b> is an unauthorized device (step S<b>206</b>).</p>
<p id="h-0065" num="0000">3.1.5 Conclusion</p>
<p id="p-0230" num="0229">In the second embodiment, before distributed or sold to a user, the memory card <b>200</b><i>a </i>is connected to the media inherent key information generating device <b>600</b>, the media inherent key information generating device <b>600</b> generates the encrypted inherent key Ji, the encrypted inherent key Ji is written into the memory card <b>200</b><i>a. </i></p>
<p id="p-0231" num="0230">Accordingly, the memory card <b>200</b><i>a </i>does not need to include the conversion unit <b>230</b> that is included in the memory card <b>200</b>. As a result, the hardware scale of the memory card <b>200</b><i>a </i>is reduced, in comparison with the memory card <b>200</b>.</p>
<p id="p-0232" num="0231">When judging whether an access device is an authorized device, a recording medium device generates authentication information, which is to say a random number, and transfers the authentication information to the access device. After receiving the authentication information, the access device encrypts the received authentication information using the master key and transfers the encrypted authentication information to the recording medium device. The recording medium device decrypts the encrypted authentication information using the master key and compares the original authentication information with the decrypted authentication information. If the original authentication information matches the decrypted authentication information, the recording medium device judges that the access device is an authorized device. This authentication operation performed by the digital content protection system <b>100</b><i>a </i>is simpler than that performed by the digital content protection system <b>100</b>. Because the master key is not transferred between apparatuses in the digital content protection system <b>100</b><i>a</i>, leakage of the master key can be prevented.</p>
<p id="h-0066" num="0000">3.2 Modification of Digital Content Protection System <b>100</b></p>
<p id="p-0233" num="0232">In the digital content protection system <b>100</b>, the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b> prestores the same master key, and the master key is used as the key of a common key encryption algorithm and a common key decryption algorithm. However, instead of the master key, the memory card <b>200</b> may prestore a public key Kp and each of the memory card writer <b>300</b> and the memory card reader <b>400</b> may prestore a secret key Ks. The public key Kp and the secret key Ks are obtained under the RSA cryptosystem, which is to say a type of the public key cryptosystem.</p>
<p id="p-0234" num="0233">The following description concerns the process where the public key Kp and the secret key Ks are determined. Prime numbers p and q are assumed to be decimal numbers having around 160 digits, a value n is assumed to be the product of these prime numbers, an integer L is assumed to be the least common multiple of p−1 and q−1, and values e and d are assumed to be invertible in a modulo L. That is, the relation between the values e and d is represented by e·d=1(mod L). Also, the public key Kp is assumed to be the values n and e, and the secret key Ks is assumed to be the value d. On these assumptions, the conversion unit obtains a conversion result C by performing M<sup>e </sup>(multiplication of an input M by e times) in the modulo n. Also, the inversion unit obtains the input M by performing C<sup>d </sup>(multiplication of the conversion result C by d times). Because C<sup>d</sup>=(M<sup>e</sup>)<sup>d</sup>=M<sup>ed</sup>=M in the modulo n, the conversion result C is appropriately inverted into the input M.</p>
<p id="p-0235" num="0234">The public key Kp is generated by a separated public key generating apparatus in the manner described above and is transferred to the memory card <b>200</b>.</p>
<p id="h-0067" num="0000">(Authentication Operation in the Case Where Memory Card <b>200</b> is Placed in Memory Card Writer <b>300</b>)</p>
<p id="p-0236" num="0235">The authentication operation in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b> is described in detail below with reference to <figref idref="DRAWINGS">FIG. 13</figref>. Note that the steps of this modification that are the same as steps of the above embodiments are assigned the same numbers as in <figref idref="DRAWINGS">FIG. 10</figref> and are not described here.</p>
<p id="p-0237" num="0236">The public key generating apparatus reads the secret key Ks from the memory card writer <b>300</b>, generates the public key Kp from the secret key Ks using a public key encryption algorithm, and sends the generated public key Kp to the memory card <b>200</b>. The memory card <b>200</b> holds the public key Kp (step S<b>301</b>).</p>
<p id="p-0238" num="0237">The conversion unit <b>230</b> generates the encrypted inherent key E<b>4</b> (Kp,Ki) by applying the encryption algorithm E<b>4</b> to the inherent key Ki using the public key Kp as the key of the encryption algorithm E<b>4</b> (step S<b>302</b>). The communication unit <b>270</b> outputs the encrypted inherent key E<b>4</b> (Kp,Ki) to the inversion unit <b>321</b> via the communication unit <b>340</b> (step S<b>303</b>). The inversion unit <b>321</b> generates the inherent key K′i=D<b>4</b> (Ks,E<b>4</b> (Kp,Ki)) by applying the decryption algorithm D<b>4</b> to the encrypted inherent key E<b>4</b> (Kp,Ki) using the secret key Ks as the key of the decryption algorithm D<b>4</b> (step S<b>304</b>).</p>
<p id="p-0239" num="0238">It should be noted here that in this modification, the encryption algorithm E<b>4</b> and the decryption algorithm D<b>4</b> are based on the RSA cryptosystem. However, the encryption algorithm E<b>4</b> and the decryption algorithm D<b>4</b> may be based on any cryptosystem.</p>
<p id="p-0240" num="0239">Because the public key and secret key are generated in the manner described above, an outsider cannot calculate the public key e from the secret key d. This is because even if the outsider knows the secret key d, the outsider needs to know the modulo L to obtain the public key e from the secret key d. However, because the modulo L is the least common multiple of p−1 and q−1, the outsider cannot obtain the modulo L only from the product of p and q. Therefore, even if the outsider Uncovers the secret key d prestored in the memory card and the memory card writer, he cannot obtain the public key e from the secret key d. This makes it difficult for the outsider to make the counterfeit of the memory card.</p>
<p id="h-0068" num="0000">3.3 Another Modification of Digital Content Protection System <b>100</b></p>
<p id="p-0241" num="0240">In the digital content protection system of the above modification, a public key Kp and a secret key Ks are obtained under the RAS cryptosystem. However, in this modification, a secret key Ks and a public key Kp are obtained under the message recovery signature scheme over an elliptic curve, that is a public key cryptosystem. In this case, the memory card <b>200</b> prestores the secret key Ks and each of the memory card writer <b>300</b> and the memory card reader <b>400</b> prestore the public key Kp. The public key Kp and the secret key Ks are determined in the manner described below.</p>
<p id="p-0242" num="0241">A scalar x is selected as the secret key Ks. The point “G+G+ . . . +G (addition of G by x times)” over an elliptic curve is determined as the public key Kp, with the base point on the elliptic curve being set as G. During the conversion process, the recovery signature conversion is performed using the secret key Ks. During the inversion process, the recovery signature verification conversion is performed using the public key Kp. The recovery signature method is described in “A message recovery signature scheme equivalent to DSA over elliptic curves” (Atsuko Miyaji, Advances in Cryptology-Proceedings of ASIACRYPT '96, Lecture Notes in Computer Science, 1163 (1996), Springer-Verlag, 1-14) and is not described here.</p>
<p id="p-0243" num="0242">In the digital content protection system of this modification, a separated public key generating apparatus generates a public key Kp from a secret key Ks prestored in the memory card <b>200</b> using a public key encryption algorithm, and sends the generated public key Kp to the memory card writer <b>300</b>.</p>
<p id="p-0244" num="0243">The conversion unit <b>230</b> generates the encrypted inherent key E<b>4</b> (Ks,Ki) by applying the encryption algorithm E<b>4</b> to the inherent key Ki using the secret key Ks as the key of the encryption algorithm E<b>4</b>. The inversion unit <b>321</b> generates the inherent key K′i=D<b>4</b> (Kp, E<b>4</b> (Ks,Ki)) by applying the decryption algorithm D<b>4</b> to the encrypted inherent key E<b>4</b> (Ks,Ki) using the public key Kp as the key of the decryption algorithm D<b>4</b>.</p>
<p id="p-0245" num="0244">Because the public key Kp and the secret key Ks are generated in the manner described above, enormous amounts of calculation need to be performed to obtain the secret key Ks from the public key Kp. As a result, it is very difficult to calculate the secret key Ks from the public key Kp. Also, the security level of the digital content service system can be enhanced in total by assigning a secret key to the memory card and assigning a public key to the memory card writer and the memory card reader. This is because the memory card writer and the memory card reader generally have the high possibilities that their internal constructions are analyzed, in comparison with the memory card.</p>
<p id="p-0246" num="0245">It should be noted here that because public key cryptosystems, such as the elliptic curve cryptosystem, achieve the system security by utilizing discrete logarithm questions, public keys can be uncovered from secret keys in the public key cryptosystems.</p>
<heading id="h-0069" level="1">3.4 Third Embodiment</heading>
<p id="p-0247" num="0246">The digital content protection system <b>100</b><i>c </i>of the third embodiment includes a memory card <b>200</b><i>c </i>shown in <figref idref="DRAWINGS">FIG. 14</figref>, a memory card writer <b>300</b><i>c </i>shown in <figref idref="DRAWINGS">FIG. 15</figref>, and a memory card reader <b>400</b><i>c </i>shown in <figref idref="DRAWINGS">FIG. 16</figref>.</p>
<p id="p-0248" num="0247">The memory card <b>200</b><i>c </i>is placed in a master key selection apparatus that is not shown in the drawings. The memory card writer <b>300</b><i>c </i>and the memory card reader <b>400</b><i>c </i>are also connected to the master key selection apparatus.</p>
<p id="h-0070" num="0000">3.4.1 Master Key Selection Apparatus</p>
<p id="p-0249" num="0248">When the memory card <b>200</b><i>c </i>is placed in the master key selection apparatus, the master key selection apparatus is connected to the memory card <b>200</b><i>c </i>via the communication unit <b>270</b> of the memory card <b>200</b><i>c. </i></p>
<p id="p-0250" num="0249">The master key selection apparatus is also connected to the memory card writer <b>300</b><i>c </i>via the communication unit <b>340</b> of the memory card writer <b>300</b><i>c </i>and is connected to the memory card reader <b>400</b><i>c </i>via the communication unit <b>440</b> of the memory card reader <b>400</b><i>c. </i></p>
<p id="p-0251" num="0250">After connected to the memory card <b>200</b><i>c</i>, the memory card writer <b>300</b><i>c</i>, or the memory card reader <b>400</b><i>c</i>, the master key selection apparatus outputs a password to the communication unit of the connected device.</p>
<p id="p-0252" num="0251">The outputted password corresponds to one of a plurality of master keys.</p>
<p id="h-0071" num="0000">3.4.2 Memory Card <b>200</b><i>c </i></p>
<p id="p-0253" num="0252">The memory card <b>200</b><i>c </i>differs from the memory card <b>200</b> in that the memory card <b>200</b><i>c </i>further includes a master key selection unit <b>215</b>. Other elements of the memory card <b>200</b><i>c </i>are respectively the same as those of the memory card <b>200</b>. Therefore, the following description centers on the different aspects of the memory card <b>200</b><i>c. </i></p>
<p id="p-0254" num="0253">The master key storing unit <b>210</b> prestores the plurality of master keys.</p>
<p id="p-0255" num="0254">After the memory card <b>200</b><i>c </i>is connected to the master key selection apparatus, the communication unit <b>270</b> receives a password from the master key selection apparatus and outputs the received password to the master key selection unit <b>215</b>.</p>
<p id="p-0256" num="0255">The master key selection unit <b>215</b> finds which master key prestored in the master key storing unit <b>210</b> corresponds to the password and informs the master key storing unit <b>210</b> of the corresponding master key.</p>
<p id="p-0257" num="0256">The master key storing unit <b>210</b> gives a find mark to the corresponding master key. The find mark shows that the master key to which the find mark is given corresponds to the password.</p>
<p id="p-0258" num="0257">The conversion unit <b>230</b> and the inversion unit <b>222</b> read the master key to which the find mark is assigned.</p>
<p id="h-0072" num="0000">3.4.3 Memory Card Writer <b>300</b><i>c </i>and Memory Card Reader <b>400</b><i>c </i></p>
<p id="p-0259" num="0258">The memory card writer <b>300</b><i>c </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>c </i>further includes a master key selection unit <b>315</b>. Other elements of the memory card writer <b>300</b><i>c </i>are respectively the same as those of the memory card writer <b>300</b>.</p>
<p id="p-0260" num="0259">The master key storing unit <b>313</b> prestores the plurality of master keys.</p>
<p id="p-0261" num="0260">The memory card writer <b>300</b><i>c </i>performs the same operation as the memory card <b>200</b><i>c</i>. That is, the communication unit <b>340</b> receives a password from the master key selection apparatus and outputs the received password to the master key selection unit <b>315</b>. The master key selection unit <b>315</b> finds which master key prestored in the master key storing unit <b>313</b> corresponds to the password. The master key storing unit <b>313</b> gives a find mark to the corresponding master key. The find mark shows that the master key to which the find mark is given corresponds to the password.</p>
<p id="p-0262" num="0261">The conversion unit <b>311</b> and the inversion unit <b>321</b> read the master key to which the find mark is given.</p>
<p id="p-0263" num="0262">The memory card reader <b>400</b><i>c </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>c </i>further includes a master key selection unit <b>415</b>, and performs the same operation as the memory card writer <b>300</b><i>c. </i></p>
<p id="h-0073" num="0000">3.4.4 Conclusion</p>
<p id="p-0264" num="0263">The digital content protection system <b>100</b><i>c </i>of the third embodiment can be used to protect the contents delivered in a plurality of service systems. For instance, the plurality of service systems are a music delivery system that is cooperatively run by A, B, and C companies and a movie rental system that is cooperatively run by X, Y, and Z companies.</p>
<p id="p-0265" num="0264">Each service system is assigned a unique master key. For instance, the music delivery system is assigned a master key Mk<b>1</b> and the movie rental system is assigned a master key Mk<b>2</b> that is different from the master key Mk<b>1</b>.</p>
<p id="p-0266" num="0265">It is preferable that the service system to which the digital content protection system <b>100</b><i>c </i>is applied involves a license organization, manufacturers, and users. The license organization determines the standards of service systems, maintains the confidentiality of secret information, such as the master key, and issues a license to each manufacturer. Each manufacturer receives a license from the license organization, produces devices that conform to the standards determined by the license organization, and delivers the devices to users. The users use the delivered devices.</p>
<p id="p-0267" num="0266">It is difficult to define complete security conditions for preventing the manufacturers from leaking the master key during the production of devices, such as memory cards, memory card writers, and memory card readers. Also, it is relatively easy to analyze the internal constructions of memory card writers and memory card readers, in comparison with memory cards.</p>
<p id="p-0268" num="0267">To minimize the possibility of the leakage of the master key, to reduce the device production cost including the selection of the master key, and to slash the maintenance cost of the service system, the manufacturers select the master keys of the memory cards and the license organization selects the master keys of the memory card writers and the memory card readers.</p>
<p id="p-0269" num="0268">To do so, three types of master key selection apparatuses are used. The master key selection apparatuses are master key selection apparatus <b>901</b> for the memory cards, a master key selection apparatus <b>902</b> for the memory card writers, and a master key selection apparatus <b>903</b> for the memory card readers. The manufacturers have the master key selection apparatus <b>901</b> and the license organization keeps the master key selection apparatuses <b>902</b> and <b>903</b> and does not give them to the manufacturers.</p>
<p id="p-0270" num="0269">The manufacturers produce memory cards which each prestore a plurality of master keys and select one of the plurality of master keys using the master key selection apparatus <b>901</b>. On the other hand, each of the memory card writers and memory card readers prestores only a master key selected by the license organization using the master key selection apparatuses <b>902</b> and <b>903</b>.</p>
<p id="p-0271" num="0270">Because each of the recording medium device and access device prestores a plurality of master keys, the present digital content protection system can be applied to a plurality of digital content service systems.</p>
<p id="p-0272" num="0271">Also, because each service system is assigned a unique master key, even if the master key of a service system is leaked, other service systems are not affected by the master key leakage. As a result, the present digital content protection system achieves a high security effect.</p>
<heading id="h-0074" level="1">3.5 Fourth Embodiment</heading>
<p id="p-0273" num="0272">The digital content protection system <b>100</b><i>d </i>of the fourth embodiment includes a memory card <b>200</b><i>d</i>, a memory card writer <b>300</b><i>d</i>, and a memory card reader <b>400</b><i>d</i>. The memory card <b>200</b><i>d </i>and the memory card writer <b>300</b><i>d </i>are shown in <figref idref="DRAWINGS">FIG. 17</figref>, while the memory card reader <b>400</b><i>d </i>is not shown in the drawings.</p>
<p id="p-0274" num="0273">The memory card <b>200</b><i>d</i>, the memory card writer <b>300</b><i>d</i>, and the memory card reader <b>400</b><i>d </i>are respectively similar to the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0075" num="0000">3.5.1 Memory Card <b>200</b><i>d </i></p>
<p id="p-0275" num="0274">The memory card <b>200</b><i>d </i>differs from the memory card <b>200</b> in that the memory card <b>200</b><i>d </i>further includes a subgroup key storing unit <b>290</b><i>d </i>and a conversion unit <b>291</b><i>d</i>. Also, the conversion unit <b>230</b> of the memory card <b>200</b><i>d </i>differs from the conversion unit <b>230</b> of the memory card <b>200</b>. Other elements of the memory card <b>200</b><i>d </i>are respectively the same as those of the memory card <b>200</b> and are not described here.</p>
<p id="h-0076" num="0000">(1) Subgroup Key Storing Unit <b>290</b><i>d </i></p>
<p id="p-0276" num="0275">The subgroup key storing unit <b>290</b><i>d </i>prestores a subgroup key Gjk that is a 56-bit bit string.</p>
<p id="p-0277" num="0276">When a digital content service system is run by a plurality of groups, a plurality of subgroup keys whose number is equal to the number of the groups are generated and each of the plurality of subgroup keys is assigned to one of the plurality of groups.</p>
<p id="p-0278" num="0277">The digital content service system is, for instance, a music delivery service that is cooperatively run by A, B, and C companies. In this case, three subgroup keys are generated and are respectively assigned to the companies.</p>
<p id="h-0077" num="0000">(2) Conversion Unit <b>291</b><i>d </i></p>
<p id="p-0279" num="0278">The conversion unit <b>291</b><i>d </i>reads a subgroup key Gjk from the subgroup key storing unit <b>290</b><i>d </i>and reads an inherent key Ki from the media inherent key storing unit <b>220</b>.</p>
<p id="p-0280" num="0279">Also, the conversion unit <b>291</b><i>d </i>generates a transformed key by performing a predetermined calculation on the read subgroup key Gjk and inherent key Ki.</p>
<p id="p-0281" num="0280">Here, the predetermined calculation is, for instance, the exclusive disjunction (exclusive OR) expressed by the formula give below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>(Transformed Key)=(Subgroup Key <i>Gjk</i>)<i>EOR</i>(Inherent Key <i>Ki</i>) where <i>EOR </i>represents an exclusive disjunction.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0282" num="0281">The conversion unit <b>291</b><i>d </i>outputs the transformed key to the conversion unit <b>230</b>.</p>
<p id="h-0078" num="0000">(3) Conversion Unit <b>230</b></p>
<p id="p-0283" num="0282">In the above examples, the conversion unit <b>230</b> reads the inherent key Ki from the media inherent key storing unit <b>220</b> and generates the encrypted inherent key Ji by applying the encryption algorithm E<b>1</b> to the inherent key Ki. Instead of these operations, in this embodiment, the conversion unit <b>230</b> receives the transformed key from the conversion unit <b>291</b><i>d </i>and generates the encrypted inherent key Ji by applying the encryption algorithm E<b>1</b> to the transformed key.</p>
<p id="h-0079" num="0000">3.5.2 Memory Card Writer <b>300</b><i>d </i></p>
<p id="p-0284" num="0283">The memory card writer <b>300</b><i>d </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>d </i>further includes a subgroup key storing unit <b>390</b><i>d </i>and an inversion unit <b>391</b><i>d</i>. Also, the inversion unit <b>321</b> and the media inherent key storing unit <b>323</b> of the memory card writer <b>300</b><i>d </i>differ from those of the memory card writer <b>300</b>. Other elements of the memory card writer <b>300</b><i>d </i>are respectively the same as those of the memory card writer <b>300</b> and are not described here.</p>
<p id="h-0080" num="0000">(1) Subgroup Key Storing Unit <b>390</b><i>d </i></p>
<p id="p-0285" num="0284">The subgroup key storing unit <b>390</b><i>d </i>prestores a subgroup key Gjk that is a 56-bit bit string, like the subgroup key storing unit <b>290</b><i>d. </i></p>
<p id="p-0286" num="0285">The subgroup key Gjk prestored in the subgroup key storing unit <b>390</b><i>d </i>is the same of that prestored in the subgroup key storing unit <b>290</b><i>d </i>and is not described here.</p>
<p id="h-0081" num="0000">(2) Inversion Unit <b>321</b></p>
<p id="p-0287" num="0286">In the above examples, the inversion unit <b>321</b> generates the inherent key K′i by applying the decryption algorithm D<b>1</b> to the encrypted inherent key Ji read from the media inherent key information storing unit <b>320</b>, and outputs the generated inherent key K′i to the media inherent key storing unit <b>323</b>. Instead of these operations, in this embodiment, the inversion unit <b>321</b> generates a transformed key by applying the decryption algorithm D<b>1</b> to the encrypted inherent key Ji read from the media inherent key information storing unit <b>320</b>, and outputs the transformed key to the inversion unit <b>391</b><i>d. </i></p>
<p id="h-0082" num="0000">(3) Inversion Unit <b>391</b><i>d </i></p>
<p id="p-0288" num="0287">The inversion unit <b>391</b><i>d </i>reads a subgroup key Gjk from the subgroup key storing unit <b>390</b><i>d </i>and receives the transformed key from the inversion unit <b>321</b>.</p>
<p id="p-0289" num="0288">The inversion unit <b>391</b><i>d </i>then generates the inherent key K′i by performing an inverse calculation of the predetermined calculation, which is performed by the conversion unit <b>291</b><i>d</i>, on the subgroup key Gjk and the transformed key.</p>
<p id="p-0290" num="0289">The inversion unit <b>391</b><i>d </i>finally outputs the inherent key K′i to the media inherent key storing unit <b>323</b>.</p>
<p id="h-0083" num="0000">(4) Media Inherent Key Storing Unit <b>323</b></p>
<p id="p-0291" num="0290">The media inherent key storing unit <b>323</b> receives the inherent key K′i from the inversion unit <b>391</b><i>d </i>and holds the inherent key K′i.</p>
<p id="h-0084" num="0000">3.5.3 Memory Card Reader <b>400</b><i>d </i></p>
<p id="p-0292" num="0291">The memory card reader <b>400</b><i>d </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>d </i>further includes a subgroup key storing unit <b>490</b><i>d </i>and an inversion unit <b>491</b><i>d</i>. Here, the subgroup key storing unit <b>490</b><i>d </i>and the inversion unit <b>491</b><i>d </i>are respectively the same as the subgroup key storing unit <b>390</b><i>d </i>and the inversion unit <b>391</b><i>d </i>and are not described here. The inversion unit <b>421</b> and the media inherent key storing unit <b>423</b> of the memory card reader <b>400</b><i>d </i>are respectively the same as the inversion unit <b>321</b> and the media inherent key storing unit <b>323</b> of the memory card writer <b>300</b><i>d</i>. Furthermore, other elements of the memory card reader <b>400</b><i>d </i>are respectively the same as those of the memory card reader <b>400</b>.</p>
<p id="h-0085" num="0000">3.5.4 Operation of Digital Content Protection System <b>100</b><i>d </i></p>
<p id="p-0293" num="0292">The following description concerns the operation of the digital content protection system <b>100</b><i>d. </i></p>
<p id="p-0294" num="0293">The operation outlines in the case where the memory card <b>200</b><i>d </i>is placed in the memory card writer <b>300</b><i>d </i>and in the case where the memory card <b>200</b><i>d </i>is placed in the memory card reader <b>400</b><i>d </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here.</p>
<p id="p-0295" num="0294">The authentication operation in the case where the memory card <b>200</b><i>d </i>is placed in the memory card writer <b>300</b><i>d </i>is described in detail below with reference to <figref idref="DRAWINGS">FIG. 18</figref>. Note that the following description centers on the different steps in authentication operation between the present digital content protection system and the digital content protection system <b>100</b>.</p>
<p id="p-0296" num="0295">In step S<b>150</b><i>d</i>, the conversion unit <b>291</b><i>d </i>reads a subgroup key Gjk from the subgroup key storing unit <b>290</b><i>d</i>, reads an inherent key Ki from the media inherent key storing unit <b>220</b>, and generates a transformed key Hjk by performing a predetermined calculation on the subgroup key Gjk and inherent key Ki.</p>
<p id="p-0297" num="0296">In step S<b>130</b>, the conversion unit <b>230</b> generates an encrypted inherent key E<b>1</b> (Mk,Hjk) by applying the encryption algorithm E<b>1</b> to the transformed key Hjk using the master key Mk as the key of the encryption algorithm E<b>1</b>.</p>
<p id="p-0298" num="0297">In step S<b>132</b>, the inversion unit <b>321</b> generates the transformed key D<b>1</b> (Mk,E<b>1</b> (Mk,Hjk)) by applying the decryption algorithm D<b>1</b> to the encrypted inherent key E<b>1</b> (Mk,Hjk) using the master key Mk as the key of the decryption algorithm D<b>1</b>.</p>
<p id="p-0299" num="0298">In step S<b>151</b><i>d</i>, the inversion unit <b>391</b><i>d </i>reads a subgroup key Gjk from the subgroup key storing unit <b>390</b><i>d</i>, receives the transformed key D<b>1</b> (Mk,E<b>1</b> (Mk,Hjk)) from the inversion unit <b>321</b>, and generates the inherent key K′i by performing an inverse calculation of the predetermined calculation, which is performed by the conversion unit <b>291</b><i>d</i>, on the subgroup key Gjk and the transformed key D<b>1</b> (Mk,E<b>1</b> (Mk,Hjk)).</p>
<p id="p-0300" num="0299">In the case where the memory card <b>200</b><i>d </i>is placed in the memory card reader <b>400</b><i>d</i>, the same authentication operation is performed. Therefore, the authentication operation in the case where the memory card <b>200</b><i>d </i>is placed in the memory card reader <b>400</b><i>d </i>is not described here.</p>
<p id="h-0086" num="0000">3.5.5 Conclusion</p>
<p id="p-0301" num="0300">When a digital content service system is run by a plurality of groups, a plurality of subgroup keys whose number is equal to the number of the plurality of groups are generated and each of the plurality of subgroup keys is assigned to one of the plurality of groups. This allows each group to provide its own service.</p>
<p id="p-0302" num="0301">The digital content service system is, for instance, a music delivery system for delivering music that is cooperatively run by A, B, and C companies. In this case, three subgroup keys are generated and are respectively assigned to these companies. Therefore, A, B, and C companies can provide their own music delivery services.</p>
<p id="p-0303" num="0302">In many cases, the number of master keys that can be prestored in a memory card is restricted due to the limited storage capacity of the memory card. However, the present digital content protection system can increase the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0304" num="0303">It should be noted here that services that are common to a plurality of groups can be provided in the present digital content protection system. To do so, two other control units are added to the digital content protection system, the same subgroup key is assigned to each group, and the master key is assigned to the digital content service system. One of the added control units prohibits the conversion unit <b>291</b><i>d </i>from performing its conversion processing and has the conversion unit <b>230</b> convert the inherent key prestored in the media inherent key storing unit <b>220</b>. The other of the added control units prohibits the inversion unit <b>391</b><i>d </i>from performing its inversion processing and has the inversion unit <b>321</b> invert the encrypted inherent key held in the media inherent key information storing unit <b>320</b>.</p>
<heading id="h-0087" level="1">3.6 Fifth Embodiment</heading>
<p id="p-0305" num="0304">The digital content protection system <b>100</b><i>e </i>of the fifth embodiment includes a memory card <b>200</b><i>e</i>, a memory card writer <b>300</b><i>e</i>, and a memory card reader <b>400</b><i>e</i>. The memory card <b>200</b><i>e </i>and the memory card writer <b>300</b><i>e </i>are shown in <figref idref="DRAWINGS">FIG. 19</figref>, while the memory card reader <b>400</b><i>e </i>is not shown in the drawings.</p>
<p id="p-0306" num="0305">The memory card <b>200</b><i>e</i>, the memory card writer <b>300</b><i>e</i>, and the memory card reader <b>400</b><i>e </i>are respectively similar to the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b>. Therefor, the following description centers on the different aspects of these elements.</p>
<p id="h-0088" num="0000">3.6.1 Memory Card <b>200</b><i>e </i></p>
<p id="p-0307" num="0306">The memory card <b>200</b><i>e </i>differs from the memory card <b>200</b> in that the memory card <b>200</b><i>e </i>further includes a subgroup key storing unit <b>290</b><i>e </i>and a conversion unit <b>291</b><i>e</i>. Also, the communication unit <b>270</b> of the memory card <b>200</b><i>e </i>differs from that of the memory card <b>200</b>. Other elements of the memory card <b>200</b><i>e </i>are respectively the same as those of the memory card <b>200</b> and are not described.</p>
<p id="h-0089" num="0000">(1) Subgroup Key Storing Unit <b>290</b><i>e </i></p>
<p id="p-0308" num="0307">The subgroup key storing unit <b>290</b><i>e </i>prestores a subgroup Gjk that is a 56-bit string.</p>
<p id="p-0309" num="0308">The subgroup key is the same as that prestored in the subgroup key storing unit <b>290</b><i>d </i>and is not described here.</p>
<p id="h-0090" num="0000">(2) Conversion Unit <b>291</b><i>e </i></p>
<p id="p-0310" num="0309">The conversion unit <b>291</b><i>e </i>first reads the subgroup key Gjk from the subgroup key storing unit <b>290</b><i>e </i>and reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b>.</p>
<p id="p-0311" num="0310">The conversion unit <b>291</b><i>e </i>then generates a transformed key by performing a predetermined calculation on the subgroup key Gjk and encrypted inherent key Ji.</p>
<p id="p-0312" num="0311">Here, the predetermined calculation is the same as that performed by the conversion unit <b>291</b><i>d. </i></p>
<p id="p-0313" num="0312">The conversion unit <b>291</b><i>e </i>finally outputs the transformed key to the communication unit <b>270</b>.</p>
<p id="h-0091" num="0000">(3) Communication Unit <b>270</b></p>
<p id="p-0314" num="0313">In the above examples, the communication unit <b>270</b> reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b> and outputs the encrypted inherent key Ji to the communication unit <b>340</b> of the memory card writer <b>300</b> or the communication unit <b>440</b> of the memory card reader <b>400</b>. Instead of these operations, in this embodiment, the communication unit <b>270</b> receives the transformed key from the conversion unit <b>291</b><i>e </i>and outputs the transformed key to the communication unit <b>340</b> of the memory card writer <b>300</b><i>e </i>or the communication unit <b>440</b> of the memory card reader <b>400</b><i>e. </i></p>
<p id="h-0092" num="0000">3.6.2 Memory Card Writer <b>300</b><i>e </i></p>
<p id="p-0315" num="0314">The memory card writer <b>300</b><i>e </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>e </i>further includes a subgroup key storing unit <b>390</b><i>e </i>and an inversion unit <b>391</b><i>e</i>. Also, the communication unit <b>340</b> of the memory card writer <b>300</b><i>e </i>differs from the communication unit <b>340</b> of the memory card writer <b>300</b>. Other elements of the memory card writer <b>300</b><i>e </i>are respectively the same as those of the memory card writer <b>300</b> and are not described here.</p>
<p id="h-0093" num="0000">(1) Subgroup Key Storing Unit <b>390</b><i>e </i></p>
<p id="p-0316" num="0315">The subgroup key storing unit <b>390</b><i>e </i>prestores a subgroup key Gjk that is a 56-bit bit string, like the subgroup key storing unit <b>290</b><i>e. </i></p>
<p id="p-0317" num="0316">The subgroup key Gjk prestored in the subgroup key storing unit <b>390</b><i>e </i>is the same as that prestored in the subgroup key storing unit <b>290</b><i>e </i>and is not described here.</p>
<p id="h-0094" num="0000">(2) Communication Unit <b>340</b></p>
<p id="p-0318" num="0317">In the above examples, the communication unit <b>340</b> receives the encrypted inherent key Ji from the communication unit <b>270</b> of the memory card <b>200</b> and outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>320</b>. Instead of these operations, in this embodiment, the communication unit <b>340</b> receives the transformed key from the communication unit <b>270</b> of the memory card <b>200</b><i>e </i>and outputs the transformed key to the inversion unit <b>391</b><i>e. </i></p>
<p id="h-0095" num="0000">(3) Inversion Unit <b>391</b><i>e </i></p>
<p id="p-0319" num="0318">The inversion unit <b>391</b><i>e </i>first reads the subgroup key Gjk from the subgroup key storing unit <b>390</b><i>e </i>and receives the transformed key from the communication unit <b>340</b>.</p>
<p id="p-0320" num="0319">The inversion unit <b>391</b><i>e </i>then generates the encrypted inherent key Ji by performing an inverse calculation of the predetermined calculation, which is performed by the conversion unit <b>291</b><i>e</i>, on the subgroup key Gjk and the transformed key.</p>
<p id="p-0321" num="0320">The inversion unit <b>391</b> finally outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>320</b>.</p>
<p id="h-0096" num="0000">3.6.3 Memory Card Reader <b>400</b><i>e </i></p>
<p id="p-0322" num="0321">The memory card reader <b>400</b><i>e </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>e </i>further includes a subgroup key storing unit <b>490</b><i>e </i>and an inversion unit <b>491</b><i>e</i>. The subgroup key storing unit <b>490</b><i>e </i>and the inversion unit <b>491</b><i>e </i>are respectively the same as the subgroup key storing unit <b>390</b><i>e </i>and the inversion unit <b>391</b><i>e </i>and are not described here. The communication unit <b>440</b> of the memory card reader <b>400</b><i>e </i>is the same as the communication unit <b>340</b> of the memory card writer <b>300</b><i>e</i>. Other elements of the memory card reader <b>400</b><i>e </i>are respectively the same as those of the memory card reader <b>400</b>.</p>
<p id="h-0097" num="0000">3.6.4 Operation of Digital Content Protection System <b>100</b><i>e </i></p>
<p id="p-0323" num="0322">The following is a description of the operation of the digital content protection system <b>100</b><i>e. </i></p>
<p id="p-0324" num="0323">The operation outlines in the case where the memory card <b>200</b><i>e </i>is placed in the memory card writer <b>300</b><i>e </i>and in the case where the memory card <b>200</b><i>e </i>is placed in the memory card reader <b>400</b><i>e </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here.</p>
<p id="p-0325" num="0324">The authentication operation in the case where the memory card <b>200</b><i>e </i>is placed in the memory card writer <b>300</b><i>e </i>is described in detail below with reference to <figref idref="DRAWINGS">FIG. 20</figref>. The following description centers on the different steps in authentication operation between the present digital content protection system and the digital content protection system <b>100</b>.</p>
<p id="p-0326" num="0325">In step S<b>150</b><i>e</i>, the conversion unit <b>291</b><i>e </i>reads the subgroup key Gjk from the subgroup key storing unit <b>290</b><i>e</i>, reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b>, generates the transformed key by performing the predetermined calculation on the subgroup key Gjk and encrypted inherent key Ji, and outputs the transformed key to the communication unit <b>270</b>.</p>
<p id="p-0327" num="0326">In step S<b>131</b>, the communication unit <b>270</b> receives the transformed key from the conversion unit <b>291</b><i>e</i>, outputs the transformed key to the communication unit <b>340</b> of the memory card writer <b>300</b><i>e</i>. After receiving the transformed key from the communication unit <b>270</b> of the memory card <b>200</b><i>e</i>, the communication unit <b>340</b> outputs the transformed key to the inversion unit <b>391</b><i>e. </i></p>
<p id="p-0328" num="0327">In step S<b>151</b><i>e</i>, the inversion unit <b>391</b><i>e </i>reads the subgroup key Gjk from the subgroup key storing unit <b>390</b><i>e</i>, receives the transformed key from the communication unit <b>340</b>, and generates the encrypted inherent key Ji by performing an inverse calculation of the predetermined calculation on the subgroup key Gjk and transformed key.</p>
<p id="p-0329" num="0328">In the case where the memory card <b>200</b><i>e </i>is placed in the memory card reader <b>400</b><i>e</i>, the same authentication operation is performed. Therefore, the authentication operation in the case where the memory card <b>200</b><i>e </i>is placed in the memory card reader <b>400</b><i>e </i>is not described here.</p>
<p id="h-0098" num="0000">3.6.5 Conclusion</p>
<p id="p-0330" num="0329">Like the digital content protection system <b>100</b><i>d</i>, when a digital content service system is run by a plurality of groups, a plurality of subgroup keys whose number is equal to the number of the plurality of groups are generated and each of the plurality of subgroup keys is assigned to one of the plurality of groups. This allows each group to provide its own service.</p>
<p id="p-0331" num="0330">In many cases, the number of master keys that can be prestored in a memory card is restricted due to the limited storage capacity of the memory card. However, the present digital content protection system can increase the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0332" num="0331">It should be noted here that services that are common to a plurality of groups can be provided in the present digital content protection system. To do so, two other control units are added to the digital content protection system, the same subgroup key is assigned to each group, and the master key is assigned to the digital content service system. One of the added control units prohibits the conversion unit <b>291</b><i>e </i>from performing its conversion processing and has the conversion unit <b>230</b> convert the inherent key prestored in the media inherent key storing unit <b>220</b>. The other of the added control units prohibits the inversion unit <b>391</b><i>e </i>from performing its inversion processing and has the inversion unit <b>321</b> invert the encrypted inherent key held in the media inherent key information storing unit <b>320</b>.</p>
<heading id="h-0099" level="1">3.7 Sixth Embodiment</heading>
<p id="p-0333" num="0332">The digital content protection system <b>100</b><i>f </i>of the sixth embodiment includes a memory card <b>200</b><i>f</i>, a memory card writer <b>300</b><i>f</i>, and a memory card reader <b>400</b><i>f</i>. The memory card <b>200</b><i>f </i>and the memory card writer <b>300</b><i>f </i>are shown in <figref idref="DRAWINGS">FIG. 21</figref>, while the memory card reader <b>400</b><i>f </i>is not shown in the drawings.</p>
<p id="p-0334" num="0333">The memory card <b>200</b><i>f</i>, the memory card writer <b>300</b><i>f</i>, and the memory card reader <b>400</b><i>f </i>are respectively similar to the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0100" num="0000">3.7.1 Memory Card <b>200</b><i>f </i></p>
<p id="p-0335" num="0334">The memory card <b>200</b><i>f </i>differs from the memory card <b>200</b> in that the memory card <b>200</b><i>f </i>further includes a subgroup key storing unit <b>290</b><i>f </i>and a conversion unit <b>291</b><i>f</i>. Also, the conversion unit <b>230</b> of the memory card <b>200</b><i>f </i>differs from the conversion unit <b>230</b> of the memory card <b>200</b>. Other elements of the memory card <b>200</b><i>f </i>are respectively the same as those of the memory card <b>200</b> and are not described here.</p>
<p id="h-0101" num="0000">(1) Subgroup Key Storing Unit <b>290</b><i>f </i></p>
<p id="p-0336" num="0335">The subgroup key storing unit <b>290</b><i>f </i>prestores a subgroup key Gjk that is a 56-bit bit string.</p>
<p id="p-0337" num="0336">The subgroup key prestored in the subgroup key storing unit <b>290</b><i>f </i>is the same as that prestored in the subgroup key storing unit <b>290</b><i>d </i>and is not described here.</p>
<p id="h-0102" num="0000">(2) Conversion Unit <b>291</b><i>f </i></p>
<p id="p-0338" num="0337">The conversion unit <b>291</b><i>f </i>first reads the subgroup key Gjk from the subgroup key storing unit <b>290</b><i>f </i>and reads the master key Mk from the master key storing unit <b>210</b>.</p>
<p id="p-0339" num="0338">The conversion unit <b>291</b><i>f </i>then generates a transformed key by performing a predetermined calculation on the subgroup key Gjk and master key Mk.</p>
<p id="p-0340" num="0339">Here, the predetermined calculation is the same as that performed by the conversion unit <b>291</b><i>d. </i></p>
<p id="p-0341" num="0340">The conversion unit <b>291</b><i>f </i>finally outputs the transformed key to the conversion unit <b>230</b>.</p>
<p id="h-0103" num="0000">(3) Conversion Unit <b>230</b></p>
<p id="p-0342" num="0341">In the above examples, the conversion unit <b>230</b> reads the master key Mk from the master key storing unit <b>210</b> and generates the encrypted inherent key Ji by applying the encryption algorithm E<b>1</b> to the inherent key Ki using the master key Mk as the key of the encryption algorithm E<b>1</b>. Instead of these operations, in this embodiment, the conversion unit <b>230</b> receives the transformed key from the conversion unit <b>291</b><i>f </i>and generates the encrypted inherent key Ji by applying the encryption algorithm E<b>1</b> to the inherent key Ki using the transformed key as the key of the encryption algorithm E<b>1</b>.</p>
<p id="h-0104" num="0000">3.7.2 Memory Card Writer <b>300</b><i>f </i></p>
<p id="p-0343" num="0342">The memory card writer <b>300</b><i>f </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>f </i>further includes a subgroup key storing unit <b>390</b><i>f </i>and an inversion unit <b>391</b><i>f</i>. Also, the inversion unit <b>321</b> of the memory card writer <b>300</b><i>f </i>differs from the inversion unit <b>321</b> of the memory card writer <b>300</b>. Other elements of the memory card writer <b>300</b><i>f </i>are respectively the same as those of the memory card writer <b>300</b> and are not described here.</p>
<p id="h-0105" num="0000">(1) Subgroup Key Storing Unit <b>390</b><i>f </i></p>
<p id="p-0344" num="0343">The subgroup key storing unit <b>390</b><i>f </i>prestores a subgroup key Gjk that is a 56-bit bit string, like the subgroup key storing unit <b>290</b><i>f. </i></p>
<p id="p-0345" num="0344">The subgroup key prestored in the subgroup key storing unit <b>390</b><i>f </i>is the same as that prestored in the subgroup key storing unit <b>290</b><i>f </i>and is not described here.</p>
<p id="h-0106" num="0000">(2) Inversion Unit <b>391</b><i>f </i></p>
<p id="p-0346" num="0345">The inversion unit <b>391</b><i>f </i>first reads the subgroup key Gjk from the subgroup key storing unit <b>390</b><i>f </i>and reads the master key Mk from the master key storing unit <b>313</b>.</p>
<p id="p-0347" num="0346">The inversion unit <b>391</b><i>f </i>then generates a transformed key by performing a predetermined calculation on the subgroup key Gjk and the master key Mk.</p>
<p id="p-0348" num="0347">Here, the predetermined calculation is the same as that performed by the conversion unit <b>291</b><i>d. </i></p>
<p id="p-0349" num="0348">The inversion unit <b>391</b><i>f </i>finally outputs the transformed key to the inversion unit <b>321</b>.</p>
<p id="h-0107" num="0000">(3) Inversion Unit <b>321</b></p>
<p id="p-0350" num="0349">In the above embodiments, the inversion unit <b>321</b> read the master key Mk from the master key storing unit <b>313</b> and generates the inherent key K′i by applying the decryption algorithm D<b>1</b> to the encrypted inherent key Ji using the master key Mk as the key of the decryption algorithm D<b>1</b>. Instead of these operations, in this embodiment, the inversion unit <b>321</b> receives the transformed key from the inversion unit <b>391</b><i>f </i>and generates the inherent key K′i by applying the decryption algorithm D<b>1</b> to the encrypted inherent key Ji using the transformed key as the key of the decryption algorithm D<b>1</b>.</p>
<p id="h-0108" num="0000">3.7.3 Memory Card Reader <b>400</b><i>f </i></p>
<p id="p-0351" num="0350">The memory card reader <b>400</b><i>f </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>f </i>further includes a subgroup key storing unit <b>490</b><i>f </i>and an inversion unit <b>491</b><i>f</i>. The subgroup key storing unit <b>490</b><i>f </i>and the inversion unit <b>491</b><i>f </i>are respectively the same as the subgroup key storing unit <b>390</b><i>f </i>and the inversion unit <b>391</b><i>f </i>and are not described here. The inversion unit <b>421</b> of the memory card reader <b>400</b><i>f </i>is the same as the inversion unit <b>321</b> of the memory card writer <b>300</b><i>f</i>. Other elements of the memory card reader <b>400</b><i>f </i>are respectively the same as those of the memory card reader <b>400</b>.</p>
<p id="h-0109" num="0000">3.7.4 Operation of Digital Content Protection System <b>100</b><i>f </i></p>
<p id="p-0352" num="0351">The following is a description of the operation of the digital content protection system <b>100</b><i>f. </i></p>
<p id="p-0353" num="0352">The operation outlines in the case where the memory card <b>200</b><i>f </i>is placed in the memory card writer <b>300</b><i>f </i>and in the case where the memory card <b>200</b><i>f </i>is placed in the memory card reader <b>400</b><i>f </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here.</p>
<p id="p-0354" num="0353">The authentication operation in the case where the memory card <b>200</b><i>f </i>is placed in the memory card writer <b>300</b><i>f </i>is described in detail below with reference to <figref idref="DRAWINGS">FIG. 22</figref>. The following description centers on the different steps in authentication operation between the present digital content protection system and the digital content protection system <b>100</b>.</p>
<p id="p-0355" num="0354">In step S<b>150</b><i>f</i>, the conversion unit <b>291</b><i>f </i>reads the subgroup key Gjk from the subgroup key storing unit <b>290</b><i>f</i>, reads the master key Mk from the master key storing unit <b>210</b>, generates the transformed key Mk′ by performing the predetermined calculation on the subgroup key Gjk and master key Mk, and outputs the transformed key Mk′ to the conversion unit <b>230</b>.</p>
<p id="p-0356" num="0355">In step S<b>130</b>, the conversion unit <b>230</b> generates the encrypted inherent key E<b>1</b> (Mk′,Ki) by applying the encryption algorithm E<b>1</b> to the inherent key Ki using the transformed key Mk′ as the key of the encryption algorithm E<b>1</b>.</p>
<p id="p-0357" num="0356">In step S<b>151</b><i>f</i>, the inversion unit <b>391</b><i>f </i>reads the subgroup key Gjk from the subgroup key storing unit <b>390</b><i>f</i>, reads the master key Mk from the master key storing unit <b>313</b>, generates the transformed key Mk′ by performing the predetermined calculation on the subgroup key Gjk and master key Mk, and outputs the transformed key Mk′ to the inversion unit <b>321</b>.</p>
<p id="p-0358" num="0357">In step <b>132</b>, the inversion unit <b>321</b> generates the inherent key K′i=D<b>1</b> (Mk′, E<b>1</b> (Mk′,Ki)) by applying the decryption algorithm D<b>1</b> to the encrypted inherent key E<b>1</b> (Mk′,Ki) using the transformed key as the key of the decryption algorithm D<b>1</b>.</p>
<p id="p-0359" num="0358">In the case where the memory card <b>200</b><i>f </i>is placed in the memory card reader <b>400</b><i>f</i>, the same authentication operation is performed. Therefore, the authentication operation in the case where the memory card <b>200</b><i>f </i>is placed in the memory card reader <b>400</b><i>f </i>is not described here.</p>
<p id="h-0110" num="0000">3.7.5 Conclusion</p>
<p id="p-0360" num="0359">Like the digital content protection system <b>100</b><i>d</i>, when a digital content service system is run by a plurality of groups, a plurality of subgroup keys whose number is equal to the number of the plurality of groups are generated and each of the plurality of subgroup keys is assigned to one of the plurality of groups. This allows each group to provide its own service.</p>
<p id="p-0361" num="0360">In many cases, the number of master keys that can be prestored in a memory card is restricted due to the limited storage capacity of the memory card. However, the present digital content protection system can increase the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0362" num="0361">It should be noted here that services that are common to a plurality of groups can be provided in the present digital content protection system. To do so, two other control units are added to the digital content protection system, the same subgroup key is assigned to each group, and the master key is assigned to the digital content service system. One of the added control units prohibits the conversion unit <b>291</b><i>f </i>from performing its conversion processing and has the conversion unit <b>230</b> convert the inherent key prestored in the media inherent key storing unit <b>220</b>. The other of the added control units prohibits the inversion unit <b>391</b><i>f </i>from performing its inversion processing and has the inversion unit <b>321</b> invert the encrypted inherent key held in the media inherent key information storing unit <b>320</b>.</p>
<p id="p-0363" num="0362">Also, in the digital content protection system <b>100</b><i>f</i>, the same master key is prestored in the master key storing units <b>210</b> and <b>313</b>. However, a public key method may be used in the manner described below.</p>
<p id="p-0364" num="0363">In the digital content protection system <b>100</b><i>f </i>using the public key method, the master key storing unit <b>210</b> of the memory card <b>200</b><i>f </i>prestores a secret key that is the master key. The memory card <b>200</b><i>f </i>further includes a public key generating unit that generates a public key from the transformed key generated by the conversion unit <b>291</b><i>f </i>and the public key is sent to the memory card writer <b>300</b><i>f </i>in advance. In the memory card writer <b>300</b><i>f</i>, the encryption unit <b>360</b> encrypts contents using the public key.</p>
<heading id="h-0111" level="1">3.8 Seventh Embodiment</heading>
<p id="p-0365" num="0364">The digital content protection system <b>100</b><i>g </i>of this embodiment includes a memory card <b>200</b><i>g</i>, a memory card writer <b>300</b><i>g</i>, and a memory card reader <b>400</b><i>g</i>. The memory card <b>200</b><i>g </i>and the memory card writer <b>300</b><i>g </i>are shown in <figref idref="DRAWINGS">FIG. 23</figref>, while the memory card reader <b>400</b><i>g </i>is not shown in the drawings.</p>
<p id="p-0366" num="0365">The memory card <b>200</b><i>g</i>, the memory card writer <b>300</b><i>g</i>, and the memory card reader <b>400</b><i>g </i>are respectively similar to the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0112" num="0000">3.8.1 Memory Card <b>200</b><i>g </i></p>
<p id="p-0367" num="0366">The memory card <b>200</b><i>g </i>differs from the memory card <b>200</b> in that the memory card <b>200</b><i>g </i>further includes a subgroup key storing unit <b>290</b><i>g </i>and a conversion unit <b>291</b><i>g</i>. Also, the encryption unit <b>252</b> of the memory card <b>200</b><i>g </i>differs from that of the memory card <b>200</b>. Other elements of the memory card <b>200</b><i>g </i>are respectively the same as those of the memory card <b>200</b>.</p>
<p id="h-0113" num="0000">(1) Subgroup Key Storing Unit <b>290</b><i>g </i></p>
<p id="p-0368" num="0367">The subgroup key storing unit <b>290</b><i>g </i>prestores a subgroup key Gjk that is a 56-bit bit string.</p>
<p id="p-0369" num="0368">The subgroup key prestored in the subgroup key storing unit <b>290</b><i>g </i>is the same as that prestored in the subgroup key storing unit <b>290</b><i>d </i>and is not described here.</p>
<p id="h-0114" num="0000">(2) Conversion Unit <b>291</b><i>g </i></p>
<p id="p-0370" num="0369">The conversion unit <b>291</b><i>g </i>first reads the subgroup key Gjk from the subgroup key storing unit <b>290</b><i>g </i>and reads the inherent key Ki from the media inherent key storing unit <b>220</b>.</p>
<p id="p-0371" num="0370">The conversion unit <b>291</b><i>g </i>then generates a transformed key by performing a predetermined calculation on the subgroup key Gjk and the inherent key Ki.</p>
<p id="p-0372" num="0371">Here, the predetermined calculation is the same as that performed by the conversion unit <b>291</b><i>d. </i></p>
<p id="p-0373" num="0372">The conversion unit <b>291</b><i>g </i>finally outputs the transformed key to the encryption unit <b>252</b> of the mutual authentication unit <b>250</b>.</p>
<p id="h-0115" num="0000">(3) Encryption Unit <b>252</b></p>
<p id="p-0374" num="0373">In the above examples, the encryption unit <b>252</b> reads the inherent key Ki from the media inherent key storing unit <b>220</b> and generates the encrypted random number S<b>1</b> by applying the encryption algorithm E<b>2</b> to the random number R<b>1</b> using the inherent key Ki as the key of the encryption algorithm E<b>2</b>. Instead of these operations, in this embodiment, the encryption unit <b>252</b> receives the transformed key from the conversion unit <b>291</b><i>g </i>and generates the encrypted random number S<b>1</b> by applying the encryption algorithm E<b>2</b> to the random number R<b>1</b> using the transformed key as the key of the encryption algorithm E<b>2</b>.</p>
<p id="h-0116" num="0000">3.8.2 Memory Card Writer <b>300</b><i>g </i></p>
<p id="p-0375" num="0374">The memory card writer <b>300</b><i>g </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>g </i>further includes a subgroup key storing unit <b>390</b><i>g </i>and an inversion unit <b>391</b><i>g</i>. Also, the decryption unit <b>333</b> of the memory card writer <b>300</b><i>g </i>differs from that of the memory card writer <b>300</b>. Other elements of the memory card writer <b>300</b><i>g </i>are respectively the same as those of the memory card writer <b>300</b>.</p>
<p id="h-0117" num="0000">(1) Subgroup Key Storing Unit <b>390</b><i>g </i></p>
<p id="p-0376" num="0375">The subgroup key storing unit <b>390</b><i>g </i>prestores a subgroup key Gjk that is a 56-bit bit string, like the subgroup key storing unit <b>290</b><i>g. </i></p>
<p id="p-0377" num="0376">The subgroup key prestored in the subgroup key storing unit <b>390</b><i>g </i>is the same as that prestored in the subgroup key storing unit <b>290</b><i>g </i>and is not described here.</p>
<p id="h-0118" num="0000">(2) Inversion Unit <b>391</b><i>g </i></p>
<p id="p-0378" num="0377">The inversion unit <b>391</b><i>g </i>first reads the subgroup key Gjk from the subgroup key storing unit <b>390</b><i>g </i>and reads the inherent key K′i from the media inherent key storing unit <b>323</b>.</p>
<p id="p-0379" num="0378">The inversion unit <b>391</b><i>g </i>then generates a transformed key by performing a predetermined calculation on the subgroup key Gjk and the inherent key K′i.</p>
<p id="p-0380" num="0379">Here, the predetermined calculation is the same as that performed by the conversion unit <b>291</b><i>d. </i></p>
<p id="p-0381" num="0380">The inversion unit <b>391</b><i>g </i>finally outputs the transformed key to the decryption unit <b>333</b>.</p>
<p id="h-0119" num="0000">(3) Decryption Unit <b>333</b></p>
<p id="p-0382" num="0381">In the above examples, the decryption unit <b>333</b> reads the inherent key K′i from the media inherent key storing unit <b>323</b> and generates the random number R′<b>1</b> by applying the decryption algorithm D<b>2</b> to the encrypted random number S<b>1</b> using the inherent key K′i as the key of the decryption algorithm D<b>2</b>. Instead of these operations, in this embodiment, the decryption unit <b>333</b> receives the transformed key from the inversion unit <b>391</b><i>g </i>and generates the random number R′<b>1</b> by applying the decryption algorithm D<b>2</b> to the encrypted random number S<b>1</b> using the transformed key as the key of the decryption algorithm D<b>2</b>.</p>
<p id="h-0120" num="0000">3.8.3 Memory Card Reader <b>400</b><i>g </i></p>
<p id="p-0383" num="0382">The memory card reader <b>400</b><i>g </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>g </i>further includes a subgroup key storing unit <b>490</b><i>g </i>and an inversion unit <b>491</b><i>g</i>. The subgroup key storing unit <b>490</b><i>g </i>and the inversion unit <b>491</b><i>g </i>are respectively the same as the subgroup key storing unit <b>390</b><i>g </i>and the inversion unit <b>391</b><i>g </i>and are not described here. The decryption unit <b>433</b> of the memory card reader <b>400</b><i>g </i>is the same as the decryption unit <b>333</b> of the memory card writer <b>300</b><i>g</i>. Other elements of the memory card reader <b>400</b><i>g </i>are respectively the same as those of the memory card reader <b>400</b>.</p>
<p id="h-0121" num="0000">3.8.4 Operation of Digital Content Protection System <b>100</b><i>g </i></p>
<p id="p-0384" num="0383">The following is a description of the operation of the digital content protection system <b>100</b><i>g. </i></p>
<p id="p-0385" num="0384">The operation outlines in the case where the memory card <b>200</b><i>g </i>is placed in the memory card writer <b>300</b><i>g </i>and in the case where the memory card <b>200</b><i>g </i>is placed in the memory card reader <b>400</b><i>g </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here.</p>
<p id="p-0386" num="0385">The authentication operation in the case where the memory card <b>200</b><i>g </i>is placed in the memory card writer <b>300</b><i>g </i>is described in detail below with reference to <figref idref="DRAWINGS">FIG. 24</figref>. The following description centers on the different steps in authentication operation between the present digital content protection system and the digital content protection system <b>100</b>.</p>
<p id="p-0387" num="0386">In step S<b>150</b><i>g</i>, the conversion unit <b>291</b><i>g </i>reads the subgroup key Gjk from the subgroup key storing unit <b>290</b><i>g</i>, reads the inherent key Ki from the media inherent key storing unit <b>220</b>, generates the transformed key by performing the predetermined calculation on the subgroup key Gjk and inherent key Ki, and outputs the transformed key to the encryption unit <b>252</b> of the mutual authentication unit <b>250</b>.</p>
<p id="p-0388" num="0387">In step S<b>135</b>, the encryption unit <b>252</b> receives the transformed key from the conversion unit <b>291</b><i>g </i>and generates the encrypted random number S<b>1</b> by applying the encryption algorithm E<b>2</b> to the random number R<b>1</b> using the transformed key as the key of the encryption algorithm E<b>2</b>.</p>
<p id="p-0389" num="0388">In step S<b>151</b><i>g</i>, the inversion unit <b>391</b><i>g </i>reads the subgroup key Gjk from the subgroup key storing unit <b>390</b><i>g</i>, reads the inherent key K′i from the media inherent key storing unit <b>323</b>, generates the transformed key by performing the predetermined calculation on the subgroup key Gjk and inherent key K′i, and outputs the transformed key to the decryption unit <b>333</b>.</p>
<p id="p-0390" num="0389">In step <b>137</b>, the decryption unit <b>333</b> receives the transformed key from the inversion unit <b>391</b><i>g </i>and generates the random number R′i by applying the decryption algorithm D<b>2</b> to the encrypted random number S<b>1</b> using the transformed key as the key of the decryption algorithm D<b>2</b>.</p>
<p id="p-0391" num="0390">In the case where the memory card <b>200</b><i>g </i>is placed in the memory card reader <b>400</b><i>g</i>, the same authentication operation is performed. Therefore, the authentication operation in the case where the memory card <b>200</b><i>g </i>is placed in the memory card reader <b>400</b><i>g </i>is not described here.</p>
<p id="h-0122" num="0000">3.8.5 Conclusion</p>
<p id="p-0392" num="0391">Like the digital content protection system <b>100</b><i>d</i>, when a digital content service system is run by a plurality of groups, a plurality of subgroup keys whose number is equal to the number of the plurality of groups are generated and each of the plurality of subgroup keys is assigned to one of the plurality of groups. This allows each group to provide its own service.</p>
<p id="p-0393" num="0392">In many cases, the number of master keys that can be prestored in a memory card is restricted due to the limited storage capacity of the memory card. However, the present digital content protection system can increase the number of available keys by combining a master key and subgroup keys.</p>
<p id="p-0394" num="0393">It should be noted here that services that are common to a plurality of groups can be provided in the present digital content protection system. To do so, two other control units are added to the digital content protection system, the same subgroup key is assigned to each group, and the master key is assigned to the digital content service system. One of the added control units prohibits the conversion unit <b>291</b><i>g </i>from performing its conversion processing and has the conversion unit <b>230</b> convert the inherent key prestored in the media inherent key storing unit <b>220</b>. The other of the added control units prohibits the inversion unit <b>391</b><i>g </i>from performing its inversion processing and has the inversion unit <b>321</b> invert the encrypted inherent key held in the media inherent key information storing unit <b>320</b>.</p>
<heading id="h-0123" level="1">3.9 Eighth Embodiment</heading>
<p id="p-0395" num="0394">The digital content protection system <b>100</b><i>h </i>of this embodiment includes the memory card <b>200</b>, a memory card writer <b>300</b><i>h</i>, and a memory card reader <b>400</b><i>h</i>. These elements are shown in <figref idref="DRAWINGS">FIGS. 25 and 26</figref>.</p>
<p id="p-0396" num="0395">The memory card <b>200</b> of this system is the same as that of the digital content protection system <b>100</b> and is not described here. The memory card writer <b>300</b><i>h </i>and the memory card reader <b>400</b><i>h </i>are respectively similar to the memory card writer <b>300</b> and the memory card reader <b>400</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0124" num="0000">3.9.1 Memory Card Writer <b>300</b><i>h </i></p>
<p id="p-0397" num="0396">The memory card writer <b>300</b><i>h </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>h </i>further includes a conversion unit <b>392</b> and a user key input unit <b>393</b>. Also, the encryption unit <b>360</b> of the memory card writer <b>300</b><i>h </i>differs from the encryption unit <b>360</b> of the memory card writer <b>300</b>. Other elements of the memory card writer <b>300</b><i>h </i>are respectively the same as those of the memory card writer <b>300</b>.</p>
<p id="h-0125" num="0000">(1) User Key Input Unit <b>393</b></p>
<p id="p-0398" num="0397">The user key input unit <b>393</b> includes an input device such as a keyboard and receives a user key from a user. The user key means a password that is determined by each user, is known only by the user, and is inherent in the user. Also, the user key is a combination of alphabets, numbers, and symbols.</p>
<p id="p-0399" num="0398">After receiving the user key, the user key input unit <b>393</b> outputs the user key to the conversion unit <b>392</b>.</p>
<p id="h-0126" num="0000">(2) Conversion Unit <b>392</b></p>
<p id="p-0400" num="0399">The conversion unit <b>392</b> first reads the inherent key K′i from the media inherent key storing unit <b>323</b> and receives the user key from the user key input unit <b>393</b>.</p>
<p id="p-0401" num="0400">The conversion unit <b>392</b> then generates a transformed key by performing a predetermined calculation on the inherent key K′i and the user key. Here, the predetermined calculation is an exclusive disjunction (exclusive OR).</p>
<p id="p-0402" num="0401">The conversion unit <b>392</b> finally outputs the transformed key to the encryption unit <b>360</b>.</p>
<p id="h-0127" num="0000">(3) Encryption Unit <b>360</b></p>
<p id="p-0403" num="0402">In the above examples, the encryption unit <b>360</b> reads the inherent key K′i from the media inherent key storing unit <b>323</b>, divides the content read from the content storing unit <b>370</b> into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the inherent key K′i as the key of the encryption algorithm E<b>2</b>. Instead of these operations, in this embodiment, the encryption unit <b>360</b> receives the transformed key from the conversion unit <b>392</b>, divides the content read from the content storing unit <b>370</b> into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the transformed key as the key of the encryption algorithm E<b>2</b>.</p>
<p id="h-0128" num="0000">3.9.2 Memory Card Reader <b>400</b><i>h </i></p>
<p id="p-0404" num="0403">The memory card reader <b>400</b><i>h </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>h </i>further includes a conversion unit <b>492</b> and a user key input unit <b>493</b>. Also, the decryption unit <b>460</b> of the memory card reader <b>400</b><i>h </i>differs from that of the memory card reader <b>400</b>. Other elements of the memory card reader <b>400</b><i>h </i>are respectively the same as those of the memory card reader <b>400</b>.</p>
<p id="h-0129" num="0000">(1) User Key Input Unit <b>493</b></p>
<p id="p-0405" num="0404">The user key input unit <b>493</b> receives a user key from a user and outputs the user key to the conversion unit <b>492</b>, like the user key input unit <b>393</b>.</p>
<p id="h-0130" num="0000">(2) Conversion Unit <b>492</b></p>
<p id="p-0406" num="0405">The conversion unit <b>492</b> first reads the inherent key K′i from the media inherent key storing unit <b>423</b> and receives the user key from the user key input unit <b>493</b>.</p>
<p id="p-0407" num="0406">The conversion unit <b>392</b> then generates a transformed key by performing a predetermined calculation on the inherent key K′i and the user key. Here, the predetermined calculation is an exclusive disjunction.</p>
<p id="p-0408" num="0407">The conversion unit <b>492</b> finally outputs the transformed key to the decryption unit <b>460</b>.</p>
<p id="h-0131" num="0000">(3) Decryption Unit <b>460</b></p>
<p id="p-0409" num="0408">In the above examples, the decryption unit <b>460</b> reads the inherent key K′i from the media inherent key storing unit <b>423</b>, divides the encrypted content read from the content storing unit <b>470</b> into a plurality of encrypted partial contents Gi (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each encrypted partial content Gi using the inherent key K′i as the key of the decryption algorithm D<b>2</b>. Instead of these operations, in this embodiment, the decryption unit <b>460</b> receives the transformed key from the conversion unit <b>492</b>, divides the encrypted content read from the content storing unit <b>470</b> into a plurality of encrypted partial contents Gi (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each encrypted partial content Gi using the transformed key as the key of the decryption algorithm D<b>2</b>.</p>
<p id="h-0132" num="0000">3.9.3 Operation of Digital Content Protection System <b>100</b><i>h </i></p>
<p id="p-0410" num="0409">The following is a description of the operation of the digital content protection system <b>100</b><i>h. </i></p>
<p id="p-0411" num="0410">The authentication operations in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b><i>h </i>and in the case where the memory card <b>200</b> is placed in the memory card reader <b>400</b><i>h </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here.</p>
<p id="p-0412" num="0411">The following description concerns the operation outlines in the case where the memory card <b>200</b> is placed in the memory card writer <b>300</b><i>h </i>and in the case where the memory card <b>200</b> is placed in the memory card reader <b>400</b><i>h. </i></p>
<p id="h-0133" num="0000">(1) Operation Outline in the Case Where Memory Card <b>200</b> is Placed in Memory Card Writer <b>300</b><i>h </i></p>
<p id="p-0413" num="0412">When the memory card <b>200</b> is placed in the memory card writer <b>300</b><i>h</i>, the operation in the flowchart shown in <figref idref="DRAWINGS">FIG. 7</figref> is also performed. However, the different operation is performed in step S<b>114</b> in the digital content protection system <b>100</b><i>h </i>and is described below with reference to the flowchart shown in <figref idref="DRAWINGS">FIG. 27</figref>.</p>
<p id="p-0414" num="0413">The user key input unit <b>393</b> receives a user key from a user and outputs the user key to the conversion unit <b>392</b> (step S<b>100</b><i>h</i>). The conversion unit <b>392</b> reads the inherent key K′i from the media inherent key storing unit <b>323</b>, receives the user key from the user key input unit <b>393</b>, generates a transformed key by performing the predetermined calculation on the inherent key K′i and the user key, and outputs the transformed key to the encryption unit <b>360</b> (step S<b>101</b><i>h</i>). The encryption unit <b>360</b> receives the transformed key from the conversion unit <b>392</b>, divides the content read from the content storing unit <b>370</b> into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which is each a 64-bit bit string, generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the transformed key as the key of the encryption algorithm E<b>2</b>, and outputs the plurality of encrypted partial contents Fi to the communication unit <b>340</b> (step S<b>102</b><i>h</i>). The communication unit <b>340</b> outputs the plurality of encrypted partial contents Fi to the communication unit <b>270</b> of the memory card <b>200</b> (step S<b>103</b><i>h</i>).</p>
<p id="h-0134" num="0000">(2) Operation Outline in the Case Where Memory Card <b>200</b> is Placed in Memory Card Reader <b>400</b><i>h </i></p>
<p id="p-0415" num="0414">When the memory card <b>200</b> is placed in the memory card reader <b>400</b><i>h</i>, the operation in the flowchart shown in <figref idref="DRAWINGS">FIG. 8</figref> is also performed. However, the different operation is performed in step S<b>125</b> in the digital content protection system <b>100</b><i>h </i>and is described below with reference to the flowchart shown in <figref idref="DRAWINGS">FIG. 28</figref>.</p>
<p id="p-0416" num="0415">The user key input unit <b>493</b> receives a user key from a user and outputs the user key to the conversion unit <b>492</b> (step S<b>111</b><i>h</i>). The conversion unit <b>492</b> reads the inherent key K′i from the media inherent key storing unit <b>423</b>, receives the user key from the user key input unit <b>493</b>, generates a transformed key by performing the predetermined calculation on the inherent key K′i and the user key, and outputs the transformed key to the decryption unit <b>460</b> (step S<b>112</b><i>h</i>). The decryption unit <b>460</b> receives the transformed key from the conversion unit <b>492</b>, divides the encrypted content read from the content storing unit <b>470</b> into a plurality of encrypted partial contents Gi (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each encrypted partial content Gi using the transformed key as the key of the decryption algorithm D<b>2</b> (step S<b>113</b><i>h</i>).</p>
<p id="h-0135" num="0000">3.9.5 Conclusion</p>
<p id="p-0417" num="0416">The users can encrypt contents and decrypt the encrypted contents using user keys set by themselves. Therefore, the digital content protection system of this embodiment protects contents owned by the users. That is, the present digital content protection system prevents such contents from being decoded by others.</p>
<heading id="h-0136" level="1">3.10 Ninth Embodiment</heading>
<p id="p-0418" num="0417">The digital content protection system <b>100</b><i>i </i>of this embodiment includes a memory card <b>200</b><i>i</i>, a memory card writer <b>300</b><i>i</i>, and a memory card reader <b>400</b><i>i</i>. These elements are shown in <figref idref="DRAWINGS">FIGS. 29 and 30</figref>.</p>
<p id="p-0419" num="0418">The memory card <b>200</b><i>i</i>, the memory card writer <b>300</b><i>i</i>, and the memory card reader <b>400</b><i>i </i>are respectively similar to the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b> of the digital content protection system <b>100</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0137" num="0000">3.10.1 Memory Card Writer <b>300</b><i>i </i></p>
<p id="p-0420" num="0419">The memory card writer <b>300</b><i>i </i>differs from the memory card writer <b>300</b> in that the memory card writer <b>300</b><i>i </i>further includes an encryption unit <b>365</b> and a file key generating unit <b>366</b>. Also, the control unit <b>350</b>, the content download unit <b>380</b>, the content storing unit <b>370</b>, the encryption unit <b>360</b>, and the communication unit <b>340</b> of the memory card writer <b>300</b><i>i </i>differ from those of the memory card writer <b>300</b>. Other elements of the memory card writer <b>300</b><i>i </i>are respectively the same as those of the memory card writer <b>300</b> and are not described here.</p>
<p id="h-0138" num="0000">(1) Control Unit <b>350</b></p>
<p id="p-0421" num="0420">The control unit <b>350</b> outputs a download signal to the content download unit <b>380</b> and outputs a generation signal to the file key generating unit <b>366</b>. The download signal instructs the content download unit <b>380</b> to download a content from the outside as a file. The generation signal instructs the file key generating unit <b>366</b> to generate a file key for each file of the downloaded contents.</p>
<p id="h-0139" num="0000">(2) Content Download Unit <b>380</b></p>
<p id="p-0422" num="0421">The content download unit <b>380</b> downloads a content as a file. Here, the file means a collection of data under a certain rule. When the downloaded contents are music data, for instance, one file is generated for a piece of music.</p>
<p id="h-0140" num="0000">(3) Content Storing Unit <b>370</b></p>
<p id="p-0423" num="0422">The content storing unit <b>370</b> holds the downloaded content as a file.</p>
<p id="h-0141" num="0000">(4) File Key Generating Unit <b>366</b></p>
<p id="p-0424" num="0423">The file key generating unit <b>366</b>, on receiving the generation signal from the control unit <b>350</b>, generates a 56-bit file key at random for a file. The file key generating unit <b>366</b> then outputs the file key to the encryption units <b>365</b> and <b>360</b>.</p>
<p id="p-0425" num="0424">It should be noted here that in this embodiment, file keys are generated at random. However, the file key generating unit <b>366</b> may receives file keys from a user.</p>
<p id="h-0142" num="0000">(5) Encryption Unit <b>365</b></p>
<p id="p-0426" num="0425">The encryption unit <b>365</b> prestores an encryption algorithm E<b>5</b> that conforms to DES.</p>
<p id="p-0427" num="0426">The encryption unit <b>365</b> first reads the inherent key K′i from the media inherent key storing unit <b>323</b> and receives a file key from the file key generating unit <b>366</b>.</p>
<p id="p-0428" num="0427">The encryption unit <b>365</b> then generates an encrypted file key by applying the encryption algorithm E<b>5</b> to the file key using the inherent key K′i as the key of the encryption algorithm E<b>5</b>.</p>
<p id="p-0429" num="0428">The encryption unit <b>365</b> finally outputs the encrypted file key to the communication unit <b>340</b>.</p>
<p id="h-0143" num="0000">(6) Encryption Unit <b>360</b></p>
<p id="p-0430" num="0429">In the above embodiments, the encryption unit <b>360</b> reads the inherent key K′i from the media inherent key storing unit <b>323</b>, divides the content read from the content storing unit <b>370</b> into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the inherent key K′i as the key of the encryption algorithm E<b>2</b>. Instead of these operations, in this embodiment, the encryption unit <b>360</b> reads a content of a file, receives a file key from the file key generating unit <b>366</b>, divides the read content into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the file key as the key of the encryption algorithm E<b>2</b>.</p>
<p id="h-0144" num="0000">(7) Communication Unit <b>340</b></p>
<p id="p-0431" num="0430">The communication unit <b>340</b> receives the encrypted file key from the encryption unit <b>365</b> and outputs the encrypted file key to the communication unit <b>270</b>.</p>
<p id="h-0145" num="0000">3.10.2 Memory Card <b>200</b><i>i </i></p>
<p id="p-0432" num="0431">The communication unit <b>270</b> and the encrypted content storing unit <b>260</b> of the memory card <b>200</b><i>i </i>differ from those of the memory card <b>200</b>. Therefore, these elements are described below.</p>
<p id="h-0146" num="0000">(1) Communication Unit <b>270</b></p>
<p id="p-0433" num="0432">The communication unit <b>270</b> receives the encrypted file key from the communication unit <b>340</b> and outputs the encrypted file key to the encrypted content storing unit <b>260</b> (the encrypted file key outputted to the encrypted content storing unit <b>260</b> are shown as an encrypted file key <b>261</b> in <figref idref="DRAWINGS">FIG. 29</figref>).</p>
<p id="p-0434" num="0433">The communication unit <b>270</b> also reads the encrypted file key <b>261</b> from the encrypted content storing unit <b>260</b> and outputs the encrypted file key <b>261</b> to the communication unit <b>440</b> of the memory card reader <b>400</b><i>i. </i></p>
<p id="h-0147" num="0000">(2) Encrypted Content Storing Unit <b>260</b></p>
<p id="p-0435" num="0434">The encrypted content storing unit <b>260</b> receives the encrypted file key <b>261</b> from the communication unit <b>270</b> and holds the encrypted file key <b>261</b>.</p>
<p id="p-0436" num="0435">The encrypted content storing unit <b>260</b> also holds the encrypted partial contents Fi sent from the communication unit <b>270</b> (the encrypted partial contents Fi sent from the communication unit <b>270</b> are shown as encrypted files <b>262</b> in <figref idref="DRAWINGS">FIG. 29</figref>).</p>
<p id="h-0148" num="0000">3.10.3 Memory Card Reader <b>400</b><i>i </i></p>
<p id="p-0437" num="0436">The memory card reader <b>400</b><i>i </i>differs from the memory card reader <b>400</b> in that the memory card reader <b>400</b><i>i </i>further includes a decryption unit <b>465</b>. Also, the communication unit <b>440</b> and the decryption unit <b>460</b> of the memory card reader <b>400</b><i>i </i>differ from those of the memory card reader <b>400</b>. Other elements of the memory card reader <b>400</b><i>i </i>are respectively the same as those of the memory card reader <b>400</b> and are not described here.</p>
<p id="h-0149" num="0000">(1) Communication Unit <b>440</b></p>
<p id="p-0438" num="0437">The communication unit <b>440</b> receives the encrypted file key from the communication unit <b>270</b> and outputs the encrypted file key to the decryption unit <b>465</b>.</p>
<p id="h-0150" num="0000">(2) Decryption Unit <b>465</b></p>
<p id="p-0439" num="0438">The decryption unit <b>465</b> prestores a decryption algorithm D<b>5</b> that conforms to DES.</p>
<p id="p-0440" num="0439">Here, the relation between the encryption algorithm E<b>5</b> prestored in the encryption unit <b>365</b> and the decryption algorithm D<b>5</b> can be expressed by Formula 17 give below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E</i>5=crpt(<i>D</i>5)  &lt;Formula 17&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0441" num="0440">The decryption unit <b>465</b> first reads the inherent key K′i from the media inherent key storing unit <b>423</b> and receives the encrypted file key from the communication unit <b>440</b>.</p>
<p id="p-0442" num="0441">The decryption unit <b>465</b> then generates a file key by applying the decryption algorithm D<b>5</b> to the encrypted file key using the inherent key K′i as the key of the decryption algorithm D<b>5</b>.</p>
<p id="p-0443" num="0442">The decryption unit <b>465</b> finally outputs the file key to the decryption unit <b>460</b>.</p>
<p id="h-0151" num="0000">(3) Decryption Unit <b>460</b></p>
<p id="p-0444" num="0443">In the above examples, the decryption unit <b>460</b> reads the inherent key K′i from the media inherent key storing unit <b>423</b>, divides the encrypted content read from the content storing unit <b>470</b> into a plurality of encrypted partial contents Gi (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each encrypted partial content Gi using the inherent key K′i as the key of the decryption algorithm D<b>2</b>. Instead of these operations, in this embodiment, the decryption unit <b>460</b> receives the file key from the decryption unit <b>465</b>, divides the encrypted content read from the content storing unit <b>470</b> into a plurality of encrypted partial contents Gi (i=1, 2, 3, . . . ) which is each a 64-bit bit string, and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each encrypted partial content Gi using the file key as the key of the decryption algorithm D<b>2</b>.</p>
<p id="h-0152" num="0000">3.10.4 Operation of Digital Content Protection System <b>100</b><i>i </i></p>
<p id="p-0445" num="0444">The following is a description of the operation of the digital content protection system <b>100</b><i>i. </i></p>
<p id="p-0446" num="0445">The authentication operations in the case where the memory card <b>200</b><i>i </i>is placed in the memory card writer <b>300</b><i>i </i>and in the case where the memory card <b>200</b><i>i </i>is placed in the memory card reader <b>400</b><i>i </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here. The following description concerns the operation outlines in the case where the memory card <b>200</b><i>i </i>is placed in the memory card writer <b>300</b><i>i </i>and in the case where the memory card <b>200</b><i>i </i>is placed in the memory card reader <b>400</b><i>i. </i></p>
<p id="h-0153" num="0000">(1) Operation Outline in the Case Where Memory Card <b>200</b><i>i </i>is Placed in Memory Card Writer <b>300</b><i>i </i></p>
<p id="p-0447" num="0446">When the memory card <b>200</b><i>i </i>is placed in the memory card writer <b>300</b><i>i</i>, the operation in the flowchart shown in <figref idref="DRAWINGS">FIG. 7</figref> is also performed. However, the different operation is performed in step S<b>114</b> in the digital content protection system <b>100</b> and is described below with reference to the flowchart shown in <figref idref="DRAWINGS">FIG. 31</figref>.</p>
<p id="p-0448" num="0447">On receiving a generation signal, the file key generating unit <b>366</b> generates a 64-bit file key at random, outputs the file key to the decryption unit <b>365</b>. The encryption unit <b>365</b>-receives the file key from the file key generating unit <b>366</b>, reads the inherent key K′i from the media inherent key storing unit <b>323</b>, generates an encrypted file key by applying the encryption algorithm E<b>5</b> to the file key using the inherent key K′i as the key of the encryption algorithm E<b>5</b>, and outputs the encrypted file key to the communication unit <b>340</b> (step S<b>100</b><i>i</i>). The communication unit <b>340</b> receives the encrypted file key from the encryption unit <b>365</b> and outputs the encrypted file key to the communication unit <b>270</b> (step S<b>101</b><i>i</i>). The encryption unit <b>360</b> receives the file key from the file key generating unit <b>366</b>, and divides the content read from the content storing unit <b>370</b> into a plurality of partial contents Ci (i=1, 2, 3, . . . ) which is each a 64-bit bit string, generates a plurality of encrypted partial contents Fi (i=1, 2, 3, . . . ) by applying the encryption algorithm E<b>2</b> to each partial content Ci using the file key as the key of the encryption algorithm E<b>2</b> (step S<b>102</b><i>i</i>). The communication unit <b>340</b> receives the plurality of encrypted partial contents Fi from the encryption unit <b>360</b> and outputs the plurality of encrypted partial contents Fi to the communication unit <b>270</b> of the memory card <b>200</b><i>i </i>(step S<b>103</b><i>i</i>).</p>
<p id="h-0154" num="0000">(2) Operation Outline in the Case Where Memory Card <b>200</b><i>i </i>is Placed in Memory Card Reader <b>400</b><i>i </i></p>
<p id="p-0449" num="0448">When the memory card <b>200</b><i>i </i>is placed in the memory card reader <b>400</b><i>i</i>, the operation in the flowchart shown in <figref idref="DRAWINGS">FIG. 8</figref> is also performed. However, the different operation is performed in step S<b>125</b> in the digital content protection system <b>100</b><i>i </i>and is described below with reference to the flowchart shown in <figref idref="DRAWINGS">FIG. 32</figref>.</p>
<p id="p-0450" num="0449">The communication unit <b>440</b> receives the encrypted file key from the communication unit <b>270</b> and outputs the encrypted file key to the decryption unit <b>465</b>. The decryption unit <b>465</b> receives the encrypted file key from the communication unit <b>440</b>, reads the inherent key K′i from the media inherent key storing unit <b>423</b>, generates the file key by applying the decryption algorithm D<b>5</b> to the encrypted file key using the inherent key K′i as the key of the decryption algorithm D<b>5</b>, and outputs the file key to the decryption unit <b>460</b> (step S<b>111</b><i>i</i>). The decryption unit <b>460</b> receives the file key from the decryption unit <b>465</b>, divides the encrypted content read from the content storing unit <b>470</b> into a plurality of encrypted partial contents Gi (i=<b>1</b>, <b>2</b>, <b>3</b>, . . . ) which is each a 64-bit bit string, and generates a plurality of partial contents Hi (i=1, 2, 3, . . . ) by applying the decryption algorithm D<b>2</b> to each encrypted partial content Gi using the file key as the key of the decryption algorithm D<b>2</b> (step S<b>112</b><i>i</i>).</p>
<p id="h-0155" num="0000">3.10.5 Conclusion</p>
<p id="p-0451" num="0450">As described above, when a recording medium device is connected to an access device that is a memory card writer, each of the devices judges whether the other device is an authenticated device. If the judgement result is affirmative, the access device encrypts a digital content using file keys and writes the encrypted digital content into the recording medium device. More specifically, the access device generates file keys for respective files of the digital content, encrypts the file keys using an inherent key that has been secretly sent from the recording medium device, encrypts the files of the digital content using the file keys, and sends the encrypted file keys and the encrypted files to the recording medium device. The recording medium device receives the encrypted file keys and the encrypted files from the access device and holds them.</p>
<p id="p-0452" num="0451">Also, when the recording medium device that holds the encrypted file keys and the encrypted files is connected to an access device that is a memory card reader, each of the devices judges whether the other device is an authenticated device. If the judgement result is affirmative, the access device decrypts the encrypted files and reproduces the decrypted files. More specifically, the recording medium device outputs the encrypted file keys and the encrypted files to the access device. The access device receives the encrypted file keys and the encrypted files from the recording medium device, decrypts the encrypted file keys using an inherent key that has been secretly sent from the recording medium device, decrypts the encrypted files using the decrypted file keys, and reproduces the decrypted files.</p>
<p id="p-0453" num="0452">In this manner, the digital content protection system of this embodiment generates a file key inherent in each file of downloaded contents and encrypts the files using the file keys. Because this makes it difficult for third parties to intercept files, the present digital content protection system achieves a high security for the files.</p>
<p id="p-0454" num="0453">It should be noted here that the digital content protection system <b>100</b><i>i </i>may be modified as follows.</p>
<p id="h-0156" num="0000">(1) First Modification of Digital Content Protection System <b>100</b><i>i </i></p>
<p id="p-0455" num="0454"><figref idref="DRAWINGS">FIG. 33</figref> is a block diagram of the digital content protection system <b>100</b><i>i </i>of the first modification.</p>
<p id="p-0456" num="0455">As shown in this drawing, the memory card <b>200</b><i>i </i>further includes a random number seed generating unit <b>292</b> that generates a seed. Here, the seed is an initial value of a random number and is, in this modification, 64-bit time data. It is preferable to use a value, such as time data, that changes by the hour as the seed. The random number seed generating unit <b>292</b> generates the seed and outputs it to the communication unit <b>270</b>. After receiving the seed, the communication unit <b>270</b> outputs the seed to the communication unit <b>340</b>. The communication unit <b>340</b> outputs the seed sent from the communication unit <b>270</b> to the file key generating unit <b>366</b>. The file key generating unit <b>366</b> receives the seed from the communication unit <b>340</b>, generates a random number using the seed, and sets the random number as a file key.</p>
<p id="p-0457" num="0456">Note that the file key generating unit <b>366</b> may generate a random number as follows.</p>
<p id="p-0458" num="0457">The file key generating unit <b>366</b> generates a cipher text by applying a predetermined encryption algorithm to the seed using a predetermined key. The file key generating unit <b>366</b> then reapplies the predetermined algorithm to the cipher text to generate another cipher text. The file key generating unit <b>366</b> repeats this encryption processing by certain times and uses the final cipher text as the random number.</p>
<p id="h-0157" num="0000">(2) Second Modification of Digital Content Protection System <b>100</b><i>i </i></p>
<p id="p-0459" num="0458"><figref idref="DRAWINGS">FIG. 34</figref> is a block diagram of the digital content protection system <b>100</b><i>i </i>of the second modification.</p>
<p id="p-0460" num="0459">As shown in this drawing, the memory card <b>200</b><i>i </i>of this modification further includes a random number seed generating unit <b>293</b>. Like the random number seed generating unit <b>292</b>, the random number seed generating unit <b>293</b> generates a seed. Here, the seed is an initial value of a random number and is, in this modification, 64-bit time data. It is preferable to use a value, such as time data, that changes by the hour as the seed. The random number seed generating unit <b>293</b> generates a seed and outputs the seed to the mutual authentication unit <b>250</b>. After receiving the seed, the mutual authentication unit <b>250</b> performs its authentication process and outputs the seed to the mutual authentication unit <b>330</b> via the communication units <b>270</b> and <b>340</b>. The authentication unit <b>330</b> receives the seed from the communication unit <b>340</b> and outputs the seed to the file key generating unit <b>366</b>. The file key generating unit <b>366</b> receives the seed from the mutual authentication unit <b>330</b>, generates a random number using the seed, and sets the random number as a file key.</p>
<p id="p-0461" num="0460">During the authentication processing, the digital content protection system <b>100</b><i>i </i>of the first and second modifications perform different processing in steps S<b>135</b>, S<b>136</b>, S<b>137</b>, and S<b>138</b> in the authentication operation shown in <figref idref="DRAWINGS">FIGS. 9 and 10</figref>. Therefore, the following description centers on these steps.</p>
<p id="p-0462" num="0461">In step S<b>135</b>, the encryption unit <b>252</b> receives a seed S from the random number seed generating unit <b>293</b> and combines the seed S with the random number R<b>1</b> to generate (R<b>1</b>+S) that is a 128-bit bit string. The encryption unit <b>252</b> generates an encrypted random number E<b>2</b> (Ki,(R<b>1</b>+S)) by applying the encryption algorithm E<b>2</b> to (R<b>1</b>+S) using the inherent key Ki as the key of the encryption algorithm E<b>2</b>. Here, because (R<b>1</b>+S) is a 128-bit bit string, the encryption unit <b>252</b> divides (R<b>1</b>+S) into two 64-bit blocks and encrypts each block.</p>
<p id="p-0463" num="0462">In step S<b>136</b>, the communication unit <b>270</b> outputs the encrypted random number E<b>2</b> (Ki,(R<b>1</b>+S)) to the decryption unit <b>333</b> via the communication units <b>270</b> and <b>340</b>.</p>
<p id="p-0464" num="0463">In step S<b>137</b>, the decryption unit <b>333</b> generates D<b>2</b> (K′i,E<b>2</b> (Ki,(R<b>1</b>+S)) by applying the decryption algorithm D<b>2</b> to the encrypted random number E<b>2</b> (Ki,(R<b>1</b>+S)) using the inherent key K′i as the key of the decryption algorithm D<b>2</b>. The decryption unit <b>333</b> then divides D<b>2</b> (K′i,E<b>2</b> (Ki,(R<b>1</b>+S)) into two 64-bit bit strings.</p>
<p id="p-0465" num="0464">In step S<b>138</b>, the mutual authentication control unit <b>334</b> judges whether the random number R<b>1</b> matches the former one of the two 64-bit bit strings. If the comparison result is affirmative, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b> is an authorized device; if not, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b> is an unauthorized device. If the comparison result is affirmative, the mutual authentication control unit <b>334</b> also determines that the latter one of the two 64-bit bit strings is the seed S and outputs the seed S to the file key generating unit <b>366</b>.</p>
<p id="p-0466" num="0465">Note that in the above modification, the encryption unit <b>252</b> combines the random number R<b>1</b> with the seed S to generate (R<b>1</b>+S). However, the encryption unit <b>252</b> may divide the random number R<b>1</b> into two bit strings, divide the seed S into two 32-bit bit strings, combine the former bit string of the random number R<b>1</b> with the former bit string of the seed S in the order, and combine the latter bit string of the random number R<b>1</b> with the latter bit string of the seed S in the order.</p>
<p id="h-0158" num="0000">(3) Third Modification of Digital Content Protection System <b>100</b><i>i </i></p>
<p id="p-0467" num="0466">In this modification, the downloaded content is divided into one or more data blocks in logical or physical units, each data block is encrypted and is transferred to a recording medium, and the encrypted data blocks are transferred from the recording medium and are decrypted. During encryption, data block keys that are unique to respective data blocks are generated, the data blocks are encrypted using the unique data block keys and the inherent key obtained after the authentication processing, and the encrypted data blocks are transferred to the recording medium. During decryption, the encrypted data blocks are transferred from the recording medium and are decrypted.</p>
<p id="p-0468" num="0467">More specifically, when each of the memory card <b>200</b><i>i </i>and the memory card writer <b>300</b><i>i </i>judges that the other device is an authenticated device, the memory card writer <b>300</b><i>i </i>divides the downloaded content into one or more data blocks, generates a data block key for each data block, encrypts each data block using the inherent key and the data block key of the data block, and sends the encrypted data blocks to the memory card <b>200</b><i>i</i>. When the memory card <b>200</b><i>i </i>and the memory card reader <b>400</b><i>i </i>judges that they are connected to authenticated devices, the memory card reader <b>400</b><i>i </i>receives the encrypted data blocks from the memory card <b>200</b><i>i</i>, generates data block keys for respective encrypted data blocks, and decrypts the encrypted data blocks using the inherent key and the data block keys.</p>
<p id="p-0469" num="0468">With this construction, the digital content protection system of this modification generates a data block key unique to each data block of the downloaded content and encrypts the data block using the data block key. Because this makes it difficult for third parties to intercept data blocks, the present digital content protection system achieves a high security for the data blocks.</p>
<heading id="h-0159" level="1">3.11 Tenth Embodiment</heading>
<p id="p-0470" num="0469">The digital content protection system <b>100</b><i>j </i>of the present embodiment includes a memory card <b>200</b><i>j</i>, a memory card writer <b>300</b><i>j</i>, and a memory card reader <b>400</b><i>j</i>. These devices are not shown in the drawings.</p>
<p id="p-0471" num="0470">The memory card <b>200</b><i>j </i>secretly sends its inherent key to the memory card writer <b>300</b><i>j</i>, the memory card writer <b>300</b><i>j </i>judges whether the memory card <b>200</b><i>j </i>is an authorized device using the inherent key, and the memory card <b>200</b><i>j </i>judges whether the memory card writer <b>300</b><i>j </i>is an authorized device using the inherent key. Only if both of the memory card <b>200</b><i>j </i>and the memory card writer <b>300</b><i>j </i>judge that the other device is an authorized device, the memory card writer <b>300</b><i>j </i>outputs digital contents to the memory card <b>200</b><i>j</i>. When the memory card <b>200</b><i>j </i>is connected to the memory card reader <b>400</b><i>j</i>, the same authentication operation is performed.</p>
<p id="p-0472" num="0471">The memory card <b>200</b><i>j</i>, the memory card writer <b>300</b><i>j</i>, and the memory card reader <b>400</b><i>j </i>are respectively similar to the memory card <b>200</b>, the memory card writer <b>300</b>, and the memory card reader <b>400</b>. Therefore, the following description centers on the different aspects of these elements.</p>
<p id="h-0160" num="0000">3.11.1 Memory Card <b>200</b><i>j </i></p>
<p id="p-0473" num="0472">The memory card <b>200</b><i>j </i>includes a master key storing unit <b>210</b>, a media inherent key storing unit <b>220</b>, a conversion unit <b>230</b>, a media inherent key information storing unit <b>240</b>, a mutual authentication unit <b>250</b>, an encrypted content storing unit <b>260</b>, a communication unit <b>270</b>, and a control unit <b>280</b>. The mutual authentication unit <b>250</b> includes a random number generating unit <b>251</b>, a conversion unit <b>255</b>, and a mutual authentication control unit <b>254</b>.</p>
<p id="p-0474" num="0473">The master key storing unit <b>210</b>, the media inherent key storing unit <b>220</b>, the conversion unit <b>230</b>, and the media inherent key information storing unit <b>240</b> of the memory card <b>200</b><i>j </i>are respectively the same as those of the memory card <b>200</b>. Therefore, the following description concerns the different elements.</p>
<p id="h-0161" num="0000">(1) Random Number Generating Unit <b>251</b></p>
<p id="p-0475" num="0474">The random number generating unit <b>251</b> generates a random number R<b>2</b> that is a 64-bit bit string and outputs the random number R<b>2</b> to the communication unit <b>270</b> and the conversion unit <b>255</b>.</p>
<p id="h-0162" num="0000">(2) Conversion Unit <b>255</b></p>
<p id="p-0476" num="0475">The conversion unit <b>255</b> prestores a function f<b>1</b>.</p>
<p id="p-0477" num="0476">The conversion unit <b>255</b> receives a random number R<b>1</b> from the communication unit <b>270</b>, reads the inherent key Ki from the media inherent key storing unit <b>220</b>, and generates a conversion coefficient Q<b>1</b>. The conversion coefficient Q<b>1</b> can be expressed by Formula 18 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i>1=<i>f</i>1(<i>Ki,R</i>1)  &lt;Formula 18&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0478" num="0477">Here, the function f<b>1</b> is a one-way function. The one-way function means a function having a feature that it is easy to calculate output values from input values but it is difficult to calculate input values from output values. The one-way function is, for instance, an encryption function.</p>
<p id="p-0479" num="0478">The conversion unit <b>255</b> outputs the conversion coefficient Q<b>1</b> to the communication unit <b>270</b>.</p>
<p id="p-0480" num="0479">The conversion unit <b>255</b> also receives the random number S<b>2</b> from the random number generating unit <b>251</b>, reads the inherent key Ki from the media inherent key storing unit <b>220</b>, and generates a conversion coefficient Q<b>2</b> by applying the function f<b>1</b> to the random number R<b>2</b> using the inherent key Ki. The conversion coefficient Q<b>2</b> can be expressed by Formula 19 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q</i>2=<i>f</i>1(<i>Ki,R</i>2)  &lt;Formula 19&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0481" num="0480">The conversion unit <b>255</b> outputs the conversion coefficient Q<b>2</b> to the mutual authentication control unit <b>254</b>.</p>
<p id="h-0163" num="0000">(3) Mutual Authentication Control Unit <b>254</b></p>
<p id="p-0482" num="0481">The mutual authentication control unit <b>254</b> first receives the conversion coefficient Q<b>2</b> from the conversion unit <b>255</b> and receives a conversion coefficient Q′<b>2</b> from the communication unit <b>270</b>.</p>
<p id="p-0483" num="0482">The mutual authentication control unit <b>254</b> then compares the conversion coefficient Q<b>2</b> with the conversion coefficient Q′<b>2</b>. If the conversion coefficient Q<b>2</b> matches the conversion coefficient Q′<b>2</b>, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b><i>j </i>or te memory card reader <b>400</b><i>j </i>in which the memory card <b>200</b><i>j </i>is placed is an authorized device; if not, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b><i>j </i>or the memory card reader <b>400</b><i>j </i>is an unauthorized device.</p>
<p id="p-0484" num="0483">The mutual authentication control unit <b>254</b> finally outputs an authentication signal showing whether the memory card writer <b>300</b><i>j </i>or the memory card reader <b>400</b><i>j </i>is an authorized device to the control unit <b>280</b>.</p>
<p id="h-0164" num="0000">(4) Communication Unit <b>270</b></p>
<p id="p-0485" num="0484">The communication unit <b>270</b> reads the encrypted inherent key Ji from the media inherent key information storing unit <b>240</b> and outputs the encrypted inherent key Ji to the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>or to the communication unit <b>440</b> of the memory card reader <b>400</b><i>j. </i></p>
<p id="p-0486" num="0485">The communication unit <b>270</b> also receives the random number R<b>1</b> from the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>or the communication unit <b>440</b> of the memory card reader <b>400</b><i>j </i>and outputs the random number R<b>1</b> to the conversion unit <b>255</b> of the mutual authentication unit <b>250</b>.</p>
<p id="p-0487" num="0486">The communication unit <b>270</b> further receives the conversion coefficient Q<b>1</b> from the conversion unit <b>255</b> and outputs the conversion coefficient Q<b>1</b> to the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>or the communication unit <b>440</b> of the memory card reader <b>400</b><i>j. </i></p>
<p id="p-0488" num="0487">The communication unit <b>270</b> also receives the random number R<b>2</b> from the random number generating unit <b>251</b> and outputs the random number R<b>2</b> to the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>or the communication unit <b>440</b> of the memory card reader <b>400</b><i>j. </i></p>
<p id="p-0489" num="0488">The communication unit <b>270</b> also receives the conversion coefficient Q<b>2</b> from the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>or the communication unit <b>440</b> of the memory card reader <b>400</b><i>j </i>and outputs the conversion coefficient Q<b>2</b> to the mutual authentication control unit <b>254</b> of the mutual authentication unit <b>250</b>.</p>
<p id="p-0490" num="0489">On receiving a communication termination signal from the control unit <b>280</b>, the communication unit <b>270</b> terminates the communication with the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>or the communication unit <b>440</b> of the memory card reader <b>400</b><i>j</i>. The communication unit <b>270</b> also receives the encrypted partial contents Fi (where i=1, 2, 3, . . . ) from the communication unit <b>340</b> of the memory card writer <b>300</b><i>j </i>and outputs the encrypted partial contents Fi to the encrypted content storing unit <b>260</b>. The communication unit <b>270</b> furthermore reads the encrypted partial contents Fi from the encrypted content storing unit <b>260</b> and outputs the encrypted partial contents Fi to the communication unit <b>440</b> of the memory card reader <b>400</b><i>j. </i></p>
<p id="h-0165" num="0000">3.11.2 Memory Card Writer <b>300</b><i>j </i></p>
<p id="p-0491" num="0490">The memory card writer <b>300</b><i>j </i>includes a master key storing unit <b>313</b>, a media inherent key information storing unit <b>320</b>, an inversion unit <b>321</b>, a media inherent key storing unit <b>323</b>, a mutual authentication unit <b>330</b>, a communication unit <b>340</b>, a control unit <b>350</b>, an encryption unit <b>360</b>, a content storing unit <b>370</b>, and a content download unit <b>380</b>. The content download unit <b>380</b> is connected to the outside via the communication line <b>10</b> and includes a random number generating unit <b>331</b>, a conversion unit <b>335</b>, and a mutual authentication control unit <b>334</b>.</p>
<p id="p-0492" num="0491">The master key storing unit <b>313</b>, the media inherent key information storing unit <b>320</b>, the inversion unit <b>321</b>, the media inherent key storing unit <b>323</b>, the control unit <b>350</b>, the encryption unit <b>360</b>, the content storing unit <b>370</b>, and the content download unit <b>380</b> are respectively the same as those of the memory card writer <b>300</b>. Therefore, the following description centers on the different elements.</p>
<p id="h-0166" num="0000">(1) Random Number Generating Unit <b>331</b></p>
<p id="p-0493" num="0492">The random number generating unit <b>331</b> generates the random number R<b>1</b> that is a 64-bit bit string and outputs the random number R<b>1</b> to the communication unit <b>340</b> and the conversion unit <b>335</b>.</p>
<p id="h-0167" num="0000">(2) Conversion Unit <b>335</b></p>
<p id="p-0494" num="0493">The conversion unit <b>335</b> prestores a function f<b>1</b> that is the same as that prestored in the conversion unit <b>255</b>.</p>
<p id="p-0495" num="0494">The conversion unit <b>335</b> receives the random number R<b>2</b> from the communication unit <b>340</b>, reads the inherent key K′i from the media inherent key storing unit <b>323</b>, and generates the conversion coefficient Q′<b>2</b> by applying the function f<b>1</b> to the random number R<b>2</b> using the inherent key K′i. The conversion coefficient Q′<b>2</b> can be expressed by Formula 20 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q′</i>2=<i>f</i>1(<i>K′i,R</i>2)  &lt;Formula 20&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0496" num="0495">The conversion unit <b>335</b> outputs the conversion coefficient Q′<b>2</b> to the communication unit <b>340</b>.</p>
<p id="p-0497" num="0496">The conversion unit <b>335</b> also receives the random number R<b>1</b> from the random number generating unit <b>331</b>, reads the inherent key K′i from the media inherent key storing unit <b>323</b>, and generates the conversion coefficient Q′<b>1</b> by applying the function f<b>1</b> to the random number R<b>1</b> using the inherent key K′i. The conversion coefficient Q′<b>1</b> can be expressed by Formula 21 given below.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Q′</i>1=<i>f</i>1(<i>K′i,R</i>1)  &lt;Formula 21&gt;<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0498" num="0497">The conversion unit <b>335</b> outputs the conversion coefficient Q′<b>1</b> to the mutual authentication control unit <b>334</b>.</p>
<p id="h-0168" num="0000">(3) Mutual Authentication Control Unit <b>334</b></p>
<p id="p-0499" num="0498">The mutual authentication control unit <b>334</b> first receives the conversion coefficient Q<b>11</b> from the conversion unit <b>335</b> and receives the conversion coefficient Q<b>1</b> from the communication unit <b>340</b>.</p>
<p id="p-0500" num="0499">The mutual authentication control unit <b>334</b> then compares the conversion coefficient Q′<b>1</b> with the conversion coefficient Q<b>1</b>. If the conversion coefficient Q′<b>1</b> matches the conversion coefficient Q<b>1</b>, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b><i>j </i>that is placed in the memory card writer <b>300</b><i>j </i>is an authorized device; if not, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b><i>j </i>is an unauthorized device.</p>
<p id="p-0501" num="0500">The mutual authentication control unit <b>334</b> finally outputs an authentication signal showing whether the memory card <b>200</b><i>j </i>is an authorized device to the control unit <b>350</b>.</p>
<p id="h-0169" num="0000">(4) Communication Unit <b>340</b></p>
<p id="p-0502" num="0501">The communication unit <b>340</b> receives the encrypted inherent key Ji from the communication unit <b>270</b> and outputs the encrypted inherent key Ji to the media inherent key information storing unit <b>320</b>.</p>
<p id="p-0503" num="0502">The communication unit <b>340</b> also receives the random number R<b>1</b> from the random number generating unit <b>331</b> and outputs the random number R<b>1</b> to the communication unit <b>270</b> of the memory card <b>200</b><i>j. </i></p>
<p id="p-0504" num="0503">The communication unit <b>340</b> further receives the conversion coefficient Q<b>1</b> from the communication unit <b>270</b> of the memory card <b>200</b><i>j </i>and outputs the conversion coefficient Q<b>1</b> to the mutual authentication control unit <b>334</b> of the mutual authentication unit <b>330</b>.</p>
<p id="p-0505" num="0504">The communication unit <b>340</b> also receives the random number R<b>2</b> from the communication unit <b>270</b> of the memory card <b>200</b><i>j </i>and outputs the random number R<b>2</b> to the conversion unit <b>335</b> of the mutual authentication unit <b>330</b>.</p>
<p id="p-0506" num="0505">The communication unit <b>340</b> also receives the conversion coefficient Q′<b>2</b> from the conversion unit <b>335</b> and outputs the conversion coefficient Q′<b>2</b> to the communication unit <b>270</b> of the memory card <b>200</b><i>j. </i></p>
<p id="p-0507" num="0506">On receiving a communication termination signal from the control unit <b>350</b>, the communication unit <b>340</b> terminates the communication with the communication unit <b>270</b> of the memory card <b>200</b><i>j</i>. The communication unit <b>340</b> also receives the encrypted partial contents Fi (where i=1, 2, 3, . . . ) from the encryption unit <b>360</b> and outputs the encrypted partial contents Fi to the communication unit <b>270</b> of the memory card <b>200</b><i>j. </i></p>
<p id="h-0170" num="0000">3.11.3 Memory Card Reader <b>400</b><i>j </i></p>
<p id="p-0508" num="0507">The memory card reader <b>400</b><i>j </i>includes a master key storing unit <b>413</b>, a media inherent key information storing unit <b>420</b>, an inversion unit <b>421</b>, a media inherent key storing unit <b>423</b>, a mutual authentication unit <b>430</b>, a communication unit <b>440</b>, a control unit <b>450</b>, a decryption unit <b>460</b>, a content storing unit <b>470</b>, a reproduction unit <b>480</b>, and an operation unit <b>490</b>. The mutual authentication unit <b>430</b> includes a random number generating unit <b>431</b>, a conversion unit <b>435</b>, and a mutual authentication control unit <b>434</b>.</p>
<p id="p-0509" num="0508">The master key storing unit <b>413</b>, the media inherent key information storing unit <b>420</b>, the inversion unit <b>421</b>, the media inherent key storing unit <b>423</b>, the control unit <b>450</b>, the decryption unit <b>460</b>, the content storing unit <b>470</b>, the reproduction unit <b>480</b>, and the operation unit <b>490</b> are respectively the same as those of the memory card reader <b>400</b> and are not described here. Also, the communication unit <b>440</b>, the random number generating unit <b>431</b>, the conversion unit <b>435</b>, and the mutual authentication control unit <b>434</b> are respectively the same as the communication unit <b>340</b>, the random number generating unit <b>331</b>, the conversion unit <b>335</b>, and the mutual authentication control unit <b>334</b> of the memory card writer <b>300</b><i>j </i>and are not described here.</p>
<p id="h-0171" num="0000">3.11.4 Operation of Digital Content Protection System <b>100</b><i>j </i></p>
<p id="p-0510" num="0509">The following is a description of the operation of the digital content protection system <b>100</b><i>j. </i></p>
<p id="p-0511" num="0510">The operation outlines in the case where the memory card <b>200</b><i>j </i>is placed in the memory card writer <b>300</b><i>j </i>and in the case where the memory card <b>200</b><i>j </i>is placed in the memory card reader <b>400</b><i>j </i>are the same as those performed in the digital content protection system <b>100</b> and are not described here. The authentication operation in the case where the memory card <b>200</b><i>j </i>is placed in the memory card writer <b>300</b><i>j </i>is described in detail below. Note that the same authentication operation is performed in the case where the memory card <b>200</b><i>j </i>is placed in the memory card reader <b>400</b><i>j </i>and is not described here.</p>
<p id="h-0172" num="0000">(1) Authentication Operation in Case Where Memory Card <b>200</b><i>j </i>is Placed in Memory Card Writer <b>300</b><i>j </i></p>
<p id="p-0512" num="0511">The authentication operation in the case where the memory card <b>200</b><i>j </i>is placed in the memory card writer <b>300</b><i>j </i>is described in detail below with reference to <figref idref="DRAWINGS">FIG. 35</figref>.</p>
<p id="p-0513" num="0512">Steps S<b>130</b>-S<b>134</b> are the same those in <figref idref="DRAWINGS">FIG. 9</figref> and are not described here.</p>
<p id="p-0514" num="0513">The conversion unit <b>335</b> receives the random number R<b>1</b> from the random number generating unit <b>331</b>, reads the inherent key K′i from the media inherent key storing unit <b>323</b>, generates the conversion coefficient Q′<b>1</b> by applying the function f<b>1</b> to the random number R<b>1</b> using the inherent key K′i, and outputs the conversion coefficient Q′<b>1</b> to the mutual authentication control unit <b>334</b> (step S<b>162</b>).</p>
<p id="p-0515" num="0514">The conversion unit <b>255</b> receives the random number R<b>1</b> from the communication unit <b>270</b>, reads the inherent key Ki from the media inherent key storing unit <b>220</b>, generates the conversion coefficient Q<b>1</b> by applying the function f<b>1</b> to the random number R<b>1</b> using the inherent key Ki (step S<b>161</b>), and outputs the conversion coefficient Q<b>1</b> to the mutual authentication control unit <b>334</b> via the communication units <b>270</b> and <b>340</b> (step S<b>163</b>).</p>
<p id="p-0516" num="0515">The mutual authentication control unit <b>334</b> compares the conversion coefficient Q′<b>1</b> with the conversion coefficient Q<b>1</b>. If the conversion coefficient Q′<b>1</b> matches the conversion coefficient Q<b>1</b>, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b><i>j </i>is an authorized device; if not, the mutual authentication control unit <b>334</b> judges that the memory card <b>200</b><i>j </i>is an unauthorized device (step S<b>164</b>).</p>
<p id="p-0517" num="0516">The random number generating unit <b>251</b> generates the random number R<b>2</b> (step S<b>165</b>), and outputs the random number R<b>2</b> to the conversion unit <b>335</b> via the communication units <b>270</b> and <b>340</b> (step S<b>166</b>).</p>
<p id="p-0518" num="0517">The conversion unit <b>335</b> receives the random number R<b>2</b> from the communication unit <b>340</b>, reads the inherent key K′i from the media inherent key storing unit <b>323</b>, and generates the conversion coefficient Q′<b>2</b> by applying the function f<b>1</b> to the random number R<b>2</b> using the inherent key K′i (step S<b>168</b>).</p>
<p id="p-0519" num="0518">The conversion unit <b>335</b> then outputs the conversion coefficient Q′<b>2</b> to the mutual authentication control unit <b>254</b> via the communication units <b>340</b> and <b>270</b> (step S<b>169</b>).</p>
<p id="p-0520" num="0519">The conversion unit <b>335</b> receives the random number R<b>2</b> from the random number generating unit <b>251</b>, reads the inherent key Ki from the media inherent key storing unit <b>220</b>, and generates the conversion coefficient Q<b>2</b> by applying the function f<b>1</b> to the random number R<b>2</b> using the inherent key Ki (step S<b>167</b>).</p>
<p id="p-0521" num="0520">The mutual authentication control unit <b>254</b> compares the conversion coefficient Q<b>2</b> with the conversion coefficient Q′<b>2</b>. If the conversion coefficient Q<b>2</b> matches the conversion coefficient Q′<b>2</b>, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b><i>j </i>or the memory card reader <b>400</b><i>j </i>in which the memory card <b>200</b><i>j </i>is placed is an authorized device; if not, the mutual authentication control unit <b>254</b> judges that the memory card writer <b>300</b><i>j </i>or the memory card reader <b>400</b><i>j </i>is an unauthorized device (step S<b>170</b>).</p>
<p id="h-0173" num="0000">3.11.5 Conclusion</p>
<p id="p-0522" num="0521">As described above, like the digital content protection system <b>100</b>, the digital content protection system <b>100</b><i>j </i>prevents an authorized device from transferring contents to an unauthorized device. This prevents contents that have been properly downloaded from being used without a proper authorization. Also, an unauthorized device cannot transfer contents to an authorized device. This prevents illegally obtained contents from being reused.</p>
<p id="p-0523" num="0522">The recording medium device secretly sends its inherent key to the access device using the master key. The access device decrypts the inherent key sent from the recording medium device using the master key, generates authentication information that is a random number, sends the authentication information to the recording medium device, and applies a function to the authentication information using the decrypted inherent key. The recording medium device applies the same function as that applied by the access device to the authentication information using the inherent key, and sends the authentication information to which the function has been applied to the access device. The access device compares the authentication information generated by the access device with the authentication information sent from the recording medium. If the authentication information generated by the access device matches the authentication information sent from the recording medium, the access device judges that the recording medium device is an authorized device; if not, the access device judges that the recording medium device is an unauthorized device. The recording medium judges whether the access device is an authorized device in the same manner. By doing so, each of the recording medium device and the access device judges whether the other device is an authorized device.</p>
<p id="p-0524" num="0523">Also, unlike the digital content protection system <b>100</b>, the access device and the recording medium device perform the authentication operation described above using the inherent key prestored in the recording medium device, instead of the apparatus key prestored in the access device. Therefore, the access device and the recording medium device are not required to include memories for holding apparatus keys and apparatus key information, conversion units for converting the apparatus keys into the apparatus key information, and inversion units for performing inversion processing. As a result, the hardware scales of the access device and the recording medium device are reduced.</p>
<p id="h-0174" num="0000">3.12 Other Modifications</p>
<p id="p-0525" num="0524">(1) In the above examples, the digital content protection system includes a memory card, a memory card writer, and a memory card reader. However, the digital content protection system does not need to include all of these devices. That is, the digital content protection system may only include a memory card and a memory card writer or may only include a memory card and a memory card reader.
<br/>
(2) In the above examples, after a recording medium device, such as a memory card, is connected to an access device, such as a memory card writer and a memory card reader, each of the recording medium device and the access device judges whether the other device is an authenticated device. Only if both of these devices judges that they are connected to authenticated devices, digital contents are transferred between the recording medium device and the access device. However, the following operation may be performed.
</p>
<p id="p-0526" num="0525">When contents are sent from the access device to the recording medium device, the access device judges whether the recording medium device is an authentication device and, only if the judgement result is affirmative, sends the contents to the recording medium device. In this case, the recording medium device does not judge wether the access device is an authorized device.</p>
<p id="p-0527" num="0526">On the other hand, when contents are sent from the recording medium device to the access device, the recording medium device judges wether the access device is an authorized device and, only if the judgement result is affirmative, the recording medium device sends the contents to the access device. In this case, the access device does not judge whether the recording medium device is an authorized device.</p>
<p id="p-0528" num="0527">This modification is based on the concept that the authentication of a target device by a source device prevents contents that are properly downloaded from being used without proper authorization.</p>
<p id="h-0175" num="0000">(3) In the above examples, the access device is a memory card writer or a memory card reader. However, the access device may doubles as the memory card writer and the memory card reader.</p>
<p id="p-0529" num="0528">More specifically, the access device that doubles as the memory card writer and the memory card reader is connected to the personal computer shown in <figref idref="DRAWINGS">FIG. 2</figref> and a memory card is inserted into the access device. With the personal computer <b>500</b>, a user obtains contents, such as music data, from the outside via the communication line <b>10</b> and writes the contents in the memory card through the mediation of the access device. Also, with the personal computer <b>500</b>, the user obtains contents from the memory card through the mediation of the access device and reproduces the obtained contents.</p>
<p id="h-0176" num="0000">(4) In the above examples, the DES algorithm is used. However, any other cryptographic algorithm may be used.</p>
<p id="h-0177" num="0000">(5) The memory card may use an optical disc or an MO (Magneto-Optical) disc, instead of a semiconductor memory.</p>
<p id="h-0178" num="0000">(6) In the above examples, different inherent keys are assigned to respective recording medium devices. However, the present invention may be modified as follows.</p>
<p id="p-0530" num="0529">An inherent key is assigned to a group of recording medium devices and another inherent key is assigned to another group of recording mediums. In this case, the recording medium devices in each group are assigned the same inherent key.</p>
<p id="p-0531" num="0530">Also, an inherent key is assigned to the group of recording medium devices in one version of a product and another inherent key is assigned to the group of recording medium devices in another version. In this case, the recording medium devices in each group are assigned the same inherent key.</p>
<p id="p-0532" num="0531">Furthermore, an inherent key is assigned to the group of recording medium devices produced by a manufacturer and another inherent key is assigned to the group of recording medium produced by another manufacturer. In this case, the recording medium devices in each group are assigned the same inherent key.</p>
<p id="h-0179" num="0000">(7) When both of a recording medium device and an access device that is a memory card writer judge that the other device is an authorized device, the user key may be used to encrypt and decrypt digital contents in the manner described below.</p>
<p id="p-0533" num="0532">When the recording medium device is connected to the access device, the access device receives a user key from a user, generates a file key for each file of a digital content, and generates a transformed key for each file by performing a predetermined calculation, such as the exclusive disjunction, on the file key using the user key. The access device encrypts the files using the transformed keys and outputs the encrypted files and the transformed keys to the recording medium device. The recording medium device receives the encrypted files and the transformed keys from the access device and holds them.</p>
<p id="p-0534" num="0533">When the recording medium device that holds the encrypted files and the transformed keys is connected to an access device that is a memory card reader, the recording medium device outputs the encrypted files and the transformed keys to the access device. The access device receives the encrypted files and the transformed keys from the recording medium device, receives a user key from a user, generates a file key for each of the encrypted files by performing an inverse calculation of the predetermined calculation on the transformed key using the user key, decrypts the encrypted files using the generated file keys, and reproduces the decrypted files.</p>
<p id="p-0535" num="0534">(8) The present invention may be achieved by a computer-readable recording medium that records a program for having a computer perform the operation of the present digital content protection system. Also, the present invention may be achieved by computer digital signals of such a program.
<br/>
(9) The present invention may be achieved by a transmission media, such as a communication channel, that transmits the program for having a computer perform the operation of the present digital content protection system. Also, the present invention may be achieved by a separated computer system by delivering the recording medium to the computer system or transferring the program to the computer system via a communication channel. Furthermore, the present invention may be a program or computer digital signals transferred via a communication channel.
<br/>
(10) The embodiments described above may be combined to realize a modified digital content protection system. Also, parts of some embodiments may be combined to realize a modified digital content protection system.
</p>
<p id="p-0536" num="0535">Although the present invention has been fully described by way of examples with reference to accompanying drawings, it is to be noted that various changes and modifications will be apparent to those skilled in the art. Therefore, unless such changes and modifications depart from the scope of the present invention, they should be construed as being included therein.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298845-20071120-M00001.NB">
<img id="EMI-M00001" he="8.13mm" wi="76.20mm" file="US07298845-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298845-20071120-M00002.NB">
<img id="EMI-M00002" he="7.79mm" wi="76.20mm" file="US07298845-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298845-20071120-M00003.NB">
<img id="EMI-M00003" he="8.13mm" wi="76.20mm" file="US07298845-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein the recording medium apparatus includes a first calculation means, and</claim-text>
<claim-text>the access apparatus includes a first authentication information generating means and a first authentication means,</claim-text>
<claim-text>wherein while the access apparatus judges whether the recording medium apparatus is legitimate in the authentication phase,</claim-text>
<claim-text>the first authentication information generating means generates first authentication information and outputs the first authentication information to the recording medium apparatus,</claim-text>
<claim-text>the first calculation means receives the first authentication information, generates first calculated authentication information by performing a first calculation on the received first authentication information using the inherent key, and outputs the first calculated authentication information to the access apparatus, and</claim-text>
<claim-text>the first authentication means judges whether the recording medium apparatus is legitimate from the first authentication information and the first calculated authentication information using the secretly transmitted inherent key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The digital content protection system of <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the access apparatus includes a second calculation means, and</claim-text>
<claim-text>the recording medium apparatus includes a second authentication information generating means and a second authentication means,</claim-text>
<claim-text>wherein while the recording medium apparatus judges whether the access apparatus is legitimate in the authentication phase,</claim-text>
<claim-text>the second authentication information generating means generates second authentication information and outputs the second authentication information to the access medium apparatus,</claim-text>
<claim-text>the second calculation means receives the second authentication information, generates second calculated authentication information by performing a second calculation on the received second authentication information using the secretly transmitted inherent key, and outputs the second calculated authentication information to the recording medium apparatus, and</claim-text>
<claim-text>the second authentication means judges whether the access apparatus is legitimate from the second authentication information and the second calculated authentication information using the inherent key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The digital content protection system of <claim-ref idref="CLM-00002">claim 2</claim-ref>,
<claim-text>wherein the recording medium apparatus further includes a first encryption means and an inherent key storing means for prestoring the inherent key, and</claim-text>
<claim-text>the access apparatus further includes a first decryption means,</claim-text>
<claim-text>wherein while the recording medium apparatus secretly transmits the inherent key to the access apparatus in the authentication phase,</claim-text>
<claim-text>the first encryption means generates an encrypted inherent key by applying a first encryption algorithm to the inherent key and outputs the encrypted inherent key to the access apparatus, and</claim-text>
<claim-text>the first decryption means receives the encrypted inherent key and generates a decrypted inherent key by applying a first decryption algorithm to the encrypted inherent key, the first decryption algorithm being used to decrypt cipher text generated with the first encryption algorithm.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The digital content protection system of <claim-ref idref="CLM-00003">claim 3</claim-ref>,
<claim-text>wherein the recording medium apparatus further includes a first key storing means for prestoring a first key, and</claim-text>
<claim-text>the access apparatus further includes a second key storing means for prestoring a second key that corresponds to the first key,</claim-text>
<claim-text>wherein the first encryption means encrypts the inherent key using the first key, and</claim-text>
<claim-text>the first decryption means decrypts the encrypted inherent key using the second key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein when the recording medium apparatus and the access apparatus have successfully authenticated each other,</claim-text>
<claim-text>in the content transfer phase, the access apparatus either</claim-text>
<claim-text>(c) generates at least one data block by dividing a digital content, generates a data block key for each data block, generates at least one encrypted data block by encrypting each data block using the secretly transmitted inherent key and a data block key that corresponds to the data block, and transfers each encrypted data block to the recording medium, or</claim-text>
<claim-text>(d) receives at least one encrypted data block of an encrypted digital content from the recording medium apparatus, generates a data block key for each data block, and generates at least one data block by decrypting each encrypted data block using the secretly transmitted inherent key and a data block key that corresponds to the encrypted data block,</claim-text>
<claim-text>wherein each data block has one of a logical length and a physical length, and</claim-text>
<claim-text>each encrypted data block has one of a logical length and a physical length.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein when the recording medium apparatus and the access apparatus have successfully authenticated each other,</claim-text>
<claim-text>in the content transfer phase, the access apparatus either</claim-text>
<claim-text>(e) generates a file key for a file of a digital content, generates an encrypted file by encrypting the file using the secretly transmitted inherent key and the file key, and transfers the encrypted file and information concerning the file key to the recording medium, or</claim-text>
<claim-text>(f) receives, from the recording medium apparatus, an encrypted file of an encrypted digital content and information concerning a file key that corresponds to the encrypted file, generates a decrypted file by decrypting the encrypted file using the secretly transmitted inherent key and the information concerning the file key, and reproduces the decrypted file.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The digital content protection system of <claim-ref idref="CLM-00006">claim 6</claim-ref>,
<claim-text>wherein when the recording medium apparatus and the access apparatus have successfully authenticated each other,</claim-text>
<claim-text>in the content transfer phase, the access apparatus either</claim-text>
<claim-text>(g) generates a file key for a file of a digital content, generates an encrypted file by encrypting the file using the file key, generates an encrypted file key by encrypting the file key using the secretly transmitted inherent key, and transfers the encrypted file and the encrypted file key to the recording medium, or</claim-text>
<claim-text>(h) receives, from the recording medium apparatus, an encrypted file and an encrypted file key that corresponds to the encrypted file, generates a ‘file key by decrypting the encrypted file key using the secretly transmitted inherent key, generates a decrypted file by decrypting the encrypted file using the file key, and reproduces the decrypted file.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The digital content protection system of <claim-ref idref="CLM-00006">claim 6</claim-ref>,
<claim-text>wherein the recording medium apparatus generates a seed from a current time and outputs the seed to the access apparatus, the seed being an initial value of a random number,</claim-text>
<claim-text>the access apparatus receives the generated seed from the recording medium apparatus, generates the random number from the seed, and sets the random number as a file key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The digital content protection system of <claim-ref idref="CLM-00006">claim 6</claim-ref>,
<claim-text>wherein while the access apparatus judges whether the recording medium apparatus is legitimate in the authentication phase,</claim-text>
<claim-text>the access apparatus sends the first authentication information to the recording medium apparatus,</claim-text>
<claim-text>the recording medium apparatus generates a seed from a current time, generates a combination result by combining the seed with the first authentication information, generates an encrypted combination result by encrypting the combination result using the inherent key, and sends the encrypted combination result to the access apparatus, the seed being an initial value of a random number, and</claim-text>
<claim-text>the access apparatus generates a decrypted seed and first decrypted authentication information by decrypting the encrypted combination result using the secretly transmitted inherent key, judges whether the first authentication information matches the first decrypted authentication information, and, if so, determines that the recording medium apparatus is legitimate, and</claim-text>
<claim-text>in the content transfer phase, the access apparatus generates the random number from the decrypted seed and sets the random number as a file key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein when the recording medium apparatus and the access apparatus have successfully authenticated each other,</claim-text>
<claim-text>in the content transfer phase, the access apparatus either</claim-text>
<claim-text>(i) receives a user key from an operator, generates a transformed key from the user key and the secretly transmitted inherent key, generates an encrypted digital content by encrypting a digital content using the transformed key, and transfers the encrypted digital content to the recording medium, or</claim-text>
<claim-text>(j) receives an encrypted digital content from the recording medium apparatus, generates a transformed key from a user key inputted from an operator and the secretly transmitted inherent key, and generates a decrypted digital content by decrypting the encrypted digital content using the transformed key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein when the recording medium apparatus and the access apparatus have successfully authenticated each other,</claim-text>
<claim-text>in the content transfer phase, the ‘access apparatus either</claim-text>
<claim-text>(k) receives a user key from an operator, generates a file key for a file of a digital content, generates a transformed key from the user key and the file key, generates an encrypted file by encrypting the file using the transformed key, and transfers the encrypted file and the transformed key to the recording medium, or</claim-text>
<claim-text>(l) receives, from the recording medium apparatus, an encrypted file and a transformed key that corresponds to the encrypted file, receives a user key from an operator, generates a file key from the user key and the transformed key, generates a decrypted file by decrypting the encrypted file using the file key, and reproduces the decrypted file.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein while the recording medium apparatus judges whether the access apparatus is legitimate in the authentication phase,</claim-text>
<claim-text>the recording medium apparatus sends second authentication information to the access apparatus,</claim-text>
<claim-text>the access apparatus generates encrypted second authentication information by encrypting the second authentication information using a master key and sends the encrypted second authentication information to the recording medium apparatus, and</claim-text>
<claim-text>the recording medium apparatus generates decrypted second authentication information by decrypting the encrypted second authentication information using a master key, judges whether the second authentication information matches the decrypted second authentication information, and, if so, determines that the access apparatus is legitimate.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A digital content protection system that enables a digital content to be used and includes a recording medium apparatus having a storage area for holding digital content information and an access apparatus that reads information from and writes information into the storage area,
<claim-text>the digital content protection system operating according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus;</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key; and</claim-text>
<claim-text>an encrypted inherent key generation apparatus,</claim-text>
<claim-text>wherein the digital content protection system further operates according to an encrypted inherent key setting phase where the encrypted inherent key generation apparatus generates an encrypted inherent key by encrypting the inherent key sent from the recording medium apparatus and sends the encrypted inherent key to the recording medium apparatus, and the recording medium apparatus holds the encrypted inherent key sent from the encrypted inherent key generation apparatus,</claim-text>
<claim-text>wherein in the authentication phase, the recording medium apparatus sends the encrypted inherent key to the access apparatus, and the access apparatus generates a decrypted inherent key by decrypting the encrypted inherent key secretly sent from the recording medium apparatus and judges whether the recording medium apparatus is legitimate using the’ decrypted inherent key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A recording medium apparatus that has a storage area for holding digital content information and is used in a digital content protection system,
<claim-text>wherein the digital content protection system enables a digital content to be used and further includes an access apparatus that reads information from and writes information into the storage area, and</claim-text>
<claim-text>the digital content protection system operates according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein the recording medium apparatus includes a first calculation means, and</claim-text>
<claim-text>the access apparatus includes a first authentication information generating means and a first authentication means,</claim-text>
<claim-text>wherein while the access apparatus judges whether the recording medium apparatus is legitimate in the authentication phase,</claim-text>
<claim-text>the first authentication information generating means generates first authentication information and outputs the first authentication information to the recording medium apparatus,</claim-text>
<claim-text>the first calculation means receives the first authentication information, generates first calculated authentication information by performing a first calculation on the received first authentication information using the inherent key, and outputs the first calculated authentication information to the access apparatus, and</claim-text>
<claim-text>the first authentication means judges whether the recording medium apparatus is legitimate from the first authentication information and the first calculated authentication information using the secretly transmitted inherent key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. An access apparatus that reads information from and writes information into a storage area of a recording medium apparatus and is included in a digital content protection system,
<claim-text>wherein the storage area holds digital content information,</claim-text>
<claim-text>the digital content protection system enables a digital content to be used and includes the recording medium apparatus and the access apparatus,</claim-text>
<claim-text>wherein the digital content protection system operates according to the following phases:</claim-text>
<claim-text>an authentication phase where the recording medium apparatus secretly transmits an inherent key to the access apparatus, and the recording medium apparatus and the access apparatus perform mutual authentication using the inherent key, the inherent key being information that is unique to the recording medium apparatus; and</claim-text>
<claim-text>a content transfer phase, performed only when the recording medium apparatus and the access apparatus have successfully authenticated each other, where the access apparatus either (a) encrypts a digital content using the secretly transmitted inherent key and sends the encrypted digital content to the recording medium apparatus or (b) receives an encrypted digital content from the recording medium apparatus and decrypts the encrypted digital content using the secretly transmitted inherent key,</claim-text>
<claim-text>wherein the recording medium apparatus includes a first calculation means, and</claim-text>
<claim-text>the access apparatus includes a first authentication information generating means and a first authentication means,</claim-text>
<claim-text>wherein while the access apparatus judges whether the recording medium apparatus is legitimate in the authentication phase,</claim-text>
<claim-text>the first authentication information generating means generates first authentication information and outputs the first authentication information to the recording medium apparatus,</claim-text>
<claim-text>the first calculation means receives the first authentication information, generates first calculated authentication information by performing a first calculation on the received first authentication information using the inherent key, and outputs the first calculated authentication information to the access apparatus, and</claim-text>
<claim-text>the first authentication means judges whether the recording medium apparatus is legitimate from the first authentication information and the first calculated authentication information using the secretly transmitted inherent key.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
