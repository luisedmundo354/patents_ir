<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299491-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299491</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10427458</doc-number>
<date>20030430</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>849</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>32</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726  4</main-classification>
<further-classification>726 26</further-classification>
</classification-national>
<invention-title id="d0e53">Authenticated domain name resolution</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5777989</doc-number>
<kind>A</kind>
<name>McGarvey</name>
<date>19980700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370254</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6119234</doc-number>
<kind>A</kind>
<name>Aziz et al.</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 11</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6381627</doc-number>
<kind>B1</kind>
<name>Kwan et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>709201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6411966</doc-number>
<kind>B1</kind>
<name>Kwan et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>707201</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6434600</doc-number>
<kind>B2</kind>
<name>Waite et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>709206</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6578066</doc-number>
<kind>B1</kind>
<name>Logan et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>718105</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6728767</doc-number>
<kind>B1</kind>
<name>Day et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6907525</doc-number>
<kind>B2</kind>
<name>Pazi et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713170</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00009">
<othercit>Vixie, Paul; “DNS and Bind Security Issues”; Proceedings of the 5th Usenx Iunix Security Symposium; Jun. 5-7, 1995; p. 209-216.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Xunhau Wang; Yih Huang; Yvo Desmendt; and Rine, David; “Enabling Secure On-Line DNS Dynamic Update”; Computer Security Applications, 2000. ACSAC '00 16th Annual Conference; Dec. 11-15, 2000; p. 52-58.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Le, Van and Guyennet, Herve; “IPSEC and DNSSEC to Support Grid Application Security”; Proceedings of the 2nd IEEE/ACM International Symposium on Cluster Computing and the Grid ( CCGRID2002); May 21-24, 2002; p. 425-426.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Massey, Daniel; Lewis, Ed; Gudmundsson, Olafur; Mundy, Russ; and Mankin, Allison; “Public Key Validation for the DNS Security Extension”; Proceedings of the DARPA Information Survivablity Conference &amp; Exposition II (DISCEX '01); Jun. 12-14, 2001; vol. 1; p. 227-238.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Jim, Trevor; “SD3: A Trust Management System With Certified Evaluation”; Proceedings of the 2001 IEEE Symposium on Security and Privacy; May 14-16, 2001; p. 106-115.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Davidowicz, Diane and Vixie, Paul; “Securing the Domain Name System”; <i>Network Magazine</i>; Jan. 2000; vol. 15, No. 1; p. 92-94 and 96-97.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Eastlake, D. and Kaufman, C.; “Domain Name System Security Extensions”; &lt;http://www.ietf.org/rfc/rfc2065.txt?number=2065&gt;; visited Jul. 7, 2003; p. 1-41.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>Eastlake, D., “Domain Name System Security Extensions”; &lt;http://www.ietf.org/rfc/rfc2535.txt?number=2524&gt;; visited Jul. 7, 2003; p. 1-47.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>Mockapetris, P.; “Domain Names—Implementation and Specification”; &lt;http://www.ietf.org/rfc/rfc1035.txt?number=1035&gt;; visited Jul. 7, 2003; p. 1-55.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>Mockapetris, P.; “Domain Names—Concepts and Facilities”; &lt;http://www.ietf.org/rfc/rfc1034.txt?number=1034&gt;; visited Jul. 7, 2003; p. 1-55.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>Elz, R. and Bush, R.; “Clarifications to the DNS Specification”; &lt;http://www.ietf.org/rfc/rfc2181.txt?number=2181&gt;; visited Jul. 7, 2003; p. 1-15.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Baba, T.; “Requirements for Access Control in Domain Name Systems”; &lt;http://www.ietf.org/internet-drafts/draft-baba-dnsext-acl-requts-00.txt&gt;; visited Jul. 7, 2003; p. 1-6.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Lioy, Antonio; Maino, Fabio; Marian, Marius; and Mazzocchi, Daniele; “DNS Security”; Proceedings of the Terena Networking Conference; May 22-25, 2000; p. 1-13.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>53</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726  4</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040250119</doc-number>
<kind>A1</kind>
<date>20041209</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Shelest</last-name>
<first-name>Art</first-name>
<address>
<city>Sammamish</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Gilroy</last-name>
<first-name>James M.</first-name>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Workman Nydegger</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Microsoft Corporation</orgname>
<role>02</role>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Zand</last-name>
<first-name>Kambiz</first-name>
<department>2134</department>
</primary-examiner>
<assistant-examiner>
<last-name>Powers</last-name>
<first-name>William S</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Methods, systems, and computer program products for resolving domain name system records based on client authentication. Basing domain name resolution on client authentication provides remote clients with the convenience of domain names, without sacrificing the security of keeping potentially sensitive domain names private. An authoritative name server receives requests for domain name resolution from clients. For requests without client authentication, the authoritative name server responds that the domain name cannot be found. This response identifies the authoritative name server to the client so that the client can submit subsequent requests with client authentication. For requests with client authentication, the authoritative name server responds with the corresponding domain name addresses. Client may communicate domain name resolution requests directly to the authoritative name server or indirection, through one or more intermediate domain name servers. Client authentication may occur over a secure connection with the authoritative name server.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="170.60mm" wi="239.61mm" file="US07299491-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="258.91mm" wi="167.56mm" orientation="landscape" file="US07299491-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="222.76mm" wi="163.41mm" orientation="landscape" file="US07299491-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="241.89mm" wi="171.70mm" orientation="landscape" file="US07299491-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="220.56mm" wi="165.52mm" orientation="landscape" file="US07299491-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="253.75mm" wi="173.48mm" orientation="landscape" file="US07299491-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">N/A</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. The Field of the Invention</p>
<p id="p-0004" num="0003">The present invention relates to domain name resolution. More particularly, the present invention relates to systems, computer program products, and methods for resolving domain names based on client authentication.</p>
<p id="p-0005" num="0004">2. The Relevant Technology</p>
<p id="p-0006" num="0005">Security is a growing concern for many organizations (including families and individuals) that offer outside connections to computers on their home or business network. At any given time, an organization may provide access to certain computers over various networks (such as a local or wide area network, the Internet, etc.). For example, the organization may have an externally accessible computer to manage email, web content, financial or marketing data, technical information, or other content. While these external connections provide the organization with some benefits, they also introduce security concerns.</p>
<p id="p-0007" num="0006">When an organization opens up a network computer to external access, the organization risks the possibility that unwanted persons (e.g., hackers) will gain access to restricted portions of that computer. Thus, organizations strike a balance between the need to allow remote access to potentially sensitive information and the chance a hacker may break through the security. To mitigate these risks, organizations often employ a firewall and other expensive security measures to restrict external access to their computers.</p>
<p id="p-0008" num="0007">For example, an organization may implement any of one or more higher level secure communication protocols, such as Secure Sockets Layer (SSL) and Transport Layer Security (TLS) for encrypting data that passes between computers. The organization also may (or alternatively) employ a virtual private network (VPN) that provides access to an organization's network in part by forbidding entry of data packets that are not encrypted properly. An organization may enhance security further through lower level communication protocols, such as Internet Protocol Security (IPsec).</p>
<p id="p-0009" num="0008">Many communication protocols, including those identified above, may transmit data intended for a private network over a public (or wide area) network through a “tunneling” protocol. Tunneling masks the transmission of private data sent over a public network so that certain information is inaccessible to the public network. Accordingly, an organization may implement one or more of these protocols to secure access to their computers.</p>
<p id="p-0010" num="0009">Network connectivity allows for access to files and for conducting a variety of transactions from remote locations. Those wanting to access an organization's computer typically do so using a relatively easily remembered domain name that corresponds to one or more Internet Protocol (IP) addresses (or, in some cases one or more arbitrary text strings). IP addresses are numbers ranging from 32-bits (older standard: e.g., written as a set of four 8-bit numbers separated by periods) to 128-bits (more recent standard: e.g., written as a set of sixteen 8-bit numbers). IP addresses ordinarily represent an address for a computer on a network.</p>
<p id="p-0011" num="0010">IP addresses, however, tend to be difficult to remember, and may change, especially within a particular network, depending on how a network server configures addresses (e.g., allowing static addresses, or requiring dynamic address assignment). Thus, a computer's domain name (e.g., www.company.com) often is a more convenient way to reference a particular computer on a network. Domain names are also convenient since domain names can be reassigned to different, or even multiple IP addresses, and hence may remain constant in spite of fairly significant changes in network configuration.</p>
<p id="p-0012" num="0011">A domain name generally comprises a top-level domain (TLD), a second-level domain, and a server, protocol, and/or sub-domain. With reference to <figref idref="DRAWINGS">FIG. 1</figref>, “ns.company.com” <b>136</b> comprises three parts: “.com” represents the top-level domain <b>130</b>, “company” represents a second-level domain with the “.com” TLD, and “ns” represents a server within the “company” second-level domain. The domain name, “ns.company.com” typically maps to, and can be thought of as, a readable version of an IP address. Frequently, the prefix letters “www” comprise a third level domain that represents a specific server for handling HyperText Transfer Protocol (HTTP) requests. Examples of sub-domains include prefixes preceding the second-level domain, such as in “private.company.com” <b>138</b> (or mail.company.com). In either case, a domain name server resolves domain names into domain name address for requesting clients.</p>
<p id="p-0013" num="0012">Domain name servers (DNS servers, or name servers) are servers scattered over various worldwide zones, which can perform “name to address” translation—converting textual domain names into IP addresses and vice versa. To resolve a domain name, domain name servers refer to a distributed database of domain names and respective IP addresses. Requests for domain name resolution often are referred to as DNS queries. As described in more detail below, a domain name server may reference a cache containing recently accessed domain names with their corresponding IP addresses or may request the information from another domain name server.</p>
<p id="p-0014" num="0013">The server responsible for maintaining domain name resolution information for a particular domain or sub-domain is known as an authoritative name server for the domain or sub-domain. Accordingly, a domain name server may function as an authoritative name server, a domain name cache server, or some combination of both. Except for relatively small domains or sub-domains, a single domain name server typically does not contain a complete reference of all domain names and corresponding IP addresses. Rather domain name servers usually are organized to coordinate and distribute available domain name information due to both performance and size considerations. The domain name server organization for the Internet follows a hierarchy beginning with several distributed root name servers, e.g., <b>100</b>, <b>110</b>, <b>115</b>, etc., followed by various top-level domain name servers, e.g., “.org” <b>125</b>, “.com” <b>130</b>, “.edu” <b>150</b>, “.net” <b>180</b>, etc., and various more localized domain names servers, e.g., <b>134</b>, <b>136</b>, <b>132</b>, <b>152</b>, <b>154</b>, etc.</p>
<p id="p-0015" num="0014">An authoritative name server, such as name server <b>136</b>, maintains domain name resolution information (domain names and corresponding IP addresses) for a portion of the hierarchy. For example, the authoritative name server “ns.company.com” <b>136</b> may be authoritative for various sub-domains in the “company” organization, such as, “private.company.com” <b>138</b>, product.company.com (not shown), accounting.company.com (not shown), and mail.company.com (not shown). Similarly, other domain name servers in the “.com” or other hierarchies may be authoritative for a certain geographic area, such as Seattle, or for a particular range of IP addresses, such as the range of IP addresses assigned by an Internet Service Provider or registrar of domain names. Regardless, if a particular name server cannot determine the appropriate IP address for a given domain name, such as “private.company.com” <b>138</b>, the name server may relay or forward the domain name request to other domain name servers, and eventually to the authoritative name server “ns.company.com” <b>136</b>, if the information is not cached at intervening name servers.</p>
<p id="p-0016" num="0015">By way of illustration, Client B requests <b>140</b> access to “http://humanities.school.edu” which requires the domain name “humanities.school.edu” to be resolved. The server “physics.school.edu” <b>156</b> caches some domain name resolution information, but in this example does not have the IP address for the “humanities.school.edu” domain name and therefore queries server <b>154</b>. Name server “ns.school.edu” <b>154</b> is an authoritative name server for the “school.edu” domain and provides an authoritative response <b>145</b>, indicating that “192.168.2.2” is the IP address for the “humanities.school.edu” domain name. This response may be forwarded <b>147</b> to client B. (It should be noted that throughout this document, an effort is made to use fictitious IP addresses which are reserved for local use.) Because name server “ns.school.edu” <b>154</b> is authoritative for the “school.edu” domain, “ns.school.edu” would not forward this request on to other DNS servers, but rather would respond that “humanities.school.edu” was unknown if no IP address were available. Upon receiving a response from “ns.school.edu” <b>154</b>, server <b>156</b> “physics.school.edu” ordinarily caches the domain name and corresponding IP address for some period of time.</p>
<p id="p-0017" num="0016">Request <b>160</b> from Client A for content at “http://www.foxnews.com” illustrates an example of cached domain name resolution information. In this case, server <b>156</b> previously has received domain name resolution information for “www.foxnews.com” and therefore can respond <b>165</b> with an IP address “10.5.5.5” and does not need to query other DNS servers. For frequently requested domain names, it is likely that a DNS server within the hierarch will have cached the domain name resolution information and it will not be necessary to access an authoritative server. It is possible to bypass any DNS caching, and query only the authoritative name server for the domain name resolution information, but due to performance considerations, bypassing the caching information is relatively uncommon.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref> shows how the process follows a slightly different path when a client requests a domain name that no name server in its hierarchy recognizes. For example, a client in the “school.edu” domain makes a request <b>260</b> for a domain name in the “company.com” domain. In this particular case, the request <b>260</b> is for resolution of the domain name “private.company.com” <b>238</b>. For a variety of reasons, it is possible that none of the intermediary name servers <b>256</b>, <b>254</b>, <b>252</b>, and <b>250</b> will recognize the requested domain name <b>260</b> from their cache.</p>
<p id="p-0019" num="0018">Note that in <figref idref="DRAWINGS">FIG. 2</figref>, the example hierarchy does not show communication between the “.edu” DNS servers and the “.com” DNS servers. In practice, there is nothing to prevent one DNS server from communicating with another DNS server, provided the one server knows about the other. Accordingly, server <b>254</b> may be configured to query DNS server <b>234</b> for “.com” domain names, and so on. The particular hierarchy shown in <figref idref="DRAWINGS">FIG. 2</figref>, therefore, is only one example hierarchy that provides helpful context for describing the present invention, which is not restricted to any particular organization of DNS hierarchies.</p>
<p id="p-0020" num="0019">For request <b>260</b>, it is also possible that none of these intermediate name servers will recognize the authoritative name server <b>236</b> in their databases. In this case, the appropriate top-level name server “.edu” <b>250</b> or root name server <b>210</b> refers the request to a name server, e.g, <b>234</b>, in the “.com” <b>230</b> hierarchy based on the top-level portion of the domain name “private.company.com” request. Alternatively, the top-level name server “.com” <b>250</b>, root name server <b>210</b>, or any other intermediate name server, may simply recognize that the name server “ns.company.com” <b>236</b> is authoritative for the “company.com” domain, and relay the request to the appropriate authoritative name server <b>236</b>.</p>
<p id="p-0021" num="0020">Typically, authoritative name servers, do not base their domain name resolution response on the client requesting the IP address. In some circumstances, communication between DNS servers may have a security component, but secure communication of DNS information is not ordinarily based on the requesting client. As a result, “ns.company.com” <b>236</b> is not able to shield the IP address of “private.company.com” from some clients, but make it available to others.</p>
<p id="p-0022" num="0021">Nevertheless, for security reasons, an organization may not want DNS information available for certain servers. For example, “private.company.com” may operate as a gateway to a “company.com” private network or may be an internal server for “company.com” that may give hints to network topology, reveal project names, or otherwise disclose potentially sensitive information. If “ns.company.com” responds <b>265</b>, the IP address “10.1.1.1” may be cached at various intermediate DNS servers, such as “physics.school.edu” <b>256</b>, and become more widely known and accessible because “physics.school.edu” <b>256</b> and/or other intermediate domain name servers can then respond <b>267</b> with the IP address corresponding to “private.company.com” for requests from other clients. To guard against this security risk, many organizations prohibit domain name resolution for a server such as “private.company.com” and allow access only from within a private network or if a client knows the correct IP address.</p>
<p id="p-0023" num="0022">As described above, however, IP addresses are difficult to remember and subject to change. Accordingly, prohibiting domain name resolution as a security measure represents a significant burden for clients. What is needed, therefore, is a way of allowing only authorized clients to resolve certain domain names and receive the corresponding IP address, so that clients can resolve and access only those domain names for which the clients are authorized.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0024" num="0023">The present invention solves one or more of the foregoing problems by offering systems, methods, and computer program products for resolving a wide variety of DNS records, and particularly domain name resolution of certain domain names, based on client authentication. This provides authorized clients with the convenience of domain name resolution, while preserving security by keeping gateways to a private network confidential from unauthorized clients, such as those who may attempt to break through other security measures protecting the private network.</p>
<p id="p-0025" num="0024">In an example embodiment, an authoritative name server receives a request for domain name resolution from a client computer. The request for domain name resolution may include client authentication, or, alternatively, the authoritative name server may receive the client authentication at a later point. In either case, if the authoritative name server recognizes the received client authentication as valid, the authoritative server sends to the client the IP address corresponding to the requested domain name. Prior to authentication, the authoritative server responds that the requested domain name is unknown.</p>
<p id="p-0026" num="0025">The identity of the authoritative name server may be discovered by an iterative domain name query that bypasses DNS caching. Bypassing DNS caching assures that the query will eventually reach the authoritative name server for the requested domain name. When the client receives the response indicating that the domain name is unknown to the authoritative name server, the client may subsequently contact the authoritative name server and authenticate appropriately.</p>
<p id="p-0027" num="0026">These and other objects and features of the present invention will become more fully apparent from the following description and appended claims, or may be learned by the practice of the invention as set forth hereinafter.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0028" num="0027">To further clarify the above and other advantages and features of the present invention, a more particular description of the invention will be rendered by references to specific embodiments thereof, which are illustrated in the appended drawings. It is appreciated that these drawings depict only typical embodiments of the invention and are therefore not to be considered limiting of its scope. The invention will be described and explained with additional specificity and detail through the use of the accompanying drawings in which:</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIGS. 1 and 2</figref> illustrate prior art domain name resolution in an example domain name hierarchy.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a domain name resolution for an example domain name hierarchy in accordance with the present invention.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a flowchart depicting an example embodiment of the present invention.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 5</figref> illustrates an example system that provides a suitable operating environment for practicing the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0033" num="0032">The present invention extends to methods, systems, and computer program products for resolving a client-requested domain name so that the client can access only those domain names for which the client is authorized. The embodiments of the present invention may comprise a special purpose or general-purpose computer including various computer hardware, as discussed in greater detail below.</p>
<p id="p-0034" num="0033">Embodiments within the scope of the present invention also include computer-readable media for carrying or having computer-executable instructions or data structures stored thereon. Such computer-readable media can be any available media that can be accessed by a general purpose or special purpose computer. By way of example, and not limitation, such computer-readable media can comprise RAM, ROM, EEPROM, CD-ROM or other optical disc storage, magnetic disk storage or other magnetic storage devices, or any other medium which can be used to carry or store desired program code means in the form of computer-executable instructions or data structures and which can be accessed by a general purpose or special purpose computer. When information is transferred or provided over a network or another communications connection (either hardwired, wireless, or a combination of hardwired or wireless) to a computer, the computer properly views the connection as a computer-readable medium. Thus, any such connection is properly termed a computer-readable medium. Combinations of the above should also be included within the scope of computer-readable media. Computer-executable instructions comprise, for example, instructions and data which cause a general purpose computer, special purpose computer, or special purpose processing device to perform a certain function or group of functions.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an example embodiment of domain name resolution in accordance with the present invention. <figref idref="DRAWINGS">FIG. 3</figref> shows several root name servers, such as root <b>300</b>, root <b>310</b>, and root <b>315</b>, which may be geographically scattered over a number of worldwide zones. Each root server handles requests arising from one or more top-level domains. In <figref idref="DRAWINGS">FIG. 3</figref>, root <b>310</b> receives requests from top-level domains as “.org” <b>325</b>, “.com” <b>330</b>, “.edu” <b>350</b>, and “.net” <b>380</b>. Root server <b>310</b> can relay requests for “.com” domain names arising from the “.edu” hierarchy in the event that none of the intermediary “.edu” name servers (e.g., <b>356</b>, <b>354</b>, <b>352</b>, etc.) were able to resolve the request. Other root servers such as root <b>315</b> may handle other top-level domain names such as “.us”, “.ca” and “.uk” in a similar fashion. Of course, the hierarchy shown in <figref idref="DRAWINGS">FIG. 3</figref> is only one example hierarchy.</p>
<p id="p-0036" num="0035">In accordance with the present invention, Client A may request <b>360</b> domain name resolution for the domain name “private.company.com” <b>338</b>, for which domain name resolution is restricted in order to promote security. For example, “private.company.com” <b>338</b> may operate as a gateway to a “company.com” private network or may be an internal server for “company.com” that may give hints to network topology, reveal project names, or otherwise disclose potentially sensitive information. Accordingly, domain name resolution information for “private.company.com” may be hidden from some (e.g., unauthorized) clients. But, as described below, making domain name resolution information for “private.company.com” accessible to other (e.g., authorized) clients, may allow for increased remote access options that do not rely on more traditional virtual private networks (VPNs).</p>
<p id="p-0037" num="0036">Client A may make the request to resolve “private.company.com” <b>338</b>, for example, by typing the domain name in a web browser, initiating software to establish a virtual private network connection, or in some other way. Once Client A sends the request, no intermediary domain name servers in the “.edu” hierarchy <b>356</b>, <b>354</b>, <b>352</b> are able to resolve the domain name “private.company.com” <b>338</b> to a corresponding IP address. Each name server, therefore, forwards the request <b>360</b> along to the next appropriate name server (e.g. server <b>356</b> forwards to server <b>354</b>, then to <b>352</b>, etc.).</p>
<p id="p-0038" num="0037">Where none of the intermediate name servers recognizes an authoritative server for the request <b>360</b>, the top-level “.edu” name server <b>350</b> may recognize that the request should be forwarded to a name server in the top-level domain “.com” <b>330</b> hierarchy, or if the “.edu” name server <b>350</b> cannot recognize that the request <b>360</b> belongs in the “.com” hierarchy, then the “.edu” name server <b>350</b> will forward the address to the root name server <b>310</b>. The root name server <b>310</b> may then recognize that the request for “private.company.com” <b>338</b> should be forwarded to “.com” name server <b>330</b>, and may even recognize the authoritative name server <b>336</b> for the request <b>360</b>.</p>
<p id="p-0039" num="0038">Thus, the root name server <b>310</b> may relay the request to an additional name server <b>330</b>, <b>334</b>, or may relay the request directly to the “ns.company.com” <b>336</b> authoritative name server. If the root name server <b>310</b> were unable to determine an appropriate hierarchy or authoritative name server for the request <b>360</b>, the root name server <b>310</b> would relay a response back to the requesting client indicating that the domain name is unknown. This sort of processing may continue down the “.com” hierarchy until the request reaches the authoritative name server <b>336</b>.</p>
<p id="p-0040" num="0039">Once the authoritative name server <b>336</b> receives the domain name resolution request <b>360</b>, the authoritative name server checks the request for client authentication. Client authentication may come in many forms. For example, client authentication may comprise a device address, a device name or identification, a user name, a user name and password, a password, a digital signature, a specialized encryption form, and so on. In this case, client request <b>360</b> contains no authentication. Upon recognizing no valid client authentication, the authoritative name server <b>336</b> replies <b>365</b> to the client, for example, that authoritative name server “ns.company.com” <b>336</b> could not find the requested IP address for “private.company.com” <b>338</b>.</p>
<p id="p-0041" num="0040">This reply <b>365</b> travels back through the “.com” and “.edu” hierarchy of name servers until the name server “physics.school.edu” <b>356</b> relays an answer <b>367</b> to Client A. If the domain name had been resolved, traveling back through the hierarchy of name servers along the relay chain allows each name server to cache the resolution information from authoritative name server <b>336</b>. In this case, however, there is nothing to cache, since the reply <b>365</b> contains no domain name resolution information, which helps preserve the secrecy of this domain name.</p>
<p id="p-0042" num="0041">When Client A receives the response <b>367</b> that the request <b>360</b> for resolving “private.company.com” cannot be processed, Client A learns the identity of the authoritative name server “ns.company.com” <b>336</b> for “private.company.com” <b>338</b>. This allows Client A to request, using any of a variety of communication protocols, domain name resolution for “private.company.com” directly from the authoritative name server “ns.company.com” <b>336</b>. The request may involve secure (e.g., Secure Sockets Layer (SSL), Transport Layer Security (TLS), Internet Protocol Security (IPsec), etc.) or insecure communication protocols. Client A may include authentication with the request, separate from the request, or may receive a request for authentication from “ns.company.com” <b>336</b>.</p>
<p id="p-0043" num="0042">Upon receiving valid client authentication <b>340</b>, the authoritative name server “company.com” <b>336</b> may respond <b>345</b> directly to the requesting client <b>340</b> with domain name resolution information for “private.company.com” <b>338</b>. By requiring client authentication, however, the authoritative name server prevents unauthorized clients from resolving the domain name and learning the IP address of “private.company.com” <b>338</b>. Furthermore, since the authoritative name server <b>336</b> responds directly to the client, the authoritative name server prevents other domain name servers from caching the reply and resolving the domain name for other unauthorized clients indirectly. With a valid domain name address, subsequent requests (<b>3</b> and on) <b>370</b> can be sent directly (i.e., without any intervening DNS servers) to “private.company.com” <b>338</b>. It should be noted that the authoritative name server and/or “private.company.com” may operate in any of one or more capacities, including as a router, a firewall, a virtual private network gateway, a proxy server, a web server, a database server, a file server, an email server, etc.</p>
<p id="p-0044" num="0043">By way of clarification, <figref idref="DRAWINGS">FIG. 3</figref> shows that the authoritative name server <b>336</b> resolves the domain name “private.company.com” as the IP address 10.1.1.1. One should note, however, that 32-bit IP addresses beginning with 10.0.0.0. and ending with 10.255.255.255 (i.e., 10.1.1.1) are not typically valid IP address except in local or private networks. The IP address 10.1.1.1 is used merely out of convenience since it will not identify any present, generally requested domain name available over the Internet. Accordingly, one should appreciate that the authoritative name server <b>336</b> may reply with an appropriate IP address that may be valid outside of a local network, or that may be valid only inside a local network, depending on the location of the requesting client.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a flow chart in accordance with an example embodiment of the present invention. The present invention also may be described in terms of methods comprising functional steps and/or non-functional acts. Usually, functional steps describe the invention in terms of results that are accomplished, whereas non-functional acts describe more specific actions for achieving a particular result. Although the functional steps and non functional acts may be described or claimed in a particular order, the present invention is not necessarily limited to any particular ordering or combination of acts and/or steps.</p>
<p id="p-0046" num="0045">As shown, a client sends a request (<b>400</b>) to resolve a particular domain name to a domain name server. Typically, each domain name server receiving the request (often termed a DNS query) checks to see if the domain name resolution information is cached. If cached, the domain name server responds with the domain name resolution information, which then may be cached for a period of time at other domain name servers participating in the query. If the domain name resolution information is not cached, the request is forwarded to another domain name server in the hierarchy, unless the domain name server is authoritative for the requested domain name.</p>
<p id="p-0047" num="0046">As described above, an authoritative name server is responsible for maintaining domain name resolution information for a particular domain. Accordingly, an authoritative name server ordinarily is the final domain name server to which a request is forwarded. If an authoritative server does not have resolution information for a domain, the resolution information generally does not exist. Therefore, when a resolution request reaches an authoritative name server and the authoritative name server cannot resolve the domain name into a corresponding domain name address, the authoritative name server responds that the domain name is unknown or cannot be found.</p>
<p id="p-0048" num="0047">Clients may specify in the domain name resolution request to iterate through intermediate domain name servers until either a cache entry is found, or the authoritative name server is found. In accordance with the present invention, the client may not know which name server is authoritative for a domain name of interest. To maintain compatibility with traditional domain name servers, therefore, the client's request specifies that the domain name system should discover the name mapping through its iterative mechanism. Again, for compatibility reasons, this request may not include client authentication.</p>
<p id="p-0049" num="0048">Each domain name server receiving the request determines (<b>410</b>) if it has a cached entry for the requested domain name. If not, the domain name server determines (<b>430</b>) if there is an additional domain name server to which the query should be forwarded. Where no additional domain name servers are available to ask, the domain name server responds (<b>435</b>) that the domain name is unknown. If an additional domain name server is available, then the next domain name server receives (<b>415</b>) the request.</p>
<p id="p-0050" num="0049">When the request reaches an authoritative name server (yes branch of decision block <b>410</b>), the authoritative name server checks (<b>420</b>) to see if the client has authenticated. A step for authenticating a client may include acts of requesting authentication from the client, establishing or allowing a direct connection (secure or insecure) with the client, receiving client authentication from a client, sending a response to the client that a domain name is unknown, and the like. If the client has not authenticated, the authoritative name server responds (<b>435</b>) that the domain name is unknown. Note, however, that the response that the domain name is unknown identifies the authoritative name server so that the client can discover the authoritative name server without initially knowing the authoritative name server.</p>
<p id="p-0051" num="0050">Of course, the authoritative name server may act as a traditional domain name server as well. Accordingly, the authoritative name server may receive requests for domain names that can be resolved without client authentication and resolve these domain names as requested, whereas access to domain name resolution for other, restricted domain names may only occur with proper client authentication.</p>
<p id="p-0052" num="0051">Therefore, a step for responding to one or more unauthenticated clients may include acts of determining that a client is not authorized to receive a domain name address corresponding to a requested domain name and sending a response to an unauthenticated client that the domain name is unknown. A step for responding to unauthenticated clients further may include an act of sending a response identifying a domain name address for a public domain name (i.e., one that is unrestricted and does not require client authentication) and sending the domain name to an unauthenticated client.</p>
<p id="p-0053" num="0052">Requiring authentication for certain domain names allows for the convenience of domain name resolution (e.g., clients do not need to know domain name addresses, such as IP addresses, which can be difficult to remember and are subject to change) without necessarily making this information generally available (which is a significant security measure). As a result, domain names for servers internal to a private network can be kept confidential, except for those clients who properly authenticate. Often, such domain names convey information about a networks configuration, may identify of projects, or otherwise represent sensitive information that should not be available to unauthorized requestors.</p>
<p id="p-0054" num="0053">Furthermore, basing domain name resolution on client authorization allows an authoritative name server to provide different or custom resolution responses to different clients. For example, requests from a client in one department of a business may receive one resolution response, whereas a client in another department receives a different resolution response. It should be appreciated that this resolution process applies easily to a wide variety of DNS records, and not just those relating to protecting a network computer's identity, such a domain name to address resolution.</p>
<p id="p-0055" num="0054">The authoritative name server may request client authentication, or upon receiving the response that a requested domain name is unknown, the client may send authentication to the authoritative server. Because client authentication typically includes sensitive information, the client may establish a direct connection with the authoritative server using a secure communication protocol, such as SSL, TLS, IPsec, etc. Client authentication also may be included in the request.</p>
<p id="p-0056" num="0055">If the authoritative name server determines (<b>440</b>) that the client authentication is not valid, the authoritative name server responds (<b>435</b>) that the domain name is unknown. The authoritative name server may respond that the client authentication is invalid, but this provides information about the authoritative server, which for some implementation may be undesirable. For example, disclosing that the authoritative name server expects credentials may make it the focus of an attack.</p>
<p id="p-0057" num="0056">If the authoritative name server determines (<b>440</b>) that the client authentication is valid, the authoritative name server responds (<b>445</b>) with the domain name address for the requested domain name. Therefore, a step for responding to one or more authenticated clients may include acts of determining that a client is authorized to received a domain name address for a requested domain name and sending the domain name address to the authorized client.</p>
<p id="p-0058" num="0057">With the domain name address, the client can establish a connection with the server of interest. Naturally, a variety of other security measures, such as those typically implemented for accessing any server, are likely to be in place and can coexist with the selective domain name resolution of the present invention. The server for the requested domain name and the authoritative name server may operate in a number of capacities, including as a router, a firewall, a virtual private network gateway, a proxy server, a web server, a database server, a file server, an email server, and the like.</p>
<p id="p-0059" num="0058">The request to resolve a domain name described above involves a slight security risk—the domain name is identified in the request and therefore is accessible to eavesdroppers. As an added measure of protection, the actual domain name may be maintained in confidence by identifying the authoritative name server for the domain name prior to making a request to resolve the actual domain name. In one example embodiment, a request to resolve a non-existent domain name is used to identify the authoritative name server. Consider, for example, a request to resolve non-existent.company.com to its corresponding domain name address. When this query eventually reaches an authoritative name server, such as ns.company.com, the authoritative name server will respond that the domain name is unknown, but the response will identify ns.company.com as the authoritative name server.</p>
<p id="p-0060" num="0059">Alternatively, the client may ask explicitly for the name server record for company.com, which should represent little or no security risk, using traditional resolution techniques, and then perform additional resolution over a secure connection. For example, in order to resolve a domain name, such as secrethost.secretdepartment.company.com, the client first asks for the name server record for company.com, which identifies ns1.company.com as a name server. The client then securely connects to ns1.company.com and requests the name server record for secretdepartment.company.com, which identifies ns2.company.com as a name server. Finally, the client requests resolution (e.g. the address record) of secrethost.secretdepartment.company.com from ns2.company.com over a secure connection.</p>
<p id="p-0061" num="0060">Whether domain name resolution occurs over a secure connection or an insecure connection may be a configuration option at the client. In an example implementation, a client may be configured to request all, none, or a portion of its domain name resolution requests over a secure connection. For example, to enhance compatibility with traditional domain name resolution, the client may be configured to use secure domain name resolution for particular domains or sub-domains known to support the present invention. Domain name resolution for other (unspecified) domains uses an insecure form of communication. These examples should not be interpreted as excluding other configuration mechanisms for specifying secure domain name resolution.</p>
<p id="p-0062" num="0061">It should be noted that name server records (i.e., domain name system records that identify name servers for a domain name) and address records (i.e., domain name system records that identify a domain name address for a particular domain name) represent examples of Domain Name System (DNS) records. As indicated above, however, the present invention is not necessarily limited to any particular type of DNS record.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 5</figref> and the following discussion are intended to provide a brief, general description of a suitable computing environment in which the invention may be implemented. Although not required, the invention will be described in the general context of computer-executable instructions, such as program modules, being executed by computers in network environments. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. Computer-executable instructions, associated data structures, and program modules represent examples of the program code means for executing steps of the methods disclosed herein. The particular sequence of such executable instructions or associated data structures represents examples of corresponding acts for implementing the functions described in such steps.</p>
<p id="p-0064" num="0063">Those skilled in the art will appreciate that the invention may be practiced in network computing environments with many types of computer system configurations, including personal computers, hand-held devices, multi-processor systems, microprocessor-based or programmable consumer electronics, network PCs, minicomputers, mainframe computers, and the like. The invention may also be practiced in distributed computing environments where local and remote processing devices perform tasks and are linked (either by hardwired links, wireless links, or by a combination of hardwired or wireless links) through a communications network. In a distributed computing environment, program modules may be located in both local and remote memory storage devices.</p>
<p id="p-0065" num="0064">With reference to <figref idref="DRAWINGS">FIG. 5</figref>, an exemplary system for implementing the invention includes a general-purpose computing device in the form of a conventional computer <b>520</b>, including a processing unit <b>521</b>, a system memory <b>522</b>, and a system bus <b>523</b> that couples various system components including the system memory <b>522</b> to the processing unit <b>521</b>. The system bus <b>523</b> may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. The system memory includes read only memory (ROM) <b>524</b> and random access memory (RAM) <b>525</b>. A basic input/output system (BIOS) <b>526</b>, containing the basic routines that help transfer information between elements within the computer <b>520</b>, such as during start-up, may be stored in ROM <b>524</b>.</p>
<p id="p-0066" num="0065">The computer <b>520</b> may also include a magnetic hard disk drive <b>527</b> for reading from and writing to a magnetic hard disk <b>539</b>, a magnetic disk drive <b>528</b> for reading from or writing to a removable magnetic disk <b>529</b>, and an optical disc drive <b>530</b> for reading from or writing to removable optical disk <b>531</b> such as a CD ROM or other optical media. The magnetic hard disk drive <b>527</b>, magnetic disk drive <b>528</b>, and optical disc drive <b>530</b> are connected to the system bus <b>523</b> by a hard disk drive interface <b>532</b>, a magnetic disk drive-interface <b>533</b>, and an optical drive interface <b>534</b>, respectively. The drives and their associated computer-readable media provide nonvolatile storage of computer-executable instructions, data structures, program modules and other data for the computer <b>520</b>. Although the exemplary environment described herein employs a magnetic hard disk <b>539</b>, a removable magnetic disk <b>529</b> and a removable optical disc <b>531</b>, other types of computer readable media for storing data can be used, including magnetic cassettes, flash memory cards, digital versatile disks, Bernoulli cartridges, RAMs, ROMs, and the like.</p>
<p id="p-0067" num="0066">Program code means comprising one or more program modules may be stored on the hard disk <b>539</b>, magnetic disk <b>529</b>, optical disk <b>531</b>, ROM <b>524</b> or RAM <b>525</b>, including an operating system <b>535</b>, one or more application programs <b>536</b>, other program modules <b>537</b>, and program data <b>538</b>. A user may enter commands and information into the computer <b>520</b> through keyboard <b>540</b>, pointing device <b>542</b>, or other input devices (not shown), such as a microphone, joy stick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to the processing unit <b>521</b> through a serial port interface <b>546</b> coupled to system bus <b>523</b>. Alternatively, the input devices may be connected by other interfaces, such as a parallel port, a game port or a universal serial bus (USB). A monitor <b>547</b> or another display device is also connected to system bus <b>523</b> via an interface, such as video adapter <b>548</b>. In addition to the monitor, personal computers typically include other peripheral output devices (not shown), such as speakers and printers.</p>
<p id="p-0068" num="0067">The computer <b>520</b> may operate in a networked environment using logical connections to one or more remote computers, such as remote computers <b>549</b><i>a </i>and <b>549</b><i>b. </i>Remote computers <b>549</b><i>a </i>and <b>549</b><i>b </i>may each be another personal computer, a server, a router, a network PC, a peer device or other common network node, and typically include many or all of the elements described above relative to the computer <b>520</b>, although only memory storage devices <b>550</b><i>a </i>and <b>550</b><i>b </i>and their associated application programs <b>536</b><i>a </i>and <b>536</b><i>b </i>have been illustrated in <figref idref="DRAWINGS">FIG. 5</figref>. The logical connections depicted in <figref idref="DRAWINGS">FIG. 5</figref> include a local area network (LAN) <b>551</b> and a wide area network (WAN) <b>552</b> that are presented here by way of example and not limitation. Such networking environments are commonplace in office-wide or enterprise-wide computer networks, intranets and the Internet.</p>
<p id="p-0069" num="0068">When used in a LAN networking environment, the computer <b>520</b> is connected to the local network <b>551</b> through a network interface or adapter <b>553</b>. When used in a WAN networking environment, the computer <b>520</b> may include a modem <b>554</b>, a wireless link, or other means for establishing communications over the wide area network <b>552</b>, such as the Internet. The modem <b>554</b>, which may be internal or external, is connected to the system bus <b>523</b> via the serial port interface <b>546</b>. In a networked environment, program modules depicted relative to the computer <b>520</b>, or portions thereof, may be stored in the remote memory storage device. It will be appreciated that the network connections shown are exemplary and other means of establishing communications over wide area network <b>552</b> may be used.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. In an authoritative name server configured to resolve one or more domain names, a method of selectively resolving a domain name so that a client requesting resolution of the domain name receives a domain name system response based on the client's authorization, the method comprising acts of:
<claim-text>at an authoritative name server, receiving, from a client, a first request to resolve a domain name into a corresponding domain name system response, the authoritative name server receiving the first request being capable of resolving the domain name into the corresponding domain name system response;</claim-text>
<claim-text>at the authoritative name server, sending, to the client, a first response identifying the authoritative name server sending the first response and indicating that the authoritative name server was unable to retrieve the requested domain name system response corresponding to the domain name;</claim-text>
<claim-text>at the authoritative name server, receiving, from the client, a subsequent request to resolve the domain name into a corresponding domain name system response, and the subsequent request having been sent by the client in response to the first response indicating that the authoritative name server was unable to retrieve the requested domain name system response;</claim-text>
<claim-text>at the authoritative name server, receiving client authentication from the client;</claim-text>
<claim-text>based on the received client authentication, determining at the authoritative name server that the client is authorized to receive the domain name response corresponding to the domain name; and</claim-text>
<claim-text>sending the corresponding domain name system response to the client.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a plurality of domain name system responses correspond to the first resolution request received from the client, the method further comprising an act of selecting the domain name system response sent to the client based on the received client authentication.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the authoritative name server receives client authentication over a secure connection with the client.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the first request to resolve a domain name comprises a request to resolve at least one domain name into at least one domain name address, and wherein the corresponding domain name system response sent to the client comprises one or more domain name addresses corresponding to the at least one domain name.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the first request to resolve the at least one domain name is received without client authentication.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the first request is received from the client through an intermediate domain name server capable of resolving one or more other domain names into one or more other domain name addresses.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the at least one domain name identifies at least one of router, a gateway, a firewall, or a proxy server for a private network.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the at least one domain name identifies at least one of a web server, a database server, a file server, or an email server for a private network.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the authoritative name server operates as one or more of a router, a firewall, a virtual private network gateway, a proxy server, a web server, a database server, a file server, or an email server.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A computer program product comprising one or more computer readable storage media having stored thereon computer executable instructions that, when executed on suitable computing equipment, implement a method of selectively resolving a domain name so that a client requesting resolution of the domain name receives a domain name system response based on the client's authorization, the method being that of <claim-ref idref="CLM-00001">claim 1</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the authoritative name server receives the subsequent request from the client through a direct connection.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the authoritative name server receives client authentication over a secure connection with the client.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the initial request to resolve the domain name is received without client authentication.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer program product of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the initial request is received from the client through an intermediate domain name server capable of resolving one or more other domain names into one or more other domain name addresses.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the authoritative name server operates as one or more of a router, a firewall, a virtual private network gateway, a proxy server, a web server, a database server, a file server, or an email server.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the domain name identifies at least one of router, a gateway, a firewall, or a proxy server for a private network.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the domain name identifies at least one of a web server, a database server, a file server, or an email server for a private network.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, the method further comprising acts of:
<claim-text>at an authoritative name server, receiving, from another client, a request to resolve a public domain name into one or more corresponding domain name addresses, wherein the request fails to include client authentication for the other client;</claim-text>
<claim-text>identifying the corresponding one or more domain name addresses corresponding to the public domain name; and</claim-text>
<claim-text>sending the corresponding one or more domain name addresses to the other client.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer program product of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein authoritative name server is not authoritative for the public domain name.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. In an authoritative name server configured to resolve one or more domain name system records, a method of selectively resolving a domain name system record so that a client requesting resolution of the domain name system record receives a domain name system response based on the client's authorization, the method comprising acts of:
<claim-text>at an authoritative name server, receiving, from a client, a first request to resolve a domain name system record into a corresponding domain name system response, the authoritative name server receiving the first request being capable of resolving the domain name system record into the corresponding domain name system response, and the first request being received via a first communication path;</claim-text>
<claim-text>at the authoritative name server, sending, to the client, a first response identifying the authoritative name server sending the first response and indicating that the authoritative name server was unable to retrieve the requested domain name system response corresponding to the domain name system record;</claim-text>
<claim-text>at the authoritative name server, receiving, from the client, a second request to resolve the domain name system record into a corresponding domain name system response, the second request having been made via a second communication path, and the second request having been sent by the client in response to the first response indicating that the authoritative name server was unable to retrieve the requested domain name system response;</claim-text>
<claim-text>at the authoritative name server, receiving client authentication from the client;</claim-text>
<claim-text>based on the received client authentication, determining at the authoritative name server that the client is authorized to receive the domain name response corresponding to the domain name system record; and</claim-text>
<claim-text>sending the corresponding domain name system response to the client;</claim-text>
<claim-text>wherein the first communication path over which the authoritative name server receives the first request includes a path through one or more domain name cache servers, and wherein the second communication path bypasses the one or more domain name cache servers for a direct connection between the client and the authoritative name server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. In a client capable of establishing a connection with an authoritative name server that resolves at least one domain name into at least one domain name address, wherein the authoritative name server only resolves domain names into the corresponding domain name addresses for authorized clients, a method of requesting, from the authoritative name server, a domain name address that corresponds to a domain name, the method comprising acts of:
<claim-text>a client sending an initial request, to resolve a domain name into a corresponding domain name address, to an authoritative name server capable of resolving the domain name into the domain name address, the initial request being sent without client authentication;</claim-text>
<claim-text>the client receiving an initial response from the authoritative name server indicating that the domain name address is unknown to the authoritative name server;</claim-text>
<claim-text>determining, by the client, that client authentication is needed to receive the domain name address from the authoritative name server;</claim-text>
<claim-text>sending to the authoritative name server a subsequent request, the subsequent request including client authentication, to resolve the domain name into the corresponding domain name address; and</claim-text>
<claim-text>in response to having sent the subsequent request including client authentication, receiving the corresponding domain name address in a subsequent response sent from the authoritative name server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the subsequent request is sent through a secure connection.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein determining that client authentication is needed comprises an act of the client receiving a request for the client authentication from the authoritative name server.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the client and the authoritative name server are connected to a common private network.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the authoritative name server functions as a gateway computer on one or more of a home, or an organizational network.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The method of <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the gateway computer functions further as one or more of a router, a firewall, a virtual private network, a proxy server, a web server, a database server, a file server, or an email server.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the domain name identifies at least one of a router, a firewall, a virtual private network gateway, a proxy server, a web server, a database server, a file server, or an email server for a private network.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. A computer program product comprising one or more computer readable storage media having stored thereon computer executable instructions that, when executed on suitable computing equipment, implements a method of requesting, from an authoritative name server, a domain name address that corresponds to a domain name, the method being that of <claim-ref idref="CLM-00021">claim 21</claim-ref>.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The computer program product of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the subsequent request is sent through a secure connection.</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The computer program product of <claim-ref idref="CLM-00028">claim 28</claim-ref>, the method further comprising an act of the client receiving a request for the client authentication from the authoritative name server.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The computer program product of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the client and the authoritative name server are connected to a common private network.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The computer program product of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the authoritative name server functions as a gateway computer on one or more of a home, or an organizational network.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The computer program product of <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein the gateway computer functions further as one or more of a router, a firewall, a virtual private network, a proxy server, a web server, a database server, a file server, or an email server.</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The computer program product of <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein the domain name identifies at least one of a router, a firewall, a virtual private network gateway, a proxy server, a web server, a database server, a file server, or an email server for a private network.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. The method of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein determining that client authentication is needed to receive the domain address from the authoritative server comprises the client determining that the received initial response was from an authoritative name server capable of translating the domain name into the domain name address.</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. In a client capable of establishing a connection with an authoritative name server that resolves at least one domain name into at least one domain name address, wherein the authoritative name server only resolves domain names into the corresponding domain name addresses for authorized clients, a method of requesting, from the authoritative name server, a domain name address that corresponds to a domain name, the method comprising acts of:
<claim-text>a client sending an initial request, to resolve a domain name into a corresponding domain name address, to an authoritative name server capable of resolving the domain name into the domain name address, the initial request being sent without client authentication;</claim-text>
<claim-text>the client receiving an initial response from the authoritative name server indicating that the domain name address is unknown to the authoritative name server;</claim-text>
<claim-text>in response to receiving the initial response indicating that the domain name address is unknown to the authoritative name server, the client establishing a direct connection with the authoritative name server;</claim-text>
<claim-text>determining, by the client, that client authentication is needed to receive the domain name address from the authoritative name server;</claim-text>
<claim-text>sending, by the client, client authentication to the authoritative name server over the direct connection;</claim-text>
<claim-text>sending a subsequent request, to resolve the domain name into the corresponding domain name address, to the authoritative name server; and</claim-text>
<claim-text>in response to having sent client authentication, receiving the corresponding domain name address in a subsequent response sent from the authoritative name server;</claim-text>
<claim-text>wherein the initial request is directed through a domain name server to the authoritative name server because the authoritative name server is unknown, the domain name server identifying the authoritative name server and directing the initial request to the authoritative name server, the method further comprising an act of the client discovering the authoritative name server from the initial response from the authoritative name server indicating that the domain name address is unknown.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. In an authoritative name server configured for resolving domain name addresses, a method for selectively resolving one or more client-requested domain names so that the client receives one or more corresponding domain name addresses only if the client is authorized, the method comprising steps for:
<claim-text>for one or more unauthenticated requests, originating from one or more unauthenticated clients, to resolve one or more domain names, an authoritative name server capable of resolving the one or more domain names into corresponding one or more domain name addresses responding to the one or more unauthenticated clients that the one or more domain name addresses are unknown because the one or more unauthenticated clients have not provided client authentication to the authoritative name server;</claim-text>
<claim-text>in response to the one or more unauthenticated requests originating from the one or more unauthenticated clients, receiving one or more subsequent requests over a direct connection with the one or more unauthenticated clients</claim-text>
<claim-text>receiving, by the authoritative name server, client authentication such that the one or more subsequent requests are one or more authenticated requests; and</claim-text>
<claim-text>for the one or more authenticated requests originating from one or more authenticated clients, to resolve the one or more domain names, the authoritative name server responding to the one or more authenticated clients with one or more domain name addresses corresponding to the one or more domain names because the one or more authenticated clients provided client authentication to the authoritative name server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The method of <claim-ref idref="CLM-00037">claim 37</claim-ref>, further comprising a step for authenticating the authenticated clients over a secure connection.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. The method of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the one or more unauthenticated clients and the one or more authenticated clients are the same one or more clients.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The method of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the one or more unauthenticated requests are received from the one or more unauthenticated clients through one or more intermediate domain name servers capable of resolving a plurality of other domain names into a plurality of other domain name addresses.</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. The method of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the one or more authenticated clients are external to a private network and the one or more domain names identify one or more servers internal to the private network.</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. The method of <claim-ref idref="CLM-00041">claim 41</claim-ref>, wherein the one or more domain names identify at least one a web server, a database server, a file server, or an email server within the private network.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. For a client capable of establishing a connection with an authoritative name server that resolves at least one domain name into at least one domain name address, wherein the authoritative name server only resolves domain names into the corresponding domain name addresses for authorized clients, a computer program product comprising one or more computer readable storage media having stored thereon computer executable instructions that implement a method of requesting, from the authoritative name server, a domain name address that corresponds to a domain name, the method comprising acts of:
<claim-text>a client sending an initial request, to resolve a domain name into a corresponding domain name address, to an authoritative name server capable of resolving the domain name into the domain name address, the initial request being sent without client authentication;</claim-text>
<claim-text>the client receiving an initial response from the authoritative name server indicating that the domain name address is unknown to the authoritative name server capable of resolving the domain name into the domain name address;</claim-text>
<claim-text>in response to receiving the initial response indicating that the domain name address is unknown to the authoritative name server, the client establishing a direct connection with the authoritative name server;</claim-text>
<claim-text>determining, by the client, that client authentication is needed to receive the domain name address from the authoritative name server;</claim-text>
<claim-text>sending, by the client, client authentication to the authoritative name server over the direct connection;</claim-text>
<claim-text>sending a subsequent request; to resolve the domain name into the corresponding domain name address, to the authoritative name server; and</claim-text>
<claim-text>in response to having sent client authentication, receiving the corresponding domain name address in a subsequent response sent from the authoritative name server;</claim-text>
<claim-text>wherein the initial request is directed through a domain name server to the authoritative name server because the authoritative name server is unknown, the domain name server identifying the authoritative name server and directing the initial request to the authoritative name server, the method further comprising an act of the client discovering the authoritative name server from the initial response from the authoritative name server indicating that the domain name address is unknown.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. In a client capable of establishing a connection with one or more name servers that resolve at least one domain name into at least one domain name address, wherein at least one name server resolves domain name system records based on client authentication, a method of requesting one or more domain name addresses for one or more domain names, the method comprising acts of:
<claim-text>identifying an authoritative name server for a domain of interest, wherein the authoritative name server for the domain of interest is identified to the client in a message from the authoritative name server which indicates that the authoritative name server could not find a domain address for the domain of interest;</claim-text>
<claim-text>in response to receiving the message indicating that the authoritative name server could not find the domain name address for the domain of interest, establishing a secure connection with the authoritative name server;</claim-text>
<claim-text>sending client authentication to the authoritative name server over the secure connection;</claim-text>
<claim-text>requesting, from the authoritative name server, one or more domain name addresses for one or more domain names; and</claim-text>
<claim-text>based on the client authentication, receiving from the authoritative name server at least one domain name address for the one or more domain names.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. The method of <claim-ref idref="CLM-00044">claim 44</claim-ref>, wherein the client authentication is sent with the request.</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. The method of <claim-ref idref="CLM-00044">claim 44</claim-ref>, wherein identifying the authoritative name server comprises an act of requesting a name server record for the domain of interest.</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. The method of <claim-ref idref="CLM-00046">claim 46</claim-ref>, wherein the domain of interest comprises a sub-domain of a higher-level domain, the method further comprising an act of requesting the name server record for the domain of interest from a name server for the higher-level domain.</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. The method of <claim-ref idref="CLM-00047">claim 47</claim-ref>, wherein the request to the name server for the higher-level domain occurs over a secure connection.</claim-text>
</claim>
<claim id="CLM-00049" num="00049">
<claim-text>49. The method of <claim-ref idref="CLM-00048">claim 48</claim-ref>, further comprising an act of requesting a name server record for the higher-level domain to identify the name server for the higher-level domain.</claim-text>
</claim>
<claim id="CLM-00050" num="00050">
<claim-text>50. The method of <claim-ref idref="CLM-00044">claim 44</claim-ref>, wherein identifying the authoritative name server comprises an act of requesting domain name resolution for a non-existent domain name.</claim-text>
</claim>
<claim id="CLM-00051" num="00051">
<claim-text>51. The method of <claim-ref idref="CLM-00044">claim 44</claim-ref>, wherein the client is configured to request the one or more domain name addresses for the one or more domain names using a secure form of communication.</claim-text>
</claim>
<claim id="CLM-00052" num="00052">
<claim-text>52. The method of <claim-ref idref="CLM-00051">claim 51</claim-ref>, wherein the client is configured to request one or more other domain name addresses for one or more other domain names using an insecure form of communication.</claim-text>
</claim>
<claim id="CLM-00053" num="00053">
<claim-text>53. The method of <claim-ref idref="CLM-00052">claim 52</claim-ref>, wherein the client configuration to use a secure form of communication or an insecure form of communication is domain specific.</claim-text>
</claim>
</claims>
</us-patent-grant>
