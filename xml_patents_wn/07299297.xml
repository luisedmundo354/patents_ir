<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299297-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299297</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10175463</doc-number>
<date>20020619</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1058</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>16</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>173</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>Q</subclass>
<main-group>30</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>56</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>709240</main-classification>
<further-classification>709238</further-classification>
<further-classification>705 26</further-classification>
<further-classification>37039521</further-classification>
</classification-national>
<invention-title id="d0e53">Method and apparatus for protecting electronic commerce from distributed denial-of-service attacks</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6073175</doc-number>
<kind>A</kind>
<name>Tavs et al.</name>
<date>20000600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709226</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6115390</doc-number>
<kind>A</kind>
<name>Chuah</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370443</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6167445</doc-number>
<kind>A</kind>
<name>Gai et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6459682</doc-number>
<kind>B1</kind>
<name>Ellesson et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370235</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6519636</doc-number>
<kind>B2</kind>
<name>Engel et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709223</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6567406</doc-number>
<kind>B1</kind>
<name>Skemer</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370392</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6668046</doc-number>
<kind>B1</kind>
<name>Albal</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>379119</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6725378</doc-number>
<kind>B1</kind>
<name>Schuba et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 13</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6751668</doc-number>
<kind>B1</kind>
<name>Lin et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709227</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6826616</doc-number>
<kind>B2</kind>
<name>Larson et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709228</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6839759</doc-number>
<kind>B2</kind>
<name>Larson et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709228</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6940862</doc-number>
<kind>B2</kind>
<name>Goudreau</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>37039552</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>7046680</doc-number>
<kind>B1</kind>
<name>McDysan et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370396</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>2002/0146018</doc-number>
<kind>A1</kind>
<name>Kailamaki et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370401</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>2002/0194251</doc-number>
<kind>A1</kind>
<name>Richter et al.</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709105</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>WO</country>
<doc-number>WO 00/303/7</doc-number>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>A. Odlyzko, “Paris Metro Pricing for the Internet”, Proc. ACM Conference on Electronic Commerce (EC99), ACM, 1999, pp. 140-147.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>R. Braden, et al., “Integrated Services in the Internet Architecture: an Overview,” IETF, RFC 1633, Jun. 1994.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>S. Blake, et al., “An Architecture for Differentiated Services,” IETF, RFC 2475, Dec. 1998.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>P. Ferguson, et al., “Network Ingress Filtering: Defeating Denial of Service Attacks Which Employ IP Source Address Spoofing”, IETF, RFC 2827 (also BCP 0038), May 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>S. Savage, et al., “Practical Network Support for IP Traceback”, Proc. SIGCOMM'2000, pp. 295-306, ACM, Stockholm, Sweden, Aug. 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00022">
<othercit>J. Bruno, et al., “Retrofitting Quality of Service into a Time-Sharing Operating System”, Proc. Annual Tech. Conf., USENIX, Jun. 1999. pp. 15-26.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00023">
<othercit>“Characterizing and Tracing Packet Floods Using Cisco Routers,” Cisco, available at http://www.cisco.com/warp/public/70722.html.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00024">
<othercit>Andrew Odlyzko, “Paris Metro Pricing for the Internet”, <i>Proceedings of 1</i><sup>st </sup><i>ACM Conference on Electronic Commerce</i>, Denver, CO, (Nov. 3-5, 1999), pp. 140-147.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00025">
<othercit>European Search Report.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>6</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>709207</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709227</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709228</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709235</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370229</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370320</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3702301</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370231</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370351</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37039521</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3703953</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370238</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370223</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370227</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>705 26</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60313031</doc-number>
<kind>00</kind>
<date>20010816</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20030036970</doc-number>
<kind>A1</kind>
<date>20030220</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Brustoloni</last-name>
<first-name>Jose′  C</first-name>
<address>
<city>Westfield</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Gurey</last-name>
<first-name>Stephen M.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Lucent Technologies Inc.</orgname>
<role>02</role>
<address>
<city>Murray Hill</city>
<state>NJ</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Najjar</last-name>
<first-name>Saleh</first-name>
<department>2155</department>
</primary-examiner>
<assistant-examiner>
<last-name>Korobov</last-name>
<first-name>Vitali</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An Internet Service Provider (ISP), in consideration of being remunerated in some manner by an e-merchant, carries the packets of a designated subset of that e-merchant's clients, designated as VIPs, in a privileged class of service as compared to an unprivileged class of service that is used to carry the packets of the e-merchant's other regular clients. In this way, the adverse effects on performance due to congestion in the unprivileged class of service, whether due to an ongoing denial-of-service attack or not, will not affect the performance of packets sent by and to VIPs using the privileged class of service. An e-merchant may select its VIPs from among those clients that bring in a majority of the e-merchant's revenues. An e-merchant turns a regular client into a VIP by granting it a VIP right. VIP gates, preferable implemented in an ISP's access gateways, monitor the packets sent by clients and mark for the privileged class of service those packets whose source has an active VIP right issued by the packet's destination.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="146.98mm" wi="198.20mm" file="US07299297-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="198.80mm" wi="156.21mm" orientation="landscape" file="US07299297-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="227.67mm" wi="130.05mm" file="US07299297-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="215.82mm" wi="168.32mm" orientation="landscape" file="US07299297-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="250.27mm" wi="158.16mm" orientation="landscape" file="US07299297-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims benefit of U.S. provisional application Ser. No. 60/313,031 filed Aug. 16, 2001, which is herein incorporated by reference.</p>
<p id="p-0003" num="0002">This application is also related to co-pending U.S. patent applications filed simultaneously herewith entitled: “METHOD AND APPARATUS FOR INCREMENTALLY DEPLOYING INGRESS FILTERING ON THE INTERNET”, Ser. No. 10/175,577, and “METHOD AND APPARATUS FOR PROTECTING WEB SITES FROM DISTRIBUTED DENIAL-OF-SERVICE ATTACKS”, Ser. No. 10/175,458.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0004" num="0003">This invention relates to communications over the Internet, and more particularly, to protecting servers on the Internet from malicious attacks that can partially or totally disrupt service.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0005" num="0004">In a denial-of-service (DoS) attack, a malicious client (called the attacker) performs operations designed to partially or completely prevent legitimate clients from communicating with or gaining service from a server (called the victim). DoS attacks are common and cause significant losses. Well-known e-merchants, including Amazon, buy.com, E*Trade, and eBay, are among recent victims. DoS attacks can harm e-merchants in two ways. First, when an e-merchant cannot serve its customers, the e-merchant loses advertising and sales revenues. Second, the e-merchant's clients, advertisers, and investors are frustrated and may therefore seek competing alternatives.</p>
<p id="p-0006" num="0005">Some DoS attacks can be prevented by proper system administration. These include physical or remote takeover attacks and death-pill attacks. In a physical takeover attack, the attacker gains physical access to components of the Internet Service Provider (ISP) or e-merchant infrastructure (e.g., one or more links, routers, or servers) and compromises their functionality. In a remote takeover attack, the attacker exploits some bug in the infrastructure's software so as to gain privileged access and thus be able to modify the software remotely. In a death-pill attack the attacker sends one or a few packets to an infrastructure component (e.g., router or server) known to contain a bug, such that the packets cause the component to crash. Proper ISP and e-merchant physical security can eliminate physical takeover attacks. Likewise, prompt installation of patches or updates that fix software bugs can prevent future remote takeover or death-pill attacks exploiting those bugs.</p>
<p id="p-0007" num="0006">On the contrary, congestive DoS attacks cannot be similarly prevented. In a congestive attack, an attacker floods a server with so many packets that the server is unable to respond to requests sent by legitimate clients. Four factors make it difficult to defend against congestive attacks. First, any host connected to the Internet can be used to sustain a congestive attack against any victim also connected to the Internet. By design, the Internet will forward packets from any host to any other host on a best-effort basis, without bounding packet rate or volume. Second, there are many hosts (e.g., in homes and universities) that are connected to the Internet and do not have the benefit of proper system administration. Such hosts often contain bugs or are configured in such a way that attackers can, without authorization, use them as agents, i.e., as the hosts that actually send attack packets to a victim. Agents provide cloaking and leverage to an attacker, i.e., respectively, hide the attacker's identity and multiply the attacker's resources (e.g., bandwidth). Third, attackers can spoof attack packets, i.e., falsify the packets' source addresses. Spoofing is possible because the Internet does not validate source addresses. Spoofing further enhances an attacker's cloaking. Finally, automated tools of increasing sophistication for mounting DoS attacks can be easily downloaded from the Web. Using such tools, even unskilled Web users can mount successful attacks.</p>
<p id="p-0008" num="0007">The two currently most popular DoS attack techniques, smurf and TCP SYN flooding, are both congestive. In a smurf attack, the attacker sends ICMP echo requests to a network's broadcast address. The attacker spoofs the requests with the victim's address. Therefore, each host in the network sends a reply not to the attacker but to the victim, thus unwittingly becoming an agent of the attack. In a TCP SYN flooding attack, the attacker or its agents send spoofed TCP SYN (i.e., connection request) packets to the victim. Each such bogus request causes the victim to tie up resources that could otherwise be used for requests from legitimate clients.</p>
<p id="p-0009" num="0008">To prevent smurf attacks, the Internet Engineering Task Force (IETF) has changed the default treatment of directed broadcast packets by routers. Instead of accepting and forwarding directed broadcast packets, routers should now by default drop them. Additionally, to thwart spoofing, the IETF has recommended ingress filtering (see, e.g., P. Ferguson and D. Senie, “Network Ingress Filtering: Defeating Denial of Service Attacks Which Employ IP Source Address Spoofing,” IETF, RFC 2827 (also BCP 0038), May 2000). With ingress filtering, ISP ingress routers should drop a packet that arrives in a port if the packet's source address does not match a prefix associated with the port. Ingress filtering automatically stops attacks that require spoofing. Moreover, if an attack that does not use spoofing occurs, ingress filtering allows the origin of the attack to be determined simply by examining the source addresses of attack packets. Therefore, ingress filtering can speed up recovery from such attacks. Disadvantageously, the IETF's recommendations need to be adopted by many parties (networks unwittingly used in smurf attacks and ISPs) that are thereby burdened with new responsibilities and costs, but receive no compensation for solving what they may consider somebody else's (the e-merchants') problem. Moreover, these recommendations do not deter all possible congestive DoS attacks. Even without spoofing and directed broadcast, attackers can use agents to obtain the cloaking and leverage necessary for successful attacks. Therefore, adoption of these recommendations (particularly ingress filtering) has not been widespread.</p>
<p id="p-0010" num="0009">IP traceback is a recently proposed alternative to ingress filtering (see, e.g., S. Savage, D. Wetherall, A. Karlin and T. Anderson, “Practical Network Support for IP Traceback,” <i>Proc. SIGCOMM'</i>2000, pp. 295-306, ACM, Stockholm, Sweden, August 2000). Unlike ingress filtering, IP traceback can be effective even if not widely deployed. IP traceback modifies routers so that they probabilistically send traceback information to a packet's destination. Statistical methods allow a victim to use such information to partly reconstruct the attack path (the reconstructed part is that closest to the victim). However, IP traceback has weaknesses that may deleteriously affect the likelihood of its adoption. It appears that attackers can easily defeat IP traceback by making attacks oblique, i.e., by ostensibly targeting neighbors of the victim, rather than the victim itself. Moreover, traceback information sent by routers that are further from the victim than is the closest attacker can be spoofed and therefore needs authentication. The infrastructure necessary for such authentication may add considerable complexity and vulnerabilities of its own. Finally, like ingress filtering, traceback does not stop attackers from using agents, and may increase ISP responsibilities and costs without contributing to ISP revenues.</p>
<p id="p-0011" num="0010">Victims can often restore their Internet connectivity by simply changing their address in case of an attack. Of course, this solution is not robust against attackers that periodically check the victim's address via the current DNS mapping. A more general solution against congestive DoS attacks consists in combining input logging and rate limiting (see, e.g., “Characterizing and Tracing Packet Floods Using Cisco Routers,” Cisco, available on the Cisco website, cisco.com, at/warp/public/707/22.html). To use these techniques, the victim must initially determine the signature of the attack, i.e., how the attack packets differ from legitimate packets. ISP personnel then install a filter matching the attack's signature in the egress port of the router closest to the victim. The filter generates a log that reveals what ingress port the attack is coming from. Input logging is then iterated for the next upstream router, until the router closest to the origin of the attack is found. A rate-limiting filter matching the attack's signature is then left installed in the ingress port from where the attack is coming.</p>
<p id="p-0012" num="0011">Input logging and rate limiting have many limitations. First, attackers may perform an oblique attack noted above, i.e. obfuscate the attack by ostensibly targeting a neighbor of the intended victim. Thus, the victim may not have the opportunity to examine attack packets. Second, even if attack packets reach the victim, the signature may be difficult to characterize. For example, an attacker may coordinate agents so that they send endless streams of seemingly legitimate but fruitless requests to the victim, so as to crowd out requests from legitimate clients. Unlike smurf and TCP SYN flooding attacks, such crowding attacks do not cause easily identifiable anomalies at the network or transport layer, and therefore may be difficult to filter in routers. Third, filtering, logging, and rate limiting may not be available or may prohibitively slow down many routers, especially in the network core. Fourth, rate limiting may be unable to distinguish malicious and legitimate packets (e.g., TCP SYN packets) that arrive in the same ingress port. Thus, rate limiting may be ineffective if the attack is evenly distributed among ingress ports. Finally, input logging and rate limiting are often labor-intensive, tedious procedures performed under pressure and usually without adequate compensation to the ISP.</p>
<p id="p-0013" num="0012">A methodology is needed, therefore, that limits the losses inflicted upon an e-merchant by congestion, whether legitimate or intentionally inflicted upon the e-merchant by an attacker.</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0014" num="0013">The present invention assumes Internet support for at least two separate classes of service, a first class of service that is privileged with respect to a second (unprivileged) class of service. In the current Internet, these multiple classes of service could be implemented using, for example, what has been designated as differs (see, e.g., S. Blake, D. Black, M. Carlson, E. Davies, Z. Wang and W. Weiss, “An Architecture for Differentiated Services,” IETF, RFC 2475, December 1998). In accordance with the invention, an ISP carries the packets of a designated subset of an e-merchant's clients, designated as VIPs, in the privileged class of service as compared to the unprivileged class of service that is used to carry the packets of the e-merchant's other clients, which are called regular clients. In this way, congestion in the unprivileged class of service, regardless of cause, will have limited effect on the performance of packets sent by and to VIPs using the privileged class of service. An e-merchant may select its VIPs, for example, from among those clients that bring in a majority of the e-merchant's revenues. An e-merchant turns a regular client into a VIP by granting it a VIP right. VIP gates, preferably implemented in an ISP's access gateways, monitor the packets sent by clients and mark for the privileged class of service those packets whose source has an active VIP right issued by the packet's destination. Quality of service (QoS) mechanisms protect VIP packets from overload in the regular best-effort class of service.</p>
<p id="p-0015" num="0014">The quid pro quo between the e-merchant, which is able to provide a premium protected class of service to its VIP clients, and the ISP, which needs to incorporate the extra functionality into its access gateways or elsewhere, is that the e-merchant remunerates the ISP in some manner, such as through the payment of money or otherwise, for providing the value-added service. The ISP thus has the benefits of a new stream of revenue and the e-merchant has the benefits that inure to it from being able to provide such a premium-protected service to its better clients.</p>
<p id="p-0016" num="0015">In addition to the VIP gate functionality that is incorporated into the ISP's access routers, the e-merchant may incorporate other functionalities itself. Thus, for example, a VIP monitor may optionally be used at an e-merchant to perform session admission control and dynamic prioritization so as to keep the performance of admitted sessions within desired performance bounds. The VIP monitor prioritizes each session according to class of service markings in client packets and load and revenues generated by recent sessions having the same client address.</p>
<p id="p-0017" num="0016">A VIP protocol is used to request, install, activate and bill VIP rights.</p>
<p id="p-0018" num="0017">A VIP gate in monitoring the packets transiting it from an access link, first determines whether the packet's destination was recently the source of another packet to this packet's source and in the privileged class of service. If it was, the packet is marked and forwarded in the privileged class of service. Thus, reply packets to a client coming from a server are handled in the same class of service that the request packets were sent to the server from the client. If it was not, then the source of the packet may not be a server, but a client, and a determination is made whether the destination of the packet is a subscribing site. If the destination isn't a subscribing site, the packet is marked for the unprivileged class of service. If the packet source is a subscribing site, a determination is made whether the source of the packet is a VIP of the destination. If the source is a VIP, the packet may be marked and forwarded using the privileged class of service. A client may choose, however, not to use what may be its usage-limited VIP rights, in which case the client is an inactive VIP and its packets are marked and forwarded using the unprivileged class of service. If the client is active, thus choosing to use its usage-limited VIP rights, a determination is made whether the packet's usage of those rights would exceed that client's VIP usage limits. If the usage limits would be exceeded, it is marked and forwarded using the unprivileged class of service. If the usage limits would not be exceeded, the packet is marked and forwarded using the privileged class of service and that client's usage of its VIP rights is updated.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWING</heading>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a system in which VIP gates are incorporated in the access gateway routers that interface the input ports in the ISP that services an e-merchant and in the ISP that services the e-merchant's VIP customers;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 2</figref> is a flowchart showing the VIP protocol for requesting, installing, activating, and billing VIP rights;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 3</figref> is a flowchart showing the steps performed at an access gateway; and</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart showing the steps performed by a VIP monitor.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0023" num="0022">With reference to <figref idref="DRAWINGS">FIG. 1</figref>, ISP <b>101</b>, which supports the VIP service and thus two classes of service, incorporates a VIP gate into its access gateways (referred to hereinafter as VIP gateways) <b>102</b>, <b>103</b> and <b>104</b>, for three exemplary points of presence (PoPs) of the ISP. A plurality of clients <b>105</b>-<b>1</b>-<b>105</b>-N are shown connected over access links to VIP gateway <b>102</b>. Other clients are similarly connected to VIP gateways <b>103</b> and <b>104</b>, but are not explicitly shown in <figref idref="DRAWINGS">FIG. 1</figref>. The access links connecting the clients and the VIP gateways can be over any telecommunications network such as a local POTS network or a DSL connection, a cable network using a cable modem, or any other network or methodology, wired or wireless, which provides Internet connectivity to the clients. Two classes of service, privileged and unprivileged, are available to packets sent from and sent to ISP <b>101</b>. To illustrate that separate resources are available to these separate classes of service, ISP <b>101</b> and Internet exchange <b>110</b> within an intermediate ISP <b>111</b> are shown interconnected by two connections <b>106</b> and <b>107</b>, for the separate transmission of packets in the privileged and unprivileged classes of service, respectively.</p>
<p id="p-0024" num="0023">At Internet exchange router <b>110</b>, two or more ISPs exchange packets. Two other ISPs are shown connected to Internet exchange <b>110</b>: ISP <b>112</b> and ISP <b>113</b>. ISP <b>112</b> does not support the VIP service and is shown including an exemplary access router <b>114</b> to which a plurality of clients <b>115</b> are connected over access links. Since only one class of service is supported, a single transmission facility <b>116</b> interconnects access router <b>114</b> and Internet exchange router <b>110</b>. ISP <b>113</b> supports the VIP service and is the ISP that provides Internet connectivity to the e-merchant that offers the VIP service to its best clients. A VIP monitor <b>117</b>, to be described herein later, interconnects the front end of the e-merchant's server <b>118</b> and the VIP gateway <b>120</b> within ISP <b>113</b>. Packets are transmitted in both directions between VIP gateway <b>120</b> and Internet exchange <b>110</b> in the privileged class of service and in the unprivileged class of service over separate facilities <b>121</b> and <b>122</b>, respectively.</p>
<p id="p-0025" num="0024">In accordance with the VIP service, the e-merchant <b>118</b> requests that an ISP, such as ISP <b>101</b>, carry packets of a designated subset of the e-merchant's clients in the privileged class of service as compared to the unprivileged class of service that is used to carry the packets of the e-merchant's other clients. The term privileged class of service as used herein and in the accompanying claims encompasses any method that limits the adverse effects of packets sent in the unprivileged class of service on the performance of the packets being sent in the privileged class of service. Members of the designated privileged subset are called VIPs, whereas other clients are called regular clients. The e-merchant <b>118</b> may select its VIPs in any manner such as from among those clients that bring in a majority of the e-merchant's revenues. The e-merchant <b>118</b> turns a regular client into a VIP by granting it a VIP right. VIP gates incorporated in the access routers, designated VIP gateways <b>102</b>, <b>103</b> and <b>104</b>, monitor packets and mark for the privileged class of service those packets whose source has an active VIP right issued by the packet's destination (or vice-versa). Thus, similarly, VIP gateway <b>120</b> in ISP <b>113</b> monitors those packets from e-merchant <b>118</b> and marks for the privileged class of service packets that have a destination address of a VIP. Quality of service (QoS) mechanisms protect VIP packets in either direction from overload in the regular best-effort class of service.</p>
<p id="p-0026" num="0025">A regular client <b>105</b> becomes a selected client when the e-merchant <b>118</b> grants a VIP right to the client. A selected client becomes a VIP when the selected client activates the respective VIP right. A VIP becomes a selected client when the VIP deactivates the respective VIP right. A VIP or selected client becomes a regular client when the respective VIP right expires or is revoked by the e-merchant.</p>
<p id="p-0027" num="0026">The judgment of what clients should have VIP privileges for sending packets to a given e-merchant <b>118</b> is made only by that e-merchant, and not by a client. Therefore, a VIP right is always client-specific, i.e., a client cannot transfer to another client a VIP right. Because the e-merchant <b>118</b> may not consider another e-merchant's VIPs particularly worthy, a VIP right is always specific to the e-merchant that granted the VIP right. Thus, the privileged class of service is only used to carry a client's packets to the e-merchant that granted that client the VIP right.</p>
<p id="p-0028" num="0027">The e-merchant <b>118</b> grants or revokes a VIP right to one or more clients <b>105</b> by sending to ISP <b>101</b> a request that the ISP respectively insert the VIP right into or remove the VIP right from the ISP's VIP list. The VIP list may be stored in association with the VIP gateway <b>102</b>, which is the point of presence (PoP) to ISP <b>101</b> of client <b>105</b>. Thus, a VIP right is always ISP-specific. The e-merchant <b>118</b> may also grant VIP rights for the same client at different ISPs or at different PoPs of the same ISP. Typically, an e-merchant will grant a client no more than a few VIP rights, e.g., one that the client may use at home, another for use at work, and perhaps a third for use while traveling.</p>
<p id="p-0029" num="0028">Every VIP right is term-limited, expiring at a certain time. This term limit reflects the frequency with which the e-merchant ranks clients for selection of VIPs. Every VIP right is also usage-limited and thus expires when the amount of information (e.g., number of packets or bytes) the client has sent using it reaches a specified limit. This usage limit is calculated to allow a VIP to perform, as a VIP, sufficient new transactions to remain a VIP.</p>
<p id="p-0030" num="0029">A VIP right may also be location-specific, being usable only in a certain PoP of an ISP. Location-specific VIP rights may be used, for example, for access from home or from work. A location-specific VIP right allows the respective activation, deactivation, and usage accounting to be processed entirely locally at the PoP, e.g., at VIP gateway <b>102</b> for a client <b>105</b>. This local processing provides straightforward scalability and robustness with respect to DoS attacks against most of the ISP's infrastructure. Alternatively, a VIP right may be location-independent, thus usable in any of the ISP's PoPs. A location-independent VIP right may be used, for example, for mobile access. To activate, deactivate, read, or update the usage accounting of a location-independent VIP right, a VIP gateway, such as VIP gateway <b>102</b>, needs to communicate with a remote database server, such as ISP server <b>125</b> within ISP <b>101</b>. Because these operations cannot be performed locally, they are more susceptible to DoS attacks than is the case for location-specific VIP rights. Thus, location-independent VIP rights require more sophisticated distributed database processing techniques for high scalability and robustness.</p>
<p id="p-0031" num="0030">Each VIP gateway, such as VIP gateway <b>102</b>, maintains a VIP list and a Web site where clients can activate and deactivate the respective VIP rights. The VIP list associated with VIP gateway <b>102</b> contains that VIP gateway's location-specific VIP rights and replicas of location-independent VIP rights activated by the clients <b>105</b> connected to the VIP gateway. The VIP gateway <b>102</b> dynamically binds a client <b>105</b> with an address when the client activates a VIP right. Thus, client addresses need not be fixed. When a client <b>105</b> activates a location-independent VIP right, VIP gateway <b>102</b> locks and reads the respective records from the remote database <b>125</b>. Conversely, when the client deactivates the right, the VIP gateway <b>102</b> updates and unlocks the respective records in the remote database <b>125</b>.</p>
<p id="p-0032" num="0031">VIP gateway <b>102</b> monitors the packets coming in from the access links connected to clients <b>105</b>, marks for transmission in the privileged class of service those packets whose source is a VIP with respect to the packet's destination, marks for the unprivileged regular class of service all other packets, and maintains VIP rights' usage information.</p>
<p id="p-0033" num="0032">VIP gateway <b>120</b> is the PoP of e-merchant <b>118</b>, which issues the VIP rights to the clients <b>105</b> that conduct transactions with that e-merchant through ISP <b>101</b>. Since the responsive packets to packets that were received by e-merchant in the privileged class from a VIP client should be returned to that same client in the privileged class, VIP gateway <b>120</b>, and each other VIP gateway determines whether the packet's destination (e.g., a client <b>105</b>) has an active VIP right issued by the packet's source (in this case, e-merchant <b>118</b>). To determine whether a packet's destination has an active VIP right issued by the packet's source, a VIP gateway <b>120</b>, and each other VIP gateway, caches whether packets recently sent from the destination to the source were marked for a privileged class of service.</p>
<p id="p-0034" num="0033">As described above and as shown in <figref idref="DRAWINGS">FIG. 1</figref>, VIP gates are preferably implemented in the input ports of an ISP's access gateways, the VIP gateways. This allows the ISP to separate the privileged VIP traffic and the unprivileged and regular traffic as close to its source as possible. VIP gates can also be implemented downstream from access gateways as, for example, stand-alone devices or integrated with differs edge routers. Disadvantageously, however, a downstream implementation may leave packets from VIP clients vulnerable to congestion caused by regular packets between an access gateway and the corresponding downstream VIP gate.</p>
<p id="p-0035" num="0034">IP address spoofing may in some cases allow a regular client to pose as a VIP client. Therefore, mutually authenticated tunnels, using IPsec for example, between a client and a VIP gate may be desirable in the following circumstances: (a) the client is in an ISP customer's network that has many IP addresses (e.g. at a company or university); (b) access to the ISP is via a shared medium with layer-2 authentication that is either nonexistent or deemed insecure (e.g., WEP in 802.11b wireless networks); or (c) the VIP gate is implemented downstream from an access gateway that does not implement ingress filtering, the latter having been described above.</p>
<p id="p-0036" num="0035">A VIP monitor <b>117</b>, noted above, is an optional device connected to the front-end of the e-merchant's site <b>118</b>. It is a device that performs session admission control and prioritization at the e-merchant site, so as to keep the performance of admitted sessions within desired performance bounds. The VIP monitor <b>117</b> prioritizes each session according to the class of service markings in client packets and load and revenues generated by recent sessions having the same client address. In performing this prioritization, VIP monitor <b>117</b> favors VIP, up-and-coming, and regular sessions (in that order), in detriment of disappointing sessions. Disappointing sessions are those that have the same client address and class of service as one or more recent sessions that have consumed excessive e-merchant resources without generating revenues. Conversely, up-and-coming sessions are regular unprivileged class of service sessions that have the same client address and class of service as one or more recent sessions that have generated significant revenues without unduly consuming e-merchant resources. VIP sessions are those that have the VIP privileged class of service marking and are not disappointing. If, however, an excessive number of VIP clients access the e-merchant's site <b>118</b> at the same time, the VIP monitor <b>117</b> may downgrade one or more VIP sessions to a lower priority, according to the recent load and revenues generated by each client. Regular sessions are all other sessions.</p>
<p id="p-0037" num="0036">The VIP monitor <b>117</b> is typically implemented at a customer-premises front-end, as shown in <figref idref="DRAWINGS">FIG. 1</figref>, or alternatively, in a Web switch. The VIP monitor advantageously enables the ability to respond to client load and revenues more quickly and in a more nuanced fashion than is possible using only VIP gates.</p>
<p id="p-0038" num="0037">The afore-described VIP service assumes that ISPs can support at least two classes of service, the privileged VIP class of service and the regular unprivileged class of service. As previously noted, different classes of service may be implemented using the previously noted and referenced differs. Other implementations could use integrated services (intserv) (see, e.g., R. Braden, D. Clark, S. Shenker, “Integrated Services in the Internet Architecture: an Overview,” IETF, RFC 1633, June 1994), or any other quality of service scheme. Most currently available routers support at least one such scheme. The regular unprivileged class of service may be, for example, the network's best-effort class of service. The VIP privileged class of service may be one having higher priority than that of the regular unprivileged class of service, or having a certain minimum share of each required resource, such as bandwidth and buffer space. The class of service may be marked, for example, in the TOS (type of service) field of the packet's IP header.</p>
<p id="p-0039" num="0038">More than one ISP may be involved in carrying packets from a client to an e-merchant. In such cases, each ISP must be able to differentiate privileged VIP and unprivileged regular traffic, but it is not necessary that all ISPs use the same mechanisms to achieve such differentiation.</p>
<p id="p-0040" num="0039">At Internet exchange <b>110</b>, where ISPs <b>101</b>, <b>112</b> and <b>113</b> exchange packets, class of service markings used in packets coming from one ISP need to be mapped into class of service marking used by the ISP to which those packets are directed. Since ISP <b>112</b> does not support VIP service, as noted above, only the regular unprivileged class of service is available for the transport of packets directed to e-merchant <b>118</b> from any client <b>115</b> connected to that ISP. Internet exchange <b>110</b> thus transports packets directed to and from a client <b>115</b> and e-merchant <b>118</b> in the unprivileged regular class of service.</p>
<p id="p-0041" num="0040">Similarly, at peering points at which two peer ISPs directly exchange packets, a first ISP that supports VIP service needs to map class of service markings in packets received from a second ISP. If the second ISP also supports VIP service, then the first ISP needs to map the second IPS's privileged VIP and regular unprivileged class of service markings respectively into the first ISP's equivalent class of service markings. On the other hand, if the second ISP does not support the VIP service, then the first ISP needs to map any of the second ISP's class of service markings into the first ISP's regular unprivileged class of service marking.</p>
<p id="p-0042" num="0041">The mappings performed at an Internet exchange and at a peering point may require changing the TOS and correspondingly updating the checksum of the IP header of each packet. Since IPsec, TCP, and UDP checksums do not depend on the TOS, these checksums do not need to be updated.</p>
<p id="p-0043" num="0042">E-merchants also need to separate the resources used by each class (a session class if using the optional VIP monitor, or client class of service otherwise). In large sites, this can be achieved by using separate hosts as servers for each class. A Web switch will then forward the traffic of each class to the respective servers. Each server may run a conventional operating system.</p>
<p id="p-0044" num="0043">Alternatively, in small sites, a single host running an operating system with quality of service support may be used as server for all classes. An example of an operating systems that may be used for such purpose is Eclipse/BSD (see, e.g., J. Bruno, J. Brustoloni, E. Gabber, B. Ozden, and A. Silberschatz, “Retrofitting Quality of Service into a Time-Sharing Operating System”, <i>Proc. Annual Tech. Conf.</i>, USENIX, June 1999, pp. 15-26).</p>
<p id="p-0045" num="0044">Congestion or disruption in an ISP customer's network (e.g., at a company or university) or shared-medium access link (e.g., cable or wireless) can affect VIP clients that access an ISP via such a network or access link. These vulnerabilities can be eliminated by using (1) customer-premises networks that support and enforce different classes of service, and (2) exclusive access links, such as DSL, dial-up, ISDN, or leased lines.</p>
<p id="p-0046" num="0045">The methodology of the VIP protocol, which is used to request, install, activate and bill VIP rights is described in connection with the flowchart in <figref idref="DRAWINGS">FIG. 2</figref>. During a first stage of the VIP protocol, a client registers with a desired ISP. This stage is performed only once per desired ISP and location. At step <b>201</b>, the client chooses an ISP, a client identification (ID), a password, and a location for using the VIP rights. The location may represent one of the IPS's PoPs (for a location-specific right)) or be left unspecified (for a location-independent right). The client may make these choices, for example, using an ISP's secure Web site, which should check that the client id and password are not easily guessable. At step <b>202</b>, the client obtains from the ISP an ISP client locator, which is a data structure containing the ISP name (in cleartext) and client id and location (both encrypted by the ISP using a secret key known only to the ISP, so as not to disclose them to the e-merchant or other parties). The client may download this data structure from the ISP's site as a file. The client also receives from the ISP the URL of a password-protected VIP gateway Web page where the client can activate and deactivate its VIP rights. This may be implemented by Web redirection. At step <b>203</b>, the client bookmarks or memorializes this URL in some other medium.</p>
<p id="p-0047" num="0046">The second stage in the VIP protocol comprises only step <b>204</b>. The client provides the ISP client locator to an e-merchant that the client wishes to access as a VIP. This may be implemented by uploading the ISP client locator to a secure Web site maintained by the e-merchant. The e-merchant may preserve past client information, so that the client may need to perform this stage only once per location and e-merchant that the client desires to access as a VIP.</p>
<p id="p-0048" num="0047">The third stage comprises steps <b>205</b>-<b>207</b>, and is performed by the e-merchant each time the e-merchant grants new VIP rights. At step <b>205</b>, the e-merchant prepares a VIP right, which is a data structure containing the ISP client locator, the e-merchant's client id (encrypted by the e-merchant using a secret key known only to the e-merchant, so as not to disclose it to the ISP), the e-merchant name or address(es), the expiration time, and the usage limits (the latter three items in cleartext). At step <b>206</b>, the e-merchant requests the ISP to include the VIP right in the ISP's VIP list. This may be implemented employing a mutually authenticated and encrypted channel between the e-merchant and the ISP, e.g. using the Transport Layer Security (TLS) protocol. At step <b>207</b>, the ISP decrypts the locator embedded in the VIP right and includes the VIP right in its corresponding VIP list. If the VIP right's location is specified, then the ISP updates the respective VIP gateway's VIP list, otherwise the ISP updates the ISP's location-independent VIP list. The former update may be implemented employing a mutually authenticated and encrypted channel between the ISP and each of the VIP gateways using, for example, TLS.</p>
<p id="p-0049" num="0048">The fourth stage of the protocol comprises step <b>208</b> only. At step <b>208</b>, when desired, the client goes to a VIP gateway's password-protected Web page to activate or deactivate the respective VIP rights.</p>
<p id="p-0050" num="0049">The fifth and final stage comprises steps <b>209</b>. At step <b>209</b>, the ISP periodically verifies the usage of each VIP right and bills the e-merchant. The bill may include, for example, a minimum monthly fee per VIP right that the e-merchant requests the ISP to install, plus an amount proportional to the actual network usage of the e-merchant's VIPs.</p>
<p id="p-0051" num="0050">The protocol shown in <figref idref="DRAWINGS">FIG. 2</figref> can be easily strengthened, for example, by having the ISP give the client a hardware token, such as a SecurID, in step <b>202</b>, and requiring the client to combine the hardware token with the client's password in step <b>208</b>. Certificate-based strengthening is also possible.</p>
<p id="p-0052" num="0051">The flowchart in <figref idref="DRAWINGS">FIG. 3</figref> shows the processing of a packet by a VIP gateway. At step, <b>301</b>, the packet arrives from an access link at the input port of a VIP gateway. At step <b>302</b>, a determination is made whether the packet's destination was recently the source of another packet destined to this packet's source and in the privileged class of service. If yes, then, at step <b>303</b>, the packet is marked and forwarded in the privileged class of service. If not, then, at step <b>304</b>, a determination is made whether the packet's source is a VIP of its destination. If not, then, at step <b>305</b>, the packet is marked and forwarded in the unprivileged class of service. If yes, then, at step <b>306</b>, a determination is made whether the source of the packet is an active VIP of the destination. If not, then, again at step <b>305</b>, the packet is marked and forwarded in the unprivileged class of service. If yes, then, at step <b>307</b>, a determination is made whether the previous usage of the VIP rights plus this packet's usage would be less than or equal to the VIP's usage limits that have been given to it by the e-merchant. If these usage limits would be exceeded, then, again at step <b>305</b>, the packet is marked and forwarded in the unprivileged class of service. If these usage limits would not be exceeded, then, at step <b>308</b>, the VIP's usage of its VIP rights is updated, and, at step <b>309</b>, the packet is marked and forwarded in the privileged class of service.</p>
<p id="p-0053" num="0052">The flowchart in <figref idref="DRAWINGS">FIG. 4</figref> shows the steps associated with classifying sessions between a client and an e-merchant by the optional VIP monitor <b>117</b>, previously described. At step <b>401</b>, packets within a session arrive at the e-merchant. At step <b>402</b>, the class of service of the arriving packets is verified. If privileged, at step <b>403</b>, a determination is made whether the session is-one that is disappointing. As previously noted, a disappointing session is one that has the same client address and class of service as one or more recent sessions that has consumed excessive e-merchant resources without generating revenues for the e-merchant. If not a disappointing session, then, at step <b>404</b>, a determination is made whether there are an excessive number of VIP clients simultaneously trying to access the e-merchant. If not, then, at step <b>405</b>, the session is classified in the first level for processing by the e-merchant at the highest priority level. If there are an excessive number of VIP clients simultaneously accessing the e-merchant, then, at step <b>406</b>, the session may be downgraded to a lower priority level of processing depending upon recent load and revenues generated by the client as compared with the recent load and revenues generated by the other VIP clients which are simultaneously trying to access the e-merchant. If, at step <b>402</b>, the class of service is determined to be unprivileged, then, at step <b>407</b>, a determination is made whether the client has been engaged in one or more recent sessions that have generated significant revenues without unduly consuming the e-merchant's resources. If yes, then, at step <b>408</b>, the session is deemed up-and-coming, and is processed by the e-merchant at a second level, at a lower priority than the first level. If, at step <b>407</b>, the determination is made that the client has not been engaged in one or more recent revenue producing session, then, at step <b>409</b>, a determination is made whether the session is disappointing. If not a disappointing session, then at step <b>410</b>, the session is processed by the e-merchant at a third level, which is lower than the second level. If a session, privileged or unprivileged, is determined to be disappointing, at step <b>403</b> or at step <b>409</b>, respectively, then, at step <b>411</b>, the session may be processed by the e-merchant at a fourth and lowest level.</p>
<p id="p-0054" num="0053">Advantageously, the implementation of VIP service makes it very difficult for an attacker to mount a successful DoS attack against an emerchant's VIP clients. Currently, an attacker can easily scan for vulnerable computers to use as agents for a DoS attack: Any computer will do. VIPnet changes that. Attacks launched from regular clients do not block the VIP clients because VIP packets are carried in a separate class of service. Consequently, attacks launched against the e-merchant that would affect the VIP clients need to be launched from among the VIP clients. Because VIP rights cannot be forged, the attacker can use only computers that have active VIP rights for the intended victim. Therefore, the universe of potential agents is smaller and more difficult to scan for. Moreover, the traffic that any one VIP agent might generate is limited, because VIP rights are term and usage limited. Consequently, the attacker cannot sustain an attack. A corollary of the above advantage is that VIP service protects what may be a major part of an e-merchant's revenues from the effects of congestion and DoS attacks. The other main advantage of VIP service is that it allows e-merchants to provide to select clients a superior quality of service.</p>
<p id="p-0055" num="0054">As previously noted, the present invention is likely to be implemented, in part, as a computer program or application running in the periphery of the Internet, most probably in an access gateway. As noted, however, It may also be implemented, in part, in a computer program or application running at downstream from an access gateway.</p>
<p id="p-0056" num="0055">It should be noted that the term privileged class of service as used herein and in the claims encompasses any method that limits the adverse effects of packets sent in the unprivileged class of service on the performance of the packets being sent in the privileged class of service.</p>
<p id="p-0057" num="0056">The foregoing merely illustrates the principles of the invention. It will thus be appreciated that those skilled in the art will be able to devise various arrangements, which, although not explicitly described or shown herein, embody the principles of the invention and are included within its spirit and scope. Furthermore, all examples and conditional language recited herein are principally intended expressly to be only for pedagogical purposes to aid the reader in understanding the principles of the invention and the concepts contributed by the inventor to furthering the art, and are to be construed as being without limitation to such specifically recited examples and conditions. Moreover, all statements herein reciting principles, aspects, and embodiments of the invention, as well as specific examples thereof, are intended to encompass both structural and functional equivalents thereof. Additionally, it is intended that such equivalents include both currently known equivalents as well as equivalents developed in the future, i.e., any elements developed that perform the same function, regardless of structure.</p>
<p id="p-0058" num="0057">It will be further appreciated by those skilled in the art that the block diagrams herein represent conceptual views embodying the principles of the invention. Similarly, it will be appreciated that the flowchart represents various processes that may be substantially represented in computer readable medium and so executed by a computer or processor, whether or not such computer or processor is explicitly shown.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of limiting the effect upon certain users that access an e-merchant's server from a denial-of-service attack against the e-merchant's server, the method comprising:
<claim-text>marking a packet addressed to the e-merchant's server for forwarding in a privileged class of service when the source of the packet is a computer whose user is a VIP user who has been designated by the e-merchant as being within a predetermined subset of users who transact business online with the e-merchant through the e-merchant's server, where a determination that the computer's user is a VIP user is made through the VIP user's activation of a VIP right that was granted to the VIP user by the e-merchant and the attachment of that VIP right to the VIP user's computer, the VIP right granted by the e-merchant to the VIP user automatically expiring at the end of a specified term and/or after a specified maximum number of packets or bytes have been forwarded to the e-merchant's server by the VIP user's computer client-in the privileged class of service.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>marking a packet addressed to the e-merchant's server for forwarding in an unprivileged class of service when the source of the packet is a computer whose user has not been designated as a VIP user by the e-merchant, is a VIP user whose VIP right has either expired or has previously forwarded the specified maximum number of packets or bytes to the e-merchant's server in the privileged class of service, or is a VIP user who has not activated and attached his VIP right to his computer.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the VIP user can dynamically activate or deactivate a VIP right granted to it by the e-merchant such that packets originating from the VIP user's computer and addressed to the e-merchant's server are marked for forwarding in the privileged class of service only when the respective VIP right is unexpired and has been activated, and are marked for forwarding in the unprivileged class of service otherwise.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. Apparatus for limiting the effect upon certain users that access an e-merchant's server from a denial-of-service attack against the e-merchant's server comprising:
<claim-text>means for storing a VIP right for at least one user who has been designated by the e-merchant as a VIP user who is within a predetermined subset of users that transact business online with the e-merchant through the e-merchant's server, the VIP right being granted individually by the e-merchant to the at least one VIP user and having a specified term and/or specified packet or byte usage limits; and</claim-text>
<claim-text>a computer program or application that performs a method of marking a packet addressed to the e-merchant's server for forwarding in a privileged class of service when the source of the packet is a computer whose user has been designated as a VIP user by the e-merchant, where a determination that the computer's user is a VIP user is made through the VIP user's activation of the VIP right and the attachment of that VIP right to the VIP user's computer, and the specified term of the VIP right granted to that user that is stored in the storing means has neither expired nor have the number of packets or bytes that have been already forwarded from that client to the e-merchant's server in the privileged class of service exceeded the specified packet or byte usage limits of that user's VIP right.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein the computer program or application further marks a packet addressed to the e-merchant's server for forwarding in an unprivileged class when the source of the packet is a computer whose user has not been designated as a VIP user by the e-merchant, is a VIP user whose VIP right has either expired or has previously forwarded the specified maximum number of packets or bytes to the e-merchant in the privileged class of service, or is a VIP user who has not activated and attached his VIP right to his computer.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the computer program marks a packet addressed to the e-merchant's server for forwarding in the privileged class of service only when the source of the packet is a computer whose user is an active VIP user of the e-merchant, and marks a packet for forwarding a packet addressed to the e-merchant's server in the unprivileged class of service if the source of the packet is a computer whose user is an inactive VIP user of the e-merchant.</claim-text>
</claim>
</claims>
</us-patent-grant>
