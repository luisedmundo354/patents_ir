<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299189-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299189</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>09700611</doc-number>
<date>20000321</date>
</document-id>
</application-reference>
<us-application-series-code>09</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>11-076944</doc-number>
<date>19990319</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>10</class>
<subclass>L</subclass>
<main-group>19</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>704500</main-classification>
</classification-national>
<invention-title id="d0e61">Additional information embedding method and it's device, and additional information decoding method and its decoding device</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4750173</doc-number>
<kind>A</kind>
<name>Bliithgen</name>
<date>19880600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6061793</doc-number>
<kind>A</kind>
<name>Tewfik et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713176</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6208735</doc-number>
<kind>B1</kind>
<name>Cox et al.</name>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380 54</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6240121</doc-number>
<kind>B1</kind>
<name>Senoh</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375130</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6359849</doc-number>
<kind>B1</kind>
<name>Sato et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>369 591</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6738493</doc-number>
<kind>B1</kind>
<name>Cox et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382100</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>EP</country>
<doc-number>0 673 014</doc-number>
<date>19950900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>EP</country>
<doc-number>0 766 468</doc-number>
<date>19970400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>EP</country>
<doc-number>0 840 513</doc-number>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>EP</country>
<doc-number>0 891 071</doc-number>
<date>19990100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>EP</country>
<doc-number>0 901 259</doc-number>
<date>19990300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>JP</country>
<doc-number>6-232824</doc-number>
<date>19940800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>JP</country>
<doc-number>6232824</doc-number>
<date>19940800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>JP</country>
<doc-number>7-115369</doc-number>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>JP</country>
<doc-number>7115369</doc-number>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>JP</country>
<doc-number>7-297725</doc-number>
<date>19951100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>JP</country>
<doc-number>7297725</doc-number>
<date>19951100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>JP</country>
<doc-number>8-44399</doc-number>
<date>19960200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>WO</country>
<doc-number>WO 94 18762</doc-number>
<date>19940800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>WO</country>
<doc-number>WO 95 26601</doc-number>
<date>19951000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Database Inspec Online! The Institution of Electrical Engineers, Stevenage, GB; Sep. 1998, Iwakiri M et al: “Digital watermark scheme for high quality audio data by spectrum spreading and modified discrete cosine transform” XP002331466 Database accession No. 6102486 &amp; Transactions of the Information Processing Society of Japan Inf. Process. Soc. Japan , vol. 39, No. 9, Sep. 1998, pp. 2631-2637 ISSN: 0387-5806.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>67</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>704500-504</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>7042001</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382100</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382248</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382250</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382251</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713176</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>25</number-of-drawing-sheets>
<number-of-figures>48</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Sato</last-name>
<first-name>Hideo</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Finnegan, Henderson, Farabow, Garrett &amp; Dunner, L.L.P.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sony Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Armstrong</last-name>
<first-name>Angela</first-name>
<department>2626</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/JP00/01715</doc-number>
<kind>00</kind>
<date>20000321</date>
</document-id>
<us-371c124-date>
<date>20010205</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO00/57399</doc-number>
<kind>A </kind>
<date>20000928</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention relates to an additional information embedding method for embedding additional information into an audio signal, in which the audio signal is MDCT-transformed to calculate an MDCT coefficient and the calculated MDCT coefficient is damped, shifted in the direction of the frequency axis and added to the original MDCT coefficient, thereby embedding the additional information as a watermark into the audio signal.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="107.19mm" wi="229.28mm" file="US07299189-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="230.21mm" wi="160.53mm" orientation="landscape" file="US07299189-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="100.08mm" wi="168.66mm" file="US07299189-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="164.17mm" wi="114.89mm" file="US07299189-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="178.90mm" wi="107.70mm" file="US07299189-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="223.69mm" wi="154.69mm" orientation="landscape" file="US07299189-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="169.33mm" wi="169.33mm" file="US07299189-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="167.30mm" wi="175.18mm" file="US07299189-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="202.78mm" wi="164.34mm" file="US07299189-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="228.60mm" wi="160.78mm" file="US07299189-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="243.76mm" wi="168.32mm" file="US07299189-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="212.85mm" wi="169.67mm" file="US07299189-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="222.84mm" wi="174.16mm" file="US07299189-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="242.65mm" wi="170.69mm" file="US07299189-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="237.24mm" wi="135.38mm" orientation="landscape" file="US07299189-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="216.32mm" wi="102.53mm" file="US07299189-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="145.54mm" wi="160.36mm" file="US07299189-20071120-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="201.85mm" wi="176.53mm" file="US07299189-20071120-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="230.89mm" wi="180.34mm" file="US07299189-20071120-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="214.97mm" wi="127.42mm" orientation="landscape" file="US07299189-20071120-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="224.87mm" wi="132.00mm" orientation="landscape" file="US07299189-20071120-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="236.22mm" wi="148.08mm" orientation="landscape" file="US07299189-20071120-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="204.30mm" wi="95.33mm" file="US07299189-20071120-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00023" num="00023">
<img id="EMI-D00023" he="233.85mm" wi="138.60mm" orientation="landscape" file="US07299189-20071120-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00024" num="00024">
<img id="EMI-D00024" he="235.29mm" wi="131.91mm" orientation="landscape" file="US07299189-20071120-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00025" num="00025">
<img id="EMI-D00025" he="234.61mm" wi="124.12mm" orientation="landscape" file="US07299189-20071120-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">This invention relates to an additional information embedding method and device for embedding, into an audio signal, information which enables limitation of recording of the audio signal, prohibition of transfer to another equipment or protection of the interest of the copyright holder, as additional information, and a demodulation method and device for demodulating the additional information added to the audio signal.</p>
<heading id="h-0002" level="1">BACKGROUND ART</heading>
<p id="p-0003" num="0002">There has been conventionally used a technique for embedding, as additional information, information which prohibits transfer of an audio signal to another equipment or which limits recording of the audio signal in order to realize protection of the contents of an audio work. The additional information of this type is embedded into an audio signal as a watermark, which may be a digital watermark or an analog watermark.</p>
<p id="p-0004" num="0003">As a technique for embedding a digital watermark into a digital audio signal, there is employed a technique which uses the least significant bit (LSB) of a 16-bit PCM audio signal for watermark data. Also, there is employed a technique for embedding additional information into a digital audio signal as a watermark by operating the modified discrete cosine transform (MDCT) coefficient of a compression-coded digital audio signal or the coefficient of a subband.</p>
<p id="p-0005" num="0004">Since a digital watermark can be read and written by superimposing watermark data directly on a digital audio signal, signal processing is facilitated. However, the digital watermark will be broken when the digital audio signal is demodulated to an analog audio signal. The digital watermark might also be broken when the digital audio signal is converted to a different data format. Therefore, the digital watermark cannot limit repeated recording of the analog audio signal, that is, copying of the analog audio signal, and cannot sufficiently protect the interest of the copyright holder of the audio work.</p>
<p id="p-0006" num="0005">An analog watermark is embedded into a digital audio signal in such a manner that it is detected in the form of an analog signal. Even after conversion of the file format is carried out, the watermark can be read again by demodulating the digital audio signal to an analog audio signal.</p>
<p id="p-0007" num="0006">Meanwhile, a technique for distributing an audio work such as a music tune to the user through a communication network is proposed. This distribution technique is exemplified by the electronic music distribution (EMD) for transmitting and recording a digital audio signal in a compressed data format. An analog watermark which is embedded in the compressed digital audio signal distributed by the EMD cannot be read out or written unless the compressed digital audio signal is demodulated to a PCM signal or an analog signal. Therefore, in order to record the audio signal distributed by the EMD on which the analog watermark is superimposed, the user needs to demodulate the audio signal to a PCM signal. As the compressed digital audio signal is demodulated to a PCM signal or the like, the data size is increased and recording to a recording medium cannot be carried out efficiently. Also, in order to rewrite the analog watermark, the audio signal distribution side needs to demodulate audio signal once compressed to a PCM signal and therefore cannot rewrite the analog watermark easily.</p>
<p id="p-0008" num="0007">As methods for embedding an analog watermark into an audio signal, a spread spectrum system and a phase shift keying (PSK) system are proposed. The spread spectrum system and the PSK system are adapted for embedding additional information to an audio signal by utilizing a masking effect with respect to the auditory sense in reproducing an audio signal. However, since these systems cannot provide a sufficient masking effect, it is difficult to embed the additional information into the audio signal without deteriorating the quality of the reproduced sound.</p>
<heading id="h-0003" level="1">DISCLOSURE OF THE INVENTION</heading>
<p id="p-0009" num="0008">In view of the foregoing status of the art, it is an object of the present invention to provide a novel additional information embedding method and device and an additional information demodulation method and device which enable solution of the foregoing problems.</p>
<p id="p-0010" num="0009">It is another object of the present invention to provide an additional information embedding method and device which enable embedment of additional information into an audio signal without deteriorating the quality of a reproduced sound, and an additional information demodulation method and device which enable demodulation of additional information without deteriorating the sound quality of an audio signal in which the additional information is embedded.</p>
<p id="p-0011" num="0010">It is still another object of the present invention to provide an additional information embedding method and device and an additional information demodulation method and device which enable embedment of additional information into an audio signal without easily being subject to damages even in the case where the audio signal is demodulated from a digital signal to an analog signal or in the case where the data format is changed.</p>
<p id="p-0012" num="0011">It is a further object of the present invention to provide an additional information embedding method and device which enable easy embedment of additional information into a compressed audio signal, and an additional information demodulation method and device which enable demodulation of the embedded additional information in the data-compressed state.</p>
<p id="p-0013" num="0012">An additional information embedding method for embedding additional information into an audio signal according to the present invention includes: an orthogonal transform step of orthogonally transforming an audio signal and thus calculating an orthogonal transform coefficient; and a shift and addition step of damping and shifting the orthogonal transform coefficient in the direction of the frequency axis and adding the resultant coefficient to the original orthogonal transform coefficient so as to embed the additional information.</p>
<p id="p-0014" num="0013">The orthogonal transform step includes MDCT of the audio signal so as to calculate an MDCT coefficient, and the shift and addition step includes damping and shifting the calculated MDCT coefficient in the direction of the frequency axis and adding the resultant coefficient to the original MDCT coefficient so as to embed the additional information.</p>
<p id="p-0015" num="0014">The method of the present invention further includes a step of scrambling the signal calculated by the shift and addition step, using a pseudo-random signal.</p>
<p id="p-0016" num="0015">The additional information embedded into the audio signal is limitation information for prohibiting transfer of the audio signal, limitation information for prohibiting recording of the audio signal to a recording medium, and work data corresponding to the audio signal.</p>
<p id="p-0017" num="0016">Moreover, in the method of the present invention, the shift and addition step includes adding the orthogonal transform coefficient shifted on the frequency axis to the original orthogonal transform coefficient so that a frequency masking condition and a temporal masking condition are met.</p>
<p id="p-0018" num="0017">Also, the shift and addition step includes adding in the case where the value obtained by adding the shifted orthogonal transform coefficient to the original orthogonal transform coefficient is not higher than a predetermined value.</p>
<p id="p-0019" num="0018">Moreover, the shift and addition step includes prohibiting shift and addition in accordance with the polarity of the value obtained by adding the shifted orthogonal transform coefficient to the original orthogonal transform coefficient.</p>
<p id="p-0020" num="0019">Furthermore, the shift and addition step includes shifting and adding in the case where the audio signal falls within a range from an upper limit value to a lower limit value. In this case, the shift and addition step includes shifting and adding in the case where the audio signal falls within a range from an upper limit value to a lower limit value set on the basis of the human auditory characteristics.</p>
<p id="p-0021" num="0020">Also, the shift and addition step includes shifting and adding an orthogonal transform coefficient within a predetermined frequency band.</p>
<p id="p-0022" num="0021">Moreover, the shift and addition step includes dividing the frequency band of the audio signal and carrying out shift and addition for each of the divided frequency bands. In this case, the shift and addition step includes reversing the shifting direction of the divided adjacent frequency bands.</p>
<p id="p-0023" num="0022">Furthermore, the shift and addition step includes shifting the MDCT coefficient toward the frequency-increasing side and adding the MDCT coefficient to the original MDCT coefficient. In this case, at the shift and addition step, the frequency of the MDCT coefficient is increased by ((sampling frequency/number of samples of MDCT coefficient)×2N) Hz, as the MDCT coefficient is shifted by 2N units (where N is a natural number). The shift and addition step is substantially equal to the amplitude of the audio signal.</p>
<p id="p-0024" num="0023">Also, the shift and addition step includes shifting the MDCT coefficient toward the frequency-decreasing side and adding the MDCT coefficient to the original MDCT coefficient. In this case, at the shift and addition step, the frequency of the MDCT coefficient is decreased by ((sampling frequency/number of samples of MDCT coefficient)×2N) Hz, as the MDCT coefficient is shifted by 2N units (where N is a natural number).</p>
<p id="p-0025" num="0024">An additional information embedding device for embedding additional information into an audio signal according to the present invention includes: orthogonal transform means for orthogonally transforming an audio signal and thus calculating an orthogonal transform coefficient; and shift and addition means for damping and shifting the orthogonal transform coefficient in the direction of the frequency axis and adding the resultant coefficient to the original orthogonal transform coefficient so as to embed the additional information.</p>
<p id="p-0026" num="0025">The orthogonal transform step means carries out MDCT of the audio signal so as to calculate an MDCT coefficient, and the shift and addition means damps and shifts the calculated MDCT coefficient in the direction of the frequency axis and adds the resultant coefficient to the original MDCT coefficient so as to embed the additional information.</p>
<p id="p-0027" num="0026">The additional information embedding device according to the present invention further includes means for scrambling the signal calculated by the shift and addition means, using a pseudo-random signal.</p>
<p id="p-0028" num="0027">A demodulation method according to the present invention for receiving an audio signal in which additional information is embedded and demodulating the additional information includes: a receiving step of receiving an audio signal in which additional information is embedded by damping and shifting in the direction of the frequency axis and adding to the audio signal on the original frequency axis; and a demodulation step of demodulating the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis, of the received signal. The receiving step includes receiving the audio signal in which the additional information is embedded by damping and shifting in the direction of the frequency axis an orthogonal transform coefficient calculated by orthogonally transforming the audio signal and adding the resultant orthogonal transform coefficient to the original orthogonal transform coefficient. Also, the receiving step includes receiving the audio signal in which the additional information is embedded by damping and shifting in the direction of the frequency axis an MDCT coefficient calculated by MDCT of the audio signal and adding the resultant MDCT coefficient to the original MDCT coefficient.</p>
<p id="p-0029" num="0028">Moreover, the receiving step includes receiving the audio signal in which the additional information is embedded by amplitude modulation (AM modulation), and the demodulation step includes demodulating the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis, of the received signal.</p>
<p id="p-0030" num="0029">Furthermore, the receiving step includes receiving the audio signal in which the additional information is embedded by FM modulation, and the demodulation step includes demodulating the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis, of the received signal.</p>
<p id="p-0031" num="0030">Also, the demodulation step includes demodulating the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis within a predetermined frequency band of the received signal.</p>
<p id="p-0032" num="0031">A demodulation device according to the present invention for receiving an audio signal in which additional information is embedded and demodulating the additional information includes: receiving means for receiving an audio signal in which additional information is embedded by damping and shifting in the direction of the frequency axis and adding to the audio signal on the original frequency axis; and demodulation means for demodulating the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis, of the received signal. The receiving means receives the audio signal in which the additional information is embedded by damping and shifting in the direction of the frequency axis an orthogonal transform coefficient calculated by orthogonally transforming the audio signal and adding the resultant orthogonal transform coefficient to the original orthogonal transform coefficient.</p>
<p id="p-0033" num="0032">Also, the receiving means receives the audio signal in which the additional information is embedded by damping and shifting in the direction of the frequency axis an MDCT coefficient calculated by MDCT of the audio signal and adding the resultant MDCT coefficient to the original MDCT coefficient.</p>
<p id="p-0034" num="0033">Moreover, the receiving means receives receiving the audio signal in which the additional information is embedded by AM modulation, and the demodulation means demodulates the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis, of the received signal.</p>
<p id="p-0035" num="0034">Furthermore, the receiving means receives the audio signal in which the additional information is embedded by FM modulation, and the demodulation means demodulates the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis, of the received signal.</p>
<p id="p-0036" num="0035">Also, the demodulation means demodulates the additional information on the basis of the polarity of the audio signal at each predetermined interval on the frequency axis within a predetermined frequency band of the received signal.</p>
<p id="p-0037" num="0036">Other objects and specific advantages of the present invention will be clarified further by the following description of embodiments.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 1</figref> illustrates frequency masking of an audio signal.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 2A</figref> is a graph showing the result of MDCT of an audio signal as a sine wave. <figref idref="DRAWINGS">FIG. 2B</figref> shows the result of fast Fourier transform of an audio signal as a sine wave.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIGS. 3A and 3B</figref> are graphs showing the state where the MDCT coefficient is shifted in the direction of the frequency axis.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIGS. 4A and 4B</figref> are graphs showing the change of the frequency in the case where the MDCT coefficient is shifted in the direction of the frequency axis.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIGS. 5A and 5B</figref> are graphs showing frequency selection processing of a watermark embedded into an audio signal.</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 6A</figref> is a graph showing the signal characteristics in a frequency region of a signal obtained by amplitude-modulating an audio signal by a sine wave. <figref idref="DRAWINGS">FIG. 6B</figref> is a graph showing the original audio signal. <figref idref="DRAWINGS">FIG. 6C</figref> is a graph showing a signal obtained by amplitude-modulating the audio signal of <figref idref="DRAWINGS">FIG. 6B</figref> by a sine wave.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 7A</figref> is a graph showing the signal characteristics in a frequency region of a signal obtained by frequency-modulating an audio signal by a sine wave. <figref idref="DRAWINGS">FIG. 7B</figref> is a graph showing the original audio signal. <figref idref="DRAWINGS">FIG. 7C</figref> is a graph showing a signal obtained by frequency-modulating the audio signal of <figref idref="DRAWINGS">FIG. 7B</figref> by a sine wave.</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 8A</figref> is a graph showing an example of embedment of a watermark into a high frequency band side of the original audio signal. <figref idref="DRAWINGS">FIG. 8B</figref> is a graph showing an example of embedment of a watermark into a low frequency band side of the original audio signal.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 9</figref> is a graph illustrating an MDCT coefficient calculation method.</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIGS. 10A and 10B</figref> are graphs showing replacement of the MDCT coefficient.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 11A</figref> is a graph showing the MDCT coefficient of the original audio signal. <figref idref="DRAWINGS">FIG. 11B</figref> is a graph showing the state where an MDCT coefficient shifted in the direction of the frequency axis is added to the MDCT coefficient of the original audio signal. <figref idref="DRAWINGS">FIG. 11C</figref> is a graph showing the state where an originally nonexistent polarity change is generated when the MDCT coefficient shifted in the direction of the frequency axis is added to the MDCT coefficient of the original audio signal.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 12A</figref> is a graph showing the state where the MDCT coefficient to which a watermark is to be embedded is selected in accordance with the level of the MDCT coefficient. <figref idref="DRAWINGS">FIG. 12B</figref> is a graph showing the state where additional information is embedded as a watermark around the MDCT coefficient selected in <figref idref="DRAWINGS">FIG. 12A</figref>.</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 13A</figref> is a first graph showing an example of frequency band limitation of the watermark. <figref idref="DRAWINGS">FIG. 13B</figref> is a second graph showing the example of frequency band limitation of the watermark.</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 14</figref> is a graph showing an example of insertion of multiple information with a plurality of layers of watermark.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 15A</figref> is a first graph showing an example of frequency band division for division into a plurality of frequency bands. <figref idref="DRAWINGS">FIG. 15B</figref> is a second graph showing the example of frequency band division for division into a plurality of frequency bands.</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 16</figref> is a block diagram showing a codec which superimposes additional information as a watermark onto an audio signal so as to carry out modulation and then decodes the audio signal on which the additional information is superimposed.</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 17</figref> is a flowchart showing the procedure for superimposing the additional information onto the audio signal.</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 18</figref> is a graph showing processing for extracting the additional information in the form of a watermark embedded in the audio signal, by resetting every other second and detecting deviation of each section.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 19</figref> is a first graph showing the operation of demodulation in accordance with the comparison of curves of different shift quantities of the MDCT coefficient in the direction of the frequency axis.</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 20</figref> is a second graph showing the operation of demodulation in accordance with the comparison of curves of different shift quantities of the MDCT coefficient in the direction of the frequency axis.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 21A</figref> is a graph showing the state of frequency band division. <figref idref="DRAWINGS">FIG. 21B</figref> is a graph showing an envelope obtained by the audio signals having the band divided in <figref idref="DRAWINGS">FIG. 21A</figref> are respectively modulated in the inverse phase. <figref idref="DRAWINGS">FIG. 21C</figref> is a graph showing an error generated by the envelope. <figref idref="DRAWINGS">FIG. 21D</figref> is a graph showing the state of synthesis of the band-divided audio signals modulated in the inverse phase.</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 22A</figref> is a graph showing the number of the same polarities and the number of different polarities between the MDCT coefficients in the case where frequency division is not carried out. <figref idref="DRAWINGS">FIG. 22B</figref> is a graph showing the number of the same polarities and the number of different polarities for each block and between the synthesized MDCT coefficients in the case where frequency division is not carried out.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 23A</figref> is a graph showing the number of the same polarities and the number of different polarities between the MDCT coefficients in the case where frequency division is carried out. <figref idref="DRAWINGS">FIG. 23B</figref> is a graph showing the number of the same polarities and the number of different polarities for each block and between the synthesized MDCT coefficients in the case where frequency division is carried out.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 24</figref> is a block diagram showing another example of the codec which superimposes additional information as a watermark onto an audio signal so as to carry out modulation and then decodes the audio signal on which the additional information is superimposed.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 25</figref> is a flowchart showing the procedure for superimposing the additional information onto the audio signal by using the codec of <figref idref="DRAWINGS">FIG. 24</figref>.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 26</figref> is a block diagram showing still another example of the codec which superimposes additional information as a watermark onto an audio signal so as to carry out modulation and then decodes the audio signal on which the additional information is superimposed.</p>
<p id="p-0064" num="0063"><figref idref="DRAWINGS">FIG. 27</figref> is a block diagram showing a watermark generation circuit with Hilbert conversion.</p>
<p id="p-0065" num="0064"><figref idref="DRAWINGS">FIG. 28</figref> is a block diagram showing embedment of additional information as a watermark into an audio signal by using the watermark generation circuit with Hilbert conversion.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">BEST MODE FOR CARRYING OUT THE INVENTION</heading>
<p id="p-0066" num="0065">The additional information embedding method and device and the additional information demodulation method and device according to the present invention will now be described with reference to the drawings.</p>
<p id="p-0067" num="0066">Prior to the description of the present invention, a sound masking effect will be explained. The masking effect means a state such that with respect to a masker which is a sound having a certain frequency and a predetermined sound pressure level or higher, the human auditory sense does not respond to a sound having a frequency shifted within a predetermined range and the sound pressure level or lower. When there is a sound Ms having a certain frequency and a predetermined sound pressure or higher, the human auditory sense does not response to a sound WM of not higher than a sound pressure level indicated by a masking curve <b>1</b> within a predetermined frequency region Bw shown in <figref idref="DRAWINGS">FIG. 1</figref>. For example, with respect to a sound As in a frequency band of 1 kHz or lower, the human auditory sense does not response to a sound WM of not higher than the sound pressure level indicated by the masking curve <b>1</b> within the range of the critical bandwidth Bw of 100 Hz around that audio signal. The critical bandwidth Bw is dependent on the frequency and the frequency bandwidth is gradually broadened at 1 kHz or higher, as shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0068" num="0067">The masking effect also includes what is called temporal masking effect. With this temporal masking effect, even the sound WM, which is a maskee to be masked at the sound pressure level indicated by the masking curve <b>1</b> or lower in the direction of the time base, will be caught by the human auditory sense if it is shifted in the direction of the time base with respect to the sound As, which serves as a masker of a certain frequency and the predetermined sound pressure level or higher. For example, depending on the listener, the maskee sound WM might be heard in such a manner that it is shifted several milliseconds forward or several milliseconds backward in the direction of the time base with respect to the masker sound As.</p>
<p id="p-0069" num="0068">Thus, in order to embed additional information as a maskee into an audio signal as a masker, the additional information must be added within the range of the sound pressure level indicated by the masking curve or lower with respect to the audio signal as the masker, in consideration of the above-described masking effect. In consideration of the temporal masking effect, the additional information must not be largely shifted in the direction of the time base with respect to the audio signal as the masker.</p>
<p id="p-0070" num="0069">The audio signal handled in the present invention will now be described. The audio signal has a sine wave of various frequencies superimposed thereon. If this sine wave is transformed by fast Fourier transform (FFT), one spectrum (fast Fourier transform coefficient) is generated at a certain frequency, as shown in <figref idref="DRAWINGS">FIG. 2A</figref>. On the other hand, if the sine wave is transformed by MDCT (modified discrete cosine transform), a plurality of MDCT coefficients of both polarities are generated at a plurality of frequencies, as shown in <figref idref="DRAWINGS">FIG. 2B</figref>. As shown in <figref idref="DRAWINGS">FIG. 2B</figref>, the four MDCT coefficients in the central area occupy approximately 90% of the whole. In <figref idref="DRAWINGS">FIGS. 2A</figref> and <b>2</b>B, the vertical axis represents the gain (or level).</p>
<p id="p-0071" num="0070">The MDCT coefficients obtained by carrying out MDCT of the sine wave have the following characteristics. That is, if the entire MDCT coefficients are shifted by an even number of units in the direction of the frequency axis so as to carry out inverse MDCT (IMDCT), the result is a signal obtained by frequency shifting on the PCM signal due to the characteristics of the MDCT and inverse MDCT. For example, if an audio signal of 1 kHz is sampled by a frequency of 44.1 kHz, then the 1024 sample values are transformed by MDCT as shown in <figref idref="DRAWINGS">FIG. 3A</figref>, and the resultant MDCT coefficients are shifted by two to the right on the frequency axis and transformed by inverse MDCT as shown in <figref idref="DRAWINGS">FIG. 3B</figref>, the audio signal of 1 kHz shown in <figref idref="DRAWINGS">FIG. 4A</figref> becomes a signal with its frequency raised by 43 Hz as shown in <figref idref="DRAWINGS">FIG. 4B</figref>. Similarly, if the resultant MDCT coefficients are shifted by four to the right as shown in <figref idref="DRAWINGS">FIG. 4B</figref> and then transformed by inverse MDCT, a signal with its frequency raised by 86 Hz is obtained as shown in <figref idref="DRAWINGS">FIG. 3B</figref>. Thus, as described above, if the entire MDCT coefficients are shifted by two to the right in the direction of the frequency axis, a signal of 1043 Hz shown in <figref idref="DRAWINGS">FIG. 4B</figref> obtained by shifting the audio signal of 1 kHz shown in <figref idref="DRAWINGS">FIG. 4A</figref> is generated. If the entire MDCT coefficients are shifted by four, a signal of 1086 Hz shown in <figref idref="DRAWINGS">FIG. 4B</figref> is generated.</p>
<p id="p-0072" num="0071">By sampling a typical audio signal by a frequency of 44.1 kHz, then carrying out MDCT of the 1024 sample values, then selecting a predetermined number of MDCT coefficient from the resultant MDCT coefficients as shown in <figref idref="DRAWINGS">FIG. 5A</figref>, and carrying out inverse MDCT of the selected MDCT coefficients, the modulation result with the frequency limitation can be obtained. Thus, additional information can be embedded as a watermark WM into a signal limited to a band of 1.5 to 5 kHz as shown in <figref idref="DRAWINGS">FIG. 5B</figref>, instead of the entire frequencies of the audio signal.</p>
<p id="p-0073" num="0072">As a method for embedding additional information as a watermark WM into an audio signal, there is employed a system which generates the additional information directly from the audio signal itself, that is, a system which uses a component of a predetermined frequency band wave included in the audio signal as the additional information and embed the additional information as a watermark WM within a range where the masking effect shown in <figref idref="DRAWINGS">FIG. 1</figref> is obtained.</p>
<p id="p-0074" num="0073">As one of such systems, an AM modulation system may be employed. The AM modulation system is adapted for carrying out processing as shown in <figref idref="DRAWINGS">FIGS. 6A</figref>, <b>6</b>B and <b>6</b>C. Specifically, if an envelope of a signal (sine wave) of a specified frequency of the original audio signal into which the additional information is to be embedded is amplitude-modulated by a sine wave shown in <figref idref="DRAWINGS">FIG. 6B</figref>, as shown in <figref idref="DRAWINGS">FIG. 6C</figref>, side band signals SB appear on both sides of the original audio signal as shown in <figref idref="DRAWINGS">FIG. 6A</figref>, and the side band signals SB are caused to fall within the range of the masking curve <b>1</b> shown in <figref idref="DRAWINGS">FIG. 1</figref>. By utilizing the side band signals SB, the additional information can be embedded as a watermark into the audio signal.</p>
<p id="p-0075" num="0074">As another system, an FM modulation system may be employed. The FM modulation system is adapted for carrying out processing as shown in <figref idref="DRAWINGS">FIGS. 7A</figref>, <b>7</b>B and <b>7</b>C. Specifically, if a signal (sine wave) of a specified frequency of the audio signal into which the additional information is to be embedded is frequency-modulated by a sine wave shown in <figref idref="DRAWINGS">FIG. 7B</figref>, as shown in <figref idref="DRAWINGS">FIG. 7C</figref>, side band signals SB appear on both sides of the original audio signal as shown in <figref idref="DRAWINGS">FIG. 7A</figref>, and the side band signals SB are caused to fall within the range of the masking curve <b>1</b> shown in <figref idref="DRAWINGS">FIG. 1</figref>. By utilizing the side band signals SB, the additional information can be embedded as a watermark into the audio signal.</p>
<p id="p-0076" num="0075">Moreover, in the case of embedding additional information as a watermark into an audio signal, the additional information may be embedded as a watermark WM into either a high-frequency band of a signal of a specified frequency of the audio signal to which the additional information is to be embedded, as shown in <figref idref="DRAWINGS">FIG. 8A</figref>, or a low-frequency band of the signal of the specified frequency, as shown in <figref idref="DRAWINGS">FIG. 8B</figref>. In both cases of <figref idref="DRAWINGS">FIGS. 8A and 8B</figref>, the watermark WM is embedded with the gain damped to fall within the range of the masking curve <b>1</b> of the audio signal of the specified frequency, as shown in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0077" num="0076">A method for demodulating additional information which is embedded as a watermark WM within the range of the masking curve <b>1</b> of the audio signal, by damping the MDCT coefficient obtained by MDCT and decoding of the audio signal and then shifting the MDCT coefficient in the direction of the frequency axis, will now be described.</p>
<p id="p-0078" num="0077">In the case of demodulating the MDCT coefficient obtained by MDCT of the audio signal, correct demodulation cannot be carried out if there is a shift between the 1024 samples as a MDCT unit at the time of modulation and the 1024 transform coefficients as an inverse MDCT unit at the time of demodulation. Therefore, to correctly demodulate the additional information, 1024 times of inverse MDCT must be carried out with the phases of the transform coefficients shifted one by one, as shown in <figref idref="DRAWINGS">FIG. 9</figref>. Such multiple times of inverse MDCT is impractical in consideration of the processing time and processing speed, and also requires excessive increase in the circuit scale.</p>
<p id="p-0079" num="0078">The additional information which is embedded into the audio signal by shifting in the direction of the frequency axis the MDCT coefficient obtained by MDCT of the audio signal has the correlation with the original audio signal. Thus, demodulation of the additional information embedded in the audio signal is carried out utilizing the characteristics of the additional information. In this demodulation, the additional information can be easily demodulated by adding the MDCT coefficient shifted in the direction of the frequency axis to the original MDCT coefficient obtained by MDCT of the audio signal.</p>
<p id="p-0080" num="0079">Specifically, if the MDCT coefficients shown in <figref idref="DRAWINGS">FIG. 10A</figref> obtained by MDCT of the audio signal are shifted by four in the direction of the frequency axis and then added to the original MDCT coefficients, there is a high probability that the polarity of the original MDCT coefficients and the polarity of the added MDCT coefficients are of the same phase, as shown in <figref idref="DRAWINGS">FIG. 10B</figref>. That is, as shown in <figref idref="DRAWINGS">FIG. 10B</figref>, the MDCT coefficients which are added in the direction of the frequency axis and of the same phase as the original MDCT are increased, and those of the inverse phase are decreased. Thus, the polarity of the MDCT coefficients shown in <figref idref="DRAWINGS">FIG. 10B</figref>, obtained by shifting the MDCT coefficient by four in the direction of the frequency axis and adding the resultant MDCT coefficients, is counted with respect to the same phase or the inverse phase and statistical processing is carried out, thus detecting whether the shifted MDCT coefficients are added as the same phase or as the inverse phase. By doing so, the modulated additional information can be easily demodulated without carrying out multiple times of inverse MDCT even in the case where there is a shift between the 1024 samples as a MDCT unit at the time of modulation and the 1024 transform coefficients as an inverse MDCT unit at the time of demodulation.</p>
<p id="p-0081" num="0080">In this case, the MDCT coefficients are shifted by four in the direction of the frequency axis in order to realize a high probability that the polarity of the MDCT coefficients is of the same phase. However, the MDCT coefficients may be shifted by 2N (where N is a natural number).</p>
<p id="p-0082" num="0081">Meanwhile, in demodulating the additional information, there are some MDCT coefficients which do not contribute to increase or decrease of the polarity, of the MDCT coefficients shifted in the direction of the frequency axis and added to or subtracted from the original MDCT coefficients obtained by MDCT and decoding of the audio signal. That is, of the MDCT coefficients shifted in the direction of the frequency axis, there are some MDCT coefficients the polarity of which is not changed by addition to or subtraction from the original MDCT coefficients.</p>
<p id="p-0083" num="0082">Specifically, the MDCT coefficients shifted by four in the direction of the frequency axis are added to the original MDCT coefficients shown in <figref idref="DRAWINGS">FIG. 11A</figref> obtained by MDCT of the audio signal. In this case, the MDCT coefficients to be added have the gain reduced by a predetermined level, for example, approximately 30 dB, as shown in <figref idref="DRAWINGS">FIG. 11B</figref>, and then added to the original MDCT coefficients. The result of addition is as shown in <figref idref="DRAWINGS">FIG. 11C</figref>. Even in such case where the MDCT coefficients with the gain reduced by 30 dB is added to the original MDCT coefficients, there are some MDCT coefficients which neither contribute to inversion of the polarity of the original MDCT coefficients nor function as a watermark as they exceed the masking level of an audio signal of a predetermined frequency. Therefore, there is a risk of deterioration in the quality of the reproduced sound.</p>
<p id="p-0084" num="0083">In order to solve such problems, it may be considered to add only the MDCT coefficients having a level greater than that of the original MDCT coefficients and having the inverse phase. However, even in the case where such processing is completely carried out, there is a risk that the additional information embedded in the audio signal cannot be demodulated when the MDCT-transformed audio signal is converted to an analog signal and MDCT-transformed again by a block of a different sample value. That is, there is a risk that the additional information might be lost when the MDCT coefficients shifted in the direction of the frequency axis are added to the MDCT coefficients obtained by MDCT-transforming again the audio signal converted to the analog signal, by the processing similar to the above-described processing.</p>
<p id="p-0085" num="0084">Thus, in order to prevent damage to the additional information embedded in the audio signal and to prevent deterioration in the sound quality of the demodulated audio signal, only the MDCT coefficients having a gain not higher than a predetermined level, of the MDCT coefficients obtained by MDCT of the audio signal into which the additional information is embedded, are used for embedment of the additional information. With respect to a sound of a predetermined frequency, a sound of a shifted frequency and not lower than a certain sound pressure level cannot provide an auditory masking effect. In consideration of such sound characteristics, a threshold value S<b>1</b> is provided on the gain and frequency of the MDCT coefficients used for the additional information in view of the human auditory sense, as shown in <figref idref="DRAWINGS">FIG. 12A</figref>, and only the MDCT coefficients within the range of not higher than the threshold value S<b>1</b> are used for embedment of the additional information. The MDCT coefficients selected in this case are shifted by four in the direction of the frequency axis, then have the gain reduced, and are added to the original MDCT coefficients. Thus, the additional information is embedded as watermarks WM on both side of the original MDCT coefficients, as shown in <figref idref="DRAWINGS">FIG. 12B</figref>. In this case, as shown in <figref idref="DRAWINGS">FIG. 12B</figref>, the additional information of not lower than the predetermined level can be prevented from being embedded at positions away by a predetermined frequency from the original MDCT coefficients of a predetermined frequency, and generation of a sound that is reproduced as an auditory noise component can be prevented.</p>
<p id="p-0086" num="0085">In embedding the additional information as a watermark WM into the audio signal, if the MDCT coefficients for the additional information are embedded at positions that are constantly away by a predetermined frequency from the MDCT coefficients of a predetermined frequency, an auditory noise which is not masked might be heard when the audio signal is reproduced, as described with reference to <figref idref="DRAWINGS">FIG. 1</figref>. Since the frequency band where the masking effect can be obtained changes depending on the frequency, the frequency distance Hr for embedding the additional information as a watermark WM is varied in accordance with the frequency of the audio signal into which the additional information is embedded. For example, when the additional information is to be embedded as a watermark WM into an audio signal of 1 kHz or lower, the original MDCT coefficients are shifted on the frequency axis so that the MDCT coefficient for the additional information are embedded within the frequency distance Hr of 43 Hz, as shown in <figref idref="DRAWINGS">FIG. 13A</figref>. On the other hand, when the additional information is to be embedded as a watermark WM into an audio signal of 2 kHz or higher, the original MDCT coefficients are shifted on the frequency axis so that the MDCT coefficient for generating the additional information are embedded within the frequency distance Hr of 86 Hz, as shown in <figref idref="DRAWINGS">FIG. 13A</figref>.</p>
<p id="p-0087" num="0086">Moreover, in embedding the additional information as a watermark WM into the audio signal, the frequency distance Hr for embedding the additional information as a watermark WM can be increased with respect to the audio signal of 2 kHz or higher. Thus, the MDCT coefficients for the additional information can be multiplexed and then embedded within the frequency distance Hr, as shown in <figref idref="DRAWINGS">FIG. 13B</figref>.</p>
<p id="p-0088" num="0087">As described above, if signal compression processing using compression quantization for a video signal is carried out on the audio signal in which the additional information is embedded as a watermark WM, the additional information might be broken. This is because the amplitude of each frequency component within the frequency band of the audio signal is rounded to be smaller by the limitation of the number of quantization steps in the course of signal compression. To solve this problem, the level of the additional information to be added to the audio signal may be maintained at a predetermined level or higher. For example, by maintaining the level of the additional information at approximately −6 to −30 dB with respect to the level of an audio signal of a predetermined frequency into which the additional information is embedded, the tolerance of the additional information can be guaranteed and breakdown of the additional information can be prevented even when the audio signal in which the additional information is embedded is compressed by quantization or the like. In order to prevent breakdown of the additional information when signal compression is carried out, the use of the MDCT coefficients which are damped −30 dB or more with respect to the original MDCT coefficients for the additional information may be avoided.</p>
<p id="p-0089" num="0088">When shifting the MDCT coefficients obtained by MDCT of the audio signal into the direction of the frequency axis and thus embedding the additional information as a watermark WM, if the additional information to be embedded is multiplexed to a plurality of layers L<b>1</b>, L<b>2</b>, . . . , LN as shown in <figref idref="DRAWINGS">FIG. 14</figref>, the frequency of each layer may be set exclusively.</p>
<p id="p-0090" num="0089">Depending on the codec, the audio signal may be MDCT-transformed after the frequency band of the audio signal is divided into predetermined frequency bands by a data filter, as shown in <figref idref="DRAWINGS">FIGS. 15A and 15B</figref>. The components of such divided frequency regions may be used directly as layers. <figref idref="DRAWINGS">FIG. 15A</figref> shows an example in which an adaptive audio signal compression technique (ATRAC2 or Adaptive Transform Acoustic Coding: trademark of Sony Corporation) is applied and in which frequency division is carried out every 5 kHz. <figref idref="DRAWINGS">FIG. 15B</figref> shows an example in which an output from a subband filter divided into 32 by the MDCT layer 3 is MDCT-transformed.</p>
<p id="p-0091" num="0090">As described above, in the method for embedding the additional information as a watermark WM into the audio signal by shifting the MDCT coefficients obtained by MDCT of the audio signal in the direction of the frequency axis, the level of the MDCT coefficients for generating the additional information is determined in accordance with the coincidence or non-coincidence of the polarity of the original MDCT coefficients and the polarity of the MDCT coefficients which are shifted by a predetermined number of units in the direction of the frequency axis and then added. Therefore, high levels of the MDCT coefficients do not directly affect the modulation intensity of the additional information. The MDCT coefficients of lower levels and the MDCT coefficients of higher levels have the same data quantity. Therefore, if priority is given the sound quality of the reproduced audio signal, it is desired to use the MDCT coefficients of the least possible level for generating the additional information in consideration of the masking effect of the audio signal to which the additional information is added and the tolerance of the addition information in the case where signal compression is carried out.</p>
<p id="p-0092" num="0091">In the case where the level of the additional information to be added to the audio signal is to be automatically set with respect to the level of the audio signal, the maximum amplitude of the additional information can be set by limiting the addition/subtraction of the level of the audio signal. Also, by setting the lower limit of the level of the addition information to be added to the audio signal, generation of the additional information which is damaged by signal compression or repeated conversion from a digital signal to an analog signal can be prevented.</p>
<p id="p-0093" num="0092">To automatically set the level of the audio signal to which the additional information is added, a method for normalizing the output of each frequency band or of each filter bank is used. In ATRAC2 or ATRAC3, an AGC circuit is provided on the stage subsequent to a polyphase quadrature filter (PQF), and therefore level adjustment is carried out before the audio signal is MDCT-transformed. Therefore, ATRAC2 or ATRAC3 can be used for the demodulation method of the present invention.</p>
<p id="p-0094" num="0093">Also, as a method for automatically setting the level of the audio signal, the number of effective MDCT coefficients for generating the additional information to be added to the audio signal may be counted and the level of the MDCT coefficients for generating the additional information may be automatically limited so that a constant number of MDCT coefficients are added on the average.</p>
<p id="p-0095" num="0094">The additional information embedding device for embedding additional information as a watermark into an audio signal and the demodulation device for demodulating the additional information embedded in the audio signal will now be described.</p>
<p id="p-0096" num="0095">In the present invention, the additional information embedding device and the additional information demodulation device are integrally constituted as a codec <b>10</b>, as shown in <figref idref="DRAWINGS">FIG. 16</figref>. This codec <b>10</b> has an A/D converter <b>12</b> for converting an audio signal inputted through an audio signal input terminal <b>10</b><i>a </i>to a digital signal, and an MDCT section <b>14</b> for MDCT-transforming (modified discrete cosine transform) the audio data converted to the digital signal by the A/D converter. The MDCT section <b>14</b> is adapted for carrying out one-dimensional orthogonal transform of a PCM signal, which is one-dimensional audio data. The MDCT section <b>14</b> carries out one-dimensional MDCT of the PCM signal and outputs a MDCT coefficient.</p>
<p id="p-0097" num="0096">The codec <b>10</b> also has a shift/addition section <b>16</b> to which the MDCT coefficient calculated by the MDCT section <b>14</b> is inputted and to which additional information inputted through an additional information input terminal <b>10</b><i>b </i>is inputted. The shift/addition section <b>16</b> shifts the MDCT coefficient supplied from the MDCT section <b>14</b> into the direction of the frequency axis and carries out polarity conversion of the original MDCT coefficient on the basis of the additional information, thus embedding the additional information into the MDCT coefficient.</p>
<p id="p-0098" num="0097">The signal outputted from the shift/addition section <b>16</b> is inputted an inverse MDCT section <b>18</b>. The inverse MDCT section <b>18</b> carries out inverse modified discrete cosine transform, which is the opposite to the transform by the MDCT section <b>14</b>, with respect to the signal outputted from the shift/addition section <b>16</b>.</p>
<p id="p-0099" num="0098">The digital audio data in which the additional information outputted as a digital signal from the inverse MDCT section <b>18</b> is embedded is converted to an analog audio data by a D/A converter <b>20</b> and then outputted through an output terminal <b>21</b>. The audio signal outputted from the output terminal <b>21</b> is a signal in which the additional information is embedded.</p>
<p id="p-0100" num="0099">The codec <b>10</b> is used as the additional information demodulation device and therefore has an additional information demodulation section <b>22</b> for demodulating the additional information embedded in the audio signal from the MDCT coefficient outputted from the MDCT section <b>14</b>. The additional information demodulated by the additional information demodulation section <b>22</b> is outputted to outside of the device through the output terminal <b>21</b>.</p>
<p id="p-0101" num="0100">The additional information embedded as a watermark into the audio signal includes limitation information for prohibiting transfer of the audio signal, limitation information for prohibiting recording of the audio signal to another recording medium, and work data corresponding to the audio signal. The work data includes data for managing the copyright of a music tune or the like corresponding to the audio signal, the copyright holder code, the copyright management number and the like.</p>
<p id="p-0102" num="0101">The procedure for embedding additional information into an audio signal using the codec <b>10</b> having the additional information embedding function shown in <figref idref="DRAWINGS">FIG. 16</figref> will now be described with reference to the flowchart of <figref idref="DRAWINGS">FIG. 17</figref>.</p>
<p id="p-0103" num="0102">As an audio signal is inputted from the audio signal input terminal <b>10</b><i>a </i>at step S<b>1</b>, the audio signal is inputted to the A/D converter <b>12</b>, where it is converted to a digital signal at step S<b>2</b>. The audio signal converted to the digital signal is inputted to the MDCT section <b>14</b>. At step S<b>3</b>, the audio signal inputted to the MDCT section <b>14</b> is MDCT-transformed to calculate MDCT coefficients. The MDCT coefficients calculated by the MDCT section <b>14</b> are inputted to the shift/addition section <b>16</b>.</p>
<p id="p-0104" num="0103">At step S<b>4</b>, whether additional information is inputted to the shift/addition section <b>16</b> or not is discriminated. Specifically, when the input of the additional information indicates “1”, the shift/addition section <b>16</b> at step S<b>5</b> shifts the MDCT coefficients inputted from the MDCT section <b>14</b> by two or by four in the direction of the frequency axis and adds the resultant MDCT coefficients to the original MDCT coefficients, thus embedding the additional information as a watermark WM. On the other hand, when there is no input of additional information, that is, when the additional information indicates “0”, the shift/addition section <b>16</b> outputs the original MDCT coefficients without carrying out the above-described shift and addition. The shift/addition section <b>16</b> adds the MDCT coefficients shifted in the direction of the frequency axis to the original MDCT coefficients when the additional information indicates “1”, and the shift/addition section <b>16</b> does not carry out shift and addition of the MDCT coefficients when the additional information indicates “0”. Thus, “0” or “1” of the additional information can be detected on the side of the equipment which receives or is supplied with the audio signal outputted from the additional information embedding device. In the case where the audio signal is sampled by a frequency of 44.1 kHz and 1024 sample values as one block are MDCT-transformed to obtain MDCT coefficients, each one bit of the additional information can be embedded for every 1024 sample values. However, it should be noted that the number of sample values is not limited to 1024.</p>
<p id="p-0105" num="0104">On the MDCT coefficients which are processed by predetermined processing by the shift/addition section <b>16</b>, inverse modified discrete cosine transform opposite to the MDCT transform is performed at step S<b>6</b>. At the subsequent step S<b>7</b>, the audio signal is converted to an analog audio signal, and at step S<b>8</b>, the analog audio signal in which the additional information is embedded is outputted.</p>
<p id="p-0106" num="0105">The case of demodulating the additional information embedded as a watermark in the audio signal using the codec <b>10</b> shown in <figref idref="DRAWINGS">FIG. 16</figref> will now be described.</p>
<p id="p-0107" num="0106">In the case where the MDCT coefficients are shifted by two or by four in the direction of the frequency axis and then added to the original MDCT coefficients by the shift/addition section <b>16</b> so as to embed the additional information as a watermark WM, the polarity of the fourth coefficients on the left and right sides of an arbitrary MDCT coefficient is inverted with a high probability by the additional information component embedded as a watermark, thus increasing/decreasing the polarity. Thus, as the fourth coefficients on the left and right side of the MDCT coefficient are accumulated with respect to the same polarity and different polarity, the bias of the polarity can be detected in a predetermined time section, for example, a section of one second.</p>
<p id="p-0108" num="0107">To detect the additional information embedded in the audio signal by using the bias of the polarity of the MDCT coefficients, the count number is reset every other second and the bias of the polarity in each section is examined, as shown in <figref idref="DRAWINGS">FIG. 18</figref>. Thus, detection of the additional information embedded as a watermark is made possible. In accordance with the combination of the case where the polarity is biased to the positive direction and the case where the polarity is biased to the negative direction, a data string of “1”, “1”, “0” as the data of the respective sections can be transmitted and detected, as shown in <figref idref="DRAWINGS">FIG. 18</figref>.</p>
<p id="p-0109" num="0108">Also, in the case where the MDCT coefficients are shifted by four in the direction of the frequency axis and then added to the original MDCT coefficient so as to embed the additional information as a watermark WM, if a shift is generated in the phase of the sample values when carrying out MDCT again after the audio signal is converted to an analog signal in simply demodulating a signal such that the MDCT coefficients of the same polarity increase, the additional information sometimes cannot be read out in accordance with the combination of the positive and negative polarities.</p>
<p id="p-0110" num="0109">Meanwhile, in the case where the MDCT coefficients are shifted by four in the direction of the frequency axis and then added to the original MDCT coefficient so as to embed the additional information as a watermark WM, if a shift is generated in the phase of the sample values, the number of polarity-coincident MDCT coefficients is increased or decreased in the form of a cosine wave. On the other hand, in the case where the MDCT coefficients are shifted by five in the direction of the frequency axis and then added to the original MDCT coefficient so as to embed the additional information as a watermark WM, if a shift is generated in the phase of the sample values, the number of polarity-coincident MDCT coefficients is increased or decreased in the form of a sine wave. Therefore, in the case where the 1024 sample values are MDCT-transformed as one block, if the phase of the MDCT coefficients is shifted by 128 sample values, a sufficient number of MDCT coefficient of the same polarity, of the MDCT coefficients shifted by five in the direction of the frequency axis, can be obtained even though the total number of MDCT coefficients of the same polarity, of the MDCT coefficients shifted by four in the direction of the frequency axis, is zero. Therefore, the additional information embedded as a watermark can be demodulated.</p>
<p id="p-0111" num="0110">This method is an advantageous technique in the case where detection is to be carried out by a method easier than the method of copy control, or in the application where the phase of MDCT cannot be controlled.</p>
<p id="p-0112" num="0111">Moreover, in synchronization processing for matching to the correct phase, since the position can be roughly specified by checking the values of 4 and 5 of the MDCT coefficients, synchronization to the correct phase can be realized without checking the phase of all the 1024 sample values. Alternatively, the phase where the maximum gain can be obtained of the 1024 sample values may be found.</p>
<p id="p-0113" num="0112"><figref idref="DRAWINGS">FIG. 20</figref> shows the case where the MDCT coefficients are shifted by eight in the direction of the frequency axis and then added to the original MDCT coefficients to as to embed the additional information as a watermark WM and the case where the MDCT coefficients are shifted by nine in the direction of the frequency axis and then added to the original MDCT coefficients so as to embed the additional information as a watermark WM. The distance is changed between 8 and 9 for every 64 sample values. By combining the case where the MDCT coefficients are shifted by eight in the direction of the frequency axis and then added to the original MDCT coefficients to as to embed the additional information as a watermark WM and the case where the MDCT coefficients are shifted by nine in the direction of the frequency axis and then added to the original MDCT coefficients so as to embed the additional information as a watermark WM, rough adjustment for finding the correct phase is made easier.</p>
<p id="p-0114" num="0113">Methods for providing multiple layers for this system will now be described.</p>
<p id="p-0115" num="0114">In the additional information demodulation section <b>22</b>, the MDCT coefficients to be the additional information are added or subtracted in the direction of the high frequencies of the original MDCT coefficients. Alternatively, in the additional information demodulation section <b>22</b>, the MDCT coefficients to be the additional information are added or subtracted in the direction of the low frequencies of the original MDCT coefficients. In these methods, two types of layers which are completely independent can be utilized by setting the relation between the level of the original MDCT coefficients and the level of the added or subtracted MDCT coefficients.</p>
<p id="p-0116" num="0115">Since the MDCT coefficients correspond to the frequency band, the frequency band can be limited by limitation of the MDCT coefficients, as shown in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0117" num="0116">In the case where the MDCT coefficients are shifted in the direction of the frequency axis and then added to the original MDCT coefficients so as to embed the additional information, the same signal as the resultant additional information might exist in a component of the audio signal. In such case, erroneous detection of the additional information occurs.</p>
<p id="p-0118" num="0117">The primary cause of generation of such signal component is that the envelope of the original audio signal is of the same phase as the change to be modulated, or of the inverse phase, as shown in <figref idref="DRAWINGS">FIG. 21B</figref>. In such case, the audio signal of each frequency band often changes with the same phase and therefore highly intensive modulation is carried out. If a large signal to overcome this is used, a problem arises in the sound quality. Thus, to easily discriminate the additional information from the original audio signal, the frequency band is divided into a block A and a block B to have opposite modulation directions, as shown in <figref idref="DRAWINGS">FIG. 21A</figref>. In this example, the frequency band of 1.5 to 5 kHz is divided into the blocks of 1.5 to 3 kHz and 3 to 5 kHz.</p>
<p id="p-0119" num="0118">If these two blocks A and B of the frequency band are modulated in the same direction, the result is as shown in <figref idref="DRAWINGS">FIG. 21C</figref>. However, if these blocks are modulated in the opposite directions, the modulated components of the low-frequency band and the high-frequency band included in the original audio signal are demodulated as data of the opposite phases, as shown in <figref idref="DRAWINGS">FIG. 21D</figref>. Therefore, it is possible cancel only the error signal while maintaining the same gain of the data.</p>
<p id="p-0120" num="0119"><figref idref="DRAWINGS">FIGS. 22A and 22B</figref> are graphs showing the number of the same polarities and the number of different polarities between the MDCT coefficients in the case where frequency division is not carried out. <figref idref="DRAWINGS">FIGS. 23A and 23B</figref> are graphs showing the number of the same polarities and the number of different polarities between the MDCT coefficients in the case where frequency division is carried out. In the case where frequency division is carried out, the data rate and the error rate can be lowered by avoiding as much as possible a pattern that incidentally occurs in the audio signal.</p>
<p id="p-0121" num="0120">In carrying out frequency division, selecting an octave as the frequency to be divided leads to enhancement of the cancel effect. This is due to the musical characteristics. A component including a musical interval inversely acts on the octave, it is useful for maintaining the opposite phase in terms of the probability. Alternatively, it is also effective to select approximately the same number of MDCT coefficients included in the two frequency band blocks A and B.</p>
<p id="p-0122" num="0121">Also, as a method for dividing the frequency band, it is possible to subdivide the frequency band further for the cancellation method in terms of the probability, as shown in <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0123" num="0122">In the application to audio compression, the division characteristics of a polyphase quadrature filter (PQF) of ATRAC2 can be used for the above-described frequency division method. Also, a subband filter of the MPEG layer 3 can be utilized.</p>
<p id="p-0124" num="0123">The additional information which is embedded as a watermark by shifting the MDCT coefficients in the direction of the frequency axis and the adding the resultant MDCT coefficients to the original MDCT coefficients has very high confidentiality so that it will not be separated even when conversion to analog signal or fast Fourier transform is carried out. However, such additional information can be attacked relatively easily by using MDCT. To solve this problem, detection of the additional information embedded in the audio signal using MDCT is carried out by setting the distance between the original MDCT coefficients based on the audio signal and the added MDCT coefficients shifted in the direction of the frequency axis, that is, the number of shifts, and using the polarity of these MDCT coefficients. In the case where the polarity of each MDCT coefficient for generating the additional information is inverted by a pseudo-random signal or the like, whether the signal is modulated by the additional information or not cannot be known even when a third party checks it by using MDCT.</p>
<p id="p-0125" num="0124">As the pseudo-random signal used in this case, a simple PN sequence and a gold code can be used, and complicated DES and elliptic cryptography can also be used. Alternatively, an AC signal of simple repeated inversion of 1 and 0 may be used.</p>
<p id="p-0126" num="0125">Also, by producing false signals from two types of cryptography such as gold codes, then fixing one and changing the other for each terminal of each individual, and changing synthesized cryptography for each terminal unit, the confidentiality of the additional information can be enhanced.</p>
<p id="p-0127" num="0126">Another example of the additional information embedding device for embedding additional information as a watermark into an audio signal and the demodulation device for demodulating the additional information embedded in the audio signal will now be described.</p>
<p id="p-0128" num="0127">The additional information embedding device and the additional information demodulation device in this example, too, are integrally constituted as a codec <b>30</b>, as shown in <figref idref="DRAWINGS">FIG. 24</figref>. This codec <b>30</b> has an A/D converter <b>32</b> for converting an audio signal inputted through an audio signal input terminal <b>30</b><i>a </i>to a digital signal, and an MDCT section <b>34</b> for MDCT-transforming (modified discrete cosine transform) the audio data converted to the digital signal by the A/D converter <b>32</b>. The MDCT section <b>34</b> is adapted for MDCT-transforming a PCM signal so as to output a MDCT coefficient. The MDCT section <b>34</b> carries out one-dimensional discrete cosine transform for a one-dimensional audio signal.</p>
<p id="p-0129" num="0128">The codec <b>30</b> also has a shift/addition section <b>36</b> to which the MDCT coefficient calculated by the MDCT section <b>34</b> is inputted and to which additional information inputted through an additional information input terminal <b>30</b><i>b </i>is inputted. The shift/addition section <b>36</b> shifts in the direction of the frequency axis the MDCT coefficient obtained by transforming the audio signal and supplied from the MDCT section <b>34</b>, and carries out polarity conversion of the original MDCT coefficient on the basis of the additional information, thus coding the MDCT coefficient and the additional information.</p>
<p id="p-0130" num="0129">The signal outputted from the MDCT section <b>34</b> is inputted to an inverse MDCT section <b>38</b>. The inverse MDCT section <b>38</b> carries out inverse modified discrete cosine transform, which is the opposite to the transform by the MDCT section <b>34</b>, with respect to the signal outputted from the MDCT section <b>34</b>.</p>
<p id="p-0131" num="0130">The digital audio data in which the additional information outputted as a digital signal from the inverse MDCT section <b>38</b> is embedded is compression-coded by a compression processing circuit <b>40</b> and outputted as a compression-coded signal through an output terminal <b>31</b>.</p>
<p id="p-0132" num="0131">The codec <b>30</b>, too, is used as the additional information demodulation device and therefore has an additional information demodulation section <b>38</b> for demodulating the additional information embedded in the audio signal from the MDCT coefficient outputted from the MDCT section <b>34</b>. The additional information demodulated by the additional information demodulation section <b>38</b> is outputted to outside of the device through the output terminal <b>31</b>.</p>
<p id="p-0133" num="0132">The additional information embedded as a watermark into the audio signal includes limitation information for prohibiting transfer of the audio signal, limitation information for prohibiting recording of the audio signal to another recording medium, and work data corresponding to the audio signal. The work data includes data for managing the copyright of a music tune or the like corresponding to the audio signal, the copyright holder code, the copyright management number and the like.</p>
<p id="p-0134" num="0133">In the codec <b>30</b> of <figref idref="DRAWINGS">FIG. 24</figref>, the shift/addition section <b>36</b> and the additional information demodulation section <b>38</b> are integrally constituted as a unit circuit <b>35</b>. Since the shift/addition section <b>36</b> and the additional information demodulation section <b>38</b> are integrally constituted as the unit circuit <b>35</b>, access from outside for unauthorized purposes is restrained. Moreover, since the MDCT section <b>34</b>, the unit circuit <b>35</b> and the compression processing circuit <b>40</b> are also integrally constituted as a circuit <b>33</b>, access from outside for unauthorized purposes is restrained. As the circuit <b>33</b>, a circuit for executing ATRAC2 can be used. With such structure, the confidentiality of the codec <b>30</b> is improved and unauthorized access from outside to signal processing by the codec <b>30</b> is made difficult.</p>
<p id="p-0135" num="0134">The procedure for embedding additional information into an audio signal using the codec <b>30</b> having the additional information embedding function shown in <figref idref="DRAWINGS">FIG. 24</figref> will now be described with reference to the flowchart of <figref idref="DRAWINGS">FIG. 25</figref>.</p>
<p id="p-0136" num="0135">As an audio signal is inputted from the audio signal input terminal <b>30</b><i>a </i>at step S<b>11</b>, the audio signal is inputted to the A/D converter <b>32</b>, where it is converted to a digital signal at step S<b>12</b>. The audio signal converted to the digital signal is inputted to the MDCT section <b>34</b>. At step S<b>13</b>, the audio signal inputted to the MDCT section <b>34</b> is MDCT-transformed to calculate MDCT coefficients. The MDCT coefficients calculated by the MDCT section <b>34</b> are inputted to the shift/addition section <b>36</b>.</p>
<p id="p-0137" num="0136">At step S<b>14</b>, whether additional information is inputted to the shift/addition section <b>36</b> or not is discriminated. Specifically, when the input of the additional information indicates “1”, the shift/addition section <b>36</b> at step S<b>15</b> shifts the MDCT coefficients inputted from the MDCT section <b>34</b> by two or by four in the direction of the frequency axis and adds the resultant MDCT coefficients to the original MDCT coefficients, thus embedding the additional information as a watermark WM. On the other hand, when there is no input of additional information, that is, when the additional information indicates “0”, the shift/addition section <b>36</b> outputs the original MDCT coefficients without carrying out the above-described shift and addition. The shift/addition section <b>36</b> adds the MDCT coefficients shifted in the direction of the frequency axis to the original MDCT coefficients when the additional information indicates “1”, and the shift/addition section <b>36</b> does not carry out shift and addition of the MDCT coefficients when the additional information indicates “0”. Thus, the presence or absence of the additional information can be detected on the side of the equipment which receives or is supplied with the audio signal outputted from the additional information embedding device. In the case where the audio signal is sampled by a frequency of 44.1 kHz and 1024 sample values as one block are MDCT-transformed to obtain MDCT coefficients, each one bit of the additional information can be obtained for every 1024 sample values. However, it should be noted that the number of sample values is not limited to 1024.</p>
<p id="p-0138" num="0137">On the MDCT coefficients which are processed by predetermined processing by the shift/addition section <b>36</b>, compression processing in accordance with the compression system of ATRAC2 is performed at step S<b>16</b>. At step S<b>17</b>, the resultant signal is outputted from the output terminal <b>31</b> as a digital audio signal in which the additional information is embedded.</p>
<p id="p-0139" num="0138">The case of demodulating the additional information embedded as a watermark in the audio signal using the codec <b>30</b> shown in <figref idref="DRAWINGS">FIG. 24</figref> will now be described.</p>
<p id="p-0140" num="0139">In the case where the codec <b>30</b> is used as a demodulator, the analog audio signal inputted from the input terminal <b>30</b><i>a </i>is converted to a digital signal by the D/A converter <b>32</b>. The MDCT section <b>34</b> MDCT-transforms the digital signal outputted from the D/A converter <b>32</b> and outputs MDCT coefficients. From the MDCT coefficients, the additional information is demodulated and outputted from the output terminal <b>31</b>.</p>
<p id="p-0141" num="0140">Another example of the additional information embedding device for embedding additional information as a watermark into a compressed digital audio signal and the demodulation device for demodulating the additional information embedded in the compressed digital audio signal will now be described with reference to <figref idref="DRAWINGS">FIG. 26</figref>. This device is useful for receiving and demodulating a digital audio signal distributed, for example, through a communication network.</p>
<p id="p-0142" num="0141">The additional information embedding device and the additional information demodulation device in this example, too, are integrally constituted as a codec <b>50</b>, as shown in <figref idref="DRAWINGS">FIG. 26</figref>. This codec <b>30</b> has an expansion processing section <b>52</b> for expanding a compressed digital audio signal inputted through an input terminal <b>50</b><i>a </i>and for MDCT-transforming (modified discrete cosine transform) the expanded audio data, and a shift/addition section <b>54</b> to which the MDCT coefficient calculated by the expansion processing section <b>52</b> is inputted and to which additional information inputted through an additional information input terminal <b>50</b><i>b </i>is inputted. The shift/addition section <b>54</b> shifts in the direction of the frequency axis the MDCT coefficient obtained by transforming the audio signal and supplied from the expansion processing section <b>52</b>, and carries out polarity conversion of the original MDCT coefficient on the basis of the additional information inputted from the additional information input terminal <b>50</b><i>b</i>, thus coding the MDCT coefficient and the additional information.</p>
<p id="p-0143" num="0142">The signal outputted from the shift/addition section <b>54</b> is inputted to an inverse MDCT section <b>58</b>. The inverse MDCT section <b>58</b> carries out inverse modified discrete cosine transform of the digital data outputted from the shift/addition section <b>54</b>.</p>
<p id="p-0144" num="0143">The digital audio data in which the additional information outputted from the inverse MDCT section <b>58</b> is embedded is converted to an analog audio signal by an A/D converter <b>60</b> and the outputted from an output terminal <b>61</b>.</p>
<p id="p-0145" num="0144">The codec <b>50</b>, too, is used as the additional information demodulation device and therefore has an additional information demodulation section <b>56</b> for demodulating the additional information embedded in the audio signal from the MDCT coefficient outputted from the expansion processing section <b>52</b>. The additional information demodulated by the additional information demodulation section <b>56</b> is outputted to outside of the device through the output terminal <b>61</b>.</p>
<p id="p-0146" num="0145">The additional information embedded as a watermark into the audio signal includes limitation information for prohibiting transfer of the audio signal, limitation information for prohibiting recording of the audio signal to another recording medium, and work data corresponding to the audio signal. The work data includes data for managing the copyright of a music tune or the like corresponding to the audio signal, the copyright holder code, the copyright management number and the like.</p>
<p id="p-0147" num="0146">In the codec <b>50</b> of <figref idref="DRAWINGS">FIG. 26</figref>, the shift/addition section <b>54</b> and the additional information demodulation section <b>56</b> are integrally constituted as a unit circuit <b>53</b>. Since the shift/addition section <b>54</b> and the additional information demodulation section <b>56</b> are integrally constituted as the unit circuit <b>53</b>, access from outside for unauthorized purposes is restrained. Moreover, since the expansion processing section <b>52</b>, the unit circuit <b>53</b> and the inverse MDCT section <b>58</b> are also integrally constituted as a circuit <b>51</b>, access from outside for unauthorized purposes is restrained.</p>
<p id="p-0148" num="0147">Meanwhile, in the case of embedding additional information as a watermark into an audio signal, as described above with reference to <figref idref="DRAWINGS">FIG. 6</figref>, if an envelope of an analog audio signal shown in <figref idref="DRAWINGS">FIG. 6B</figref> is amplitude-modulated (AM) directly by a sine wave as shown in <figref idref="DRAWINGS">FIG. 6C</figref>, side band signals SB can be formed on both sides of the original audio signal as shown in <figref idref="DRAWINGS">FIG. 6A</figref>. Since the side band signals SB function as watermarks with respect to the original audio signal, the additional information can be embedded by utilizing the side band signals SB.</p>
<p id="p-0149" num="0148">Also, in the case of embedding additional information as a watermark into an audio signal, as described above with reference to <figref idref="DRAWINGS">FIG. 7</figref>, if an analog audio signal shown in <figref idref="DRAWINGS">FIG. 7B</figref> is frequency-modulated (FM) by a sine wave of a predetermined frequency as shown in <figref idref="DRAWINGS">FIG. 7C</figref>, side band signals SB can be formed on both sides of the original audio signal as shown in <figref idref="DRAWINGS">FIG. 7A</figref>. Since the side band signals SB function as watermarks with respect to the original audio signal, the additional information can be embedded by utilizing the side band signals SB.</p>
<p id="p-0150" num="0149">Thus, the side band signals SB due to AM modulation and FM modulation can be generated by Hilbert conversion.</p>
<p id="p-0151" num="0150">An example of generation of side band on an audio signal by Hilbert conversion will now be described with reference to <figref idref="DRAWINGS">FIG. 27</figref>.</p>
<p id="p-0152" num="0151">A side band generation circuit <b>100</b> for generating side band signals SB on an audio signal by using Hilbert conversion includes a Hilbert converter <b>102</b> for Hilbert-converting a PCM signal as a digital audio signal inputted from an input terminal <b>101</b><i>a</i>, a modulation frequency generator <b>104</b> for generating a modulation frequency from a control signal such as frequency, gain, phase or the like inputted from an input terminal <b>101</b><i>b</i>, a real part multiplier <b>106</b> for multiplying a real part output from the Hilbert converter <b>102</b> and a real part output from the modulation frequency generator <b>104</b>, an imaginary part multiplier <b>108</b> for multiplying an imaginary part output from the Hilbert converter <b>102</b> and an imaginary part output from the modulation frequency generator <b>104</b>, a first adder <b>110</b> for subtracting an output of the real part multiplier <b>106</b> from an output of the imaginary part multiplier <b>108</b> so as to generate an upper side band signal SB on the high-frequency side of the PCM signal as the original audio signal, and a second adder <b>112</b> for adding the output of the real part multiplier <b>106</b> and the output of the imaginary part multiplier <b>108</b> so as to generate a lower side band signal SB on the low-frequency side of the PCM signal as the original audio signal.</p>
<p id="p-0153" num="0152">By using the side band signals SB thus generated on the high-frequency side and the low-frequency side of the PCM signal as the original audio signal, the additional information can be embedded as a watermark.</p>
<p id="p-0154" num="0153"><figref idref="DRAWINGS">FIG. 28</figref> shows an exemplary modulation device <b>200</b> for AM-modulating or FM-modulating an original audio signal and using side band signals SB generated on both sides of the original audio signal so as to embed additional information as a watermark. The modulation device <b>200</b> has an MDCT section <b>202</b> to which a PCM signal as an original audio signal is inputted through an input terminal <b>201</b>, an audio signal extraction unit <b>204</b> for extracting an audio signal of a predetermined frequency to which additional information is added, an inverse MDCT section <b>206</b>, a watermark generator by Hilbert conversion <b>208</b>, a timing adjustment delay unit <b>210</b>, and a signal embedding circuit <b>212</b>.</p>
<p id="p-0155" num="0154">The MDCT section <b>202</b> carries out MDCT of an audio signal inputted as a PCM signal and thus calculates MDCT coefficients. The audio signal extraction circuit <b>204</b> extracts an audio signal of a predetermined frequency into which additional information is embedded from the MDCT coefficients. The inverse MDCT section <b>206</b> carries out inverse MDCT with respect to the PCM signal extracted by the audio signal extraction circuit <b>204</b>.</p>
<p id="p-0156" num="0155">The watermark generation circuit by Hilbert conversion <b>208</b> has the structure as shown in <figref idref="DRAWINGS">FIG. 27</figref> and generates side band signals SB on both sides of the audio signal of the predetermined frequency in which the additional information is embedded as a watermark.</p>
<p id="p-0157" num="0156">The timing adjustment delay circuit <b>210</b> delays the PCM audio signal inputted through the input terminal <b>201</b> by the time corresponding to the time of processing by the MDCT section <b>202</b>, the audio signal extraction unit <b>204</b>, the inverse MDCT section <b>206</b> and the watermark generator by Hilbert conversion <b>208</b>, thus adjusting the timing.</p>
<p id="p-0158" num="0157">The signal embedding circuit <b>212</b> embeds, as a watermark, the side band signal SB generated in the upper or lower frequency band of the audio signal where the masking effect can be obtained, into the audio signal outputted from the timing adjustment delay circuit <b>210</b>.</p>
<p id="p-0159" num="0158">The modulation device <b>200</b> for embedding additional information as a watermark into an audio signal by using Hilbert conversion can generate the side band signals in upper and lower frequency bands of an audio signal of an arbitrary frequency as shown in <figref idref="DRAWINGS">FIGS. 6A and 7A</figref>, AM modulation and FM modulation can be carried out by frequency shift through Hilbert conversion. Also, since the modulation device <b>200</b> can generate a side band signal SB in either one of upper and lower frequency bands of an audio signal of an arbitrary frequency as shown in <figref idref="DRAWINGS">FIG. 7A</figref>, the additional information can be embedded as a watermark at an arbitrary frequency.</p>
<heading id="h-0006" level="1">INDUSTRIAL APPLICABILITY</heading>
<p id="p-0160" num="0159">According to the present invention, additional information is embedded by orthogonally transforming an audio signal to calculate an orthogonal transform coefficient, then damping and shifting in the direction of the frequency axis the calculated orthogonal transform coefficient, and then adding the resultant orthogonal transform coefficient to the original orthogonal transform coefficient. Therefore, the additional information can be embedded as a watermark into the audio signal. In addition, damage to the addition information embedded as a watermark can be securely prevented even in the case where the audio signal is compressed.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for embedding additional information into an input audio signal and outputting an output audio signal having the embedded additional information, the method comprising the steps of:
<claim-text>orthogonally transforming the input audio signal to generate a plurality of orthogonal transform coefficients;</claim-text>
<claim-text>damping and shifting a predetermined number of orthogonal transform coefficients selected from the plurality of orthogonal transform coefficients by damping the predetermined number of orthogonal transform coefficients by a predetermined amount and shifting the predetermined number of orthogonal coefficients by a predetermined number of units in the direction of the frequency axis;</claim-text>
<claim-text>adding the damped and shifted orthogonal transform coefficients to the original orthogonal transform coefficients to form an output audio signal, the added damped and shifted orthogonal coefficients comprising the embedded additional information; and</claim-text>
<claim-text>outputting the output audio signal having the embedded additional information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein orthogonally transforming the input audio signal includes carrying out a modified discrete cosine transform (MDCT) of the audio signal to calculate MDCT coefficients, and wherein damping and shifting the predetermined number of orthogonal transform coefficients includes damping and shifting the calculated MDCT coefficients in the direction of the frequency axis and adding the damped and shifted MDCT coefficients to the original MDCT coefficients, the added damped and shifted MDCT coefficients comprising the embedded additional information.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes carrying out the shift and addition of the MDCT coefficients within a predetermined frequency band.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes shifting the MDCT coefficients toward the frequency-increasing side and adding the shifted MDCT coefficients to the original MDCT coefficients.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method as claimed in <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes increasing the frequency of the MDCT coefficients by ((sampling frequency/number of samples of MDCT coefficient)×2N) Hz, as the MDCT coefficients are shifted by 2N units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method as claimed in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the amplitude of the MDCT coefficients is substantially equal to the amplitude of the input audio signal.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes shifting the MDCT coefficients toward the frequency-decreasing side and adding the shifted MDCT coefficients to the original MDCT coefficients.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes decreasing the frequency of the MDCT coefficients by ((sampling frequency/number of samples of MDCT coefficient)×2N) Hz, as the MDCT coefficients is shifted by 2N units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method as claimed in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the amplitude of the MDCT coefficients is substantially equal to the amplitude of the input audio signal.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes shifting the MDCT coefficients by 2N units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes shifting the MDCT coefficient by 2N−1 units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes adding the shifted MDCT coefficients within a critical band of a frequency masking area of the MDCT coefficients of the original input audio signal.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes adding the orthogonal transform coefficients shifted on the frequency axis to the original orthogonal transform coefficients so that a frequency masking condition and a temporal masking condition are met.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes carrying out the addition when the value obtained by adding the shifted orthogonal transform coefficients to the value of the original orthogonal transform coefficients is not higher than a predetermined value.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes prohibiting the shift and addition in accordance with the polarity of the value obtained by adding the shifted orthogonal transform coefficients to the value of the original orthogonal transform coefficients.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes carrying out the shift and addition when the input audio signal falls within a range from an upper limit value to a lower limit value.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method as claimed in <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes carrying out the shift and addition when the input audio signal falls within a range from an upper limit value to a lower limit value set on the basis of the human auditory characteristics.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes carrying out the shift and addition of the orthogonal transform coefficients within a predetermined frequency band.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes dividing the frequency band of the input audio signal and carrying out shift and addition for each of the divided frequency bands.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method as claimed in <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein damping and shifting the predetermined number of orthogonal transform coefficients includes reversing the shifting direction of the divided adjacent frequency bands.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising scrambling the output audio signal using a pseudo-random signal.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the embedded additional information comprises limitation information for prohibiting the transfer of the input audio signal.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the embedded additional information comprises limitation information for prohibiting recording of the input audio signal to a recording medium.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the embedded additional information comprises work data corresponding to the input audio signal.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. A device for embedding additional information into an input audio signal and outputting an output audio signal having the embedded additional information, the device comprising:
<claim-text>orthogonal transform means for orthogonally transforming the input audio signal to generate a plurality of orthogonal transform coefficients;</claim-text>
<claim-text>shift and addition means for damping and shifting a predetermined number of orthogonal transform coefficients selected from said plurality of orthogonal transform coefficients by damping the predetermined number of orthogonal transform coefficients by a predetermined amount and shifting the predetermined number of orthogonal coefficients by a predetermined number of units in the direction of the frequency axis and adding the damped and shifted orthogonal transform coefficients to the original orthogonal transform coefficients to form the output audio signal, the added damped and shifted orthogonal coefficients comprising the embedded additional information; and</claim-text>
<claim-text>output means for outputting the output audio signal having embedded additional information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the orthogonal transform means carries out a modified discrete cosine transform (MDCT) of the audio signal to calculate MDCT coefficients, and wherein the shift and addition means damps and shifts the calculated MDCT coefficients in the direction of the frequency axis and adds the damped and shifted MDCT coefficients to the original MDCT coefficients, the added damped and shifted MDCT coefficients comprising the embedded additional information.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The device as claimed in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the shift and addition means carries out the shift and addition of the MDCT coefficients within a predetermined frequency band.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The device as claimed in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the shift and addition means shifts the MDCT coefficients toward the frequency-increasing side and adds the shifted MDCT coefficients to the original MDCT coefficients.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The device as claimed in <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein at the shift and addition means, the frequency of the MDCT coefficients is increased by ((sampling frequency/number of samples of MDCT coefficient)×2N) Hz, as the MDCT coefficients are shifted by 2N units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The device as claimed in <claim-ref idref="CLM-00029">claim 29</claim-ref>, wherein at the shift and addition means, the amplitude of the MDCT coefficients is substantially equal to the amplitude of the input audio signal.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The device as claimed in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the shift and addition means shifts the MDCT coefficients toward the frequency-decreasing side and adds the shifted MDCT coefficients to the original MDCT coefficients.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The device as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein at the shift and addition means, the frequency of the MDCT coefficients is decreased by ((sampling frequency/number of samples of MDCT coefficient)×2N) Hz, as the MDCT coefficients is shifted by 2N units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The device as claimed in <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein at the shift and addition means, the amplitude of the MDCT coefficients is substantially equal to the amplitude of the input audio signal.</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The device as claimed in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the shift and addition means shifts the MDCT coefficients by 2N units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. The device as claimed in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the shift and addition means shifts the MDCT coefficients by 2N−1 units (where N is a natural number).</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The device as claimed in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the shift and addition means adds the shifted MDCT coefficients within a critical band of a frequency masking area of the MDCT coefficients of the original input audio signal.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the shift and addition means adds the orthogonal transform coefficients shifted on the frequency axis to the original orthogonal transform coefficients so that a frequency masking condition and a temporal masking condition are met.</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the shift and addition means carries out the addition when the value obtained by adding the shifted orthogonal transform coefficients to the value of the original orthogonal transform coefficients is not higher than a predetermined value.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the shift and addition means prohibits the shift and addition in accordance with the polarity of the value obtained by adding the shifted orthogonal transform coefficients to the value of the original orthogonal transform coefficients.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the shift and addition means carries out the shift and addition when the input audio signal falls within a range from an upper limit value to a lower limit value.</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. The device as claimed in <claim-ref idref="CLM-00040">claim 40</claim-ref>, wherein the shift and addition means carries out the shift and addition when the input audio signal falls within a range from an upper limit value to a lower limit value set on the basis of the human auditory characteristics.</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the shift and addition means carries out the shift and addition of the orthogonal transform coefficients within a predetermined frequency band.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the shift and addition means divides the frequency band of the input audio signal and carries out shift and addition for each of the divided frequency bands.</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. The device as claimed in <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein the shift and addition means reverses the shifting direction of the divided adjacent frequency bands.</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, further comprising means for scrambling the output audio signal using a pseudo-random signal.</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the orthogonal transform means and the shift and addition means are integrally formed in a single circuit.</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the embedded additional information comprises limitation information for prohibiting transfer of the input audio signal.</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the embedded additional information is limitation information for prohibiting recording of the input audio signal to a recording medium.</claim-text>
</claim>
<claim id="CLM-00049" num="00049">
<claim-text>49. The device as claimed in <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein the embedded additional information is work data corresponding to the input audio signal.</claim-text>
</claim>
<claim id="CLM-00050" num="00050">
<claim-text>50. A method for demodulating embedded additional information in a received audio signal, the embedded additional information generated by performing an inverse orthogonal transform on a predetermined number of a plurality of orthogonal transform coefficients generated by orthogonally transforming the audio signal, the method comprising the steps of:
<claim-text>receiving the audio signal having embedded additional information, the additional information embedded by damping and shifting a predetermined number of orthogonal transform coefficients selected from the plurality of orthogonal transform coefficients by damping the predetermined number of orthogonal transform coefficients by a predetermined amount and shifting the predetermined number of orthogonal coefficients by a predetermined number of units in the direction of the frequency axis and adding the damped and shifted orthogonal transform coefficients to the audio signal on the original frequency axis;</claim-text>
<claim-text>demodulation step of demodulating the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis; and</claim-text>
<claim-text>outputting the demodulated embedded additional information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00051" num="00051">
<claim-text>51. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the step of receiving the audio signal includes receiving the audio signal having embedded additional information, the additional information embedded by damping and shifting in the direction of the frequency axis modified discrete cosine transform (MDCT) coefficient calculated by performing an MDCT on the audio signal and adding the damped and shifted MDCT coefficient to the original MDCT coefficient.</claim-text>
</claim>
<claim id="CLM-00052" num="00052">
<claim-text>52. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the step of receiving the audio signal includes receiving the audio signal having embedded additional information, the additional information embedded by AM modulation, and wherein the demodulation step includes demodulating the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis.</claim-text>
</claim>
<claim id="CLM-00053" num="00053">
<claim-text>53. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the step of receiving the audio signal includes receiving the audio signal having embedded additional information by FM modulation, and wherein the demodulation step includes demodulating the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis.</claim-text>
</claim>
<claim id="CLM-00054" num="00054">
<claim-text>54. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the step of receiving the audio signal includes receiving the audio signal having embedded additional information by Hilbert conversion, and wherein the demodulation step includes demodulating the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis.</claim-text>
</claim>
<claim id="CLM-00055" num="00055">
<claim-text>55. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the step of demodulating includes demodulating the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis within a predetermined frequency band.</claim-text>
</claim>
<claim id="CLM-00056" num="00056">
<claim-text>56. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the embedded additional information comprises control information for prohibiting transfer of the received audio signal.</claim-text>
</claim>
<claim id="CLM-00057" num="00057">
<claim-text>57. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the embedded additional information comprises control information for prohibiting recording of the received audio signal to a recording medium.</claim-text>
</claim>
<claim id="CLM-00058" num="00058">
<claim-text>58. The method as claimed in <claim-ref idref="CLM-00050">claim 50</claim-ref>, wherein the embedded additional information comprises work data corresponding to the received audio signal.</claim-text>
</claim>
<claim id="CLM-00059" num="00059">
<claim-text>59. A device for demodulating embedded additional information in a received audio signal the embedded additional information generated by performing an inverse orthogonal transform on a predetermined number of orthogonal transform coefficients generated by orthogonally transforming the audio signal the device comprising:
<claim-text>receiving means for receiving the audio signal having embedded additional information, the additional information embedded by damping and shifting a predetermined number of orthogonal transform coefficients selected from the plurality of orthogonal transform coefficients by damping the predetermined number of orthogonal transform coefficients by a predetermined amount and shifting the predetermined number of orthogonal coefficients by a predetermined number of units in the direction of the frequency axis and adding the damped and shifted orthogonal transform coefficients to the audio signal on the original frequency axis;</claim-text>
<claim-text>demodulation means for demodulating the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis; and</claim-text>
<claim-text>an outputting means for outputting the demodulated embedded additional information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00060" num="00060">
<claim-text>60. The device as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the receiving means receives the audio signal having embedded additional information, the embedded additional information embedded by damping and shifting in the direction of the frequency axis a modified discrete cosine transform (MDCT) coefficient calculated by performing an MDCT on the audio signal and adding the damped and shifted MDCT coefficient to the original MDCT coefficient.</claim-text>
</claim>
<claim id="CLM-00061" num="00061">
<claim-text>61. The device as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the receiving means receives receiving the audio signal having embedded information, the additional information embedded by AM modulation, and wherein the demodulation means demodulates the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis.</claim-text>
</claim>
<claim id="CLM-00062" num="00062">
<claim-text>62. The device as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the receiving means receives the audio signal having embedded additional information embedded by FM modulation, and wherein the demodulation means demodulates the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis.</claim-text>
</claim>
<claim id="CLM-00063" num="00063">
<claim-text>63. The device as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the receiving means receives the audio signal having embedded additional information embedded by Hilbert conversion, and wherein the demodulation means demodulates the embedded additional information the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis.</claim-text>
</claim>
<claim id="CLM-00064" num="00064">
<claim-text>64. The device as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the demodulation means demodulates the embedded additional information on the basis of the polarity of the received audio signal at predetermined intervals on the frequency axis within a predetermined frequency band of the received audio signal.</claim-text>
</claim>
<claim id="CLM-00065" num="00065">
<claim-text>65. The device as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the embedded additional information comprises control information for prohibiting transfer of the received audio signal.</claim-text>
</claim>
<claim id="CLM-00066" num="00066">
<claim-text>66. The method as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the embedded additional information comprises control information for prohibiting recording of the received audio signal to a recording medium.</claim-text>
</claim>
<claim id="CLM-00067" num="00067">
<claim-text>67. The method as claimed in <claim-ref idref="CLM-00059">claim 59</claim-ref>, wherein the embedded additional information comprises work data corresponding to the received audio signal.</claim-text>
</claim>
</claims>
</us-patent-grant>
