<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299017-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299017</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10760532</doc-number>
<date>20040121</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>FI</country>
<doc-number>20031609</doc-number>
<date>20031106</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>551</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>17</main-group>
<subgroup>02</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>455137</main-classification>
<further-classification>455 6713</further-classification>
<further-classification>375343</further-classification>
<further-classification>375347</further-classification>
</classification-national>
<invention-title id="d0e71">Communication method, receiver and base station</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6128355</doc-number>
<kind>A</kind>
<name>Backman et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375347</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2001/0017883</doc-number>
<kind>A1</kind>
<name>Tiirola et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375148</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2003/0076908</doc-number>
<kind>A1</kind>
<name>Huang et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375350</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2004/0114695</doc-number>
<kind>A1</kind>
<name>Astely et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375343</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0101279</doc-number>
<kind>A1</kind>
<name>Lee et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4552781</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2005/0111596</doc-number>
<kind>A1</kind>
<name>Olsson et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375346</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>WO</country>
<doc-number>WO 98/53560</doc-number>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>WO</country>
<doc-number>WO 02/075950</doc-number>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>455 6711</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 6713</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 631</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 6714</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552781</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455137</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375347</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375148</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375343</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>2</number-of-drawing-sheets>
<number-of-figures>3</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050101253</doc-number>
<kind>A1</kind>
<date>20050512</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Pajukoski</last-name>
<first-name>Kari</first-name>
<address>
<city>Oulu</city>
<country>FI</country>
</address>
</addressbook>
<nationality>
<country>FI</country>
</nationality>
<residence>
<country>FI</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Tiirola</last-name>
<first-name>Esa</first-name>
<address>
<city>Oulu</city>
<country>FI</country>
</address>
</addressbook>
<nationality>
<country>FI</country>
</nationality>
<residence>
<country>FI</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ylitalo</last-name>
<first-name>Juha</first-name>
<address>
<city>Oulu</city>
<country>FI</country>
</address>
</addressbook>
<nationality>
<country>FI</country>
</nationality>
<residence>
<country>FI</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Squire, Sanders &amp; Dempsey L.L.P.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Nokia Corporation</orgname>
<role>03</role>
<address>
<city>Espoo</city>
<country>FI</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Phu</last-name>
<first-name>Sanh D.</first-name>
<department>2618</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A multi-user receiver which uses at least two antenna elements and in which the influence of interference is reduced, the receiver comprises: means (<b>200</b>) for pre-filtering a wideband antenna signal, the pre-filtering means being determined on the basis of a spatial covariance matrix estimate, which spatial covariance matrix estimate is obtained from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector, means (<b>210, 218</b>) for removing the whitening from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter, means (<b>202, 204, 206, 208, 210</b>) for performing multi-path combining and multi-antenna combining.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="108.63mm" wi="156.38mm" file="US07299017-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="193.72mm" wi="99.31mm" file="US07299017-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="222.25mm" wi="159.17mm" file="US07299017-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD</heading>
<p id="p-0002" num="0001">The invention relates to a method for reducing the influence of interference in a multi-user receiver, when the multi-user receiver receives signals from users having different data rates using at least two antenna elements. The invention also relates to a multi-user receiver and a base station.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Several combining techniques have usually been used to combine diversity antennas or different antenna branches in antenna arrays to create nulls towards interfering signals while maintaining a large antenna gain towards the desired signal, thus reducing interference. One example of combining techniques is interference rejection combining (IRC). Conventionally the IRC is carried out at symbol level after despreading operations. This requires that the IRC operations need to be implemented separately for each user, thus increasing the complexity of a receiver. For simplifying the receiver structure, the IRC technique is combined with a maximal ratio combining (MRC) technique, whereupon an IRC filter acts as a pre-whitening filter in WO 02/075950. The IRC technique is also examined in Esa Tiirola, Juha Ylitalo: Performance of Smart Antenna Receivers in WCDMA Uplink with Spatially Coloured Interference, IST Mobile Communications Summit 2001, Barcelona, Spain, 9-12 Sep. 2001, which is incorporated herein by reference. While the IRC technique is used in a pre-whitening filter, the pre-whitening is carried out by antenna weighting, which is performed on all users. Thus there arises a problem: the high bit rate users are seen as relatively high level interferers to low bit rate users and therefore taken into account when determining whitening weights. As a consequence of this, in whitening, the combining of antenna signals is not optimal from the high data rate user's point of view. The use of a non-optimal solution will diminish the uplink coverage of high data rate users and at the same time increase the user terminal's battery consumption for the high bit rate users.</p>
<heading id="h-0003" level="1">BRIEF DESCRIPTIONS OF THE INVENTION</heading>
<p id="p-0004" num="0003">The invention provides an improved method, receiver and base station.</p>
<p id="p-0005" num="0004">According to an embodiment, there is provided a method for reducing the influence of interference in a multi-user receiver, when the multi-user receiver receives signals from users having different data rates using at least two antenna elements, the method comprises: creating a spatial covariance matrix estimate from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector, determining a whitening filter on the basis of the spatial covariance matrix estimate, whitening received signals by using the whitening filter, removing the whitening from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter, conveying whitened signals and the signals from which the whitening has been removed to a receiver element, which carries out multi-path combining and multi-antenna combining.</p>
<p id="p-0006" num="0005">According to another embodiment, there is provided a multi-user receiver which uses at least two antenna elements and in which the influence of interference is reduced, the receiver comprises: means for pre-filtering a wideband antenna signal, the pre-filtering means being determined on the basis of a spatial covariance matrix estimate, which spatial covariance matrix estimate is obtained from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector, means for removing the whitening from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter, means for performing multi-path combining and multi-antenna combining.</p>
<p id="p-0007" num="0006">According to another embodiment, there is provided a multi-user receiver which uses at least two antenna elements and in which the influence of interference is reduced, the receiver comprises: one branch with a whitening arrangement, another branch without a whitening arrangement and a switching arrangement conveying received signals to the branch with the whitening arrangement or to the branch without the whitening arrangement depending on the used bit rate, a receiver element performing multi-path combining and multi-antenna combining.</p>
<p id="p-0008" num="0007">According to another embodiment, there is provided a multi-user receiver in which the influence of interference is reduced, comprising: a pre-filter whitening a wideband antenna signal, the pre-filter being determined on the basis of a spatial covariance matrix estimate which spatial covariance matrix estimate is obtained from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector, a whitening removing arrangement removing the whitening from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter, a receiver element performing multi-path combining and multi-antenna combining.</p>
<p id="p-0009" num="0008">According to another embodiment, there is provided a base station comprising a multi-user receiver which receiver uses at least two antenna elements and in which base station the influence of the interference is reduced, the base station comprises: means for pre-filtering a wideband antenna signal, the pre-filtering means being determined on the basis of a spatial covariance matrix estimate, which spatial covariance matrix estimate is obtained from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector, means for removing the whitening from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter, means for performing multi-path combining and multi-antenna combining.</p>
<p id="p-0010" num="0009">According to another embodiment, there is provided a base station comprising a multi-user receiver which uses at least two antenna elements and in which base station the influence of the interference is reduced, the base station comprises: one branch with a whitening arrangement, another branch without a whitening arrangement and a switching arrangement conveying received signals to the branch with the whitening arrangement or to the branch without the whitening arrangement depending on the used bit rate, an element performing multi-path combining and multi-antenna combining.</p>
<p id="p-0011" num="0010">According to another embodiment, there is provided a base station comprising a multi-user receiver which uses at least two antenna elements and in which base station the influence of the interference is reduced, the receiver comprises: a pre-filter whitening a wideband antenna signal, the pre-filter being determined on the basis of a spatial covariance matrix estimate, which spatial covariance matrix estimate is obtained from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector, a whitening removing arrangement removing the whitening from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter, an element performing multi-path combining and multi-antenna combining.</p>
<p id="p-0012" num="0011">The method and system of the invention provide several advantages. In one embodiment of the invention, the whitening performed by a pre-whitening filter can be removed from predetermined users and therefore the signals can be combined optimally. In another embodiment of the invention, the predetermined users are conveyed to by-pass a pre-whitening filter, thus preventing disadvantages caused by whitening.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">LIST OF DRAWINGS</heading>
<p id="p-0013" num="0012">In the following, embodiments of the invention will be described in greater detail with reference to the preferred embodiments and the accompanying drawings, in which</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> shows an example of a method for reducing the influence of interference in a multi-user receiver,</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an example of a receiver structure for reducing the influence of interference in a multi-user receiver,</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> shows an example of a receiver structure for reducing the influence of interference in a multi-user receiver.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DESCRIPTION OF EMBODIMENTS</heading>
<p id="p-0017" num="0016">With reference to <figref idref="DRAWINGS">FIG. 1</figref>, let us examine an embodiment of a method for reducing the influence of interference in a multi-user receiver. The method may be used in several kinds of radio receivers, such as a base station of a communication system, for instance a base station used in a wide-band code division multiple access system (WCDMA), such as UMTS (universal mobile telecommunications system). The receiver may, for example, be a Rake receiver or a receiver having diversity antennas. The embodiment is directed to a receiver having a pre-whitening filter in the front-end of an MRC receiver.</p>
<p id="p-0018" num="0017">The embodiment is especially suitable for systems where there are users having different bit rates, for example, the majority of users use low bit rate services and some users use high bit rate services and the receiver uses several antenna elements. Data rates, which are classified as low or high, vary according to the current system; the data rates tend to increase due to technology development. In this application, the concept of high bit rate users means users having a relatively high bit rate and low bit rate users mean users having a relatively low bit rate. It is possible to set a bit rate threshold and classify users exceeding it as high bit rate users.</p>
<p id="p-0019" num="0018">The embodiment starts in block <b>100</b>. In block <b>102</b>, a covariance matrix estimate is created from wideband antenna signals by sampling, arranging sampled values into a signal vector and by multiplying the signal vector by its conjugate transpose vector. The signals received by different antennas are preferably sampled simultaneously, for which reason sampled values are arranged into a vector format. The size of the vector depends on the number of antennas. Several sampling methods are known in the art and therefore they are not explained here in further detail.</p>
<p id="p-0020" num="0019">The wideband antenna signal vector representing the desired signal of a single user, related interference and noise can be defined as</p>
<p id="p-0021" num="0020">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>x</mi>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>j</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mi>l</mi>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>h</mi>
                <mi>l</mi>
              </msub>
              <mo>⁢</mo>
              <mrow>
                <msub>
                  <mi>y</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>j</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>τ</mi>
                      <mi>l</mi>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
            <msub>
              <mi>u</mi>
              <mi>i</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>j</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0021">wherein</li>
        <li id="ul0002-0002" num="0022">h is a channel model as a tapped delay line with an impulse response</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0022" num="0023">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <munderover>
    <mo>∑</mo>
    <mi>l</mi>
    <mstyle>
      <mspace width="0.3em" height="0.3ex"/>
    </mstyle>
  </munderover>
  <mo>⁢</mo>
  <mrow>
    <msub>
      <mi>h</mi>
      <mi>l</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <mi>δ</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>j</mi>
          <mo>-</mo>
          <msub>
            <mi>τ</mi>
            <mi>l</mi>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0024">u<sub>i </sub>is a vector including interference and noise components of signal samples,</li>
        <li id="ul0004-0002" num="0025">y<sub>i </sub>is a complex-valued transmitted signal,</li>
        <li id="ul0004-0003" num="0026">i is a time slot index,</li>
        <li id="ul0004-0004" num="0027">j is a chip index,</li>
        <li id="ul0004-0005" num="0028">δ means the Dirac's delta function,</li>
        <li id="ul0004-0006" num="0029">τ means a relative delay of a multi-path component,</li>
        <li id="ul0004-0007" num="0030">Σ means summing.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0023" num="0031">The signal spatial covariance matrix is then calculated by multiplying the signal vector (1) by its conjugate transpose (Hermitian) vector x<sub>i</sub>(j)<sup>H</sup>.</p>
<p id="p-0024" num="0032">The spatial covariance estimate matrix is typically averaged over a selected period of time, for instance, the averaging length can be chosen to be a time slot or a fraction of it.</p>
<p id="p-0025" num="0033">The spatial covariance estimate matrix averaged over a time slot having 2560 chips can be expressed as follows</p>
<p id="p-0026" num="0034">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mover>
            <mi>R</mi>
            <mo>^</mo>
          </mover>
          <mrow>
            <mi>xx</mi>
            <mo>,</mo>
            <mi>i</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mn>2560</mn>
          </mfrac>
          <mo>⁢</mo>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mn>2560</mn>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>x</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>j</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>⁢</mo>
              <msup>
                <mrow>
                  <msub>
                    <mi>x</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>j</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mi>H</mi>
              </msup>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0035">wherein</li>
        <li id="ul0006-0002" num="0036">x<sub>i </sub>is a wideband antenna signal matrix,</li>
        <li id="ul0006-0003" num="0037">i is a time slot index,</li>
        <li id="ul0006-0004" num="0038">j is a chip index.</li>
        <li id="ul0006-0005" num="0039">Σ means summing.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0027" num="0040">In block <b>104</b>, a whitening filter is determined on the basis of the covariance matrix estimate. The whitening filter is typically implemented by using a whitening filter matrix. The whitening filter matrix may be obtained in such a way that is satisfies</p>
<p id="p-0028" num="0041">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>W</mi>
            <mi>i</mi>
          </msub>
          <mo>⁢</mo>
          <msubsup>
            <mi>W</mi>
            <mi>i</mi>
            <mi>H</mi>
          </msubsup>
        </mrow>
        <mo>=</mo>
        <msubsup>
          <mover>
            <mi>R</mi>
            <mo>^</mo>
          </mover>
          <mrow>
            <mi>xx</mi>
            <mo>,</mo>
            <mi>i</mi>
          </mrow>
          <mrow>
            <mo>-</mo>
            <mn>1</mn>
          </mrow>
        </msubsup>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0042">wherein</li>
        <li id="ul0008-0002" num="0043">{circumflex over (R)}<sub>xx,i </sub>is a covariance matrix estimate,</li>
        <li id="ul0008-0003" num="0044">W<sub>i </sub>is a whitening filter matrix,</li>
        <li id="ul0008-0004" num="0045">W<sub>i</sub><sup>H </sup>is a complex-conjugate (Hermitian) matrix of the whitening filter matrix,</li>
        <li id="ul0008-0005" num="0046"><sup>−1 </sup>denotes inversion.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0029" num="0047">The whitening filter matrix can be solved by using Cholesky decomposition, because matrix {circumflex over (R)}<sub>xx,i </sub>is a symmetric and positive definite matrix. The Cholesky decomposition of the spatial covariance matrix estimate {circumflex over (R)}<sub>xx,i </sub>may be written as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>{circumflex over (R)}<sub>xx,i</sub>=U<sup>H</sup>U  (4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0000">
    <ul id="ul0010" list-style="none">
        <li id="ul0010-0001" num="0048">wherein</li>
        <li id="ul0010-0002" num="0049">U is an upper triangular matrix.</li>
        <li id="ul0010-0003" num="0050">If the filter W is chosen as the inverse of the Cholesky factor, i.e.,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>UW=I<sub>m</sub>  (5)<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
        <li id="ul0010-0004" num="0051">wherein</li>
        <li id="ul0010-0005" num="0052">I<sub>m </sub>is an identity matrix of size m, then it follows that the equation (3) is satisfied.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0030" num="0053">In block <b>106</b>, received signals are whitened by using the whitening filter. The whitening may be carried out by a complex matrix multiplication.</p>
<p id="p-0031" num="0054">The purpose of whitening is to whiten coloured noise or interference, which means that the powers of interfering signals are transformed by filtering to be similar to that of white Gaussian noise. The whitening adjusts signals for the MRC (maximal ratio combining) because the MRC performance is optimal in case that noise or interference is spatially white Gaussian. The assumption of spatially white Gaussian noise is valid for the interference scenario with a large number of low bit rate users. When there are also high bit rate users, the interference is coloured, in other words the interference is not uncorrelated between different antennas. Whitened received signals (received chips) obtained by matrix multiplication may be written as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>x<sub>w,i</sub>(j)=W<sub>i</sub>x<sub>i</sub>(j)  (6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0011" list-style="none">
    <li id="ul0011-0001" num="0000">
    <ul id="ul0012" list-style="none">
        <li id="ul0012-0001" num="0055">wherein</li>
        <li id="ul0012-0002" num="0056">W<sub>i </sub>is a whitening filter matrix,</li>
        <li id="ul0012-0003" num="0057">x<sub>i </sub>is a wideband antenna signal matrix,</li>
        <li id="ul0012-0004" num="0058">i is a time slot index,</li>
        <li id="ul0012-0005" num="0059">j is a chip index.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0032" num="0060">In block <b>108</b>, the whitening is removed from signals of predetermined users by using an inverse matrix of the matrix used in the whitening filter. Removing is typically carried out by matrix multiplication. The removing may be carried out in different places in a reception chain: if the whitening is removed from channel estimates, the channel impulse response matrix is multiplied by the inverse matrix of the whitening matrix, or if the whitening is removed from despread data, the despread data arranged in a matrix format is multiplied by the inverse matrix of the whitening matrix, for example. The whitening is removed from predetermined signals, which in practice can be implemented, for instance, by using a bit rate threshold: the whitening is removed from signals exceeding the threshold.</p>
<p id="p-0033" num="0061">In practice, the whitening is preferably carried out before a prior art MRC (maximal ratio combining) receiver. The removing of the whitening may also be carried out before the MRC receiver or it may be incorporated in it. The principle of the MRC is that different phase offsets of each received signal are estimated and compensated for after demodulation, the power level of each received signal is estimated and the phase-corrected demodulator outputs are weighted in direct proportion of the received signal strength, the phase-corrected and weighted signals are summed and fed to the detector. The MRC technique is known in the art and is therefore not explained here in greater detail.</p>
<p id="p-0034" num="0062">In block <b>110</b>, whitened signals and the signals from which the whitening has been removed are conveyed to a receiver element, which carries out multi-path combining and multi-antenna combining. The element performing multi-path combining and multi-antenna combining may be a maximum ratio combiner. In one embodiment, the multi-path combining and the multi-antenna combining are carried out according to the Rake principle. Arrow <b>116</b> depicts that both whitened signals and signals from which the whitening has been removed are conveyed to the multi-path combining and multi-antenna combining.</p>
<p id="p-0035" num="0063">The embodiment ends in block <b>112</b>. Arrow <b>114</b> depicts one possibility for repeating the embodiment. A generalised example of a part of a receiver depicted by <figref idref="DRAWINGS">FIG. 2</figref> is now examined. It is obvious to a person skilled in the art that the receiver may also include elements other than those illustrated in <figref idref="DRAWINGS">FIG. 2</figref>. The receiver may be located in several kinds of communication units, such as a base station of a communication system, for instance a base station used in a wideband code division multiple access system (WCDMA), such as UMTS (universal mobile telecommunications system). The receiver may, for example, be a Rake receiver.</p>
<p id="p-0036" num="0064">The receiver includes an antenna array or diversity antennas <b>212</b>, <b>214</b>. The number of antennas may vary according to the implementation. The IRC block <b>200</b> is a pre-whitening filter carrying out whitening operation. The pre-whitening filter is determined on the basis of a spatial covariance matrix estimate, which is obtained from the sampled antenna signals. The pre-whitening filter determination is explained above with the aid of the embodiment depicted in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0037" num="0065">The MRC receiver structure <b>216</b> includes in this embodiment one receiver element <b>202</b>, <b>204</b>, <b>206</b>, <b>208</b>, <b>210</b> per each user. Some of them <b>202</b>, <b>204</b>, <b>206</b>, <b>208</b> are for low bit rate users and one <b>210</b> for a high bit rate user. The number of MRC receiver elements may vary according to the implementation. In this embodiment, the MRC receiver elements use the Rake principle for multi-path combining and multi-antenna combining.</p>
<p id="p-0038" num="0066">Low bit rate users are conveyed to their MRC receiver elements for MRC processing. The MRC process includes estimation and compensation for phase offsets of each received signal after demodulation, power level estimation of each received signal, weighting of phase-corrected demodulator outputs in direct proportion of the received signal strength and summation of the phase-corrected and weighted signals. The output of each MRC receiver element is then conveyed to the detector <b>220</b>. The MRC technique is known in the art and is therefore not explained here in greater detail.</p>
<p id="p-0039" num="0067">The predetermined user, typically a high bit rate user, is conveyed to its MRC element, where the whitening carried out by a pre-whitening filter <b>200</b> is removed by using an inverse matrix W<sub>i</sub><sup>−1 </sup>of the matrix used in the whitening filter. Removing is typically carried out by matrix multiplication. The removing may be carried out in different points of a transmission chain: if the whitening is removed from channel estimates, the estimate channel impulse response matrix is multiplied by the inverse matrix of the whitening matrix, or if the whitening is removed from despread data, the despread data arranged in a matrix format is multiplied by the inverse matrix of the whitening matrix, for example. The whitening is removed from predetermined signals, which in practice can be implemented, for instance, by using a bit rate threshold: the whitening is removed from signals exceeding the threshold. The removing may also be carried out in a separate removing block in the front end of a MRC receiver or receiver element.</p>
<p id="p-0040" num="0068">The control block <b>218</b> controls the function of the MRC receiver and also the removing of whitening. The whitening and the removing of whitening are typically implemented according to the present embodiment as a processor and software, but different hardware implementations are also feasible, e.g. a circuit built of separate logic components or one or more client-specific integrated circuits (Application-Specific Integrated Circuit, ASIC). A hybrid of these implementations is also feasible.</p>
<p id="p-0041" num="0069">Next another generalised example of a part of a receiver is examined with the aid of <figref idref="DRAWINGS">FIG. 3</figref>. The receiver of this embodiment includes one branch with a whitening procedure and another branch without a whitening procedure. Received signals are conveyed to the branch with the whitening procedure or to the branch without the whitening procedure depending on the used bit rate.</p>
<p id="p-0042" num="0070">It is obvious to a person skilled in the art that the receiver may also include elements other than illustrated in <figref idref="DRAWINGS">FIG. 3</figref>. The receiver may be located in several kinds of communication units, such as a base station of a communication system, for instance a base station used in a wideband code division multiple access system (WCDMA), such as UMTS (universal mobile telecommunications system). The receiver may, for example, be a Rake receiver.</p>
<p id="p-0043" num="0071">The receiver includes an antenna array or diversity antennas <b>312</b>, <b>314</b>. The number of antennas may vary according to the implementation. The IRC block <b>300</b> is a pre-whitening filter carrying out whitening operation. The pre-whitening filter is determined on the basis of a spatial covariance matrix estimate, which is obtained from the sampled antenna signals. The pre-whitening filter determination is explained above with the aid of the embodiment depicted in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0044" num="0072">The receiver also includes logical MRC receivers <b>302</b>, <b>304</b>, <b>306</b>, <b>308</b> for low bit rate users and one <b>310</b> for a high bit rate user. There are available two connections per antenna: one <b>322</b>A, <b>324</b>A for wideband antenna signal passing the pre-whitening filter (IRC block) <b>300</b> and another one <b>322</b>B, <b>324</b>B which conveys signals to the pre-whitening filter. There is also a switching block <b>318</b> which switches low bit rate users to their MRC receivers <b>302</b>, <b>304</b>, <b>306</b>, <b>308</b> and a high bit rate user to its MRC receiver <b>310</b>. In this embodiment, the MRC receiver elements use the Rake principle for multi-path combining and multi-antenna combining. The MRC process includes estimation and compensation for phase offsets of each received signal after demodulation, power level estimation of each received signal, weighting of phase-corrected demodulator outputs in direct proportion of the received signal strength and summation of the phase-corrected and weighted signals. The output of each MRC receiver element is then conveyed to the detector <b>320</b>. The MRC technique is known in the art and is therefore not explained here in greater detail.</p>
<p id="p-0045" num="0073">The control block <b>316</b> controls the function of the switching block <b>318</b> according to the user's bit rate conveying the high bit rate users to by-pass the pre-whitening filter <b>300</b>. The switching is typically implemented as a hardware implementation.</p>
<p id="p-0046" num="0074">Even though the invention is described above with reference to an example according to the accompanying drawings, it is clear that the invention is not restricted thereto but it can be modified in several ways within the scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07299017-20071120-M00001.NB">
<img id="EMI-M00001" he="7.79mm" wi="76.20mm" file="US07299017-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07299017-20071120-M00002.NB">
<img id="EMI-M00002" he="7.79mm" wi="76.20mm" file="US07299017-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07299017-20071120-M00003.NB">
<img id="EMI-M00003" he="9.14mm" wi="76.20mm" file="US07299017-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07299017-20071120-M00004.NB">
<img id="EMI-M00004" he="4.91mm" wi="76.20mm" file="US07299017-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A multi-user receiver comprising:
<claim-text>a branch with a whitening arrangement;</claim-text>
<claim-text>another branch without a whitening arrangement;</claim-text>
<claim-text>a switching means for conveying received signals to the branch with the whitening arrangement or to the another branch without the whitening arrangement depending on a used bit rate, wherein the multi-user receiver is configured to use at least two antenna elements and in which an influence of interference is reduced;</claim-text>
<claim-text>receiving means for performing multi-path combining and multi-antenna combining; and</claim-text>
<claim-text>determining means for determining the predetermined users from whom the whitening is removed based on a bit rate threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The multi-user receiver of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the whitening is carried out in the whitening arrangement by complex matrix multiplication.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The multi-user receiver of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the receiving means for performing the multi-path combining and the multi-antenna combining comprises a maximum ratio combiner.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A base station comprising:
<claim-text>a multi-user receiver, wherein the multi-user receiver is configured to use at least two antenna elements and, in the base station, an influence of an interference is reduced;</claim-text>
<claim-text>a branch with a whitening arrangement, another branch without a whitening arrangement and a switching arrangement configured to convey received signals to the branch with the whitening arrangement or to the another branch without the whitening arrangement depending on a used bit rate;</claim-text>
<claim-text>an element configured to perform multi-path combining and multi-antenna combining; and</claim-text>
<claim-text>a determining unit configured to determine the predetermined users from whom the whitening is removed based on a bit rate threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A multi-user receiver comprising:
<claim-text>a branch with a whitening arrangement;</claim-text>
<claim-text>another branch without a whitening arrangement;</claim-text>
<claim-text>a switching arrangement configured to convey received signals to the branch with the whitening arrangement or to the another branch without the whitening arrangement depending on a used bit rate, wherein the multi-user receiver uses at least two antenna elements and in which an influence of interference is reduced;</claim-text>
<claim-text>a receiver element configured to perform multi-path combining and multi-antenna combining; and</claim-text>
<claim-text>a determining unit configured to determine the predetermined users from whom the whitening is removed based on a bit rate threshold.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The multi-user receiver of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the whitening is carried out in the whitening arrangement by complex matrix multiplication.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The multi-user receiver of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the receiver element comprises a maximum ratio combiner.</claim-text>
</claim>
</claims>
</us-patent-grant>
