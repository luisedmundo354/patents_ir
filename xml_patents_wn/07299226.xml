<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299226-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299226</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10465148</doc-number>
<date>20030619</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>425</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>707  5</main-classification>
<further-classification>707  6</further-classification>
<further-classification>707  7</further-classification>
</classification-national>
<invention-title id="d0e53">Cardinality estimation of joins</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6865567</doc-number>
<kind>B1</kind>
<name>Oommen et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  2</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00002">
<othercit>Nicolas Bruno &amp; Surajit Chaudhuri, “Exploiting Statistics on Query Expressions for Optimization”, ACM SIGMOD Jun. 4-6, 2002, Madison, Wisconsin, USA.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00003">
<othercit>Nicolas Bruno, “Automatic Management of Statictics on Query Expression in Relational Databases”, Department of Computer Science, Columbia University, Apr. 25, 2002, New York, NY.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00004">
<othercit>Nicolas Bruno, Surajit Chaudhuri, Luis Gravano; “STHoles: a Multidimensional Workload-Aware Histogram”; ACM SIGMOD May 21-24, 2001; Santa Barbara, California, USA.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00005">
<othercit>P.G. Selinger, M.M. Astrahan, D.D. Chamberlin, R.A. Lorie, T.G. Price: Access Path Selection in a Relational Database Management System, <i>In Proceedings of the 1979 ACM Int'l Conference on Management of Data </i>(SIGMOD '79), 1979.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>H. Garcia-Molina, J.D. Ullman and Jennider Widom. <i>Database System Implementation </i>Prentice Hall, 2000. (Section 7.4.4).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>707  2</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707  5</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707  6</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707  7</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040260675</doc-number>
<kind>A1</kind>
<date>20041223</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bruno</last-name>
<first-name>Nicolas</first-name>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Krishna</last-name>
<first-name>Murali</first-name>
<address>
<city>Bellevue</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Wu</last-name>
<first-name>Ming-Chuan</first-name>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Chaudhuri</last-name>
<first-name>Surajit</first-name>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Microsoft Corporation</orgname>
<role>02</role>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Alam</last-name>
<first-name>Shahid</first-name>
<department>2162</department>
</primary-examiner>
<assistant-examiner>
<last-name>Colan</last-name>
<first-name>Giovanna B.</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method of estimating cardinality of a join of tables using multi-column density values and additionally using coarser density values of a subset of the multi-column density attributes. In one embodiment, the subset of attributes for the coarser densities is a prefix of the set of multi-column density attributes. A number of tuples from each table that participate in the join may be estimated using densities of the subsets. The cardinality of the join can be estimated using the multi-column density for each table and the estimated number of tuples that participate in the join from each table.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="167.47mm" wi="168.91mm" file="US07299226-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="235.88mm" wi="172.30mm" orientation="landscape" file="US07299226-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="251.46mm" wi="170.35mm" orientation="landscape" file="US07299226-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="177.72mm" wi="168.15mm" file="US07299226-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="179.66mm" wi="169.59mm" file="US07299226-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="159.17mm" wi="131.74mm" file="US07299226-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="230.04mm" wi="161.88mm" file="US07299226-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present disclosure concerns a method of estimating cardinality of a join of tables using multi-column density values, and more particularly, the present disclosure relates to a method of estimating cardinality of a join of tables using multi-column density values and additionally using coarser density values of a subset of the multi-column density attributes.</p>
<heading id="h-0002" level="1">BACKGROUND ART</heading>
<p id="p-0003" num="0002">Relational databases systems allow a database user to enter queries into the database and return the data that meets the conditions of the query. The data present within the database system is in one or more tables or relations. Each relation consists of a number of records or tuples containing specific information possibly grouped in some ordered sequence. Each tuple consists of one or more fields called attributes. In any single attribute of a tuple there can be only a single value. However, each tuple can have a different value for the same attribute.</p>
<p id="p-0004" num="0003">Some characteristics of a database relation are typically maintained. For example, the database system may maintain the cardinality, the density and the number of distinct values of each relation. Cardinality is the number of tuples or records in a relation. The number of distinct values is the number of distinct values of a given attribute or set of attributes. The density is the average number of tuples per distinct value.</p>
<p id="p-0005" num="0004">One operation performed by a database system is known as a join operation. A join operation is used to combine related tuples from two relations into single tuples. Typically, the join operation matches tuples from two relations on the values taken from each relation on a common attribute and creates a joined table or relation. If another relation needs to be joined with the result relation, the result relation may be referred to as an intermediate relation because it is created in the process of generating a result relation.</p>
<p id="p-0006" num="0005">Another operation performed by a database system is the select operation. The select operation is used to select a subset of tuples from a relation that satisfy a selection condition. One can consider the select operation to be a filter that keeps only those tuples that satisfy a qualifying condition.</p>
<p id="p-0007" num="0006">A query entered into a relational database system may result in multiple operations being performed. For example, selection operations on one or more relations can be used together with multiple join operations in the same query. In many cases, the operations of the query can be performed in several different orders without changing the result of the query. Each possible order of operations is referred to as a query execution plan. There may be several alternative query execution plans, each specifying a set of operations to be executed by the database system. Each different query execution plan will have a different “cost.” The costs may include the cost of accessing secondary storage, computation cost, memory usage cost, and communication cost.</p>
<p id="p-0008" num="0007">Relational database systems typically include a component called a query optimizer. The query optimizer may identify several query execution plans, estimate the cost of each different query execution plan, and select the plan with the lowest estimated cost for execution. Query plans generated for a query will differ in their total cost of obtaining the desired data. The query optimizer evaluates these cost estimates for each query plan in order to determine which plan is likely to have the lowest execution cost.</p>
<p id="p-0009" num="0008">The join operation can be quite expensive, since joining together two or more entire relations can result in a very large relation. When multiple joins are present in a query, the cost of a bad execution plan may increase dramatically. It is important for the query optimizer to identify a query execution plan that minimizes cost. The join ordering chosen by the query optimizer is often a key factor in the ultimate cost of the query execution plan.</p>
<p id="p-0010" num="0009">In view of these considerations, query optimizers often use estimates of the cardinality of joins in attempting to select the most efficient query plan. It may be desirable to estimate the cardinality of the join of a table R with a table S where attribute a of table R is equal to attribute b of table S, denoted R<img id="CUSTOM-CHARACTER-00001" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub>S. One prior art method of estimating the cardinality of such a join relied on what is referred to as the “containment assumption.” According to the containment assumption, each group of distinct valued tuples belonging to the relation with the minimal number of distinct values joins with some group of distinct valued tuples in the other table. The containment assumption has been extended to estimate the cardinality of a multi-predicate join. One problem with an existing method of estimating the cardinality of a multi-predicate using the containment assumption join is that cardinality is often overestimated.</p>
<p id="p-0011" num="0010">There is a need for a method of estimating cardinality using multi-column density values and additionally using coarser density values of a subset of the multi-column density attributes to reduce the overestimation problem.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0012" num="0011">The present disclosure concerns a method of estimating cardinality of a join of tables using multi-column density values and additionally using coarser density values of a subset of the multi-column density attributes. In one embodiment, the sequence of attributes for the coarser densities is a prefix of the sequence of multi-column density attributes.</p>
<p id="p-0013" num="0012">In one embodiment of the method, a multi-column density over a set of attributes is identified for each table. A density of a subset of the set of attributes is also identified for each table. In this embodiment, a number of tuples from each table that participate in the join is estimated using densities of the subsets. The cardinality of the join is estimated using the multi-column density for each table and the estimated number of tuples that participate in the join from each table.</p>
<p id="p-0014" num="0013">In one embodiment of the method, a multi-column density over a set of attributes and a cardinality is identified for each table. A density of a subset of the set of attributes is also identified for each table. The cardinality of the join is estimated using the multi-column density for each table, the density of said subset of said set of attributes for each table, and the cardinality of each table.</p>
<p id="p-0015" num="0014">In one embodiment, the method improves an existing method of estimating cardinality of a join of tables using a multi-column density over a set of attributes. The method improves the existing method by additionally using a density of a subset of the set of multi-column density attributes for each table to estimate the cardinality of the join.</p>
<p id="p-0016" num="0015">The number of tuples from each table that participate in the join may be estimated by multiplying an estimated minimum number of distinct values for the subset of attributes and a density of the subset of attributes in the table. The number of distinct values of a subset of attributes can be calculated by dividing the cardinality of the table by the density of the subset of attributes in the table.</p>
<p id="p-0017" num="0016">In one embodiment, the join cardinality estimation is calculated by selecting the minimum of an estimated number of tuples from a first table that participate in the join divided by a multi-column density over a set of attributes for the first table and an estimated number of tuples from a second table that participate in the join divided by a multi-column density over a set of attributes for the second table. This minimum, the multi-column density for the first table, and the multi-column density for the second table are multiplied to calculate the estimated cardinality of the join.</p>
<p id="p-0018" num="0017">In one embodiment, the cardinality estimation is calculated by identifying a first minimum value of a cardinality of a first table divided by a density of a subset of the set of multi-column density attributes for the first table and a cardinality of a second table divided by a density of a subset of the set multi-column density attributes for the second table. The method also identifies a second minimum value of the density of the subset of the set of multi-column density attributes for the first table divided by a multi-column density over the set of multi-column density attributes for the first table and the density of the subset of the set of multi-column density attributes for the second table divided by a multi-column density over the set of attributes for the second table. The first minimum value, the second minimum value, the multi-column density over the set of attributes for the first table, and the multi-column density over the set of attributes for the second table are multiplied to calculate the estimated cardinality of the join.</p>
<p id="p-0019" num="0018">These and other objects, advantages, and features of an exemplary embodiment are described in conjunction with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic depiction of a computer system used in practicing an exemplary embodiment of the disclosed method;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2</figref> is illustrates a method of estimating the cardinality of a join of two relations using single column densities;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 3A</figref> illustrates a method of estimating the cardinality of a join of two relations using multi-column densities;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 3B</figref> illustrates a method of estimating the cardinality of a join of two relations using multi-column densities;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 4</figref> is a flow chart that illustrates a method of estimating cardinality of a join of two relations using multi-column densities and densities of subsets of multi-column density attributes; and</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a method of estimating the cardinality of a join of two relations using histograms and multi-column densities.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0026" num="0025">Exemplary Operating Environment</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 1</figref> and the following discussion are intended to provide a brief, general description of a suitable computing environment in which the invention may be implemented. Although not required, the invention will be described in the general context of computer-executable instructions, such as program modules, being executed by a personal computer. Generally, program modules include routines, programs, objects, components, data structures, etc., that perform particular tasks or implement particular abstract data types. Moreover, those skilled in the art will appreciate that the invention may be practiced with other computer system configurations, including hand-held devices, multiprocessor systems, microprocessor-based or programmable consumer electronics, network PCs, minicomputers, mainframe computers, and the like. The invention may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. In a distributed computing environment, program modules may be located in both local and remote memory storage devices.</p>
<p id="p-0028" num="0027">With reference to <figref idref="DRAWINGS">FIG. 1</figref>, an exemplary system for implementing the invention includes a general purpose computing device in the form of a conventional personal computer <b>20</b>, including a processing unit <b>21</b>, a system memory <b>22</b>, and a system bus <b>24</b> that couples various system components including system memory <b>22</b> to processing unit <b>21</b>. System bus <b>23</b> may be any of several types of bus structures including a memory bus or memory controller, a peripheral bus, and a local bus using any of a variety of bus architectures. System memory <b>22</b> includes read only memory (ROM) <b>24</b> and random access memory (RAM) <b>25</b>. A basic input/output system (BIOS) <b>26</b>, containing the basic routines that help to transfer information between elements within personal computer <b>20</b>, such as during start-up, is stored in ROM <b>24</b>. Personal computer <b>20</b> further includes a hard disk drive <b>27</b> for reading from and writing to a hard disk, a magnetic disk drive <b>28</b> for reading from or writing to a removable magnetic disk <b>29</b> and an optical disk drive <b>30</b> for reading from or writing to a removable optical disk <b>31</b> such as a CD ROM or other optical media. Hard disk drive <b>27</b>, magnetic disk drive <b>28</b>, and optical disk drive <b>30</b> are connected to system bus <b>23</b> by a hard disk drive interface <b>32</b>, a magnetic disk drive interface <b>33</b>, and an optical drive interface <b>34</b>, respectively. The drives and their associated computer-readable media provide nonvolatile storage of computer-readable instructions, data structures, program modules and other data for personal computer <b>20</b>. Although the exemplary environment described herein employs a hard disk <b>27</b>, a removable magnetic disk <b>29</b> and a removable optical disk <b>31</b>, it should be appreciated by those skilled in the art that other types of computer-readable media which can store data that is accessible by computer, such as random access memories (RAMs), read only memories (ROMs), and the like may also be used in the exemplary operating environment.</p>
<p id="p-0029" num="0028">A number of program modules may be stored on the hard disk <b>27</b>, magnetic disk <b>29</b>, optical disk <b>31</b>, ROM <b>24</b> or RAM <b>25</b>, including an operating system <b>35</b>, one or more application programs <b>36</b>, other program modules <b>37</b>, and program data <b>38</b>. A database system <b>55</b> may also be stored on the hard disk, magnetic disk <b>29</b>, optical disk <b>31</b>, ROM <b>24</b> or RAM <b>25</b>. A user may enter commands and information into personal computer <b>20</b> through input devices such as a keyboard <b>40</b> and pointing device <b>42</b>. Other input devices may include a microphone, joystick, game pad, satellite dish, scanner, or the like. These and other input devices are often connected to processing unit <b>21</b> through a serial port interface <b>46</b> that is coupled to system bus <b>23</b>, but may be connected by other interfaces, such as a parallel port, game port or a universal serial bus (USB). A monitor <b>47</b> or other type of display device is also connected to system bus <b>23</b> via an interface, such as a video adapter <b>48</b>. In addition to the monitor, personal computers typically include other peripheral output devices such as speakers and printers.</p>
<p id="p-0030" num="0029">Personal computer <b>20</b> may operate in a networked environment using logical connections to one or more remote computers, such as a remote computer <b>49</b>. Remote computer <b>49</b> may be another personal computer, a server, a router, a network PC, a peer device or other common network node, and typically includes many or all of the elements described above relative to personal computer <b>20</b>, although only a memory storage device <b>50</b> has been illustrated in <figref idref="DRAWINGS">FIG. 1</figref>. The logical connections depicted in <figref idref="DRAWINGS">FIG. 1</figref> include local area network (LAN) <b>51</b> and a widearea network (WAN) <b>52</b>. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet.</p>
<p id="p-0031" num="0030">When using a LAN networking environment, personal computer <b>20</b> is connected to local network <b>51</b> through a network interface or adapter <b>53</b>. When used in a WAN networking environment, personal computer <b>20</b> typically includes a modem <b>54</b> or other means for establishing communication over wide area network <b>52</b>, such as the Internet. Modem <b>54</b>, which may be internal or external, is connected to system bus <b>23</b> via serial port interface <b>46</b>. In a networked environment, program modules depicted relative to personal computer <b>20</b>, or portions thereof, may be stored in remote memory storage, device <b>50</b>. It will be appreciated that the network connections shown are exemplary and other means of establishing a communications link between the computers may be used.</p>
<p id="p-0032" num="0031">Notation</p>
<p id="p-0033" num="0032">In this disclosure, tables are represented by uppercase letters. For example, tables may be represented by uppercase letters R; S; T . . . Table attributes are represented by lowercase letters. For example, table attributes may be represented by lowercase letters a; b; c . . . The cardinality of a table R is denoted as card<sub>R </sub>or |R|. For a given attribute a of table R, the density of attribute a in table R, denoted δ<sub>R.a</sub>, is the average number of duplicates per distinct value of attribute a in R. The number of distinct values of attribute a in table R is denoted dv<sub>R.a</sub>. As a result, dv<sub>R.a</sub>=card<sub>R</sub>/δ<sub>R.a</sub>.</p>
<p id="p-0034" num="0033">A multi-column density MCD for attributes a<sub>1</sub>, . . . ,a<sub>n </sub>of table R is denoted as δ<sub>R.a1, . . . ,an</sub>. The multi-column density δ<sub>R.a1, . . . ,an </sub>is the average number of duplicates per distinct combination of attributes a<sub>1</sub>, . . . ,a<sub>n</sub>. In this disclosure, the number of distinct combinations of a<sub>1</sub>, . . . ,a<sub>n </sub>in table R are denoted as dv<sub>R.a1, . . . ,an</sub>. As such, the number of distinct attribute combinations dv<sub>R.a1, . . . ,an</sub>=card<sub>R</sub>/δ<sub>R.a1, . . . ,an</sub>. It is assumed in this disclosure that whenever multi-column densities are available over attributes a<sub>1</sub>, . . . ,a<sub>n </sub>the densities of prefix subsets of the original multi-column density are also available. For the multi-column density of a<sub>1</sub>, . . . ,a<sub>n </sub>the densities of the prefixes: (a<sub>1</sub>), (a<sub>1</sub>, a<sub>2</sub>); (a<sub>1</sub>, a<sub>2</sub>, a<sub>3</sub>), . . . ,(a<sub>1</sub>,a<sub>2</sub>, . . . ,a<sub>n−1</sub>) are also available.</p>
<p id="p-0035" num="0034">Join Estimation Using Containment Assumptions</p>
<p id="p-0036" num="0035">The cardinality of the join of table R with table S where attribute a of table R is equal to attribute b of table S is denoted R<img id="CUSTOM-CHARACTER-00002" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub>S. According to the containment assumption, each group of distinct valued tuples belonging to the relation with the minimal number of distinct values joins with some group of distinct valued tuples in the other table. This is illustrated by the example of <figref idref="DRAWINGS">FIG. 2</figref>. In the example of <figref idref="DRAWINGS">FIG. 2</figref> table R has a cardinality card<sub>R</sub>=100, there are twenty distinct values of attribute a dv<sub>R.a</sub>=20 and therefore, the density of attribute a is δ<sub>R.a</sub>=5. Table S has a cardinality card<sub>S</sub>=100, there are one hundred distinct values of attribute b dv<sub>S.b</sub>=100 (all values of b are different in the example), and therefore, the density of attribute b is δ<sub>S.b</sub>=1. Applying the containment assumption to the example of <figref idref="DRAWINGS">FIG. 2</figref>, relation R has the fewest number groups with distinct values, i.e. 20 groups. The containment assumption assumes that each group of distinct valued tuples of table R join with a group of distinct valued tuples in table S, which in the example is a single tuple in S. The arrows <b>104</b> between table R and table S illustrate this. According to the containment assumption, a group <b>100</b> of tuples (five tuples in the example) with attribute a having a value val<sub>a1 </sub>will join with a group <b>102</b> of tuples (one tuple in the example) with attribute b having a value val<sub>b1 </sub>as indicated by arrow <b>104</b>. Similarly the groups of tuples from relation R having values val<sub>a2</sub>, . . . ,val<sub>a20 </sub>will join with groups of tuples from relation S having values val<sub>a2</sub>, . . . ,val<sub>a20 </sub>respectively. Note in the example of <figref idref="DRAWINGS">FIG. 2</figref> that groups (single tuples in the example) 21-100 of table S do not participate in the join.</p>
<p id="p-0037" num="0036">Using the containment assumption, an estimated cardinality of the join is calculated as:</p>
<p id="p-0038" num="0037">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mi>card</mi>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>S</mi>
                  <mo>.</mo>
                  <mi>b</mi>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>S</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>R</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>,</mo>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>S</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mi>R</mi>
                <mo>.</mo>
                <mi>a</mi>
              </mrow>
            </msub>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mi>S</mi>
                <mo>.</mo>
                <mi>b</mi>
              </mrow>
            </msub>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>1</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0039" num="0038">Applying Equation 1 to the example of <figref idref="DRAWINGS">FIG. 2</figref>, the estimated cardinality of the join</p>
<p id="p-0040" num="0039">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>S</mi>
                  <mo>.</mo>
                  <mi>b</mi>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>S</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>is</mi>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>:</mo>
            <mo>=</mo>
          </mrow>
          <mo>⁢</mo>
          <mi/>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mrow>
                    <msub>
                      <mi>dv</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mn>20</mn>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <msub>
                      <mi>dv</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                    </msub>
                    <mo>=</mo>
                    <mn>100</mn>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>R</mi>
                    <mo>.</mo>
                    <mi>a</mi>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mn>5</mn>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>b</mi>
                  </mrow>
                </msub>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mn>20</mn>
              <mo>)</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mn>5</mn>
              <mo>)</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mn>1</mn>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mn>100</mn>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0041" num="0040">Considering the multi-predicate join of table R with table S where attribute a of table R is equal to attribute b of table S and attribute c of table R is equal to attribute d of table S, denoted R<img id="CUSTOM-CHARACTER-00003" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub><img id="CUSTOM-CHARACTER-00004" he="2.12mm" wi="1.44mm" file="US07299226-20071120-P00002.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.c=S.d</sub>S. The estimation calculation of Equation 1 can be extended to this multi-predicate join to define the estimated cardinality of the multi-predicate join as:</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mi>card</mi>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>S</mi>
                      <mo>.</mo>
                      <mi>b</mi>
                    </mrow>
                    <mo>⋀</mo>
                    <mrow>
                      <mi>R</mi>
                      <mo>.</mo>
                      <mi>c</mi>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>d</mi>
                  </mrow>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>S</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>R</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mrow>
                          <mi>R</mi>
                          <mo>.</mo>
                          <mi>a</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>,</mo>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>S</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mrow>
                          <mi>S</mi>
                          <mo>.</mo>
                          <mi>b</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>d</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>,</mo>
                <mi>c</mi>
              </mrow>
            </msub>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>S</mi>
                  <mo>.</mo>
                  <mi>b</mi>
                </mrow>
                <mo>,</mo>
                <mi>d</mi>
              </mrow>
            </msub>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>2</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0043" num="0042">This estimation is correct under the containment assumption in absence of additional information, such as partial densities. If the densities of the prefixes of the multi-column densities (e.g., δ<sub>R.a</sub>,δ<sub>R.b</sub>) are also available, the estimation of Equation 2 could be an overestimate of the cardinality. The example illustrated by <figref idref="DRAWINGS">FIG. 3</figref> shows how use of Equation 2 can overestimate cardinality.</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIGS. 3A and 3B</figref> illustrate the join predicate R<img id="CUSTOM-CHARACTER-00005" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub><img id="CUSTOM-CHARACTER-00006" he="2.12mm" wi="1.44mm" file="US07299226-20071120-P00002.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.c=S.d</sub>S. Suppose card<sub>R</sub>=1000, card<sub>S</sub>=1000 and that δ<sub>R.a,c</sub>=10 and δ<sub>R.b,d</sub>=1. Referring to <figref idref="DRAWINGS">FIG. 3A</figref>, there are 100 groups of tuples with distinct values dv<sub>R.a,c </sub>of the combination of attributes a and c and there are 1000 groups of tuples (1 tuple per group in the example) with distinct values dv<sub>S.b,d </sub>In <figref idref="DRAWINGS">FIG. 3A</figref>, according to Equation 2, a group <b>108</b> of ten tuples with attribute a having a value val<sub>a1 </sub>and attribute c having a value val<sub>c1 </sub>will join with a group <b>110</b> of tuples (one tuple in the example) with attribute b having a value val<sub>b1 </sub>and attribute d having a value val<sub>d1 </sub>as indicated by arrow <b>112</b> Similarly the ninety-nine remaining groups of ten tuples with the same value on attributes a and c from relation R will join with one tuple from relation S. Therefore, using the containment assumption the estimated cardinality according to Equation 2 is:</p>
<p id="p-0045" num="0044">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mfrac>
                  <msub>
                    <mi>card</mi>
                    <mi>R</mi>
                  </msub>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                      <mo>,</mo>
                      <mi>c</mi>
                    </mrow>
                  </msub>
                </mfrac>
                <mo>;</mo>
                <mfrac>
                  <msub>
                    <mi>card</mi>
                    <mi>S</mi>
                  </msub>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                      <mo>,</mo>
                      <mi>d</mi>
                    </mrow>
                  </msub>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>·</mo>
          <msub>
            <mi>δ</mi>
            <mrow>
              <mrow>
                <mi>R</mi>
                <mo>.</mo>
                <mi>a</mi>
              </mrow>
              <mo>,</mo>
              <mi>c</mi>
            </mrow>
          </msub>
          <mo>·</mo>
          <msub>
            <mi>δ</mi>
            <mrow>
              <mrow>
                <mi>S</mi>
                <mo>.</mo>
                <mi>b</mi>
              </mrow>
              <mo>,</mo>
              <mi>d</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>=</mo>
        <mi/>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <msub>
                    <mi>dv</mi>
                    <mrow>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                      <mo>,</mo>
                      <mi>c</mi>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mn>1000</mn>
                    <mo>/</mo>
                    <mn>10</mn>
                  </mrow>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <msub>
                    <mi>dv</mi>
                    <mrow>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                      <mo>,</mo>
                      <mi>c</mi>
                    </mrow>
                  </msub>
                  <mo>=</mo>
                  <mrow>
                    <mn>1000</mn>
                    <mo>/</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>R</mi>
                    <mo>.</mo>
                    <mi>a</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>c</mi>
                </mrow>
              </msub>
              <mo>=</mo>
              <mn>10</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>b</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>d</mi>
                </mrow>
              </msub>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mi/>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mn>100</mn>
                  <mo>,</mo>
                  <mn>1000</mn>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>*</mo>
            <mn>10</mn>
            <mo>*</mo>
            <mn>1</mn>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mn>100</mn>
              <mo>*</mo>
              <mn>10</mn>
            </mrow>
            <mo>=</mo>
            <mn>1000.</mn>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0046" num="0045">Using Coarser Densities to Reduce Overestimation</p>
<p id="p-0047" num="0046">Using Equation 2 in the Example of <figref idref="DRAWINGS">FIGS. 3A and 3B</figref> assumes that all tuples from R join with some tuple in S, since dv<sub>R.a,c</sub>=100&lt;1000=dv<sub>R.b,d</sub>. Suppose that in the example of <figref idref="DRAWINGS">FIGS. 3A and 3B</figref>, the following additional density information about a subset of the attributes of the multi-column density is also available: δ<sub>R.a</sub>=100 and δ<sub>S.b</sub>=500. These are the densities of the prefixes of the multi-column densities δ<sub>R.a,c </sub>and δ<sub>R.b,d</sub>. These densities of the prefixes allow the table R to be modeled as consisting of ten groups (dv<sub>R.a</sub>) of one-hundred tuples each (δ<sub>R.a</sub>) where each item in a group has the same attribute value R.a. Referring to <figref idref="DRAWINGS">FIG. 3B</figref>, a first group <b>114</b> of one-hundred tuples is modeled as having value val<sub>a1 </sub>in the example. In <figref idref="DRAWINGS">FIG. 3B</figref>, the remaining nine groups of one-hundred tuples have values val<sub>a2</sub>, . . . ,val<sub>a10</sub>. The prefix densities allow table S to be modeled as consisting of two groups <b>116</b>, <b>118</b> (dv<sub>S.b</sub>) of 500 tuples each (δ<sub>S.b</sub>), where each member of a group has the same attribute value S.b. In <figref idref="DRAWINGS">FIG. 3B</figref>, the first group <b>116</b> of five-hundred tuples is illustrated as having value val<sub>b1 </sub>and the second group <b>118</b> of five-hundred tuples is illustrated as having value val<sub>b2</sub>. This information does not contradict the original multi-column densities. Rather, this information simply models a coarser distribution for table R (i.e. a GROUP BY R.a of the different combinations of R.a, R.c). In <figref idref="DRAWINGS">FIG. 3B</figref>, arrows <b>120</b>, <b>122</b> illustrate that at most two out of the ten groups of table R (grouped by R.a alone) would match with tuples in table S, since there are only two groups with different values of attribute S.b. Therefore, the remaining 8 groups in table R (80% of the tuples in R) would not participate in a match, which is a great restriction over the first calculation that uses only the original multi-column densities.</p>
<p id="p-0048" num="0047">In one embodiment, the multicolumn density δ<sub>R.a,c</sub>, the multi-column density δ<sub>R.b,d</sub>, and the density information δ<sub>R.a</sub>,δ<sub>R.b</sub>, about a prefix subset of the multi-column density attributes is also available. This density information can be used to estimate the cardinality of R<img id="CUSTOM-CHARACTER-00007" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub><img id="CUSTOM-CHARACTER-00008" he="2.12mm" wi="1.44mm" file="US07299226-20071120-P00002.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.c=S.d</sub>S by using a two-step approach. This two-step approach is illustrated by <figref idref="DRAWINGS">FIG. 4</figref>. In the exemplary embodiment, the method first estimates <b>130</b> how many tuples from R and S participate in the simpler join R<img id="CUSTOM-CHARACTER-00009" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub>S using the containment assumption and the coarser subset density information δ<sub>R.a </sub>and δ<sub>S.b</sub>. The estimated number of tuples in table R that participate in the simpler join R<img id="CUSTOM-CHARACTER-00010" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub>S is:</p>
<p id="p-0049" num="0048">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>min</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mfrac>
                <msub>
                  <mi>card</mi>
                  <mi>R</mi>
                </msub>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>R</mi>
                    <mo>.</mo>
                    <mi>a</mi>
                  </mrow>
                </msub>
              </mfrac>
              <mo>,</mo>
              <mfrac>
                <msub>
                  <mi>card</mi>
                  <mi>S</mi>
                </msub>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>b</mi>
                  </mrow>
                </msub>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>·</mo>
        <mrow>
          <msub>
            <mi>δ</mi>
            <mrow>
              <mi>R</mi>
              <mo>.</mo>
              <mi>a</mi>
            </mrow>
          </msub>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="1.1em" height="1.1ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>3</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Analogously, the number of tuples in S that participate in this simpler join is:
</p>
<p id="p-0050" num="0049">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>min</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mfrac>
                <msub>
                  <mi>card</mi>
                  <mi>R</mi>
                </msub>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>R</mi>
                    <mo>.</mo>
                    <mi>a</mi>
                  </mrow>
                </msub>
              </mfrac>
              <mo>,</mo>
              <mfrac>
                <msub>
                  <mi>card</mi>
                  <mi>S</mi>
                </msub>
                <msub>
                  <mi>δ</mi>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>b</mi>
                  </mrow>
                </msub>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>·</mo>
        <mrow>
          <msub>
            <mi>δ</mi>
            <mrow>
              <mi>S</mi>
              <mo>.</mo>
              <mi>b</mi>
            </mrow>
          </msub>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>4</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0051" num="0050">In a second step, the cardinality of the original join R<img id="CUSTOM-CHARACTER-00011" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub><img id="CUSTOM-CHARACTER-00012" he="2.12mm" wi="1.44mm" file="US07299226-20071120-P00002.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.c=S.d</sub>S is estimated <b>132</b> using the estimated number tuples from R and S that participate in the simpler join R<img id="CUSTOM-CHARACTER-00013" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub>S (using the Equations 3 and 4) instead of the cardinality of R card<sub>R </sub>and the cardinality of S card<sub>S</sub>. The observation is that any tuple from table R or table S that does not participate in the simpler join will not participate in the original join, since the latter contains an additional equality predicate. Therefore, in the exemplary embodiment the method replaces the actual cardinalities card<sub>R </sub>and card<sub>S </sub>in estimation Equation 2 with the estimated number of tuples from table R and table S that participate in the simpler join defined by Equations 3 and 4 respectively. In this way, the method removes from table R and table S tuples that are do not to participate in the join when the containment assumption is applied. This assumes that the values of densities δ<sub>R.a,c </sub>and δ<sub>S.b,d </sub>are unchanged after removing the tuples that do not participate in the join. The resulting estimation equation is:</p>
<p id="p-0052" num="0051">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mi>card</mi>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>S</mi>
                      <mo>.</mo>
                      <mi>b</mi>
                    </mrow>
                    <mo>⋀</mo>
                    <mrow>
                      <mi>R</mi>
                      <mo>.</mo>
                      <mi>c</mi>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>d</mi>
                  </mrow>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>S</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mfrac>
                  <mrow>
                    <mrow>
                      <mi>min</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mfrac>
                            <msub>
                              <mi>card</mi>
                              <mi>R</mi>
                            </msub>
                            <msub>
                              <mi>δ</mi>
                              <mrow>
                                <mi>R</mi>
                                <mo>.</mo>
                                <mi>a</mi>
                              </mrow>
                            </msub>
                          </mfrac>
                          <mo>·</mo>
                          <mfrac>
                            <msub>
                              <mi>card</mi>
                              <mi>S</mi>
                            </msub>
                            <msub>
                              <mi>δ</mi>
                              <mrow>
                                <mi>S</mi>
                                <mo>.</mo>
                                <mi>b</mi>
                              </mrow>
                            </msub>
                          </mfrac>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>·</mo>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                      <mo>,</mo>
                      <mi>c</mi>
                    </mrow>
                  </msub>
                </mfrac>
                <mo>,</mo>
                <mfrac>
                  <mrow>
                    <mrow>
                      <mi>min</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mfrac>
                            <msub>
                              <mi>card</mi>
                              <mi>R</mi>
                            </msub>
                            <msub>
                              <mi>δ</mi>
                              <mrow>
                                <mi>R</mi>
                                <mo>.</mo>
                                <mi>a</mi>
                              </mrow>
                            </msub>
                          </mfrac>
                          <mo>;</mo>
                          <mfrac>
                            <msub>
                              <mi>card</mi>
                              <mi>S</mi>
                            </msub>
                            <msub>
                              <mi>δ</mi>
                              <mrow>
                                <mi>S</mi>
                                <mo>.</mo>
                                <mi>b</mi>
                              </mrow>
                            </msub>
                          </mfrac>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>·</mo>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                    </msub>
                  </mrow>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                      <mo>,</mo>
                      <mi>d</mi>
                    </mrow>
                  </msub>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>,</mo>
                <mi>c</mi>
              </mrow>
            </msub>
            <mo>·</mo>
            <mrow>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>b</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>d</mi>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>5</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
By extracting the common factor
</p>
<p id="p-0053" num="0052">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <mi>min</mi>
  <mo>⁡</mo>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mfrac>
        <msub>
          <mi>card</mi>
          <mi>R</mi>
        </msub>
        <msub>
          <mi>δ</mi>
          <mrow>
            <mi>R</mi>
            <mo>.</mo>
            <mi>a</mi>
          </mrow>
        </msub>
      </mfrac>
      <mo>,</mo>
      <mfrac>
        <msub>
          <mi>card</mi>
          <mi>S</mi>
        </msub>
        <msub>
          <mi>δ</mi>
          <mrow>
            <mi>S</mi>
            <mo>.</mo>
            <mi>b</mi>
          </mrow>
        </msub>
      </mfrac>
    </mrow>
    <mo>)</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
Equation 5 reduces to:
</p>
<p id="p-0054" num="0053">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mi>card</mi>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>S</mi>
                      <mo>.</mo>
                      <mi>b</mi>
                    </mrow>
                    <mo>⋀</mo>
                    <mrow>
                      <mi>R</mi>
                      <mo>.</mo>
                      <mi>c</mi>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>d</mi>
                  </mrow>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>S</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>R</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>,</mo>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>S</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>a</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mrow>
                          <mi>R</mi>
                          <mo>.</mo>
                          <mi>a</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>·</mo>
                  <mfrac>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>b</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mrow>
                          <mi>S</mi>
                          <mo>.</mo>
                          <mi>b</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>d</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>,</mo>
                <mi>c</mi>
              </mrow>
            </msub>
            <mo>·</mo>
            <mrow>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>b</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>d</mi>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="1.1em" height="1.1ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>6</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0055" num="0054">If the densities of the other prefixes are available from the construction of the original multi-column densities i.e., densities δ<sub>R.c</sub>, δ<sub>R.c,a</sub>, δ<sub>S.d</sub>, δ<sub>S.d,b </sub>using the arguments applied above, the cardinality R<img id="CUSTOM-CHARACTER-00014" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.a=S.b</sub><img id="CUSTOM-CHARACTER-00015" he="2.12mm" wi="1.44mm" file="US07299226-20071120-P00002.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>R.c=S.d</sub>S can be estimated by Equation 7.</p>
<p id="p-0056" num="0055">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mi>card</mi>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>a</mi>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mrow>
                      <mi>S</mi>
                      <mo>.</mo>
                      <mi>b</mi>
                    </mrow>
                    <mo>⋀</mo>
                    <mrow>
                      <mi>R</mi>
                      <mo>.</mo>
                      <mi>c</mi>
                    </mrow>
                  </mrow>
                  <mo>=</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>d</mi>
                  </mrow>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>S</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>R</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>,</mo>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>S</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>d</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>R</mi>
                        <mo>.</mo>
                        <mi>c</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mrow>
                          <mi>R</mi>
                          <mo>.</mo>
                          <mi>c</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>a</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>,</mo>
                  <mfrac>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>S</mi>
                        <mo>.</mo>
                        <mi>d</mi>
                      </mrow>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mrow>
                          <mi>S</mi>
                          <mo>.</mo>
                          <mi>d</mi>
                        </mrow>
                        <mo>,</mo>
                        <mi>b</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>R</mi>
                  <mo>.</mo>
                  <mi>c</mi>
                </mrow>
                <mo>,</mo>
                <mi>a</mi>
              </mrow>
            </msub>
            <mo>·</mo>
            <mrow>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>S</mi>
                    <mo>.</mo>
                    <mi>d</mi>
                  </mrow>
                  <mo>,</mo>
                  <mi>b</mi>
                </mrow>
              </msub>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mi>Equation</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mn>7</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0057" num="0056">The two estimations returned using Equations 6 and 7 can be different. In such a case, since all these estimations are estimated upper bounds for the join, the exemplary method takes the minimal one estimate.</p>
<p id="p-0058" num="0057">In one embodiment, Equation 7 is generalized for any number n (greater than 2) of equalities in the join predicate, by recursively applying the method described above. In general, for a join with a number n predicates there can be n! (n factorial) different permutations of multi-column densities and subsets of prefixes. If all of the densities are available, the method selects the minimum estimation of the cardinality in one embodiment. However, in one embodiment only a selected number of the possible estimations are calculated. This may be done either to be efficient or because not all combinations of the multi-column densities are available. Regardless of how many of the possible estimations are calculated using the disclosed method, the disclosed estimation method guarantees that the minimal value among the estimations is at least as accurate as the estimation obtained if the single multi-column densities were just used by themselves in Equation 2.</p>
<p id="p-0059" num="0058">Situations When Using Coarser Subset Densities Reduces Overestimation</p>
<p id="h-0006" num="0000">Equation 6 has the following basic form:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>min(a1/b1, a2/b2)*min(b1/c1, b2/c2)*c1*c2. where:<?in-line-formulae description="In-line Formulae" end="tail"?>
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0059">a<b>1</b>=card<sub>R </sub></li>
        <li id="ul0002-0002" num="0060">a<b>2</b>=card<sub>S </sub></li>
        <li id="ul0002-0003" num="0061">b<b>1</b>=δ<sub>R.a </sub></li>
        <li id="ul0002-0004" num="0062">b<b>2</b>=δ<sub>S.b </sub></li>
        <li id="ul0002-0005" num="0063">c<b>1</b>=δ<sub>R.a,c </sub></li>
        <li id="ul0002-0006" num="0064">c<b>2</b>=δ<sub>S.b,d </sub>
<br/>
Original estimation equation 2, which does not consider the coarser densities has the following basic form:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>min(a1/c1, a2/c2)*c1*c2.<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
If a<b>1</b>/b<b>1</b>&lt;a<b>2</b>/b<b>2</b> and b<b>1</b>/c<b>1</b>&lt;b<b>2</b>/c<b>2</b>, i.e., both min operators of Equation 6 return the first parameter, then the min operator of Equation 2 also returns the first parameter, and the result of both equations is exactly the same. That is, Equation 6 reduces to Equation 2, since
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0060" num="0065">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>a</mi>
        <mn>1</mn>
      </msub>
      <msub>
        <mi>b</mi>
        <mn>1</mn>
      </msub>
    </mfrac>
    <mo>×</mo>
    <mfrac>
      <msub>
        <mi>b</mi>
        <mn>1</mn>
      </msub>
      <msub>
        <mi>c</mi>
        <mn>1</mn>
      </msub>
    </mfrac>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>a</mi>
        <mn>1</mn>
      </msub>
      <msub>
        <mi>c</mi>
        <mn>1</mn>
      </msub>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
Analogously, if both min operators of Equation 6 return the second parameter, then the min operator of Equation 2 returns the second parameter, and the result of Equations 2 and 6 is the same. That is, Equation 6 reduces to Equation 2, since
</p>
<p id="p-0061" num="0066">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>a</mi>
        <mn>2</mn>
      </msub>
      <mi>b2</mi>
    </mfrac>
    <mo>×</mo>
    <mfrac>
      <msub>
        <mi>b</mi>
        <mn>2</mn>
      </msub>
      <msub>
        <mi>c</mi>
        <mn>2</mn>
      </msub>
    </mfrac>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>a</mi>
        <mn>2</mn>
      </msub>
      <msub>
        <mi>c</mi>
        <mn>2</mn>
      </msub>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
However, if the first min operator of Equation 6 returns the first parameter, and the second min operator of Equation 6 returns the second parameter, both equations might return different values. That is, Equation 6 does not reduce to Equation 2, since, in general,
</p>
<p id="p-0062" num="0067">
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>a</mi>
      <mn>1</mn>
    </msub>
    <msub>
      <mi>b</mi>
      <mn>1</mn>
    </msub>
  </mfrac>
  <mo>×</mo>
  <mfrac>
    <msub>
      <mi>b</mi>
      <mn>2</mn>
    </msub>
    <msub>
      <mi>c</mi>
      <mn>2</mn>
    </msub>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
is different from either
</p>
<p id="p-0063" num="0068">
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>a</mi>
      <mn>1</mn>
    </msub>
    <msub>
      <mi>c</mi>
      <mn>1</mn>
    </msub>
  </mfrac>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="1.1em" height="1.1ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mi>or</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="1.1em" height="1.1ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>a</mi>
        <mn>2</mn>
      </msub>
      <msub>
        <mi>c</mi>
        <mn>2</mn>
      </msub>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
Similarly, if the first min operator of Equation 6 returns the second parameter, and the second min operator of Equation 6 returns the first parameter, both equations might return different values. Again, Equation 6 doe not reduce to Equation 2, since
</p>
<p id="p-0064" num="0069">
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>a</mi>
      <mn>2</mn>
    </msub>
    <msub>
      <mi>b</mi>
      <mn>2</mn>
    </msub>
  </mfrac>
  <mo>×</mo>
  <mfrac>
    <msub>
      <mi>b</mi>
      <mn>1</mn>
    </msub>
    <msub>
      <mi>c</mi>
      <mn>1</mn>
    </msub>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
is in general different from either
</p>
<p id="p-0065" num="0070">
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>a</mi>
      <mn>1</mn>
    </msub>
    <msub>
      <mi>c</mi>
      <mn>1</mn>
    </msub>
  </mfrac>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="1.1em" height="1.1ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mi>or</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="1.1em" height="1.1ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mfrac>
      <msub>
        <mi>a</mi>
        <mn>2</mn>
      </msub>
      <msub>
        <mi>c</mi>
        <mn>2</mn>
      </msub>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
In such cases, Equation 6 provides a tighter upper bound than Equation 2 and is thus more accurate. The following example query illustrates how this situation arises:
</p>
<heading id="h-0007" level="1">EXAMPLE</heading>
<p id="p-0066" num="0071">SELECT*FROM part, supplier, lineitem</p>
<p id="p-0067" num="0072">WHERE
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0073">p_partkey=l_partkey AND</li>
        <li id="ul0004-0002" num="0074">s_suppkey=l_suppkey AND</li>
        <li id="ul0004-0003" num="0075">p_name like ‘% green’</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0068" num="0076">OPTION (force order)</p>
<p id="h-0008" num="0000">In the example, the database TPC-H is used. The following values are obtained from the TPC-H database where S=supplier, P=part, and L=lineitem.</p>
<p id="p-0069" num="0077">card<sub>S</sub>=1000, δ<sub>S.suppkey</sub>=1</p>
<p id="p-0070" num="0078">card<sub>P</sub>=20000, δ<sub>P.partkey</sub>=1</p>
<p id="p-0071" num="0079">card<sub>L</sub>=600000, δ<sub>L.partkey,suppkey</sub>=7.5, δ<sub>L.partkey</sub>=30, δ<sub>L.suppkey</sub>=600</p>
<p id="h-0009" num="0000">The filter σ<sub>pname like ‘green’ </sub>returns the following information where σ<sub>green</sub>P is denoted σP:</p>
<p id="p-0072" num="0080">card<sub>σP</sub>=200, δ<sub>σP.partkey</sub>=1</p>
<p id="h-0010" num="0000">After applying the Cartesian product, it can be estimated (denoting “S×σP” as x) that</p>
<p id="p-0073" num="0081">card<sub>x</sub>=1000*200=200000</p>
<p id="p-0074" num="0082">δ<sub>x.partkey,suppkey</sub>=1 (it is the product of the original densities).</p>
<p id="p-0075" num="0083">δ<sub>x.partkey</sub>=1000 (since each distinct partkey value was combined with all 1000 suppliers).</p>
<p id="p-0076" num="0084">δ<sub>x.suppkey</sub>=200 (since each distinct suppkey value was combined with all 200 green parts).</p>
<p id="p-0077" num="0085">All the information in the above example can be derived from the Cartesian product alone, without considering key information. This information can be used to estimate the size of the join L<img id="CUSTOM-CHARACTER-00016" he="3.13mm" wi="3.13mm" file="US07299226-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>partkey=partkey</sub><img id="CUSTOM-CHARACTER-00017" he="2.12mm" wi="1.44mm" file="US07299226-20071120-P00002.TIF" alt="custom character" img-content="character" img-format="tif"/><sub>suppkey=suppkey</sub>x. If the multi-column densities δ<sub>L.partkey,suppkey </sub>and δ<sub>x.partkey,suppkey </sub>are used with Equation 2, the estimated cardinality is calculated as follows:</p>
<p id="p-0078" num="0086">
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>L</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mi>partkey</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mi>partkey</mi>
                    <mo>⩓</mo>
                    <mi>suppkey</mi>
                  </mrow>
                  <mo>=</mo>
                  <mi>suppkey</mi>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>x</mi>
          </mrow>
          <mo>=</mo>
          <mi/>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>L</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>L</mi>
                        <mo>.</mo>
                        <mi>partkey</mi>
                        <mo>.</mo>
                        <mi>suppkey</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>·</mo>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>x</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>x</mi>
                        <mo>.</mo>
                        <mi>partkey</mi>
                        <mo>.</mo>
                        <mi>suppkey</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>L</mi>
                  <mo>.</mo>
                  <mi>partkey</mi>
                  <mo>.</mo>
                  <mi>suppkey</mi>
                </mrow>
                <mo>·</mo>
              </mrow>
            </msub>
            <mo>·</mo>
            <msub>
              <mi>δ</mi>
              <mrow>
                <mrow>
                  <mi>x</mi>
                  <mo>.</mo>
                  <mi>partkeys</mi>
                </mrow>
                <mo>·</mo>
                <mi>uppkey</mi>
              </mrow>
            </msub>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>=</mo>
          <mi/>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mrow>
                <mi>min</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mrow>
                        <mn>600000</mn>
                        <mo>/</mo>
                        <mn>7</mn>
                      </mrow>
                      <mo>*</mo>
                      <mn>5</mn>
                    </mrow>
                    <mo>,</mo>
                    <mrow>
                      <mn>200000</mn>
                      <mo>/</mo>
                      <mn>1</mn>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>*</mo>
              <mn>7.5</mn>
              <mo>*</mo>
              <mn>1</mn>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mrow>
                <mn>80000</mn>
                <mo>*</mo>
                <mn>7.5</mn>
              </mrow>
              <mo>=</mo>
              <mn>600</mn>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mn>000</mn>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
By applying Equation 6 it will be shown that 600,000 is an overestimate of the cardinality. The estimated cardinality using equation 6 multi-column densities δ<sub>L.partkey,suppkey </sub>and δ<sub>x.partkey,suppkey</sub>, and the additional prefix density information δ<sub>L.partkey </sub>and δ<sub>x.partkey </sub>is calculated as follows:
</p>
<p id="p-0079" num="0087">
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>L</mi>
            <mo>⁢</mo>
            <msub>
                            <mrow>
                <mi>partkey</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>=</mo>
                <mrow>
                  <mrow>
                    <mi>partkey</mi>
                    <mo>⩓</mo>
                    <mi>suppkey</mi>
                  </mrow>
                  <mo>=</mo>
                  <mi>suppkey</mi>
                </mrow>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mi>x</mi>
          </mrow>
          <mo>=</mo>
          <mi/>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mi>min</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>L</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>L</mi>
                        <mo>.</mo>
                        <mi>partkey</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                  <mo>·</mo>
                  <mfrac>
                    <msub>
                      <mi>card</mi>
                      <mi>x</mi>
                    </msub>
                    <msub>
                      <mi>δ</mi>
                      <mrow>
                        <mi>x</mi>
                        <mo>.</mo>
                        <mi>partkey</mi>
                      </mrow>
                    </msub>
                  </mfrac>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mrow>
                <mi>min</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mfrac>
                      <msub>
                        <mi>δ</mi>
                        <mrow>
                          <mi>L</mi>
                          <mo>.</mo>
                          <mi>partkey</mi>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>δ</mi>
                        <mrow>
                          <mi>L</mi>
                          <mo>.</mo>
                          <mi>partkey</mi>
                          <mo>.</mo>
                          <mi>suppkey</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                    <mo>·</mo>
                    <mfrac>
                      <msub>
                        <mi>δ</mi>
                        <mrow>
                          <mi>x</mi>
                          <mo>.</mo>
                          <mi>partkey</mi>
                        </mrow>
                      </msub>
                      <msub>
                        <mi>δ</mi>
                        <mrow>
                          <mrow>
                            <mrow>
                              <mi>x</mi>
                              <mo>.</mo>
                              <mi>partkey</mi>
                            </mrow>
                            <mo>..</mo>
                          </mrow>
                          <mo>⁢</mo>
                          <mi>suppkey</mi>
                        </mrow>
                      </msub>
                    </mfrac>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>·</mo>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>L</mi>
                    <mo>.</mo>
                    <mi>partkey</mi>
                  </mrow>
                  <mo>·</mo>
                  <mo>·</mo>
                  <mi>suppkey</mi>
                  <mo>·</mo>
                </mrow>
              </msub>
              <mo>·</mo>
              <msub>
                <mi>δ</mi>
                <mrow>
                  <mrow>
                    <mi>x</mi>
                    <mo>.</mo>
                    <mi>partkey</mi>
                  </mrow>
                  <mo>·</mo>
                  <mi>suppkey</mi>
                </mrow>
              </msub>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mn>600000</mn>
                  <mo>/</mo>
                  <mn>30</mn>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mn>200000</mn>
                  <mo>/</mo>
                  <mn>1000</mn>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>*</mo>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mn>30</mn>
                  <mo>/</mo>
                  <mn>7.5</mn>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mn>1000</mn>
                  <mo>/</mo>
                  <mn>1</mn>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>*</mo>
          <mn>7.5</mn>
          <mo>*</mo>
          <mn>1</mn>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>=</mo>
          <mi/>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mrow>
                <mi>min</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>20000</mn>
                    <mo>,</mo>
                    <mn>200</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>*</mo>
              <mrow>
                <mi>min</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>4</mn>
                    <mo>,</mo>
                    <mn>1000</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>*</mo>
              <mn>7.5</mn>
              <mo>*</mo>
              <mn>1</mn>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mrow>
                <mn>200</mn>
                <mo>*</mo>
                <mn>4</mn>
                <mo>*</mo>
                <mn>7.5</mn>
              </mrow>
              <mo>=</mo>
              <mn>6000</mn>
            </mrow>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Note that the results of the first min operation is the second parameter, while the result for the second min operation is the first parameter. Had the other possible multi-column densities, i.e., δ<sub>L.suppkey,partkey </sub>and δ<sub>x.suppkey,partkey</sub>, and the additional prefix density information δ<sub>L.suppkey </sub>and δ<sub>x.suppkey</sub>, the cardinality is calculated as follows:
</p>
<p id="p-0080" num="0088">
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>L</mi>
          <mo>⁢</mo>
          <msub>
                        <mrow>
              <mi>partkey</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>=</mo>
              <mrow>
                <mrow>
                  <mi>partkey</mi>
                  <mo>⩓</mo>
                  <mi>suppkey</mi>
                </mrow>
                <mo>=</mo>
                <mi>suppkey</mi>
              </mrow>
            </mrow>
          </msub>
          <mo>⁢</mo>
          <mi>x</mi>
        </mrow>
        <mo>=</mo>
        <mi/>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mfrac>
                  <msub>
                    <mi>card</mi>
                    <mi>L</mi>
                  </msub>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>L</mi>
                      <mo>.</mo>
                      <mi>suppkey</mi>
                      <mo>.</mo>
                    </mrow>
                  </msub>
                </mfrac>
                <mo>·</mo>
                <mfrac>
                  <msub>
                    <mi>card</mi>
                    <mi>x</mi>
                  </msub>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>x</mi>
                      <mo>.</mo>
                      <mi>suppkey</mi>
                      <mo>.</mo>
                    </mrow>
                  </msub>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>·</mo>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mfrac>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>L</mi>
                      <mo>.</mo>
                      <mi>suppkey</mi>
                    </mrow>
                  </msub>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mrow>
                        <mi>L</mi>
                        <mo>.</mo>
                        <mi>suppkey</mi>
                      </mrow>
                      <mo>·</mo>
                      <mrow>
                        <mo>.</mo>
                        <mi>partkey</mi>
                        <mo>.</mo>
                      </mrow>
                    </mrow>
                  </msub>
                </mfrac>
                <mo>·</mo>
                <mfrac>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mi>L</mi>
                      <mo>.</mo>
                      <mi>suppkey</mi>
                    </mrow>
                  </msub>
                  <msub>
                    <mi>δ</mi>
                    <mrow>
                      <mrow>
                        <mi>x</mi>
                        <mo>.</mo>
                        <mi>suppkey</mi>
                      </mrow>
                      <mo>·</mo>
                      <mrow>
                        <mo>.</mo>
                        <mi>partkey</mi>
                      </mrow>
                    </mrow>
                  </msub>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>·</mo>
          <msub>
            <mi>δ</mi>
            <mrow>
              <mrow>
                <mi>L</mi>
                <mo>..</mo>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <mi>suppkey</mi>
                <mo>·</mo>
                <mo>·</mo>
                <mi>partkey</mi>
              </mrow>
            </mrow>
          </msub>
          <mo>·</mo>
          <msub>
            <mi>δ</mi>
            <mrow>
              <mrow>
                <mi>x</mi>
                <mo>.</mo>
                <mi>suppkey</mi>
              </mrow>
              <mo>·</mo>
              <mi>partkey</mi>
            </mrow>
          </msub>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mo>=</mo>
        <mi/>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mn>600000</mn>
                  <mo>/</mo>
                  <mn>600</mn>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mn>200000</mn>
                  <mo>/</mo>
                  <mn>200</mn>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>*</mo>
          <mrow>
            <mi>min</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mn>600</mn>
                  <mo>/</mo>
                  <mn>7.5</mn>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mn>200</mn>
                  <mo>/</mo>
                  <mn>1</mn>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>*</mo>
          <mn>7.5</mn>
          <mo>*</mo>
          <mn>1</mn>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>=</mo>
            <mi/>
            <mo>⁢</mo>
            <mrow>
              <mrow>
                <mrow>
                  <mi>min</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mn>1000</mn>
                      <mo>,</mo>
                      <mn>1000</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>*</mo>
                <mrow>
                  <mi>min</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mn>80</mn>
                      <mo>,</mo>
                      <mn>200</mn>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>*</mo>
                <mn>7.5</mn>
                <mo>*</mo>
                <mn>1</mn>
              </mrow>
              <mo>=</mo>
              <mrow>
                <mrow>
                  <mn>1000</mn>
                  <mo>*</mo>
                  <mn>80</mn>
                  <mo>*</mo>
                  <mn>7.5</mn>
                </mrow>
                <mo>=</mo>
                <mn>600</mn>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mn>000</mn>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
In the exemplary embodiment, the method takes the minimum over these two refined estimations (min(600000, 6000)=6000) to obtain the estimated cardinality estimation. The estimated cardinality returned in this example is an accurate estimation (the actual value obtained by running the query on TPC-H is 6629).
</p>
<p id="p-0081" num="0089">Extending the Method to Histograms</p>
<p id="p-0082" num="0090">In one embodiment, the disclosed method of estimating cardinality using multi-column densities can be extended to histograms. Referring to <figref idref="DRAWINGS">FIG. 5</figref>, suppose a multi-column density over R.a, R.c is available, a multi-column density over S.b, S.d is available and histograms <b>150</b>, <b>152</b> over R.a and S.b are also available. In one embodiment, the disclosed method can simply extend the information in each histogram bucket with the single value δ<sub>R.a,c </sub>or δ<sub>S.b,d </sub>coming from the multi-column densities. In this embodiment, each histogram bucket currently represents δ<sub>R.a </sub>and δ<sub>S.b </sub>duplicates for each distinct value of R.a and S.b respectively. In such a case, the method chooses to use an extended histogram as opposed to the multi-column density. The reasoning behind this decision is that more detailed information about one column (R.a) is available and no multi-column density information is lost, since the bucket information is extended with the multi-column density value.</p>
<p id="p-0083" num="0091">Referring to <figref idref="DRAWINGS">FIG. 5</figref>, the buckets <b>154</b> of the histogram <b>150</b> for R.a are aligned with the buckets <b>156</b> of the histogram <b>152</b> for S.b. For each pair of buckets, the multi-column density values δ<sub>R.a,c</sub>, δ<sub>S.b,d </sub>and the information in the pair of buckets (number of tuples in each bucket, density of each bucket) can be used in Equation 7 to calculate the cardinality for the pair of buckets. The results for the pairs of buckets are added together to estimate the cardinality of the join.</p>
<p id="p-0084" num="0092">While the present invention has been described with a degree of particularity, it is the intent that the invention include all modifications and alterations falling within the spirit or scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07299226-20071120-M00001.NB">
<img id="EMI-M00001" he="6.69mm" wi="76.20mm" file="US07299226-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07299226-20071120-M00002.NB">
<img id="EMI-M00002" he="8.47mm" wi="76.20mm" file="US07299226-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07299226-20071120-M00003.NB">
<img id="EMI-M00003" he="7.03mm" wi="76.20mm" file="US07299226-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07299226-20071120-M00004.NB">
<img id="EMI-M00004" he="10.58mm" wi="117.18mm" file="US07299226-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07299226-20071120-M00005.NB">
<img id="EMI-M00005" he="6.69mm" wi="76.20mm" file="US07299226-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07299226-20071120-M00006.NB">
<img id="EMI-M00006" he="6.69mm" wi="76.20mm" file="US07299226-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07299226-20071120-M00007.NB">
<img id="EMI-M00007" he="27.86mm" wi="76.20mm" file="US07299226-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07299226-20071120-M00008.NB">
<img id="EMI-M00008" he="6.35mm" wi="76.20mm" file="US07299226-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07299226-20071120-M00009.NB">
<img id="EMI-M00009" he="11.68mm" wi="76.20mm" file="US07299226-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07299226-20071120-M00010.NB">
<img id="EMI-M00010" he="11.68mm" wi="76.20mm" file="US07299226-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07299226-20071120-M00011.NB">
<img id="EMI-M00011" he="6.35mm" wi="76.20mm" file="US07299226-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07299226-20071120-M00012.NB">
<img id="EMI-M00012" he="6.35mm" wi="76.20mm" file="US07299226-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013" nb-file="US07299226-20071120-M00013.NB">
<img id="EMI-M00013" he="6.35mm" wi="76.20mm" file="US07299226-20071120-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US07299226-20071120-M00014.NB">
<img id="EMI-M00014" he="6.01mm" wi="76.20mm" file="US07299226-20071120-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US07299226-20071120-M00015.NB">
<img id="EMI-M00015" he="6.35mm" wi="76.20mm" file="US07299226-20071120-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016" nb-file="US07299226-20071120-M00016.NB">
<img id="EMI-M00016" he="6.01mm" wi="76.20mm" file="US07299226-20071120-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00017" nb-file="US07299226-20071120-M00017.NB">
<img id="EMI-M00017" he="10.58mm" wi="117.18mm" file="US07299226-20071120-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00018" nb-file="US07299226-20071120-M00018.NB">
<img id="EMI-M00018" he="14.48mm" wi="137.58mm" file="US07299226-20071120-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00019" nb-file="US07299226-20071120-M00019.NB">
<img id="EMI-M00019" he="14.48mm" wi="158.07mm" file="US07299226-20071120-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of estimating cardinality of a join of tables using multicolumn density values, comprising:
<claim-text>identifying a number of distinct combination tuples, the combination tuples containing a combination of values of a plurality of attributes for each table;</claim-text>
<claim-text>determining a number of duplicates for each identified distinct combination tuple;</claim-text>
<claim-text>identifying a number of distinct subset tuples containing a value of a subset of the plurality of attributes for each table;</claim-text>
<claim-text>determining a number of duplicates for each identified subset tuple;</claim-text>
<claim-text>estimating a number of tuples from each table that participate in the join using a subset density factor, the subset density factor being equal to the determined number of duplicates for each identified subset tuple divided by the determined number of distinct subset tuples containing a value of a subset of the plurality of attributes for each table;</claim-text>
<claim-text>estimating the cardinality of the join using a combination density factor for each table and the estimated number of tuples that participate in the join from each table, the combination density factor being equal to the determined number of duplicates for each identified distinct combination tuple divided by the determined number of distinct combination tuples containing a combination of values of a plurality of attributes for each table;</claim-text>
<claim-text>outputting the estimated cardinality of the join.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein estimating a number of tuples of one of the tables that participate in the join comprises estimating a number of distinct values of a subset of the plurality of attributes in a first table, estimating a number of distinct values of a subset of the plurality of attributes in a second table, and multiplying the subset density factor of the attributes in each table by a minimum of the estimated numbers of distinct values.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the number of distinct values of a subset of said plurality of attributes in a table is calculated by dividing the cardinality of the table by the subset density factor of attributes in the table.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein said estimating cardinality comprises selecting the minimum of an estimated number of tuples from a first table that participate in the join divided by the combination density factor over the plurality of attributes for the first table and an estimated number of tuples from a second table that participate in the join divided by the combination density over the plurality of attributes for the second table and multiplying said minimum, said combination density factor over the plurality of attributes for the first table, and said combination density factor over the plurality of attributes for the second table.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein said subset density factor comprises prefixes of said set of attributes.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein densities of a plurality of subsets of the set of attributes are used to calculate a plurality of cardinality estimations and a minimum of the plurality of cardinality estimations is selected as the cardinality estimation for the join.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A computer readable storage medium having computer executable instructions stored thereon for performing a method of estimating cardinality of a join of tables using multicolumn density values, the method comprising:
<claim-text>identifying a number of distinct combination tuples, the combination tuples containing a combination of values of a plurality of attributes for each table;</claim-text>
<claim-text>determining a number of duplicates for each identified distinct combination tuple;</claim-text>
<claim-text>identifying a number of distinct subset tuples containing a value of a subset of the plurality of attributes for each table;</claim-text>
<claim-text>determining a number of duplicates for each identified subset tuple;</claim-text>
<claim-text>estimating a number of tuples from each table that participate in the join using a subset density factor, the subset density factor being equal to the determined number of duplicates for each identified subset tuple divided by the determined number of distinct subset tuples containing a value of a subset of the plurality of attributes for each table;</claim-text>
<claim-text>estimating the cardinality of the join using a combination density factor for each table and the estimated number of tuples that participate in the join from each table, the combination density factor being equal to the determined number of duplicates for each identified distinct combination tuple divided by the determined number of distinct combination tuples containing a combination of values of a plurality of attributes for each table; and</claim-text>
<claim-text>outputting the estimated cardinality of the join.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer readable storage medium of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein estimating a number of tuples of one of the tables that participate in the join comprises estimating a number of distinct values of a subset of the plurality of attributes in a first table, estimating a number of distinct values of a subset of the plurality of attributes in a second table, and multiplying the subset density factor of the attributes in each table by a minimum of the estimated numbers of distinct values.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer readable storage medium of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the number of distinct values of a subset of said plurality of attributes in a table is calculated by dividing the cardinality of the table by the subset density factor of attributes in the table.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer readable storage medium of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein said estimating cardinality comprises selecting the minimum of an estimated number of tuples from a first table that participate in the join divided by the combination density factor over the plurality of attributes for the first table and an estimated number of tuples from a second table that participate in the join divided by the combination density over the plurality of attributes for the second table and multiplying said minimum, said combination density factor over the plurality of attributes for the first table, and said combination density factor over the plurality of attributes for the second table.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer readable storage medium of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein said subset density factor comprises prefixes of said set of attributes.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer readable storage medium of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein densities of a plurality of subsets of the set of attributes are used to calculate a plurality of cardinality estimations and a minimum of the plurality of cardinality estimations is selected as the cardinality estimation for the join.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A computer readable storage medium having computer executable instructions stored thereon for performing a method of estimating cardinality of a join of tables using multicolumn density values, the method comprising:
<claim-text>identifying a number of distinct combination tuples, the combination tuples containing a combination of values of a plurality of attributes for each table;</claim-text>
<claim-text>determining a number of duplicates for each identified distinct combination tuple;</claim-text>
<claim-text>identifying a number of distinct subset tuples containing a value of a subset of the plurality of attributes for each table;</claim-text>
<claim-text>determining a number of duplicates for each identified subset tuple;</claim-text>
<claim-text>identifying a cardinality of each table;</claim-text>
<claim-text>estimating the cardinality of the join using a combination density factor for each table, a subset density factor of the plurality of attributes for each table, and the cardinality of each table,</claim-text>
<claim-text>wherein the combination density factor is equal to the determined number of duplicates for each identified distinct combination tuple divided by the determined number of distinct combination tuples containing a combination of values of the plurality of attributes for each table and the subset density factor is equal to the determined number of duplicates for each identified subset tuple divided by the determined number of distinct subset tuples containing a value of a subset of the plurality of attributes for each table; and</claim-text>
<claim-text>outputting the estimated cardinality of the join.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer readable storage medium of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein the method further comprises estimating a number of tuples from each table that participate in the join using the subset density factor and cardinalities of the tables and wherein the cardinality of the join is estimated using the combination density factor for each table and the estimated number of tuples that participate in the join from each table.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer readable storage medium of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein estimating a number of tuples of one of the tables that participate in the join comprises estimating a number of distinct values of a subset of the plurality of attributes in a first table, estimating a number of distinct values of a subset of the plurality of attributes in a second table, and multiplying the subset density factor of the attributes in each table by a minimum of the estimated numbers of distinct values.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The computer readable storage medium of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the number of distinct subset tuples in a table is calculated by dividing the cardinality of the table by the subset density factor of the subset of attributes in the table.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer readable storage medium of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein said estimating cardinality comprises selecting a minimum of an estimated number of tuples from a first table that participate in the join divided by the combination density factor over the plurality of attributes for the first table and an estimated number of tuples from a second table that participate in the join divided by the combination density factor over the plurality of attributes for the second table and multiplying said minimum, said combination density factor over the plurality of attributes for the first table, and said combination density factor over the plurality of attributes for the second table.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer readable storage medium of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein said subset density factor comprises prefixes of said set of attributes.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer readable storage medium of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein estimating the cardinality comprises identifying a first minimum of a cardinality of a first table divided by the subset density factor of the subset of said plurality of attributes for the first table and a cardinality of a second table divided by the subset density factor of the subset of said plurality of attributes for the second table, identifying a second minimum of said subset density factor of said subset of said set of attributes for the first table divided by the combination density factor over said plurality of attributes for the first table and said subset density factor of said subset of said plurality of attributes for the second table divided by the combination density factor over said plurality of attributes for the second table, and multiplying said first minimum, said second minimum, said combination density over said plurality of attributes for the first table, and said combination density factor over said plurality of attributes for the second table.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer readable storage medium of <claim-ref idref="CLM-00013">claim 13</claim-ref> wherein subset density factors of a plurality of subsets of the plurality of attributes are used to calculate a plurality of cardinality estimations and a minimum of the plurality of cardinality estimations is selected as the cardinality estimation for the join.</claim-text>
</claim>
</claims>
</us-patent-grant>
