<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298819-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298819</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11241658</doc-number>
<date>20050929</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>N</subclass>
<main-group>5</main-group>
<subgroup>10</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>378 65</main-classification>
<further-classification>600407</further-classification>
</classification-national>
<invention-title id="d0e43">Flexible treatment planning</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>2002/0051513</doc-number>
<kind>A1</kind>
<name>Pugachev et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>378 65</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2006/0293583</doc-number>
<kind>A1</kind>
<name>Saracen et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600407</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00003">
<othercit>Leksell, L., “The stereotactic method and radiosurgery of the brain”, Acta Chirurgica Scandanavica 102 (1951), pp. 316-319.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00004">
<othercit>Holder, A., “A tutorial on radiation oncology and optimization”, In Greenberg, H.J., ed.: Tutorials on Emerging Methodologies and Applications in Operations Research. Kluwer Academic Press (2004).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00005">
<othercit>Ferris, M., Lim, J., Shepard, D.: “An optimization approach for the radiosurgery treatment planning”, SIAM Journal on Optimization 13 (2003), pp. 921-937.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>Cheek, S., Holder, A., Fuss, M. Salter, B.: “The relationship between the number of shots and the quality of Gamma Knife Radiosurgeries.” Technical Report 84, Department of Mathematics, Trinity University, San Antonio, TX (2004).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00007">
<othercit>Rosen, I., Lane, R., Morrill, S., Belli, J.: “Treatment plan optimization using linear programming”, Medical Physics 18 (1991), pp. 141-152.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>Shepard, D., Ferris, M., Olivera, G., Mackie, T.: “Optimizing the delivery of radiation therapy to cancer patients”, SIAM Review 41 (1999) pp. 721-744.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Bartolozzi, F., De Gaetano, A., DiLena, E., Marino, S., Nieddu, L., Patrizi, G.: “Operational research techniques in medical treatment and diagnosis: a review.” European Journal of Operations Research 121 (2000) pp. 435-466.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Holder, A.: “Radiotherapy treatment design and linear programming”. Technical Report 70, Department of Mathematics, Trinity University, San Antonio, TX (2002).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Dantzig, G.B., Orden, A., Wolfe, P.: “The generalized Simplex method for minimizing a linear form under linear inequality restraints”. Pacific Journal of Mathematics 5 (1955), pp. 183-195.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Paddick, I.: “A simple scoring ratio to index the conformality of radiosurgical treatment plans”, Journal of Neurosurgery 93 (2000), pp. 219-222.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>D. Bechmann, N. Dubreuil, “Animation through space and time base don a space deformation model”, The Journal of Visualization and Computer Animation, 4(3) 165-184, 1993.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>M. Levoy, et al., “Volume Rendering in Radiation Treatment Planning”, Proc. First Conference on Visualization in Biomedical Computing, IEEE Computer Society Press, Atlanta, Georgia, May 1990, pp. 4-10.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>PCT International Preliminary Report on Patentability (Chapter I of the Patent Cooperation Treaty), PCT/US2005/035371 filed Sep. 30, 2005, mailed Apr. 12, 2007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>International PCT Search Report and Written Opinion, PCT/US05//35371, Int'l. filing date Sep. 30, 2005, mailing date Nov. 9, 2006, 9 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>41</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>378 65</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600407</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>12</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60614574</doc-number>
<kind>00</kind>
<date>20040930</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060067469</doc-number>
<kind>A1</kind>
<date>20060330</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Dooley</last-name>
<first-name>John R.</first-name>
<address>
<city>Milpitas</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Wang</last-name>
<first-name>Jin-Wu J.</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bodduluri</last-name>
<first-name>Radhika Mohan</first-name>
<address>
<city>Palo Atlo</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>West</last-name>
<first-name>Jay B.</first-name>
<address>
<city>Mountain View</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Blakely, Sokoloff, Taylor &amp; Zafman LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Accuray Incorporated</orgname>
<role>02</role>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Thomas</last-name>
<first-name>Courtney</first-name>
<department>2882</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A flexible treatment planning system configured to enable the user to utilize both forward planning and inverse planning techniques is described.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="182.12mm" wi="94.23mm" file="US07298819-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="169.50mm" wi="166.54mm" file="US07298819-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="180.42mm" wi="164.51mm" file="US07298819-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="153.84mm" wi="143.51mm" file="US07298819-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="211.41mm" wi="98.30mm" file="US07298819-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="183.81mm" wi="166.96mm" file="US07298819-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="199.98mm" wi="168.15mm" file="US07298819-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="211.67mm" wi="159.77mm" file="US07298819-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="215.98mm" wi="152.15mm" file="US07298819-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="213.02mm" wi="161.46mm" file="US07298819-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="233.85mm" wi="178.65mm" orientation="landscape" file="US07298819-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="174.16mm" wi="132.33mm" file="US07298819-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="206.25mm" wi="187.03mm" file="US07298819-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application claims the benefit of U.S. Provisional Application 60/614,574, filed Sep. 30, 2004, the contents of which are hereby incorporated by reference herein.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">Embodiments of the present invention relate generally to radiation treatment and, more particularly, to treatment planning in radiation treatment.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">Tumors and lesions are types of pathological anatomies characterized by abnormal growth of tissue resulting from the uncontrolled, progressive multiplication of cells, while serving no physiological function.</p>
<p id="p-0005" num="0004">Pathological anatomies can be treated with an invasive procedure, such as surgery, but can be harmful and full of risks for the patient. A non-invasive method to treat a pathological anatomy (e.g., tumor, legion, vascular malformation, nerve disorder, etc.) is external beam radiation therapy. In one type of external beam radiation therapy, an external radiation source is used to direct a sequence of x-ray beams at a tumor site from multiple angles, with the patient positioned so the tumor is at the center of rotation (isocenter) of the beam. As the angle of the radiation source changes, every beam passes through the tumor site, but passes through a different area of healthy tissue on its way to the tumor. As a result, the cumulative radiation dose at the tumor is high and the average radiation dose to healthy tissue is low.</p>
<p id="p-0006" num="0005">The term “radiotherapy” refers to a radiation treatment procedure in which radiation is applied to a target region for therapeutic, rather than necrotic, purposes. The amount of radiation utilized in radiotherapy treatment sessions is typically about an order of magnitude smaller, as compared to the amount used in a radiosurgery session. Radiotherapy is typically characterized by a low dose per treatment (e.g., 100-200 centiGray (cGy)), short treatment times (e.g., 10 to 30 minutes per treatment) and conventional or hyperfractionation (e.g., 30 to 45 days of treatment). For convenience, the term “radiation treatment” is used herein to mean radiosurgery and/or radiotherapy unless otherwise noted by the magnitude of the radiation.</p>
<p id="p-0007" num="0006">In order to deliver a requisite dose to a targeted region, whilst minimizing exposure to healthy tissue and avoiding sensitive critical structures, a suitable treatment planning system is required. Treatment plans specify quantities such as the directions and intensities of the applied radiation beams, and the durations of the beam exposure. It is desirable that treatment plans be designed in such a way that a specified dose (required for the clinical purpose at hand) be delivered to a tumor, while avoiding an excessive dose to the surrounding healthy tissue and, in particular, to any important nearby organs. Developing an appropriate treatment planning system is especially challenging for tumors that are larger, have irregular shapes, or are close to a sensitive or critical structure.</p>
<p id="p-0008" num="0007">A treatment plan may typically be generated from input parameters such as beam positions, beam orientations, beam shapes, beam intensities, and radiation dose distributions (that are deemed necessary by the radiologist in order to achieve a particular clinical goal). Sophisticated treatment plans may be developed using advanced modeling techniques, and state-of-the-art optimization algorithms.</p>
<p id="p-0009" num="0008">Two kinds of treatment planning procedures are known: forward planning and inverse planning. In early days, treatment planning systems tended to focus on forward planning techniques. In forward treatment planning, a medical physicist determines the radiation dose of a chosen beam and then calculates how much radiation will be absorbed by the tumor, critical structures (i.e., vital organs) and other healthy tissue. There is no independent control of the dose levels to the tumor and other structures for a given number of beams, because the radiation absorption in a volume of tissue is determined by the properties of the tissue and the distance of each point in the volume to the origin of the beam and the beam axis. More specifically, the medical physicist may “guess” or assign, based on his experience, values to various treatment parameters such as beam positions and beam intensities. The treatment planning system then calculates the resulting dose distribution. After reviewing the resulting dose distribution, the medical physicist may adjust the values of the treatment parameters. The system re-calculates a new resulting dose distribution. This process may be repeated, until the medical physicist is satisfied by the resulting dose distribution, as compared to his desired distribution. Forward planning tends to rely on the user's ability to iterate through various selections of beam directions and dose weights, and to properly evaluate the resulting dose distributions. The more experienced the user, the more likely a satisfactory dose distribution is produced.</p>
<p id="p-0010" num="0009">In inverse planning, in contrast to forward planning, the medical physicist specifies the minimum dose to the tumor and the maximum dose to other healthy tissues independently, and the treatment planning module then selects the direction, distance, and total number and intensity of the beams in order to achieve the specified dose conditions. Given a desired dose distribution specified and input by the user (e.g., the minimum and maximum doses), the inverse planning module selects and optimizes dose weights and/or beam directions, i.e. select an optimum set of beams that results in such a distribution.</p>
<p id="p-0011" num="0010">Inverse planning may have the advantage of being able to produce better plans, when used by less sophisticated users. However, conventional treatment planning systems do not allow a user the flexibility to use both forward planning and inverse planning techniques within a same plan, or to switch back and forth between forward planning and inverse planning. Also, conventional treatment planning systems do not allow a user to incorporate direct modification of the topological map for the isodose distribution. These conventional inverse planning systems may require user definition of anatomical regions to affect the dose distribution. These drawn regions may usually cover a limited percentage of the patient anatomy, and may not fully reflect the clinical goals of the treatment plan. Further, existing treatment planning systems may be based solely on either an isocentric beam geometry or a non-isocentric boundary-targeting beam geometry.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">The present invention is illustrated by way of example, and not by way of limitation, in the figures of the accompanying drawings.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an exemplary embodiment of an isocentric beam profile.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates an exemplary embodiment of non-isocentric beam profile.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2B</figref> illustrates one embodiment of a tumor T and critical structure C delineated.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2C</figref> is a flow chart illustrating one embodiment of an inverse planning method.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an exemplary embodiment of a combined isocentric and non-isocentric beam profile.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a series of isodose curves specified along with a tumor and a critical structure.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a functional PET image <b>500</b> of an intra cranial axial view.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> shows an intra cranial axial view illustrating an exemplary embodiment of a non-isocentric beam profile to treat an elongated target region.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 7</figref> illustrates another exemplary embodiment of a non-isocentric beam profile to treat a ring shaped target region.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 8</figref> illustrates one embodiment of systems that may be used to perform radiation treatment in which features of the present invention may be implemented.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 9</figref> illustrates one embodiment of an image-guided, robotic-based radiation treatment system.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 10</figref> illustrates one embodiment of a combined isocentric and non-isocentric beam profile to treat an irregular shaped tumor.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0025" num="0024">In the following description, numerous specific details are set forth such as examples of specific components, devices, methods, etc., in order to provide a thorough understanding of embodiments of the present invention. It will be apparent, however, to one skilled in the art that these specific details need not be employed to practice embodiments of the present invention. In other instances, well-known materials or methods have not been described in detail in order to avoid unnecessarily obscuring embodiments of the present invention. The term “coupled” as used herein, may mean directly coupled or indirectly coupled through one or more intervening components or systems.</p>
<p id="p-0026" num="0025">Embodiments of the present invention include various steps, which will be described below. The steps of the present invention may be performed by hardware components or may be embodied in machine-executable instructions, which may be used to cause a general-purpose or special-purpose processor programmed with the instructions to perform the steps. Alternatively, the steps may be performed by a combination of hardware and software.</p>
<p id="p-0027" num="0026">The treatment planning module and system discussed herein may be implemented using hardware, software, firmware or combinations thereof. For example, a forward planning module that may be composed of hardware, firmware, software, or any combination thereof, may be used to implement the forward planning techniques described herein; an inverse planning module that may be composed of hardware, firmware, software, or any combination thereof, may be used to implement the inverse planning techniques described herein. A forward and inverse planning module (or combination of the separate modules mentioned above) that may be composed of hardware, firmware, software, or any combination thereof, may be used to implement the mixed, or flexible, planning techniques described herein, wherein at least a portion of the treatment plan is developed using forwarding planning techniques and at least another portion of the treatment plan is developed using inverse planning techniques.</p>
<p id="p-0028" num="0027">The software modules discussed herein may be written in a variety of programming languages, such as, for example, C/C++ and/or Assembly, etc. The operating system (OS) on which the software runs may be a Windows® OS from Microsoft Corporation of Washington or a Mac OS from Apple Computer of California. Alternatively, the OS may be a Unix, Linux, or other operating systems (e.g., embedded or real-time operating system), etc. The software and OS may be run on any type of platform, for example, a personal computer (PC) platform, workstation, etc.</p>
<p id="p-0029" num="0028">A software module, or computer program product, may include a machine-readable medium having stored thereon instructions, which may be used to program a computer system (or other electronic devices) to perform a process. A machine-readable medium includes any mechanism for storing or transmitting information in a form (e.g., software, processing application) readable by a machine (e.g., a computer). The machine-readable medium may include, but is not limited to, magnetic storage medium (e.g., floppy diskette); optical storage medium (e.g., CD-ROM); magneto-optical storage medium; read-only memory (ROM); random-access memory (RAM); erasable programmable memory (e.g., EPROM and EEPROM); flash memory; electrical, optical, acoustical, or other form of propagated signal (e.g., carrier waves, infrared signals, digital signals, etc.); or other type of medium suitable for storing electronic instructions.</p>
<p id="p-0030" num="0029">Unless stated otherwise as apparent from the following discussion, it will be appreciated that terms such as “processing,” “selecting,” “determining,” “generating,” “weighting” or the like may refer to the actions and processes of a computer system, or similar electronic computing device, that manipulates and transforms data represented as physical (e.g., electronic) quantities within the computer system's registers and memories into other data similarly represented as physical within the computer system memories or registers or other such information storage, transmission or display devices. Embodiments of the method described herein may be implemented using computer software. If written in a programming language conforming to a recognized standard, sequences of instructions designed to implement the methods can be compiled for execution on a variety of hardware platforms and for interface to a variety of operating systems. In addition, embodiments of the present invention are not described with reference to any particular programming language. It will be appreciated that a variety of programming languages may be used to implement embodiments of the present invention.</p>
<p id="p-0031" num="0030">Some portions of the description that follow are presented in terms of algorithms and symbolic representations of operations on data bits that may be stored within a memory and operated on by a processor. These algorithmic descriptions and representations are the means used by those skilled in the art to effectively convey their work. An algorithm is generally conceived to be a self-consistent sequence of acts leading to a desired result. The acts are those requiring manipulation of quantities. Usually, though not necessarily, these quantities take the form of electrical or magnetic signals capable of being stored, transferred, combined, compared, and otherwise manipulated. It has proven convenient at times, principally for reasons of common usage, to refer to these signals as bits, values, elements, symbols, characters, terms, numbers, parameters, or the like.</p>
<p id="p-0032" num="0031">A flexible treatment planning module (FTPM) for radiosurgery is described. In one embodiment, a hybrid approach to treatment planning may be used that integrates both forward and inverse planning techniques (e.g., isocentric and non-isocentric beam geometries) to develop a treatment plan and, thereby, allows a user to engage in both forward and inverse planning modes during treatment planning. In one embodiment, the user can produce a plan using a partial set of beams generated using one or more forward planning approaches and the rest of the beams by one or more inverse planning approaches. In another embodiment, the user can produce a plan generated by forward planning technique with a set of beams and initiate an inverse planning scheme to improve the plan. In another embodiment, the user can produce a plan generated by inverse planning technique with a set of beams and initiate forward planning scheme to improve the plan. In another embodiment, the user can produce a plan generated by either forward or inverse planning technique and enhance the plan by either inverse or forward planning technique with additional beams, respectively. In another embodiment, the user can produce a plan generated by forward planning approach by adjusting beam weights based on a selection of one or more beams. In another embodiment, the user can produce a plan generated by inverse planning approach by using only beams selected based on one or more specific characteristics of the beams. These embodiments are described in more detail below.</p>
<p id="p-0033" num="0032">Although a specific type of target such as a pathological anatomy (such as a tumor, legion, arteriovenous malformation, etc.) may be referred to below for ease of explanation purposes, the method and apparatus described herein may be applied to other types of targets (e.g., non-biological) and other types of objects (non-human).</p>
<p id="p-0034" num="0033">In forward planning, a user (e.g., medical physicist) chooses the directions of the beams and the intensity of the beams and then the treatment planning module calculates and displays the resulting dose distribution. More specifically, the user may specify particular directions and intensities for the radiation beams to be generated by the radiation treatment delivery system, choosing from a subset of available beams determined by constraints on the delivery system itself. The user may “guess” or assign, based on his or her experience, values to beam directions and intensities, or weights. The treatment planning system then calculates the resulting dose distribution. By evaluating the dose distribution, the user may manually change his or her selection of beams in an attempt to improve the dose distribution. The feedback given to the user is the dose profile corresponding to the current plan where beams may be removed, changed or added until the dose profile is deemed acceptable. After reviewing the resulting dose distribution, the user may adjust the values of the treatment parameters. The system re-calculates a new resulting dose distribution. This process may be repeated, until the user is satisfied by the resulting dose distribution, as compared to a desired distribution.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 1</figref> illustrates an exemplary embodiment of an isocentric beam profile. In one embodiment where a forward planning process is used, at least in a part, an isocentric beam profile <b>110</b> may be produced. In order to generate such a profile, an external radiation source is used to direct a sequence of x-ray beams (e.g., beam <b>120</b>) at a tumor target <b>130</b> from multiple angles, with the patient being positioned so the tumor is at the center of rotation (isocenter) of the beams. Each available beam is targeted at the same point to form the “isocenter,” which generally may be a roughly spherical isodose region as represented by sphere <b>140</b>. Accordingly, isocentric planning may be often applied when treating a tumor that has a substantially regular (e.g., spherical) shape. As the angle of the radiation source is changed, every beam passes through the tumor, but may pass through a different area of healthy tissue on its way to the tumor. By stacking isocenters within a target volume, a plan may be developed that ensures that nearly all the target receives a sufficient dose. As a result, the cumulative radiation dose at the tumor may be high and the average radiation dose to healthy tissue may be low.</p>
<p id="p-0036" num="0035">In one embodiment, a linear or non-iterative algorithm that performs convex optimization may be used to perform forward planning, for example a Simplex algorithm. Such an algorithm operates to minimize the number of monitor units (MUs) subject to the minimum/maximum dose constraints. A Simplex algorithm is known in the art; accordingly, a detailed description is not provided. It should be noted that a forward planning process may not necessary be the same as an isocentric planning process.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 2A</figref> illustrates an exemplary embodiment of non-isocentric beam profile. In an embodiment where inverse planning process (which may also be referred as conformal planning) is used, at least in part, a non-isocentric beam profile <b>210</b> is produced. In inverse treatment planning, some beams may or may not intersect or converge at a common point (the isocenter). Although some of the beams may appear to intersect in the perspective of <figref idref="DRAWINGS">FIG. 2A</figref>, the beams may not intersect in their actual three-dimensional space. The radiation beams (e.g., beam <b>220</b>) need only intersect with the target <b>130</b> and do not necessarily converge on a single point, or isocenter, within the target <b>130</b>.</p>
<p id="p-0038" num="0037">In one embodiment, an inverse planning process may generally proceed as follows. Find a plan so that an objective function J is minimized while meeting the constraints on doses in tumor(s) and other critical structures. Given a tumor region T and a critical region C, as shown in <figref idref="DRAWINGS">FIG. 2B</figref>, the inverse planning problem is formulated as follows:</p>
<p id="p-0039" num="0038">Find the plan x with beams that minimizes the objective function J(x) such that
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0039">D<sub>T</sub>(x)&lt;D<sub>Tmax </sub>for each pixel in Tumor T</li>
        <li id="ul0002-0002" num="0040">D<sub>T</sub>(x)&gt;D<sub>Tmin </sub>for each pixel in Tumor T</li>
        <li id="ul0002-0003" num="0041">D<sub>C</sub>(x)&lt;D<sub>Cmax </sub>for each pixel in Critical structure C.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0040" num="0042">The objective function J itself is defined in different ways depending on the planning system. The optimization variables x vary also depending on the planning system. In one embodiment, the treatment planning system uses the objective function J as the total monitor units of all the beams. The selection of the linear objective function and the linear formulation of constraints enable optimization using linear programming.</p>
<p id="p-0041" num="0043">In one embodiment, the inverse-planning process may be well suited for the user (e.g., physician or the physicist) to specify the doses required to kill a tumor and maximum doses allowed in the critical structures. An inverse planning process to specify the dose distributions based on the anatomy region may be referred to as region-based inverse planning. One of the assumptions of the region-based inverse planning is that the objective function is intelligently formulated such that the result of the optimization while meeting the user specified constraint criteria results in an overall optimal dose distribution. An optimal dose distribution, in the most ideal sense, is the uniform dose in Tumor equaling D<sub>Tmin</sub>, and zero everywhere else. While this is not practical, the optimization strives to achieve the best it can, based on the objective function.</p>
<p id="p-0042" num="0044">In one embodiment, the dose calculation in the inverse planning process considers a set of beams that are directed at the tumor <b>130</b>. In this embodiment, the inverse planning process is used with a radiation source that has a collimator that defines the width of the set of beams that is produced. For each tumor <b>130</b>, for example, the number of beams, their sizes (e.g., as established by the collimator), their positions and orientations are determined. Having defined the position, orientation, and size of the beams to be used for planning, how much radiation should be delivered via each beam is also determined. The total amount of radiation exiting the collimator for one beam is defined in terms of Monitor Units (MU). Because the intensity of the radiation source is constant, the MU is linearly related to the amount of time for which the beam is enabled. The radiation dose absorbed (in units of cGy) by tissue in the path of the beam is related to the MU. The absorbed dose related to a beam is also affected by the collimator size of the beam, the amount of material between the collimator and the calculation point, the distance of the collimator from the calculation point, and the distance of the calculation point from the central axis of the beam.</p>
<p id="p-0043" num="0045"><figref idref="DRAWINGS">FIG. 2C</figref> is a flow chart illustrating one embodiment of an inverse planning method. In this embodiment, the inverse planning method utilizes an iterative routine that enables alterations to treatment plan without requiring re-initialization of the optimization process.</p>
<p id="p-0044" num="0046">In one embodiment, the treatment planning algorithm receives as input from a user, step <b>281</b>, the delineated target region <b>130</b> and any critical region <b>235</b> on one or more slices of a CT image; and (2) dose constraints defining the minimum and maximum doses for target region <b>130</b> and the maximum dose for the critical region <b>235</b>. It should be noted that additional dose constraints for additional regions may also be provided. The delineation of the regions and the dose constraints may be performed in any order. In one embodiment, a dose isocontour may be generated by the treatment planning module for a given dose percentage (e.g., 60%, 70%, 80%, etc.) of the maximum dose as displayed to the user, step <b>282</b>. The generation of a dose isocontour is known in the art; accordingly, a more detailed description is not provided.</p>
<p id="p-0045" num="0047">In one embodiment, the treatment planning module assesses any penalties that may be assigned, step <b>285</b>, before performing beam weighting. Whether any penalties should be assessed when performing beam weighting may be based, for example, on the dose constraints for a dose voxel, in order to reduce dose to a given sensitive organ to minimal levels. A beam intersecting such position may be given a penalty such that it is automatically set to have zero MU in the final plan.</p>
<p id="p-0046" num="0048">Then, beam weighting is performed in step <b>286</b>. The user or the treatment planning module assigns an arbitrary weighting to each of one or more beams of the radiation treatment system. This weighting may be determined using an algorithm designed to give a suitable “start point” for planning, may be randomly chosen, or may simply be a constant weighting for each beam.</p>
<p id="p-0047" num="0049">Then, the treatment planning algorithm performs beam weighting of each one or more beams of the radiation treatment system to be used in the treatment plan according to the inputs provided by the user above. In one particular embodiment, to begin the beam weighting, step <b>286</b>, an assumption may be made that the size and trajectory of the beam set has been defined. Let the beam set be {B<sub>i</sub>; 1≦i≦N}, where N≈500. Each of the beams illustrate in <figref idref="DRAWINGS">FIG. 2A</figref> has a weight (e.g., a number of MU assigned to the beam, or how long a beam will be maintained on) associated with it. The weight in MU of each beam is designated by w<sub>i</sub>. The delineated regions are represented as objects T<sub>i</sub>, with corresponding minimum and maximum allowed dose min<sub>j </sub>and max<sub>j</sub>, and critical structures (critical region <b>235</b>) C<sub>j</sub>, with corresponding max<sub>j </sub>defined. Each region has an integer priority p<sub>j</sub>ε[0,100] defining the relative importance of the dose constraints applied to that region. For each beam, a dose value mask is created. The dose value mask provides a linked list of floating point values and positions d<sub>i</sub>(r) where r is the position within the dose calculation volume, and d<sub>i </sub>is the dose in cGy delivered to r by beam i when w<sub>i </sub>is set to unity. Thus, the total dose at r is given by:</p>
<p id="p-0048" num="0050">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>D</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>r</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>∑</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <msub>
              <mi>w</mi>
              <mi>i</mi>
            </msub>
            <mo>⁢</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>d</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>r</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0049" num="0051">For each B<sub>i</sub>, we define a beam value υ<sub>i</sub>, where</p>
<p id="p-0050" num="0052">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>υ</mi>
            <mi>i</mi>
          </msub>
          <mo>=</mo>
          <mfrac>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mi>j</mi>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mo>∑</mo>
                <mrow>
                  <mi>r</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>ε</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>T</mi>
                    <mi>j</mi>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <msub>
                      <mi>d</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>r</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
            <mrow>
              <mo>∑</mo>
              <mrow>
                <msub>
                  <mi>d</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>r</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0051" num="0053">The beam value is the ratio of dose delivered into tumor <b>130</b> to total dose delivered. To define the initial set of w<sub>i </sub>for optimization, we set w<sub>i</sub>=υ<sub>i</sub>, ∀i. The maximum dose within the dose calculation volume, D<sub>max</sub>, is computed and the beam weights renormalized so that the new maximum dose is equal to the largest of the maximum dose constraints, max<sub>j</sub>. Hence, this provides:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>w</i><sub>i</sub>=υ<sub>i</sub>sup(max<sub>j</sub>)/<i>D</i><sub>max</sub>.   (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0052" num="0054">At one iteration of the treatment planning algorithm, the optimization process looks at all of the dose values in the dose volume and determines if the target tumor <b>130</b> and critical structure <b>235</b> are within the dose constraints.</p>
<p id="p-0053" num="0055">Given the initial weights, the optimization process then alters the beam weights so that the treatment solution is closer to meeting the provided dose constraints. First, a set of Δw<sub>i</sub>, the amount by which each beam weight may be changed, is defined:</p>
<p id="p-0054" num="0056">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>Δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <msub>
              <mi>w</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <msup>
                <mi>Δ</mi>
                <mrow>
                  <mo>(</mo>
                  <mn>0</mn>
                  <mo>)</mo>
                </mrow>
              </msup>
              <mo>⁢</mo>
              <msub>
                <mi>w</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mfrac>
                <mi>s</mi>
                <mrow>
                  <mn>4</mn>
                  <mo>⁢</mo>
                  <mi>N</mi>
                </mrow>
              </mfrac>
              <mo>⁢</mo>
              <mrow>
                <munderover>
                  <mo>∑</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>N</mi>
                </munderover>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <msub>
                  <mi>w</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <mo>∀</mo>
          <mi>i</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where s is the search resolution, having an initial value of 1.
</p>
<p id="p-0055" num="0057">The optimization process iterates through one or more of the beams and for each of the beams, if a beam weight is increased or decreased by a certain amount, determines the resulting dose distribution from such a change (i.e., how such a change alters the amount of violation of the treatment plan constraints). For example, an increase in one or more of the beam weights may typically help in achieving the constraint in the target (e.g., tumor) region but, depending on the location of the beam, it may also hurt in the critical region due to a possible resulting increase of dose above the maximum value in the critical region.</p>
<p id="p-0056" num="0058">The optimization process traverses the volume of interest, adds up all the penalties that are incurred by the increase in a beam weight, adds up all the penalties that are incurred by the decreasing the beam weight (e.g., under-dosing the target region), and then provides a result. In one embodiment, a multiplier may be used with each penalty to stress the importance of one constraint (e.g., minimum dose value in the target region) versus another constraint (e.g., maximum dose value in the target region). For example, it may be more important to achieve a minimum dose value than to stay under the maximum dose value in the target region.</p>
<p id="p-0057" num="0059">The optimization process then updates the dose and goes on to the next beam and repeats the process until it has made its way through the beam set. The optimization process then reaches a stage where it has looked at all of the different weights for each of the beams at the different dose levels and selects the beam weight that provides the optimal resulting dose values in both the target region and critical region.</p>
<p id="p-0058" num="0060">More particularly, in one embodiment, the iterative optimization process proceeds as follows: Iterate over the beams in decreasing order of υ<sub>i</sub>. For each beam B<sub>j</sub>, calculate P<sub>j</sub><sup>+</sup> and P<sub>j</sub><sup>−</sup>, the relative penalties for respectively increasing or decreasing w<sub>j</sub>, that are defined as:</p>
<p id="p-0059" num="0061">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msubsup>
              <mi>P</mi>
              <mi>j</mi>
              <mo>+</mo>
            </msubsup>
            <mo>=</mo>
            <mrow>
              <mrow>
                <munderover>
                  <mo>∑</mo>
                  <mi>i</mi>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </munderover>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <msub>
                      <mi>V</mi>
                      <mi>i</mi>
                    </msub>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <munderover>
                      <mo>∑</mo>
                      <mrow>
                        <mrow>
                          <mi>r</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <msub>
                            <mi>εT</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                        <mo>⋃</mo>
                        <mrow>
                          <mi>r</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <msub>
                            <mi>εC</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                      </mrow>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                    </munderover>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>Δ</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <msub>
                        <mi>w</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <msub>
                          <mi>d</mi>
                          <mi>j</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>r</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>max</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mn>0</mn>
                            <mo>,</mo>
                            <mrow>
                              <mi>min</mi>
                              <mo>⁡</mo>
                              <mrow>
                                <mo>(</mo>
                                <mrow>
                                  <mn>1</mn>
                                  <mo>,</mo>
                                  <mfrac>
                                    <mrow>
                                      <mrow>
                                        <mi>D</mi>
                                        <mo>⁡</mo>
                                        <mrow>
                                          <mo>(</mo>
                                          <mi>r</mi>
                                          <mo>)</mo>
                                        </mrow>
                                      </mrow>
                                      <mo>+</mo>
                                      <mrow>
                                        <mi>Δ</mi>
                                        <mo>⁢</mo>
                                        <mstyle>
                                          <mspace width="0.3em" height="0.3ex"/>
                                        </mstyle>
                                        <mo>⁢</mo>
                                        <msub>
                                          <mi>w</mi>
                                          <mi>j</mi>
                                        </msub>
                                        <mo>⁢</mo>
                                        <mrow>
                                          <msub>
                                            <mi>d</mi>
                                            <mi>j</mi>
                                          </msub>
                                          <mo>⁡</mo>
                                          <mrow>
                                            <mo>(</mo>
                                            <mi>r</mi>
                                            <mo>)</mo>
                                          </mrow>
                                        </mrow>
                                      </mrow>
                                      <mo>-</mo>
                                      <msub>
                                        <mi>max</mi>
                                        <mi>i</mi>
                                      </msub>
                                    </mrow>
                                    <mrow>
                                      <mi>Δ</mi>
                                      <mo>⁢</mo>
                                      <mstyle>
                                        <mspace width="0.3em" height="0.3ex"/>
                                      </mstyle>
                                      <mo>⁢</mo>
                                      <msub>
                                        <mi>w</mi>
                                        <mi>j</mi>
                                      </msub>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <msub>
                                          <mi>d</mi>
                                          <mi>j</mi>
                                        </msub>
                                        <mo>⁡</mo>
                                        <mrow>
                                          <mo>(</mo>
                                          <mi>r</mi>
                                          <mo>)</mo>
                                        </mrow>
                                      </mrow>
                                    </mrow>
                                  </mfrac>
                                </mrow>
                                <mo>)</mo>
                              </mrow>
                            </mrow>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>-</mo>
              <mrow>
                <munderover>
                  <mo>∑</mo>
                  <mi>i</mi>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </munderover>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <msub>
                      <mi>V</mi>
                      <mi>i</mi>
                    </msub>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <munderover>
                      <mo>∑</mo>
                      <mrow>
                        <mi>r</mi>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>⁢</mo>
                        <msub>
                          <mi>εT</mi>
                          <mi>i</mi>
                        </msub>
                      </mrow>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                    </munderover>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>Δ</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <msub>
                        <mi>w</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <msub>
                          <mi>d</mi>
                          <mi>j</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>r</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>max</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mn>0</mn>
                            <mo>,</mo>
                            <mrow>
                              <mi>min</mi>
                              <mo>⁡</mo>
                              <mrow>
                                <mo>(</mo>
                                <mrow>
                                  <mn>1</mn>
                                  <mo>,</mo>
                                  <mfrac>
                                    <mrow>
                                      <msub>
                                        <mi>min</mi>
                                        <mi>i</mi>
                                      </msub>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <mo>-</mo>
                                        <mrow>
                                          <mi>D</mi>
                                          <mo>⁡</mo>
                                          <mrow>
                                            <mo>(</mo>
                                            <mi>r</mi>
                                            <mo>)</mo>
                                          </mrow>
                                        </mrow>
                                      </mrow>
                                    </mrow>
                                    <mrow>
                                      <mi>Δ</mi>
                                      <mo>⁢</mo>
                                      <mstyle>
                                        <mspace width="0.3em" height="0.3ex"/>
                                      </mstyle>
                                      <mo>⁢</mo>
                                      <msub>
                                        <mi>w</mi>
                                        <mi>j</mi>
                                      </msub>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <msub>
                                          <mi>d</mi>
                                          <mi>j</mi>
                                        </msub>
                                        <mo>⁡</mo>
                                        <mrow>
                                          <mo>(</mo>
                                          <mi>r</mi>
                                          <mo>)</mo>
                                        </mrow>
                                      </mrow>
                                    </mrow>
                                  </mfrac>
                                </mrow>
                                <mo>)</mo>
                              </mrow>
                            </mrow>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>and</mi>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <msubsup>
              <mi>P</mi>
              <mi>j</mi>
              <mo>-</mo>
            </msubsup>
            <mo>=</mo>
            <mrow>
              <mrow>
                <munderover>
                  <mo>∑</mo>
                  <mi>i</mi>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </munderover>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <msub>
                      <mi>V</mi>
                      <mi>i</mi>
                    </msub>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <munderover>
                      <mo>∑</mo>
                      <mrow>
                        <mi>r</mi>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                        <mo>⁢</mo>
                        <msub>
                          <mi>εT</mi>
                          <mi>i</mi>
                        </msub>
                      </mrow>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                    </munderover>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>Δ</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <msub>
                        <mi>w</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <msub>
                          <mi>d</mi>
                          <mi>j</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>r</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>max</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mn>0</mn>
                            <mo>,</mo>
                            <mrow>
                              <mi>min</mi>
                              <mo>⁡</mo>
                              <mrow>
                                <mo>(</mo>
                                <mfrac>
                                  <mrow>
                                    <mrow>
                                      <msub>
                                        <mi>min</mi>
                                        <mi>i</mi>
                                      </msub>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <mo>-</mo>
                                        <mrow>
                                          <mi>D</mi>
                                          <mo>⁡</mo>
                                          <mrow>
                                            <mo>(</mo>
                                            <mi>r</mi>
                                            <mo>)</mo>
                                          </mrow>
                                        </mrow>
                                      </mrow>
                                    </mrow>
                                    <mo>+</mo>
                                    <mrow>
                                      <mi>Δ</mi>
                                      <mo>⁢</mo>
                                      <mstyle>
                                        <mspace width="0.3em" height="0.3ex"/>
                                      </mstyle>
                                      <mo>⁢</mo>
                                      <msub>
                                        <mi>w</mi>
                                        <mi>j</mi>
                                      </msub>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <msub>
                                          <mi>d</mi>
                                          <mi>j</mi>
                                        </msub>
                                        <mo>⁡</mo>
                                        <mrow>
                                          <mo>(</mo>
                                          <mi>r</mi>
                                          <mo>)</mo>
                                        </mrow>
                                      </mrow>
                                    </mrow>
                                  </mrow>
                                  <mrow>
                                    <mi>Δ</mi>
                                    <mo>⁢</mo>
                                    <mstyle>
                                      <mspace width="0.3em" height="0.3ex"/>
                                    </mstyle>
                                    <mo>⁢</mo>
                                    <msub>
                                      <mi>w</mi>
                                      <mi>j</mi>
                                    </msub>
                                    <mo>⁢</mo>
                                    <mrow>
                                      <msub>
                                        <mi>d</mi>
                                        <mi>j</mi>
                                      </msub>
                                      <mo>⁡</mo>
                                      <mrow>
                                        <mo>(</mo>
                                        <mi>r</mi>
                                        <mo>)</mo>
                                      </mrow>
                                    </mrow>
                                  </mrow>
                                </mfrac>
                                <mo>)</mo>
                              </mrow>
                            </mrow>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
              <mo>-</mo>
              <mrow>
                <munderover>
                  <mo>∑</mo>
                  <mi>i</mi>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                </munderover>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <msub>
                      <mi>p</mi>
                      <mi>i</mi>
                    </msub>
                    <msub>
                      <mi>V</mi>
                      <mi>i</mi>
                    </msub>
                  </mfrac>
                  <mo>⁢</mo>
                  <mrow>
                    <munderover>
                      <mo>∑</mo>
                      <mrow>
                        <mrow>
                          <mi>r</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <msub>
                            <mi>εT</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                        <mo>⋃</mo>
                        <mrow>
                          <mi>r</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <msub>
                            <mi>εC</mi>
                            <mi>i</mi>
                          </msub>
                        </mrow>
                      </mrow>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                    </munderover>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>Δ</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <msub>
                        <mi>w</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>⁢</mo>
                      <mrow>
                        <msub>
                          <mi>d</mi>
                          <mi>j</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>r</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>max</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mn>0</mn>
                            <mo>,</mo>
                            <mrow>
                              <mi>min</mi>
                              <mo>⁡</mo>
                              <mrow>
                                <mo>(</mo>
                                <mrow>
                                  <mn>1</mn>
                                  <mo>,</mo>
                                  <mfrac>
                                    <mrow>
                                      <mrow>
                                        <mi>D</mi>
                                        <mo>⁡</mo>
                                        <mrow>
                                          <mo>(</mo>
                                          <mi>r</mi>
                                          <mo>)</mo>
                                        </mrow>
                                      </mrow>
                                      <mo>-</mo>
                                      <msub>
                                        <mi>max</mi>
                                        <mi>i</mi>
                                      </msub>
                                    </mrow>
                                    <mrow>
                                      <mi>Δ</mi>
                                      <mo>⁢</mo>
                                      <mstyle>
                                        <mspace width="0.3em" height="0.3ex"/>
                                      </mstyle>
                                      <mo>⁢</mo>
                                      <msub>
                                        <mi>w</mi>
                                        <mi>j</mi>
                                      </msub>
                                      <mo>⁢</mo>
                                      <mrow>
                                        <msub>
                                          <mi>d</mi>
                                          <mi>j</mi>
                                        </msub>
                                        <mo>⁡</mo>
                                        <mrow>
                                          <mo>(</mo>
                                          <mi>r</mi>
                                          <mo>)</mo>
                                        </mrow>
                                      </mrow>
                                    </mrow>
                                  </mfrac>
                                </mrow>
                                <mo>)</mo>
                              </mrow>
                            </mrow>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>,</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mn>53.</mn>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0060" num="0062">where V<sub>i </sub>is the volume in mm<sup>3 </sup>of region i. Hence, the penalty for this beam is the sum of the additional amount of over-dosing and under-dosing that would be created by the change in the beam, weighted by the priorities of the different regions and normalized according to the region volumes. If P<sub>j</sub><sup>−</sup> and P<sub>j</sub><sup>+</sup> are both positive, w<sub>j </sub>is kept the same, otherwise change w<sub>j</sub>=w<sub>j</sub>±Δw<sub>j </sub>according to whichever of P<sub>j</sub><sup>−</sup> and P<sub>j</sub><sup>+</sup> i smaller. If the previous iteration moved w<sub>j </sub>in the same direction as this iteration, the following is set:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Δ<i>w</i><sub>j</sub><i>=Δw</i><sub>j</sub>+Δ<sup>(0)</sup><i>w</i><sub>j</sub>,   (5)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>else set:<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Δw<sub>j</sub>=Δ<sup>(0)</sup>w<sub>j</sub>.   (6)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0061" num="0063">The change in dose according to Δw<sub>j </sub>is computed and applied to the dose volume before the optimization process moves on to a next beam, because a correct decision on how to change the beam weight assumes an up-to-date view of the dose including change sin previous w<sub>i</sub>. If all w<sub>j </sub>remained unchanged by the current iteration, s is reduced by a factor of 2. The process may iterate (indicated by the dashed line <b>283</b>) to generate a more optimized result. In one embodiment, the treatment planning module may generate an optimized dose isocontour that may be displayed to the user, step <b>287</b>.</p>
<p id="p-0062" num="0064">The optimization process described above may also provide feedback to the user via an update to the dose isocontours and/or dose volume histograms (DVHs), after each iteration in the optimization process. In one embodiment, beam statistics may also be displayed to the user, for example, the total MU and number of beams, the minimum non-zero MU of all currently existing beams and the maximum MU. These statistics may also be continually updated by the treatment planning module at the end of each optimization iteration. Accordingly, it is easy to make small modifications to the plan without going through the entire solution process. In an alternative embodiment, other iterative and non-linear optimization algorithms may be used.</p>
<p id="p-0063" num="0065"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an exemplary embodiment of a combined isocentric and non-isocentric beam profile. In an embodiment where a combined forward and inverse planning module (referred to as FTPM) is used to generate a combined beam profile <b>310</b> composed of an isocentric beam profile <b>110</b> and a non-isocentric beam profile <b>210</b>. The beam profile <b>110</b> of the forward planning process may be used, for example, to target an inner volume of the tumor <b>130</b>, while the beam profile <b>210</b> of the inverse planning process may be used, for example, to target the outer periphery of the tumor <b>130</b>. The combination of the forward and inverse planning process may, thus, permit very complex tumor surfaces and volumes to be accurately irradiated so that a more accurate and complete treatment of the tumor can be performed. It should be noted that number of beams illustrated in <figref idref="DRAWINGS">FIGS. 1-3</figref> are only for ease of illustration and that an actual treatment plan may include more, or fewer, than the illustrated number of beams.</p>
<p id="p-0064" num="0066">Each beam in a treatment planning system may be characterized by a radiation emission point, a distance to the tumor target <b>130</b>, an orientation, and a radiation dose weight. The FTPM enables the user to control these characteristics. FTPM allows the user to specify which beams (e.g., a first subset of the system's beams) should be selected using forward planning, and which beams (e.g., a second subset of system's beams) should be selected using inverse planning. Each beam in the first subset may be characterized by user-generated values representative of radiation emission point, target point, orientation, and radiation dose weight. In other words, each beam in the first subset is generated using forward planning. Each beam in the second subset may be generated using inverse planning. The radiation emission point, target point, orientation, and radiation dose weight for the beams in the second subset are generated by the treatment planning module in such a way that at least a portion of a desired radiation dose distribution profile is achieved.</p>
<p id="p-0065" num="0067">For instance, the user may produce a plan generated by a forward planning approach, by adjusting beam weights based on a selection of one or more beams. Alternatively, the user can produce a plan generated by the inverse planning approach, by using only beams selected based on one or more specific characteristics of the beams. Alternatively, the user can use a partial set of beams generated using a forward planning approach, and the rest by one or more inverse planning approach.</p>
<p id="p-0066" num="0068">By way of example, in one embodiment, the user may produce a plan that uses forward planning to create one or more isocenters that distribute the radiation dose to the central part of the target <b>130</b> as discussed above. Inverse planning is then used to shape the dose in the proximity of the target <b>130</b> boundary (i.e., the outer periphery). The central dose to the tumor <b>130</b> is constrained using the sum of the effect of the non-isocentric shaping beams and the constant previously calculated dose from the isocentric forward planning process. Alternatively, the user can first use inverse planning to create a dose distribution around the boundary of target <b>130</b>. Forward planning is then used to fill the dose in the central portion of the target <b>130</b>.</p>
<p id="p-0067" num="0069">In another embodiment, the user may target isocentric beams as in a forward planning process, but not assign dose weightings to those beams. The inverse planning algorithm uses sculpting beams around the boundary of the target <b>130</b> and the full weight of the isocentrically targeted beams to generate a dose distribution for treatment of the target <b>130</b>.</p>
<p id="p-0068" num="0070">In operation, the user of FTPM determines the tumor location and boundaries, based on pre-operative image (e.g., CT, PET, MRI, etc.). The user then determines beam geometries. For example, the user inputs desired values for the beam diameters, and decides whether the beams should be isocentric or non-isocentric. Next, the user sets the acceptable dose ranges for predetermined regions such as the tumor <b>130</b> and the critical structure <b>235</b>, i.e. the upper and lower limits of radiation for delivering the requisite doses of radiation to the tumor <b>130</b>, and avoid the critical structure <b>135</b>. The FTPM finds the optical solution, i.e. the optimal set of beams and associated characteristics (such as beam paths and dose weights) that satisfies these constraints imposed by the user. In one embodiment, a linear optimization algorithm, as described above, may be used to determine the optical dose weights and beam directions.</p>
<p id="p-0069" num="0071">It should be noted that the FTPM is not limited to only divisions of forward planning and inverse planning to treat bulk and boundary areas, respectively, of a substantially regular shaped (e.g., spherical) tumor target as was discussed in an exemplary manner above. In another embodiment, both forward and inverse planning techniques may be used to treat the same portions of a tumor, which may be regardless of tumor shape. For example, if a tumor has a region of higher intensity relative to other regions in the tumor (e.g., region <b>503</b>), inverse planning may be used to treat the entire tumor region and forward planning may be used to treat the higher intensity region. <figref idref="DRAWINGS">FIG. 5</figref> illustrates a functional PET image <b>500</b> of an intra cranial axial view. A lesion, for example, does not necessarily have a uniform distribution of cells within the volume occupied by the lesion. Functional images such as PET scans can provide data relating to the differences in cellular activity within the lesion volume. Fluorodeoxyglucose (FDG), a radioactive sugar molecule, is used to produce images that demonstrate increased glucose metabolism associated with regions of lesion activity. Because cancer cells grow and divide more rapidly than normal cells, they metabolize more sugar for fuel. This increased activity identifies them as cancer in FDG-PET scanning. For this procedure, the patient is injected with the FDG and lies in a PET camera for the imaging. Areas of activity from PET images are also represented by differences in image intensity. Especially beneficial is the data shown with respect to tissue activity for lesion <b>506</b>, which shows a higher intensity region <b>504</b>, indicating an area of high glucose metabolism, and therefore higher lesion cell content. Accordingly, inverse planning may be used to treat the entire tumor region <b>506</b> and forward planning may be used to treat the higher intensity region <b>504</b>.</p>
<p id="p-0070" num="0072">In alternative embodiments, the inverse planning techniques, or a combination of the inverse and forward planning techniques of the FTPM, may also be used to treat other target shapes and regions, for examples, ring shaped, crescent, elongated, etc. by selecting only certain beams based on various geometric and physical characteristics.</p>
<p id="p-0071" num="0073"><figref idref="DRAWINGS">FIG. 6</figref> shows an intra cranial axial view illustrating an exemplary embodiment of a non-isocentric beam profile to treat an elongated target region. In this embodiment, a non-isocentric beam profile is delivered to the elongated target <b>630</b>. However, the treatment plan may be developed using both forward planning and an inverse planning techniques whereby a forward planning process is used to select only certain beams targeted at the central region <b>635</b> of the tumor target <b>630</b>, and then an inverse planning process is used to weight the selected beams.</p>
<p id="p-0072" num="0074">In this embodiment, unlike an isocentric form of forward planning, each available beam is not targeted at the same point to form an isocenter. Rather, inverse planning techniques are used to plan a non-isocentric beam profile for the entire target <b>630</b>. However, similar to forward planning, in this embodiment, the user may specify particular beams (i.e., choose a subset of available beams) from the planned non-isocentric profile that tend to target the central region <b>635</b> of the elongated target tumor <b>630</b>. For example, the user may choose to select all of the illustrated beams (e.g., the chosen subset of the all the illustrated beams) except for beams <b>661</b>-<b>663</b> which do not intersect with the central region <b>635</b>. It should be noted that the process may be one by which the user selects the desired beams and/or de-selects beams that are not desired.</p>
<p id="p-0073" num="0075">Then, an inverse planning process is used whereby either the user, or the treatment planning module, assigns weights (step <b>286</b> of <figref idref="DRAWINGS">FIG. 2C</figref>) to the beams. The treatment planning system then re-calculates the resulting dose distribution. The user may evaluate the resulting dose distribution and manually change his or her selection of beams in an attempt to improve the dose distribution. The treatment planning system may re-calculate yet another resulting dose distribution. This process may be repeated, until the user is satisfied by the resulting dose distribution, as compared to a desired distribution. Circle <b>680</b> indicates a collimator size, for the LINAC that produces the beams, to be used in one position Collimator size may be chosen by the user or be chosen automatically by the inverse planning algorithm. A bigger collimator (for example 60 mm) produces a larger beam compared to a smaller collimator (for example 5 mm). For this example, note that the collimator is smaller than the target and therefore encompasses just a portion of that target.</p>
<p id="p-0074" num="0076"><figref idref="DRAWINGS">FIG. 7</figref> illustrates another exemplary embodiment of a non-isocentric beam profile to treat a ring shaped target region. In this embodiment, a non-isocentric beam profile is delivered to the ring shaped target <b>730</b>. Similar to the process discussed above in relation to <figref idref="DRAWINGS">FIG. 6</figref>, a treatment plan may be developed using both forward planning and an inverse planning techniques whereby a forward planning process is used to select only certain beams targeted at the central region <b>735</b> of the ring shaped target <b>730</b> and then an inverse planning process is used to deliver the selected beams. The user may specify particular beams (i.e., choose a subset of available beams) from a planned non-isocentric profile that tend to target the central region <b>735</b> of the ring shaped target <b>730</b>. For example, the user may choose to select all of the illustrated beams (e.g., the chosen subset of the illustrated beams) except for beams <b>761</b>-<b>763</b> which do not intersect with the central region <b>735</b>. As previously noted, the process may be one by which the user selects the desired beams and/or de-selects beams that are not desired.</p>
<p id="p-0075" num="0077">Then, an inverse planning process is used whereby either the user, or the treatment planning module, assigns weights (step <b>286</b> of <figref idref="DRAWINGS">FIG. 2C</figref>) to the beams. The treatment planning system then re-calculates the resulting dose distribution. As described above, this process may be repeated, until the user is satisfied by the resulting dose distribution, as compared to a desired distribution.</p>
<p id="p-0076" num="0078"><figref idref="DRAWINGS">FIG. 10</figref> illustrates one embodiment of a combined isocentric and non-isocentric beam profile to treat an irregular shaped tumor. In this embodiment, an isocentric planning process similar to those discussed above in regards to <figref idref="DRAWINGS">FIG. 1</figref> may be used to target the bulk region <b>1110</b> of an irregular shaped tumor <b>1110</b>. While a mixed planning process similar to that described above in regards to <figref idref="DRAWINGS">FIG. 7</figref> may be used to target the outer regions of the tumor <b>1110</b>. More specifically, a non-isocentric beam profile (as exemplified by beam <b>1064</b>) is delivered to a portion of a ring shaped target <b>730</b> of <figref idref="DRAWINGS">FIG. 10</figref> using a treatment plan developed using both forward planning and inverse planning techniques. A forward planning process is used to select only certain beams targeted at the central region <b>735</b> of the ring shaped target <b>730</b> that overlap the tumor <b>1110</b> and then an inverse planning process is used to weight the selected beams. The user may specify particular beams (i.e., choose a subset of available beams) from a planned non-isocentric profile that tend to target the central region <b>735</b> of the ring shaped target <b>730</b> or deselect undesired beams that do not tend to target central region <b>735</b> (e.g., beams <b>1064</b> and <b>1065</b>) and/or do not target regions of the tumor (e.g., beams <b>1061</b>-<b>1063</b>). Then, an inverse planning process is used whereby either the user, or the treatment planning module, assigns weights (step <b>286</b> of <figref idref="DRAWINGS">FIG. 2C</figref>) to the beams. The treatment planning system then re-calculates the resulting dose distribution. As described above, this process may be repeated, until the user is satisfied by the resulting dose distribution, as compared to a desired distribution.</p>
<p id="p-0077" num="0079"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a series of isodose curves specified along with a tumor and a critical structure. In one embodiment, the treatment planning system may provide an isodose-based inverse planning technique, in which the user can specify isodose contours (e.g., curve <b>441</b>, <b>442</b>, <b>443</b>), as well as acceptable dose ranges for a tumor <b>130</b> and critical structure <b>235</b>. <figref idref="DRAWINGS">FIG. 4</figref> illustrates exemplary isodose curves <b>441</b>, <b>442</b>, <b>443</b> corresponding to 3, 15, and 20 Gy values, respectively, that the user specified. The inverse planning problem can now be specified as follows:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0080">Find the plan x with beams that minimizes the objective function J(x) such that</li>
        <li id="ul0004-0002" num="0081">D<sub>i</sub>=D<sub>iprescribed </sub>for each pixel on isodose curve i,</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0078" num="0082">Isodose based constraints give a user a more direct control on the desired overall dose distribution. Since the user is looking for the optimal overall dose distribution, this method reduces the effect on the results based on the selection of objective function J.</p>
<p id="p-0079" num="0083">Accordingly, in one embodiment, the inverse planning process utilizes both isodose-based and region-based inverse planning formulations, as follows:</p>
<p id="p-0080" num="0084">Find the plan x with beams that minimizes the objective function J(x) such that:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0085">D<sub>i</sub>=D<sub>iprescribed </sub>for each pixel on isodose curve i,</li>
        <li id="ul0006-0002" num="0086">D<sub>T</sub>(x)&lt;D<sub>Tmax </sub>for each pixel in Tumor T</li>
        <li id="ul0006-0003" num="0087">D<sub>T</sub>(x)&gt;D<sub>Tmin </sub>for each pixel in Tumor T</li>
        <li id="ul0006-0004" num="0088">D<sub>C</sub>(x)&lt;D<sub>Cmax </sub>for each pixel in Critical structure C.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0081" num="0089">The optimization variables x vary, depending on the planning system, and are the monitor units of each of the beams that the machine is capable of generating, which in one embodiment may not be more than 1200 or 1300 beams. Alternatively, another number of beams may be used.</p>
<p id="p-0082" num="0090">In one embodiment, the treatment planning system may also provide a user with the flexibility to directly modify a topological map of the isodose distribution generated for inverse planning, during use. In such an embodiment, the treatment planning system includes a drawing device interactive with a system display that is responsive to user action, to draw on a display screen contours representative of at least one desired radiation isodose contour and associated radiation value within the image. The treatment planning system may generate isodose contour data representative of the isodose contour lines and associated radiation value. In this embodiment, a processing device within the treatment planning system is responsive to the isodose contour data to determine the beam paths and associated radiation emission points and radiation intensities for affecting a radiation pattern in the anatomical structure characterized by the desired radiation isodose contours.</p>
<p id="p-0083" num="0091"><figref idref="DRAWINGS">FIG. 8</figref> illustrates one embodiment of systems that may be used to perform radiation treatment in which features of the present invention may be implemented. As described below and illustrated in <figref idref="DRAWINGS">FIG. 17</figref>, system <b>1000</b> may include a diagnostic imaging system <b>2000</b>, a treatment planning system <b>3000</b>, and a treatment delivery system <b>4000</b>.</p>
<p id="p-0084" num="0092">Diagnostic imaging system <b>2000</b> may be any system capable of producing medical diagnostic images of a volume of interest (VOI) in a patient that may be used for subsequent medical diagnosis, treatment planning and/or treatment delivery. For example, diagnostic imaging system <b>2000</b> may be a computed tomography (CT) system, a magnetic resonance imaging (MRI) system, a positron emission tomography (PET) system, an ultrasound system or the like. For ease of discussion, diagnostic imaging system <b>2000</b> may be discussed below at times in relation to a CT x-ray imaging modality. However, other imaging modalities such as those above may also be used.</p>
<p id="p-0085" num="0093">Diagnostic imaging system <b>2000</b> includes an imaging source <b>2010</b> to generate an imaging beam (e.g., x-rays, ultrasonic waves, radio frequency waves, etc.) and an imaging detector <b>2020</b> to detect and receive the beam generated by imaging source <b>2010</b>, or a secondary beam or emission stimulated by the beam from the imaging source (e.g., in an MRI or PET scan). In one embodiment, diagnostic imaging system <b>2000</b> may include two or more diagnostic X-ray sources and two or more corresponding imaging detectors. For example, two x-ray sources may be disposed around a patient to be imaged, fixed at an angular separation from each other (e.g., 90 degrees, 45 degrees, etc.) and aimed through the patient toward (an) imaging detector(s) which may be diametrically opposed to the x-ray sources. A single large imaging detector, or multiple imaging detectors, may also be used that would be illuminated by each x-ray imaging source. Alternatively, other numbers and configurations of imaging sources and imaging detectors may be used.</p>
<p id="p-0086" num="0094">The imaging source <b>2010</b> and the imaging detector <b>2020</b> are coupled to a digital processing system <b>2030</b> to control the imaging operation and process image data. Diagnostic imaging system <b>2000</b> includes a bus or other means <b>2035</b> for transferring data and commands among digital processing system <b>2030</b>, imaging source <b>2010</b> and imaging detector <b>2020</b>. Digital processing system <b>2030</b> may include one or more general-purpose processors (e.g., a microprocessor), special purpose processor such as a digital signal processor (DSP) or other type of device such as a controller or field programmable gate array (FPGA). Digital processing system <b>2030</b> may also include other components (not shown) such as memory, storage devices, network adapters and the like. Digital processing system <b>2030</b> may be configured to generate digital diagnostic images in a standard format, such as the DICOM (Digital Imaging and Communications in Medicine) format, for example. In other embodiments, digital processing system <b>2030</b> may generate other standard or non-standard digital image formats. Digital processing system <b>2030</b> may transmit diagnostic image files (e.g., the aforementioned DICOM formatted files) to treatment planning system <b>3000</b> over a data link <b>1500</b>, which may be, for example, a direct link, a local area network (LAN) link or a wide area network (WAN) link such as the Internet. In addition, the information transferred between systems may either be pulled or pushed across the communication medium connecting the systems, such as in a remote diagnosis or treatment planning configuration. In remote diagnosis or treatment planning, a user may utilize embodiments of the present invention to diagnose or treatment plan despite the existence of a physical separation between the system user and the patient.</p>
<p id="p-0087" num="0095">Treatment planning system <b>3000</b> includes a processing device <b>3010</b> to receive and process image data. Processing device <b>3010</b> may represent one or more general-purpose processors (e.g., a microprocessor), special purpose processor such as a digital signal processor (DSP) or other type of device such as a controller or field programmable gate array (FPGA). Processing device <b>3010</b> may be configured to execute instructions for performing treatment planning operations discussed herein, for example, automatically generating an envelope of constraint points based on the anatomical shape of a pathological anatomy, and optimizing a current dose isocontour utilizing the envelope of constraint points.</p>
<p id="p-0088" num="0096">Treatment planning system <b>3000</b> may also include system memory <b>3020</b> that may include a random access memory (RAM), or other dynamic storage devices, coupled to processing device <b>3010</b> by bus <b>3055</b>, for storing information and instructions to be executed by processing device <b>3010</b>. System memory <b>3020</b> also may be used for storing temporary variables or other intermediate information during execution of instructions by processing device <b>3010</b>. System memory <b>3020</b> may also include a read only memory (ROM) and/or other static storage device coupled to bus <b>3055</b> for storing static information and instructions for processing device <b>3010</b>.</p>
<p id="p-0089" num="0097">Treatment planning system <b>3000</b> may also include storage device <b>3030</b>, representing one or more storage devices (e.g., a magnetic disk drive or optical disk drive) coupled to bus <b>3055</b> for storing information and instructions. Storage device <b>3030</b> may be used for storing instructions for performing the treatment planning steps discussed herein, such as the dilution and erosion algorithms.</p>
<p id="p-0090" num="0098">Processing device <b>3010</b> may also be coupled to a display device <b>3040</b>, such as a cathode ray tube (CRT) or liquid crystal display (LCD), for displaying information (e.g., a two-dimensional or three-dimensional representation of the VOI) to the user. An input device <b>3050</b>, such as a keyboard, may be coupled to processing device <b>3010</b> for communicating information and/or command selections to processing device <b>3010</b>. One or more other user input devices (e.g., a mouse, a trackball or cursor direction keys) may also be used to communicate directional information, to select commands for processing device <b>3010</b> and to control cursor movements on display <b>3040</b>.</p>
<p id="p-0091" num="0099">It will be appreciated that treatment planning system <b>3000</b> represents only one example of a treatment planning system, which may have many different configurations and architectures, which may include more components or fewer components than treatment planning system <b>3000</b> and which may be employed with the present invention. For example, some systems often have multiple buses, such as a peripheral bus, a dedicated cache bus, etc. The treatment planning system <b>3000</b> may also include MIRIT (Medical Image Review and Import Tool) to support DICOM import (so images can be fused and targets delineated on different systems and then imported into the treatment planning system for planning and dose calculations), expanded image fusion capabilities that allow the user to treatment plan and view dose distributions on any one of various imaging modalities (e.g., MRI, CT, PET, etc.). Treatment planning systems are known in the art; accordingly, a more detailed discussion is not provided.</p>
<p id="p-0092" num="0100">Treatment planning system <b>3000</b> may share its database (e.g., data stored in storage device <b>3030</b>) with a treatment delivery system, such as treatment delivery system <b>4000</b>, so that it may not be necessary to export from the treatment planning system prior to treatment delivery. Treatment planning system <b>3000</b> may be linked to treatment delivery system <b>4000</b> via a data link <b>2500</b>, which may be a direct link, a LAN link or a WAN link as discussed above with respect to data link <b>1500</b>. It should be noted that when data links <b>1500</b> and <b>2500</b> are implemented as LAN or WAN connections, any of diagnostic imaging system <b>2000</b>, treatment planning system <b>3000</b> and/or treatment delivery system <b>4000</b> may be in decentralized locations such that the systems may be physically remote from each other. Alternatively, any of diagnostic imaging system <b>2000</b>, treatment planning system <b>3000</b> and/or treatment delivery system <b>4000</b> may be integrated with each other in one or more systems.</p>
<p id="p-0093" num="0101">Treatment delivery system <b>4000</b> includes a therapeutic and/or surgical radiation source <b>4010</b> to administer a prescribed radiation dose to a target volume in conformance with a treatment plan. Treatment delivery system <b>4000</b> may also include an imaging system <b>4020</b> to capture intra-treatment images of a patient volume (including the target volume) for registration or correlation with the diagnostic images described above in order to position the patient with respect to the radiation source. Treatment delivery system <b>4000</b> may also include a digital processing system <b>4030</b> to control radiation source <b>4010</b>, imaging system <b>4020</b>, and a patient support device such as a treatment couch <b>4040</b>. Digital processing system <b>4030</b> may include one or more general-purpose processors (e.g., a microprocessor), special purpose processor such as a digital signal processor (DSP) or other type of device such as a controller or field programmable gate array (FPGA). Digital processing system <b>4030</b> may also include other components (not shown) such as memory, storage devices, network adapters and the like. Digital processing system <b>4030</b> may be coupled to radiation source <b>4010</b>, imaging system <b>4020</b> and treatment couch <b>4040</b> by a bus <b>4045</b> or other type of control and communication interface.</p>
<p id="p-0094" num="0102">In one embodiment, as illustrated in <figref idref="DRAWINGS">FIG. 9</figref>, treatment delivery system <b>4000</b> may be an image-guided, robotic-based radiation treatment system (e.g., for performing radiosurgery) such as the CyberKnife® system developed by Accuray Incorporated of California. In <figref idref="DRAWINGS">FIG. 18</figref>, radiation source <b>4010</b> may be represented by a linear accelerator (LINAC) <b>4051</b> mounted on the end of a robotic arm <b>4052</b> having multiple (e.g., 5 or more) degrees of freedom in order to position the LINAC <b>4051</b> to irradiate a pathological anatomy (target region or volume) with beams delivered from many angles in an operating volume (e.g., a sphere) around the patient. Treatment may involve beam paths with a single isocenter (point of convergence), multiple isocenters, or with a non-isocentric approach (i.e., the beams need only intersect with the pathological target volume and do not necessarily converge on a single point, or isocenter, within the target as illustrated in <figref idref="DRAWINGS">FIG. 1</figref>). Treatment can be delivered in either a single session (mono-fraction) or in a small number of sessions as determined during treatment planning. With treatment delivery system <b>4000</b>, in one embodiment, radiation beams may be delivered according to the treatment plan without fixing the patient to a rigid, external frame to register the intra-operative position of the target volume with the position of the target volume during the pre-operative treatment planning phase.</p>
<p id="p-0095" num="0103">In <figref idref="DRAWINGS">FIG. 9</figref>, imaging system <b>4020</b> may be represented by X-ray sources <b>4053</b> and <b>4054</b> and X-ray image detectors (imagers) <b>4056</b> and <b>4057</b>. In one embodiment, for example, two x-ray sources <b>4053</b> and <b>4054</b> may be nominally aligned to project imaging x-ray beams through a patient from two different angular positions (e.g., separated by 90 degrees, 45 degrees, etc.) and aimed through the patient on treatment couch <b>4050</b> toward respective detectors <b>4056</b> and <b>4057</b>. In another embodiment, a single large imager can be used that would be illuminated by each x-ray imaging source. Alternatively, other numbers and configurations of imaging sources and imagers may be used.</p>
<p id="p-0096" num="0104">Digital processing system <b>4030</b> may implement algorithms to register images obtained from imaging system <b>4020</b> with pre-operative treatment planning images in order to align the patient on the treatment couch <b>4050</b> within the treatment delivery system <b>4000</b>, and to precisely position the radiation source with respect to the target volume.</p>
<p id="p-0097" num="0105">The treatment couch <b>4050</b> may be coupled to another robotic arm (not illustrated) having multiple (e.g., 5 or more) degrees of freedom. The couch arm may have five rotational degrees of freedom and one substantially vertical, linear degree of freedom. Alternatively, the couch arm may have six rotational degrees of freedom and one substantially vertical, linear degree of freedom or at least four rotational degrees of freedom. The couch arm may be vertically mounted to a column or wall, or horizontally mounted to pedestal, floor, or ceiling. Alternatively, the treatment couch <b>4050</b> may be a component of another mechanical mechanism, such as the Axum® treatment couch developed by Accuray, Inc. of California, or be another type of conventional treatment table known to those of ordinary skill in the art.</p>
<p id="p-0098" num="0106">Alternatively, treatment delivery system <b>4000</b> may be another type of treatment delivery system, for example, a gantry based (isocentric) intensity modulated radiotherapy (IMRT) system. In a gantry based system, a radiation source (e.g., a LINAC) is mounted on the gantry in such a way that it rotates in a plane corresponding to an axial slice of the patient. Radiation is then delivered from several positions on the circular plane of rotation. In IMRT, the shape of the radiation beam is defined by a multi-leaf collimator that allows portions of the beam to be blocked, so that the remaining beam incident on the patient has a pre-defined shape. The resulting system generates arbitrarily shaped radiation beams that intersect each other at the isocenter to deliver a dose distribution to the target. In IMRT planning, the optimization algorithm selects subsets of the main beam and determines the amount of time that the patient should be exposed to each subset, so that the prescribed dose constraints are best met.</p>
<p id="p-0099" num="0107">In other embodiments, yet another type of treatment delivery system <b>4000</b> may be used, for example, a stereotactic frame system such as the GammaKnife®, available from Elekta of Sweden. With such a system, the optimization algorithm (also referred to as a sphere packing algorithm) of the treatment plan determines the selection and dose weighting assigned to a group of beams forming isocenters in order to best meet provided dose constraints.</p>
<p id="p-0100" num="0108">It should be noted that the methods and apparatus described herein are not limited to use only with medical diagnostic imaging and treatment. In alternative embodiments, the methods and apparatus herein may be used in applications outside of the medical technology field, such as industrial imaging and non-destructive testing of materials (e.g., motor blocks in the automotive industry, airframes in the aviation industry, welds in the construction industry and drill cores in the petroleum industry) and seismic surveying. In such applications, for example, “treatment” may refer generally to the effectuation of an operation controlled by the TPS, such as the application of a beam (e.g., radiation, acoustic, etc.).</p>
<p id="p-0101" num="0109">In the foregoing specification, the invention has been described with reference to specific exemplary embodiments thereof. It will, however, be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention as set forth in the appended claims. The specification and drawings are, accordingly, to be regarded in an illustrative sense rather than a restrictive sense.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298819-20071120-M00001.NB">
<img id="EMI-M00001" he="8.81mm" wi="76.20mm" file="US07298819-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298819-20071120-M00002.NB">
<img id="EMI-M00002" he="11.26mm" wi="76.20mm" file="US07298819-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298819-20071120-M00003.NB">
<img id="EMI-M00003" he="8.81mm" wi="76.20mm" file="US07298819-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298819-20071120-M00004.NB">
<img id="EMI-M00004" he="50.80mm" wi="76.20mm" file="US07298819-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method, comprising:
<claim-text>performing forward planning, at least in part, to develop a treatment plan using a first subset of beams of a plurality of beams, wherein performing forward planning comprises selecting a direction and an intensity for each beam in the first subset of beams; and</claim-text>
<claim-text>performing inverse planning, at least in part to develop the treatment plan.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein inverse planning is performed using a second subset of beams of the plurality of beams.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second subset of beams does not include any of the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the second subset of beams includes one or more beams from the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein each of the plurality of beams is characterized by a plurality of parameters comprising a radiation emission point, a distance to a target, an orientation, and a radiation dose weight, and wherein selecting the direction comprises selecting the radiation emission point and the orientation for each beam in the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein at least one of the plurality of parameters of each beam in the first subset of beams is generated by a user, and wherein at least one of the parameters of the second subset of beams is generated by an inverse treatment planning module.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the second subset of beams may include one or more beams from the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the second subset of beams does not include any of the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein
<claim-text>performing forward planning comprises selecting the first subset of beams from among the plurality of beams, wherein each beam in the first subset of beams is based on user generated values representative of a radiation emission point, a target point, and a radiation dose weight; and wherein</claim-text>
<claim-text>performing inverse planning comprises determining at least one of the radiation emission points, the target point and the radiation dose weight of a second subset of beams.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein selecting the direction comprises selecting an emission point and an orientation for each of the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein performing forward planning comprises generating a dose distribution.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein performing forward planning further comprises generating a first beam profile with the first subset of beams to target a bulk region of a target, and wherein performing inverse planning comprises generating a second beam profile with the second subset of beams to target a boundary region of the target.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the first beam profile is an isocentric beam profile and wherein the second beam profile is a non-isocentric beam profile.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein performing forward planning further comprises generating a first beam profile with the first subset of beams to target a higher intensity region of a target, and wherein performing inverse planning comprises generating a second beam profile with the second subset of beams to target a lower intensity region of the target.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein performing inverse planning comprises generating a non-isocentric beam profile with the plurality of beams and wherein performing forward planning comprises choosing the first subset of beams from among the plurality of beams.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein performing inverse planning further comprises:
<claim-text>assigning weights to each of the first subset of beams; and</claim-text>
<claim-text>recalculating a resulting dose distribution from the first subset of beams.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein performing inverse planning further comprises changing the chosen first subset of beams.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the target has a regular shape.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the target has an irregular shape.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein inverse planning is performed using the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A treatment planning system, comprising a forward treatment planning module integrated with an inverse treatment planning module to develop a same treatment plan, wherein the forward planning module is configured to enable a user to select a direction and an intensity for a first subset of beams of a plurality of beams.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein
<claim-text>the forward treatment planning module is configured to develop a portion of the treatment plan using forward treatment planning techniques; and wherein</claim-text>
<claim-text>the inverse treatment planning module is coupled with the forward treatment planning module, the inverse treatment planning module is configured to develop another portion of the treatment plan.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the forward planning module is configured to enable the user to select the first subset of beams from among the plurality of beams, wherein each beam in the first subset of beams is based on user generated values representative of a radiation emission point, a target point and a radiation dose weight, and wherein the inverse planning module is configured to determine at least one of the radiation emission points, the target point and the radiation dose weight of a second subset of beams of the plurality of beams.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein enabling the user to select the direction comprises enabling the user to select a radiation emission point and an orientation for each of the plurality of radiation beams.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the forward planning module is configured to generating a dose distribution.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the forward treatment planning module is configured to generate a first beam profile with the first subset of beams to target a bulk region of a target, and wherein the inverse treatment planning module is configured to generate a second beam profile with the second subset of beams to target a boundary region of the target.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The treatment planning system of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the first beam profile is an isocentric beam profile and wherein the second beam profile is a non-isocentric beam profile.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the forward treatment planning module is configured to generate a first beam profile with the first subset of beams to target a higher intensity region of a target, and wherein the inverse treatment planning module is configured to generate a second bean profile with the second subset of beams to target a lower intensity region of the target.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the inverse treatment planning module is configured to generate a non-isocentric beam profile with the plurality of beams and wherein the forward treatment planning module is configured to enable choosing of the first subset of beams from among the plurality of beams.</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The treatment planning system of <claim-ref idref="CLM-00029">claim 29</claim-ref>, wherein the inverse treatment planning module is further configured to assign weights to each of the first subset of beams and recalculating a resulting dose distribution from the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. The treatment planing system of <claim-ref idref="CLM-00030">claim 30</claim-ref>, wherein the inverse treatment planning module is further configured to enable changing of the chosen first subset of beams.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The treatment planning system of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the target has a regular shape.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The treatment planning system of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein the target has an irregular shape.</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The treatment planning system of <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein inverse treatment planning module is configured to develop the treatment plan using the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. A treatment planning system, comprising:
<claim-text>means for developing a treatment plan using, at least in part, a forward planning module, wherein the forward planning module is configured to enable a user to select a direction and an intensity for each of a first subset of beams; and</claim-text>
<claim-text>means for developing the treatment plan using, at least in part, an inverse planning module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. An article of manufacture, comprising:
<claim-text>a machine-accessible medium including data that, when accessed by a machine, cause the machine to perform operations comprising:
<claim-text>developing, at least in part, a treatment plan based on user inputted forward treatment plan parameters comprising a radiation emission point, a target point and a radiation dose weight for a first subset of beams; and</claim-text>
<claim-text>developing, at least in part, the treatment plan using an inverse planning algorithm.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. The article of manufacture of <claim-ref idref="CLM-00036">claim 36</claim-ref>, wherein developing, at least in part, the treatment plan using the inverse planning algorithm comprises determining at least one of the radiation emission point, the target point and the radiation dose weight of a second subset of beams.</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The article of manufacture of <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein the second subset of beams includes one or more beams from the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. The article of manufacture of <claim-ref idref="CLM-00038">claim 38</claim-ref>, wherein the second subset of beams does not include any of the first subset of beams.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The article of manufacture of <claim-ref idref="CLM-00036">claim 36</claim-ref>, wherein developing, at least in part, the treatment plan based on user inputted forward treatment plan parameters comprises generating a dose distribution.</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. The article of manufacture of <claim-ref idref="CLM-00036">claim 36</claim-ref>, wherein developing, at least in part, the treatment plan based on user inputted forward treatment plan parameters comprises enabling the user to select the first subset of beams from among the plurality of beams, and wherein developing, at least in part, the treatment plan using the inverse planning algorithm comprises determining at least one of the radiation emission points, the target point and the radiation dose weight of a second subset of beams of the plurality of beams.</claim-text>
</claim>
</claims>
</us-patent-grant>
