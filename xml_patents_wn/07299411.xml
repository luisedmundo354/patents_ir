<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299411-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299411</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10675918</doc-number>
<date>20030929</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>164</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>715517</main-classification>
<further-classification>715513</further-classification>
<further-classification>715522</further-classification>
<further-classification>709247</further-classification>
</classification-national>
<invention-title id="d0e53">Providing a presentation engine adapted for use by a constrained resource client device</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6023714</doc-number>
<kind>A</kind>
<name>Hill et al.</name>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6226642</doc-number>
<kind>B1</kind>
<name>Beranek et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707 10</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6580438</doc-number>
<kind>B1</kind>
<name>Ichimura et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715732</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6589291</doc-number>
<kind>B1</kind>
<name>Boag et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6671853</doc-number>
<kind>B1</kind>
<name>Burkett et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7007105</doc-number>
<kind>B1</kind>
<name>Sullivan et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709247</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2001/0042081</doc-number>
<kind>A1</kind>
<name>Macfarlane et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2001/0044809</doc-number>
<kind>A1</kind>
<name>Parasine et al.</name>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>2003/0023628</doc-number>
<kind>A1</kind>
<name>Girardot et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2003/0028805</doc-number>
<kind>A1</kind>
<name>Lahteenmaki</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2003/0046317</doc-number>
<kind>A1</kind>
<name>Cseri et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2005/0027823</doc-number>
<kind>A1</kind>
<name>Rana</name>
<date>20050200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709219</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2005/0193372</doc-number>
<kind>A1</kind>
<name>Wu et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>717118</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00014">
<othercit>David Flanagan, “JavaScript: The Definitive Guide”, pp. 1-6, published Dec. 3, 2001.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
</references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>715517</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715522</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>7155011</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715513</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715511</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715760</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707101</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>700101</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709247</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>5</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60414250</doc-number>
<kind>00</kind>
<date>20020927</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040133855</doc-number>
<kind>A1</kind>
<date>20040708</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Blair</last-name>
<first-name>Robert Bruce</first-name>
<address>
<city>San Francisco</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Carson</last-name>
<first-name>Neil</first-name>
<address>
<city>Redwood City</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Etheredge</last-name>
<first-name>Robert</first-name>
<address>
<city>Orinda</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Flynn</last-name>
<first-name>David</first-name>
<address>
<city>Sandy</city>
<state>UT</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="005" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Guerra</last-name>
<first-name>Christopher John</first-name>
<address>
<city>Dorchester</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>CA</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Synnestvedt &amp; Lechner LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Liberate Technologies</orgname>
<role>02</role>
<address>
<city>San Carlos</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Huynh</last-name>
<first-name>Thu V.</first-name>
<department>2178</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A transcoder that converts text-based computer software instructions or code intended for use by a presentation engine into a binary code adapted for use by a constrained function presentation engine.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="127.42mm" wi="151.13mm" file="US07299411-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="229.19mm" wi="112.35mm" orientation="landscape" file="US07299411-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="195.41mm" wi="157.73mm" file="US07299411-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="229.45mm" wi="114.30mm" orientation="landscape" file="US07299411-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="188.72mm" wi="160.27mm" file="US07299411-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="182.54mm" wi="138.85mm" file="US07299411-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This patent application claims the benefit of U.S. Provisional Patent Application Ser. No. 60/414,250, filed on Sep. 27, 2002, for SYSTEM AND METHOD OF PROVIDING A PRESENTATION ENGINE ON A CLIENT DEVICE, which is incorporated herein by reference in its entirety.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">This invention relates generally to transcoding or adapting information for use by a constrained presentation engine in a client device operating in an information distribution system.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">Interactive television services are increasingly becoming available on many cable and satellite distribution networks. In such networks, television programming and other multimedia content is delivered to and processed by a set top box located at a subscriber's premises. In addition to conventional television programming, interactive services are also being made available to network subscribers. Such services may include the delivery of applications such as games, weather, email, tickers, TV chat and walled garden web type content.</p>
<p id="p-0007" num="0006">In some interactive networks, a presentation engine resides on a set top box that can be used by various interactive applications or services to provide a user interface and to provide a user with requested information. In some cases, a presentation engine handles HTML-based interactive content that is to be displayed on a TV set. A Presentation Engine (PE) is, in some embodiments, similar to a Web browser in that it provides support for creating and using the Web's standardized mark-up and scripting languages, such as Hypertext Mark-up Language (HTML) and ECMAScript. Unfortunately, the implementation of a presentation engine on a set top box requires a relatively large amount of computing resources, including memory and processing cycles.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">In accordance with one illustrative embodiment of the invention, a transcoder is provided that converts text-based computer software instructions or code (such as XML or CSS) intended for use by a conventional presentation engine into binary code adapted for use by a constrained feature presentation engine.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0009" num="0008">The teachings of the present invention can be readily understood by considering the following detailed description in conjunction with the accompanying drawings, in which:</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> depicts a high-level block diagram of an information distribution system suitable for use with the present invention;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> depicts a high-level block diagram of a controller suitable for use in the signal analysis system of <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> depicts a high-level functional diagram useful in understanding the present invention; and</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> depicts a flow diagram of a method according to an embodiment of the present invention; and</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 5</figref> depicts a flow diagram of a method according to an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0015" num="0014">To facilitate understanding, identical reference numerals have been used, where possible, to designate identical elements that are common to the figures.</p>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0016" num="0015">The following embodiments of the present invention will be described within the context of an information distribution system adapted to distribute information streams (e.g., video streams, audio streams and the like), data files (email, computer files and the like) and general control information, although those skilled in the art will recognize that the disclosed methods and structures are readily adaptable for broader application.</p>
<p id="p-0017" num="0016">In one embodiment, extensible mark-up language (XML) information streams and/or data files intended for use by one or more client devices are converted or transcoded by a near side server into feature or function reduced information streams and/or data files which are subsequently propagated to the client. The conversion/transcoding operates to shift a portion of the processing burden associated with the use of the information streams and/or data files from the client device(s) to the near side server, thereby enabling the use of so-called thin client devices (i.e., client devices such as set top boxes having a relatively limited memory or processing power). In general, the invention converts unresolved styles into resolved styles such that the processing burden placed upon the client device is lessened.</p>
<p id="p-0018" num="0017">This advantageously enables the use of a constrained resource or compact presentation engine in a set top box. Other advantages include, in various embodiments, the separation of application code from presentation code; higher performance than the current Java-drawing solutions; simplified application development; the ability to implement various applications such as electronic program guides (EPGs) and API-compatibility with existing platforms if desired. It is noted that the pre-processing and compression imparted to a file being processed by the server results in a smaller file such that a smaller amount of bandwidth is utilized in transmitting the pre-processed file to the client. Moreover, as discussed in more detail below, the pre-processed file as propagated to the client is a substantially error-free file which enables the use of a non-validating parser at the client.</p>
<p id="p-0019" num="0018">Moreover, writing content or applications for a digital television (DTV) platform using, for example, Java, can be a relatively difficult task for content developers, who tend to be non-programmers. The invention provides a straightforward way to enable the programming of a user interface (UI) or other presentation function using, for example, a subset of Cascading Style Sheets (CSS) and HTML. Thus, a high proportion of the functionality (i.e., that portion associated with the UI and other display functions) necessary to implement an application is provided to the content programmer such that the content programmer may primarily focus on the particular application.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> depicts a high-level block diagram of an information distribution system suitable for use with the present invention. A client computer or set top box (STB) <b>104</b> is connected to a presentation device <b>102</b> such as a television or other audiovisual display device or component(s). The connection between client computer <b>104</b> and presentation device <b>102</b> allows client computer <b>104</b> to tune and/or provide a presentation signal (e.g., a television signal) to presentation device <b>102</b>.</p>
<p id="p-0021" num="0020">Client <b>104</b> is also connected to a communication system <b>106</b>. In one embodiment, communication system <b>106</b> includes a telephone network and the Internet. In other embodiments, communication system <b>106</b> could include a network, the Internet without a telephone network, a dedicated communication system, a cable or satellite network, a single connection to another computer or any other means for communicating with another electronic entity. In one embodiment of the invention, the client comprises an STB such as the model DCT2000 manufactured by Motorola Corporation of Schaumburg, Ill. For purposes of this description, it will be assumed that the client or STB <b>104</b> comprises a device having a relatively limited amount of memory and/or processing power compared to a full featured (e.g., desktop) computer.</p>
<p id="p-0022" num="0021">The communication system <b>106</b> is also connected to a near side server <b>108</b>, such as a Unix or Windows server computer. In one embodiment, there are many near side servers connected to communication system <b>106</b>. The near side servers may be situated so that there is one near side server for a predetermined number of clients. This can be accomplished by locating at least one near side server in each of a given number of geographical locations. All the near side servers are connected to far side server <b>110</b>. There may be fewer far side servers (e.g., one far side server for an entire country or region of a country). Although the present invention is discussed with respect to one or more near side servers <b>108</b> and a single far side server <b>110</b>, the present invention can be implemented with more or fewer near side and far side servers</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 2</figref> depicts a high level block diagram of a controller topology suitable for use in the information distribution system of <figref idref="DRAWINGS">FIG. 1</figref>. Specifically, the controller <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> may be employed to implement relevant functions within the client <b>104</b>, near side server <b>108</b> and/or far side server <b>110</b>.</p>
<p id="p-0024" num="0023">The controller <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> comprises a processor <b>230</b> as well as memory <b>240</b> for storing various control programs and other programs <b>244</b> and data <b>246</b>. The memory <b>240</b> may also store an operating system <b>242</b> supporting the programs <b>244</b>.</p>
<p id="p-0025" num="0024">The processor <b>230</b> cooperates with conventional support circuitry such as power supplies, clock circuits, cache memory and the like as well as circuits that assist in executing the software routines stored in the memory <b>240</b>. As such, it is contemplated that some of the steps discussed herein as software processes may be implemented within hardware, for example as circuitry that cooperates with the processor <b>230</b> to perform various steps. The controller <b>200</b> also contains input/output (I/O) circuitry <b>210</b> that forms an interface between the various functional elements communicating with the controller <b>200</b>. Although the controller <b>200</b> is depicted as a general purpose computer that is programmed to perform various control functions in accordance with the present invention, the invention can be implemented in hardware as, for example, an application specific integrated circuit (ASIC) or field programmable gate array (FPGA). As such, the process steps described herein are intended to be broadly interpreted as being equivalently performed by software, hardware or a combination thereof.</p>
<p id="p-0026" num="0025">The controller <b>200</b> of <figref idref="DRAWINGS">FIG. 2</figref> may be operably coupled to a number of devices or systems. For example, the I/O circuit <b>210</b> in <figref idref="DRAWINGS">FIG. 2</figref> is depicted as interfacing to an input device (e.g., a keyboard, mouse, remote control and the like), a network (e.g., communications system <b>106</b>), a display device (e.g., presentation device <b>102</b> or a display device associated with a server) and, optionally, another server (in the case of controller <b>200</b> implementing server functions).</p>
<p id="p-0027" num="0026">In the case of controller <b>200</b> being used to implement a client or set top box, it will be assumed that the client or set top box comprises a device having a relatively limited amount of memory and processing power compared to a full featured desktop computer, laptop computer or server (though the client or STB may be implemented using a desktop computer, laptop computer, server or other general purpose or special purpose computer).</p>
<p id="p-0028" num="0027">In the case of the controller <b>200</b> being used to implement functions within the client <b>104</b>, the operating system <b>242</b> comprises, illustratively, the Mentor VRTX Real-Time Operating System (RTOS) and the programs <b>244</b> include a constrained function presentation engine, a Java application core, a Document Object Model (DOM) API and the like. Briefly, a Document Object Model parser reads an XML document and converts it into a tree of nodes that represent the full content of the document. Once a tree representation is created, a program can examine and manipulate the tree representation (and, therefore, the document).</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 3</figref> depicts a high-level functional diagram useful in understanding the present invention. Specifically, <figref idref="DRAWINGS">FIG. 3</figref> depicts a server function; namely, a resolver and translator <b>310</b> that processes a mark-up file such as XML, XHTML and the like, as well as any CSS style sheets or in-line styles <b>312</b> to produce a binary file <b>320</b>. The mark-up file <b>314</b> is processed to identify all presentation codes such as styles which, along with the in-line styles and CSS style sheet styles are resolved to a subset of style tags. The file and resolved style information are then compressed <b>316</b> into a binary data file <b>320</b> which is provided to a client presentation engine <b>330</b>. The client presentation engine utilizes a Java application core <b>332</b>, which works in conjunction with a DOM API <b>334</b> to process an in memory tree structure <b>336</b> provided by the compressed presentation-related code within the binary data file <b>320</b> such that layout and drawing code <b>338</b> may render and otherwise present application imagery on a presentation device <b>102</b>.</p>
<p id="p-0030" num="0029">The server function (i.e., the resolver, translator and compression function) may be implemented on a near side server <b>108</b> to produce a binary data file <b>320</b> for propagation via the network <b>106</b> to the client presentation engine <b>330</b>, which is executed by the client or STB <b>104</b>. These functions will be discussed in more detail below with respect to the figures and the tables included herein. The functions may be implemented as a method by one or more processors. The functions may be embodied as software instructions within a signal bearing medium or a computer product.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 4</figref> depicts a flow diagram of a method according to an embodiment of the present invention. Specifically, the method <b>400</b> of <figref idref="DRAWINGS">FIG. 4</figref> describes processing (preprocessing with respect to the client) functions occurring within, illustratively, the near side server <b>108</b> of <figref idref="DRAWINGS">FIG. 1</figref> in which XML, HTML, XHTML or other application code is processed to provide a compressed binary file adapted for use with a presentation engine of a resource-constrained client (i.e., a compact or constrained function presentation engine). The compressed binary file provided to a client after processing by the near or far side server comprises an error free syntactically correct binary code representation of the processed application code. As such, the compact presentation engine and, generally, the code parser and other functions operating within the client may avoid expending memory and computational resources on error correction, error detection and other processes. Thus, the memory and computational burden imposed upon the client is reduced by preprocessing application and associated presentation code, compressing the resulting preprocessed code and insuring that the compressed and preprocessed code provided to the client is syntactically correct such that error processing overhead may be avoided.</p>
<p id="p-0032" num="0031">The method <b>400</b> operates to perform various processing functions normally performed by a client device such that the client device may substantially immediately display visual elements or process visual elements in a manner avoiding complexity normally required of a full featured presentation engine. In general, the method <b>400</b> of <figref idref="DRAWINGS">FIG. 4</figref> removes code associated with presentation functions not invoked by the application, as well as streamlines invoked presentation functions by replacing identified unresolved style elements (which may be members of a large class of style elements) with a relatively small number of resolved style elements, such that a subset of the nominal class of style elements is used. In this manner, a reduced function presentation engine or compact presentation engine using only the reduced subset of resolved style elements may display the imagery normally associated with the full set of unresolved style elements. It is noted that style functions not related to the necessary resolved styles are optionally deleted from the presentation code to further reduce the size of the code.</p>
<p id="p-0033" num="0032">The method is entered at step <b>410</b>, when the server (e.g., the near-side server <b>108</b>) receives an HTML-compatible mark-up file, any CSS style sheets, any in-line styles and the like. Generally, at step <b>410</b>, the server receives mark-up code such as XML code or XHTML code representing an application intended for execution on a client device. The application includes application code and presentation code, where the presentation code includes various style elements used to provide a visually rich presentation of the application and its related imagery.</p>
<p id="p-0034" num="0033">At step <b>420</b>, the style elements within the presentation code and, optionally, the application code are identified. At step <b>430</b>, the input style information is processed to provide a subset of style information adapted for use by a constrained function or a compact presentation engine. That is, at step <b>430</b> the method operates to perform at least one of the functions of simplifying or reducing the style information such as reducing the number of style properties, deleting style rules, simplifying style dependencies and compressing common resolved styles. It is noted that compressing common resolved styles may be performed as an additional step in said method after, for example, all the style information is resolved.</p>
<p id="p-0035" num="0034">At step <b>440</b>, the presentation code and, optionally, the application code including resolved style elements is compressed to form a binary file. At step <b>450</b>, the binary file is transmitted or propagated toward the client via, for example, the network <b>106</b>. As previously noted, the binary file comprises compressed application code and presentation code in which style elements have been dramatically simplified by utilizing a resolved subset of the style tags normally available. In addition, the binary file is generated in a manner avoiding syntactical errors such that the error processing burden on the client is reduced or eliminated. That is, a validation step is performed to ensure that errors are substantially eliminated in the binary file such that a non-validating parser may be used by the client.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 5</figref> depicts a flow diagram of a method according to an embodiment of the present invention. Specifically, the method <b>500</b> of <figref idref="DRAWINGS">FIG. 5</figref> describes processing functions occurring within, illustratively, the client <b>104</b> of <figref idref="DRAWINGS">FIG. 1</figref> in which the client processes a binary file such as, for example, the binary file discussed above with respect to <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0037" num="0036">The method is entered at step <b>510</b>, when the client receives a compressed binary file from, for example, the near side server <b>108</b>. At step <b>520</b>, a local Document Object Model (DOM) tree of nodes is created in response to a received binary file. For example, in one embodiment of the invention, a non-validating parser is used to process the received binary file which, as discussed above, comprises a substantially error-free file. The node information is extracted from the binary file and used to generate the tree of nodes representation of the presentation code. It is noted that the style information is resolved so that each node contains all of the information necessary to display itself (i.e., height, width, X position, Y position, font, color and the like). New styles have been created which are complete and resolved styles which are not necessarily related to the original styles. The nodes using the new style information have references to the new style. The information associated with each node includes source information defining where each of the properties associated with the node come from (i.e., whether from an inherited style or manually set on just that node), and if the properties are from an inherited style where that style comes from (i.e., a new resolved style or an existing style such as a style already stored on the client).</p>
<p id="p-0038" num="0037">At step <b>530</b>, the method waits for user interaction and, at step <b>540</b>, the node tree is modified in response to received user interaction. Referring to box <b>545</b>, the user interaction may comprise adding a node, deleting a node, changing the properties of a node, adding to the properties of a node, deleting properties from the node, and propagating changes in node properties to the sub-nodes associated with the node being manipulated.</p>
<p id="p-0039" num="0038">In one embodiment of the invention, multiple style sheets on a server are referenced by one XML file on the server. In this embodiment, at least one of multiple stream resolutions on a set top box and multiple color pallets on the set top box are supported. The client code (e.g., JAVA or other code executed within the client) queries the set top box to determine the capabilities of the STB or other parameters associated with the STB to determine thereby which of the multiple style sheets are appropriate for the XML file to request from the server. The server then resolves the proper combination of XML/CSS files and delivers the preprocessed XML/CSS files within the context of a compressed binary file including presentation information optimized for the particular set top box. Thus, in response to a control signal, stored indicium or other representation of a capability level of the set top box or client, the server adapts the style resolving process to support the capability level of the set top box.</p>
<p id="p-0040" num="0039">In one embodiment of the invention, the server does not need to have a complete font metric table, since the client determines how fonts are actually laid out in a requested font which is specified to each set top box. Advantageously, an absolute draw list providing the exact XY coordinate information of fonts is not created. Thus, a source of errors is eliminated and the creation of content is greatly facilitated. Similarly, the server does not need to know the display device resolution nor the actual size of images that will be propagated to the client, since such processing is performed on the client.</p>
<p id="p-0041" num="0040">In one embodiment, the client is able to display the screen rapidly since the client keeps information pertaining to the effects of changes to any portion of the screen, including such information as a minimum amount or area required to repaint the screen portion. Thus, since the styles have been pre-resolved by the server, the repainting process invoked at the client is much faster for each node, since the information to accomplish this task is readily available to the client. Additionally, rectangles will be properly clipped by the parent and/or the screen which makes the processing at the client even faster. The client tracks which objects are displayed on top of other objects (i.e., at a higher screen layer or display layer), as well as which objects contain transparent bits so that a minimum amount of objects are repainted by the client.</p>
<p id="p-0042" num="0041">Several examples of systems, data structures and general applicability of the invention will now be discussed with respect to server functionality and client functionality. In general, text-based files or streams including application and presentation code are processed by a server to produce a compressed binary code for use by a client device or set top box, as discussed above. The following examples will provide additional detail of different embodiments of the invention in which some or all of the listed tags and style properties may be used in different embodiments. It will be appreciated by those skilled in the art that more or fewer tags and other structures may be used without diverging from the fundamental aspects of the invention, and that such use of more or fewer style tags, style properties, functions and the like are contemplated by the inventors.</p>
<p id="p-0043" num="0042">The application files or streams processed according to an embodiment of the present invention comprise a combination of tag-based mark-up and style information, either in-lined (i.e., within the application code or presentation code) or in separate style sheets. In one embodiment, the formatting of these input files are such that they are compatible with a standard HTML/CSS system.</p>
<p id="p-0044" num="0043">The input files are processed by a server to produce a binary-encoded file including all the necessary application and presentation information using a small subset of the style tags normally available. In one embodiment, the input file is preprocessed at the server to transform the file into a format suitable for directly reading into client memory for display and manipulation. The input-side tool (i.e., the transcoder at the server) reads in the relevant mark-up file together with any stylesheets it references, resolves all of the styles, and then emits a serialized binary representation of the resulting tree structure to a file that can be loaded by the presentation engine. The data is optionally subjected to version control processing so that new style properties can be added to the system at a later date without trouble.</p>
<p id="p-0045" num="0044">In one embodiment, the core style tags used by the transcoder are presented below as Table 1:</p>
<p id="p-0046" num="0045">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="35pt" align="left"/>
<colspec colname="1" colwidth="70pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Tag name</entry>
<entry>Function</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>html</entry>
<entry>Main page container</entry>
</row>
<row>
<entry/>
<entry>body</entry>
<entry>Main page block</entry>
</row>
<row>
<entry/>
<entry>div</entry>
<entry>Styled element</entry>
</row>
<row>
<entry/>
<entry>span</entry>
<entry>Styled text-level element</entry>
</row>
<row>
<entry/>
<entry>img</entry>
<entry>Styled image</entry>
</row>
<row>
<entry/>
<entry>br</entry>
<entry>Line break</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0047" num="0046">These tags together are sufficient to allow specification of a wide variety of content. Effectively all presentational information would come from the styles of these elements. Style specification (style=attribute) would be mandatory for every element that doesn't want the simple, default style. An example of style parameters that could be supported are shown below in Table 2.</p>
<p id="p-0048" num="0047">In various embodiments, support for other HTML-like inputs is provided. For example, a “bold” tag may be provided which is translated by the compact presentation engine as a styled span.</p>
<p id="p-0049" num="0048">A position example will now be described. Assume that a content developer wanted to use the presentation engine to put an image somewhere towards the top left of the screen and a container of text with a <b>3</b>D red border further down, they could do so with a file of the form:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0049">&lt;html&gt;&lt;body&gt;</li>
        <li id="ul0002-0002" num="0050">&lt;img src=“myimage.vq” style=”position:absolute;</li>
        <li id="ul0002-0003" num="0051">top: 100px; left: 100px;”/&gt;</li>
        <li id="ul0002-0004" num="0052">&lt;div style=”border:2px outset red; position:absolute;</li>
        <li id="ul0002-0005" num="0053">top: 220px; left: 100px; width: 400px; height: 30px;”&gt;
        <ul id="ul0003" list-style="none">
            <li id="ul0003-0001" num="0054">This is some text!</li>
        </ul>
        </li>
        <li id="ul0002-0006" num="0055">&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0050" num="0056">This file is translated into a document tree containing an HTML element, underneath it a BODY element, underneath it an IMG and DIV element, and underneath the DIV element a text element. The HTML, BODY and DIV elements all map to visible elements or objects on the screen, and the text is flowed inside the innermost DIV element by the presentation engine.</p>
<p id="p-0051" num="0057">The set of tags above looks deceptively simple. However, using the available styles for these elements, one can create a very rich set of graphical effects to allow fully automatic drawing and re-layout of complex screen presentations. An exemplary set of supported properties is shown below in Table 2:</p>
<p id="p-0052" num="0058">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0" pgwide="1">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="175pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="2" rowsep="1">TABLE 2</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>CSS style property</entry>
<entry>What the property allows</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>display</entry>
<entry>Settable to few specific values., either block for div, in-line</entry>
</row>
<row>
<entry/>
<entry>for span, or “none” to turn off sections of the document.</entry>
</row>
<row>
<entry>Position</entry>
<entry>For images and (DIV) elements, declaring this “absolute”</entry>
</row>
<row>
<entry/>
<entry>lifts block out of flow and instead places them at a</entry>
</row>
<row>
<entry/>
<entry>specified location on the screen relative to their parent</entry>
</row>
<row>
<entry/>
<entry>using (top, left, width, height) below.</entry>
</row>
<row>
<entry>Top, left, width, height</entry>
<entry>Location of element on screen, nested within parent.</entry>
</row>
<row>
<entry>Border (top, bottom, left,</entry>
<entry>Drawing of solid, inset, outset, beveled, dashed, etc.</entry>
</row>
<row>
<entry>right, color, width, style)</entry>
<entry>borders for the outside edges of diplayable objectss.</entry>
</row>
<row>
<entry>Border-radius</entry>
<entry>Radius of edges on borders to supported rounded</entry>
</row>
<row>
<entry/>
<entry>rectangles or “wieners/capsules/lozenges”</entry>
</row>
<row>
<entry>Background</entry>
<entry>Background image for an element</entry>
</row>
<row>
<entry>Background-repeat</entry>
<entry>Specifies how the background image of an element is tiled.</entry>
</row>
<row>
<entry>Background-color</entry>
<entry>Solid color background for an element</entry>
</row>
<row>
<entry>Background-gradient</entry>
<entry>Sets a gradient as the background for an element</entry>
</row>
<row>
<entry>Font-family, font-size, font-</entry>
<entry>Specification of the font used to lay out and draw child</entry>
</row>
<row>
<entry>style, font-weight, font-stretch</entry>
<entry>text.</entry>
</row>
<row>
<entry>Margin</entry>
<entry>Specification of an element's margins (space around the</entry>
</row>
<row>
<entry/>
<entry>outside edge of the border)</entry>
</row>
<row>
<entry>Padding</entry>
<entry>Specification of box padding (space between inside of</entry>
</row>
<row>
<entry/>
<entry>border and content)</entry>
</row>
<row>
<entry>Text-align</entry>
<entry>Controls left/right/center/justification of text.</entry>
</row>
<row>
<entry>Vertical-align</entry>
<entry>Controls vertical alignment of objects within the line.</entry>
</row>
<row>
<entry>Color</entry>
<entry>Specifies text colour</entry>
</row>
<row>
<entry>Text-shadow</entry>
<entry>Specifies style of a background shadow on text.</entry>
</row>
<row>
<entry>Text-transform</entry>
<entry>Allows forced upper, lower or capitalized casing of text.</entry>
</row>
<row>
<entry>Text-decoration</entry>
<entry>Adds underlines, overlines or lines through text.</entry>
</row>
<row>
<entry>Visibility</entry>
<entry>Allows pieces of the document to be switched on or off</entry>
</row>
<row>
<entry>z-index</entry>
<entry>Controls layering for displayable objects at the same level</entry>
</row>
<row>
<entry>Focusable</entry>
<entry>Defines whether or not a piece of text or block level</entry>
</row>
<row>
<entry/>
<entry>element is focusable</entry>
</row>
<row>
<entry>Line-height</entry>
<entry>Allows forcing tall lines for extra line spacing</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
These together allow specification of the vast majority of the requirements for typical interactive TV and enhanced TV applications. Those which aren't fully allowed can be implemented at the code level by drawing underneath or on top of presented content.
</p>
<p id="p-0053" num="0059">In yet another example, a TV Guide EPG-style “wiener” (i.e., a relatively thin, horizontally disposed, rounded corner graphical object) with centered text may be styled as an object as follows. In this manner, the whole “wiener,” together with its text content, may be rendered automatically by the client platform, moved around, have its contents or presentation altered and the like:</p>
<p id="p-0054" num="0060">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Div {</entry>
</row>
<row>
<entry> Position: absolute;</entry>
</row>
<row>
<entry> Width: 200;</entry>
</row>
<row>
<entry> Height: 20;</entry>
</row>
<row>
<entry> Border: 2px solid red;</entry>
</row>
<row>
<entry> Border-radius: 10px;</entry>
</row>
<row>
<entry> Text-align: center;</entry>
</row>
<row>
<entry> Background-gradient: “0,0:rgb(190, 10, 10); 0,20: rgb(220, 10, 10)”;</entry>
</row>
<row>
<entry>}</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Document and Display Manipulation
</p>
<p id="p-0055" num="0061">An application running on the system taking advantage of the compact presentation engine described herein derives from a base class with access to a new set of APIs to load data files from the carousel. As mentioned above, the data files would contain an initial styled document tree that can be loaded into memory, easily cached (since it will be very small, typically of the order of hundreds of bytes) and manipulated by a set of Java APIs. The Java APIs allow manipulation of both the document structure (the elements that make up the tree) as well as the presentation of the elements (the styles, as listed above). Changing the document structure may mean removing, inserting or re-parenting elements; and changing the presentation could mean animating elements, altering their border, colour, text or image content. These two sets of APIs together allow creation of interesting dynamic content.</p>
<p id="p-0056" num="0062">Exemplary tree manipulation APIs are as follows, currently expressed in IDL (Interface Definition Language) form:</p>
<p id="p-0057" num="0063">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>interface Window extends lbrt.applet.Window</entry>
</row>
<row>
<entry>{</entry>
</row>
<row>
<entry>// Used to load document into window</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>permanent attribute untyped location;</entry>
</row>
<row>
<entry/>
<entry>jstatic Window getWindowForApplet(in Applet applet);</entry>
</row>
<row>
<entry/>
<entry>permanent readonly attribute Document document;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<tbody valign="top">
<row>
<entry>}</entry>
</row>
<row>
<entry>interface Node {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="112pt" align="left"/>
<colspec colname="2" colwidth="91pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>readonly attribute unsigned short</entry>
<entry>nodeType;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>readonly attribute Node</entry>
<entry>parentNode;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute Node</entry>
<entry>firstChild;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute Node</entry>
<entry>lastChild;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute Node</entry>
<entry>previousSibling;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute Node</entry>
<entry>nextSibling;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="105pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>readonly attribute Document</entry>
<entry>ownerDocument;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Node insertBefore(in Node newChild, in Node refChild)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>raises(DOMException);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Node replaceChild(in Node newChild, in Node oldChild)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>raises(DOMException);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Node removeChild(in Node oldChild) raises(DOMException);</entry>
</row>
<row>
<entry/>
<entry>Node appendChild(in Node newChild) raises(DOMException);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="161pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>boolean</entry>
<entry>hasChildNodes( );</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<tbody valign="top">
<row>
<entry>}</entry>
</row>
<row>
<entry>interface Document : Node {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Element createElement(in DOMString tagName) raises</entry>
</row>
<row>
<entry/>
<entry>(DOMException);</entry>
</row>
<row>
<entry/>
<entry>Text createTextNode(in DOMString data);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<tbody valign="top">
<row>
<entry>}</entry>
</row>
<row>
<entry>interface HTMLDocument: Document {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Element getElementById(in DOMString elementId);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<tbody valign="top">
<row>
<entry>}</entry>
</row>
<row>
<entry>interface Element : Node {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="105pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>readonly attribute DOMString</entry>
<entry>tagName;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>readonly attribute CSSStyleDeclaration style;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="84pt" align="left"/>
<colspec colname="2" colwidth="119pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>readonly attribute long</entry>
<entry>offsetTop;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute long</entry>
<entry>offsetLeft;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute long</entry>
<entry>offsetWidth;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute long</entry>
<entry>offsetHeight;</entry>
</row>
<row>
<entry/>
<entry>readonly attribute long</entry>
<entry>offsetNode;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>DOMString getAttribute(in DOMString name);</entry>
</row>
<row>
<entry/>
<entry>void setAttribute(in DOMString name, in DOMString value)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>raises(DOMException);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>void removeAttribute(in DOMString name)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>raises(DOMException);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="105pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onblur;</entry>
</row>
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onfocus;</entry>
</row>
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onmousedown;</entry>
</row>
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onmouseup;</entry>
</row>
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onmouseover;</entry>
</row>
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onmouseout;</entry>
</row>
<row>
<entry/>
<entry>noenumerate attribute handler</entry>
<entry>onclick;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="left"/>
<tbody valign="top">
<row>
<entry>}</entry>
</row>
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0058" num="0064">The functions above provide for substantially full manipulation of the document tree—insertion and removal of elements, text, attachment of handlers (see below), query of laid-out-positions and basic tree traversal/element search. For modifying the presentation of the document, rather than its structure, the styles of individual elements would need to be changed. The object that facilitates this is the CSSStyleDeclaration, which is as follows:</p>
<p id="p-0059" num="0065">
<tables id="TABLE-US-00005" num="00005">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>interface CSSStyleDeclaration {</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>void</entry>
<entry>setTrajectory(in DOMString propertyName,</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="70pt" align="left"/>
<colspec colname="1" colwidth="147pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>in DOMString initial,</entry>
</row>
<row>
<entry/>
<entry>in DOMString values);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>void</entry>
<entry>clearTrajectory(in DOMString propertyName);</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>attribute DOMString background;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundAttachment;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundColor;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundImage;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundPosition;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundPositionX;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundPositionY;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString backgroundRepeat;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString border;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString borderBackground;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString borderBottom;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString borderBottomColor;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString borderBottomStyle;</entry>
</row>
<row>
<entry/>
<entry>attribute DOMString borderBottomWidth;</entry>
</row>
<row>
<entry/>
<entry>...etc... For each of the declared style properties above.</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0060" num="0066">The above consists of a large, exemplary number of set/get methods that provide for getting or setting each individual CSS style property specifiable (see table of “CSS Style Properties” above). The setTrajectory/getTrajectory methods allow automated animation of individual properties by the platform, with either point-to-point, linear or quadratic interpolation.</p>
<p id="h-0006" num="0000">Handlers</p>
<p id="p-0061" num="0067">In one embodiment, areas of the screen (or elements or individual words of text or images) are focusable, and focus management can be optionally managed by the underlying presentation engine. In such an embodiment, these areas of the screen need a way to notify the Java-application when the highlight moves on or-off areas of the screen. Similarly, the application needs to be able to capture key requests, and ideally needs to be able to draw custom graphics in addition to the primitives supported by the presentation engine (in case, for example, it wants to draw odd arcs, angled lines and other shapes that the engine does not natively support). To do this, per-element handlers can be supported, as follows:</p>
<p id="p-0062" num="0068">
<tables id="TABLE-US-00006" num="00006">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="168pt" align="left"/>
<thead>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Handler name</entry>
<entry>Explanation</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry>Onclick</entry>
<entry>Invoked when a highlightable area is selected by pressing</entry>
</row>
<row>
<entry/>
<entry>OK on the remote</entry>
</row>
<row>
<entry>Onmouseover</entry>
<entry>Invoked when focus moves over a given area</entry>
</row>
<row>
<entry>Onmouseout</entry>
<entry>Invoked when focus leaves a given area</entry>
</row>
<row>
<entry>Onredraw</entry>
<entry>Invoked before the presentation engine's content is drawn</entry>
</row>
<row>
<entry/>
<entry>into the displayable object</entry>
</row>
<row>
<entry>Onnavigate</entry>
<entry>Invoked when the decision is being made to choose the</entry>
</row>
<row>
<entry/>
<entry>next focusable target on screen, to block movement or</entry>
</row>
<row>
<entry/>
<entry>alter behaviour.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Classes that want to handle events from the system can implement a callback on individual elements. For example, Element.setOnClick(mylistenerclass) would set up a handler on an element such that, when the OK button is selected on the remote control, the relevant function (mylistenerclass) would be invoked. A similar handler can be set up that takes a graphics context as an argument to allow individual elements' contents to be drawn by Java code.
<br/>
Re-Layout and Output
</p>
<p id="p-0063" num="0069">The layout engine supports incremental re-layout of the document. Each element in the document tree optionally contains a bitfield that indicates, if the element is “dirty” (i.e. if attributes of the element have been modified such that the element needs to be redrawn), what work is required to clean it up (i.e. what to draw). For example, for changes that require little work to changes that require a lot of work, valid actions may be to just re-expose the element (e.g., a color change), reposition the element (for a change to on-screen location), or re-layout the contents of the element (for a change to document-text or in-line image). Another bit is optionally used to leave a bit trail to the containing document object so that, when time comes to re-expose and re-layout, the dirty elements can be found easily. Then, the layout engine can perform the required changes and put together a “dirty” region for the screen as well as a list of move commands to be executed.</p>
<p id="p-0064" num="0070">Rendering of the document tree uses a region system. This is one important aspect of making an efficient display system. The region holds a list of rectangles which is guaranteed to be the minimum number of rectangles required to express (optionally disjoint) areas of the screen. Different regions can be translated, unioned, intersected etc. in order to aid implementing the display code. All drawing to the screen is clipped against regions.</p>
<p id="p-0065" num="0071">Exposure of the node tree optionally uses a hybrid back-to-front-to-back approach to factor out unnecessary redraws of underlying elements while still correctly handling transparency. The code paths to perform this work will be significantly simpler since, due to our pre-processing steps, we neither have to take into account nodes that aren't clipped by their parent (a feature of the full, unresolved HTML/CSS language) nor scrollable areas.</p>
<p id="h-0007" num="0000">Client Embodiment</p>
<p id="p-0066" num="0072">In one embodiment, the constrained function or thin client presentation engine uses a defined framework which is divided into two components. The first half is a simple input side, which consists of a bare-bones canonical non-validating XML parser. The second half is a combined layout/render engine, using techniques providing for high performance drawing, clipping and page layout functions.</p>
<p id="p-0067" num="0073">For creating content user interfaces, a forward HTML/CSS-compatible XML DTD (Document Type Definition) is used to specify a tiny subset of tags and attributes that will be read in to create a document structure. This parser may be exported directly to applications so that the applications may make use of the parser functionality. This function is described above with respect to <figref idref="DRAWINGS">FIGS. 2–4</figref>.</p>
<p id="p-0068" num="0074">The second stage is a tiny layout engine, which allows flowing lines and images as well as manipulation of X/Y positioned content. This engine takes the document structure and emits a set of display objects on the screen together with positional information for text, images, borders and other graphical elements contained within the display objects or nodes. In this environment, the actual memory occupied by the parsed document and corresponding display objects may well be the same or different. It is noted that imagery to be displayed is represented by a signal propagated toward the display device.</p>
<p id="p-0069" num="0075">The final stage is the drawing environment, which provides high performance rendering of the node tree, far exceeding that currently possible from Java. The node tree is created by the internal layout system, but each node in the tree can also allow Java handlers to be registered allowing Java to draw within them too.</p>
<p id="p-0070" num="0076">The document structure, and thus nodes, can be dynamically updated and altered using forward-compatible DOM APIs. This allows alteration of any part of the document structure, as well as addition and removal of new components.</p>
<p id="p-0071" num="0077">The input side of the client system uses an XML parser. In one embodiment, the parser uses the SAX API. In one embodiment, the parser uses little or no error correction. Such a parser requires around 1 KB of memory and parses only correct XML, offering extremely high performance. The parser consists primarily of calls to a “sink” to store off tags, attribute/value tables and text.</p>
<p id="p-0072" num="0078">The API of the parser is, optionally, exported to C code (for use by a document presentation engine) and Java, so that other applications can use it to decode data feeds in standard formats. In one embodiment, a standard client is provided where the parser is exposed to JavaScript also (via IDL).</p>
<p id="h-0008" num="0000">Document Manipulation</p>
<p id="p-0073" num="0079">The functions discussed above allow the document to be read from an XML input, laid out and presented. However, in a dynamic system embodiment, a subset of DOM methods is supported for altering the document structure such that changes appear on the screen accordingly. The related methods allow addition and removal of elements in the document tree, replacement of text and images, and controlling the presentational aspects of existing elements by manipulating style properties—the on-screen position, size, borders, z-index, fonts, colours and all other things that control how things look. Optionally implemented is a “setTrajectory” API which allows automated animation of any of these properties (along point-to-point, linear or curved paths) to achieve efficient animation of position, colours or any other parameters without the Java interpreter needing to be invoked on each frame.</p>
<p id="p-0074" num="0080">A node or object framework is also provided, which logically sits alongside AWT (the Java Abstract Window Toolkit), an alternative the content developer may use if she/he makes use of the presentation engine.</p>
<p id="p-0075" num="0081">The node or object framework supports, for example, a tree of nested rectangular, optionally transparent nodes, each of which conforms to the CSS box model (this means each node has a margin area around the outside, optional borders, and then optional empty padding space between the borders and content of the node or display object). Each node will have a specified background color or background image or, if no background is specified, will be assumed to be transparent. Each node clips its child nodes and its content.</p>
<p id="p-0076" num="0082">The node or displayable object code optionally uses a hybrid exclusion-back-to-front drawing model. This guarantees that, for any required exposure, the minimum amount of actual drawing will be performed, but containers that are transparent (in whole or in part) will still be drawn correctly. It also makes use of a simplified form of the existing region code for minimizing redraw of disjoint areas of the screen.</p>
<p id="p-0077" num="0083">The code optionally makes use of an accelerated move feature which is intelligent enough to avoid large repaints when nodes on the screen move, instead opting for a blit-partial-repaint strategy, even when things are on top of the node. This approach allows maximum efficiency on-screen animation by avoiding unnecessary drawing when moving objects, but still correctly copes with transparency.</p>
<p id="p-0078" num="0084">While the foregoing is directed to certain embodiments of the present invention, these embodiments are meant to be illustrative, not limiting. Other and further embodiments of the invention may be devised without departing from the basic scope thereof, and the scope thereof is determined by the claims that follow.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>We claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of propagating presentation code to a client said client using a constrained function presentation engine, said method comprising:
<claim-text>identifying style information within said presentation code at a server;</claim-text>
<claim-text>resolving, at said server said style information to a subset of said style information;</claim-text>
<claim-text>compressing, at the server said presentation code including said subset of said style information to provide a binary-encoded file for use by said constrained function presentation engine, said subset of said style information represented within said binary-encoded file;</claim-text>
<claim-text>validating said binary-encoded file to provide an error-free binary-encoded file at the server;</claim-text>
<claim-text>propagating said error-free binary-encoded file toward said client;</claim-text>
<claim-text>translating said error-free binary-encoded file into a document tree containing a plurality of nodes at said client, wherein said translating includes non-validating parsing to avoid expending memory and computational resources on error correction and error detection at said client, wherein each one of said plurality of nodes represents said subset of said style information, wherein each one of said plurality of nodes comprises at least one user manipulable property; and</claim-text>
<claim-text>modifying at least one of said plurality of nodes in response to a received user interaction with the document tree at said client;</claim-text>
<claim-text>wherein said resolving said style information comprises two or more of: reducing the number of style properties, deleting style rules, and simplifying style dependencies in said style information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said presentation code is substantially compliant with an HTML/CSS system.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein said presentation code comprises at least one of in-line XML styles and CSS style sheets.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising adapting the style resolving process in response to an indicium of capability of a client.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein said indicium comprises a control signal received from the client.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said presentation code comprises a markup file and associated CSS style sheets.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising compressing common resolved styles.</claim-text>
</claim>
</claims>
</us-patent-grant>
