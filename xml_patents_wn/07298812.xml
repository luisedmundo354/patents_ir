<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298812-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298812</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11278287</doc-number>
<date>20060331</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>N</subclass>
<main-group>23</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>378  5</main-classification>
<further-classification>378  4</further-classification>
</classification-national>
<invention-title id="d0e43">Image-based material decomposition</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5661774</doc-number>
<kind>A</kind>
<name>Gordon et al.</name>
<date>19970800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6904118</doc-number>
<kind>B2</kind>
<name>Wu et al.</name>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>378  5</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2004/0102688</doc-number>
<kind>A1</kind>
<name>Walker et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600407</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2004/0136491</doc-number>
<kind>A1</kind>
<name>Iatrou et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>378  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0264627</doc-number>
<kind>A1</kind>
<name>Besson</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0264628</doc-number>
<kind>A1</kind>
<name>Besson</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>378  5</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0067461</doc-number>
<kind>A1</kind>
<name>Yin et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>378  5</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>26</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>378  4</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378  5</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 16</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 15</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378 19</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378901</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>378  8</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382131</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600425</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070237288</doc-number>
<kind>A1</kind>
<date>20071011</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Tkaczyk</last-name>
<first-name>J. Eric</first-name>
<address>
<city>Delanson</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Leue</last-name>
<first-name>William Macomber</first-name>
<address>
<city>Albany</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Garms</last-name>
<first-name>Walter Irving</first-name>
<address>
<city>Berkeley</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bendahan</last-name>
<first-name>Joseph</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="005" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Walter</last-name>
<first-name>Deborah</first-name>
<address>
<city>Burnt Hills</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="006" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Pourjavid-Granfors</last-name>
<first-name>Sussan</first-name>
<address>
<city>Sunnyvale</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="007" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Wu</last-name>
<first-name>Xiaoye</first-name>
<address>
<city>Rexford</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="008" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Edic</last-name>
<first-name>Peter Michael</first-name>
<address>
<city>Albany</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="009" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Landolfi</last-name>
<first-name>Pierfrancesco</first-name>
<address>
<city>Newark</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Powell, III</last-name>
<first-name>William E.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Brueske</last-name>
<first-name>Curtis B.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>General Electric Company</orgname>
<role>02</role>
<address>
<city>Niskayuna</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Song</last-name>
<first-name>Hoon</first-name>
<department>2882</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A CT scanner acquires CT images at different energy levels and registers those images to provide a composite image that is substantially free of beam hardening artifacts and conspicuously provides atomic information of that imaged.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="190.75mm" wi="97.71mm" file="US07298812-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="229.19mm" wi="184.32mm" file="US07298812-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="210.40mm" wi="103.38mm" file="US07298812-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="133.01mm" wi="117.77mm" file="US07298812-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="223.77mm" wi="178.56mm" orientation="landscape" file="US07298812-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="197.02mm" wi="174.16mm" file="US07298812-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="237.49mm" wi="175.09mm" file="US07298812-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates generally to diagnostic imaging and, more particularly, to image-based material decomposition with beam hardening correction.</p>
<p id="p-0003" num="0002">Helical or axial computed tomography (CT) is an effective imaging modality that presents 2D or volumetric images representative of the x-ray attenuation density of the interior of an object or subject to be imaged. The terms “object” and “subject” are interchangeable and correspond to anything capable of being imaged. The images are reconstructed from sinogram data acquired by scanning the object with an axial or helical protocol. Notwithstanding the numerous advancements in CT imaging, without a priori chemical composition information about the object, the attenuation of x-rays by the object cannot be represented as a line integral across the object thickness. Rather, the attenuation results from a convolution across a broad spectrum of x-ray photon energies delivered by the x-ray source. The lack of a line integral representation results in “beam hardening error” in the sinogram data. Subsequent reconstruction of the sinogram results in beam hardening artifacts in the image.</p>
<p id="p-0004" num="0003">In addition to the standard attenuation (i.e. Hounsfield unit) images, CT can provide an estimate of atomic number of the interior region of the scanned object. Equivalently, the composition of the interior region can be represented as an equivalent mixture of two basis materials or as a combination of Compton and Photoelectric attenuation parts. Hencefore, reference to atomic number is to any of the equivalent compositional representations possible with dual energy data. These representations of composition have been found to be useful for detection and classification of the object in industrial and medical applications. By processing dual energy sinogram data with a material decomposition algorithm, the beam hardening errors are prevented and accurate atomic number information can be obtained. However, in order to process the data in the sinogram domain, it is necessary to identically register all source-to-detector angles in low and high energy projection views of the sinogram. Lack of such registration results in errors in the material decomposition sinogram. This registration requirement greatly constrains the system architecture and speed at which a given volume of the object can be scanned when using sinogram-based material decomposition. This is particularly true for systems where dual energy data is acquired by separate scans at two different kvp or spectral filter conditions. One proposed system uses a fast kvp switching circuit yielding separate low and high energy images. This system similarly suffers from beam hardening due to mis-registered views acquired at different times and view angles. Furthermore, a fast switching circuit will give insufficient control of the x-ray source beam current and kvp for high view rate acquisitions due to the long thermal time constants of the source filament and the electrical time constants of the high voltage system reactance.</p>
<p id="p-0005" num="0004">Image-based material decomposition has been proposed to extract atomic number information. However, with image-based material decomposition, separate high and low energy images are first reconstructed from sinogram data. A material decomposition algorithm is then applied to the image data. However, the images themselves can suffer from beam-hardening inaccuracies that can lead to errors in the atomic information gathered.</p>
<p id="p-0006" num="0005">For conventional CT imaging with data at only one tube voltage setting, artifacts are mitigated by performing a beam hardening correction on the sinogram data. The measured ρ value is increasingly suppressed below a linear dependence with respect to the actual ρ value. As is known to those skilled in the art, the ρ value refers to a log-normalized projection value of an x-ray measurement. The ρ value may be used to determine the thickness of a material based on the total x-ray attenuation and incident x-ray measurements. A larger ρ value corresponds to thicker and denser material in the path between the source and detector. As a result of the non-linear transform, a cupping artifact can result in the reconstructed image. The beam hardening effect can be corrected well for the case where the object is composed identically with the assumed material, usually water. By fitting a beam hardening curve to a polynomial and transforming, the measured sinogram multiplicatively with this polynomial transforms to some linear relation. The elimination of cupping in the image is typically accomplished by assuming water to be the material. In the case where the object material is inhomogeneous in composition and not known a priori, this beam hardening correction, using water's parameters, does not completely remove the artifacts in the image. The presence of artifacts in images of inhomogeneous objects will result in error in the atomic number determinations. And, since most objects are inhomogenous, that is, composed of different materials, conventional image-based decomposition can result in artifact-prone images.</p>
<p id="p-0007" num="0006">When (registered) dual energy sinogram data is available from CT systems, sinogram-based material decomposition is applied to extract atomic number information in a way that is insensitive to beam hardening. Sinogram-based material decomposition self-consistently removes the beam hardening effects in the sinogram and produces chemical composition information for each ray of the sinogram in one algorithmic operation. In order to obtain registered dual kvp sinogram data in a CT system, it is necessary to perform repeated axial mode acquisitions with a motionless object. Volumetric data is built up in such an axial-mode by incrementing the object after acquisition of a complete set of high and low data (step and shoot mode). To acquire aligned sinogram data, each energy acquisition involves at least a full rotation of the gantry so that the low and high energy data can be acquired with identical view angles. This full rotation of 360 degrees is more than required for generation of conventional CT images and can slow the acquisition process. For example, the translation of the object can be delayed until the full 360 degree rotation is complete and overshoot in angle may require waiting for the next rotation in order to insure identically registered views. Furthermore, mechanical inaccuracies can cause the data in the two views not to be coincident. The CT data acquisition process in conventional (non-dual-energy) CT can be accelerated by acquiring data from a scan with only 180 degrees plus detector fan angle. In addition, CT data acquisition can be faster by using more than one detector row (multi-slice CT), or with a helical acquisition with a continuously translated object. However, the registration of x-rays at two energies in these acquisition modes cannot be made identical unless the object is sent through the system twice with careful placement of the object. Alternately, duplicate system hardware can be arrayed along the direction of travel of the object with each system running at one of the two kvp settings. Such duplicative hardware is cost-prohibitive and can result in a prohibitively large scanner.</p>
<p id="p-0008" num="0007">Computed tomography systems with a dual-source x-ray tube and a wide detector have been suggested to acquire high and low kvp data. In these systems, the x-ray source has two anodes that operate at low and high kvp. This configuration has been shown to result in sinogram misregistration. Moreover, such dual-system architectures are cost intensive solutions to the problem of dual-energy data acquisition and registration. Alternately, systems with energy-sensitive detectors have been proposed, but these systems require a detector architecture that is cost prohibitive.</p>
<p id="p-0009" num="0008">Therefore, it would be desirable to have a data acquisition process that is efficient and avoids redundant scans as well as an image reconstruction process that includes imaged-based material decomposition to gather atomic number information of an object and that yields an image substantially free of beam hardening artifacts without a substantial increase in scan time.</p>
<heading id="h-0002" level="1">BRIEF DESCRIPTION OF THE INVENTION</heading>
<p id="p-0010" num="0009">The present invention overcomes the aforementioned drawbacks with a method and apparatus for acquiring CT images at different energy levels and registering those images to provide a composite image that is substantially free of beam hardening artifacts and conspicuously provides composition information of that imaged. In one embodiment, multiple gantry rotations of a helical are segmented into a low energy segments and a high energy segments so that dual-energy data can be acquired in one or more gantry rotations and with a single x-ray source. In the context of this invention, the motion of the gantry relative to the imaged object can be configured to affect a scan in helical or step-and-shoot modes.</p>
<p id="p-0011" num="0010">In addition to the segmented scan just described, a system with fast kvp switching between each view can also benefit by iterative beam hardening corrections if the registration in the sinogram domain is lacking. In these cases, image domain material decomposition analysis with beam hardening correction is needed to reveal atomic number or material composition information.</p>
<p id="p-0012" num="0011">Therefore, in accordance with one aspect, the invention includes an imaging apparatus having a data acquisition system configured to reconstruct an image of an object. The apparatus further includes a computer programmed to define a given projection into a first segment and a second segment different from the first segment and acquire a first set of data in the first segment and acquire a second set of data in the second segment. The first set of data is acquired at a first energy level and the second set of data is acquired at a second energy level that is different from the first energy level. The computer is further programmed to reconstruct a first image from the first set of data and a second image from the second set of data, and then automatically register the first and the second images into a composite image substantially free of beam hardening artifacts and that at least provides material decomposition information.</p>
<p id="p-0013" num="0012">In accordance with another aspect, the invention includes a computer readable storage medium having a computer program stored thereon and representing a set of instructions that when executed by a computer causes the computer to perform image-based atomic number mapping of an object imaged in a dual-energy mode.</p>
<p id="p-0014" num="0013">According to another aspect, the invention is embodied in a method of CT imaging that includes determining a first attenuation coefficient for a given pixel in a first image and determining a second attenuation coefficient, different from the first attenuation coefficient, for the given pixel in a second image, different from the first image. The method further determines a linear coefficient ratio between the first attenuation coefficient and the second attenuation coefficient and determines an atomic make-up for the given pixel from the linear coefficient ratio. The method further includes the step of displaying a registered image comprised of the first and the second images with the given pixel in the registered image displayed in a conspicuous manner to indicate the atomic make-up of that imaged in the given pixel.</p>
<p id="p-0015" num="0014">Various other features and advantages of the present invention will be made apparent from the following detailed description and the drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0016" num="0015">The drawings illustrate one preferred embodiment presently contemplated for carrying out the invention.</p>
<p id="p-0017" num="0016">In the drawings:</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 1</figref> is a pictorial view of a CT system for use with a non-invasive package inspection system.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 2</figref> is a block schematic diagram of the system illustrated in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart setting forth the steps of an image-based material decomposition technique according to one aspect of the invention.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 4</figref> is a graph illustrating measured ρ values versus actual ρ values for high kvp data and low kvp data.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 5</figref> is a flow chart setting forth the steps of an image-based material decomposition technique with multi-pass beam hardening correction according to another aspect of the invention.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 6</figref> is a flow chart setting forth the steps of another image-based material decomposition technique in accordance with the present invention.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 7</figref> is a graph illustrating a relationship between linear coefficient ratios and atomic number.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 8</figref> is a pictorial view of a CT system for medical imaging.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
<p id="p-0026" num="0025">Referring to <figref idref="DRAWINGS">FIGS. 1 and 2</figref>, a computed tomography (CT) imaging system <b>10</b> is shown as including a gantry <b>12</b> representative of a “third generation” CT scanner for scanning luggage, parcels, and packages. Gantry <b>12</b> has an x-ray source <b>14</b> that projects a beam of x-rays <b>16</b> toward a detector array <b>18</b> on the opposite side of the gantry <b>12</b>. The x-ray source is preferably a single-anode x-ray source. Detector array <b>18</b> is formed by a plurality of detectors <b>20</b> which together sense the projected x-rays that pass through an object <b>22</b>. Each detector <b>20</b> produces an electrical signal that represents the intensity of an impinging x-ray beam and hence the attenuated beam as it passes through the patient <b>22</b>. It is contemplated that each detector <b>20</b> may be an energy integrating detector or a photon counting energy discriminating detector. During a scan to acquire x-ray projection data, gantry <b>12</b> and the components mounted thereon rotate about a center of rotation <b>24</b>.</p>
<p id="p-0027" num="0026">Rotation of gantry <b>12</b> and the operation of x-ray source <b>14</b> are governed by a control mechanism <b>26</b> of CT system <b>10</b>. Control mechanism <b>26</b> includes an x-ray controller <b>28</b> that provides power and timing signals to an x-ray source <b>14</b> and a gantry motor controller <b>30</b> that controls the rotational speed and position of gantry <b>12</b>. A data acquisition system (DAS) <b>32</b> in control mechanism <b>26</b> samples analog data from detectors <b>20</b> and converts the data to digital signals for subsequent processing. An image reconstructor <b>34</b> receives sampled and digitized x-ray data from DAS <b>32</b> and performs high speed reconstruction. The reconstructed image is applied as an input to a computer <b>36</b> which stores the image in a mass storage device <b>38</b>.</p>
<p id="p-0028" num="0027">Computer <b>36</b> also receives commands and scanning parameters from an operator via console <b>40</b> that has a keyboard. An associated cathode ray tube display <b>42</b> allows the operator to observe the reconstructed image and other data from computer <b>36</b>. The operator supplied commands and parameters are used by computer <b>36</b> to provide control signals and information to DAS <b>32</b>, x-ray controller <b>28</b> and gantry motor controller <b>30</b>.</p>
<p id="p-0029" num="0028">In addition, computer <b>36</b> operates a table motor controller <b>44</b> which controls a motorized conveyor system <b>46</b> to position objects <b>22</b> through a gantry opening <b>48</b>. The conveyor system <b>46</b> includes a conveyor belt <b>50</b> supported by structure <b>52</b> to automatically and continuously pass packages or baggage pieces <b>22</b> through opening <b>48</b> to be scanned. Objects <b>22</b> are fed through opening <b>48</b> by conveyor belt <b>50</b>, imaging data is then acquired, and the conveyor belt <b>50</b> removes the packages <b>22</b> from opening <b>48</b> in a controlled and continuous manner. As a result, postal inspectors, baggage handlers, and other security personnel may non-invasively inspect the contents of packages <b>22</b> for explosives, knives, guns, contraband, etc.</p>
<p id="p-0030" num="0029">As will be described in greater detail below, the present invention is directed to an apparatus and method for reconstructing and displaying CT images with material differentiation based on atomic number, wherein the images are substantially free of beam hardening artifacts. Three exemplary algorithms for such reconstruction will be described, but one skilled in the art will appreciate that variants of the three exemplary algorithms are contemplated and considered within the scope of the claimed invention.</p>
<p id="p-0031" num="0030">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, a flow chart for image-based atomic number mapping with pixel-by-pixel thickness according to one aspect of the present invention is shown. As will be explained below, the exemplary algorithm assumes a pixel thickness of 1.0 cm. One skilled in the art will appreciate that a “pixel” corresponds to a picture element of a reconstructed image. Thus, a presumed 1.0 cm thick pixel refers to the presumed thickness of the material imaged in each pixel. For algorithm <b>54</b>, the material is presumed to be water.</p>
<p id="p-0032" num="0031">Algorithm <b>54</b> begins at step <b>56</b> with the acquisition of a low energy sinogram and a high energy sinogram <b>58</b> in one of a number of dual-energy manners. In one preferred embodiment, the low energy sinogram is acquired in approximately one-half of a full gantry rotation plus detector fan-angle and the high energy sinogram in acquired in approximately one-half of a full gantry rotation plus detector fan-angle. In this regard, little over one full gantry rotation of data acquisition is segmented into a low energy half and a high energy half. This allows for nearly full 360 degree plus twice the fan angle acquisition without increasing scan time.</p>
<p id="p-0033" num="0032">For step-and-shoot scanning, the linear motion is suspended during the acquisition of both kvp data sets corresponding to gantry rotation of one-full rotation plus twice the fan angle. Upon completion of this acquisition, the object is moved one detector width. For helical mode scanning, the gantry rotation and linear motion of the object are continuous constant values. The switching of kvp will occur periodically at the points where a complete set of helical data is acquired for each kvp. For example, for a pitch one-half helical scan, during every rotation of the gantry, the object will increment by one-half the width of the detector and the kvp is changed when the system reaches top-dead-center on every rotation. For a gated acquisition, the data and linear motion are adjusted to optimally match biological signatures, such as respiration and heart beat motion.</p>
<p id="p-0034" num="0033">It is recognized that a number of techniques may be used to acquire the sinograms <b>58</b>. For example, the x-ray tube may be alternately biased between a high kvp and a low kvp. or, a dynamic x-ray filter may be controlled such that the x-ray beam attenuated by the object to be imaged is cycled between high energy and low energy. It is also contemplated that a combination of x-ray tube and x-ray filter control may be used to acquire sinograms at different energy levels. Other dual-energy techniques are also contemplated, i.e., tube current control in conjunction with x-ray filter control. At 60, the sinograms undergo spectrally-sensitive beam hardening correction and cone beam correction to preserve the spectral information contained in each sinogram. Following beam hardening correction <b>60</b>, the sinograms are reconstructed to form a low energy image and a high energy image in a conventional manner <b>62</b>. It is typical for a properly calibrated CT system to produce registered low and high images by reconstruction even if the sinogram data is not registered.</p>
<p id="p-0035" num="0034">The data for each pixel in the low and high energy images are then combined in an imaged-based material decomposition algorithm with a presumed pixel thickness at <b>64</b> to derive atomic number information for each pixel of the images. In other words, an atomic number map is generated for each image on a pixel-by-pixel basis. As will be described below, the atomic map information is used to determine the material imaged in each pixel of the images. The high and low energy images are then combined with the atomic number map to form a composite image <b>66</b> that is presented with both density and atomic number information. For example, it is contemplated that color-coding, shading, and the like of the usual CT gray-scale image may be used to differentiate materials in the composite image. The composite image is displayed and/or stored in a conventional scanner at <b>68</b> whereupon the process ends.</p>
<p id="p-0036" num="0035">As reference above, the high and low energy images are decomposed to determine atomic number information therefrom. This atomic number information is ascertainable because there is a different and unique relationship between measured ρ values and actual ρ values for each energy. This is illustrated in the graph of <figref idref="DRAWINGS">FIG. 4</figref>. Moreover, the relationship between measured and actual ρ values will differ significantly depending upon the material through which the x-rays are attenuated. For the algorithm illustrated in <figref idref="DRAWINGS">FIG. 3</figref>, it has been presumed that the material that attenuates the x-rays is water. In this regard, the beam hardening correction preserves the spatial sensitivity information of the images by basing the correction on the linear extrapolation from the attenuation through 1.0 cm of water. Conventional beam hardening correction techniques use a linear relationship between measured and actual ρ values with a fixed slope of 0.2 cm<sup>−1 </sup>regardless of the spectral content. By taking the actual spectral content into consideration during beam hardening correction, the present invention has shown to reconstruct images with improved image quality.</p>
<p id="p-0037" num="0036">The reconstruction technique described with respect to <figref idref="DRAWINGS">FIG. 3</figref>, for purposes of explanation, is referred to as a “first pass” beam hardening correction technique. However, this first pass technique may not to be optimal when a material other than water is presumed to be the material through which x-rays are attenuated. Accordingly, a “multi-pass” technique is shown in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0038" num="0037">The “multi-pass” technique <b>70</b> is similar to the technique of <figref idref="DRAWINGS">FIG. 3</figref> in that the imaging process begins at step <b>72</b> with the acquisition of a low energy sinogram and a high energy sinogram <b>74</b>. The low and high energy sinograms undergo beam hardening correction at <b>76</b> followed by reconstruction of beam-hardening corrected, Hounsfield unit, low energy and high energy images <b>78</b>. The beam hardening correction carried out at step <b>76</b> is similar to the beam hardening correction described above with respect to <figref idref="DRAWINGS">FIGS. 3 and 4</figref>. Specifically, for the first pass of beam hardening correction, it is presumed that water is the material that attenuates the x-ray beam.</p>
<p id="p-0039" num="0038">The reconstructed beam-hardening corrected images are reprojected at <b>80</b> to obtain low and high energy sinograms with registration to the measured sinogram acquired at <b>74</b>. In this regard, the images are reprojected twice, each time to register with either the low or high energy measured sinogram. The reprojection is preferably carried out with a courser matrix size to expedite execution of the algorithm. Following reprojection, material decomposition is performed on the re-projected sinograms at <b>82</b> to extract atomic number information for each ray of the registered sinograms. Thereafter, spectrally-sensitive beam hardening correction is carried out on the registered sinograms, but now using the atomic number information for each ray. The corrected sinograms are then reconstructed at <b>86</b> to yield low and high energy images. The images are then decomposed at <b>88</b> in a manner similar to that described with respect to <figref idref="DRAWINGS">FIG. 3</figref>. The low and high energy images are then registered and presented at <b>90</b> with atomic number information. The process then ends at <b>92</b>.</p>
<p id="p-0040" num="0039">While the algorithm of <figref idref="DRAWINGS">FIG. 5</figref> has been described with respect to “two” beam hardening passes, it is contemplated that more than two passes or iterations may be carried out. In this regard, the spectrally-sensitive beam hardening corrected sinograms may be decomposed at <b>82</b> to re-determine atomic number information. In this regard, steps <b>82</b> through <b>84</b> may be iteratively repeated a desired number of times to improve the accuracy of the atomic number information. However, it is believed that two passes will be sufficient for most CT studies. For example, testing has shown that water and aluminum of a phantom can be correctly assigned an atomic number with two passes. Furthermore, those skilled in the art will appreciate that additional iterative reconstruction algorithms which effect a consecutive improvement in the atomic number information upon each iteration of the algorithm are contemplated.</p>
<p id="p-0041" num="0040">Referring now to <figref idref="DRAWINGS">FIG. 6</figref>, another exemplary algorithm for image-based material decomposition with beam hardening correction is shown in flow chart form. Algorithm <b>94</b> is similar to the algorithm described with respect to <figref idref="DRAWINGS">FIG. 3</figref>, but does not include beam hardening correction of sinogram data before image reconstruction. Moreover, algorithm <b>94</b> avoids the reprojection step of the algorithm of <figref idref="DRAWINGS">FIG. 5</figref>. Thus, the imaging process <b>94</b> begins at <b>96</b> with the acquisition of low and high energy data <b>98</b>. As referenced above, beam hardening correction is not performed prior to image reconstruction. In this regard, beam hardening artifacts are mitigated by the selection of a material thickness on a per-pixel basis.</p>
<p id="p-0042" num="0041">Two techniques for determining material thickness are contemplated. In either approach, the low and high energy sinograms are reconstructed into low and high energy images <b>102</b>. In one technique, the material thickness for each image pixel is set to the same value give by the median ρ value of the low energy sinogram divided by a scalar <b>100</b>, e.g., 0.2. In another technique, a separate thickness value is generated of each pixel in the low energy image <b>104</b>. The thickness value is constructed by reprojection of each image pixel onto a trajectory along the low energy sinogram and selecting the median or maximum value of ρ value on that trajectory divided by a scalar, e.g., 0.2. The trajectory can be pre-computed and available as a lookup table for every data set. In either approach <b>100</b> or <b>104</b>, imaged-based material decomposition is performed <b>106</b> on the reconstructed low and high energy images using either a constant value for all pixels, formed by the median ρ value of the low energy sinogram divided by a scalar as the material thickness value, or using a respective thickness value for each pixel. Following decomposition, the low and high energy images are registered and presented as a composite image with atomic number information differentiation at <b>108</b>. The imaging process then ends at <b>110</b>.</p>
<p id="p-0043" num="0042">As described for each of the exemplary decomposition techniques, atomic number information is determined, in part, from information relating to the thickness of a material captured in a given image pixel. Specifically, attenuation due to thickness T of material M is equivalent to attenuation of material with interpolated atomic number Z and same thickness T. As such, the linear attenuation constant, α, for a material illuminated with a broad spectrum of x-rays can be obtained as the sum with spectral weighting of the attenuation factor through a thickness T at each photon energy indexed by n. The spectral weighing w<sub>bin,n </sub>will be equal to the energy multiplied by the number of photons absorbed in the detector at the energy for energy-integrating detectors.</p>
<p id="h-0005" num="0000">Specifically:</p>
<p id="p-0044" num="0043">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>α</mi>
            <mi>bin</mi>
          </msub>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
              <mi>T</mi>
            </mfrac>
            <mo>⁢</mo>
            <mrow>
              <mi>ln</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <munder>
                    <mo>∑</mo>
                    <mi>n</mi>
                  </munder>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mrow>
                    <msub>
                      <mi>w</mi>
                      <mrow>
                        <mi>bin</mi>
                        <mo>,</mo>
                        <mi>n</mi>
                      </mrow>
                    </msub>
                    <mo>⁢</mo>
                    <msup>
                      <mi>ⅇ</mi>
                      <mrow>
                        <mrow>
                          <mo>-</mo>
                          <msub>
                            <mi>Tα</mi>
                            <mrow>
                              <mi>Z</mi>
                              <mo>,</mo>
                              <mi>n</mi>
                            </mrow>
                          </msub>
                        </mrow>
                        <mo>⁢</mo>
                        <mstyle>
                          <mspace width="0.3em" height="0.3ex"/>
                        </mstyle>
                      </mrow>
                    </msup>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>Eqn</mi>
          <mo>.</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mn>1</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0045" num="0044">where:</p>
<p id="p-0046" num="0045">w<sub>bin,n </sub>is the energy weighting function for each bin at energy E<sub>n</sub>,</p>
<p id="p-0047" num="0046">α<sub>Z,n </sub>is the linear attenuation constant of element Z with density 1 g/cc at energy E<sub>n</sub>.</p>
<p id="p-0048" num="0047">With this equation and knowledge about the spectral content of the two energy bins, it is possible to calculate and plot a ratio of high linear coefficient to low linear attenuation coefficients as a function of atomic number, as illustrated in <figref idref="DRAWINGS">FIG. 7</figref>. As shown, the ratio of linear coefficients can be plotted for each atomic element and thickness. The plot can be interpolated to extract the atomic number of any material M with thickness T. Accordingly, on a pixel-by-pixel basis for the high and low energy images reconstructed as described above, a linear coefficient ratio is determined. By interpolating the plot shown in <figref idref="DRAWINGS">FIG. 7</figref>, the atomic number for each pixel can be ascertained and used to differentiate materials in a composite image of the high and low energy images. The plot shown in <figref idref="DRAWINGS">FIG. 7</figref> is preferably stored as a lookup table in computer readable memory of the CT scanner.</p>
<p id="p-0049" num="0048">The present invention is also applicable with a CT scanner for medical scanning. An exemplary medical CT scanner <b>112</b> is shown in <figref idref="DRAWINGS">FIG. 8</figref>. The scanner includes a gantry <b>114</b> housing an x-ray source <b>118</b> that projects a beam of x-rays toward a detector array <b>120</b> on the opposite side of the gantry <b>114</b>. Detector array <b>120</b> senses the projected x-rays that pass through the patient <b>116</b>. The patient is translated through gantry opening <b>122</b> in either a continuous or incremental manner by table <b>124</b>. While a “third generation” CT scanner has been shown, the invention is applicable with other configured CT scanners including but not limited to “first”, “second”, “fourth”, “fifth”, “sixth”, etc. generation systems.</p>
<p id="p-0050" num="0049">Therefore, in accordance with one embodiment, the invention includes an imaging apparatus having a data acquisition system configured to reconstruct an image of an object. The apparatus further includes a computer programmed to define a given projection into a first segment and a second segment different from the first segment and acquire a first set of data in the first segment and acquire a second set of data in the second segment. The first set of data is acquired at a first energy level and the second set of data is acquired at a second energy level that is different from the first energy level. The computer is further programmed to reconstruct a first image from the first set of data and a second image from the second set of data, and then automatically register the first and the second images into a composite image substantially free of beam hardening artifacts and that at least provides material decomposition information.</p>
<p id="p-0051" num="0050">In accordance with another embodiment, the invention includes a computer readable storage medium having a computer program stored thereon and representing a set of instructions that when executed by a computer causes the computer to perform image-based atomic number mapping of an object imaged in a dual-energy mode.</p>
<p id="p-0052" num="0051">According to another embodiment, the invention is embodied in a method of CT imaging that includes determining a first attenuation coefficient for a given pixel in a first image and determining a second attenuation coefficient, different from the first attenuation coefficient, for the given pixel in a second image, different from the first image. The method further determines a linear coefficient ratio between the first attenuation coefficient and the second attenuation coefficient and determines an atomic make-up for the given pixel from the linear coefficient ratio. The method further includes the step of displaying a registered image comprised of the first and the second images with the given pixel in the registered image displayed in a conspicuous manner to indicate the atomic make-up of that imaged in the given pixel.</p>
<p id="p-0053" num="0052">The present invention has been described in terms of the preferred embodiment, and it is recognized that equivalents, alternatives, and modifications, aside from those expressly stated, are possible and within the scope of the appending claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298812-20071120-M00001.NB">
<img id="EMI-M00001" he="8.47mm" wi="76.20mm" file="US07298812-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An imaging apparatus having a data acquisition system configured to reconstruct an image of an object and comprising a computer programmed to:
<claim-text>define a given projection into a first segment and a second segment different from the first segment;</claim-text>
<claim-text>acquire a first set of data in the first segment and acquire a second set of data in the second segment, wherein the first set of data is acquired at a first energy level and the second set of data is acquired at a second energy level that is different from the first energy level;</claim-text>
<claim-text>reconstruct a first image from the first set of data and a second image from the second set of data;</claim-text>
<claim-text>re-project the first image to a first set of corrected sinograms and re-project the second image to a second set of corrected sinograms;</claim-text>
<claim-text>decompose the first and second sets of corrected sinograms and determine atomic number information for each ray of each corrected sinogram, wherein the step of decomposing comprises generating an atomic number of material composition map from the decomposition;
<claim-text>reconstruct a first corrected image and a second corrected image from the first and the second sets of corrected sinograms; and</claim-text>
<claim-text>automatically register the first and the second corrected images into a composite image substantially free of beam hardening artifacts, wherein the composite image provides material decomposition information.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising an x-ray energy source designed to emit an x-ray beam toward an x-ray detector spaced from the x-ray source by at least an object to be imaged, and wherein the first set of data is acquired with the x-ray source biased to a first voltage and the second set of data is acquired with the x-ray source biased to a second voltage different from the first voltage.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The apparatus of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the second voltage is considerably less than the first voltage.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the computer is further programmed to correct the first and the second images for cone beam distortions prior to registration.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the computer is further programmed to perform spectrally-sensitive beam hardening correction, with a water curve, on the first set and the second set of data to yield a first sinogram and a second sinogram, respectively.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The apparatus of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the computer is further programmed to reconstruct the first image from the first sinogram and reconstruct the second image from the second sinogram, and display the composite image with material differentiation by color-coding image pixels corresponding to various imaged materials.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising an x-ray source and an x-ray filter, and wherein the computer is further programmed to automatically control at least one of x-ray source energization and x-ray filter filtering to generate the first energy level and the second energy level.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The apparatus of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein the x-ray source is a single anode x-ray source.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the computer is further programmed to determine material composition of the composite image based on atomic numbers of that imaged in the composite image, the determination of the material composition achieved by:
<claim-text>determining a first attenuation coefficient for a given pixel in the first image and a second attenuation coefficient for the given pixel in the second image;</claim-text>
<claim-text>determining a ratio between the first attenuation coefficient and the second attenuation coefficient; and</claim-text>
<claim-text>determining an atomic number for the given pixel in the composite image from the ratio.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00009">claim 9</claim-ref> further comprising a computer readable storage medium having a look-up table stored thereon, and wherein the computer is further programmed to compare the determined ratio to the look-up table to determine the atomic number for the given pixel.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the first set of data includes a first sinogram and the second set of data includes a second sinogram, and wherein the computer is further programmed to:
<claim-text>reconstruct the first image from the first sinogram and reconstruct the second image from the second sinogram with a first beam hardening correction;</claim-text>
<claim-text>re-project the first image to a first set of corrected sinograms and re-project the second image to a second set of corrected sinograms;</claim-text>
<claim-text>decompose the first and the second sets of corrected sinograms and determine atomic number information for each ray of each corrected sinogram;</claim-text>
<claim-text>perform spectrally sensitive beam hardening correction, with the atomic number information, on the first and the second set of corrected sinograms;</claim-text>
<claim-text>reconstruct a first corrected image and a second corrected image from the spectrally sensitive beam hardening corrected sinograms;</claim-text>
<claim-text>register the first corrected image and the second corrected image to form a corrected composite image; and</claim-text>
<claim-text>display with the corrected composite image with atomic number information differentiated in the corrected composite image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the first set of data includes a first sinogram and the second set of data includes a second sinogram, and wherein the computer is further programmed to:
<claim-text>determine median ρ-value of second sinogram;</claim-text>
<claim-text>set baseline thickness to the median ρ-value;</claim-text>
<claim-text>iteratively determine a first attenuation coefficient for each pixel in the first image and a second attenuation coefficient for each pixel in the second image;</claim-text>
<claim-text>determine a ratio between the first attenuation coefficient and the second attenuation coefficient for each pixel;</claim-text>
<claim-text>determine an atomic number for each pixel in the composite image from a linear attenuation coefficient curve that is defined in the x-axis by atomic number and defined in the y-axis by possible ratios.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the computer is further programmed to:
<claim-text>determine a thickness for each pixel of the second image;</claim-text>
<claim-text>iteratively determine a first attenuation coefficient for each pixel in the first image and a second attenuation coefficient for each pixel in the second image;</claim-text>
<claim-text>determine a ratio between the first attenuation coefficient and the second attenuation coefficient for each pixel;</claim-text>
<claim-text>determine an atomic number for each pixel in the composite image from a linear attenuation coefficient curve that is defined in the x-axis by atomic number and defined in the y-axis by possible ratios, wherein the thickness determined for each pixel mitigates beam hardening artifacts for the pixel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> configured to acquire CT data of luggage, packages, or parcels.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> configured to acquire CT data from a medical patient.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The apparatus of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising a rotatable gantry defining a bore to receive an object for imaging, the gantry housing an x-ray source and an x-ray detector assembly that are rotated about the object during CT data acquisition, and wherein one projection of data is acquired in one gantry rotation plus twice a detector fan-angle, and wherein the first segment is defined by one-half of gantry rotation plus a fan-angle and the second segment is defined by the other one-half of gantry rotation plus a fan-angle.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the computer is further programmed to coordinate gantry rotation with linear motion of the object to effect a helical scan, and wherein periodic switching of kvp corresponds to linear motion of one-half of detector width.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the computer is further programmed to coordinate gantry rotation with linear motion of the object to effect a step-and-shoot scan, and wherein the linear motion is suspended during acquisition of one projection data corresponding to two segments and linear advancement between acquisitions.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A computer readable storage medium having a computer program stored thereon and representing a set of instructions that when executed by a computer causes the computer to perform image-based atomic number mapping of an object imaged in a dual-energy mode, wherein the set of instructions comprise:
<claim-text>defining a given projection into a first segment and a second segment different from the first segment;</claim-text>
<claim-text>acquiring a first set of data in the first segment and acquiring a second set of data in the second segment, wherein the first set of data is acquired at a first energy level and the second set of data is acquired at a second energy level that is different from the first energy level;</claim-text>
<claim-text>reconstructing a first image from the first set of data and a second image from the second set of data;</claim-text>
<claim-text>re-projecting the first image to a first set of corrected sinograms and re-projecting the second image to a second set of corrected sinograms;</claim-text>
<claim-text>decomposing the first and second sets of corrected sinograms and determining atomic number information for each ray of each corrected sinogram, wherein the step of decomposing comprises generating an atomic number of material composition map from the decomposition;</claim-text>
<claim-text>reconstructing a first corrected image and a second corrected image from the first and the second sets of corrected sinograms; and</claim-text>
<claim-text>automatically registering the first and the second corrected images into a composite image substantially free of beam hardening artifacts, wherein the composite image provides material decomposition information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer readable storage medium of <claim-ref idref="CLM-00019">claim 19</claim-ref> wherein the computer is further caused to:
<claim-text>automatically register a high kvp image and a low kvp image to form a composite image;</claim-text>
<claim-text>associate an atomic number of reach pixel of the composite image; and</claim-text>
<claim-text>color-code the composite image to differentiate imaged materials from one another based on atomic number.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The computer readable storage medium of <claim-ref idref="CLM-00020">claim 20</claim-ref> wherein the computer is further caused to iteratively determine the atomic number for each pixel of the composite image based on a linear coefficient curve.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A method of CT imaging comprising the steps of:
<claim-text>determining a thickness for each pixel;</claim-text>
<claim-text>determining a first attenuation coefficient for a given pixel in a first image;</claim-text>
<claim-text>determining a second attenuation coefficient, different from the first attenuation coefficient, for the given pixel in a second image, different from the first image;</claim-text>
<claim-text>determining a linear coefficient ratio between the first attenuation coefficient and the second attenuation coefficient;</claim-text>
<claim-text>determining an atomic make-up for the given pixel from the linear coefficient ratio, wherein the thickness determined for each pixel mitigates beam hardening artifacts for the pixel; and</claim-text>
<claim-text>displaying a registered image comprised of the first and the second images with the given pixel in the registered image displayed in a conspicuous manner to indicate the atomic make-up of that imaged in the given pixel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref> wherein the first image is acquired at a first energy level and the second image is acquired at a second energy level, different from the first energy level.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method of <claim-ref idref="CLM-00023">claim 23</claim-ref> further comprising the step of alternating an x-ray source between a high kvp and a low kvp to acquire the first and the second images, respectively.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref> wherein the registered image is substantially free of beam hardening artifacts.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref> wherein the atomic make-up of that imaged in the given pixel is indicated by at least one of color-coding or shading. </claim-text>
</claim>
</claims>
</us-patent-grant>
