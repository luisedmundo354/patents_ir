<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07297117-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07297117</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10852572</doc-number>
<date>20040524</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>IT</country>
<doc-number>SV03A0023</doc-number>
<date>20030522</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>209</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>8</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>600443</main-classification>
</classification-national>
<invention-title id="d0e71">Method for optimization of transmit and receive ultrasound pulses, particularly for ultrasonic imaging</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5089988</doc-number>
<kind>A</kind>
<name>Arens</name>
<date>19920200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>367 12</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5113866</doc-number>
<kind>A</kind>
<name>Hassler et al.</name>
<date>19920500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600447</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5517996</doc-number>
<kind>A</kind>
<name>Okada et al.</name>
<date>19960500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600447</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5551433</doc-number>
<kind>A</kind>
<name>Wright et al.</name>
<date>19960900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600443</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6279398</doc-number>
<kind>B1</kind>
<name>Bae et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 73625</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6282963</doc-number>
<kind>B1</kind>
<name>Haider</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 73602</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6368279</doc-number>
<kind>B1</kind>
<name>Liu</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600443</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6436044</doc-number>
<kind>B1</kind>
<name>Wang</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600443</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6585648</doc-number>
<kind>B1</kind>
<name>Robinson</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600437</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6599245</doc-number>
<kind>B1</kind>
<name>Ma et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600437</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6726631</doc-number>
<kind>B2</kind>
<name>Hatangadi et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>600459</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>60</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>600443-447</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>600455-458</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>128916</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 73625-626</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 73602</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>15</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050033167</doc-number>
<kind>A1</kind>
<date>20050210</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Trucco</last-name>
<first-name>Andrea</first-name>
<address>
<city>Genoa</city>
<country>IT</country>
</address>
</addressbook>
<nationality>
<country>IT</country>
</nationality>
<residence>
<country>IT</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Curletto</last-name>
<first-name>Simone</first-name>
<address>
<city>Genoa</city>
<country>IT</country>
</address>
</addressbook>
<nationality>
<country>IT</country>
</nationality>
<residence>
<country>IT</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Woodard, Emhardt, Moriarty, McNett &amp; Henry LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Esaote, S.p.A.</orgname>
<role>03</role>
<address>
<city>Casale Monferrato</city>
<country>IT</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Jaworski</last-name>
<first-name>Francis J.</first-name>
<department>3768</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for optimizing transmit and receive ultrasound imaging pulses generates transmit pulses from an array of transducers which are energized by excitation signals that are applied to each individual transducer of the array. Each of the excitation signals are individually weighted to optimize the transducers' contribution to a predetermined energy function. Such optimization may also be performed on the received pulses.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="63.75mm" wi="93.13mm" file="US07297117-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="206.33mm" wi="161.54mm" file="US07297117-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="208.70mm" wi="153.92mm" file="US07297117-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="212.51mm" wi="158.41mm" file="US07297117-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="211.50mm" wi="149.86mm" file="US07297117-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="98.55mm" wi="121.07mm" file="US07297117-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="226.65mm" wi="166.20mm" file="US07297117-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="219.29mm" wi="155.45mm" file="US07297117-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="174.24mm" wi="150.20mm" file="US07297117-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATION</heading>
<p id="p-0002" num="0001">The present application claims the benefit of Italian Application Serial No. IT SV2003A000023, filed on May 22, 2003, which is hereby incorporated by reference in its entirety.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">The invention addresses a method for optimizing ultrasonic transmit and receive pulses, particularly for ultrasound imaging, wherein transmit pulses are generated from ultrasonic pulse contributions of each of a plurality of electroacoustic transducers, which are grouped in an array and are individually triggered by electric excitation signals, the excitation signal being applied to each individual transducer of the array with a predetermined delay with respect to the application of the excitation signal to the other transducers, and a weight being applied to the excitation signal of each transducer for increasing/decreasing the amplitude of the excitation signal and, as a result, the acoustic signal generated by the transducer.</p>
<p id="p-0004" num="0003">In prior art insonification and ultrasonic pulse generation methods for ultrasonic imaging, each pulse results from ultrasonic pulse contributions of a certain number of electroacoustic transducers which are individually excited to transmit the corresponding acoustic pulse at different times, i.e. with predetermined delays relative to each other, to generate a comprehensive pulse which is focused on a predetermined scan line or band in the direction of the body or object under examination, and at a predetermined penetration depth within said body or object under examination.</p>
<p id="p-0005" num="0004">In addition to said focusing, the application of amplitude attenuating/increasing weights to the individual acoustic pulse contributions provided by transducers is known, in order to obtain beam patterns, i.e. pulse fronts having a narrow main lobe, having a predominant amplitude as compared with side lobes. This has the purpose of reducing insonification in regions of the body or object under examination that are close to those on which the ultrasonic transmit pulse is focused and of reducing artifacts in images. Essentially, the side lobes generate reflection pulses from the areas adjacent to pulse focusing areas, and thereby contaminate or distort to a certain extent the resulting image by superposition of such pulses upon the reflection pulses deriving from the main lobe and from the ultrasonic pulse focusing area on the body or object under examination.</p>
<p id="p-0006" num="0005">Nevertheless, in prior art no consideration is given to the problem that such optimization process does not account for the effects on mechanical pressure distribution in the body or object under examination, which is not optimal in itself, and becomes even less homogeneous in the focusing region, as a result of the ultrasonic pulse optimization process as described above.</p>
<p id="p-0007" num="0006">The mechanical pressure that is exerted in the body or object being examined also has a certain importance, an excessive mechanical pressure potentially causing the structure of the material of the body or object under examination to break. Such effect is particularly undesired in the field of biomedical imaging, the tissues of the body or object under examination being frequently permeated with contrast agents to enhance visibility of non echogenic tissues. These contrast agents are made of microspheres or microbubbles, which have a nonlinear reflection behavior and reflect the acoustic signal at a frequency that is different from that of the incident transmit pulse, thereby allowing to image structures of non echogenic materials or tissues.</p>
<p id="p-0008" num="0007">Contrast agents are particularly responsive to the mechanical pressure exerted by acoustic insonification pulses and may be destroyed when such mechanical pressure exceeds predetermined limits.</p>
<p id="p-0009" num="0008">Essentially, when considering the mechanical pressure profile generated along the scan line on which the ultrasonic pulse is focused, at depths different from the focusing depth, the mechanical pressure value is found to change with depth. Since contrast agents may be located along a scan line at different positions as compared with the ultrasonic pulse focusing depth, prior art methods cannot ensure that the ultrasonic pulse has the right mechanical pressure in the area that is permeated with contrast agents, and it is further not easy to predict if such pressure will be lower or higher than the maximum allowed pressure to prevent contrast agent destruction. Also, regarding the beam pattern, prior art methods cannot ensure that the latter will be constant or substantially constant or anyway that it will maintain a good quality as the penetration depth of the ultrasonic pulse within the body or object under examination changes.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">Therefore, the invention has the object of providing a method for optimization of transmit and receive ultrasound pulses, particularly for ultrasonic imaging, whereby the transmit ultrasound pulse may be optimized along a scan line or band, on which the pulse is focused, and across a predetermined penetration depth range, which spans or contains the focusing depth, in such a manner as to obviate the drawbacks of prior art methods, thereby providing both mechanical pressure optimization and beam pattern optimization.</p>
<p id="p-0011" num="0010">The invention fulfils the above objects by providing a method for optimization of transmit and receive ultrasound pulses, particularly useful for ultrasonic imaging.</p>
<p id="p-0012" num="0011">The optimal desired mechanical pressure profile relative to the penetration depth of the ultrasonic pulse within the body or object being examined is defined as a function of at least the amplitude weighting parameters for the transducers' contributions to the comprehensive pulse, and of the transmission excitation delays for individual transducer pulse contributions in order to focus ultrasonic pulses on a scan line or band and at a certain penetration depth within the body or object under examination.</p>
<p id="p-0013" num="0012">The ideal beam pattern for ultrasonic pulses relative to the propagation time or penetration depth within the body or object under examination is defined as a function of at least the amplitude weighting parameters for the transducers' contributions to the comprehensive pulse, and of the transmission excitation delays for individual transducer pulse contributions in order to focus ultrasonic pulses on a scan line or band and at a certain penetration depth within the body or object under examination.</p>
<p id="p-0014" num="0013">An energy function which depends on the difference between the ideal pressure profile and the actual pressure profile and between the ideal beam pattern and the actual beam pattern is defined and the minimum of that energy function is determined.</p>
<p id="p-0015" num="0014">Weighting parameters and delays which correspond to the minimum of the energy function are determined and used to excite the transducers to generate the comprehensive ultrasonic pulse.</p>
<p id="p-0016" num="0015">The transducer excitation delays may be chosen to be ultrasonic pulse focusing delays, which are currently used for focusing ultrasonic pulses in ultrasonic imaging apparatus.</p>
<p id="p-0017" num="0016">An additional variable may be provided for the individual transducers' pulse contributions which form the comprehensive ultrasonic pulse. The transducers of the transducer array, individually or in subgroups, may be excited to transmit pulse contributions having different waveforms. In this case, both the function that describes the pressure profile relative to the penetration depth and the function that describes the beam pattern profile may depend on the waveforms of the individual transducers' contributions.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">DESCRIPTION OF THE DRAWING</heading>
<p id="p-0018" num="0017">The method of the invention will be described below with reference to a few experimental embodiments, whose results are shown in the annexed figures, in which:</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic view of an array of transducers, and the propagation geometry of an ultrasonic pulse which is focused on a scan line in the pulse propagation direction within a body under examination.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic example of the actual and desired mechanical pressure profiles along a scan line, and relative to the z axis parallel to the ultrasonic pulse propagation direction.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 3</figref> is a chart of mechanical pressure profiles, as desired, optimized and non optimized, relative to the penetration depth.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 4</figref> shows the curve of weights with reference to the individual transducers of the transducer array.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIGS. 5 to 8</figref> show charts of the original beam pattern and a pattern optimized at different transmit pulse penetration depths.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> shows a diagram of the geometry whereon receive beam forming is based.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> is a chart of the desired beam power pattern, relative to the u variable, which is defined as sin(θ)sin(θ<sub>0</sub>), such angles being defined in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 11</figref> shows the function for determining the amplitude weights relative to the individual transducers, as obtained by the optimization according to the present method.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 12</figref> shows a chart in which the desired beam power pattern is compared with the beam power pattern of the receive pulse, which is optimized with reference to the amplitude weights of the signal contributions of each receive transducer.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 13</figref> is a chart like that of <figref idref="DRAWINGS">FIG. 12</figref>, in which the beam power pattern of both the optimized signal and the original signal, which is not optimized with the method of the invention.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 14</figref> shows the envelope of the waveform that forms the received pulse, and is used in beam pattern calculation.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 15</figref> is a chart that shows the comparison between the angular resolution of the receive signal as optimized according to this invention and the receive signal as obtained from prior art.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DESCRIPTION OF THE EMBODIMENTS</heading>
<p id="p-0031" num="0030">The optimization goal for forming ultrasonic pulses is a compromise between the achievement of the best beam pattern and the achievement of the best mechanical pressure profile. Although there is not an exact mathematical solution, there certainly exists a best solution, wherein the energy function is minimized. Due to the considerable computational load required by the large number of variables, the optimal solution is obtained by using predictive or optimization algorithms of the stochastic or evolutionary type.</p>
<p id="p-0032" num="0031">Suitable algorithms for this application are genetic algorithms, e.g., the Tabu search, among others. A particular algorithm that provides effective results, i.e., a relatively fast convergence and solution stability, where slight parameter variations with respect to the best solution generate slight result variations, is the Simulated Annealing algorithm.</p>
<p id="p-0033" num="0032">This algorithm is described in “Genetic Algorithms in Search, Optimization and Machine Learning” by D. E. Goldberg, AddisonWesley, Reading, Mass., 1989, and in “Simulated Annealing: Theory and Applications” P.J.M. by van Laarhoven and E. H. L. Aarts, Kluwer Academic Publisher, Dordrecht, 1987. A description of the Tabu search is provided in “A user's guide to Tabu search” by F. Glover, E. Taillard, D. de Werra, published in Vol. 41 of Annals of Operations Research, printed in 1993 by J. C. Baltzer AG.</p>
<p id="p-0034" num="0033">The energy function may be expressed in various manners. In general terms, the energy function has the following general form:</p>
<p id="p-0035" num="0034">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <msubsup>
        <mo>∫</mo>
        <mi>z</mi>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
      </msubsup>
      <mo>⁢</mo>
      <mrow>
        <msup>
          <mrow>
            <mo>[</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>Pcal</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>W</mi>
                    <mo>,</mo>
                    <mi>τ</mi>
                    <mo>,</mo>
                    <mi>ω</mi>
                    <mo>,</mo>
                    <mi>z</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>P</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.2em" height="0.2ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mi>des</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>z</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>z</mi>
        </mrow>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <munder>
        <mrow>
          <msup>
            <mo>∫</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
          </msup>
          <mo>∫</mo>
        </mrow>
        <mi>x</mi>
      </munder>
      <mo>[</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>BPcal</mi>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>W</mi>
              <mo>,</mo>
              <mi>τ</mi>
              <mo>,</mo>
              <mi>ω</mi>
              <mo>,</mo>
              <mi>z</mi>
              <mo>,</mo>
              <mi>x</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
          <msup>
            <mrow>
              <mi>BPdes</mi>
              <mo>(</mo>
              <mrow>
                <mi>z</mi>
                <mo>,</mo>
                <mi>x</mi>
              </mrow>
              <mo>]</mo>
            </mrow>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <mrow>
            <mo>ⅆ</mo>
            <mi>x</mi>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>ⅆ</mo>
            <mi>z</mi>
          </mrow>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0036" num="0035">where:</p>
<p id="p-0037" num="0036">Pdes(z)is the function that describes the desired pressure profile at the different penetration depths along the propagation axis x of the ultrasonic pulse.</p>
<p id="p-0038" num="0037">Pcal<sub>i</sub>(W,τ,ω,z)is the function that describes the pressure profile as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization vector and at the different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector θ and the waveforms of the pulse contributions generated by the transducers θ.</p>
<p id="p-0039" num="0038">BPdes(z,x) is the function that describes the desired beam pattern at the different penetration depths along the ultrasonic beam propagation axis z.</p>
<p id="p-0040" num="0039">BPcal<sub>i</sub>(W,τ,ω,z) is the function that describes the beam pattern as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization vector and at the different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector θ and the waveforms of the pulse contributions generated by the transducers θ.</p>
<p id="p-0041" num="0040">Both the desired mechanical pressure profile and the desired beam pattern may be defined in numerical terms. Furthermore, the energy function may be easily discretized and integrals be transformed into a summation, by assuming a certain approximation error margin.</p>
<p id="p-0042" num="0041">The above function is a generally expressed energy function and may be slightly changed by using coefficients whereby the contributions to said function of the beam pattern optimization portion and of the mechanical pressure optimization portion, as represented by the corresponding integrals, may be further weighted.</p>
<p id="p-0043" num="0042">Regarding the ranges wherein the propagation depth variable z and the variable x, which is defined along an axis parallel to the transmission surface of the array of electroacoustic transducers may change, the variable z may obviously change in a range of interest which spans the ultrasonic pulse focusing depth, or in a range in which the focusing depth is one of the upper or lower limits or is close to one of said limits.</p>
<p id="p-0044" num="0043">Conversely, the variable x may be in a range that is equal to or larger than the whole extension of the transducer array along the x axis parallel to the transmit surface of said transducer array, or said range may be smaller than said extension of the transducer array along the x axis and of the same order of magnitude as a scan band corresponding to a few parallel and adjacent scan lines.</p>
<p id="p-0045" num="0044">It shall be noted that the energy function to be minimized describes an energy also in physical terms, as it represents the surface difference in a velocity range, which strengthens the adequateness of the above energy function.</p>
<p id="p-0046" num="0045">According to a further improvement, in the calculation of weights and possibly delays and/or waveforms of transducers' contributions, account is taken of the fact that, for instance, the attenuation of the ultrasonic pulse within the body or object under examination does not only depend on the physical characteristics of the signal, but also on the structure of the body which, e.g. in ultrasonic imaging applications may vary from one region to another due to the presence of different biological tissues, having different ultrasonic pulse absorption capacity. Signal attenuation occurs due to the geometry of the propagation condition, to an attenuation caused by tissue absorption, for instance in biomedical imaging and also due to the radiation pattern of each probe element.</p>
<p id="p-0047" num="0046">As is further detailed in the following description of an embodiment of the method, it was surprisingly found that the results derived from the generation of an ultrasonic pulse having a nearly constant mechanical pressure in the expected propagation depth range and a beam pattern with a narrow, scan-line centered main lobe and low side lobes, far from the main lobe, which pattern is constant with time, i.e. along the ultrasonic pulse propagation axis, are considerable even when using focusing delays like those conventionally in use in ultrasonic transducer arrays, such as ultrasonic probes, by generating transducers' contributions to the ultrasonic pulse which have the same waveform, of the conventional type, and by only using amplitude weights for said array transducers' contributions. Also, ultrasonic pulse attenuation hypotheses may be only limited to geometric attenuation during propagation.</p>
<p id="p-0048" num="0047">This provides a considerable simplification of the method as well as remarkable mechanical pressure and beam pattern improvements as compared with prior art, while reducing the computational load. In certain special cases, the method may be required to be carried out by contemplating all possible variables, i.e. in its most general and widest form.</p>
<p id="p-0049" num="0048">For optimization of receive pulses, the principles that were used for transmit pulses also apply. However, for reception, the waveform variable of the transducers' contributions to the ultrasonic pulse is irrelevant, as the receive contributions consist of the transmit contributions reflected by the structure of the material that forms the body or object being examined. The receive focusing delays may be also kept substantially identical to those conventionally in use for receive beam forming.</p>
<p id="p-0050" num="0049">For reception also, the only variable for optimization consists of the components of the weight vector.</p>
<p id="p-0051" num="0050">An improvement of the method according to this invention provides a further simplification of the combined transmit and receive optimization.</p>
<p id="p-0052" num="0051">Such improvement accounts for the fact that, in order to optimize the ultrasonic transmit pulse, mechanical pressure is particularly relevant, as it particularly exerts its action on contrast agents during transmission of the ultrasonic pulse whereas the provision of an ideal beam pattern or a beam pattern as close as possible to the ideal is not critical to image quality because reflection signal contributions from regions of the body under examination close to those along the focusing line or band can be removed or anyway drastically attenuated by acting on the optimization of reflection pulse reception by the electroacoustic transducers of the array. In fact, if receive ultrasound pulses are optimized by defining a weight vector according to the method of receive pulse beam pattern optimization and in the sense of obtaining a receive pulse having a narrow main lobe and far and low-amplitude side lobes, the contributions to the reflected signal due to reflections from regions of the body close to those along which focusing of the ultrasonic pulse from the side lobes of a transmit pulse having an acceptable but not optimal beam pattern are automatically removed or drastically attenuated. In ultrasonic imaging this has an effect on the image, which is not soiled, i.e. is free from artifacts and has a good side resolution. Conversely, pulse mechanical pressure optimization has no relevance because the mechanical pressure of the transmit pulse is certainly higher than that of the corresponding reflection pulse, hence any destruction effect of an excessive mechanical pressure, e.g. on contrast agent microbubbles, would already occur upon transmission of the ultrasonic pulse and during propagation thereof within the body under examination, whereby the reflected acoustic wave range has an insignificant effect or no effect at all.</p>
<p id="p-0053" num="0052">Thanks to this discovery, the optimization method of the invention may be further simplified, by providing a combined transmit and receive optimization wherein the amplitude weights of the individual pulse transducers' contributions are determined for only minimizing the mechanical pressure part of the energy function, i.e. the first integral of the above function, whereas, upon reception, amplitude weights are applied to the signals emitted from the transducers, which weights are determined by only minimizing the beam pattern part of the energy function, i.e. the second integral of the above energy function.</p>
<p id="p-0054" num="0053">In stricter terms, upon transmission the amplitude weights of individual electroacoustic transducers' contributions to the transmit pulse are determined by minimizing the following function:</p>
<p id="p-0055" num="0054">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msubsup>
      <mo>∫</mo>
      <mi>z</mi>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
    </msubsup>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>Pcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>z</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>P</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.2em" height="0.2ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>des</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>z</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>z</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0056" num="0055">whereas, upon reception, the amplitude weights of the individual electroacoustic transducers' contributions to the receive pulse are determined by minimizing the following function:</p>
<p id="p-0057" num="0056">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msup>
      <mrow>
        <msup>
          <munder>
            <mrow>
              <mo>∫</mo>
              <mo>∫</mo>
            </mrow>
            <mi>x</mi>
          </munder>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
        </msup>
        <mo>⁡</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <mi>BP</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <msub>
                  <mi>cal</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>W</mi>
                    <mo>,</mo>
                    <mi>τ</mi>
                    <mo>,</mo>
                    <mi>ω</mi>
                    <mo>,</mo>
                    <mi>z</mi>
                    <mo>,</mo>
                    <mi>x</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>BPdes</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>z</mi>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
      </mrow>
      <mn>2</mn>
    </msup>
    <mo>⁢</mo>
    <mrow>
      <mo>ⅆ</mo>
      <mi>x</mi>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <mo>ⅆ</mo>
      <mi>z</mi>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0058" num="0057">in which the beam patterns (designated as BP) are those related to ultrasonic pulse reception. As optimization of pulse waveforms is no longer possible upon reception, the variable θ was omitted from the energy function E.</p>
<p id="p-0059" num="0058">Once more, the possibility shall be considered of simplifying as much as possible the method by using, upon transmission, pulse contributions of transducers having the same waveform θ and by using, as transmit and receive delays, the delays θ that are commonly used for ultrasonic imaging, which allows to omit the variables θ, θ in the above equations, by replacing them with constants.</p>
<p id="p-0060" num="0059">Furthermore, thanks to the possibility of implementing, upon reception, the so-called dynamic focus technique, which maintains the focus of contributions from different depths, integration relative to the variable z is no longer required. In fact, the receive beam pattern as determined at a given depth can represent the beam patterns determined at other depths, which are approximated with a satisfactory precision. Therefore, the last equation can be further simplified as follows:</p>
<p id="p-0061" num="0060">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>W</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msubsup>
      <mo>∫</mo>
      <mi>x</mi>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
    </msubsup>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>BPcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <msub>
                    <mi>z</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>BP</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.2em" height="0.2ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>des</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <msub>
                      <mi>z</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>,</mo>
                    <mi>z</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>x</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0062" num="0061">Referring to the above equations, a great number of variants may be provided, which are all aimed at making the beam pattern or the pressure profile as close as possible to the desired ones, by optimization of the specified parameters. An exemplary, non limiting list of possible variants includes:</p>
<p id="p-0063" num="0062">(i) integration of the absolute values of differences instead of the squares of differences;</p>
<p id="p-0064" num="0063">(ii) integration of x and/or z variables over limited intervals to only consider, for instance, the main lobe or the side lobes;</p>
<p id="p-0065" num="0064">(iii) replacement of the desired pressure profile and/or the desired beam pattern with a constant, possibly null, which represents, for instance, average values over the integration interval being considered;</p>
<p id="p-0066" num="0065">(iv) integration of excess values, if any, resulting from the difference between what was actually obtained and what was desired, the latter term being assigned the meaning of maximum limit;</p>
<p id="p-0067" num="0066">(v) replacement of integral operators with different, possibly nonlinear, operators, such as a mean operator or a maximum value operator;</p>
<p id="p-0068" num="0067">(vi) integration carried out with respect to variables different from and direction/distance polar coordinates instead of the Cartesian coordinates x and z, or arbitrary variables (which are defined by using the sinus of the relevant angles), which provide an optimization that may apply to any steering angle of the scan line;</p>
<p id="p-0069" num="0068">(vii) any suitable combination of the above.</p>
<p id="p-0070" num="0069">For instance, with reference to the beam pattern, an energy function may be created that sums the integral of the square differences between obtained and desired values in the region of the side lobe, and the integral of the excess values with respect to a maximum level in the side lobe region. Otherwise, referring to the pressure profile, an energy function may be generated which accounts for pressure variance within the z interval being considered.</p>
<p id="p-0071" num="0070">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, the individual squares along the x axis represent the individual transducers of a transducer array. The z axis defines the propagation direction perpendicular to the transmitting surface of transducers. The delays θi, where i designates the ith transducer are first calculated as a function of focusing on a point Z<sub>0 </sub>along the z axis. In this embodiment, the propagation direction is parallel to the x axis, hence the other directional parameter, i.e. the theta angle is zero. In order to determine the pressure in the general point Z*, in addition to the delays associated to a purely geometric function which determines focusing on said point Z<sub>0</sub>, account shall be further taken of the propagation time to reach the point Z*, in this case on the z axis.</p>
<p id="p-0072" num="0071">In the experiment whose results are shown hereafter, the delay determination function is generally known and widely used in ultrasonic imaging apparatuses and is not further changed for optimization.</p>
<p id="p-0073" num="0072">The experiment was carried out by using an ESAOTE PILA 532 probe. The latter is a Linear array <b>128</b> transducer array. The transmission carrier frequency is of 5.56 MHz, the mechanical focus of the probe is 25 mm and the pitch is of 0.245 mm.</p>
<p id="p-0074" num="0073">For transmission an energy function was defined, from whose minimization an amplitude weight was determined for each transducer's contribution to the comprehensive transmit pulse.</p>
<p id="p-0075" num="0074">The energy function that was used is as follows:</p>
<p id="p-0076" num="0075">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msubsup>
      <mo>∫</mo>
      <mi>z</mi>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
    </msubsup>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>Pcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>z</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>P</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.2em" height="0.2ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>des</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>z</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>z</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0077" num="0076">where Pdes(z) is the function that describes the desired pressure profile at the different penetration depths along the propagation axis x of the ultrasonic pulse.</p>
<p id="p-0078" num="0077">Pcal<sub>i</sub>(W,τ,ω,z) is the function that describes the pressure profile as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization vector and at the different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector, the delay vector θ and the waveforms of the pulse contributions generated by the transducers θ.</p>
<p id="p-0079" num="0078">Minimization was carried out by using a known stochastic algorithm known as Simulated Annealing whereof detailed sources are indicated above.</p>
<p id="p-0080" num="0079">For the determination of weights, the geometric attenuation of the transmit pulse was only considered, whereas attenuations caused by the structure of the material of the body under examination and by the radiation patterns of the different elements of the probe being used were not accounted for.</p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 2</figref> shows a hypothetical comparison between the mechanical pressure profile as generated by the non optimized pulse and relative to the pulse penetration depth within the body under examination along the z axis and the desired mechanical pressure profile within the region of interest along the z axis, i.e. between two different penetration depths.</p>
<p id="p-0082" num="0081"><figref idref="DRAWINGS">FIG. 3</figref> is a chart that shows the comparison between desired, optimized and experimental, i.e. non optimized mechanical pressures. Note that the mechanical pressure of the transmit pulse is substantially constant and coincident with the desired pressure within the penetration depth range of interest.</p>
<p id="p-0083" num="0082"><figref idref="DRAWINGS">FIG. 4</figref> shows the amplitude weights as determined by minimizing the above energy function, relative to the corresponding transducers of the array.</p>
<p id="p-0084" num="0083">In this experiment, both the waveforms of the contributions of transducers to the pulse and the conventionally determined delays were considered as constant and the only variable to be determined by minimizing the energy function was the vector of amplitude weights for said pulse contributions of the individual transducers to the ultrasonic pulse.</p>
<p id="p-0085" num="0084">While optimization did not account for the ultrasonic pulse beam pattern in the energy function, but only for the mechanical pressure in the penetration depth range of interest, <figref idref="DRAWINGS">FIGS. 5 to 8</figref> show the beam pattern at different penetration depths within the body under examination both for the optimized pulse and for the experimental pulse, i.e. provided by the probe in normal conditions, with no optimization according to the inventive method.</p>
<p id="p-0086" num="0085">The results were tested for stability against perturbation of weights or pulse features. Such analysis was carried out while perturbing the system with several different types of noise. The optimization as obtained with the inventive method was found to be stable, in that slight perturbations only generated slight or little variations of mechanical pressure and/or beam pattern characteristics, as compared with optimized, non perturbed ones.</p>
<p id="p-0087" num="0086"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic view of the condition of an array of transducers in the case of receive beam forming, i.e. the geometric conditions which lead to the determination of receive delays.</p>
<p id="p-0088" num="0087">The hypothesis is that of a broad band, far field beam forming; this hypothesis is widely acceptable because, although medical ultrasonic imaging acts in near field regions, the well known dynamic focusing technique allows to work, all over the region under examination, in conditions that are very close to typical far field conditions. In the Figure the following symbols designate: θ<sub>0</sub>: the steering direction; v<sub>0</sub>: the steering unit vector; θ: the arrival direction; v: the arrival unit vector; d: the distance between elements (pitch); 1, 2 . . . i, . . . , M: the sensors of the array.</p>
<p id="p-0089" num="0088">In the far field hypothesis, the whole Beam Pattern (BP) formulation may be made with respect to the independent variable u, which is defined as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>=sin(θ)−sin(θ<sub>0</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0090" num="0089">Therefore, in the following charts, the beam pattern profiles will be always indicated with reference to the above u variable.</p>
<p id="p-0091" num="0090">The experiment was carried out by using an ESAOTE PA230e probe. The PA230e probe is a Phased array <b>128</b> transducer probe. It has a carrier frequency of 2.5 MHz, a 100 mm mechanical focus, a pitch of 0.17 mm; Upon transmission it has a 90 mm focus (depth), and a Focal Number of 1.5.</p>
<p id="p-0092" num="0091">Referring to the above, constant delays were used, i.e. those well known in ultrasonic imaging. Waveforms have no influence upon reception, as mentioned above. Therefore, optimization was carried out with the aim of determining the vector of the amplitude weights that provide a minimum of the following energy function:</p>
<p id="p-0093" num="0092">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>W</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mo>∫</mo>
      <mi>u</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>BPcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>u</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>BPdes</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>u</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>u</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0094" num="0093">where:</p>
<p id="p-0095" num="0094">BPdes(u) is the function that describes the desired beam pattern as a function of said arbitrary variable u, whose possible values are of −2 to +2, which allows to account for all possible steering angles. In this case, integration was carried out for u values of 0 to 1.2.</p>
<p id="p-0096" num="0095">BPcal<sub>i</sub>(W,τ,ω,u)is the function that describes the beam pattern that was calculated on the basis of the weight vector, the delay vector and the waveform vector, at the ith iteration of the minimization algorithm and as a function of said arbitrary variable u.</p>
<p id="p-0097" num="0096">Receive optimization was carried out by only considering the beam pattern of the received pulse, and not the mechanical pressure thereof. This is possible because mechanical pressure substantially affects the material structure of the body under examination during transmission only.</p>
<p id="p-0098" num="0097">On the other hand, beam pattern optimization has the purpose of ensuring an optimal side resolution and of suppressing the artifacts caused by signals reflected by regions of the body under examination adjacent to pulse focusing regions, which are mainly due to the presence of side lobes that are too enhanced and/or close to the main lobe of the pulse.</p>
<p id="p-0099" num="0098">Here, optimization may be effected on reception, and not only on transmission. In fact, beamforming, which may be considered as a spatial filter, allows to isolate the echoes backscattered from the scene in the steering direction θ<sub>0</sub>, from all echoes received from all possible directions θ.</p>
<p id="p-0100" num="0099">Therefore, this technique allows to suppress or drastically attenuate the signal contributions associated to side lobes.</p>
<p id="p-0101" num="0100"><figref idref="DRAWINGS">FIG. 10</figref> is a chart of the desired beam pattern setting function.</p>
<p id="p-0102" num="0101">By minimizing the above energy function, an amplitude weight vector is obtained, for the signal contributions of each transducer to the comprehensive receive signal, which are designated in the chart of <figref idref="DRAWINGS">FIG. 11</figref>.</p>
<p id="p-0103" num="0102"><figref idref="DRAWINGS">FIG. 12</figref> shows the result of the beam pattern, as optimized by using the weights as shown in <figref idref="DRAWINGS">FIG. 11</figref>, which were determined by the inventive method, and in comparison with the desired beam pattern.</p>
<p id="p-0104" num="0103"><figref idref="DRAWINGS">FIG. 13</figref> shows, like <figref idref="DRAWINGS">FIG. 12</figref>, the optimized beam pattern as compared with the original beam pattern of the probe, that was obtained in normal conditions of use according to prior art.</p>
<p id="p-0105" num="0104">The figures only show one half of the beam pattern and further conveniently represent a dB standardized beam power pattern relative to the above defined u variable.</p>
<p id="p-0106" num="0105">It shall be noted that no optimization was effected for the transmit pulse generated according to prior art. <figref idref="DRAWINGS">FIG. 14</figref> shows the envelope of the transmit pulse.</p>
<p id="p-0107" num="0106"><figref idref="DRAWINGS">FIG. 15</figref> further shows the considerable angular resolution improvement that was obtained by the receive pulse optimization according to the method of the present invention as compared with that obtained with the same probe used in the prior art modes.</p>
<p id="p-0108" num="0107">The above clearly shows that the optimization according to the method of this invention also provides an optimal mechanical pressure of the transmit pulse, i.e. a constant pressure in a predetermined penetration depth range, which allows treatment of contrast agents, and prevents unexpected local peaks at depths different from the focusing depth, which might otherwise cause an at least partial destruction of contrast agent microbubbles and provide a beam pattern that ensures an optimal angular resolution and a reduced production of image artifacts. Even in its simplest form, wherein the transmit pulse is optimized by an appropriate amplitude weight vector for the contributions of the transducers to the comprehensive pulse, only for obtaining an optimal mechanical pressure, and wherein, on reception, the signal is optimized, still by an appropriate amplitude weight vector for the contributions of the transducers to the comprehensive signal only for obtaining an optimal beam pattern, the experimental results show that, as compared with prior art, better pressure profiles are obtained, as well as an effective reduction of artifacts and a better angular resolution.</p>
<p id="p-0109" num="0108">Therefore, the simplified form of the inventive method allows to improve ultrasonic imaging performances while reducing the computational load required for determining the optimization weights.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07297117-20071120-M00001.NB">
<img id="EMI-M00001" he="15.92mm" wi="76.20mm" file="US07297117-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07297117-20071120-M00002.NB">
<img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07297117-20071120-M00003.NB">
<img id="EMI-M00003" he="8.81mm" wi="76.20mm" file="US07297117-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07297117-20071120-M00004.NB">
<img id="EMI-M00004" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07297117-20071120-M00005.NB">
<img id="EMI-M00005" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07297117-20071120-M00006.NB">
<img id="EMI-M00006" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07297117-20071120-M00007.NB">
<img id="EMI-M00007" he="13.80mm" wi="76.20mm" file="US07297117-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07297117-20071120-M00008.NB">
<img id="EMI-M00008" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07297117-20071120-M00009.NB">
<img id="EMI-M00009" he="8.47mm" wi="76.20mm" file="US07297117-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07297117-20071120-M00010.NB">
<img id="EMI-M00010" he="13.80mm" wi="76.20mm" file="US07297117-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07297117-20071120-M00011.NB">
<img id="EMI-M00011" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07297117-20071120-M00012.NB">
<img id="EMI-M00012" he="6.69mm" wi="76.20mm" file="US07297117-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of ultrasonic imaging comprising the step of optimizing one or more ultrasonic pulses in conjunction with ultrasonic imaging, wherein transmit pulses are generated from ultrasonic pulse contributions of each of a plurality of electroacoustic transducers, said transducers being grouped in an array and being individually triggered by electric excitation signals, said excitation signal being applied to each individual transducer of said array having a predetermined delay with respect to the application of the excitation signal that is applied to the other transducers of said plurality of transducers, and wherein a weight is applied to the excitation signal for each transducer for adjusting the amplitude of said excitation signal, characterized in the following steps:
<claim-text>defining an optimal desired mechanical pressure profile for said transmit pulses relative to the penetration depth of said transmit pulses within the body or object being examined as a function of at least amplitude weighting parameters for said transducers' contributions to said transmit pulses, and of the delays of excitation for transmission of individual pulse contributions of transducers, aimed at focusing comprehensive pulses on a scan line or band and at a certain penetration depth within the body or object under examination;</claim-text>
<claim-text>defining an ideal beam pattern for said transmit pulses relative to the propagation time or penetration depth within the body or object under examination as a function of at least amplitude weighting parameters for said transducers' contributions to said transmit pulses, and of delays of excitation delays for transmission of individual pulse contributions of transducers aimed at focusing comprehensive pulses on a scan line or band and at a certain penetration depth within the body or object under examination;</claim-text>
<claim-text>defining an energy function which depends on the difference between said ideal pressure profile and the actual pressure profile and between said ideal beam pattern and the actual beam pattern;</claim-text>
<claim-text>determining the minimum of said energy function;</claim-text>
<claim-text>determining said weighting parameters and said delays which correspond to the minimum of the energy function and applying said weighting parameters and said delays to said excitation signals for exciting said transducers to generate said comprehensive pulses.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that a further optimization variable for said transducers' pulse contributions is provided that forms said comprehensive pulses, which variable is the waveform of the pulse contribution generated by each transducer, that may be equal to or different from one transducer to the other.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that said energy function has the following general form:</claim-text>
<claim-text>
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <msub>
        <mo>∫</mo>
        <mi>z</mi>
      </msub>
      <mo>⁢</mo>
      <mrow>
        <msup>
          <mrow>
            <mo>[</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>Pcal</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.2em" height="0.2ex"/>
                </mstyle>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>z</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>Pdes</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>z</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>z</mi>
        </mrow>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <msub>
        <mo>∫</mo>
        <mi>x</mi>
      </msub>
      <mo>⁢</mo>
      <mrow>
        <mo>∫</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>BPcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>z</mi>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <msup>
                <mrow>
                  <mi>BPdes</mi>
                  <mo>(</mo>
                  <mrow>
                    <mi>z</mi>
                    <mo>,</mo>
                    <mi>x</mi>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mn>2</mn>
              </msup>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.2em" height="0.2ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mo>ⅆ</mo>
                <mi>x</mi>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <mo>ⅆ</mo>
                <mi>z</mi>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>where:
<claim-text>Pdes(z) is the function that describes the desired pressure profile at the different penetration depths along the propagation axis x of the ultrasonic pulse,</claim-text>
<claim-text>Pcal<sub>i</sub>(W,τ,ω,z) is the function that describes the pressure profile as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization rector and at different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector τ and the waveforms of the pulse contributions generated by the transducers at ω/;</claim-text>
<claim-text>BPdes(z,x) is the function that describes the desired beam pattern at the different penetration depths along the ultrasonic pulse propagation axis z relative to the weight vector W, the delay vector τ and the waveforms off the pulse contributions generated by the transducers ω/;</claim-text>
<claim-text>BPcal<sub>i</sub>(W,τ,ω,z,x) is the function that describes the beam pattern as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization vector and at the different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector τ and the waveforms of the pulse contributions generated by the transducers ω.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is discretized and integrals are transformed into a summation by assuming a certain approximation error margin.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method as claimed in <claim-ref idref="CLM-00004">claim 4</claim-ref>, characterized in that said two integrals of said energy function or the equivalent summations are multiplied by a weighting coefficient.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said variable z may obviously change in a range of interest which spans the ultrasonic pulse focusing depth, or in a range in which the focusing depth is one of the upper or lower limits or is close to one of said limits whereas said variable x may be in a range that is equal to or larger than the whole extension of the transducer array along the x axis parallel to the transmit surface of said transducer array, or said range may be smaller than said extension of the transducer array along the x axis and of the same order of magnitude as a scan band corresponding to a few parallel and adjacent scan lines.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include integration of the absolute values of differences, instead of the squared of the differences Pcal<sub>i</sub>-Pdes and/or BPcal<sub>i</sub>-Bpdes.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include integration of the variables x and/or z upon limited intervals, to only consider one of said the main lobe or said side lobes.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include the replacement of the desired pressure profile Pdes and/or the desired beam pattern BPdes with a constant.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A method as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said constant may be null.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A method as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, characterized in that said constant replaced in lieu of the desired profile pressure and/or the desired beam pattern BPdes corresponds to the average value of the desired pressure profile Pdes and/or the desired beam pattern BPdes over the integration interval being considered.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A method as claimed in claimed <b>3</b>, characterized in that said energy function is modified in such manner as to include integration of any excess values of what was actually obtained with respect to what was desired.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include replacement of the integral operator with a different operator.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method as claimed in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein said different operator is a nonlinear operator.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method as claimed in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein said different operator is a mean operator.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A method as claimed in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein said different operator is a maximum value operator.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include an integration carried out with respect to polar coordinate variables.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include an intergration carried out with respect to arbitrary variables, thereby proving an optimization that may apply to any steering angle of said scan line.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A method as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, characterized in that said energy function is modified in such a manner as to include one or more of integration of the absolute values of differences; integration of the variables x and/or z upon limited intervals; the replacement of the desired pressure profile Pdes and/or the desired beam pattern Bpdes with a constant, wherein said constant may be null or may correspond to the average value of the desired pressure profile Pdes and/or the desired beam pattern BPdes over the integration interval being considered; integration of any excess values of what was actually obtained with respect to what was desired; replacement of the integral operator with a different operator, wherein said different operator is a nonlinear operator or a mean operator or a maximum value operator; an integration carried out with respect to polar coordinate variables; or an integration carried out with respect to arbitrary variables.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. A method as claimed in <claim-ref idref="CLM-00019">claim 19</claim-ref>, characterized in that said energy function is modified in such a manner as to include, for beam pattern optimization, a function that sums the integral of the square differences between obtained BPcal and desired Bpdes in the region of the side lobe, and the integral of the excess values with respect to a maximum level in the side lobe region.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A method as claimed in <claim-ref idref="CLM-00019">claim 19</claim-ref>, characterized in that said energy function is modified in such a manner as to include, for pressure profile optimization, a function that considers pressure variance along the z axis.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that, as transducer excitation delays, typical ultrasonic pulse focusing delays may be used, which are constant in the energy function.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that, for all transducers, identical waveforms of respective contributions to said comprehensive pulses are defined.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that the minimization of said energy function is executed by using a stochastic algorithm or an evolutionary algorithm.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. A method as claimed in <claim-ref idref="CLM-00024">claim 24</claim-ref>, characterized in that minimization is executed by using a genetic algorithm.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. A method as claimed in <claim-ref idref="CLM-00024">claim 24</claim-ref>, characterized in that minimization is executed by using an algorithm named Simulated Annealing.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. A method as claimed in <claim-ref idref="CLM-00024">claim 24</claim-ref>, characterized in that minimization is executed by using an algorithm named Tabu search.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that it provides a combined transmit and receive optimization wherein amplitude weights of the individual pulse transducers' contributions are determined for only minimizing the mechanical pressure part of the energy function, whereas, upon reception, amplitude weights are applied to the signals emitted from the transducers, which weights are determined by only minimizing the beam pattern part of the energy function.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. A method as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, characterized in that, during transmission, the transmit pulse is optimized by minimization of the following function:</claim-text>
<claim-text>
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mo>∫</mo>
      <mi>z</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>Pcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.2em" height="0.2ex"/>
              </mstyle>
              <mo>(</mo>
              <mrow>
                <mi>W</mi>
                <mo>,</mo>
                <mi>τ</mi>
                <mo>,</mo>
                <mi>ω</mi>
                <mo>,</mo>
                <mi>z</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>Pdes</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>z</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>z</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>whereas, upon reception, the receive pulse is optimized by minimizing the following function:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msup>
      <munder>
        <mrow>
          <mo>∫</mo>
          <mo>∫</mo>
        </mrow>
        <mi>x</mi>
      </munder>
      <mstyle>
        <mspace width="0.3em" height="0.3ex"/>
      </mstyle>
    </msup>
    <mo>[</mo>
    <mrow>
      <mrow>
        <mi>B</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>P</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mrow>
              <mi>ca</mi>
              <mo>⁢</mo>
              <mi>l</mi>
            </mrow>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>W</mi>
              <mo>,</mo>
              <mi>τ</mi>
              <mo>,</mo>
              <mi>ω</mi>
              <mo>,</mo>
              <mi>z</mi>
              <mo>,</mo>
              <mi>x</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
        <mi>B</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>P</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.2em" height="0.2ex"/>
        </mstyle>
        <mo>⁢</mo>
        <msup>
          <mrow>
            <mi>des</mi>
            <mo>(</mo>
            <mrow>
              <mi>z</mi>
              <mo>,</mo>
              <mi>x</mi>
            </mrow>
            <mo>]</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>x</mi>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>z</mi>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. A method as claimed in <claim-ref idref="CLM-00029">claim 29</claim-ref>, characterized in that the delays and/or waveforms are defined as constant whereas the transmit and/or receive optimization include the calculation of amplitude weights for individual transducers' contributions to the comprehensive transmit pulse and/or for individual transducers' contributions to the receive signal.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. A method of ultrasonic imaging comprising the step of optimizing one or more ultrasonic pulses in conjunction with ultrasonic imaging, wherein receive pulses are generated from ultrasonic pulse contributions of each of a plurality of electroacoustic transducers, said transducers being grouped in an array and being individually triggered by electric excitation signals, said excitation signal being applied to each individual transducer of said array having a predetermined delay with respect to the application of the excitation signal that is applied to the other transducers of said plurality of transducers, and wherein a weight is applied to the excitation signal for each transducer for adjusting the amplitude of said excitation signal, characterized in the following steps:
<claim-text>defining an optimal desired mechanical pressure profile for said receive pulses relative to the penetration depth of said receive pulses within the body or object being examined as a function of at least amplitude weighting parameters for said transducers' contributions to said receive pulses, and of the delays of excitation for reception of individual pulse contributions of transducers, aimed at focusing comprehensive pulses on a scan line or band and at a certain penetration depth within the body or object under examination;</claim-text>
<claim-text>defining an ideal beam pattern for said receive pulses relative to the propagation time or penetration depth within the body or object under examination as a function of at least amplitude weighting parameters for said transducers' contributions to said receive pulses, and of delays of excitation delays for reception of individual pulse contributions of transducers aimed at focusing comprehensive pulses on a scan line or band and at a certain penetration depth within the body or object under examination;</claim-text>
<claim-text>defining an energy function which depends on the difference between said ideal pressure profile and the actual pressure profile and between said ideal beam pattern and the actual beam pattern;</claim-text>
<claim-text>determining the minimum of said energy function;</claim-text>
<claim-text>determining said weighting parameters and said delays which correspond to the minimum of the energy function and applying said weighting parameters and said delays to said excitation signals for exciting said transducers to generate said comprehensive pulses.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that a further optimization variable for said transducers' pulse contributions is provided that forms said comprehensive pulses, which variable is the waveform of the pulse contribution generated by each transducer, that may be equal to or different from one transducer to the other.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that said energy function has the following general form:</claim-text>
<claim-text>
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>W</mi>
        <mo>,</mo>
        <mi>τ</mi>
        <mo>,</mo>
        <mi>ω</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <msub>
        <mo>∫</mo>
        <mi>z</mi>
      </msub>
      <mo>⁢</mo>
      <mrow>
        <msup>
          <mrow>
            <mo>[</mo>
            <mrow>
              <mrow>
                <msub>
                  <mi>Pcal</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.2em" height="0.2ex"/>
                </mstyle>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>z</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
              <mo>-</mo>
              <mrow>
                <mi>Pdes</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>z</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>]</mo>
          </mrow>
          <mn>2</mn>
        </msup>
        <mo>⁢</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>z</mi>
        </mrow>
      </mrow>
    </mrow>
    <mo>+</mo>
    <mrow>
      <msub>
        <mo>∫</mo>
        <mi>x</mi>
      </msub>
      <mo>⁢</mo>
      <mrow>
        <mo>∫</mo>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>BPcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>z</mi>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <msup>
                <mrow>
                  <mi>BPdes</mi>
                  <mo>(</mo>
                  <mrow>
                    <mi>z</mi>
                    <mo>,</mo>
                    <mi>x</mi>
                  </mrow>
                  <mo>]</mo>
                </mrow>
                <mn>2</mn>
              </msup>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.2em" height="0.2ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mo>ⅆ</mo>
                <mi>x</mi>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <mo>ⅆ</mo>
                <mi>z</mi>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>where
<claim-text>Pdes(z) is the function that describes the desired pressure profile at the different penetration depths along the propagcation axis x of the ultrasonic pulse,</claim-text>
<claim-text>Pcal<sub>i</sub>(W,τ,ω,z) is the function that describes the pressure profile as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization vector and at different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector τ and the waveforms of the pulse contributions generated by the transducers ω/;</claim-text>
<claim-text>BPdes(z,x) is the function that describes the desired beam pattern at the different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector τ and the waveforms of the pulse contributions generated by the transducers ω/;</claim-text>
<claim-text>BPcal<sub>i</sub>(W,τ,ω,z,x) is the function that describes the beam pattern as determined from the weight vector, the delay vector and the waveform vector at the ith iteration of the minimization vector and at the different penetration depths along the ultrasonic pulse propagation axis z, relative to the weight vector W, the delay vector τ and the waveforms of the pulse contributions generated by the transducers ω.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is discretized and integrals are transformed into a summation by assuming a certain approximation error margin.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. A method as claimed in <claim-ref idref="CLM-00034">claim 34</claim-ref>, characterized in that said two integrals of said energy function or the equivalent summations are multiplied by a weighting coefficient.</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said variable z may obviously change in a range of interest which spans the ultrasonic pulse focusing depth, or in a range in which the focusing depth is one of the upper or lower limits or is close to one of said limits whereas said variable x may be in a range that is equal to or larger than the whole extension of the transducer array along the x axis parallel to the transmit surface of said transducer array, or said range may be smaller than said extension of the transducer array along the x axis and of the same order of magnitude as a scan band corresponding to a few parallel and adjacent scan lines.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include integration of the absolute values of differences, instead of the squared of the differences Pcal<sub>i</sub>-Pdes and/or BPcal<sub>i</sub>-Bpdes.</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include integration of the variables x and/or z upon limited intervals, to only consider one of said the main lobe or said side lobes.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include the replacement of the desired pressure profile Pdes and/or the desired beam pattern BPdes with a constant.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. A method as claimed in <claim-ref idref="CLM-00039">claim 39</claim-ref>, wherein said constant may be null.</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. A method as claimed in <claim-ref idref="CLM-00039">claim 39</claim-ref>, characterized in that said constant replaced in lieu of the desired profile pressure and/or the desired beam pattern BPdes corresponds to the average value of the desired pressure profile Pdes and/or the desired beam pattern BPdes over the integration interval being considered.</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. A method as claimed in claimed <b>33</b>, characterized in that said energy function is modified in such manner as to include integration of any excess values of what was actually obtained with respect to what was desired.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include replacement of the integral operator with a different operator.</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. A method as claimed in <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein said different operator is a nonlinear operator.</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. A method as claimed in <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein said different operator is a mean operator.</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. A method as claimed in <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein said different operator is a maximum value operator.</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include an integration carried out with respect to polar coordinate variables.</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include an integration carried out with respect to arbitrary variables, thereby proving an optimization that may apply to any steering angle of said scan line.</claim-text>
</claim>
<claim id="CLM-00049" num="00049">
<claim-text>49. A method as claimed in <claim-ref idref="CLM-00033">claim 33</claim-ref>, characterized in that said energy function is modified in such a manner as to include one or more of integration of the absolute values of differences; integration of the variables x and/or z upon limited intervals; the replacement of the desired pressure profile Pdes and/or the desired beam pattern BPdes with a constant, wherein said constant may be null or may correspond to the average value of the desired pressure profile Pdes and/or the desired beam pattern Bpdes over the integration interval being considered; integration of any excess values of what was actually obtained with respect to what was desired; replacement of the integral operator with a different operator, wherein said different operator is a nonlinear operator or a mean operator or a maximum value operator; an integration carried out with respect to polar coordinate variables; or an integration carried out with respect to arbitrary variables.</claim-text>
</claim>
<claim id="CLM-00050" num="00050">
<claim-text>50. A method as claimed in <claim-ref idref="CLM-00049">claim 49</claim-ref>, characterized in that said energy function is modified in such a manner as to include, for beam pattern optimization, a function that sums the integral of the square differences between obtained Bpcal and desired Bpdes in the region of the side lobe, and the integral of the excess values with respect to a maximum level in the side lobe region.</claim-text>
</claim>
<claim id="CLM-00051" num="00051">
<claim-text>51. A method as claimed in <claim-ref idref="CLM-00049">claim 49</claim-ref>, characterized in that said energy function is modified in such a manner as to include, for pressure profile optimization, a function that considers pressure variance along the z axis.</claim-text>
</claim>
<claim id="CLM-00052" num="00052">
<claim-text>52. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that, as transducer excitation delays, typical ultrasonic pulse focusing delays may be used, which are constant in the energy function.</claim-text>
</claim>
<claim id="CLM-00053" num="00053">
<claim-text>53. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that, for all transducers, identical waveforms of respective contributions to said comprehensive pulses are defined.</claim-text>
</claim>
<claim id="CLM-00054" num="00054">
<claim-text>54. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that the minimization of said energy function is executed by using a stochastic algorithm or an evolutionary algorithm.</claim-text>
</claim>
<claim id="CLM-00055" num="00055">
<claim-text>55. A method as claimed in <claim-ref idref="CLM-00054">claim 54</claim-ref>, characterized in that minimization is executed by using a genetic algorithm.</claim-text>
</claim>
<claim id="CLM-00056" num="00056">
<claim-text>56. A method as claimed in <claim-ref idref="CLM-00054">claim 54</claim-ref>, characterized in that minimization is executed by using an algorithm named Simulated Annealing.</claim-text>
</claim>
<claim id="CLM-00057" num="00057">
<claim-text>57. A method as claimed in <claim-ref idref="CLM-00054">claim 54</claim-ref>, characterized in that minimization is executed by using an algorithm, named Tabu search.</claim-text>
</claim>
<claim id="CLM-00058" num="00058">
<claim-text>58. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that it provides a combined transmit and receive optimization wherein amplitude weights of the individual pulse transducers' contributions are determined for only minimizing the mechanical pressure part of the energy function, whereas, upon reception, amplitude weights are applied to the signals emitted from the transducers, which weights are determined by only minimizing the beam pattern part of the energy function.</claim-text>
</claim>
<claim id="CLM-00059" num="00059">
<claim-text>59. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that receive optimization is performed by minimizing the following energy function:</claim-text>
<claim-text>
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>W</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mo>∫</mo>
      <mi>x</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>BPcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <msub>
                    <mi>z</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <mi>x</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>BPdes</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <msub>
                    <mi>z</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <mi>z</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>x</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<claim-text>the so-called dynamic focus technique being applied upon reception, to maintain the focus of contributions from different depths.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00060" num="00060">
<claim-text>60. A method as claimed in <claim-ref idref="CLM-00031">claim 31</claim-ref>, characterized in that receive optimization is performed by minimizing the following energy function:</claim-text>
<claim-text>
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>W</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mo>∫</mo>
      <mi>u</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <msup>
        <mrow>
          <mo>[</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>BPcal</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>W</mi>
                  <mo>,</mo>
                  <mi>τ</mi>
                  <mo>,</mo>
                  <mi>ω</mi>
                  <mo>,</mo>
                  <mi>u</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mi>BPdes</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>u</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>]</mo>
        </mrow>
        <mn>2</mn>
      </msup>
      <mo>⁢</mo>
      <mrow>
        <mo>ⅆ</mo>
        <mi>u</mi>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>where:
<claim-text>BPdes(u) is the function that describes the desired beam pattern as a function of an arbitrary variable u, whose possible values are of −2 to +2;</claim-text>
<claim-text>is the function that describes the beam pattern BPcal<sub>i</sub>(W,τ,ω,z) that was calculated on the basis of the weight vector, the delay vector and the waveform vector, at the ith iteration of the minimization algorithm and as a function of said arbitrary variable u;</claim-text>
<claim-text>and where the arbitrary variable u is defined as:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>u</i>=sin(θ)−sin (θ<sub>0</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
</claim-text>
<claim-text>where θ<sub>0 </sub>is the steering direction; and θ is the arrival direction.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
