<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298296-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298296</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11469853</doc-number>
<date>20060902</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>M</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>341 61</main-classification>
<further-classification>341123</further-classification>
</classification-national>
<invention-title id="d0e43">Real-time sample rate converter having a non-polynomial convolution kernel</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5497152</doc-number>
<kind>A</kind>
<name>Wilson et al.</name>
<date>19960300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 61</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5666299</doc-number>
<kind>A</kind>
<name>Adams et al.</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6141671</doc-number>
<kind>A</kind>
<name>Adams et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708313</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6208671</doc-number>
<kind>B1</kind>
<name>Paulos et al.</name>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6215423</doc-number>
<kind>B1</kind>
<name>May et al.</name>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 61</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6411225</doc-number>
<kind>B1</kind>
<name>Van Den Enden et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6535553</doc-number>
<kind>B1</kind>
<name>Limberg et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375232</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6590510</doc-number>
<kind>B2</kind>
<name>Woog</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6747858</doc-number>
<kind>B1</kind>
<name>Sculley et al.</name>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6928196</doc-number>
<kind>B1</kind>
<name>Bradley et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382300</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7233268</doc-number>
<kind>B1</kind>
<name>Lin et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 61</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>2004/0044715</doc-number>
<kind>A1</kind>
<name>Aldroubi et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>708490</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>2004/0056785</doc-number>
<kind>A1</kind>
<name>Webster et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>341 61</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>24</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>341 61</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>341123</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kamath</last-name>
<first-name>Gautham Devendra</first-name>
<address>
<city>Austin</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Harris</last-name>
<first-name>Andrew M.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>Mitch Harris, Atty at Law, LLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Cirrus Logic, Inc.</orgname>
<role>02</role>
<address>
<city>Austin</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Nguyen</last-name>
<first-name>Linh</first-name>
<department>2819</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A real-time sample rate converter having a non-polynomial convolution kernel provides reduction in die area and power for performing sample rate conversion in real-time. A non-polynomial convolution kernel, which may be a gaussian operator, is used to determine output sample values from values of an incoming stream of values. If the input sample rate is higher than the output sample rate, the input sample stream is convolved with the gaussian kernel and then decimated to yield the output stream. If the input sample rate is lower than the output sample rate, the input stream is resampled to a small multiple of the output sample rate and convolved with the gaussian kernel to produce the output sample stream directly.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="75.35mm" wi="189.99mm" file="US07298296-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="194.48mm" wi="114.89mm" orientation="landscape" file="US07298296-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="188.38mm" wi="120.31mm" orientation="landscape" file="US07298296-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="193.80mm" wi="119.63mm" orientation="landscape" file="US07298296-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="207.86mm" wi="110.41mm" orientation="landscape" file="US07298296-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="223.77mm" wi="140.38mm" file="US07298296-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="185.34mm" wi="113.11mm" file="US07298296-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates generally to digital audio and audio-video systems, and more specifically, to a real-time sample rate converter and method that use non-linear and non-polynomial convolution coefficient operation to perform the conversion.</p>
<p id="p-0004" num="0003">2. Background of the Invention</p>
<p id="p-0005" num="0004">Real-time sample rate converters and sample rate conversion algorithms are pervasive in digital audio and digital audio-video (AV) systems. Frequently, the playback digital audio sample rate of an audio reproduction system or storage system does not match the digital audio sample rate of a pre-recorded program, and the audio data must be converted to the required sample rate before playback and/or storage. The ratio between the source sample rate and the desired sample rate may be irrational and/or time-varying, requiring what is known as asynchronous sample rate conversion. The ratio may also not be known in advance, requiring adaptability over a range of sampling rates and sampling rate ratios.</p>
<p id="p-0006" num="0005">Sample rate converters perform conversion of the sample rate by calculating the value of each sample at the new rate from the values surrounding each new-rate sample in time from the source audio stream. The simplest form of sample rate conversion is linear interpolation that locates the new sample value on a line projected between the two source audio samples that immediately surround the calculated value in time. Such interpolation has a large amount of harmonic distortion due to error between the calculated value and the actual value.</p>
<p id="p-0007" num="0006">Audio program information is typically very non-linear and can be generally viewed as a waveform comprising multiple superimposed sinusoids of differing frequencies. Therefore, higher-order polynomials that involve samples outside of the two-sample window surrounding the calculated sample are employed to refine the estimation of the ideal new sample value. The error level can be arbitrarily reduced by increasing the order of the polynomial function used for the estimation, with an increasing penalty in computation time and storage for the source samples surrounding the current time. Such conversion is typically performed by a time-variant interpolation filter having a large number of taps, which requires a large amount of computation power, as well as storage for a large number of coefficients. The result is a large amount of die area/processor time and consequent power consumption, in order to perform the sample rate conversion. The number of taps required for the filter may be reduced, resulting in reduced power consumption, using infinite-impulse response (IIR) filters. However, the phase-response of such filters results in non-linear group delay.</p>
<p id="p-0008" num="0007">Alternative solutions, such as that disclosed in U.S. Pat. No. 6,208,671, convert the incoming sample stream to a higher “intermediate” sample rate, and then converts the intermediate result to the desired output sample rate. Such solutions require an interpolation filter, a decimation filter and a high-speed interpolator. The application of high intermediate sample rates require circuits that also consume large amounts of circuit power.</p>
<p id="p-0009" num="0008">Therefore, it would be desirable to provide a real-time method and sample rate converter providing a sample-rate converted output stream with minimum harmonic distortion, linear phase response, and low circuit power/computation cost.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The above stated objective of providing a low-distortion real-time sample rate converter with linear phase and low circuit power/computation cost is achieved in a sample rate converter and method of operation of the sample rate converter.</p>
<p id="p-0011" num="0010">The sample rate converter converts an input sample stream to an output sample stream using a non-polynomial convolution kernel, which may be a gaussian function, to provide for sample rate conversion at a low intermediate sample rate. Since the gaussian function decays rapidly with displacement from its center of symmetry, the convolution can be truncated after a small number of terms, i.e., the convolution can be performed using only a small number of input samples, without generating unacceptable distortion.</p>
<p id="p-0012" num="0011">For incoming sample rates higher than the output sample rate, interpolation is applied by directly convolving the input sample stream with the non-polynomial kernel and then decimating the output of the convolution to the output sample rate. For incoming sample rates lower than the output sample rate, the input sample stream is first resampled at a small multiple of the output sample rate and then the sample values are convolved with the gaussian kernel at the output sample rate. When the sample rates match, either of the above-described methods/circuits may be applied.</p>
<p id="p-0013" num="0012">The foregoing and other objectives, features, and advantages of the invention will be apparent from the following, more particular, description of the preferred embodiment of the invention, as illustrated in the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram depicting a sample-rate converter in accordance with an embodiment of the present invention.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram depicting a sample-rate converter in accordance with another embodiment of the present invention.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram depicting a sample-rate converter in accordance with yet another embodiment of the present invention.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 4</figref> is a graph depicting the convolution operation performed by the sample-rate converters of <figref idref="DRAWINGS">FIGS. 1-3</figref>.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating a method for sample rate conversion as performed in the circuits of <figref idref="DRAWINGS">FIGS. 1-3</figref>.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart illustrating a method for computing the gaussian kernel within the CORDIC computation blocks of <figref idref="DRAWINGS">FIGS. 1-3</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF ILLUSTRATIVE EMBODIMENT</heading>
<p id="p-0020" num="0019">The present invention encompasses a real-time sample-rate converter and real-time sample rate conversion method that employ a non-traditional sampling kernel in order to reduce the amount of hardware and/or computation power required to perform a sample rate conversion of specified accuracy. Instead of a linear polynomial kernel, as is employed in prior art converters, a transcendental function, i.e., a function that cannot be exactly expressed as a polynomial, is employed. The magnitude of the kernel value varies with the time displacement of each sample involved in the convolution, non-linearly and according to a non-polynomial function. The time displacement is with respect to a reference time position, generally the time corresponding to the sample position of the output sample being calculated.</p>
<p id="p-0021" num="0020">In the embodiments described below, a gaussian kernel is employed, which is a non-linear and non-polynomial function. An approximation having a substantially gaussian shape could also be used. The gaussian kernel is symmetric about zero, which is desirable for fixing the position of the output sample at zero. The symmetry is desirable as artifacts would otherwise be introduced in the output sample stream. The gaussian kernel provides a particular advantage in that for a finite number of terms and/or finite precision in computation, the spread of the distortion in both the frequency-domain and time-domain is equal and the product of the time-domain and frequency-domain spreading due to error is minimal. The gaussian kernel can be computed with a simplified coordinate rotation digital computer (CORDIC) algorithm that uses a logarithmic look-up table. The CORDIC algorithm is advantageous in that the logarithmic look-up table extends over a short interval ln [1]:ln [2], and the depth and width of the table required to provide the required precision of the computed convolution result is small. For the CORDIC look-up table, both the depth and width are proportional to the required precision of the look-up values. The look-up value precision is only slightly greater than the required precision of the result, since the look-up values are only added a few times to produce the final term. CORDIC algorithms can be used to compute other transcendental functions that may be usefully applied as kernels in the sample-rate converter of the present invention, depending on the metrics required from the sample-rate converter.</p>
<p id="p-0022" num="0021">Referring now to <figref idref="DRAWINGS">FIG. 1</figref>, a block diagram of a sample-rate converter in accordance with an embodiment of the present invention is shown. The depicted embodiment is applicable when the source sample rate is higher than or equal to the desired output sample rate and may form part of a converter that supports output/input sample rate ratios greater than and less than one, as will be shown below with respect to the embodiment of FIG. <b>3</b>.</p>
<p id="p-0023" num="0022">An input sample stream IN(F<sub>SI</sub>) at a first sample rate F<sub>SI </sub>is received by a FIFO <b>10</b>. FIFO <b>10</b> is an addressable FIFO that is accessed by CORDIC processing circuit <b>11</b>, that may be a digital signal processor (DSP) executing a CORDIC algorithm, or a hardware CORDIC implementation. CORDIC processing block <b>11</b> reads a predetermined number of input values from FIFO <b>10</b> for each output stream value to be computed and performs a convolution with the gaussian kernel by computing the value of the gaussian kernel for each input value from the displacement of the input value from the midpoint of the set of input values read from FIFO <b>10</b>, the phase number of the current sample and sample-rate ratio as provided from a rate estimator <b>13</b>. The read signal, labeled “NA read” is a non-advancing read so that CORDIC processing block <b>11</b> can access the number of samples required to perform the convolution term summation for each output of CORDIC processing block <b>11</b>.</p>
<p id="p-0024" num="0023">Rate estimator <b>13</b> compares the phase of the input sample clock at rate F<sub>SI </sub>to an output sample clock at rate F<sub>SO </sub>to produce the instantaneous phase Φ and sample rate ratio F<sub>SO</sub>/F<sub>SI </sub>as fixed-point numbers. A squaring unit <b>14</b> provides the square of the time displacement used by the CORDIC kernel to compute the present output sample. The output samples are given by:</p>
<p id="p-0025" num="0024">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <munderover>
    <mo>∑</mo>
    <mrow>
      <mi>n</mi>
      <mo>-</mo>
      <mi>j</mi>
    </mrow>
    <mrow>
      <mi>n</mi>
      <mo>+</mo>
      <mi>j</mi>
    </mrow>
  </munderover>
  <mo>⁢</mo>
  <mrow>
    <mrow>
      <mi>a</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>[</mo>
        <mi>n</mi>
        <mo>]</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <msup>
      <mi>e</mi>
      <mrow>
        <mo>-</mo>
        <msup>
          <mi>kt</mi>
          <mn>2</mn>
        </msup>
      </mrow>
    </msup>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where 2j+1 is the size of the set of input samples used to provide the convolution terms, a[n] is the sequence of magnitudes of the input samples, and −t<sup>2 </sup>is the output of squaring unit <b>14</b>. The constant k is a positive constant and is determined by the spread of the gaussian kernel with respect to the spread of the input samples as will be described in further detail below. In the actual algorithm employed in CORDIC processing block <b>11</b>, a constant k′ is a constant equal to klog<sub>2</sub>e, which permits the use of a base 2 logarithm to compute the gaussian in CORDIC processing block <b>11</b>, which are computed by:
</p>
<p id="p-0026" num="0025">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <munderover>
      <mo>∑</mo>
      <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>j</mi>
      </mrow>
      <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>j</mi>
      </mrow>
    </munderover>
    <mo>⁢</mo>
    <mrow>
      <mrow>
        <mi>a</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>[</mo>
          <mi>n</mi>
          <mo>]</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <msup>
        <mn>2</mn>
        <mrow>
          <mrow>
            <mo>-</mo>
            <msup>
              <mi>k</mi>
              <mi>′</mi>
            </msup>
          </mrow>
          <mo>⁢</mo>
          <msup>
            <mi>t</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </msup>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <munderover>
      <mo>∑</mo>
      <mrow>
        <mi>n</mi>
        <mo>-</mo>
        <mi>j</mi>
      </mrow>
      <mrow>
        <mi>n</mi>
        <mo>+</mo>
        <mi>j</mi>
      </mrow>
    </munderover>
    <mo>⁢</mo>
    <mrow>
      <mrow>
        <mi>a</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>[</mo>
          <mi>n</mi>
          <mo>]</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <msup>
        <mi>e</mi>
        <mrow>
          <mo>-</mo>
          <msup>
            <mi>kt</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </msup>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
yielding the identical result given above.
</p>
<p id="p-0027" num="0026">The output of CORDIC processing block <b>11</b> is a stream of intermediate samples at an integer multiple N of the output sample rate. A decimation filter <b>12</b> decimates the intermediate sample stream to provide an output sample stream at rate F<sub>SO</sub>. The number of input samples and thus convolution terms that are employed in each output sample computation is dramatically reduced over that of traditional sample rate converters, that may include hundreds of interpolation filter taps. Since the gaussian function decays super-exponentially, for a given error in the output sample magnitudes, only a small number of convolution terms, e.g. +/−5 samples around the midpoint of the convolution, will yield a high level of precision in the output sample stream. In general, the number of terms required is proportional to the natural logarithm of the allowable truncation error.</p>
<p id="p-0028" num="0027">Referring now to <figref idref="DRAWINGS">FIG. 2</figref>, a block diagram of a sample-rate converter in accordance with another embodiment of the present invention is shown. The depicted embodiment is applicable when the source sample rate is lower than or equal to the desired output sample rate and may also form part of a converter that supports output/input sample rate ratios greater than and less than one, as mentioned above.</p>
<p id="p-0029" num="0028">An input sample stream IN(F<sub>SI</sub>) at a first sample rate F<sub>SI </sub>is up-sampled by an interpolation filter <b>26</b> to an intermediate sample stream at rate NF<sub>SI</sub>. Interpolation filter <b>26</b> can be a very simple filter compared to those required for arbitrary sample rate conversion, and may be specifically designed for a predetermined upsampling ratio of N:1. The output of interpolation filter <b>26</b> is provided to a FIFO <b>20</b>, which is an addressable FIFO that is accessed by CORDIC processing block <b>21</b>, that may be a digital signal processor (DSP) executing a CORDIC algorithm, or a hardware CORDIC implementation. CORDIC <b>21</b> reads a predetermined number of input values from FIFO <b>21</b> for each output stream value to be computed and performs a convolution with the gaussian kernel by computing the value of the gaussian kernel for each input value from the displacement of the input value from the midpoint of the set of input values read from FIFO <b>21</b>, and the phase number of the current sample and sample-rate ratio as provided from a rate estimator <b>23</b>.</p>
<p id="p-0030" num="0029">Rate estimator <b>23</b>, a squaring unit <b>24</b> and CORDIC processing block <b>21</b> operate as described above with respect to <figref idref="DRAWINGS">FIG. 1</figref>, except that the convolution performed by CORDIC processing block <b>21</b> occurs directly at output sample rate F<sub>SO </sub>from the up-sampled intermediate stream values, rather than producing an up-sample output intermediate stream from the input stream values as in the circuit of <figref idref="DRAWINGS">FIG. 1</figref>. Since the output sample rate exceeds the input sample rate, the input stream of values would otherwise not meet the required input of CORDIC processing block <b>21</b> needed to provide for computation of output data stream OUT.</p>
<p id="p-0031" num="0030">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, a sample rate converter is shown that provides the functionality of the sample rate converters of <figref idref="DRAWINGS">FIG. 1</figref> and <figref idref="DRAWINGS">FIG. 2</figref>, detecting the relationship of the input and output sample rates and adapting the architecture of the circuit to accommodate sample rate ratios greater than or less than unity. For the case of equal sampling rates, in which the converter may be performing a de-jittering function, etc., selection of either of the topologies described below may be made. A rate estimator <b>33</b> receives the input sample clock rate F<sub>SI </sub>and output sample clock rate F<sub>SO </sub>and generates both the instantaneous phase Φ and sample rate ratio F<sub>SO</sub>/F<sub>SI </sub>that are provided to a squaring unit <b>34</b> as described above with respect to <figref idref="DRAWINGS">FIGS. 1 and 2</figref>, but also a select signal SEL. Select signal SEL controls multiplexers <b>32</b>A, <b>32</b>B and <b>32</b>C to re-route various signals within the circuit, in effect, selecting between the toplogies of <figref idref="DRAWINGS">FIG. 1</figref> and <figref idref="DRAWINGS">FIG. 2</figref> as appropriate to the relationship between F<sub>SO </sub>and F<sub>SI</sub>. As mentioned above, for F<sub>SO</sub>/F<sub>SI</sub>=1, SEL may be assigned to either state and either selectable topology employed for the conversion.</p>
<p id="p-0032" num="0031">When F<sub>SO</sub>&lt;F<sub>SI</sub>, select signal SEL=0 and multiplexer <b>32</b>A supplies the input sample stream IN(F<sub>SI</sub>) to the input of FIFO <b>30</b>, which supplies non-interpolated data values to CORDIC processing block <b>31</b>. The output of CORDIC processing block <b>31</b> is provided by multiplexer <b>32</b>B to a decimator/up-sampler <b>36</b> that receives select signal SEL and for SEL=0, decimates the output of CORDIC processing block <b>31</b> to provide the output sample stream OUT(F<sub>SO</sub>) through multiplexer <b>32</b>C.</p>
<p id="p-0033" num="0032">When F<sub>SO</sub>&gt;F<sub>SI</sub>, select signal SEL=1 and the input sample stream IN(F<sub>SI</sub>) is supplied to the input of decimator/up-sampler <b>36</b> through multiplexer <b>32</b>B. Decimator/up-sampler <b>36</b> alsot receives select signal SEL and for SEL=1, upsamples the input sample stream, which is then provided to the input of FIFO <b>30</b>, through multiplexer <b>32</b>A. FIFO <b>30</b> supplies interpolated data values to CORDIC processing block <b>31</b>. The output of CORDIC processing block <b>31</b> is provided as output sample stream OUT(F<sub>SO</sub>) through multiplexer <b>32</b>C.</p>
<p id="p-0034" num="0033">Referring now to <figref idref="DRAWINGS">FIG. 4</figref>, the operation of CORDIC processing blocks <b>11</b>, <b>21</b> and <b>31</b> of <figref idref="DRAWINGS">FIGS. 1-3</figref> is illustrated in a time/signal diagram. Input sample values a[n], a[n+1] and a[n+2] are illustrated as the peak values of individual gaussian distributions. An output sample value Y[m] is shown and is computed as the sum of the contributions from each of the terms computed by the CORDIC algorithm, i.e., the magnitude of each sample a[n], a[n+1] and a[n+2] (and other samples included in the terms, e.g., a[n+3] and onward and possibly a[n−1] and backward), as modified by their corresponding time displacements t<sub>n</sub>, t<sub>n+1 </sub>and t<sub>n+2 </sub>from the position of Y[m], according to the CORDIC-computed gaussian distributions. The contributions are shown as the circles indicating the intersection between the arrow representing output sample Y[m] and the distributions around each of input samples a[n], a[n+1] and a[n+2]. In practice, a sufficient number of terms will be used to reduce the truncation error due to the non-included terms to the desirable level of distortion in the output signal. Generally +/−5 samples of a[n] around output sample Y[m] will be sufficient to reduce the distortion error to below the 20-bit level.</p>
<p id="p-0035" num="0034">Referring now to <figref idref="DRAWINGS">FIG. 5</figref>, a method of sample rate conversion as performed in the above-described sample rate converters is illustrated in a flowchart. When an output sample is needed (decision <b>50</b>), a count value j is initialized to point to the earliest input sample to be used in the output sample computation (step <b>51</b>), which can be a negative index. Input sample a[n+j] is retrieved from FIFO <b>10</b>, <b>20</b>, or <b>30</b> and the corresponding time displacement t<sub>n+j </sub>is supplied to squaring unit <b>14</b>, <b>24</b> or <b>34</b> (step <b>52</b>). Squaring unit <b>14</b>, <b>24</b> or <b>34</b> computes control value X=(k′t<sub>n+j</sub>)<sup>2 </sup>(step <b>53</b>) and control value X is delivered along with sample a[n+j] to CORDIC processing block <b>11</b>, <b>21</b>, or <b>31</b> (step <b>54</b>). CORDIC processing block <b>11</b>, <b>21</b>, or <b>31</b> returns the computed value a[n+j]2<sup>X </sup>(step <b>55</b>), which is the convolution term corresponding to input sample a[n+j]. The convolution term is accumulated as the output sample value (step <b>56</b>) and until after j+n has reached the last input sample to be used in the convolution (decision <b>57</b>), j is incremented (step <b>58</b>) and steps <b>51</b>-<b>57</b> are repeated. When all of the terms have been accumulated (decision <b>57</b>), the output sample is provided as the accumulation of all the convolution terms (step <b>59</b>).</p>
<p id="p-0036" num="0035">Referring now to <figref idref="DRAWINGS">FIG. 6</figref>, a simplified CORDIC algorithm as may be employed in CORDIC processing blocks <b>11</b>, <b>21</b> and <b>31</b> described above, is illustrated in a flowchart. The entire sequence of operations shown in the flowchart is repeated for each convolution term contributing to an output sample value and the input value for each iteration is a different input sample and a control number corresponding to the displacement from the center of the gaussian kernal for each input sample. In the following description and in the flowchart, operator &gt;&gt;&gt; indicates an arithmetic right-shift operation. A pre-computed lookup table is provided with values LOOKUP[I]=log<sub>2</sub>(1+2<sup>−I</sup>), having a predetermined precision according to the depth and width of the lookup table. The lookup table maps integer values of I to the resulting values of an operation according to log<sub>2</sub>(1+2<sup>−I</sup>). The lookup table thus only requires a storage depth equal to the maximum range of I used in the CORDIC computation, generally on the order of 20 or more entries. The storage width is set according to the required precision as noted above.</p>
<p id="p-0037" num="0036">First, the control value X=−k′t<sub>j−n</sub><sup>2 </sup>is received from squaring unit (<b>14</b>, <b>24</b>, or <b>34</b>) and input sample value a[n+j] is received from FIFO <b>10</b>, <b>20</b> or <b>30</b> (step <b>41</b>). The control value X=−k′t<sub>j+n</sub><sup>2 </sup>is a number representing the phase/time-displacement of the gaussian convolution term being computed, where k′ is defined above (in paragraph 0019) as klog<sub>2</sub>e where α[n+j]<sub>e</sub><sup>−kt</sup><sup><sub2>n+j</sub2></sup><sup>2 </sup>is the exact expression for each gaussian convolution term expression and t<sub>n+j </sub>is the time displacement between the location of the desired output sample in time and the corresponding input sample a[n+j] as depicted in <figref idref="DRAWINGS">FIG. 4</figref>. For each computed convolution term, the desired output sample contribution value Y is initially set to a[n+j]&gt;&gt;&gt; INT(X) (step <b>42</b>) and control value X is initially set to the fractional part of X (step <b>43</b>). The result is that the value of Y is initially set to a[n+j]<sup>−INT(X) </sup>and then will be adjusted according to further computation that reduces the error in Y according to iterative comparisons of a logarithmic lookup of log<sub>2</sub>(1+2<sup>−I</sup>) to the value of X. An iteration counter I is initialized to 1 (step <b>44</b>) and the iterative CORDIC computation begins for the convolution term being computed. Value C is set to a lookup logarithm value of LOOKUP[I] (step <b>45</b>), which returns an approximation of log<sub>2</sub>(1+2<sup>−I</sup>), and if X is greater than or equal to C (decision <b>46</b>), then X is reduced by C and Y is increased by a power-of-two fraction of Y, (Y&gt;&gt;&gt;I) (step <b>47</b>). If X is less than C (decision <b>46</b>), then X and Y are not adjusted. Next, iteration counter I is incremented (step <b>48</b>) and steps <b>45</b>-<b>48</b> are repeated until iteration counter I reaches a predetermined maximum M (decision <b>49</b>), reducing the error in the computed convolution term until the error is below an acceptable threshold. The resulting computation yields Y=a[n+j]2<sup>X</sup>, where X=−k′t<sup>2 </sup>to a degree of precision specified by the size of iteration maximum count M.</p>
<p id="p-0038" num="0037">The CORDIC kernel embodiment illustrated above uses fixed-point operations and storage in order to compute the convolution values required for the sample rate conversion. However, it is contemplated that all of the operations described above can be performed with floating point storage and computation. Thus, an operation such as &gt;&gt;&gt; is understood to be equivalent to subtraction from the exponent field of a floating point number. It is further contemplated, particularly in the floating point domain, that the CORDIC algorithm described above can be replaced with alternative well-known methods and operations for computing logarithms and that the particular base employed in the computations can be 2, “e” or any other base as chosen for a particular implementation, with consequent adjustment in the value of “k”.</p>
<p id="p-0039" num="0038">While the invention has been particularly shown and described with reference to the preferred embodiments thereof, it will be understood by those skilled in the art that the foregoing and other changes in form, and details may be made therein without departing from the spirit and scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298296-20071120-M00001.NB">
<img id="EMI-M00001" he="9.14mm" wi="76.20mm" file="US07298296-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298296-20071120-M00002.NB">
<img id="EMI-M00002" he="9.14mm" wi="76.20mm" file="US07298296-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A sample rate converter, comprising:
<claim-text>a digital input node for receiving a first stream of audio samples having a first sampling rate;</claim-text>
<claim-text>a digital output node for providing a second stream of audio samples having a second sampling rate differing from said first sampling rate; and</claim-text>
<claim-text>a computation circuit for computing second values within said second stream of audio samples from first values of said first stream of audio samples by convolving said first values with a predetermined number of terms of a kernel having a non-linear and non-polynomial relationship between kernel magnitude and convolution term offset, wherein said computing is performed in real-time as said audio samples of said first stream are received.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said non-linear and non-polynomial relationship is applied to a square of the convolution term offset, whereby said kernel is symmetric around an offset of zero.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The sample rate converter of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein said kernel is a gaussian operator.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The sample rate converter of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein said computation circuit implements an algorithm employing a logarithmic lookup table.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The sample rate converter of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein said computation circuit iteratively applies said logarithmic lookup table to reduce an error residue of a value of said kernel as said value is computed.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said computation circuit implements a simplified CORDIC algorithm.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said computation circuit implements an algorithm employing a logarithmic lookup table.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The sample rate converter of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein said computation circuit repeatedly applies said logarithmic lookup table to iteratively reduce an error residue of a value of said kernel as said value is computed.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said computation circuit implements a simplified CORDIC algorithm.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said first sample rate is higher than said second sample rate, and wherein said computation circuit convolves said first stream of audio samples at an intermediate rate that is an integer multiple of said second sample rate to produce an intermediate sample stream, and wherein said sample rate converter further comprises a decimation filter having a decimation factor equal to said integer multiple for decimating said intermediate sample stream to produce said second stream of audio samples.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said first sample rate is lower than said second sample rate, and wherein said sample rate converter further comprises an upsampling interpolation filter having an oversampling ratio equal to a predetermined integer that produces an intermediate sample stream at a sample rate higher than said first sample rate, and wherein said intermediate sample stream is convoluted by said computation circuit at said second sampling rate to produce said second stream of audio samples.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The sample rate converter of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said computation circuit comprises a rate estimator for estimating a ratio between said first sample rate and said second sample rate, and wherein in response to said first sample rate being higher than said second sample rate, said computation circuit convolves said first stream of audio samples at an intermediate rate that is an integer multiple of said second sample rate to produce an intermediate sample stream and decimates said intermediate sample stream to produce said second stream of audio samples, and wherein in response to said first sample rate being lower than said second sample rate, said computation circuit upsamples said first stream of audio samples and convolves said intermediate sample stream at said second sampling rate to produce said second stream of audio samples.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A method of performing sample rate conversion, comprising:
<claim-text>receiving a first stream of samples at a first sample rate;</claim-text>
<claim-text>in response to said receiving, convolving said first stream of samples with a predetermined number of terms of a kernel having a non-linear and non-polynomial relationship between kernel magnitude and convolution term offset; and</claim-text>
<claim-text>providing a second stream of samples at a second sample rate in conformity with a result of said convolving.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein said convolving convolves said first stream of samples with a gaussian kernel.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising computing each of said terms of said kernel using a simplified CORDIC algorithm.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising in response to said receiving, upsampling said first stream of samples to an intermediate stream of samples having a sample rate equal to said first sample rate multiplied by a predetermined integer, and wherein said convolving is performed by convolving said intermediate stream of samples with said kernel at said second sample rate, and wherein said providing provides a result of said convolving.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising:
<claim-text>in response to said receiving, convolving said first stream of samples to an intermediate stream of samples at a rate equal to said second sample rate multiplied by a predetermined integer; and</claim-text>
<claim-text>decimating said intermediate stream of samples with said kernel at said second sample rate, and wherein said providing provides a result of said decimating.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising:
<claim-text>determining whether or not said first sample rate is higher than said second sample rate;</claim-text>
<claim-text>in response to determining that said first sample rate is higher than said second sample rate, and further in response to said receiving, convolving said first stream of samples to an intermediate stream of samples at a rate equal to said second sample rate multiplied by a predetermined integer, and decimating said intermediate stream of samples with said kernel at said second sample rate; and</claim-text>
<claim-text>in response to determining that said first sample rate is not higher than said second sample rate, and further in response to said receiving, upsampling said first stream of samples to an intermediate stream of samples having a sample rate equal to said first sample rate multiplied by a predetermined integer, and wherein said convolving is performed by convolving said intermediate stream of samples with said kernel at said second sample rate, wherein in response to determining that said first sample rate is higher than said second sample rate, said providing provides a result of said decimating, and wherein in response to determining that said first sample rate is not higher than said second sample rate, said providing provides a result of said convolving.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A sample rate converter, comprising:
<claim-text>a digital input node for receiving a first stream of audio samples having a first sampling rate;</claim-text>
<claim-text>a digital output node for providing a second stream of audio samples having a second sampling rate differing from said first sampling rate; and</claim-text>
<claim-text>a computation circuit for computing second values within said second stream of audio samples from first values of said first stream of audio samples by convolving said first values with a kernel having a substantially gaussian shape.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The sample rate converter of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein said convolving is performed using a predetermined number of terms corresponding to an equal number samples of said first stream of audio samples.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The sample rate converter of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein said convolving is performed using a predetermined number of terms corresponding to an equal number samples of an intermediate stream up-sampled from said first stream of audio samples.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A method of performing sample rate conversion, comprising:
<claim-text>receiving a first stream of samples at a first sample rate;</claim-text>
<claim-text>in response to said receiving, convolving said first stream of samples with a gaussian kernel; and</claim-text>
<claim-text>providing a second stream of samples at a second sample rate in conformity with a result of said convolving.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein said convolving is performed using a predetermined number of terms corresponding to an equal number samples of said first stream of audio samples.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The method of <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein said convolving is performed using a predetermined number of terms corresponding to an equal number samples of an intermediate stream up-sampled from said first stream of audio samples.</claim-text>
</claim>
</claims>
</us-patent-grant>
