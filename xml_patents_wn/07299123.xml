<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299123-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299123</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11367805</doc-number>
<date>20060303</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>05425121</doc-number>
<date>20050304</date>
</priority-claim>
<priority-claim sequence="02" kind="regional">
<country>EP</country>
<doc-number>06110557</doc-number>
<date>20060301</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>4</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>19</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>F</section>
<class>02</class>
<subclass>M</subclass>
<main-group>37</main-group>
<subgroup>04</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>701114</main-classification>
<further-classification>123486</further-classification>
</classification-national>
<invention-title id="d0e89">Method and device for estimating the inlet air flow in a combustion chamber of a cylinder of an internal combustion engine</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4920789</doc-number>
<kind>A</kind>
<name>Gomez et al.</name>
<date>19900500</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification> 731182</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4962739</doc-number>
<kind>A</kind>
<name>Wataya</name>
<date>19901000</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>123435</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5140850</doc-number>
<kind>A</kind>
<name>Ellmann et al.</name>
<date>19920800</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification> 731182</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5974870</doc-number>
<kind>A</kind>
<name>Treinies et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 731182</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0096375</doc-number>
<kind>A1</kind>
<name>Cesa</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>42218604</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0226354</doc-number>
<kind>A1</kind>
<name>Schmidt</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification> 731181</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2006/0212209</doc-number>
<kind>A1</kind>
<name>Cesario et al.</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701106</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2006/0235604</doc-number>
<kind>A1</kind>
<name>Taglialatela-Scafati et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701109</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>DE</country>
<doc-number>29923272</doc-number>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>59221433</doc-number>
<date>19841200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>WO</country>
<doc-number>WO2004048761</doc-number>
<date>20040600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>“Cylinder Air/Fuel Ratio Estimation Using Net Heat Release Data”, Tunestal et al; IFAC Workshop on Advances in Automotive Control, Mar. 28, 2001, pp. 239-247, XP001032740.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>“Cylinder Air/Fuel Ratio Estimation Using Net Heat Release Data”, Tunestal et al; Control Engineering Practice, Pergamon Press, Oxford, GB, vol. 11, No. 3, 2003, pp. 311-318, XP001157572, ISSN: 0967-0661.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>701101</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>701103</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>701114</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>701115</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>123434</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>123435</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>123486</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>123494</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification> 731182</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 58</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 59</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702116</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702182</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702183</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702186</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>11</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060225710</doc-number>
<kind>A1</kind>
<date>20061012</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Taglialatela-Scafati</last-name>
<first-name>Ferdinando</first-name>
<address>
<city>Giugliano</city>
<country>IT</country>
</address>
</addressbook>
<nationality>
<country>IT</country>
</nationality>
<residence>
<country>IT</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Cesario</last-name>
<first-name>Nicola</first-name>
<address>
<city>Casalnuovo di Napoli</city>
<country>IT</country>
</address>
</addressbook>
<nationality>
<country>IT</country>
</nationality>
<residence>
<country>IT</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Cassese</last-name>
<first-name>Pasquale</first-name>
<address>
<city>Marigliano</city>
<country>IT</country>
</address>
</addressbook>
<nationality>
<country>IT</country>
</nationality>
<residence>
<country>IT</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Jorgenson</last-name>
<first-name>Lisa K.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>Allen, Dyer, Doppelt, Milbrath &amp; Gilchrist, P.A.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>STMicroelectronics S.r.l.</orgname>
<role>03</role>
<address>
<city>Agrate Brianza</city>
<country>IT</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Kwon</last-name>
<first-name>John T.</first-name>
<department>3747</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A reliable method of sensing the inlet air flow in a combustion chamber of a cylinder of an internal combustion engine includes assessing the inlet air flow with soft-computing techniques basically exploiting a combustion pressure signal generated by a pressure sensor installed in the cylinder.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="81.03mm" wi="165.35mm" file="US07299123-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="218.27mm" wi="166.54mm" file="US07299123-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="232.49mm" wi="174.07mm" file="US07299123-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="150.71mm" wi="163.83mm" file="US07299123-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="144.44mm" wi="163.91mm" file="US07299123-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="148.25mm" wi="169.67mm" file="US07299123-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="130.05mm" wi="165.02mm" file="US07299123-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="129.20mm" wi="163.58mm" file="US07299123-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="131.49mm" wi="161.12mm" file="US07299123-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="127.51mm" wi="166.20mm" file="US07299123-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">This invention relates to internal combustion engines, and, more particularly, to a method and associated device for sensing the inlet mass air flow (briefly MAF) in a cylinder of an internal combustion engine, and an associated control system that uses this sensing device.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">In the feedforward part of an SI (Spark Ignition) engine Air/Fuel control system, the in-cylinder mass air flow rate has to be accurately estimated to determine the fuel amount to be injected. Generally, this evaluation is performed either with a dedicated sensor (MAF sensor) or with an indirect evaluation based on the speed-density method.</p>
<p id="p-0004" num="0003">In order to meet the stricter and stricter emission regulations, automobile gasoline engines are equipped with a three-way catalytic converter (TWC). A precise control of air-fuel ratio (A/F) to the stoichiometric value is necessary to achieve a high efficiency of the TWC converter in the conversion of the toxic exhaust gases (CO, NOx, HC) into less harmful products (CO<sub>2</sub>, H<sub>2</sub>O, N<sub>2</sub>). Typically, this control is performed in a spark-ignition engine through a so-called lambda sensor. The lambda sensor generates a signal representative of the value of the ratio</p>
<p id="p-0005" num="0004">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mi>λ</mi>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <mi>Air</mi>
      <mo>/</mo>
      <mi>Fuel</mi>
    </mrow>
    <mrow>
      <mi>Air</mi>
      <mo>/</mo>
      <msub>
        <mi>Fuel</mi>
        <mi>stoichiometric</mi>
      </msub>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
from the amount of oxygen detected in the exhaust gas mixture. If λ&lt;1 the mixture is rich of fuel, while if λ&gt;1 the mixture is lean of fuel.
</p>
<p id="p-0006" num="0005">In order to keep the air/fuel ratio (AFR) as close as possible to unity, the lambda sensor is inserted in the outlet of exhaust gases for monitoring the amount of oxygen in the exhaust gases. The signal generated by the lambda sensor is input to the controller of the engine that adjusts the injection times and thus the fuel injected during each cycle for reaching the condition λ=1.</p>
<p id="p-0007" num="0006">Traditional Air/Fuel control strategies include a feed-forward part in which the amount of fuel to be injected is calculated on the basis of the in-cylinder mass air flow and a feedback part which uses the signal of an oxygen sensor (lambda sensor), located in the exhaust system, to ensure that the Air/Fuel will remain in the neighborhood of the stoichiometric value [1].</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> shows a block diagram of a traditional Air/Fuel control system. Generally, the feedback part of the Air/Fuel control system is fully active only in steady-state conditions; moreover the lambda sensor signal is available only after this sensor has reached a fixed operating temperature. In transient and cold start conditions the feedback control is disabled, thus the feedforward part of Air/Fuel control is particularly important.</p>
<p id="p-0009" num="0008">As mentioned before, the air flow estimation is the basis for calculating the injected fuel quantity in the feedforward part of Air/Fuel control system.</p>
<p id="p-0010" num="0009">A conventional technique [1] for estimating the cylinder air flow into a SI (Spark Ignition) engine involves the so-called “speed-density” equation:</p>
<p id="p-0011" num="0010">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <msub>
    <mover>
      <mi>m</mi>
      <mo>.</mo>
    </mover>
    <mi>ap</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mi>η</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <msub>
            <mi>p</mi>
            <mi>m</mi>
          </msub>
          <mo>,</mo>
          <mi>N</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>·</mo>
    <mfrac>
      <mrow>
        <msub>
          <mi>V</mi>
          <mi>d</mi>
        </msub>
        <mo>·</mo>
        <mi>N</mi>
        <mo>·</mo>
        <msub>
          <mi>p</mi>
          <mi>a</mi>
        </msub>
      </mrow>
      <mrow>
        <mn>120</mn>
        <mo>·</mo>
        <mi>R</mi>
        <mo>·</mo>
        <msub>
          <mi>T</mi>
          <mi>m</mi>
        </msub>
      </mrow>
    </mfrac>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where {dot over (m)}<sub>ap </sub>is the inlet mass air flow rate, V<sub>d </sub>is the engine displacement and N is the engine speed; T<sub>m </sub>and p<sub>m </sub>are the mean manifold temperature and pressure and η. is the volumetric efficiency of the engine. This is a nonlinear function of engine speed (N) and manifold pressure (p<sub>m</sub>), that may be experimentally mapped in correspondence with different engine working points. A standard method is to map the volumetric efficiency and compensate it for density variations in the intake manifold.
</p>
<p id="p-0012" num="0011">One of the drawbacks in using the “speed-density” equation for the in-cylinder air flow estimation is the uncertainty in the volumetric efficiency. Generally, the volumetric efficiency is calculated in the calibration phase with the engine under steady state conditions. However variations in the volumetric efficiency due, for example, to engine aging and wear, combustion chamber deposit buildup etc., may induce errors in the air flow estimation.</p>
<p id="p-0013" num="0012">Moreover, the low-pass characteristic of commercial sensors (Manifold Absolute Pressure or MAP sensors) used for the determination of the manifold pressure p<sub>m</sub>, makes the signal affected by a delay which, during fast transients, introduces a relevant error in the air flow estimation.</p>
<p id="p-0014" num="0013">This problem is not solved by using a faster sensor: in this case the sensor also captures pressure fluctuations due to the valve and piston motion [2]. In engines equipped with an EGR (Exhaust Gas Recirculation) valve, the MAP (Manifold Absolute Pressure) sensor cannot distinguish between fresh air and inert exhaust gas in the intake manifold. Therefore, in this case the speed-density equation (1) cannot be used and the air charge estimation algorithm must provide a method for separating the contribution of recalculated exhaust gas to the total pressure in the intake manifold [4].</p>
<p id="p-0015" num="0014">An alternative method for the air charge determination is to use a Mass Air Flow (MAF) sensor located upstream from the throttle body, which measures directly the inlet air flow. The main advantages of a direct air flow measurement are [1]: automatic compensation for engine aging and for all factors which modify engine volumetric efficiency; improved idling stability; and lack of sensibility to the system to EGR (Exhaust Gas Recirculation) since only fresh air flow is measured.</p>
<p id="p-0016" num="0015">Anyway, air flow measurement by means of a MAF sensor (which is generally a hot wire anemometer) accurately estimates the flow in the cylinder only in steady state, while in transients the intake manifold filling/emptying dynamics play a significant role [3], [5]. Moreover, a MAF sensor for commercial automotive applications has a relatively high cost compared to the cost of MAP (Manifold Absolute Pressure) sensor used in the “speed density” approach.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0017" num="0016">A reliable alternative method of sensing the inlet air flow in a combustion chamber of a cylinder of an internal combustion engine without using a relatively costly sensor of the prior art and a relative sensing device that implements the method have been found. According to the present invention, the inlet air flow is assessed with soft-computing techniques basically exploiting a combustion pressure signal generated by a common pressure sensor installed in the cylinder.</p>
<p id="p-0018" num="0017">The applicants have found that there exists a close correlation between the internal cylinder pressure and the inlet mass air flow of the cylinder and thus the former may be used for estimating the latter. The function of the rather expensive inlet mass air flow sensors that are actually deployed in internal combustion engines may be conveniently done by a far less expensive sensing device, without loss of precision and with a significant reduction of costs.</p>
<p id="p-0019" num="0018">The sensing device may be used for realizing a feedforward controller and a feedback-and-feedforward controller of an internal combustion engine.</p>
<p id="p-0020" num="0019">By juxtaposing a plurality of feedback-and-feedforward controllers, one for each cylinder of the engine, it is possible to control the inlet air/fuel ratio of each cylinder of a multi-cylinder internal combustion engine. The method may be carried out by a software code executed by a computer.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0021" num="0020">Preferred embodiments of the invention will be described referring to the attached drawings, wherein:</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 1</figref> shows a block diagram of the traditional air/fuel control system for a gasoline engine as in the prior art;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram of the feedforward control system of this invention;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of a preferred embodiment of the mass air flow sensor of this invention;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 4</figref> depicts the Yamaha single cylinder four stroke engine YP125 used for tests carried out by the applicant;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 5</figref> is a graph of simulations of the mass air flow sensor of this invention for different functioning conditions of the Yamaha engine YP125 compared with the values sensed by a known mass air flow sensor in the same conditions;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 6</figref> is an enlarged view of a portion of the graphs of <figref idref="DRAWINGS">FIG. 5</figref>;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 7</figref> compares the graphs of the mass air flow determined by the sensor of this invention and by a known sensor as a function of the crank angle when the engine is running at 4600 rpm and the throttle is 70% open;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 8</figref> compares the graphs of the mass air flow determined by the sensor of this invention and by a known sensor as a function of the crank angle when the engine is running at 4600 rpm and the throttle is 20% open;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 9</figref> compares the graphs of the mass air flow determined by the sensor of this invention and by a known sensor as a function of the crank angle when the engine is running at 5800 rpm and the throttle is 100% open;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 10</figref> compares the graphs of the mass air flow determined by the sensor of this invention and by a known sensor as a function of the crank angle when the engine is running at 5800 rpm and the throttle is 30% open; and</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 11</figref> compares the graphs of the mass air flow determined by the sensor of this invention and by a known sensor at 300 rpm during fast transient conditions varying the throttle opening from 0% to 100% and vice versa.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0033" num="0032">A soft computing mass air flow estimator of this invention, capable of estimating both in steady state and in transient conditions the in cylinder mass air flow of a single-cylinder SI engine, basically utilizes a combustion pressure signal of the cylinder. A learning machine, such as for example a MLP (Multi-Layer Perceptron) neural network, trained on the experimental data acquired in different operating conditions of a gasoline engine, was used for realizing the inlet mass air flow sensing device of this invention.</p>
<p id="p-0034" num="0033">A traditional combustion pressure piezoelectric transducer, or any other low-cost pressure sensor, may provide the required raw information. It has been found that the cylinder combustion pressure is correlated with the inlet mass air flow of the cylinder, thus a signal produced by a combustion pressure sensor is exploited for producing through a soft-computing processing that utilizes information on throttle opening, speed and angular position, a signal representative of the inlet mass air flow.</p>
<p id="h-0006" num="0000">System Description</p>
<p id="p-0035" num="0034">A block diagram of the novel system of air charge estimation in a single-cylinder SI engine is shown in <figref idref="DRAWINGS">FIG. 2</figref>. Basically, the system includes a MAF estimator device, which basically is a model able to estimate the mass air flow as a function of certain parametric features derived from the combustion pressure sensor. The output signal of the MAF estimator is used by an engine management system that uses look-up tables that map working points of the engine (“engine maps”) in order to determine the right width of the injection pulse (i.e. I<sub>FF</sub>) that produces the desired air/fuel ratio.</p>
<p id="h-0007" num="0000">Mass Air Flow Estimator</p>
<p id="p-0036" num="0035">Correlations between certain features, recognizable by analyzing the in-cylinder pressure signal and the mass air flow values measured by a real MAF sensor were verified.</p>
<p id="p-0037" num="0036">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, the MAF estimator block has the following inputs: throttle position, that is, the signal coming from the sensor that monitors the throttle opening; speed, that is, the engine speed, commonly evaluated from the signal of a phonic wheel; engine angular position, generally evaluated from the signal of a phonic wheel and the signal coming from a phase sensor; and cylinder pressure signal, that is the signal coming from a combustion pressure sensor.</p>
<p id="p-0038" num="0037">The output of the MAF estimator block is an estimated value of the mass air flow in a common scale (e.g. [kg/h]). From a mathematical point of view, the MAF estimator block can be described as a learning machine trained to emulate the way of functioning of a common MAF sensor. A learning machine [8], [10], is a model without a structured knowledge of the principles ruling the phenomena described by the model. In other words, a learning machine represents a model which is able to learn only from the data describing the system functionalities, that is, the input-output couples related to the system, operating in different states.</p>
<p id="p-0039" num="0038">For example, the learning machine disclosed in the European Patent application No. 05,425,121.0, in the name of the same Applicant may be used.</p>
<p id="p-0040" num="0039">For carrying out simulations, a MLP (Multi-Layer Perceptron) neural network [8] with three inputs and one output has been considered. The choice of all the endogenous parameters of the neural network model, such as the number of hidden layers, the number of neurons for each hidden layer, the type of activation functions, the value of the regularization parameter and so on, should be made for maximizing the “generalized predict capability” of the learning machine (for a more detailed description of this general concept refer to [8, 10]). “Generalized” means that the choice of the endogenous parameters of the model is made to increase the model generalization capability, that is, the capability of predicting unmeasured mass air flow values. In the present context, such a problem corresponds to a minimum searching problem.</p>
<p id="p-0041" num="0040">The shape of the fitness function that was used is the following:</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>V</mi>
              <mn>0</mn>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>S</mi>
                  <mn>1</mn>
                </msub>
                <mo>,</mo>
                <msub>
                  <mi>S</mi>
                  <mn>2</mn>
                </msub>
                <mo>,</mo>
                <mi>…</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.6em" height="0.6ex"/>
                </mstyle>
                <mo>,</mo>
                <msub>
                  <mi>S</mi>
                  <mi>P</mi>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <msub>
                <mi>N</mi>
                <mi>M</mi>
              </msub>
            </mfrac>
            <mo>⁢</mo>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <msub>
                  <mi>N</mi>
                  <mi>M</mi>
                </msub>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mfrac>
                  <mn>1</mn>
                  <mi>N</mi>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <munderover>
                    <mo>∑</mo>
                    <mrow>
                      <msub>
                        <mi>k</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mrow>
                    <mi>N</mi>
                  </munderover>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>[</mo>
                    <mrow>
                      <msub>
                        <mi>λ</mi>
                        <msub>
                          <mi>k</mi>
                          <mi>i</mi>
                        </msub>
                      </msub>
                      <mo>-</mo>
                      <mrow>
                        <msubsup>
                          <mi>F</mi>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <msub>
                                <mi>S</mi>
                                <mn>1</mn>
                              </msub>
                              <mo>,</mo>
                              <msub>
                                <mi>S</mi>
                                <mn>2</mn>
                              </msub>
                              <mo>,</mo>
                              <mi>…</mi>
                              <mo>⁢</mo>
                              <mstyle>
                                <mspace width="0.6em" height="0.6ex"/>
                              </mstyle>
                              <mo>,</mo>
                              <msub>
                                <mi>S</mi>
                                <msub>
                                  <mi>N</mi>
                                  <mn>1</mn>
                                </msub>
                              </msub>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                          <mi>i</mi>
                        </msubsup>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <msup>
                            <mi>x</mi>
                            <mrow>
                              <mo>(</mo>
                              <msub>
                                <mi>k</mi>
                                <mi>i</mi>
                              </msub>
                              <mo>)</mo>
                            </mrow>
                          </msup>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                    <mo>]</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mi>where</mi>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>24</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>N</mi>
          <mi>M</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mo>(</mo>
          <mtable>
            <mtr>
              <mtd>
                <mrow>
                  <mi>N</mi>
                  <mo>+</mo>
                  <mi>M</mi>
                </mrow>
              </mtd>
            </mtr>
            <mtr>
              <mtd>
                <mi>N</mi>
              </mtd>
            </mtr>
          </mtable>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>25</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0043" num="0042">Equation (24) is a modification of the “ordinary cross-validation estimate” of endogenous parameters of a neural network (chapter 5 of [8], and [9]) and has also been disclosed in the already cited prior European Patent application No. 05,425,121.0.</p>
<p id="p-0044" num="0043">In the above equations, N<sub>M </sub>is the number of possible choices of a testing set, comprising N elements, and of a training set, comprising M elements, on a total data set made by (N+M) input-output couples. The index k<sub>i </sub>labels the N elements of a testing data set selected by the i-th choice. The output of the neural network model trained on the M input-output couples related to the i-th choice is represented by the symbol</p>
<p id="p-0045" num="0044">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <msubsup>
    <mi>F</mi>
    <mrow>
      <mo>(</mo>
      <mrow>
        <msub>
          <mi>S</mi>
          <mn>1</mn>
        </msub>
        <mo>,</mo>
        <msub>
          <mi>S</mi>
          <mn>2</mn>
        </msub>
        <mo>,</mo>
        <mi>…</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>,</mo>
        <msub>
          <mi>S</mi>
          <mi>N1</mi>
        </msub>
      </mrow>
      <mo>)</mo>
    </mrow>
    <mi>i</mi>
  </msubsup>
  <mo>.</mo>
</mrow>
</math>
</maths>
<br/>
The optimal string of the endogenous parameters (S<sub>1</sub>, S<sub>2</sub>, . . . , S<sub>p</sub>) of the model is the one that minimizes the functional V<sub>0</sub>(S<sub>1</sub>, S<sub>2</sub>, . . . , S<sub>p</sub>). For the minimum searching of this functional, any evolutionary algorithm may be used. For the tests so far carried out by the applicant, the PSOA (Particle Swarm Optimization Algorithm) [11] stochastic searching algorithm has been used.
</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 3</figref> describes the preferred embodiment of the MAF estimator block. The architecture of the MAF estimator is similar to that of the lambda sensor disclosed in the already cited prior European Patent application No. 05,425,121.0.</p>
<p id="p-0047" num="0046">The MAF estimator has distinct sub-blocks for properly conditioning the input and output signals of the neural network.</p>
<p id="p-0048" num="0047">The P<smallcaps>RE</smallcaps>-P<smallcaps>ROC </smallcaps>sub-block pre-processes the model input data. The input data are transformed in dimensionless data with a zero mean and a unitary variance. Preferably, a PCA (Principal Component Analysis) transform is carried out on the dimensionless data. The P<smallcaps>OST</smallcaps>-P<smallcaps>ROC </smallcaps>sub-block performs the inverse of the previous transforms. The P<smallcaps>RE</smallcaps>-P<smallcaps>ROC </smallcaps>sub-block and the P<smallcaps>OST</smallcaps>-P<smallcaps>ROC </smallcaps>sub-block effectively reduce the noise that may be corrupting the output signal of the mass air flow sensor core.</p>
<p id="p-0049" num="0048">Finally, the E<smallcaps>DGE </smallcaps>D<smallcaps>ETECTOR </smallcaps>sub-block enables or disables the model prediction according to the values of the input signal <smallcaps>INPUT</smallcaps>4 (i.e. the engine angular position). In particular, when the engine is at the TDC (Top Dead Center) at the end of the exhaust stroke (i.e. when the intake stroke is starting), the E<smallcaps>DGE </smallcaps>D<smallcaps>ETECTOR </smallcaps>enables the model function until the engine angular position reaches 140 crank angle before TDC (Top Dead Center) in the compression stroke, when, for the considered test engine, the inlet and exhaust valves are simultaneously closed. This event happens when the inlet air charge reaches its maximum value.</p>
<p id="p-0050" num="0049">The mass air flow estimated by the model is used for the calculation of the injection pulse for the combustion in the next engine cycle. In other words, the cylinder air charge estimated in the current engine cycle is used to predict the air charge for the next engine cycle. This introduces an inherent delay that becomes important when the engine is in transient conditions.</p>
<p id="h-0008" num="0000">Set-Up of the MAF Estimator</p>
<p id="p-0051" num="0050">An MLP neural network was used as model to predict the cylinder mass air flow for different engine conditions. The neural network was trained on an experimental data set including different engine speeds and loads as reported in the following table. In particular, three engine speeds (3000, 4600 and 5800 rpm) and, for each speed, eight throttle positions corresponding to different engine loads, have been considered. Lower engine speeds were ignored because the engine, used for the training of the model and for its validation, was a scooter engine which normally works at high engine speeds. The value of the mass air flow provided by a hot wire anemometer, mounted upstream of the intake manifold, was acquired for each of the twenty four different engine working conditions specified in Table 1.</p>
<p id="p-0052" num="0051">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="119pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="3" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Speed (rpm)</entry>
<entry>throttle position (%)</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="char" char="."/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="119pt" align="char" char="."/>
<tbody valign="top">
<row>
<entry>1</entry>
<entry>3000</entry>
<entry>3</entry>
</row>
<row>
<entry>2</entry>
<entry>3000</entry>
<entry>10</entry>
</row>
<row>
<entry>3</entry>
<entry>3000</entry>
<entry>20</entry>
</row>
<row>
<entry>4</entry>
<entry>3000</entry>
<entry>30</entry>
</row>
<row>
<entry>5</entry>
<entry>3000</entry>
<entry>40</entry>
</row>
<row>
<entry>6</entry>
<entry>3000</entry>
<entry>50</entry>
</row>
<row>
<entry>7</entry>
<entry>3000</entry>
<entry>70</entry>
</row>
<row>
<entry>8</entry>
<entry>3000</entry>
<entry>100</entry>
</row>
<row>
<entry>9</entry>
<entry>4600</entry>
<entry>3</entry>
</row>
<row>
<entry>10</entry>
<entry>4600</entry>
<entry>10</entry>
</row>
<row>
<entry>11</entry>
<entry>4600</entry>
<entry>20</entry>
</row>
<row>
<entry>12</entry>
<entry>4600</entry>
<entry>30</entry>
</row>
<row>
<entry>13</entry>
<entry>4600</entry>
<entry>40</entry>
</row>
<row>
<entry>14</entry>
<entry>4600</entry>
<entry>50</entry>
</row>
<row>
<entry>15</entry>
<entry>4600</entry>
<entry>70</entry>
</row>
<row>
<entry>16</entry>
<entry>4600</entry>
<entry>100</entry>
</row>
<row>
<entry>17</entry>
<entry>5800</entry>
<entry>3</entry>
</row>
<row>
<entry>18</entry>
<entry>5800</entry>
<entry>10</entry>
</row>
<row>
<entry>19</entry>
<entry>5800</entry>
<entry>20</entry>
</row>
<row>
<entry>20</entry>
<entry>5800</entry>
<entry>30</entry>
</row>
<row>
<entry>21</entry>
<entry>5800</entry>
<entry>40</entry>
</row>
<row>
<entry>22</entry>
<entry>5800</entry>
<entry>50</entry>
</row>
<row>
<entry>23</entry>
<entry>5800</entry>
<entry>70</entry>
</row>
<row>
<entry>24</entry>
<entry>5800</entry>
<entry>100</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Injection Control Maps
</p>
<p id="p-0053" num="0052">The inputs of the block I<smallcaps>NJECTION CONTROL MAPS </smallcaps>are the current speed of the engine and the value generated by the mass air flow sensor. The signal I<sub>FF </sub>represents the amount of fuel to be injected in the single cylinder of the engine for keeping the Air/Fuel ratio as close as possible to the stoichiometric value. The values of I<sub>FF </sub>are mapped in a look-up table determined in a preliminary calibration phase of the engine.</p>
<p id="p-0054" num="0053">In practice, the feedforward control system of this invention varies the amount of fuel to be injected into the combustion chamber of the cylinder of the engine as a function of the aspired air flow.</p>
<p id="h-0009" num="0000">Experimental Equipment</p>
<p id="p-0055" num="0054">The engine used both for the training of the mass air flow estimator of this invention and for its validation was a four stroke single cylinder SI engine Yamaha YP125 shown in <figref idref="DRAWINGS">FIG. 4</figref>, whose main features are shown in Table 2. The combustion engine in the test bench room was coupled to an asynchronous dynamometer APA 100 with a nominal power of 120 kW.</p>
<p id="p-0056" num="0055">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" rowsep="1">TABLE 2</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry/>
<entry>One-cylinder 4</entry>
</row>
<row>
<entry/>
<entry>Type</entry>
<entry>stroke</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Ignition and</entry>
<entry>Electronic</entry>
</row>
<row>
<entry/>
<entry>Injection System</entry>
</row>
<row>
<entry/>
<entry>Fuel System</entry>
<entry>Port injection</entry>
</row>
<row>
<entry/>
<entry>Displacement</entry>
<entry>125 cm<sup>3</sup></entry>
</row>
<row>
<entry/>
<entry>Bore</entry>
<entry>53.7 mm</entry>
</row>
<row>
<entry/>
<entry>Stroke</entry>
<entry>54.8 mm</entry>
</row>
<row>
<entry/>
<entry>Compression Ratio</entry>
<entry>10.4:1</entry>
</row>
<row>
<entry/>
<entry>Max Torque</entry>
<entry>10 Nm @ 7500 rpm</entry>
</row>
<row>
<entry/>
<entry>Max Power</entry>
<entry>8.5 kW @ 8750 rpm</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0057" num="0056">An optical encoder with high resolution (0.2 crank angle) was used for the determination of engine speed and piston position. The optical encoder ensured also the correct timing of the acquired pressure data. The electronic control of the engine was performed with a dSPACE Rapid Prototyping System, in which the engine control maps had been loaded. Using a graphical interface of the dSPACE system, it was possible to change in real time all the engine control parameters. The air charge estimator had been also loaded on the dSPACE system and one of its inputs was the amplified signal coming from a pressure transducer mounted in the cylinder head.</p>
<p id="h-0010" num="0000">Functioning of the Mass Air Flow Sensor</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 5</figref> shows graphs of the values generated by the MAF sensor of this invention and a known MAF sensor (debimeter) installed in the same engine. The two graphs practically coincide, demonstrating that the differences between the values generated by the two systems are very small (the percentage mean square difference is smaller than 1%). <figref idref="DRAWINGS">FIG. 6</figref> is an enlarged view of a portion of the graphs of <figref idref="DRAWINGS">FIG. 5</figref>, for better highlighting the tiny differences between the two graphs.</p>
<p id="h-0011" num="0000">Experimental Tests</p>
<p id="p-0059" num="0058">Experimental tests were carried out in order to gain information about the model capability to correctly estimate the amount of intake air, both in steady state and in transient conditions. In particular, for a running engine, a real time comparison was made between the output of the model and the value provided by the traditional hot wire anemometer.</p>
<p id="h-0012" num="0000">Results in Steady State Conditions</p>
<p id="p-0060" num="0059">In <figref idref="DRAWINGS">FIGS. 7 to 10</figref>, comparison graphs of the mass air flow values measured by means of a hot wire anemometer MAF sensor and the mass air flow values estimated by the soft computing estimator of this invention are shown. The figures refer to the engine in steady state run condition and they show the estimated and measured mass air flow for a single engine cycle. In particular, in <figref idref="DRAWINGS">FIG. 7</figref> and in <figref idref="DRAWINGS">FIG. 8</figref>, the measured and the estimated mass air flows are compared for an engine speed of 4600 rpm and a throttle opening of 70% and 20% respectively, <figref idref="DRAWINGS">FIG. 9</figref> and the <figref idref="DRAWINGS">FIG. 10</figref> show the comparison at the engine speed of 5800 rpm and a throttle opening of 30% and 100% (wide open throttle condition), respectively.</p>
<p id="p-0061" num="0060">These results confirm that the model is capable of providing an outstandingly good estimation of the intake air in steady state conditions, with a mean square error lower than 3% for all engine working conditions tested. The mean square error in the mass air flow estimation for each of the specified engine operating conditions is reported in Table 3.</p>
<p id="p-0062" num="0061">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="77pt" align="center"/>
<colspec colname="2" colwidth="56pt" align="center"/>
<colspec colname="3" colwidth="84pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="3" rowsep="1">TABLE 3</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Throttle opening</entry>
<entry/>
</row>
<row>
<entry>Speed (rpm)</entry>
<entry>(%)</entry>
<entry>Mean square error</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="77pt" align="center"/>
<colspec colname="2" colwidth="56pt" align="char" char="."/>
<colspec colname="3" colwidth="84pt" align="center"/>
<tbody valign="top">
<row>
<entry>4600</entry>
<entry>70</entry>
<entry>0.011</entry>
</row>
<row>
<entry>4600</entry>
<entry>20</entry>
<entry>0.029</entry>
</row>
<row>
<entry>5800</entry>
<entry>100</entry>
<entry>0.015</entry>
</row>
<row>
<entry>5800</entry>
<entry>30</entry>
<entry>0.010</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
Results in Transient Conditions
</p>
<p id="p-0063" num="0062">It is well known that under transient conditions, the dynamics of intake manifold filling/emptying play a significant role in the cylinder air charge determination. However, the soft computing model, employing the in-cylinder pressure signal as input, which contains information about the actual cylinder air charge, is not very sensitive to these dynamics and provides a good estimation of the intake air flow even during engine transients. At an engine speed of 3000 rpm, fast transient conditions were induced by opening the throttle from close to wide open position and back to the close position. Under these transient conditions, the mass air flow values measured by the hot wire anemometer sensor were acquired for 200 consecutive engine cycles.</p>
<p id="p-0064" num="0063">Comparison graphs between the value of the measured mass air flow (average value in the engine cycle) and the value (average value in the engine cycle) of the mass air flow estimated of the soft-computing estimator of this invention are shown in <figref idref="DRAWINGS">FIG. 11</figref>.</p>
<p id="p-0065" num="0064">It may be observed that the measure provided by the physical sensor mounted upstream the intake manifold does not discriminate (compensate) the manifold filling/emptying dynamics, thus it may reasonably be regarded as not so accurate in the evaluation of the actual cylinder air charge, during fast transients. This could explain the differences between the values calculated on the basis of the physical sensor of air flow and those estimated according to the present invention.</p>
<p id="p-0066" num="0065">In particular, according to <figref idref="DRAWINGS">FIG. 11</figref>, the mass air flow measurement by the anemometer appears to provide for a faster response to rapid throttle variations than the soft-computing mass air flow estimator of this invention. This appears to confirm that, during transients, the soft-computing mass air flow estimator of this invention intrinsically accounts for the contribution due to the air dynamics in the intake manifold, explaining the differences between the two graphs.</p>
<p id="p-0067" num="0066">The feedforward control system of this invention may also be used in a feedback-and-feedforward control system such as that depicted in <figref idref="DRAWINGS">FIG. 1</figref>, even in conjunction with the virtual lambda sensor disclosed in the cited prior European Patent application No. 05,425,121.0. Such a joint control system would have a relatively low cost and would be capable of determining the amount of fuel to be injected in the combustion chamber of a cylinder as a function of both the estimated Mass Air Flow and of the lambda value of the engine.</p>
<p id="p-0068" num="0067">The soft-computing mass air flow estimator of this invention is capable of providing real time estimation of the cylinder air charge, using a cylinder pressure sensor without the need of a relatively costly physical MAF sensors.</p>
<p id="p-0069" num="0068">The same in-cylinder pressure sensor [6] [7] could be useful for a host of other functions in the electronic control of SI engines (e.g. misfire detection, knock detection, Air/Fuel control without lambda sensor, etc., [12], [13], [14], [15]).</p>
<p id="p-0070" num="0069">Experimental tests on a single-cylinder engine have demonstrated the model effectiveness in estimating the mass air flow in steady state conditions. In transient conditions the model has revealed good but not fully demonstrated satisfactory performances in cylinder air charge estimation. A correct validation of the model even during fast transients will require more specific tests.</p>
<p id="p-0071" num="0070">The applicants' approach, developed for a single cylinder engine, may be easily extended to SI engines with a plurality of cylinders. In this case, a mass air flow estimator for each cylinder of the engine using the relative combustion pressure signal may be implemented. In this way, even a different Air/Fuel control system for each cylinder of the engine could be implemented.</p>
<p id="p-0072" num="0071">According to a preferred embodiment of the invention, the lambda sensor may be a virtual lambda sensor of the type described in the cited prior European Patent application No. 05,425,121.0.</p>
<heading id="h-0013" level="1">REFERENCES</heading>
<p id="p-0073" num="0000">
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0072">1. Heywood, J. B.,—“Internal combustion engine fundamentals”—McGraw-Hill Book Co., 1988.</li>
    <li id="ul0001-0002" num="0073">2. Barbarisi, O., Di Gaeta, A., Glielmo, L., and Santini, S., “An Extended Kalman Observer for the In-Cylinder Air Mass Flow Estimation”, MECA02 International Workshop on Diagnostics in Automotive Engines and Vehicles, 2001.</li>
    <li id="ul0001-0003" num="0074">3. Grizzle, J. W., Cookyand, J. A., and Milam, W. P., “Improved Cylinder Air Charge Estimation for Transient Air Fuel Ratio Control”, Proceedings of American Control Conference, 1994.</li>
    <li id="ul0001-0004" num="0075">4. Jankovic, M., Magner, S. W., “Air Charge Estimation and Prediction in Spark Ignition Internal Combustion Engines”, Proceedings of the American Conference, San Diego, Calif., June 1999.</li>
    <li id="ul0001-0005" num="0076">5. Stotsky, I., Kolmanovsky, A., “Application of input estimation and control in automotive engines” Control Engineering Practice 10, pp. 1371-1383, 2002.</li>
    <li id="ul0001-0006" num="0077">6. Sellnau, M. C., Matekunas, F. A., Battiston, P. A., Chang, C. F., and Lancaster, D. R., “Cylinder-Pressure-Based Engine Control Using Pressure-Ratio-Management and Low-Cost Non-Intrusive Cylinder Pressure Sensors”, SAE paper 2000-01-0932, 2000.</li>
    <li id="ul0001-0007" num="0078">7. Powell, J. D., “Engine control using cylinder pressure: Past, present and future”, Journal of Dynamic Systems, Measurement and Control—Vol. 115, n<sup>o </sup>2B, 1993.</li>
    <li id="ul0001-0008" num="0079">8. Haykin, S., “Neural Networks: A comprehensive Foundation”, Prentice Hall International Editions, Piscataway, 1999.</li>
    <li id="ul0001-0009" num="0080">9. Craven, P., and Wahba, G., “Smoothing noisy data with spline functions: Estimating the correct degree of smoothing by the method of generalized crossvalidation”, Numerische Mathematik, vol. 31, pag. 377-403, 1979.</li>
    <li id="ul0001-0010" num="0081">10. Vapnik, V. N., “An overview of Statistical Learning Theory”, IEEE Trans. On Neural Networks, vol. 9, 1999.</li>
    <li id="ul0001-0011" num="0082">11. Eberhart, R. C. and Kennedy, J. “A new optimizer using particle swarm theory”, Proceedings of the sixth international symposium on micro machine and human science pp. 39-43. IEEE service center, Piscataway, N.J., Nagoya, Japan, 1995.</li>
    <li id="ul0001-0012" num="0083">12. Cesario, N., Di Meglio, M., and Pirozzi, F., “Realization of a Virtual Lambda Sensor on a Fixed Precision System”, published in IEEE Proceedings of the DATE05 (Design, Automation and Test in Europe) International Conference—Designer's Forum.</li>
    <li id="ul0001-0013" num="0084">13. Pirozzi, F., Cesario, N. and Lavorgna, M., “Modelling On-Off Virtual Lambda Sensors based on Multi-Spread Probabilistic Neural Networks”, proposed to the 10th IEEE International Conference on Emerging Technologies and Factory Automation (ETFA05), 19-22 Sep. 2005, Catania, Italy.</li>
    <li id="ul0001-0014" num="0085">14. Cesario, N., Di Meglio, M., Pirozzi, F., Moselli, G., Taglialatela, F., Carpentieri, F., “Air/Fuel Control System in SI Engines based on a Virtual Lambda Sensor”, SAE-ICE2005 7-th International Conference On Engine for Automobiles, SAE paper 2005-24-058.</li>
    <li id="ul0001-0015" num="0086">15. Taglialatela, F., Moselli, G. and Lavorgna, M., “Engine Knock Detection and Control Using In-Cylinder Pressure Cycle and Soft Computing Techniques”, SAE-ICE2005 2005 7-th International Conference On Engine for Automobiles, SAE paper 2005-24-061.</li>
</ul>
</p>
<heading id="h-0014" level="1">DEFINITIONS, ACRONYMS, ABBREVIATIONS</heading>
<p id="p-0074" num="0000">
<ul id="ul0002" list-style="none">
    <li id="ul0002-0001" num="0087">ATDC: After TDC</li>
    <li id="ul0002-0002" num="0088">BTDC: Before TDC</li>
    <li id="ul0002-0003" num="0089">EGR: Exhaust Gas Recirculation</li>
    <li id="ul0002-0004" num="0090">MAF: Mass Air Flow</li>
    <li id="ul0002-0005" num="0091">MAP: Manifold Absolute Pressure</li>
    <li id="ul0002-0006" num="0092">MLP: Multi Layer Perceptron</li>
    <li id="ul0002-0007" num="0093">PCA: Principal Component Analysis</li>
    <li id="ul0002-0008" num="0094">PSOA: Particle Swarm Optimization Algorithm</li>
    <li id="ul0002-0009" num="0095">SI: Spark Ignition</li>
    <li id="ul0002-0010" num="0096">TDC: Top Dead Center</li>
</ul>
</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07299123-20071120-M00001.NB">
<img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US07299123-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07299123-20071120-M00002.NB">
<img id="EMI-M00002" he="6.35mm" wi="76.20mm" file="US07299123-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07299123-20071120-M00003.NB">
<img id="EMI-M00003" he="24.38mm" wi="76.20mm" file="US07299123-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07299123-20071120-M00004.NB">
<img id="EMI-M00004" he="4.57mm" wi="76.20mm" file="US07299123-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>That which is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of estimating inlet air flow in a combustion chamber of a cylinder of an internal combustion engine, the method comprising:
<claim-text>providing an adaptive controller;</claim-text>
<claim-text>training the adaptive controller to reproduce an operation of a mass air flow physical sensor;</claim-text>
<claim-text>sensing at least a pressure in the combustion chamber of the cylinder of the engine and generating a cylinder pressure signal;</claim-text>
<claim-text>extracting characteristic parameters of the cylinder pressure signal; and</claim-text>
<claim-text>using the adaptive controller to generate an estimated signal representative of the inlet air flow in the combustion chamber based upon the characteristic parameters.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein providing the adaptive controller comprises providing a learning machine implemented with soft-computing techniques.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the adaptive controller is input with at least one of an engine throttle position signal, an engine speed signal, an engine drive shaft angular position signal, and the cylinder pressure signal.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A method of determining inlet air flow in a combustion chamber of a cylinder of an internal combustion engine, the method comprising:
<claim-text>providing an mass air flow predictor trained to reproduce an operation of a mass air flow physical sensor;</claim-text>
<claim-text>sensing a pressure in the combustion chamber of the cylinder of the engine and generating a cylinder pressure signal; and</claim-text>
<claim-text>using the adaptive controller to generate an estimated signal representative of the inlet air flow in the combustion chamber based upon the cylinder pressure signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, further comprising extracting characteristic parameters of the cylinder pressure signal; wherein the adaptive controller generates the estimated signal based upon the characteristic parameters.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein providing the adaptive controller comprises providing a learning machine implemented with soft-computing techniques.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the adaptive controller is input with at least one of an engine throttle position signal, an engine speed signal, an engine drive shaft angular position signal, and the cylinder pressure signal.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. An inlet air flow estimator for a combustion chamber of a cylinder of an internal combustion engine, the estimator comprising:
<claim-text>a pressure sensor generating a pressure signal of a pressure in the combustion chamber of the cylinder of the engine; and</claim-text>
<claim-text>a trained adaptive controller input with at least the cylinder pressure signal to generate an estimated signal representative of the inlet air flow in the combustion chamber of the engine based upon at least characteristic parameters of the pressure signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The estimator of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein said trained adaptive controller comprises:
<claim-text>an enabling/disabling unit for enabling the estimator when a drive shaft angular position is within a range corresponding to a start position and an end position of an aspiration phase;</claim-text>
<claim-text>a pre-processor downstream from the enabling/disabling unit and for generating a signal representing an average of at least the characteristic parameters of the cylinder pressure signal;</claim-text>
<claim-text>a neural network downstream from the pre-processor and for generating an intermediate signal indicative of the inlet air flow; and</claim-text>
<claim-text>a post-processor input with the intermediate signal and for generating the estimate signal as an average of the intermediate signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The estimator of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said pre-processor further generates signals representing averages of an engine speed and an engine throttle position, and said neural network generates the intermediate signal based upon the signals generated by the pre-processor.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The estimator of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said enabling/disabling unit enables and disables the estimator when a crank angle of the engine is −360 degrees and −140 degrees, respectively.</claim-text>
</claim>
</claims>
</us-patent-grant>
