<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298179-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298179</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11386916</doc-number>
<date>20060322</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>05006295</doc-number>
<date>20050322</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>51</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>1</main-group>
<subgroup>08</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>327 34</main-classification>
<further-classification>327 99</further-classification>
</classification-national>
<invention-title id="d0e71">Digital clock switching means</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5574753</doc-number>
<kind>A</kind>
<name>Vartti et al.</name>
<date>19961100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6831959</doc-number>
<kind>B1</kind>
<name>Manchester</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6882206</doc-number>
<kind>B2</kind>
<name>Lawler et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>327291</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7023944</doc-number>
<kind>B2</kind>
<name>Gau</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375373</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0164782</doc-number>
<kind>A1</kind>
<name>Zampetti et al.</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>EP</country>
<doc-number>0 591 593</doc-number>
<kind>A1</kind>
<date>19940400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>EP</country>
<doc-number>0 841 834</doc-number>
<kind>A2</kind>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>21</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>327 34</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>327 99</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>327407</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>9</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060224911</doc-number>
<kind>A1</kind>
<date>20061005</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Lewis</last-name>
<first-name>Michael</first-name>
<address>
<city>Märsta</city>
<country>SE</country>
</address>
</addressbook>
<nationality>
<country>SE</country>
</nationality>
<residence>
<country>SE</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Eschweiler &amp; Associates, LLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Infineon Technologies AG</orgname>
<role>03</role>
<address>
<city>Munich</city>
<country>DE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Wells</last-name>
<first-name>Kenneth B.</first-name>
<department>2816</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A digital clock switching circuit and method is disclosed and is operable to deadlock-free switch a digital clock source for an integrated circuit. The circuit includes a first finite state machine associated with a first clock source and a second finite state machine associated with a second clock source. The finite state machines are connected to each other and monitor the current state of the other finite state machine. Each finite state machine receives an input select signal to control which clock source should be active and passed to a clock output. Each finite state machine includes a counter, wherein the counter associated with the active clock source is initialized to a first predetermined value when the input select signal indicates a switching off of the active clock source. The finite state machine associated with the active clock source enters a CHECK state and varies a count at each clock cycle. If the other finite state machine verifies a presence of its clock source before the counter reaches a second predetermined value the switch of the active clock source is effected.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="192.11mm" wi="144.86mm" file="US07298179-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="206.33mm" wi="155.19mm" file="US07298179-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="160.36mm" wi="126.32mm" file="US07298179-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="197.10mm" wi="145.88mm" file="US07298179-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="159.51mm" wi="111.08mm" file="US07298179-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="210.82mm" wi="150.62mm" file="US07298179-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="158.92mm" wi="142.83mm" file="US07298179-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="206.84mm" wi="143.26mm" file="US07298179-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="163.07mm" wi="142.16mm" file="US07298179-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="146.05mm" wi="96.77mm" file="US07298179-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims the benefit of the priority date of European application 05 006 295.9, filed on Mar. 22, 2005, the contents of which are herein incorporated by reference in their entirety.</p>
<heading id="h-0002" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a digital clock switching system operable to deadlock-free switch the source of a digital clock for an integrated circuit, and a method associated therewith.</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">Most digital integrated circuits require a clock signal to synchronize their activity. Often, a circuit will be designed so that the clock signal can come from more than one source. For example, it may either be generated internally on the chip, or be supplied externally. The motivation for such a design is flexibility and reduced power consumption: in some applications, there could already be an externally generated clock available and so to generate another clock on-chip is wasteful of energy. In other applications, no such external clock may be available. Since it is extremely expensive to produce many different variants of an integrated circuit, common practice is to design a chip to meet both requirements.</p>
<p id="p-0005" num="0004">For this to be possible, there must exist a circuit for changing the source of the digital clock. Such a change-over must be glitch free, i.e. it must be possible to guarantee that the clock seen by the digital system neither has very short pulses, nor very closely spaced clock pulses. Since the internal and external clocks are asynchronous to one another, this change-over needs to be performed with some care. Typically, it is ensured that the first clock signal is paused for a sufficient duration, before the second clock signal is allowed to take over.</p>
<p id="p-0006" num="0005">A conventional circuit for performing this function is shown in <figref idref="DRAWINGS">FIG. 1</figref>. The circuit <b>50</b> consists of two finite state machines (FSMs) <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>that are responsible for managing the switch-over. Each FSM <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>is associated with a clock input, Clk_A or Clk_B. The FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>change their state on the 1-&gt;0 transition of the relevant clock input. Each FSM <b>52</b><sub>1</sub>; <b>52</b><sub>2 </sub>has an output ClkEn which, when set to 1, causes the respective clock to be passed to the clock output Clk_Out. The input signal Select, assumed to be synchronous to Clk_Out, specifies which clock should be active. Each FSM <b>52</b><sub>1</sub>; <b>52</b><sub>2 </sub>monitors the state of the other clock enable signal via the input OtherClkEn. Since the input clocks are assumed to be asynchronous to one another, it is necessary to use a double latch synchronizer <b>54</b><sub>1</sub>, <b>54</b><sub>2 </sub>for the input signals which come from other clock domains.</p>
<p id="p-0007" num="0006">The circuit <b>50</b> disclosed in <figref idref="DRAWINGS">FIG. 1</figref> also comprises two second double latch synchronizers <b>56</b><sub>1</sub>, <b>56</b><sub>2 </sub>connected to the FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>and having the signal (Select) as inputs. The circuit <b>50</b> also comprises two AND-gates <b>58</b><sub>1</sub>, <b>58</b><sub>2 </sub>connected to the FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>and to the clock sources Clk_A, Clk_B. As is apparent from <figref idref="DRAWINGS">FIG. 1</figref>, the AND-gates. <b>58</b><sub>1</sub>, <b>58</b><sub>2 </sub>are also connected to an OR gate <b>60</b> which has an output in the form of the clock output, Clk_Out.</p>
<p id="p-0008" num="0007">The function of the circuit <b>50</b> is best explained via the state diagram for the FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2</sub>, shown in <figref idref="DRAWINGS">FIG. 2</figref>. The FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>differ only in their reset behavior and the polarity of the Select signal to which they respond. It is assumed that Clk_A is to be enabled at reset, and Select is zero. The variable A in the state diagram is set to ‘1’ for the FSM <b>52</b><sub>1 </sub>associated with Clk_A and set to ‘0’ for the FSM <b>52</b><sub>2 </sub>associated with Clk_B.</p>
<p id="p-0009" num="0008">At reset, both FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>begin in the RESET state. The upper FSM <b>52</b><sub>1 </sub>(A==1) proceeds into the ON state, asserts ClkEn and allows Clk_A to pass to Clk_Out. The lower FSM <b>52</b><sub>2 </sub>(A==0) proceeds into the OFF state.</p>
<p id="p-0010" num="0009">At some point, the system desires to change its clock source and changes Select to ‘1’. The upper FSM <b>52</b><sub>1 </sub>observes the change, and proceeds to disable its clock by de-asserting ClkEn. Since the two FSMs <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>are not synchronized, it is necessary for the lower FSM <b>52</b><sub>2 </sub>to ensure that the upper FSM <b>52</b><sub>1 </sub>has released the clock output. Therefore, on observing the change in Select, the lower FSM <b>52</b><sub>2 </sub>proceeds to the WAIT state. Only when it observes that the upper FSM <b>52</b><sub>1 </sub>has released the clock output (OtherClkEn==0) does it proceed to the ON state and allows the clock to pass.</p>
<p id="p-0011" num="0010">The problem with the standard clock switch circuit <b>50</b> occurs when the clock to be switched to (for instance, Clk_B) is not present. This could be due to a misunderstanding about the application circuit, or due to a fabrication error of the integrated circuit. When the system requests to change the clock source, the upper FSM <b>52</b><sub>1 </sub>will disable the output clock. However, the lower FSM <b>52</b><sub>2 </sub>has no clock, and will never transition to the ON state. This causes a deadlock, since the system clock will not be restarted and so Select can not be changed. Such a deadlock is highly undesirable, as it means that the chip simply ceases to function with no diagnostic information and with no possibility to resume function in the alternative operating mode (using Clk_A).</p>
<heading id="h-0004" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0012" num="0011">The following presents a simplified summary in order to provide a basic understanding of one or more aspects of the invention. This summary is not an extensive overview of the invention, and is neither intended to identify key or critical elements of the invention, nor to delineate the scope thereof. Rather, the primary purpose of the summary is to present one or more concepts of the invention in a simplified form as a prelude to the more detailed description that is presented later.</p>
<p id="p-0013" num="0012">According to one embodiment of the invention, a digital clock switching circuit operable to deadlock-free switch the source of the digital clock for an integrated circuit is provided. The digital clock switching circuit comprises a first finite state machine associated with a first clock source, and a second finite state machine associated with a second clock source. The finite state machines are connected to each other and configured to monitor the current state of the other finite state machine. Each finite state machine is configured to receive an input signal (Select) operable to control which clock source should be active and passed to a clock output of the digital clock switching circuit.</p>
<p id="p-0014" num="0013">In one embodiment, each finite state machine comprises a counter with a variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>), wherein the counter associated with the active clock source will get its variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) initialized to a constant (Nfail<sub>1</sub>, Nfail<sub>2</sub>) when said input signal (Select) indicates the switching off of the active clock source, whereby the finite state machine associated with the active clock source enters a CHECK state, and wherein the respective counter decrements the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) at each clock cycle. If the other finite state machine verifies the presence of its clock source before the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) reaches zero, the switch of the active clock source will be effected. If, on the other hand, the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) decrements to zero and no such verification has occurred, no switch of the active clock source will be effected. The main advantage with the digital clock switching circuit according to the invention is that it guarantees that the system never enters a deadlock state in the absence of one clock source.</p>
<p id="p-0015" num="0014">In another embodiment a further advantage is achieved if each finite state machine has an output, a clock enable signal (ClkEn<sub>1</sub>, ClkEn<sub>2</sub>), each of which is a first input to a respective AND-gate, wherein each AND-gate has a second input that receives the respective clock source (Clk_A, Clk_B). The digital clock switching circuit also comprises a first OR-gate coupled to the output of each AND-gate and operable to output the clock output (Clk_Out) of the digital clock switching circuit.</p>
<p id="p-0016" num="0015">Furthermore, it is an advantage in another embodiment if the clock enable signal (Clk_En<sub>1</sub>; Clk_En<sub>2</sub>) of each finite state machine is connected, via a first double latch synchronizer, to an input (Other ClkEn<sub>2</sub>; Other ClkEn<sub>1</sub>) of the other finite state machine, whereby each finite state machine is able to monitor the state of the other clock enable signal (ClkEn<sub>2</sub>, ClkEn<sub>1</sub>) via said input (Other ClkEn<sub>1</sub>, Other ClkEn<sub>2</sub>).</p>
<p id="p-0017" num="0016">In still another embodiment, a further advantage is achieved if each finite state machine is connected to a second double latch synchronizer, whereby said input signal (Select) passes via said second double latch synchronizer.</p>
<p id="p-0018" num="0017">In yet another embodiment, it is an advantage if the first clock source (Clk_A) is connected to and controls the first and second double latch synchronizers connected to the first finite state machine, and the second clock source (Clk_B) is connected to and controls the first and second double latch synchronizers connected to the second finite state machine.</p>
<p id="p-0019" num="0018">In another embodiment a further advantage is achieved if the finite state machine is operable to disable the active clock source (Clk_A; Clk_B) before the other finite state machine verifies the presence of its clock source (Clk_B; Clk_A).</p>
<p id="p-0020" num="0019">According to another embodiment, the finite state machine associated with the inactive clock source (Clk_B; Clk_A) is operable to verify the presence of its clock source (Clk_B; Clk_A) before the other finite state machine disables the active clock source (Clk_A; Clk_B).</p>
<p id="p-0021" num="0020">In a further embodiment, the digital clock switching circuit also comprises a second OR-gate connected to an Error output (Error<sub>1</sub>, Error<sub>2</sub>) of each finite state machine. In such an embodiment, if the counter has decremented the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) to zero, the finite state machine currently in the CHECK state is operable to enter an ERROR state, wherein the finite state machine is operable to re-enable the active clock source (Clk_A; Clk_B), which will be passed to the clock output (Clk_Out), and to issue an error signal to the second OR-gate.</p>
<p id="p-0022" num="0021">In still another embodiment each finite state machine also comprises an output (S<sub>w</sub>OK<sub>1</sub>;S<sub>w</sub>OK<sub>2</sub>) and an input (Other S<sub>w</sub>OK<sub>1</sub>;Other S<sub>w</sub>OK<sub>2</sub>), wherein the output (S<sub>w</sub>OK<sub>1</sub>;S<sub>w</sub>OK<sub>2</sub>) of each finite state machine is connected, via a third double latch synchronizer, to the input (Other S<sub>w</sub>OK<sub>2</sub>;Other S<sub>w</sub>OK<sub>1</sub>) of the other finite state machine. In such embodiment, the first clock source (Clk_A) is connected to and is operable to control the third double latch synchronizer connected to the first finite state machine. Similarly, the second clock source (Clk_B) is connected to and is operable to control the third double latch synchronizer connected to the second finite state machine.</p>
<p id="p-0023" num="0022">In another embodiment, if the finite state machine has its clock enable signal (ClkEn<sub>1</sub>; ClkEn<sub>2</sub>) active, and the input signal (Select) indicates the switching off of the active clock source (Clk_A; Clk_B), the finite state machine is operable to enter a CHECK state, wherein the active clock source (Clk_A; Clk_B) is disabled. Further, if the other finite state machine has its output (S<sub>w</sub>OK<sub>2</sub>; S<sub>w</sub>OK<sub>1</sub>) active before the counter has decremented the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) to zero, and if the other finite state machine does not have its output (S<sub>w</sub>OK<sub>2</sub>; S<sub>w</sub>OK<sub>1</sub>) active before the counter has decremented the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) to zero, the finite state machine is operable to enter the ERROR state and issue the error signal to the second OR-gate.</p>
<p id="p-0024" num="0023">In addition, if the finite state machine has its clock enable signal (ClkEn<sub>1</sub>; ClkEn<sub>2</sub>) inactive, and the input signal (Select) indicates the switching on of its clock source (Clk_A; Clk_B), the finite state machine is operable to enter a WAIT state and its output (S<sub>w</sub>OK<sub>1</sub>; S<sub>w</sub>OK<sub>2</sub>) is operable to become active. In addition, when the other finite state machine has switched off its clock source (Clk_B; Clk_A), the other clock source (Clk_A; Clk_B) is operable to be active and passed to the clock output (Clk_Out).</p>
<p id="p-0025" num="0024">The invention is also directed to a method for deadlock-free switching of the source of a digital clock for an integrated circuit. The method is performed with the aid of a first and a second clock source (Clk_A, Clk_B), wherein the first clock source (Clk_A) is active, and the second clock source (Clk_B) is inactive. The method comprises initializing a variable (Cnt<sub>1</sub>) to a constant (Nfail<sub>1</sub>, Nfail<sub>2</sub>) when the switching off of the active clock source (Clk_A) is indicated, and decrementing the variable at each clock cycle. The method further comprises switching the active clock source (Clk_A) if the presence of the inactive clock source (Clk_B) is verified before the variable (Cnt<sub>1</sub>) reaches zero. Alternatively, if the variable (Cnt<sub>1</sub>) decrements to zero, no switch of the active clock source (Clk_A) is effected. The method of the invention advantageously guarantees that the system never enters a deadlock state in the absence of one clock source.</p>
<p id="p-0026" num="0025">In one embodiment the method advantageously verifies the presence of the inactive clock source (Clk_B) before disabling the active clock source (Clk_A). In another embodiment, if the variable (Cnt<sub>1</sub>) has decremented to zero, the active clock source (Clk_A) is re-enabled, and an error indication is issued.</p>
<p id="p-0027" num="0026">In one embodiment, the method is performed with the aid of a digital clock switching circuit comprising a first finite state machine associated with the first clock source (Clk_A), and a second finite state machine associated with the second clock source (Clk_B). Each finite state machine has an input signal (Select) operable to control which clock source (Clk_A; Clk_B) should be active and passed to a clock output (Clk_Out) of the digital clock switching circuit. In addition, each finite state machine comprises a counter with a variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>). In such context the method also comprises entering a CHECK state with the finite state machine associated with the active clock source (Clk_A) when the input signal (Select) indicates the switching off of the active clock source (Clk_A).</p>
<p id="p-0028" num="0027">In yet another embodiment, if each finite state machine has an output, clock enable signal (ClkEn<sub>1</sub>, ClkEn<sub>2</sub>) which is connected, via a first double latch synchronizer, to an input (Other ClkEn<sub>2</sub>; Other ClkEn<sub>1</sub>) of the other finite state machine, the method also comprises each finite state machine monitoring the state of the other clock enable signal (ClkEn<sub>2</sub>, ClkEn<sub>1</sub>).</p>
<p id="p-0029" num="0028">Further, if each finite state machine also comprises an output (S<sub>w</sub>OK<sub>1</sub>; S<sub>w</sub>OK<sub>2</sub>) and an input (Other S<sub>w</sub>OK<sub>1</sub>; Other S<sub>w</sub>OK<sub>2</sub>), the method also comprises entering a CHECK state with the finite state machine if the finite state machine has its clock enable signal (ClkEn<sub>1</sub>,ClkEn<sub>2</sub>) active, and the input signal (Select) indicates the switching off of the active clock source (Clk_A; Clk_B). The method further comprises disabling the active clock source (Clk_A; Clk_B) if the other finite state machine has its output (S<sub>w</sub>OK<sub>2</sub>; S<sub>w</sub>OK<sub>1</sub>) active before the counter means has decremented the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) to zero. In addition, the other finite state machine does not have its output (S<sub>w</sub>OK<sub>2</sub>; S<sub>w</sub>OK<sub>1</sub>) active before the counter has decremented the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) to zero, the finite state machine enters the ERROR state, and an error signal is issued.</p>
<p id="p-0030" num="0029">In another embodiment, the method comprises entering a WAIT state with the finite state machine and activating its output if the finite state machine has its clock enable signal (ClkEn<sub>1</sub>; ClkEn<sub>2</sub>) inactive, and the input signal (Select) indicates the switching on of the clock source (Clk_A; Clk_B). In addition, the method comprises activating the other clock source and passing it to the clock output when the other finite state machine has switched off its clock source (Clk_B; Clk_A).</p>
<p id="p-0031" num="0030">Another embodiment of the invention comprises at least one computer program product for deadlock-free switching of the source of the digital clock for an integrated circuit. The computer program product(s) is/are directly loadable into the internal memory of at least one computer digital, and comprises software code portions for performing the method according to the invention, when the at least one product is/are run on the at least one computer.</p>
<p id="p-0032" num="0031">It should be emphasized that the term “comprises/comprising” when used in this specification is taken to specify the presence of stated features, steps or components but does not preclude the presence of one or more other features, integers, steps, components or groups thereof.</p>
<p id="p-0033" num="0032">To the accomplishment of the foregoing and related ends, the invention comprises the features hereinafter fully described and particularly pointed out in the claims. The following description and the annexed drawings set forth in detail certain illustrative aspects and implementations of the invention. These are indicative, however, of but a few of the various ways in which the principles of the invention may be employed. Other objects, advantages and novel features of the invention will become apparent from the following detailed description of the invention when considered in conjunction with the drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0034" num="0033">Embodiments of the invention will now be described with a reference to the accompanying drawings, in which:</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a known circuit <b>50</b> for glitch free clock source switch over;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 2</figref> is a state diagram for the finite state machines <b>52</b><sub>1</sub>, <b>52</b><sub>2 </sub>comprised in the circuit <b>50</b> disclosed in <figref idref="DRAWINGS">FIG. 1</figref>, in order to explain the function of the circuit <b>50</b>;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram of an embodiment of a digital clock switching circuit <b>10</b> operable to deadlock-free switch the source of the digital clock for an integrated circuit according to the invention;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 4</figref> is a flow chart of a method for deadlock-free switching of the source of the digital clock for an integrated circuit according to another embodiment of the invention;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of another embodiment of a digital clock switching means <b>10</b> according to the invention;</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 6</figref> is a state diagram for the finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>comprised in the digital clock switching circuit disclosed in <figref idref="DRAWINGS">FIG. 5</figref>;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 7</figref> is a block diagram of yet another embodiment of a digital clock switching means <b>10</b> according to the invention;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 8</figref> is a state diagram for the finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>comprised in the digital clock switching circuit <b>10</b> disclosed in <figref idref="DRAWINGS">FIG. 7</figref>; and</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 9</figref> is a schematic diagram of some computer program products <b>102</b><sub>1</sub>, . . . , <b>102</b><sub>2 </sub>according to the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0044" num="0043">In <figref idref="DRAWINGS">FIG. 3</figref> there is disclosed a block diagram of one embodiment of a digital clock switching circuit <b>10</b> according to the present invention. The digital clock switching circuit <b>10</b> is operable to deadlock-free switch the source of the digital clock for an integrated circuit. The digital clock switching circuit <b>10</b> comprises a first finite state machine <b>12</b><sub>1 </sub>associated with a first clock source Clk_A, and a second finite state machine <b>12</b><sub>2 </sub>associated with a second clock source Clk_B. As is apparent from <figref idref="DRAWINGS">FIG. 3</figref>, the finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>are connected to each other, via the signals ClkEn<sub>1</sub>, ClkEn<sub>2</sub>, Other ClkEn<sub>1</sub>, Other ClkEn<sub>2</sub>, in order to monitor the current state of the other finite state machine <b>12</b><sub>2</sub>, <b>12</b><sub>1</sub>, respectively. Each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>has an input signal (Select) operable to control which clock source Clk_A;Clk_B that should be active and passed to a clock output Clk_Out of the digital clock switching circuit <b>10</b>. Each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>comprises a counter <b>14</b><sub>1</sub>, <b>14</b><sub>2 </sub>with a count variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>), wherein the counter associated with the active clock source get its variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) initialized to a constant value (Nfail<sub>1</sub>, Nfail<sub>2</sub>) when the input signal (Select) indicates the switching off of the active clock source Clk_A;Clk_B. In this instance the finite state machine <b>12</b><sub>1</sub>;<b>12</b><sub>2 </sub>associated with the active clock source Clk_A;Clk_B enters a CHECK state, wherein the counter <b>14</b><sub>1</sub>, <b>14</b><sub>2 </sub>decrements the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) at each clock cycle. If the other finite state machine <b>12</b><sub>2</sub>, <b>12</b><sub>1 </sub>verifies the presence of its clock source Clk_B;Clk_A before the respective variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) reach zero, the switch of the active clock source will be effected, Clk_B;Clk_A. If, on the other hand, the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) decrements to zero, then the other clock source is unavailable and no switch of the active clock source will be effected Clk_A;Clk_B.</p>
<p id="p-0045" num="0044">In the above example, the counter begins at a count variable and decrements toward zero, however, it should be understood that the present invention contemplates any counting from a first predetermined value to a second predetermined value, either incrementing or decrementing, and any such count functionality is contemplated as falling within the scope of the invention.</p>
<p id="p-0046" num="0045">In <figref idref="DRAWINGS">FIG. 4</figref> there is disclosed a flow chart of a method for deadlock-free switching of the source of the digital clock for an integrated circuit according to one embodiment of the invention. The method is performed with the aid of a first and a second clock source Clk_A,Clk_B, wherein the first clock source Clk_A is active, and the second clock source Clk_B is inactive in this example. The method begins at <b>70</b>. The method continues at <b>72</b> with an initialization of a variable (Cnt<sub>1</sub>) to a constant value (Nfail<sub>1</sub>) when the switching off of the active clock source Clk_A is indicated. Thereafter, at <b>74</b>, the method continues with decrementing the variable count (Cnt<sub>1</sub>) at each clock cycle. The method continues at <b>76</b> with the query whether the variable (Cnt<sub>1</sub>) is greater than zero. If the answer is negative at <b>76</b>, the method continues at <b>78</b> where no switch of the active clock source will be effected, i.e. Clk_A will remain active. If, on the other hand the answer to the query at <b>76</b> is affirmative, the method continues at <b>80</b> with another query whether the presence of the inactive clock source Clk_B is verified. If the answer at <b>80</b> is negative, the method continues by returning to <b>74</b>. If, on the other hand, the answer to the query at <b>80</b> is affirmative, the method continues at <b>82</b>, and the active clock source is switched, i.e. the clock source Clk_B will be active. The method is completed at <b>84</b>.</p>
<p id="p-0047" num="0046">In <figref idref="DRAWINGS">FIG. 5</figref> there is disclosed a block diagram of another embodiment of a digital clock switching circuit <b>10</b> according to the invention. The digital clock switching circuit <b>10</b> is operable to deadlock-free switch the source of the digital clock for an integrated circuit. The digital clock switching circuit <b>10</b> comprises a first finite state machine <b>12</b><sub>1 </sub>connected to a first clock source Clk_A, and a second finite state machine <b>12</b><sub>2 </sub>connected to a second clock source Clk_B. The finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>are connected to each other, via the signals ClkEn<sub>1</sub>, ClkEn<sub>2</sub>, Other ClkEn<sub>1</sub>, Other ClkEn<sub>2</sub>, in order to monitor the current state of the other finite state machine <b>12</b><sub>1</sub>; <b>12</b><sub>2</sub>. Each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>has an input signal (Select) operable to control which clock source Clk_A; Clk_B that should be active and passed to a clock output Clk_Out of the digital clock switching circuit <b>10</b>. Each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>comprises a counter <b>14</b><sub>1</sub>, <b>14</b><sub>2 </sub>with a variable count (Cnt<sub>1</sub>; Cnt<sub>2</sub>), wherein the counter associated with the active clock source get its variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) initialized to a constant value (Nfail<sub>1</sub>, Nfail<sub>2</sub>) when the input signal (Select) indicates the switching off of the active clock source Clk_A; Clk_B. In this instance the finite state machine <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>connected to the active clock source Clk_A; Clk_B enters a CHECK state, wherein the respective counter <b>14</b><sub>1</sub>; <b>14</b><sub>2 </sub>decrements the associated variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) at each clock cycle. If the other finite state machine <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>verifies the presence of its clock source Clk_B; Clk_A before the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) reaches zero, the switch of the active clock source will be effected, Clk_B; Clk_A. If, on the other hand, the variable (Cnt<sub>1</sub>; Cnt<sub>2</sub>) decrements to zero, no switch of the active clock source will be effected Clk_A; Clk_B. The digital clock switching circuit <b>10</b> also comprises two AND-gates <b>16</b><sub>1</sub>, <b>16</b><sub>2</sub>, wherein each AND-gate <b>16</b><sub>1</sub>, <b>16</b><sub>2 </sub>has a first input receiving a clock enable signal, Clk_En<sub>1</sub>; Clk_En<sub>2</sub>, and a second input receiving the clock source Clk_A; Clk_B. The digital clock switching circuit <b>10</b> also comprises a first OR-gate <b>18</b> connected to each AND-gate <b>16</b><sub>1</sub>, <b>16</b><sub>2</sub>, and outputting the clock output Clk_Out.</p>
<p id="p-0048" num="0047">As is apparent from <figref idref="DRAWINGS">FIG. 5</figref>, the digital clock switching circuit <b>10</b> also comprises two first double latch synchronizers <b>20</b><sub>1</sub>, <b>20</b><sub>2</sub>, each of which is connected to the respective finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2</sub>. Each finite state machine <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>is connected to a second double latch synchronizer <b>22</b><sub>1</sub>; <b>22</b><sub>2</sub>, whereby the input signal (Select) passes to the respective state machine via the second double latch synchronizer <b>22</b><sub>1</sub>; <b>22</b><sub>2</sub>. As is apparent from <figref idref="DRAWINGS">FIG. 5</figref>, the first clock source Clk_A is connected to, and controls the first and second double latch synchronizers <b>20</b><sub>1</sub>, <b>22</b><sub>1 </sub>connected to the first finite state machine <b>12</b><sub>1</sub>. The second clock source Clk_B is connected to, and controls the first and second double latch synchronizers <b>20</b><sub>2</sub>, <b>22</b><sub>2 </sub>connected to the second finite state machine <b>12</b><sub>2</sub>. The digital clock switching circuit <b>10</b> also comprises a second OR-gate <b>24</b> connected to an Error output Error<sub>1</sub>, Error<sub>2 </sub>of each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2</sub>. The second OR-gate <b>24</b> has an output Error.</p>
<p id="p-0049" num="0048">In <figref idref="DRAWINGS">FIG. 6</figref> there is disclosed a state diagram for the finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>comprised in the digital clock switching circuit <b>10</b> disclosed in <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0050" num="0049">In order to avoid a deadlock situation, the invention verifies that the clock to be selected is present, and for the system clock to continue in the event that the clock to be selected is not present.</p>
<p id="p-0051" num="0050">One difference between the conventional clock-switch circuit is in the behaviour of the FSM <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>when switching the associated clock off (transition from state ON to state OFF). According to one embodiment of the invention, the FSM <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>must first pass through the state CHECK. Prior to entering the CHECK state, a variable count (Cnt<sub>1</sub>; Cnt<sub>2</sub>) is initialized to a constant value (Nfail<sub>1</sub>, Nfail<sub>2</sub>). While in the CHECK state, the counter <b>14</b><sub>1</sub>; <b>14</b><sub>2 </sub>is decremented at each clock cycle. If it is observed that the other FSM has responded to the clock switch and enabled its clock prior to the count reaching zero (or some other predetermined value), it is safe to proceed to the OFF state. If the other FSM does not respond in a timely fashion, the counter <b>14</b><sub>1</sub>; <b>14</b><sub>2 </sub>will decrement to zero. In this case, it is assumed that the other clock is not present and the FSM enters the ERROR state, re-enables the output clock and asserts an error indication. The constant value (Nfail<sub>1</sub>; Nfail<sub>2</sub>) should be set, in one example, to a value such that the counter <b>14</b><sub>1</sub>; <b>14</b><sub>2 </sub>will not expire in the event that the other clock is present.</p>
<p id="p-0052" num="0051">This circuit is primarily intended for applications when a clock is either present or not present, and in applications where the clock initially is not present and then subsequently starts (since this could cause the situation where one FSM <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>enters the error state and passes its clock to the output at the same time as the other FSM <b>12</b><sub>2</sub>; <b>12</b><sub>1 </sub>enters the ON state).</p>
<p id="p-0053" num="0052">In <figref idref="DRAWINGS">FIG. 7</figref> there is disclosed a block diagram of another embodiment of a digital clock switching circuit <b>10</b> according to the invention. The similar components in <figref idref="DRAWINGS">FIG. 7</figref> as in <figref idref="DRAWINGS">FIG. 5</figref> has been designated with the same reference numbers and will not be described in detail again. One difference between the <figref idref="DRAWINGS">FIGS. 7 and 5</figref>, is that in <figref idref="DRAWINGS">FIG. 7</figref>, each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>also comprises an output SwOK<sub>1</sub>; SwOK<sub>2</sub>, and an output Other SwOK<sub>1</sub>; Other SwOK<sub>2</sub>, and the output SwOK<sub>2</sub>; SwOK<sub>1 </sub>of each finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>is connected, via a third double latch synchronizer <b>26</b><sub>1</sub>; <b>26</b><sub>2 </sub>to the input Other SwOK<sub>2</sub>; OtherSwOK<sub>1 </sub>of the other finite state machine <b>12</b><sub>1</sub>, <b>12</b><sub>2</sub>. The function of the digital clock switching circuit <b>10</b> disclosed in <figref idref="DRAWINGS">FIG. 7</figref> will be described in conjunction with <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0054" num="0053">In <figref idref="DRAWINGS">FIG. 8</figref> there is disclosed a state diagram for the finite state machines <b>12</b><sub>1</sub>, <b>12</b><sub>2 </sub>comprised in the digital clock switching circuit <b>10</b> disclosed in <figref idref="DRAWINGS">FIG. 7</figref> according to one example.</p>
<p id="p-0055" num="0054">An alternative implementation of the method could first verify the presence of the other clock, and only then proceed to disable its own clock. Such a circuit would be more complex, since it would require an additional output and input from each FSM <b>12</b><sub>1</sub>; <b>12</b><sub>2</sub>, with two synchronisers in each path. The additional output SwOK is used to indicate that the state machine <b>12</b><sub>2</sub>; <b>12</b><sub>1 </sub>has observed the request to switch on its clock and is prepared to do so.</p>
<p id="p-0056" num="0055">When an FSM <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>is in state ‘On’ (clock enable active), and observes a request to switch off its clock, it first proceeds to the state ‘Check’ to see that the other FSM <b>12</b><sub>2</sub>; <b>12</b><sub>2 </sub>asserts SwOK. If this does not appear within the allocated time, the error state is entered. Otherwise, on seeing SwOK==1, the FSM <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>shuts off its own clock output enable signal.</p>
<p id="p-0057" num="0056">When an FSM <b>12</b><sub>1</sub>; <b>12</b><sub>2 </sub>is in state ‘Off’ (clock enable inactive), and observes a request to switch on its clock, it first proceeds to the state ‘Wait’. Here, it asserts SwOK to indicate that it is capable of switching on its clock. As soon as the other FSM <b>12</b><sub>2</sub>; <b>12</b><sub>1 </sub>has responded and switched off its clock, the local clock enable can be asserted.</p>
<p id="p-0058" num="0057">In <figref idref="DRAWINGS">FIG. 9</figref> there is disclosed a schematic diagram of some computer program products for deadlock-free switching of the source of the digital clock for an integrated circuit according to the present invention. There is disclosed n different digital computers <b>100</b><sub>1</sub>, . . . , <b>100</b><sub>n</sub>, wherein n is an integer.</p>
<p id="p-0059" num="0058">There is also disclosed n different computer program products <b>102</b><sub>1</sub>, . . . , <b>102</b><sub>n</sub>, here showed in the form of compact discs. The different computer program products <b>102</b><sub>1</sub>, . . . , <b>102</b><sub>n </sub>are directly loadable into the internal memory of the n different digital computers <b>100</b><sub>1</sub>, . . . , <b>100</b><sub>n</sub>. Each computer program product <b>102</b><sub>1</sub>, . . . , <b>102</b><sub>n </sub>comprises software code portions for performing some or all the steps of <figref idref="DRAWINGS">FIG. 4</figref> when the product(s) <b>102</b><sub>1</sub>, . . . , <b>102</b><sub>n </sub>is/are run on said computer(s) <b>100</b><sub>1</sub>. . . , <b>100</b><sub>n</sub>. Said computer program products <b>102</b><sub>1</sub>, . . . , <b>102</b><sub>n </sub>can e.g. be in the form of floppy disks, RAM disks, magnetic tapes, opto-magnetic disks or any other suitable products.</p>
<p id="p-0060" num="0059">The invention is not limited to the embodiments described in the foregoing. It will be obvious that many different modifications are possible within the scope of the following claims.</p>
<p id="p-0061" num="0060">While the invention has been illustrated and described with respect to one or more implementations, alterations and/or modifications may be made to the illustrated examples without departing from the spirit and scope of the appended claims. In particular regard to the various functions performed by the above described components or structures (assemblies, devices, circuits, systems, etc.), the terms (including a reference to a “means”) used to describe such components are intended to correspond, unless otherwise indicated, to any component or structure which performs the specified function of the described component (e.g., that is functionally equivalent), even though not structurally equivalent to the disclosed structure which performs the function in the herein illustrated exemplary implementations of the invention. In addition, while a particular feature of the invention may have been disclosed with respect to only one of several implementations, such feature may be combined with one or more other features of the other implementations as may be desired and advantageous for any given or particular application. Furthermore, to the extent that the terms “including”, “includes”, “having”, “has”, “with”, or variants thereof are used in either the detailed description and the claims, such terms are intended to be inclusive in a manner similar to the term “comprising”.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A digital clock switching circuit operable to deadlock-free switch the source of the digital clock for an integrated circuit, comprising:
<claim-text>a first finite state machine associated with a first clock source;</claim-text>
<claim-text>a second finite state machine associated with a second clock source, wherein the first and second finite state machines are connected to each other and configured to monitor a current state of the other finite state machine, and wherein each finite state machine comprises an input configured to receive an input select signal that is configured to control which of the first and second clock sources should be active and passed to a clock output of the digital clock switching circuit, and</claim-text>
<claim-text>wherein each of the first and second finite state machines comprises a counter with a variable associated therewith, wherein the counter of the finite state machine associated with the active clock source at an instant in time is configured to initialize the variable of its respective counter to a first predetermined value when the input select signal indicates a switching off of the active clock source, and wherein the finite state machine associated with the active clock source is configured to enter a CHECK state in response thereto, wherein the respective counter increments or decrements the variable at each clock cycle, and if the other finite state machine verifies a presence of its clock source before the variable reaches a second predetermined value, the switch of the active clock source is effected, and if the variable reaches the second predetermined value, no switch of the active clock source is effected.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The digital clock switching circuit of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each finite state machine comprises an output and an output clock enable signal, wherein each output clock enable signal comprises a first input to a respective AND-gate, and wherein each AND-gate comprises a second input configured to receive one of the first and second clock sources, respectively, and wherein the digital clock switching circuit also comprises a first OR-gate having inputs connected to the output of each AND-gate and configured to output one of the first and second clock sources at the clock output of the digital clock switching circuit.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The digital clock switching circuit of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the output associated with the clock enable signal of each finite state machine is connected, via a first double latch synchronizer, to an input of the other finite state machine, wherein each finite state machine is configured to monitor a state of the other clock enable signal based on the respective clock enable signal at the input.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The digital clock switching circuit of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein each finite state machine is connected to a second double latch synchronizer, and wherein the input select signal is received at each finite state machine via the respective second double latch synchronizer.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The digital clock switching circuit of <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the first clock source is connected to and controls the first and second double latch synchronizers connected to the first finite state machine, and wherein the second clock source is connected to and controls the first and second double latch synchronizers connected to the second finite state machine.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The digital clock switching circuit of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the respective finite state machine associated with the active clock source is configured to disable the active clock source before the other finite state machine verifies a presence of its clock source.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The digital clock switching circuit of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the finite state machine associated with the inactive clock source is configured to verify a presence of its respective clock source before the other finite state machine disables the active clock source.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The digital clock switching circuit of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the digital clock switching circuit further comprises a second OR-gate configured to receive an error output signal from each finite state machine.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The digital clock switching circuit of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein if the counter associated with the finite state machine associated with the active clock source has varied the variable to the second predetermined value, the finite state machine currently in the CHECK state is configured to enter an ERROR state, wherein the finite state machine is configured to re-enable the active clock source for passage to the clock output, and issue an error signal to the second OR-gate.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The digital clock switching circuit of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein each finite state machine also comprises another output and another input, wherein the another output of each finite state machine is connected, via a third double latch synchronizer, to the another input of the other finite state machine.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The digital clock switching circuit of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the first clock source is connected to, and is operable to control the third double latch synchronizer connected to the first finite state machine, and wherein the second clock source is connected to, and is operable to control the third double latch synchronizer connected to the second finite state machine.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The digital clock switching circuit of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein if the finite state machine associated with the active clock source has its clock enable signal active, and the input select signal indicates a switching off of the active clock source, the finite state machine is operable to enter a CHECK state, wherein the active clock source is disabled if the other finite state machine has its another output active before the counter of the finite state machine associated with the active clock source has reached the second predetermined value, and if the other finite state machine does not have its another output active before the counter has reached the second predetermined value, the finite state machine associated with the active clock source is operable to enter the ERROR state and issue the error signal to the second OR-gate.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The digital clock switching circuit of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein if the finite state machine not associated with the active clock source has its clock enable signal inactive, and the input select signal indicates a switching on of its respective clock source, the finite state machine is configured to enter a WAIT state and its another output is operable to become active, and when the other finite state machine has switched off its respective clock source, the other clock source is operable to be active and passed to the clock output.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method for deadlock-free switching of a digital clock source for an integrated circuit, with the aid of a first and a second clock source, wherein the first clock source is active, and the second clock source is inactive, comprising:
<claim-text>initializing a variable to a first predetermined value when a switching off of the active clock source is indicated;</claim-text>
<claim-text>incrementing or decrementing the variable at each clock cycle;</claim-text>
<claim-text>switching the active clock source from the first clock source to the second clock source if the presence of the inactive clock source is verified before the variable reaches a second predetermined value; and</claim-text>
<claim-text>preventing switching of the active clock source if the variable reaches the second predetermined value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising disabling the active clock source before a presence of the other clock source is verified.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising verifying a presence of the inactive clock source before disabling the active clock source.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising:
<claim-text>enabling the active clock source if the variable reaches the second predetermined value; and</claim-text>
<claim-text>issuing an error indication.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the method is performed with the aid of a digital clock switching circuit comprising a first finite state machine associated with the first clock source, and a second finite state machine associated with the second clock source, wherein each finite state machine receives an input select signal operable to control which clock source should be active and passed to a clock output of the digital clock switching circuit, wherein each finite state machine further comprises a counter, and wherein the method further comprises entering a CHECK state with the finite state machine associated with the active clock source when the input select signal indicates a switching off of the active clock source.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein each finite state machine comprises a clock enable signal output connected, via a first double latch synchronizer, to an input of the other finite state machine, the method further monitoring a state of each finite state machine with the clock enable signal from the other finite state machine, respectively.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein each finite state machine also comprises another output and another input, the method further comprising:
<claim-text>entering a CHECK state with the finite state machine associated with the active clock source if the respective finite state machine has its clock enable signal active, and the input select signal indicates a switching off of the active clock source;</claim-text>
<claim-text>disabling the active clock source if the other finite state machine has its another output active before the counter has reached the second predetermined value;</claim-text>
<claim-text>entering an ERROR state with the finite state machine associated with the active clock source if the other finite state machine does not have its another output active before the counter reaches the second predetermined value; and</claim-text>
<claim-text>issuing an error signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The method of <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising:
<claim-text>entering a WAIT state with the finite state machine associated with the active clock source if the respective finite state machine has its clock enable signal inactive, and the input select signal indicates a switching on of the active clock source; and</claim-text>
<claim-text>activating the other clock source and passing it to the clock output when the other finite state machine has switched off its clock source to activate the other clock source.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
