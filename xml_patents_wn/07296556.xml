<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07296556-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07296556</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11485470</doc-number>
<date>20060713</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2005-206598</doc-number>
<date>20050715</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>F</section>
<class>02</class>
<subclass>D</subclass>
<main-group>41</main-group>
<subgroup>40</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>123305</main-classification>
<further-classification>123435</further-classification>
<further-classification>12340643</further-classification>
<further-classification>701105</further-classification>
</classification-national>
<invention-title id="d0e61">Control system for internal combustion engine</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4722310</doc-number>
<kind>A</kind>
<name>Igashira et al.</name>
<date>19880200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5718203</doc-number>
<kind>A</kind>
<name>Shimada et al.</name>
<date>19980200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>123305</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6530361</doc-number>
<kind>B1</kind>
<name>Shiraishi et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>123435</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6557528</doc-number>
<kind>B2</kind>
<name>Hiltner</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>12340643</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>7000596</doc-number>
<kind>B2</kind>
<name>Zurloye et al.</name>
<date>20060200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>701105</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7013865</doc-number>
<kind>B2</kind>
<name>Nagai et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>123305</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2004/0177830</doc-number>
<kind>A1</kind>
<name>Yamaoka et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>EP</country>
<doc-number>0 905 361</doc-number>
<kind>A2</kind>
<date>19990300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>EP</country>
<doc-number>1 445 456</doc-number>
<kind>A2</kind>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>JP</country>
<doc-number>11-107820</doc-number>
<kind>A</kind>
<date>19990400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>JP</country>
<doc-number>2004-100566</doc-number>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>6</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>123305</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>12340643</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>123435</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>701105</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>13</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070012290</doc-number>
<kind>A1</kind>
<date>20070118</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yamaguchi</last-name>
<first-name>Satoshi</first-name>
<address>
<city>Wako</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Shimasaki</last-name>
<first-name>Yuichi</first-name>
<address>
<city>Wako</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Hasegawa</last-name>
<first-name>Mamoru</first-name>
<address>
<city>Wako</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Arent Fox LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Honda Motor Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Solis</last-name>
<first-name>Erick</first-name>
<department>3747</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A control system for an internal combustion engine having a fuel injector located in a combustion chamber of the engine for injecting fuel into the combustion chamber. The fuel injection timing stored in a fuel injection timing map is retrieved according to the detected engine operating condition to determine the fuel injection timing. An actual ignition timing of the fuel injected into the combustion chamber is detected. An ignition delay of the actual ignition timing with respect to the target ignition timing, which is set according to the engine operating condition and a fuel injection timing correction amount, is calculated according to the calculated ignition delay. The fuel injection timing is corrected with the fuel injection timing correction amount, and the fuel injection is executed according to the corrected fuel injection timing.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="48.26mm" wi="184.40mm" file="US07296556-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="133.35mm" wi="117.35mm" file="US07296556-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="227.58mm" wi="174.67mm" orientation="landscape" file="US07296556-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="203.12mm" wi="193.38mm" file="US07296556-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="270.09mm" wi="192.96mm" file="US07296556-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="205.06mm" wi="172.72mm" file="US07296556-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="258.83mm" wi="186.01mm" file="US07296556-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to a control system for an internal combustion engine, and particularly, to a system for controlling an internal combustion engine according to a pressure in the cylinder detected by a cylinder pressure sensor.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">Japanese Patent Laid-open No. 2004-100566 (JP '566) discloses a fuel injection control apparatus in which the cylinder pressure (pressure in the combustion chamber) is detected by a cylinder pressure sensor, and a fuel injection amount, a fuel injection timing, and the like, are controlled according to the detected cylinder pressure. According to the disclosed apparatus, the crank angle Cmax at which the cylinder pressure reaches a maximum value is detected, and the fuel injection timing is corrected so that the detected crank angle Cmax coincides with a target value which is previously set according to the engine operating condition.</p>
<p id="p-0006" num="0005">If the internal combustion engine is a diesel engine, an actual ignition timing changes depending on the cetane number of the fuel being used, even if the fuel injection timing is the same. Therefore, the control used by the above-described conventional apparatus is effective when the combustion characteristic of fuel changes.</p>
<p id="p-0007" num="0006">However, a specific method for correcting the fuel injection timing is not shown in JP '566. For example, if the cylinder pressure is to be detected during comparatively short periods of time and control is to be performed based on the detection results, the calculation load on the control apparatus increases. Accordingly, correction of the fuel injection timing must be performed without excessively increasing the calculation load on the control apparatus. However, the apparatus shown in JP '566 is not configured in contemplation of such a situation, thereby delaying performance of the control.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">The present invention was attained contemplating the above-described points, and an aspect of the present invention is to provide a control system for an internal combustion engine which detects an actual ignition timing of fuel based on the cylinder pressure detected by the cylinder pressure sensor and which appropriately executes a correction calculation of the fuel injection timing according to the detected actual ignition timing, wherein any increase in the calculation load is suppressed.</p>
<p id="p-0009" num="0008">In order to attain the above aspect, the present invention provides a control system for an internal combustion engine having a fuel injection means located in a combustion chamber of the engine for injecting fuel into the combustion chamber. The control system includes fuel injection timing storing means, operating condition detecting means, fuel injection control means, ignition timing storing means, ignition timing detecting means, and fuel injection timing correction amount calculating means. The fuel injection timing storing means stores fuel injection timings (CAIMM) of the fuel injection means. The fuel injection timings (CAIMM) are set according to the operating condition (NE, TRQ) of the engine. The operating condition detecting means detects an operating condition of the engine. The fuel injection control means retrieves the fuel injection timing (CAIMM) stored by the fuel injection timing storing means according to the detected engine operating condition to determine the fuel injection timing and executes a fuel injection through the fuel injection means. The ignition timing storing means stores target ignition timings (CAFMM) of the fuel injected into the combustion chamber. The target ignition timings (CAFMM) are set according to the operating condition of the engine. The ignition timing detecting means detects an actual ignition timing (CAFM) of the fuel injected into the combustion chamber, based on a change (dp/d θ) in a pressure in the combustion chamber. The fuel injection timing correction amount calculating means calculates an ignition delay of the actual ignition timing (CAFM) with respect to the target ignition timing (CAFMM) and calculates a fuel injection timing correction amount (CAD) according to the calculated ignition delay (DCAM). The fuel injection control means corrects the fuel injection timing (CAIMM) by the fuel injection timing correction amount (CAD), and executes the fuel injection according to the corrected fuel injection timing (CAIM). In the present invention, the “ignition timing” means the compression ignition timing that is a timing of ignition caused not by the spark plug but by the compression of the air-fuel mixture.</p>
<p id="p-0010" num="0009">With the above-described configuration, the fuel injection timing is retrieved from the fuel injection timing storing means that stores the fuel injection timings that are set according to the operating condition of the engine, and the target ignition timing is retrieved from the ignition timing storing means that stores the target ignition timings that are set according to the operating condition of the engine. Further, the actual ignition timing of fuel is detected, the ignition delay of the actual ignition timing with respect to the target ignition timing is calculated, the fuel injection timing correction amount is calculated according to the calculated ignition delay, and the fuel injection timing is corrected with the fuel injection timing correction amount. The fuel injection is executed according to the corrected fuel injection timing. By calculating the ignition delay of the actual ignition timing with respect to the target ignition timing that is previously set according to the engine operating condition and calculating the fuel injection timing correction amount according to the ignition delay, the calculation load on the control system is reduced, wherein controllability of the control system is improved.</p>
<p id="p-0011" num="0010">Preferably, the fuel injection timing correction amount calculating means includes ignition delay learning value calculating means for calculating a learning value (DCAMFLRN) of the ignition delay and calculates the fuel injection timing correction amount (CAD) using the learning value (DCAMFLRN) of the ignition delay.</p>
<p id="p-0012" num="0011">With the above-described configuration, the learning value of the ignition delay is calculated. The fuel injection timing correction amount is then calculated using the learning value. Accordingly, it is possible to prevent the ignition timing from deviating from the desired value.</p>
<p id="p-0013" num="0012">Preferably, the fuel injection control means includes fuel injection timing learning means for calculating a learning value (CAIMLRN) of the corrected fuel injection timing (CAIM) and executes the fuel injection according to the learning value (CAIMLRN) of the fuel injection timing.</p>
<p id="p-0014" num="0013">With the above-described configuration, the learning value of the corrected fuel injection timing is calculated, and the fuel injection is executed according to the learning value. Therefore, after completion of the learning, it is possible to perform the fuel injection at a suitable fuel injection timing from the instant engine operation begins.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a schematic diagram illustrating an internal combustion engine and a control system therefor according to one embodiment of the present invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram illustrating a configuration of a part of the control system illustrated in <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustrating a configuration of a module for calculating a control duty ratio (DUTE) of a control signal supplied to an exhaust gas recirculation control valve and a main injection timing (CAIM);</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating a process for setting the switching control signal (SCTL) supplied to a switching block illustrated in <figref idref="DRAWINGS">FIG. 3</figref>;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram illustrating a configuration of an ignition timing detection block illustrated in <figref idref="DRAWINGS">FIG. 3</figref>;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> is a time chart illustrating band pass filtering of a cylinder pressure sensor output;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIGS. 7A-7C</figref> are time charts illustrating an ignition timing detection method;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a table used for calculating a cetane number (CET) from an ignition delay time period (TDFM);</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIGS. 9A and 9B</figref> illustrate a reason for stopping the exhaust gas recirculation; and</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram illustrating a configuration of the modification of the main injection timing calculation block illustrated in <figref idref="DRAWINGS">FIG. 3</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0025" num="0024">Preferred embodiments of the present invention will now be described with reference to the drawings.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIGS. 1 and 2</figref> are schematic diagrams illustrating a configuration of an internal combustion engine and a control system therefor according to one embodiment of the present invention. The internal combustion engine <b>1</b> (hereinafter referred to as “engine”), which has four cylinders, is a diesel engine, wherein fuel is injected directly into the cylinders. Each cylinder is provided with a fuel injection valve <b>6</b> that is electrically connected to an electronic control unit <b>4</b> (hereinafter referred to as “ECU <b>4</b>”). The ECU <b>4</b> controls a valve opening period and a valve opening timing of each fuel injection valve <b>6</b>. That is, the fuel injection period and fuel injection timing are controlled by the ECU <b>4</b>.</p>
<p id="p-0027" num="0026">The engine <b>1</b> has an intake pipe <b>7</b> and an exhaust pipe <b>8</b>. An exhaust gas recirculation passage <b>9</b> for recirculating a part of exhaust gases to the intake pipe <b>7</b> is provided between the exhaust pipe <b>8</b> and the intake pipe <b>7</b>. The exhaust gas recirculation passage <b>9</b> is provided with an exhaust gas recirculation control valve <b>20</b> (hereinafter referred to as “EGR valve”) that controls the amount of exhaust gases that are recirculated. The EGR valve <b>20</b> is an electromagnetic valve having a solenoid. The valve opening of the EGR valve <b>20</b> is controlled by the ECU <b>4</b>. The exhaust gas recirculation passage <b>9</b> and the EGR valve <b>20</b> form the exhaust gas recirculation mechanism.</p>
<p id="p-0028" num="0027">Each cylinder of the engine <b>1</b> is provided with a cylinder pressure sensor <b>2</b> for detecting a cylinder pressure (a pressure in the combustion chamber of the engine <b>1</b>). In this embodiment, the cylinder pressure sensor <b>2</b> is configured in one body together with a glow plug disposed in each cylinder. The detection signal of the cylinder pressure sensor <b>2</b> is supplied to the ECU <b>4</b>. It is to be noted that the detection signal of the cylinder pressure sensor <b>2</b> corresponds to a differential signal of the cylinder pressure PCYL with respect to the crank angle (time). The cylinder pressure PCYL is obtained by integrating the output of the cylinder pressure sensor.</p>
<p id="p-0029" num="0028">The engine <b>1</b> is provided with a crank angle position sensor <b>3</b> for detecting a rotational angle of the crankshaft (not shown) of the engine <b>1</b>. The crank angle position sensor <b>3</b> generates one pulse at every 1 degree of the crank angle, and the pulse is supplied to the ECU <b>4</b>. The crank angle position sensor <b>3</b> further generates a cylinder discrimination pulse at a predetermined crank angle for a specific cylinder of the engine <b>1</b>, and then supplies the cylinder discrimination pulse to the ECU <b>4</b>.</p>
<p id="p-0030" num="0029">An accelerator sensor <b>21</b> for detecting an operation amount AP of the accelerator pedal of the vehicles driven by the engine <b>1</b>, a coolant temperature sensor <b>22</b> for detecting a coolant temperature TW of the engine <b>1</b>, an intake air temperature sensor <b>23</b> for detecting an intake air temperature TA of the engine <b>1</b>, and an intake air flow rate sensor <b>24</b> for detecting an intake air flow rate GA of the engine <b>1</b> are connected to the ECU <b>4</b>. The detection signals of these sensors are supplied to the ECU <b>4</b>.</p>
<p id="p-0031" num="0030">A control signal of the fuel injection valve <b>6</b> located in the combustion chamber of each cylinder of the engine <b>1</b> is provided by the ECU <b>4</b> to a drive circuit <b>5</b>. The drive circuit <b>5</b> is connected to the fuel injection valves <b>6</b> and supplies the driving signals according to the control signal from the ECU <b>4</b> to the fuel injection valves <b>6</b>. Fuel is injected into the combustion chamber of each cylinder based on a fuel injection timing in accordance with a control signal that is output from the ECU <b>4</b>. The amount of fuel that is injected is controlled to a value in accordance with the control signal from the ECU <b>4</b>.</p>
<p id="p-0032" num="0031">The ECU <b>4</b> includes an amplifier <b>10</b>, an A/D conversion block <b>11</b>, a pulse generation block <b>13</b>, a CPU <b>14</b> (Central Processing Unit), a ROM <b>15</b> (Read Only Memory) for storing programs executed by the CPU <b>14</b>, a RAM <b>16</b> (Random Access Memory) for storing calculation results, and the like, an input circuit <b>17</b>, and an output circuit <b>18</b>. The detection signal of the cylinder pressure sensor <b>2</b> is input to the amplifier <b>10</b>. The amplifier <b>10</b> amplifies the input signal. The signal amplified by the amplifier <b>10</b> is then input to the A/D conversion block <b>11</b>. The pulse signal output from the crank angle position sensor <b>3</b> is input to the pulse generation block <b>13</b>.</p>
<p id="p-0033" num="0032">The A/D conversion block <b>11</b>, which includes a buffer <b>12</b>, converts the cylinder pressure sensor output from the amplifier <b>10</b> to a digital value (hereinafter referred to as “pressure change rate”) dp/dθ and stores the converted digital value in the buffer <b>12</b>. Specifically, a pulse signal PLS<b>1</b> (hereinafter referred to as “one-degree pulse”) having a crank angle period of one degree is supplied to the A/D conversion block <b>11</b> from the pulse generation block <b>13</b>. The cylinder pressure sensor output is sampled at intervals of the one-degree pulse PLS<b>1</b> and converted to a digital value. The digital value is then stored in the buffer <b>12</b>.</p>
<p id="p-0034" num="0033">A pulse signal PLS<b>6</b> having a crank angle period of six degrees is supplied to the CPU <b>14</b> from the pulse generation block <b>13</b>. The CPU <b>14</b> performs a process for reading the digital value stored in the buffer <b>12</b> at intervals of the six-degree pulse PLS<b>6</b>. That is, in the present embodiment, the A/D conversion block <b>11</b> does not request an interrupt from the CPU <b>14</b>, but the CPU <b>14</b> does perform the reading process at intervals of the six-degree pulse PLS<b>6</b>.</p>
<p id="p-0035" num="0034">The input circuit <b>17</b> converts the detection signals from various sensors to digital values and supplies the digital values to the CPU <b>14</b>. An engine rotational speed NE is calculated from the time period of the six-degree pulse PLS<b>6</b>. A demand torque TRQ of the engine <b>1</b> is calculated according to the operation amount AP of the accelerator pedal.</p>
<p id="p-0036" num="0035">The CPU <b>14</b> calculates a duty ratio of a control signal for controlling an opening of the EGR valve <b>20</b> according to the engine operating condition. The CPU <b>14</b> supplies the duty control signal which controls opening of the EGR valve <b>20</b> to the EGR valve <b>20</b> through the output circuit <b>18</b>.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustrating a configuration of a module which calculates a main injection timing CAIM of the fuel injection valve <b>6</b> and a duty ratio (hereinafter referred to as “control duty ratio”) DUTE of the control signal supplied to the EGR valve <b>20</b>. The function of the module is realized by the processes executed by the CPU <b>14</b>.</p>
<p id="p-0038" num="0037">The module illustrated in <figref idref="DRAWINGS">FIG. 3</figref> includes a duty ratio calculation block <b>31</b>, a main injection timing calculation block <b>32</b>, and a correction amount calculation block <b>33</b>. The duty calculation block <b>31</b> calculates the control duty ratio DUTE. The main injection timing calculation block <b>32</b> calculates the main injection timing CAIM. The correction amount calculation block <b>33</b> calculates an ignition delay based on the output of the cylinder pressure sensor, calculates a fuel injection timing correction amount CAD, estimates a cetane number CET of fuel in use, and calculates a correction coefficient KCET according to the estimated cetane number CET.</p>
<p id="p-0039" num="0038">The duty ratio calculation block <b>31</b> includes a target fresh air amount map value calculation block <b>41</b>, a subtracting block <b>42</b>, a PI control block <b>43</b>, an EGR correction amount map value calculation block <b>44</b>, a multiplying block <b>45</b>, switching blocks <b>46</b> and <b>48</b>, and an adding block <b>47</b>. The target fresh air amount map value calculation block <b>41</b> retrieves a GAM map which is previously set according to the engine rotational speed NE and the demand torque TRQ to calculate the target fresh air amount map value GAM. The GAM map is set based on a fuel having a high cetane number (e.g., “57”). The subtracting block <b>42</b> subtracts the intake air flow rate GA detected by the intake air flow rate sensor <b>24</b> from the target fresh air amount map value GAM to calculate a deviation DGA. The PI control block <b>43</b> calculates a duty ratio DUT of the control signal supplied to the EGR valve <b>20</b> by the PI (proportional and integral) control so that the deviation DGA becomes “0”.</p>
<p id="p-0040" num="0039">The EGR correction amount map value calculation block <b>44</b> retrieves a DCM map which is previously set according to the engine rotational speed NE and the demand torque TRQ to calculate an EGR correction amount map value DCM. The DCM map is set based on a fuel having a low cetane number (e.g., “40”) so that the EGR amount is corrected about 15% per 1 cetane number. The multiplying block <b>45</b> multiplies a correction coefficient KCET by the EGR correction amount map value DCM to calculate an EGR correction amount DC. The correction coefficient KCET is calculated according to the cetane number CET of the fuel being used by the correction amount calculation block <b>33</b>.</p>
<p id="p-0041" num="0040">The adding block <b>47</b> adds the EGR correction amount DC to the duty ratio DUT calculated in the PI control block <b>43</b> to calculate the control duty ratio DUTE of the EGR valve <b>20</b>. The switching blocks <b>46</b> and <b>48</b> are supplied with a switching control signal SCTL. When the switching control signal SCTL is “0”, the switching block <b>46</b> maintains the ON state, as illustrated in <figref idref="DRAWINGS">FIG. 3</figref>, and the switching block <b>48</b> selects the output of the adding block <b>47</b>. The switching control signal SCTL is set to “1” when the estimation process, which is illustrated in <figref idref="DRAWINGS">FIG. 4</figref>, of a cetane number of the fuel being used is executed. Otherwise, the switching control signal SCTL is set to “0”. Therefore, when executing the cetane number estimation process, the switching block <b>46</b> is turned off, and the switching block <b>48</b> selects the input of “0” (which means the full closure of the EGR valve). Accordingly, the exhaust gas recirculation is stopped while executing the cetane number estimation process.</p>
<p id="p-0042" num="0041">In step S<b>11</b> of <figref idref="DRAWINGS">FIG. 4</figref>, it is determined whether any of the sensors (i.e., the crank angle position sensor <b>3</b>, the accelerator sensor <b>21</b>, and the cylinder pressure sensor <b>2</b>), necessary for the cetane number estimation process, have failed. If the answer to step S<b>11</b> is affirmative (YES), the switching control signal SCTL is set to “0” (step S<b>16</b>). If no failure of the sensors is detected, it is determined whether the engine operating condition is in a predetermined operating region (for example, a region where the engine rotational speed NE is within the range from 1000 to 3000 rpm and the demand torque TRQ is within the range from 0 to 250 Nm) in which the accurate detection of the ignition timing (i.e., the estimation of the accurate cetane number) can be performed (step S<b>12</b>). If the answer to step S<b>12</b> is negative (NO), the process proceeds to step S<b>16</b> described above. If the engine operating condition is in the predetermined operating region, it is determined whether the cetane number estimation is completed (step S<b>13</b>). Since the answer to step S<b>13</b> is negative (NO) at first, the exhaust gas recirculation is stopped (step S<b>14</b>) to permit the cetane number estimation process and the learning of the ignition delay to occur, i.e., the switching control signal SCTL is set to “1” (step S<b>15</b>). Thereafter, when the estimation process is completed, the process proceeds to step S<b>16</b> from step S<b>13</b>.</p>
<p id="p-0043" num="0042">Next, the reason for stopping the exhaust gas recirculation is described below with reference to <figref idref="DRAWINGS">FIGS. 9A and 9B</figref>. <figref idref="DRAWINGS">FIG. 9A</figref> illustrates a relationship between the air-fuel ratio A/F and the rate of change in the indicated mean effective pressure Pmi (hereinafter referred to as “Pmi change rate”). The point P<b>0</b> shown in <figref idref="DRAWINGS">FIG. 9A</figref> indicates a normal operating condition. The points P<b>1</b> and P<b>2</b> indicate an operating condition in which the exhaust gas recirculation is performed and the Pmi change rate has increased. In the operating condition of the point P<b>1</b> or P<b>2</b>, the ignition timing cannot be accurately detected, and consequently, the cetane number cannot be accurately estimated. If the exhaust gas recirculation is stopped in the condition of the point P<b>1</b> or P<b>2</b>, the operating condition shifts to the operating condition indicated by the point P<b>3</b>. That is, the air-fuel ratio changes toward a leaner air-fuel ratio, and the Pmi change rate decreases to a level of the normal operating condition. In the operating condition indicated by the point P<b>3</b>, the cetane number can accurately be estimated. Therefore, in the present embodiment, the exhaust gas recirculation is stopped when the execution condition of the cetane number estimation is satisfied. Also, the Pmi change rate is reduced to the normal level by reducing the recirculation amount of exhaust gases instead of stopping the exhaust gas recirculation. Therefore, the recirculation amount of exhaust gases is reduced instead of stopping the exhaust gas recirculation when the execution condition of the cetane number estimation is satisfied. The point P<b>4</b> shown in <figref idref="DRAWINGS">FIG. 9A</figref> indicates an operating condition when the fuel injection timing is corrected according to the estimated cetane number CET.</p>
<p id="p-0044" num="0043">Further, <figref idref="DRAWINGS">FIG. 9B</figref> illustrates a relationship between an emission amount of NOx and the air-fuel ratio A/F. The operating condition corresponding to those indicated by the points P<b>0</b>-P<b>4</b> illustrated in <figref idref="DRAWINGS">FIG. 9A</figref> are indicated by the points P<b>10</b>-P<b>14</b> in <figref idref="DRAWINGS">FIG. 9B</figref>. By stopping the exhaust gas recirculation, the points P<b>11</b> and P<b>12</b> shift to the point P<b>13</b> and the emission amount of NOx temporarily increases. However, the emission amount of NOx can be reduced to the normal level (i.e., the point P<b>14</b>) by correcting the fuel injection timing and restarting the exhaust gas recirculation after completion of the cetane number estimation process.</p>
<p id="p-0045" num="0044">Returning back to <figref idref="DRAWINGS">FIG. 3</figref>, the main injection timing calculation block <b>32</b> includes a main injection timing map value calculation block <b>51</b> and an adding block <b>52</b>. The main injection timing map value calculation block <b>51</b> retrieves a CAIMM map which is previously set according to the engine rotational speed NE and the demand torque TRQ to calculate a main injection timing map value CAIMM. The CAIMM map is set based on a fuel of a predetermined cetane number (for example, the average cetane number in the market).</p>
<p id="p-0046" num="0045">The adding block <b>52</b> adds the fuel injection timing correction amount CAD calculated in the correction amount calculation block <b>33</b> to the main injection timing map value CAIMM to calculate a main injection timing CAIM.</p>
<p id="p-0047" num="0046">The correction amount calculation block <b>33</b> includes a target main injection ignition timing map value calculation block <b>61</b>, an ignition timing detection block <b>62</b>, a subtracting block <b>63</b>, a switching block <b>64</b>, a filtering block <b>65</b>, an ignition delay learning block <b>66</b>, a CAD calculation block <b>67</b>, a cetane number estimation block <b>68</b>, and a KCET calculation block <b>69</b>. The target main injection ignition timing map value calculation block <b>61</b> retrieves a CAFMM map which is previously set according to the engine rotational speed NE and the demand torque TRQ to calculate a target main injection ignition timing map value CAFMM. The CAFMM map is set based on the fuel of a predetermined cetane number (for example, the average cetane number in the market). The ignition timing detection block <b>62</b> detects a main injection ignition timing CAFM according to the pressure change rate dp/dθ which is obtained by converting the output signal of the cylinder pressure sensor <b>2</b> to a digital value. The detection method is described later with reference to <figref idref="DRAWINGS">FIGS. 5 to 7</figref>.</p>
<p id="p-0048" num="0047">The subtracting block <b>63</b> subtracts the detected main injection ignition timing CAFM from the target main injection ignition timing map value CAFMM to calculate an ignition delay angle DCAM. The switching block <b>64</b> is on/off controlled by the switching control signal STCL. Specifically, the switching block <b>64</b> is turned off when the switching control signal SCTL is equal to “0” and turned on when the switching control signal SCTL is equal to “1” which is contrary to the switching block <b>46</b>. The filtering block <b>65</b> performs filtering using the least-squares method calculation or the moving averaging calculation of data of the ignition delay angle DCAM obtained in a comparatively long time period (e.g., 10-60 seconds) to calculate a filtered ignition delay angle DCAMF.</p>
<p id="p-0049" num="0048">The ignition delay learning block <b>66</b> applies the ignition delay angle DCAMF to the following equation (1) to update a learning value DCAMLRN (i, j) of the ignition delay angle DCAMF. The parameters “i” and “j” are parameters showing an engine operating region defined according to the engine rotational speed NE and the demand torque TRQ. The learning value DCAMLRN (i, j) is calculated corresponding to the engine operating region indicated by the parameters “i” and “j”, and is stored in the map.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>DCAMLRN(<i>i,j</i>)=<i>a</i>×DCAMF+(1−<i>a</i>)×DCAMLRN(<i>i,j</i>)  (1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where “a” is an averaging coefficient set to a value between “0” and “1” and the DCAMLRN (i, j) on the right side is a map value before updating.
</p>
<p id="p-0050" num="0049">The CAD calculation block <b>67</b> adds the crank angle corresponding to the ineffectual opening period of the fuel injection valve <b>6</b> to the learning value DCAMFLRN to calculate the fuel injection timing correction amount CAD.</p>
<p id="p-0051" num="0050">The cetane number estimation block <b>68</b> converts the ignition delay angle DCAMF to an ignition delay time period TDFM using the engine rotational speed NE and retrieves a CET table shown in <figref idref="DRAWINGS">FIG. 8</figref> according to the ignition delay time period TDFM to calculate the cetane number CET. The cetane number estimation block <b>68</b> applies the cetane number CET to the following equation (2) to calculate a cetane number learning value CETLRN.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>CETLRN=α×CET+(1−α)×CETLRN  (2)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where α is an averaging coefficient set to a value between “0” and “1” and the CETLRN on the right side is a preceding calculated value.
</p>
<p id="p-0052" num="0051">When refueling, the cetane number learning value CETLRN is initialized to the minimum value CET<b>0</b> (for example, 40) among cetane numbers of the fuels distributed in the market and converges to the value indicative of the cetane number of the fuel in use by the subsequent learning. By initializing to the minimum value CET<b>0</b>, even the fuel of the worst ignitionability (flammability) is assured of igniting during a cold start of the engine when using the cetane number learning value CETLRN in the fuel injection timing control described below.</p>
<p id="p-0053" num="0052">The cetane number learning value CETLRN described above is calculated using all of the cylinder pressure sensor outputs corresponding to four cylinders. Therefore, an averaging of the cetane number CET, detected for each cylinder, and the cetane numbers CET, whose detection timings are different from each other, is performed by the above-described equation (<b>2</b>).</p>
<p id="p-0054" num="0053">The KCET calculation block <b>69</b> applies the cetane number learning value CETLRN to the following equation (3) to calculate the correction coefficient KCET.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>KCET=(CETH−CETLRN)/(CETH−CET<b>0</b>)  (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0055" num="0054">In the equation (3), CETH is a cetane number (for example, 57) of a high cetane number fuel which is a reference fuel for setting the above-described GAM map. Therefore, if the cetane number learning value CETLRN is equal to the reference high cetane number CETH, the correction coefficient KCET is set to “0”, and if the cetane number learning value CETRN is equal to the reference low cetane number CET<b>0</b>, the correction coefficient KCET is set to “1.0”.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram illustrating a configuration of the ignition timing detection block <b>62</b>. The ignition timing detection block <b>62</b> includes a band pass filtering block <b>71</b>, a phase delay correction block <b>72</b>, and an ignition timing determination block <b>73</b>. The pressure change rate dp/dθ output from the cylinder pressure sensor <b>2</b> is input into the band pass filtering block <b>71</b>. In <figref idref="DRAWINGS">FIG. 6</figref>, the waveform W<b>1</b> illustrates an input waveform, and the waveform W<b>2</b> illustrates an output waveform. The phase delay occurring in the band pass filtering block <b>71</b> is corrected in the phase delay correction block <b>72</b>.</p>
<p id="p-0057" num="0056">The ignition timing determination block <b>73</b> determines a crank angle position CAFP (hereinafter referred to as “pilot injection ignition timing”) where the pressure change rate dp/dθ takes a peak value corresponding to the pilot injection and a crank angle position CAFM (hereinafter referred to as “main injection ignition timing”) where the pressure change rate dp/dθ takes another peak value corresponding to the main injection. Specifically, as illustrated in <figref idref="DRAWINGS">FIG. 7C</figref>, the crank angle position, where the pressure change rate dp/dθ output from the phase delay correction block <b>72</b> exceeds a pilot detection threshold value DPP, is determined to be the pilot injection ignition timing CAFP. The crank angle position, where the pressure change rate dp/dθ exceeds a main detection threshold value DPM, is determined to be the main injection ignition timing CAFM. In this embodiment, only the main injection ignition timing CAFM is used for calculating the fuel injection timing correction amount CAD and estimating the cetane number CET.</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIGS. 7A and 7B</figref> illustrate a pilot injection pulse INJP started from a crank angle position CAIP and a main injection pulse INJM started from a crank angle position CAIM. <figref idref="DRAWINGS">FIG. 7C</figref> illustrates an angle position range RDET (for example, 10 degrees) where the ignition timings CAFP and CAFM are detected. By limiting the detection angle position range RDET to a comparatively narrow range, as illustrated in <figref idref="DRAWINGS">FIG. 7C</figref>, the ignition timing is accurately determined without increasing the calculation load on the CPU <b>14</b>.</p>
<p id="p-0059" num="0058">As described above, the target main injection ignition timing map value CAFMM is calculated according to the engine rotational speed NE and the demand torque TRQ, the main injection ignition timing CAFM is detected, and the ignition delay angle DCAM of the main injection ignition timing CAFM with respect to the target main injection ignition timing map value CAFMM is calculated. Further, the fuel injection timing correction amount CAD is calculated according to the calculated ignition delay angle DCAM, and the main injection timing map value CAIMM is corrected with the fuel injection timing correction amount CAD. By calculating the ignition delay angle DCAM of the actual ignition timing with respect to the target ignition timing, which is previously set according to the engine rotational speed NE and the demand torque TRQ, and calculating the fuel injection timing correction amount CAD according to the ignition delay angle DCAM, the calculation load on the control system is reduced, wherein controllability of the control system is improved.</p>
<p id="p-0060" num="0059">Further, the learning value DCAMLRN of the ignition delay angle is calculated for every corresponding operating region using the calculated ignition delay angle DCAMF to update the learning value (DCAMLRN) map. The learning value DCAMLRN is used for correcting the fuel injection timing. Therefore, it is possible to prevent the ignition timing from deviating from the desired value unless the cetane number of the fuel changes.</p>
<p id="p-0061" num="0060">In the present embodiment, the fuel injection valve <b>6</b> corresponds to the fuel injection means, and the crank angle position sensor <b>3</b> and the accelerator sensor <b>21</b> correspond to the operating condition detection means. Further, the ECU <b>4</b> includes the fuel injection control means, the ignition timing storing means, a part of the ignition timing detecting means, the fuel injection timing storing means, and the fuel injection timing correction amount calculating means. Specifically, the CAIMM map corresponds to the fuel injection timing storing means and the CAFMM map corresponds to the ignition timing storing means. The cylinder pressure sensor <b>2</b> and the ignition timing detection block <b>62</b> correspond to the ignition timing detecting means. The subtraction block <b>63</b>, the filtering block <b>65</b>, the ignition delay learning block <b>66</b> and the CAD calculation block <b>67</b> correspond to the fuel injection timing correction amount calculating means. The main injection timing map value calculation block <b>51</b> and the adding block <b>52</b> correspond to the fuel injection control means.</p>
<p id="p-0062" num="0061">The present invention is not limited to the embodiment described above, and various modifications may be made thereto. For example, the main injection timing calculation block <b>32</b> may be configured as illustrated in <figref idref="DRAWINGS">FIG. 10</figref>. The main injection timing calculation block <b>32</b> illustrated in <figref idref="DRAWINGS">FIG. 10</figref> further includes a main injection timing learning block <b>53</b> and a switching block <b>54</b> in addition to the main injection timing map value calculation block <b>51</b> and the adding block <b>52</b>. The main injection timing learning block <b>53</b> applies the corrected main injection timing CAIM to the following equation (4) to update the learning value CAIMLRN (i, j) of the main injection timing CAIM. The parameters “i” and “j” are parameters which show an engine operating region defined according to the engine rotational speed NE and the demand torque TRQ.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>CAIMLRN(<i>i,j</i>)=<i>b</i>×CAIM+(1−<i>b</i>)×CAIMLRN(<i>i,j</i>)  (4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where “b” is an averaging coefficient set to a value between “0” and “1”, and CAIMLRN (i, j) on the right side is a map value before updating.
</p>
<p id="p-0063" num="0062">The switching block <b>54</b> is controlled to usually select the output of the adding block <b>52</b>, as illustrated, and to select the output of the main injection timing learning block <b>53</b>, for example, when the learning of the main injection timing has been completed after refueling. Therefore, after completion of the learning, it is possible to perform the fuel injection at the suitable fuel injection timing from the instant engine operation begins.</p>
<p id="p-0064" num="0063">In the above-described embodiment, the calculation of the ignition delay angle and the cetane number estimation are performed based on the main injection ignition timing CAFM corresponding to the main injection. Alternatively, the calculation of the ignition delay angle and the cetane number estimation may be performed based on the pilot injection ignition timing CAFP corresponding to the pilot injection. Further, the pilot injection timing may be corrected according to the ignition delay angle.</p>
<p id="p-0065" num="0064">The CAFMM map on which the target main injection ignition timing is set may be used for calculating the main injection timing instead of the CAIMM map described above. In this case, the main injection timing CAIM is calculated by adding the average ignition delay angle and the crank angle corresponding to the ineffectual opening period of the fuel injection valve to the target main injection ignition timing CAFMM obtained by retrieving the CAFMM map.</p>
<p id="p-0066" num="0065">Further, a target ignition delay angle calculation block may be provided instead of the target main injection ignition timing map value calculation block <b>61</b>, and the ignition delay angle DCAMD with respect to the fuel injection timing may be detected in the ignition timing detection block <b>62</b>. In this case, the target ignition delay angle calculation block retrieves a DCAMDM map to calculate a target ignition delay angle DCAMDM. The target ignition delay angles DCAMDM are previously set on the DCAMDM map according to the engine rotational speed NE and the demand torque TRQ. The subtraction block <b>63</b> calculates the deviation of the detected ignition delay angle DCAMD from the target ignition delay angle DCAMDM. The deviation corresponds to the ignition delay angle DCAM.</p>
<p id="p-0067" num="0066">Further, in the above-described embodiment, the cylinder pressures in all cylinders are detected to calculate the cetane number learning value CETLRN. Alternatively, only one cylinder pressure sensor may be disposed at a specific cylinder, and the cetane number learning value CETLRN may be calculated based on the cylinder pressure (pressure change rate) detected by the cylinder pressure sensor.</p>
<p id="p-0068" num="0067">Further, the ignition delay time period TDFM changes depending not only on the cetane number of the fuel but on deterioration of the fuel injection valve <b>6</b>. Therefore, it is preferable to correct the ignition delay time period TDFM according to the mileage of the vehicle driven by the engine <b>1</b>, or according to an integrated value of the operating time period of the engine <b>1</b>.</p>
<p id="p-0069" num="0068">In the above-described embodiment, an example of the 4-cylinder diesel internal combustion engine is shown. The present invention can be applied to a diesel internal combustion engine having another number of cylinders, or a watercraft propulsion engine, such as an outboard engine having a vertically extending crankshaft.</p>
<p id="p-0070" num="0069">The present invention may be embodied in other specific forms without departing from the spirit or essential characteristics thereof. The above-disclosed embodiments are therefore to be considered in all respects as illustrative and not restrictive, the scope of the invention being indicated by the appended claims, rather than the foregoing description, and all changes which come within the meaning and range of equivalency of the claims are, therefore, to be embraced therein.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A control system for an internal combustion engine having fuel injection means provided in a combustion chamber of the engine for injecting fuel into the combustion chamber, the control system comprising:
<claim-text>operating condition detecting means for detecting an operating condition of the engine;</claim-text>
<claim-text>fuel injection timing storing means for storing fuel injection timings performed by the fuel injection means, the fuel injection timings being set according to the operating condition of the engine and on a property of a predetermined fuel;</claim-text>
<claim-text>fuel injection control means for retrieving the fuel injection timing stored in the fuel injection timing storing means according to the detected engine operating condition to determine the fuel injection timing, and executing a fuel injection through the fuel injection means;</claim-text>
<claim-text>ignition timing storing means for storing target compression ignition timings of the fuel injected into the combustion chamber, the target compression ignition timings being set according to the operating condition of the engine;</claim-text>
<claim-text>ignition timing detecting means for detecting an actual compression ignition timing of the fuel injected into the combustion chamber, based on a change in a pressure in the combustion chamber; and</claim-text>
<claim-text>fuel injection timing correction amount calculating means for calculating an ignition delay of the actual compression ignition timing with respect to the target compression ignition timing, and calculating a fuel injection timing correction amount according to the calculated ignition delay, the ignition delay being due to a difference between the predetermined fuel and the injection fuel,</claim-text>
<claim-text>wherein the fuel injection control means corrects the fuel injection timing with the fuel injection timing correction amount, and executes the fuel injection according to the corrected fuel injection timing, and</claim-text>
<claim-text>wherein the fuel injection timing correction amount calculating means includes ignition delay learning value calculating means for calculating a learning value of the ignition delay, and calculates the fuel injection timing correction amount using the learning value of the ignition delay.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A control system for an internal combustion engine having fuel injection means provided in a combustion chamber of the engine for injecting fuel into the combustion chamber, the control system comprising:
<claim-text>operating condition detecting means for detecting an operating condition of the engine;</claim-text>
<claim-text>fuel injection timing storing means for storing fuel injection timings performed by the fuel injection means, the fuel injection timings being set according to the operating condition of the engine and on a property of a predetermined fuel;</claim-text>
<claim-text>fuel injection control means for retrieving the fuel injection timing stored in the fuel injection timing storing means according to the detected engine operating condition to determine the fuel injection timing, and executing a fuel injection through the fuel injection means;</claim-text>
<claim-text>ignition timing storing means for storing target compression ignition timings of the fuel injected into the combustion chamber, the target compression ignition timings being set according to the operating condition of the engine;</claim-text>
<claim-text>ignition timing detecting means for detecting an actual compression ignition timing of the fuel injected into the combustion chamber, based on a change in a pressure in the combustion chamber; and</claim-text>
<claim-text>fuel injection timing correction amount calculating means for calculating an ignition delay of the actual compression ignition timing with respect to the target compression ignition timing, and calculating a fuel injection timing correction amount according to the calculated ignition delay, the ignition delay being due to a difference between the predetermined fuel and the injection fuel,</claim-text>
<claim-text>wherein the fuel injection control means corrects the fuel injection timing with the fuel injection timing correction amount, and executes the fuel injection according to the corrected fuel injection timing, and</claim-text>
<claim-text>wherein the fuel injection control means includes fuel injection timing learning means for calculating a learning value of the corrected fuel injection timing, which is based on an engine rotational speed and an engine demand torque, and executes the fuel injection according to the learning value of the fuel injection timing.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The control system according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the fuel injection control means executes the fuel injection using the learning value of the fuel injection timing when the leaning of the main injection timing has been completed after refueling.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A control method for an internal combustion engine having at least one fuel injection valve provided in a combustion chamber of the engine for injecting fuel into the combustion chamber, the control method comprising the steps of:
<claim-text>a) detecting an operating condition of the engine;</claim-text>
<claim-text>b) retrieving a fuel injection timing map according to the detected operating condition of the engine to determine a fuel injection timing, the fuel injection timing map being set according to the operating condition of the engine and on a property of a predetermined fuel:</claim-text>
<claim-text>c) executing a fuel injection through the at least one fuel injection valve;</claim-text>
<claim-text>d) detecting an actual compression ignition timing of the fuel injected to the combustion chamber, based on a change in a pressure in the combustion chamber;</claim-text>
<claim-text>e) retrieving a target ignition timing map according to the detected operating condition of the engine, to calculate a target compression ignition timing of the fuel injected into the combustion chamber, the target ignition timing map being set according to the operating condition of the engine;</claim-text>
<claim-text>f) calculating an ignition delay of the actual compression ignition timing with respect to the target compression ignition timing, the ignition delay being due to a difference between the predetermined fuel and the injected fuel;</claim-text>
<claim-text>g) calculating a fuel injection timing correction amount according to the calculated ignition delay; and</claim-text>
<claim-text>h) correcting the fuel injection timing with the fuel injection timing correction amount, wherein the fuel injection is executed according to the corrected fuel injection timing,</claim-text>
<claim-text>i) calculating a learning value of the ignition delay, wherein the fuel injection timing correction amount is calculated using the learning value of the ignition delay.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The control method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, further comprising the step of calculating a learning value of the corrected fuel injection timing, wherein the fuel injection is executed according to the learning value of the fuel injection timing.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The control method according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the fuel injection using the learning value of the fuel injection timing is executed when the learning of the main injection timing has been completed after refueling.</claim-text>
</claim>
</claims>
</us-patent-grant>
