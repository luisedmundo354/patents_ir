<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298801-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298801</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10111923</doc-number>
<date>20010831</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>FR</country>
<doc-number>00 11198</doc-number>
<date>20000901</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>869</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>1</main-group>
<subgroup>10</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>375346</main-classification>
<further-classification>370342</further-classification>
</classification-national>
<invention-title id="d0e71">Method and device for demodulating signals from multiple users</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5414699</doc-number>
<kind>A</kind>
<name>Lee</name>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5550810</doc-number>
<kind>A</kind>
<name>Monogioudis et al.</name>
<date>19960800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370342</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5572548</doc-number>
<kind>A</kind>
<name>Pirez et al.</name>
<date>19961100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6240099</doc-number>
<kind>B1</kind>
<name>Lim et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370441</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6243415</doc-number>
<kind>B1</kind>
<name>Pipon et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6496543</doc-number>
<kind>B1</kind>
<name>Zehavi</name>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375295</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6600729</doc-number>
<kind>B1</kind>
<name>Suzuki</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370335</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6671338</doc-number>
<kind>B1</kind>
<name>Gamal et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375346</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7068743</doc-number>
<kind>B1</kind>
<name>Suzuki</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375345</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>2002/0110206</doc-number>
<kind>A1</kind>
<name>Becker et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375346</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>2004/0001561</doc-number>
<kind>A1</kind>
<name>Dent et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375308</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00012">
<othercit>Duel-Hallen, A Family of Multiuser Decision-Feedback Detectors for Asynchronous Code-Division Multiple-Access Channels, Feb./Apr. 1995, IEEE Transactions on Communications, vol. 43, 421-434.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Duel-Hallen et al, Multiuser Detection for CDMA Systems, IEEE Personal Communications, vol. 2, pp. 46-58.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Duel-Hallen A: “A Family of Multiuser Decision-Feedback Detectors for Asynchronous Code-Division Multiple-Access Channels” IEEE Transactions on Communications, US, IEEE Inc. New York, vol. 43, No. 2/04, Part 01, Feb. 1, 1995, pp. 421-434.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Klein A et al.: “Zero Forcing and Minimum Mean-Square-Error Equalization for Multiuser Detection in Code-Division Multiple-Access Channels” IEEE Transactions on Vehicular Technology, US IEEE Inc. New York, vol. 45, No. 2, May 1, 1996, pp. 276-287.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>U.S. Appl. No. 10/111,923, filed May 1, 2002, pending.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>U.S. Appl. No. 10/204,425, filed Aug. 29, 2002, pending.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>U.S. Appl. No. 10/110,786, filed Apr. 29, 2002, pending.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>Edward A. Lee and David G. Messerschmitt, “Digital Communication,” 1988, Sec. 8.5, pp. 335-345.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Pulin Patel and Jack Holtzman, “Performance Comparison of a DS/CDMA System using a Successive Interference Cancellation (IC) Scheme and a Parallel IC Scheme under Fading,” 1994 IEEE, pp. 510-514.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>5</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>375147</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375233</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375234</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375148</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375150</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375346</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370332-333</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370335</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370342</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370441</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370473</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370479</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>3</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20020181555</doc-number>
<kind>A1</kind>
<date>20021205</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Roumy</last-name>
<first-name>Aline</first-name>
<address>
<city>Nevers</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Pirez</last-name>
<first-name>Didier</first-name>
<address>
<city>Saint Gratien</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Fijalkow</last-name>
<first-name>Inbar</first-name>
<address>
<city>Cergy St Christophe</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Oblon, Spivak, McClelland, Maier &amp; Neustadt, P.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Thales</orgname>
<role>03</role>
<address>
<city>Paris</city>
<country>FR</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Fan</last-name>
<first-name>Chieh M.</first-name>
<department>2611</department>
</primary-examiner>
<assistant-examiner>
<last-name>Aghdam</last-name>
<first-name>Freshteh N</first-name>
</assistant-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/FR01/02717</doc-number>
<kind>00</kind>
<date>20010831</date>
</document-id>
<us-371c124-date>
<date>20020501</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO02/19557</doc-number>
<kind>A </kind>
<date>20020307</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Method and device for equalizing and decoding digital signals from K users including several modules. Each module includes an equalizer linked to a decoder. An equalizer of rank k corresponding to an index of user k is linked at least to the decoders of rank varying from 1 to k-1. Such a method and apparatus may find particular application for demodulating signals in mobile radio systems.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="91.61mm" wi="123.53mm" file="US07298801-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="195.07mm" wi="127.76mm" file="US07298801-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="182.88mm" wi="135.21mm" file="US07298801-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="206.16mm" wi="137.50mm" file="US07298801-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<p id="p-0002" num="0001">The invention relates to a method and a device for equalizing and decoding digital signals from several users.</p>
<p id="p-0003" num="0002">The invention applies in a CDMA (code division multiple access) context with channel coding.</p>
<p id="p-0004" num="0003">It applies in particular to third generation mobile radio systems.</p>
<p id="p-0005" num="0004">In digital transmission, a receiver can be viewed as a succession of several elementary functions each performing a specific process such as filtering, demodulating, equalizing, decoding, etc.</p>
<p id="p-0006" num="0005">The CDMA technique is a multiple access technique which will form the basis of third-generation mobile radio systems.</p>
<p id="p-0007" num="0006">This technique is based on the spread spectrum principle in which transmission takes place at a much higher bit rate than is necessary for each user, by multiplying the useful symbols by sequences of high bit rate symbols called “spreading sequences”.</p>
<p id="p-0008" num="0007">All the transmissions are then performed at the same, frequency and at the same times, separation between the users being obtained by different spreading sequences.</p>
<p id="p-0009" num="0008">In the first versions of CDMA systems, demodulation is carried out on a user-by-user basis. The “despreading” operation which involves remultiplying the received signal by the spreading sequence enables the signal to be brought back into its original useful frequency band, while the signals from other users remain spread; these “other users” are seen as a noise level and the processing gain, known as the “spreading gain”, is equal to the ratio of the useful bit rate to the transmission bit rate. It is this processing gain which allows several users to coexist in the same frequency band.</p>
<p id="p-0010" num="0009">More recent techniques attempt to demodulate all the users jointly, by considering the signals from other users as being something other than noise. These techniques, although often more complex, considerably improve the performance compared with the standard technique and in particular they resolve the “near-far effect” which is a major disadvantage resulting from the fact that, if all the mobile terminals transmit at the same power, a transmitter close to the base station appropriates to itself alone almost the total multiple access capacity in the cell, preventing the others from communicating. To prevent this, conventional systems require a high-performance power control system on each transmitter so that the signals are received with the same power at the base station.</p>
<p id="p-0011" num="0010">Various decoding techniques are known in the prior art.</p>
<p id="p-0012" num="0011">For example, turbo-codes are powerful error-correcting codes. The basic version uses two simple convolutional codes of which one receives data to be transmitted and the other receives data passed through an interleaver. The outputs of these two codes are then multiplexed. At the receive end, iterations are made a certain number of times between the decoding of the first and the second code, each decoding stage providing weighted information on the useful bits to the next decoding stage. The successive decoding stages improve the knowledge on the bits to be decided. This iterative procedure, with very simple elementary decoding stages, enables performance levels to be achieved that are comparable with those using much more complex codes.</p>
<p id="p-0013" num="0012">In turbo-equalization or turbo-detection, the iterative processing principle is adopted using an equalizer and a decoder separated by an interleaver. This principle is applied to demodulation on a frequency-selective channel which requires, as first processing stage, an equalizer. By iteration between equalization steps and decoding steps, the equalizer benefits from information associated with the error-correcting code, to which information it does not normally have access. In this way, an attempt is made to approach the performance levels of optimal joint decoding implementing both the equalization stage and the correcting code, which turns out to be too complex to implement due to the presence of the interleaver.</p>
<p id="p-0014" num="0013">The turbo-CDMA applies the “turbo” principle to coded CDMA transmissions. Several iterations between a multiuser demodulator and an error-correcting decoder are carried out.</p>
<p id="p-0015" num="0014">Various structures have already been proposed to improve the reception of the signals.</p>
<p id="p-0016" num="0015">Patent FR 95/01603 discloses a structure for joint equalization and decoding with iteration at the receive end. It is however limited to a single user. The equalizer used is an MAP (Maximum a Posteriori) equalizer known in the technical field of turbo-codes or turbo-equalizers.</p>
<p id="p-0017" num="0016">Patent FR 2,763,978 describes a receiver in which equalization is performed as follows: for the first iteration, a linear equalizer is used and then an interference canceler is used for the next iterations. Although this structure is less complex than that described in patent FR 95/01603, it does not however provide for working under optimal conditions.</p>
<p id="p-0018" num="0017">Other documents, for example:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0018">the article by P. D. Alexander, M. C. Reed, J. A. Asenstorfer and C. B. Schlegel, “Iterative multiuser interference reduction: Turbo CDMA”, IEEE Trans. Comm., Vol. 47, No. 7, pp. 1008-1014, July 1999, or</li>
        <li id="ul0002-0002" num="0019">the article by J. Hagenauer, “The Turbo principle: Tutorial introduction and state of the art”, Int. Symp. on Turbo-codes, Brest, 1997, pp. 1-11,
<br/>
describe designs of turbo-CDMA receivers based on MAP equalizers. These receivers are extensions to the multiuser case of the Turbo-detector. Processing is performed in parallel and in a fixed manner for each user: at each iteration, the processing uses the results from the previous iteration.
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0019" num="0020">The document by X. Wang and H. V. Poor, entitled “Iterative (turbo) soft interference cancellation and decoding for coded CDMA”, IEEE Trans. Comm., Vol. 47, No. 7, pp. 1046-1061, July 1999, describes a principle of a turbo-CDMA receiver with filter-based interference canceling. This equalizer contains a generalization of the interference canceler usually used in turbo-equalization in the multiuser case, followed by a Wiener filter. Some complexity is inherent to the principle since a matrix inversion is required at each new symbol to be processed.</p>
<p id="p-0020" num="0021">Finally, the article by A. Klein, G. Kawas Kaleh and P. W. Baier, “Zero forcing and minimum mean-square-error equalization for multiuser detection in CDMA channels”, IEEE Trans. on Veh. Tech., Vol. 45, No. 2, pp. 276-287, March 1996, describes designs of multiuser equalizers without the error-correcting decoding stage.</p>
<p id="p-0021" num="0022">The principle of the invention is based on a new design which fits in particular into a turbo-CDMA system. The idea is to demodulate the users one by one, each demodulation stage being followed by an error decoding stage. At the end of an iteration for a given user which corresponds to an equalization and to a decoding on the symbols of the user, there is reliable information on the symbols of the user in question. Before demodulating a user, a first step consists in subtracting from the received signal the contribution of all the interference from the users demodulated before him, said interference being determined from the information on the decided symbols. Users who have not yet been demodulated are considered as noise, the structure of which is known, in particular due to the knowledge of the spreading sequences or of the coding parameters of the signal at the transmission stage.</p>
<p id="p-0022" num="0023">The invention also relates to an equalization and decoding method comprising a step in which the users are ordered before being processed.</p>
<p id="p-0023" num="0024">The invention relates to a device for equalizing and decoding digital signals from K users, comprising K modules, each module comprising an equalizer linked to a decoder. It is characterized in that an equalizer of rank k is linked to several decoders of lower rank 1 to k−1.</p>
<p id="p-0024" num="0025">An equalizer can comprise a first block receiving at least the signal to be demodulated, from user k, and the estimates of the symbols associated with users 1 to k−1 and a second block designed to subtract the contribution from the past symbols already demodulated.</p>
<p id="p-0025" num="0026">The first block receives, for example during an ith iteration, at least the signal from user k to be demodulated, at least the estimates of the symbols associated with users 1 to k−1 corresponding to the ith iteration and the estimates of the symbols of users k+1 to K obtained which are at the (i−1)th iteration and the second block receives the estimates of the symbols of user k which are obtained at the (i−1)th iteration.</p>
<p id="p-0026" num="0027">The device may include a device for determining a criterion to order the users.</p>
<p id="p-0027" num="0028">The invention relates to a method for equalizing and decoding digital signals from K users in a receiver comprising several modules each comprising at least one equalizer followed by a decoder. It is characterized in that it comprises at least the following steps:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0029">a) at iteration 1, for the user of index 1, to transmit the signal to be demodulated to an equalizer of rank 1 then to a decoder of rank 1 so as to obtain estimated modulated symbols of user k, and</li>
        <li id="ul0004-0002" num="0030">b) for users k of index different to 1, to transmit the signal to be demodulated to an equalizer of rank k and the various estimated modulated symbols from at least one of the decoders of rank (k−1) in order to obtain the estimated modulated symbols of user k.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0028" num="0031">The device and method according to the invention are applied to demodulate a signal in the context of a space division and/or a CDMA-type code division multiple access scheme.</p>
<p id="p-0029" num="0032">The decoding method according to the invention and the suitable receiver or device have the particular advantage of overcoming interference between symbols more effectively than that of the prior art.</p>
<p id="p-0030" num="0033">The method and the structure of the receiver prove also to be less complex than certain methods from the prior art using MAP (maximum a posteriori)-type equalizers or Wiener-type filters which require a matrix inversion for each symbol estimation.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<p id="p-0031" num="0034">Other features and advantages of the invention will become apparent on reading the description provided below for illustration purposes and not at all limiting, in conjunction with the figures in which:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0035"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram of a system for coding the signals from K users sharing a propagation channel,</li>
        <li id="ul0006-0002" num="0036"><figref idref="DRAWINGS">FIG. 2</figref> shows an example structure of a receiver, reducing the problem at the receive end to block diagram form,</li>
        <li id="ul0006-0003" num="0037"><figref idref="DRAWINGS">FIG. 3</figref> shows the steps and the means implemented by the invention,</li>
        <li id="ul0006-0004" num="0038"><figref idref="DRAWINGS">FIG. 4</figref> shows a matrix modeling the signal,</li>
        <li id="ul0006-0005" num="0039"><figref idref="DRAWINGS">FIG. 5</figref> shows an example structure of the equalizer used in the method according to the invention, and</li>
        <li id="ul0006-0006" num="0040"><figref idref="DRAWINGS">FIG. 6</figref> is an alternative implementation of the invention.</li>
    </ul>
    </li>
</ul>
</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0032" num="0041"><figref idref="DRAWINGS">FIG. 1</figref> shows a system for coding the signals transmitted by K users who share a same propagation channel and who use waveforms spread spectrally via codes, each user denoted by k, where k varies from 1 to K, having his own code. The users are considered as asynchronous users who access a same frequency-selective propagation channel in order to transmit information.</p>
<p id="p-0033" num="0042">The digital signal associated with user k is coded using a correcting code <b>1</b> before being transmitted to an interleaver <b>2</b>. These two functional blocks may be identical or very different for each user k. The correcting code is for example a convolutional-type code, but not necessarily so.</p>
<p id="p-0034" num="0043">The coded signal is then “spread” using a spreading sequence <b>3</b><sub>k</sub>—the purpose of the index k is to denote the specific spreading sequence for each user k. The different spreading sequences for each user thus provide for discrimination between them. A modulated signal will see a different propagation channel <b>4</b><sub>k </sub>for each user. This typically corresponds to the uplink of a cellular mobile radio system. The concept of propagation channel includes for example any time shifts resulting from an absence of synchronization between the K users.</p>
<p id="p-0035" num="0044">The receiver sees the sum of the various contributions of the signals from the various propagation channels. Thermal noise associated with the input stages of the receiver described below or even interference from signals transmitted in the same frequency band, for example mobile terminals of neighboring cells using the same frequency, may be added to these signals.</p>
<p id="p-0036" num="0045">To simplify the description, the modulation operations, typically the shaping by a half-Nyquist filter and the transmission via carrier, which are known to a person skilled in the art, are not represented in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0037" num="0046"><figref idref="DRAWINGS">FIG. 2</figref> shows a very general block diagram of a receiver.</p>
<p id="p-0038" num="0047">The signal made of all the symbols of all K users arrives in a multiuser equalizer <b>6</b> before being transmitted to a decoding device <b>7</b> comprising one or more decoders <b>7</b><sub>k</sub>.</p>
<p id="p-0039" num="0048">The equalizer <b>6</b> receives the signal from the various users along with information provided by the decoding block <b>7</b> on the coded symbols via a link <b>8</b>, except when no decoding has been performed. The equalizer <b>6</b> delivers as output weighted information on the coded symbols which make use of these two types of information, typically the probabilities of transmission of the various possible symbols.</p>
<p id="p-0040" num="0049">The functions for deinterleaving and shaping the weighted information between the equalizer and the decoders are not represented in the figure. These functions are for example for translating information on the 8-ary symbols into probabilities on the bits when the modulation is in 8 states and the code is binary.</p>
<p id="p-0041" num="0050">The decoder or decoders <b>7</b><sub>k </sub>receive information from the equalizer and make use of the information associated with the error-correcting code so as to provide more reliable information on the useful symbols and therefore the coded symbols. For example for a convolutional code, the decoder can be of the “MAP” (maximum a posteriori) type and calculates the probabilities on the useful symbols from the knowledge of the probabilities on the coded symbols.</p>
<p id="p-0042" num="0051">The weighted information is then reinterleaved and reshaped before being reinputted into the “equalizer” block. The data interleaving step is carried out according to a method known to a person skilled in the art and will not be detailed. One way of proceeding consists for example in writing the data column by column in a matrix of appropriate dimension and reading this matrix row by row for example. This advantageously results in any errors being distributed during the reading stage of the signal. The shaping is performed according to conventional methods which are known to a person skilled in the art, and hence are not detailed.</p>
<p id="p-0043" num="0052"><figref idref="DRAWINGS">FIG. 3</figref> shows a structure of a receiver <b>10</b> according to the invention comprising several equalizers <b>11</b><sub>k </sub>and several decoders <b>12</b><sub>k</sub>, where the index k is used to identify a user. The receiver therefore comprises as many modules as there are users, each module being formed from an equalizer and a decoder.</p>
<p id="p-0044" num="0053">The signal comprising the symbols from all the users is received by each equalizer <b>11</b><sub>k </sub>of the receiver <b>10</b>.</p>
<p id="h-0001" num="0000">Step a)</p>
<p id="p-0045" num="0054">The equalizer of rank 1 referenced <b>11</b><sub>1</sub>, receives for example the samples from the signal to be decoded, without information a priori on its own symbols or on the symbols of the other users. The information resulting from this first equalization is transmitted to the decoder of rank 1 denoted by <b>12</b><sub>1</sub>, which provides more reliable information on the useful symbols and therefore the modulated symbols of the user.</p>
<p id="h-0002" num="0000">Step b)</p>
<p id="p-0046" num="0055">The reliable information, on the useful symbols, obtained for user 1 is then transmitted to the equalizer of rank 2, <b>11</b><sub>2</sub>, which also receives the samples of the received signal to be decoded. The equalizer thus enables the interference associated with the user of rank 1 to be taken into account, while still knowing nothing a priori about the symbols of the users of rank greater than or equal to 2. The information from this second equalization is then transmitted to the decoder of rank 2, <b>12</b><sub>2</sub>, which will provide information on the useful symbols of the user of rank 2.</p>
<p id="p-0047" num="0056">Step b) is executed as many times as there are users of rank different to 1, that is K−1 times.</p>
<p id="p-0048" num="0057">To generalize, for the user of index k, the samples of the signal are transmitted to the equalizer of rank k, <b>11</b><sub>k</sub>, which also receives the useful symbols relating to the users of rank 1 to k−1, resulting from the different decoders <b>12</b><sub>1</sub>, . . . , <b>12</b><sub>k−1</sub>. The equalizer <b>11</b><sub>k </sub>thus takes into account the interference associated with the users of rank 1 to (k−1) for decoding the signal associated with user k. The information arising from this kth equalization is then transmitted to the decoder of rank k, <b>12</b><sub>k</sub>, which will provide information on the useful symbols of the user of rank k.</p>
<p id="p-0049" num="0058">The last equalizer has information on all the other users.</p>
<p id="p-0050" num="0059">According to an embodiment of the invention, the equalizer used has a two-part structure. The first part is for subtracting for a user k in question the participation of the users of rank 1 to k−1, and the second part corresponds to a decision feedback equalizer (DFE) structure having the characteristics described below.</p>
<p id="p-0051" num="0060">The signal received by the equalizer can be modeled as described below.</p>
<p id="p-0052" num="0061">It is assumed that a block of received samples can be arranged in a vectorial form Z. This block of samples arises from the contribution of the K users, each of them contributing with N coded symbols.</p>
<p id="p-0053" num="0062">The contribution from an arbitrary user of index k to the received signal is obtained, without taking into account the modulation operations on the carrier, via the following operations:
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0063">spreading by a factor Q of each coded symbol,</li>
        <li id="ul0008-0002" num="0064">shaping, for example by a half-Nyquist filter,</li>
        <li id="ul0008-0003" num="0065">filtering by the propagation channel by introducing multiple paths for example,</li>
        <li id="ul0008-0004" num="0066">anti-aliasing filtering at the receive end, and</li>
        <li id="ul0008-0005" num="0067">sampling.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0054" num="0068">The signal from user k before sampling is given for example by equation (1) below</p>
<p id="p-0055" num="0069">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>z</mi>
            <mi>k</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munder>
            <mo>∑</mo>
            <mi>n</mi>
          </munder>
          <mo>⁢</mo>
          <mrow>
            <msub>
              <mi>a</mi>
              <mrow>
                <mi>n</mi>
                <mo>,</mo>
                <mi>k</mi>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>q</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mi>Q</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <mrow>
                  <msub>
                    <mi>c</mi>
                    <mrow>
                      <mi>q</mi>
                      <mo>,</mo>
                      <mi>k</mi>
                    </mrow>
                  </msub>
                  <mo>·</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>h</mi>
                      <mo>⊗</mo>
                      <msub>
                        <mi>p</mi>
                        <mi>k</mi>
                      </msub>
                      <mo>⊗</mo>
                      <mi>f</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <mrow>
                      <mi>q</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <msub>
                        <mi>T</mi>
                        <mi>c</mi>
                      </msub>
                    </mrow>
                    <mo>-</mo>
                    <mrow>
                      <mi>n</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <msub>
                        <mi>T</mi>
                        <mi>s</mi>
                      </msub>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0056" num="0070">In this equation, h represents the shaping filter at the transmission stage, p<sub>k</sub>(t) is the propagation channel specific to a user k, f(t) is the receive filter before sampling, T<sub>c </sub>is the chip period, inverse of the modulation rate, and T<sub>s </sub>is the symbol period before spreading. The symbols a<sub>n,k </sub>are the coded symbols of the user k and the symbols c<sub>q,k </sub>are the chips of the spreading sequence, where n corresponds to the temporal index of the coded symbol and q corresponds to the index of the chips or symbols of the spreading sequence.</p>
<p id="p-0057" num="0071">The symbol
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0072"><img id="CUSTOM-CHARACTER-00001" he="3.56mm" wi="2.46mm" file="US07298801-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/>
<br/>
represents the convolution.
</li>
</ul>
</p>
<p id="p-0058" num="0073">Suppose:</p>
<p id="p-0059" num="0074">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>s</mi>
            <mi>k</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>∑</mo>
            <mrow>
              <mi>q</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>Q</mi>
          </munderover>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>c</mi>
                <mrow>
                  <mi>q</mi>
                  <mo>,</mo>
                  <mi>k</mi>
                </mrow>
              </msub>
              <mo>·</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>h</mi>
                  <mo>⊗</mo>
                  <msub>
                    <mi>p</mi>
                    <mi>k</mi>
                  </msub>
                  <mo>⊗</mo>
                  <mi>f</mi>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>t</mi>
                <mo>-</mo>
                <mrow>
                  <mi>q</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>T</mi>
                    <mi>c</mi>
                  </msub>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0060" num="0075">Then:</p>
<p id="p-0061" num="0076">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>z</mi>
            <mi>k</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munder>
            <mo>∑</mo>
            <mi>n</mi>
          </munder>
          <mo>⁢</mo>
          <mrow>
            <msub>
              <mi>a</mi>
              <mrow>
                <mi>n</mi>
                <mo>,</mo>
                <mi>k</mi>
              </mrow>
            </msub>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>s</mi>
                <mi>k</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>t</mi>
                  <mo>-</mo>
                  <mrow>
                    <mi>n</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>T</mi>
                      <mi>s</mi>
                    </msub>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0062" num="0077">Equation (3) shows that the contribution of each user k can be put in the form of filtering of a train of symbols by a certain function S<sub>k</sub>(t) which contains the effects of the spreading, of the shaping filter at the transmission stage, of the propagation and of the receive filters before sampling.</p>
<p id="p-0063" num="0078">Let S<sub>k </sub>be the vector containing the samples of s<sub>k</sub>(t). Then the sampled signal can be rewritten for the user k as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Z</i><sub>k</sub><i>=H</i><sub>k</sub><i>·A</i><sub>k</sub>  (4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where A<sub>k </sub>is the vector of N symbols a<sub>n,k </sub>and H<sub>k </sub>is a matrix constructed from the vector Sk in the manner described in <figref idref="DRAWINGS">FIG. 4</figref>.
</p>
<p id="p-0064" num="0079">The columns of the matrix H<sub>k </sub>are constructed from shifted versions of the sequence S<sub>k</sub>, and each column corresponds to a new symbol of the vector A<sub>k </sub>and the shift corresponds to the number of samples per symbol. The recovery between the various shifted versions of S<sub>k </sub>corresponds to the duration of the overall impulse response (filters plus propagation channel).</p>
<p id="p-0065" num="0080">The complete model can then be represented as follows:</p>
<p id="p-0066" num="0081">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>Z</mi>
        <mo>=</mo>
        <mrow>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>k</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>H</mi>
                <mi>k</mi>
              </msub>
              <mo>⁢</mo>
              <msub>
                <mi>A</mi>
                <mi>k</mi>
              </msub>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mi>W</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0067" num="0082">In this equation (5), W is a noise vector associated with the interference outside the cell and with the noise inside the receiver.</p>
<p id="p-0068" num="0083"><figref idref="DRAWINGS">FIG. 5</figref> shows the structure of an equalizer operating by using the feedback principle described previously in relation to <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0069" num="0084">During equalization of user k, the purpose of the first block <b>20</b> is to subtract from the received signal Z the contributions of the users of indices between 1 and k−1, that is users already processed. To do this, it receives the vectors of estimated symbols corresponding to these users. The estimate of the symbols is made for example by calculating the mathematical expectation of the value of the symbol from the probabilities obtained during the decoding steps.</p>
<p id="p-0070" num="0085">The purpose of the second block <b>21</b> is to process the intersymbol interference corresponding to the symbols of user k himself, and the noise resulting from the users of indices k+1 to K not yet processed and from the thermal noise. The equalizer has a DFE structure, that is it is made up of a “transverse filter” part and a “decision in feedback” part. The “transverse filter” part is calculated by taking into account the knowledge of the structure of the noise generated by the users not yet processed and by the thermal noise. The “decision in feedback” part has a sequential operation. For each index n symbol of the current user, it subtracts the contribution from the already decided lower index symbols.</p>
<p id="p-0071" num="0086">The second block according to the invention comprises for example a transverse filter <b>22</b> such as a matrix being applied to the vector U, and the resulting vector V is sampled at the symbol rate. The coordinates v<sub>1 </sub>of this vector are then passed into a loop comprising a decision unit <b>23</b> and a recursive filter <b>24</b>. The decision unit is for obtaining a decision on the symbols. At each new symbol, the recursive filter <b>24</b> subtracts the contribution from the symbols already decided in the block and forwarded. The loop also comprises a weighted output <b>25</b>, before the decision unit, for transmitting the symbols to the decoder.</p>
<p id="p-0072" num="0087">The calculation from the transverse filter <b>22</b> and the recursive filter <b>24</b> is carried out for example in the manner described below.</p>
<p id="p-0073" num="0088">The calculation of the filters uses as criterion the minimization of the mean square error between the weighted output of the equalizer and the vector of symbols of user k.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>min(E(∥Y<sub>k</sub>−A<sub>k</sub>∥<sup>2</sup>))  (6)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0074" num="0089">From equation (5), the vector U can be represented as follows</p>
<p id="p-0075" num="0090">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>U</mi>
          <mo>=</mo>
          <mrow>
            <mrow>
              <msub>
                <mi>H</mi>
                <mi>k</mi>
              </msub>
              <mo>⁢</mo>
              <msub>
                <mi>A</mi>
                <mi>k</mi>
              </msub>
            </mrow>
            <mo>+</mo>
            <mi>B</mi>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mi>B</mi>
          <mo>=</mo>
          <mrow>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>l</mi>
                  <mo>=</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
                <mi>K</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <msub>
                  <mi>H</mi>
                  <mi>l</mi>
                </msub>
                <mo>⁢</mo>
                <msub>
                  <mi>A</mi>
                  <mi>l</mi>
                </msub>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mi>W</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0076" num="0091">In this equation (7), the noise is made up of signals transmitted by the rank k+1 to K users not yet decoded and of the initial additive noise W.</p>
<p id="p-0077" num="0092">For a white noise W, the expressions for the filters are given below:</p>
<p id="p-0078" num="0093">The correlation matrix for B is</p>
<p id="p-0079" num="0094">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>R</mi>
          <mi>B</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msubsup>
              <mi>σ</mi>
              <mi>A</mi>
              <mn>2</mn>
            </msubsup>
            <mo>·</mo>
            <mrow>
              <munderover>
                <mo>∑</mo>
                <mrow>
                  <mi>l</mi>
                  <mo>=</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
                <mi>K</mi>
              </munderover>
              <mo>⁢</mo>
              <mrow>
                <msub>
                  <mi>H</mi>
                  <mi>l</mi>
                </msub>
                <mo>⁢</mo>
                <msubsup>
                  <mi>H</mi>
                  <mi>l</mi>
                  <mi>†</mi>
                </msubsup>
              </mrow>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mrow>
              <msubsup>
                <mi>σ</mi>
                <mi>W</mi>
                <mn>2</mn>
              </msubsup>
              <mo>·</mo>
              <mi>I</mi>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>d</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where σ<sub>A</sub><sup>2 </sup>is the power of the modulation symbols, σ<sub>w</sub><sup>2 </sup>is the power of the noise and Id is the identity matrix
<ul id="ul0010" list-style="none">
    <li id="ul0010-0001" num="0000">
    <ul id="ul0011" list-style="none">
        <li id="ul0011-0001" num="0095">the matrix Q is defined by</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0080" num="0096">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>Q</mi>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msubsup>
              <mi>H</mi>
              <mi>k</mi>
              <mi>†</mi>
            </msubsup>
            <mo>⁢</mo>
            <msubsup>
              <mi>R</mi>
              <mi>B</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msubsup>
            <mo>⁢</mo>
            <msub>
              <mi>H</mi>
              <mi>k</mi>
            </msub>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <msubsup>
                <mi>σ</mi>
                <mi>W</mi>
                <mn>2</mn>
              </msubsup>
            </mfrac>
            <mo>⁢</mo>
            <mi>I</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>d</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>9</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<ul id="ul0012" list-style="none">
    <li id="ul0012-0001" num="0000">
    <ul id="ul0013" list-style="none">
        <li id="ul0013-0001" num="0097">the Cholesky composition of this matrix is formed as follows
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>Q=(ΣL)†(ΣL)  (10)<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0081" num="0098">In equation (10), Σ is a diagonal matrix and L is a lower triangular matrix.</p>
<p id="p-0082" num="0099">The expression of the transverse filter which minimizes criterion (6) is
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>T=Σ<sup>−2</sup>L<sup>−1†</sup>H<sub>k</sub>†R<sub>B</sub><sup>−1</sup>  (11)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0083" num="0100">The recursive filter is determined by the rows of (L-Id).</p>
<p id="p-0084" num="0101">According to an embodiment of the invention, the device uses an interference canceler when all the symbols to be demodulated have been the subject of at least one decoding stage. In this situation, unlike the decision feedback equalizer, when it is desired to decide the symbol j of the user k, all the other symbols of the same user or of the other users can be considered known, even if in practice only the estimates of these symbols are known. It is then possible to subtract their contribution totally.</p>
<p id="p-0085" num="0102"><figref idref="DRAWINGS">FIG. 6</figref> shows the principle of this canceler in block diagram form.</p>
<p id="p-0086" num="0103">Compared to the decision feedback equalizer case in <figref idref="DRAWINGS">FIG. 5</figref>, there is more information on all the symbols from iteration i−1 for certain users, for example those of index 1 to k−1, and from the current iteration i for the other users of index k+1 to K.</p>
<p id="p-0087" num="0104">The principle implemented consists in:
<ul id="ul0014" list-style="none">
    <li id="ul0014-0001" num="0000">
    <ul id="ul0015" list-style="none">
        <li id="ul0015-0001" num="0105">subtracting the contributions from all the users other than user k being processed, by using the most recent information for each of them, for the users of index 1 to k−1 the estimates of the vectors of the symbols during iteration i and for the users of index k+1 to K the information of the estimates obtained during iteration (i−1), this iteration being carried out in the first block <b>20</b> which generates a vector U,</li>
        <li id="ul0015-0002" num="0106">filtering the received samples for the user k in the filter T <b>22</b>, and the resulting vector V is then sampled for example at the symbol rate,</li>
        <li id="ul0015-0003" num="0107">subtracting in the second block <b>21</b>, for a given symbol n, the residual intersymbol interference coming from the other symbols of the user k. The contribution from the symbols 1 to n−1 is determined by the filter P<sub>n</sub>, <b>26</b> and the contribution from the index n+1 to N symbols is determined by a filter Q<sub>n</sub>, <b>27</b>.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0088" num="0108">In this way, compared with the decision feedback, much richer information is available than the previous decided symbols, that is information on the past but also future symbols from the previous iteration.</p>
<p id="p-0089" num="0109">After the processing steps, the next step is the decoding step, and then the next user is considered and the contribution of user k is subtracted by using the results obtained during iteration i and no longer i−1.</p>
<p id="p-0090" num="0110">The different equalization and decoding steps can advantageously be applied to a set of users who are ordered according to a criterion taking account of the power associated with a user, from which the contribution of intersymbol interference for this same user and for the other users is subtracted.</p>
<p id="p-0091" num="0111">This criterion is determined for example as follows:
<ul id="ul0016" list-style="none">
    <li id="ul0016-0001" num="0000">
    <ul id="ul0017" list-style="none">
        <li id="ul0017-0001" num="0112">h<sub>kl </sub>denotes the lth column of the matrix H<sub>k </sub>described in relation to <figref idref="DRAWINGS">FIG. 4</figref>. This vector denotes the overall impulse response of the channel for the lth symbol of the block to be demodulated, of user k,</li>
        <li id="ul0017-0002" num="0113">the criterion C<sub>k </sub>is determined as follows</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0092" num="0114">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>C</mi>
    <mi>k</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <munderover>
      <mo>∑</mo>
      <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>1</mn>
      </mrow>
      <mi>N</mi>
    </munderover>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mrow>
            <msubsup>
              <mi>h</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>n</mi>
              </mrow>
              <mi>†</mi>
            </msubsup>
            <mo>⁢</mo>
            <msub>
              <mi>h</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>n</mi>
              </mrow>
            </msub>
          </mrow>
          <mo>-</mo>
          <munder>
            <mo>∑</mo>
            <mrow>
              <mi>m</mi>
              <mo>≠</mo>
              <mi>n</mi>
            </mrow>
          </munder>
        </mrow>
        <mo>|</mo>
        <mrow>
          <msubsup>
            <mi>h</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mi>†</mi>
          </msubsup>
          <mo>⁢</mo>
          <msub>
            <mi>h</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>m</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>|</mo>
        <mrow>
          <mo>-</mo>
          <mrow>
            <munder>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>≠</mo>
                <mi>k</mi>
              </mrow>
            </munder>
            <mo>⁢</mo>
            <munder>
              <mo>∑</mo>
              <mi>m</mi>
            </munder>
          </mrow>
        </mrow>
        <mo>|</mo>
        <mrow>
          <msubsup>
            <mi>h</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mi>†</mi>
          </msubsup>
          <mo>⁢</mo>
          <msub>
            <mi>h</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>m</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>|</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where the symbol † denotes the transposed conjugate, the first term corresponds to the power associated with user k, the second term corresponds to the contribution from the user and the third term to the contribution to intersymbol interference for all the other users.
</p>
<p id="p-0093" num="0115">This calculation involves correlations between the signals corresponding to the various symbols whether they are transmitted by the user k himself or by the others.</p>
<p id="p-0094" num="0116">In fact, the method measures the existing distance, at least, between two opposed symbols at the output of a filter designed according to the impulse response h<sub>kn</sub>, whatever the values of the other symbols which interfere.</p>
<p id="p-0095" num="0117">The users are arranged in a descending order before placing the steps of the method according to the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298801-20071120-M00001.NB">
<img id="EMI-M00001" he="9.91mm" wi="76.20mm" file="US07298801-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298801-20071120-M00002.NB">
<img id="EMI-M00002" he="9.57mm" wi="76.20mm" file="US07298801-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298801-20071120-M00003.NB">
<img id="EMI-M00003" he="7.03mm" wi="76.20mm" file="US07298801-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298801-20071120-M00004.NB">
<img id="EMI-M00004" he="9.14mm" wi="76.20mm" file="US07298801-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298801-20071120-M00005.NB">
<img id="EMI-M00005" he="13.38mm" wi="76.20mm" file="US07298801-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298801-20071120-M00006.NB">
<img id="EMI-M00006" he="9.14mm" wi="76.20mm" file="US07298801-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298801-20071120-M00007.NB">
<img id="EMI-M00007" he="7.03mm" wi="76.20mm" file="US07298801-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298801-20071120-M00008.NB">
<img id="EMI-M00008" he="10.58mm" wi="76.20mm" file="US07298801-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298801-20071120-M00009.NB">
<img id="EMI-M00009" he="10.58mm" wi="76.20mm" file="US07298801-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A device for equalizing and decoding digital signals from K users including K modules, each module comprising:
<claim-text>an equalizer; and</claim-text>
<claim-text>a decoder, wherein</claim-text>
<claim-text>an equalizer of rank k, k being an index between 1 and K, is linked to at least one decoder of lower rank 1 to k−1, and an equalizer of rank k−1 thereby receives information from a user of higher rank k to K, whether symbols from signals of K users are useable or not, wherein</claim-text>
<claim-text>each equalizer includes a first and second block,
<claim-text>the first block configured to receive at least a signal to be demodulated from a user k and estimates of the symbols associated with users 1 to k−1, and</claim-text>
<claim-text>the second block configured to subtract a contribution from past symbols already demodulated from a signal received from the first block, and</claim-text>
</claim-text>
<claim-text>the first block receives, at an ith iteration, at least the signal from user k to be demodulated, at least the estimates of the symbols associated with users 1 to k−1 corresponding to the ith iteration and estimates of the symbols of users k+1 to K which are obtained at the (i−1)th iteration and the second block receives the estimates of the symbols of user k which are obtained at the (i−1)th iteration.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A method for equalizing and decoding digital signals of K users in a receiver comprising several modules each comprising at least one equalizer followed by a decoder wherein the method comprises:
<claim-text>a) at iteration <b>1</b>, for a user of index <b>1</b>, transmitting a signal to be modulated demodulated to an equalizer of rank <b>1</b>, and from the equalizer of rank <b>1</b> to a decoder of rank <b>1</b> to obtain estimated modulated symbols of user k,</claim-text>
<claim-text>b) for users k of index different to 1, transmitting the signal to be demodulated to an equalizer of rank k and the various estimated modulated symbols from at least one of the decoders of rank (k−1),</claim-text>
<claim-text>performing plural iterations of step a) and step b) and, for an iteration different from the first iteration, step b) includes, during an ith iteration, transmitting to a first block of the equalizer of rank k the symbols of user k to be demodulated, estimates of the symbols of users 1 to k−1obtained during the ith iteration and estimates of the symbols of users k+1 to K obtained during the (i−1)th iteration and to a second block of the equalizer the estimates of the symbols of user k from the (i−1)th iteration.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A method for equalizing and decoding digital signals of K users in a receiver comprising several modules each comprising at least one equalizer followed by a decoder wherein the method comprises:
<claim-text>a) at iteration <b>1</b>, for a user of index <b>1</b>, transmitting a signal to be demodulated to an equalizer of rank <b>1</b>, and from the equalizer of rank <b>1</b> to a decoder of rank <b>1</b> to obtain estimated modulated symbols of user k,</claim-text>
<claim-text>b) for users k of index different to 1, transmitting the signal to be demodulated to an equalizer of rank k and the various estimated modulated symbols from at least one of the decoders of rank (k−1), and</claim-text>
<claim-text>c) ordering the users k, before being processed, according to a criterion taking account of a corrected power, associated with user k, of a contribution of intersymbols associated with himself and with the other users,</claim-text>
<claim-text>wherein the criterion for ordering the users is determined as follows</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>C</mi>
    <mi>k</mi>
  </msub>
  <mo>=</mo>
  <mrow>
    <munderover>
      <mo>∑</mo>
      <mrow>
        <mi>n</mi>
        <mo>=</mo>
        <mn>1</mn>
      </mrow>
      <mi>N</mi>
    </munderover>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mrow>
          <mrow>
            <msubsup>
              <mi>h</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>n</mi>
              </mrow>
              <mi>†</mi>
            </msubsup>
            <mo>⁢</mo>
            <msub>
              <mi>h</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>n</mi>
              </mrow>
            </msub>
          </mrow>
          <mo>-</mo>
          <munder>
            <mo>∑</mo>
            <mrow>
              <mi>m</mi>
              <mo>≠</mo>
              <mi>n</mi>
            </mrow>
          </munder>
        </mrow>
        <mo>|</mo>
        <mrow>
          <msubsup>
            <mi>h</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mi>†</mi>
          </msubsup>
          <mo>⁢</mo>
          <msub>
            <mi>h</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>m</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>|</mo>
        <mrow>
          <mo>-</mo>
          <mrow>
            <munder>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>≠</mo>
                <mi>k</mi>
              </mrow>
            </munder>
            <mo>⁢</mo>
            <munder>
              <mo>∑</mo>
              <mi>m</mi>
            </munder>
          </mrow>
        </mrow>
        <mo>|</mo>
        <mrow>
          <msubsup>
            <mi>h</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>n</mi>
            </mrow>
            <mi>†</mi>
          </msubsup>
          <mo>⁢</mo>
          <msub>
            <mi>h</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>m</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>|</mo>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>where h<sub>kl </sub>denotes the lth column of a matrix H<sub>k </sub>constructed from the vector containing the samples of the signal of user k, and n denotes the temporal index of the coded symbol.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The device as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a device suitable for determining a criterion to order the users before transmitting the signals to the equalizer and the decoder, the criterion taking into account a power of user k and an intersymbol interference for the user k and other users.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method as claimed in <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising:
<claim-text>ordering the users k, before being processed, according to a criterion taking account of a corrected power, associated with user k, of the contribution of intersymbols associated with the user k and with other users.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
