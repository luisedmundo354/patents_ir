<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299390-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299390</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11297948</doc-number>
<date>20051209</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>153</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>R</subclass>
<main-group>31</main-group>
<subgroup>28</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>714726</main-classification>
<further-classification>714724</further-classification>
<further-classification>713176</further-classification>
</classification-national>
<invention-title id="d0e53">Apparatus and method for encrypting security sensitive data</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5126950</doc-number>
<kind>A</kind>
<name>Rees et al.</name>
<date>19920600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>716  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6424926</doc-number>
<kind>B1</kind>
<name>Mak</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702117</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7228474</doc-number>
<kind>B2</kind>
<name>Williams et al.</name>
<date>20070600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714726</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0131295</doc-number>
<kind>A1</kind>
<name>Berry et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714726</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2004/0133832</doc-number>
<kind>A1</kind>
<name>Williams et al.</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714726</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>15</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>9</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Dastidar</last-name>
<first-name>Jayabrata Ghosh</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Martine Penilla &amp; Gencarella, LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Altera Corporation</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Chung</last-name>
<first-name>Phung My</first-name>
<department>2117</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An interlinked chain of exclusive-or (XOR) logic gates and registers is formed by connecting a first input of each XOR logic gate to an output of a preceding register, and by connecting an input of each register to an output of a preceding XOR logic gate. Each XOR logic gate has a second input connected to receive an output from a respective data source. The interlinked chain further includes an originating XOR logic gate having its first input connected to an output of an originating data source rather than to a preceding register. The interlinked chain includes a terminating XOR logic gate having an output defined to provide an encrypted signature for the various data source outputs. Destructible bypass connections are provided to enable direct access to each data source in a secure environment and permanently disable direct access to each data source prior to release from the secure environment.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="200.83mm" wi="118.87mm" file="US07299390-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="144.02mm" wi="170.35mm" file="US07299390-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="220.73mm" wi="123.61mm" file="US07299390-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="186.18mm" wi="159.85mm" file="US07299390-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="225.72mm" wi="123.27mm" file="US07299390-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="84.33mm" wi="72.56mm" file="US07299390-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="230.80mm" wi="116.92mm" file="US07299390-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="245.96mm" wi="118.96mm" file="US07299390-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="240.96mm" wi="171.70mm" file="US07299390-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">In modern electronic devices circuitry is often defined with scan capability. More specifically, a particular portion of circuitry can be defined to have a scan input chain and a scan output chain. Each of the scan input and output chains is defined by a set of serially connected registers, wherein each register is typically defined to store a single bit signal. Scan input data can be clocked through the various registers in the scan input chain. The scan input data represents binary input signals for the portion of circuitry to be tested by the scan input and output chains. Once the scan input chain is loaded, the scan input data is clocked through the circuitry to be tested. Various output signals generated by the circuitry based on the scan input data are then clocked out to the registers that define the scan output chain. Then, the scan output data is clocked out in a serial manner to be compared with expected scan output data. If the scan output data matches expectation, the circuitry is considered to be operating correctly. If the scan output data does match expectation, the circuitry is considered to be malfunctioning.</p>
<p id="p-0003" num="0002">With direct access to the scan output chain, a malevolent entity may be able to decipher the logical function of a portion of circuitry by analyzing the scan output data resulting from a large number of scan input data combinations. The malevolent entity could then exploit the deciphered logical function of the circuitry. For example, if the circuitry in question were defined to provide a security feature, the deciphered logical function of the circuitry could be used by the malevolent entity to bypass the security feature.</p>
<p id="p-0004" num="0003">Additionally, in the context of a programmable logic device (PLD), circuitry of the PLD is configured based on configuration data stored in a configuration memory. The configuration data is used to control a number of configuration devices within the PLD. A controlled state of the various configuration devices serves to establish circuitry connectivity and associated logic functions within the PLD. Thus, with direct access to the configuration data and knowledge of the underlying PLD structure, a malevolent entity may be able to ascertain the logic function of the configured PLD. The malevolent entity could then exploit the deciphered logic function of the configured PLD.</p>
<p id="p-0005" num="0004">In view of the foregoing, a solution is needed to ensure that security sensitive data, such as scan output data and PLD configuration data, is protected from direct access and exploitation. Additionally, the solution for protecting the security sensitive data should not interfere with legitimate access to the security sensitive data.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0006" num="0005">In one embodiment, a circuit is disclosed for encrypting scan test data. The circuit includes an interlinked chain of exclusive-or (XOR) logic gates and registers. The interlinked chain of XOR logic gates and registers is formed by connecting a first input of each XOR logic gate to an output of a preceding register, and by connecting an input of each register to an output of a preceding XOR logic gate. Each XOR logic gate also has a second input connected to receive an output from a respective scan output chain. The interlinked chain of XOR logic gates and registers further includes an originating XOR logic gate having its first input connected to an output of an originating scan output chain rather than to a preceding register. Additionally, the interlinked chain of XOR logic gates and registers includes a terminating XOR logic gate having an output defined to provide scan signature data. The scan signature data represents an encrypted version of scan test data output by each scan output chain.</p>
<p id="p-0007" num="0006">Each XOR logic gate and register within the interlinked chain of XOR logic gates and registers of the present embodiment is defined to transmit a single bit signal on each of their respective inputs and outputs in accordance with a common clock signal. Also, each of the plurality of scan output chains in the present embodiment can be associated with a portion of circuitry in a programmable logic device (PLD). Therefore, each of the plurality of scan output chains and its associated portion of circuitry has a corresponding scan input chain. The scan input and output chains enable testing of their associated portion of circuitry within the PLD.</p>
<p id="p-0008" num="0007">In another aspect of the present embodiment, the output of the terminating XOR logic gate is connected to a third input of at least one XOR logic gate within the interlinked chain of XOR logic gates and registers. Thus, the scan signature data provided from the terminating XOR logic gate is provided as a feedback signal to the third input of at least one XOR logic gate within the interlinked chain of XOR logic gates and registers. Connection of the scan signature data as a feedback signal further increases a difficulty level associated with deciphering the various scan output chain output signals that are used to generate the encrypted scan signature data.</p>
<p id="p-0009" num="0008">In another aspect of the present embodiment, a plurality of destructible bypass connections can be included with the circuit for encrypting scan test data. Each of the plurality of destructible bypass connections extends from the output of a respective one of the plurality of scan output chains to an output pin. Therefore, the plurality of destructible bypass connections enables direct access to the scan test data output by each scan output chain. In one embodiment, each of the destructible bypass connections is defined to include a fuse. The fuse in an intact state enables data transmission through the destructible bypass connection. The fuse in a blown state disables data transmission through the destructible bypass connection. Each fuse can be blown in a number of ways. For example, each fuse can be blown either by applying a sufficient current to the destructible bypass connection that includes the fuse, or through the appropriate application of a laser to the fuse. The plurality of destructible bypass connections can be destroyed prior to a non-secure release of the corresponding device. Upon destruction of the plurality of destructible bypass connections, the overall functionality of the device can continue to be checked using the scan signature data provided by the interlinked chain of XOR logic gates and registers.</p>
<p id="p-0010" num="0009">In another embodiment, a circuit is disclosed for encrypting configuration data of a PLD. The circuit includes an interlinked chain of XOR logic gates and registers. Within the interlinked chain, a first input of each XOR logic gate is connected to an output of a preceding register. Also within the interlinked chain, an input of each register is connected to an output of a preceding XOR logic gate. Each XOR logic gate in the interlinked chain also has a second input connected to receive an output from a respective configuration memory cell array defined within the PLD. The interlinked chain also includes an originating XOR logic gate having its first input connected to an output of an originating configuration memory cell array rather than to a preceding register. Additionally, the interlinked chain includes a terminating XOR logic gate having an output defined to provide configuration signature data. The configuration signature data represents an encrypted version of configuration data stored in each cell of the configuration memory.</p>
<p id="p-0011" num="0010">As with the circuit for encrypting scan test data in the previous embodiment, the circuit for encrypting PLD configuration data of the present embodiment is defined such that each XOR logic gate and register within the interlinked chain of XOR logic gates and registers transmits a single bit signal on each of their respective inputs and outputs in accordance with a common clock signal. Also, in another aspect of the present embodiment, the circuit for encrypting PLD configuration data can include connection of the output of the terminating XOR logic gate to a third input of at least one XOR logic gate within the interlinked chain. Provision of the configuration signature data as the feedback signal further increases a difficulty level associated with deciphering the PLD configuration data stored in the various cells of the configuration memory.</p>
<p id="p-0012" num="0011">In another aspect of the present embodiment, a plurality of destructible bypass connections can be included with the circuit for encrypting PLD configuration data. Each of the plurality of destructible bypass connections extends from the output of a respective configuration memory cell array to an output pin. Therefore, the plurality of destructible bypass connections enables direct access to the configuration data stored in each configuration memory cell array. In one embodiment, each of the destructible bypass connections is defined to include a fuse. The fuse in an intact state enables data transmission through the destructible bypass connection. The fuse in a blown state disables data transmission through the destructible bypass connection. Each fuse can be blown in a number of ways. For example, each fuse can be blown either by applying a sufficient current to the destructible bypass connection that includes the fuse, or through the appropriate application of a laser to the fuse. The plurality of destructible bypass connections can be destroyed prior to a non-secure release of the corresponding PLD. Upon destruction of the plurality of destructible bypass connections, the overall functionality of the PLD configuration memory can continue to be checked using the configuration signature data provided by the interlinked chain of XOR logic gates and registers.</p>
<p id="p-0013" num="0012">In yet another embodiment, a method is disclosed for encrypting digital data to defend against reverse engineering of a circuit. The method includes a first operation for performing an XOR logic function on a pair of digital data signals to generate an XOR logic function output signal. In a second operation, an XOR logic function is performed on the previously generated XOR logic function output signal and another digital data signal to generate another XOR logic function output signal. A third operation provides for repeating the second operation such that each digital data signal to be encrypted has been processed once through an XOR logic function. In a fourth operation, a lastly generated XOR logic function output signal is provided as an encrypted signature. The encrypted signature corresponds to an expected digital logic state when each of the digital data signals processed through its respective XOR logic function is correct.</p>
<p id="p-0014" num="0013">In another aspect of the present embodiment, the method can also include another operation for providing the lastly generated XOR logic function output signal as a feedback signal, wherein the feedback signal is to be used as a third input signal to at least one XOR logic function performed in the first, second, and third operations. Additionally, the method can include an operation for providing a destructible bypass connection to enable access to each digital data signal prior to processing of the digital data signal through an XOR logic function. An operation can also be provided for destroying each destructible bypass connection prior to a non-secure release of the circuit. In one implementation of the present embodiment, each digital data signal to be encrypted represents an output signal from a scan output chain of the circuit. In another implementation of the present embodiment, each digital data signal to be encrypted represents a configuration data signal for the circuit, wherein the circuit is defined within a PLD.</p>
<p id="p-0015" num="0014">Other aspects and advantages of the invention will become more apparent from the following detailed description, taken in conjunction with the accompanying drawings, illustrating by way of example the present invention.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> is an illustration showing a portion of circuitry having an associated scan input chain and an associated scan output chain;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> is an illustration showing a circuit for encrypting scan data, in accordance with one embodiment of the present invention;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3A</figref> is an illustration showing a truth table for a two-input XOR logic gate;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3B</figref> is an illustration showing the various combinations of scan chain outputs that could be produced in the exemplary embodiment of <figref idref="DRAWINGS">FIG. 2</figref> to yield a high logic state for a bit in the scan signature;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 4A</figref> is an illustration showing the circuit of <figref idref="DRAWINGS">FIG. 2</figref> with an additional feedback input to the various XOR logic gates of the interlinked chain, in accordance with one embodiment of the present invention;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 4B</figref> is an illustration showing a truth table for a three-input XOR logic gate;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 5A</figref> is an illustration showing a circuit for encrypting configuration data stored in CRAM cells of a PLD, in accordance with one embodiment of the present invention;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 5B</figref> is an illustration showing the circuit of <figref idref="DRAWINGS">FIG. 5A</figref> with an additional feedback input to the various XOR logic gates of the interlinked chain, in accordance with one embodiment of the present invention; and</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 6</figref> is an illustration showing a flowchart of a method for encrypting digital data to defend against reverse engineering of a circuit, in accordance with one embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0025" num="0024">In the following description, numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent, however, to one skilled in the art that the present invention may be practiced without some or all of these specific details. In other instances, well known process operations have not been described in detail in order not to unnecessarily obscure the present invention.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> is an illustration showing a portion of combinatorial circuitry <b>105</b> (“circuitry <b>105</b>” hereafter) having an associated scan input chain <b>101</b> and an associated scan output chain <b>103</b>. The scan input chain <b>101</b> and scan output chain <b>103</b> enable testing of the logic function defined by the circuitry <b>105</b>. The scan input chain <b>101</b> includes a number of serially connected registers <b>107</b><i>a</i>-<b>107</b><i>f</i>. It should be understood that the scan input chain <b>101</b> can include any number of registers as required by the logic function of the circuitry <b>105</b>. More specifically, a register can be provided for each input required by the logic function of the circuitry <b>105</b>.</p>
<p id="p-0027" num="0026">During operation, input data is sequentially loaded, i.e., clocked, into the scan input chain through a connection <b>111</b>. Once the necessary scan input data is loaded into each of the scan input chain <b>101</b> registers <b>107</b><i>a</i>-<b>107</b><i>f</i>, the scan input data is simultaneously transmitted, i.e., clocked, from each register <b>107</b><i>a</i>-<b>107</b><i>f </i>through a respective connection <b>115</b><i>a</i>-<b>115</b><i>f </i>to the various inputs required by the logic function of the circuitry <b>105</b>. Then, a sufficient number of functional clock cycles are performed to allow completion of the logic function of the circuitry <b>105</b>. Upon completion of the logic function of the circuitry <b>105</b>, each of the various outputs generated by the logic function of the circuitry <b>105</b> is transmitted, i.e., clocked, through a respective connection <b>117</b><i>a</i>-<b>117</b><i>f </i>to a respective register <b>109</b><i>a</i>-<b>109</b><i>f </i>in the scan output chain <b>103</b>. It should be understood that the scan output chain <b>103</b> can include any number of registers as required by the logic function of the circuitry <b>105</b>. More specifically, a register can be provided for each output generated by the logic function of the circuitry <b>105</b>. The scan output data in the registers <b>109</b><i>a</i>-<b>109</b><i>f </i>is then output through a connection <b>113</b> to be evaluated. If the scan output data matches the circuitry <b>105</b> logic function output expected for the scan input data, the circuitry <b>105</b> is considered to be defined and operating correctly. However, if the scan output data does not match the circuitry <b>105</b> logic function output expected for the scan input data, the circuitry <b>105</b> is considered to be faulty.</p>
<p id="p-0028" num="0027">It should be appreciated that direct access to the output connection <b>113</b> of the scan output chain <b>103</b>, enables access to each bit of scan output data. Such detailed access can support error correction within the circuitry <b>105</b>, or at least identification of the failure mode of the circuitry <b>105</b>. Unfortunately, however, such detailed access also leaves the logic function of the circuitry <b>105</b> vulnerable to reverse engineering. More specifically, it is feasible that by running a sufficient number of scan input data combinations through the circuitry <b>105</b> and examining the corresponding scan output data, the proprietary logic function of the circuitry <b>105</b> could be determined. Then, the exposed proprietary logic function of the circuitry <b>105</b> could be exploited by a malevolent entity.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 2</figref> is an illustration showing a circuit for encrypting scan data, in accordance with one embodiment of the present invention. The circuit of <figref idref="DRAWINGS">FIG. 2</figref> is shown to include a number of scan output chains <b>103</b><i>a</i>-<b>103</b><i>d</i>. For ease of discussion, <figref idref="DRAWINGS">FIG. 2</figref> shows four scan output chains <b>103</b><i>a</i>-<b>103</b><i>d</i>. However, it should be understood that the present invention can be implemented with any number of scan output chains. Each scan output chain <b>103</b><i>a</i>-<b>103</b><i>d </i>depicted in <figref idref="DRAWINGS">FIG. 2</figref> is the same as that previously described with respect to <figref idref="DRAWINGS">FIG. 1</figref>. Therefore, each scan output chain <b>103</b><i>a</i>-<b>103</b><i>d </i>is defined to output scan output data through the connection <b>113</b><i>a</i>-<b>113</b><i>d</i>, respectively. In one embodiment, each of the scan output chains <b>105</b><i>a</i>-<b>105</b><i>d </i>is associated with a portion of circuitry in a programmable logic device (PLD).</p>
<p id="p-0030" num="0029">The circuit of <figref idref="DRAWINGS">FIG. 2</figref> also includes an interlinked chain of exclusive-or (XOR) logic gates <b>203</b><i>a</i>-<b>203</b><i>c </i>and registers <b>201</b><i>a</i>-<b>201</b><i>b</i>. The interlinked chain includes an originating XOR logic gate <b>203</b><i>a </i>having a first input connected to the output connection <b>113</b><i>a </i>of the scan output chain <b>103</b><i>a</i>, wherein the scan output chain represents an originating scan output chain in the exemplary embodiment of <figref idref="DRAWINGS">FIG. 2</figref>. The originating XOR logic gate <b>203</b><i>a </i>also includes a second input connected to the output connection <b>113</b><i>b </i>of the scan output chain <b>103</b><i>b</i>. An output <b>207</b> of the originating XOR logic gate <b>203</b><i>a </i>is connected to an input of the subsequently positioned register <b>201</b><i>a</i>. Additionally, an XOR logic gate <b>203</b><i>b </i>is defined to have a first input connected to an output <b>209</b> of the preceding register <b>201</b><i>a</i>. The XOR logic gate <b>203</b><i>b </i>is also defined to have a second input connected to the output connection <b>113</b><i>c </i>of the scan output chain <b>103</b><i>c</i>. An output <b>211</b> of the XOR logic gate <b>203</b><i>b </i>is connected to an input of the subsequently positioned register <b>201</b><i>b. </i></p>
<p id="p-0031" num="0030">The interlinked chain is further defined to include a terminating XOR logic gate <b>203</b><i>c </i>having a first input connected to an output <b>213</b> of the preceding register <b>201</b><i>b</i>. The terminating XOR logic gate <b>203</b><i>c </i>is defined to have a second input connected to the output connection <b>113</b><i>d </i>of the scan output chain <b>103</b><i>d</i>. An output <b>217</b> of the terminating XOR logic gate <b>203</b><i>c </i>is defined to provide scan signature data, wherein the scan signature data represents an encrypted version of the scan test output data transmitted from each scan output chain <b>103</b><i>a</i>-<b>103</b><i>d. </i></p>
<p id="p-0032" num="0031">In one embodiment, each XOR logic gate and register within the interlinked chain of XOR logic gates and registers is defined to transmit a single bit logic signal on each of their respective inputs and outputs in accordance with a common clock signal. Thus, as the common clock signal cycles, data is shifted out of the number of scan output chains <b>103</b><i>a</i>-<b>103</b><i>d </i>and through the interlinked chain of XOR logic gates and registers one bit per clock cycle.</p>
<p id="p-0033" num="0032">The circuit of <figref idref="DRAWINGS">FIG. 2</figref> also includes a number of destructible bypass connections extending from a respective scan output chain output connection <b>113</b><i>a</i>-<b>113</b><i>d </i>to a respective output pin <b>237</b><i>a</i>-<b>237</b><i>d</i>. More specifically, a destructible bypass connection defined by connections <b>219</b> and <b>221</b> and a fuse <b>235</b><i>a </i>extends from the scan output chain output connection <b>113</b><i>a </i>to the output pin <b>237</b><i>a</i>. Another destructible bypass connection defined by connections <b>223</b> and <b>225</b> and a fuse <b>235</b><i>b </i>extends from the scan output chain output connection <b>113</b><i>b </i>to the output pin <b>237</b><i>b</i>. Another destructible bypass connection defined by connections <b>227</b> and <b>229</b> and a fuse <b>235</b><i>c </i>extends from the scan output chain output connection <b>113</b><i>c </i>to the output pin <b>237</b><i>c</i>. Another destructible bypass connection defined by connections <b>231</b> and <b>233</b> and a fuse <b>235</b><i>d </i>extends from the scan output chain output connection <b>113</b><i>d </i>to the output pin <b>237</b><i>d</i>. It should be appreciated that each of the above-identified destructible bypass connections enables direct access to the scan test data output by its respective scan output chain. Thus, while a given destructible bypass connection is intact, scan output data can be directly accessed at the output connection of the corresponding scan output chain.</p>
<p id="p-0034" num="0033">When each of the fuses <b>235</b><i>a</i>-<b>235</b><i>d </i>is in an intact state, i.e., in the as-manufactured state, data transmission is enabled through the corresponding destructible bypass connection. When each of the fuses <b>235</b><i>a</i>-<b>235</b><i>d </i>is in a blown state, data transmission is disabled through the corresponding destructible bypass connection. In one embodiment, the fuses are maintained in the intact state during manufacturing and testing of the various circuits <b>105</b><i>a</i>-<b>105</b><i>d</i>. It should be appreciated that during manufacture and testing, the various circuits are within a secure environment safe from reverse engineering hackers. Prior to non-secure release of the device including the various circuits <b>105</b><i>a</i>-<b>105</b><i>d</i>, the fuses <b>235</b><i>a</i>-<b>235</b><i>d </i>are blown to permanently destroy the destructible bypass connections. In one embodiment, each fuse <b>235</b><i>a</i>-<b>235</b><i>d </i>can be blown by applying a sufficient current to the destructible bypass connection that includes the fuse. In another embodiment, each fuse <b>235</b><i>a</i>-<b>235</b><i>d </i>can be blown through the appropriate application of a laser to the fuse.</p>
<p id="p-0035" num="0034">It should be appreciated that following the disablement of the destructible bypass connections, the combined functionality of the various circuits <b>105</b><i>a</i>-<b>105</b><i>d </i>can continue to be tested through use of the scan signature generated by the interlinked chain of XOR logic gates and registers. More specifically, because the expected scan output data for a given set of scan input data is known and because the structure of the interlinked chain of XOR logic gates and registers is known, the resulting scan signature for the given set of scan input data is known. Therefore, the overall combined functionality of the circuits <b>105</b><i>a</i>-<b>105</b><i>d </i>can be tested by observing the scan signature data corresponding to a given set of scan input data. However, it should be appreciated that with the destructible bypass connections disabled, the exact scan output data is inaccessible.</p>
<p id="p-0036" num="0035">To reverse engineer the logic function of the various circuits <b>105</b><i>a</i>-<b>105</b><i>d </i>using the scan signature, one would be faced with having to decipher the encryption provided by the interlinked chain of XOR logic gates and registers. Additionally, deciphering of the scan signature would require dealing with multiple logic functions of the various circuits that feed the interlinked chain of XOR logic gates and registers. <figref idref="DRAWINGS">FIGS. 3A-3B</figref> are provided to illustrate the complexity associated with deciphering the scan signature associated with even the simple example of <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3A</figref> is an illustration showing a truth table for a two-input XOR logic gate. The truth table shows that there are two possible input combinations that yield a high logic state “1” output and two possible input combinations that yield a low logic state “0” output. Thus, a particular logic state output by each XOR logic gate in the interlinked chain of XOR logic gates and registers can be generated by either of two combinations of inputs. Therefore, if one were to attempt to backtrack through the interlinked chain of XOR logic gates and registers to determine the specific combination of scan chain outputs that combine to yield a particular logic state within the scan chain signature, each two-input XOR logic gate <b>203</b><i>a</i>-<b>203</b><i>c </i>would represent a multiple of two in the number of possible scan chain output combinations.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 3B</figref> is an illustration showing the various combinations of scan chain outputs that could be produced in the exemplary embodiment of <figref idref="DRAWINGS">FIG. 2</figref> to yield a high logic state “1” for a bit in the scan signature. Column <b>217</b> shows the high logic state “1” at the output <b>217</b> of the terminating XOR logic gate <b>203</b><i>c</i>. Columns <b>113</b><i>d </i>and <b>213</b> show the possible inputs that could be present on the output connection <b>113</b><i>d </i>of scan output chain <b>103</b><i>d </i>and on the output <b>213</b> of register <b>201</b><i>b</i>, respectively, to produce the high logic state “1” output from the terminating XOR logic gate <b>203</b><i>c</i>. Columns <b>113</b><i>c </i>and <b>209</b> show the possible inputs that could be present on the output connection <b>113</b><i>c </i>of scan output chain <b>103</b><i>c </i>and on the output <b>209</b> of register <b>201</b><i>a</i>, respectively, to produce either the high logic state “1” output or the low logic state “0” output from the XOR logic gate <b>203</b><i>b</i>. Columns <b>113</b><i>b </i>and <b>113</b><i>a </i>show the possible inputs that could be present on the output connection <b>113</b><i>b </i>of scan output chain <b>103</b><i>b </i>and on the output connection <b>113</b><i>a </i>of scan output chain <b>103</b><i>a</i>, respectively, to produce either the high logic state “1” output or the low logic state “0” output from the originating XOR logic gate <b>203</b><i>a. </i></p>
<p id="p-0039" num="0038">Based on the diagram of <figref idref="DRAWINGS">FIG. 3B</figref>, there are eight possible combinations of scan chain output signals that could combine to yield a high logic state “1” within the scan signature. It should be appreciated that the circuit of <figref idref="DRAWINGS">FIG. 2</figref> is a simplified representation of the present invention in which just four scan output chains <b>103</b><i>a</i>-<b>103</b><i>d </i>are fed into the interlinked chain of XOR logic gates and registers. In an actual implementation of the present invention there would be a large number of scan output chains feeding the interlinked chain of XOR logic gates and registers. If each XOR logic gate in the interlinked chain is a two-input XOR logic gate, the number of possible combinations of scan chain output signals that could yield a particular logic state within the scan signature is equal to 2<sup>N</sup>, where N is equal to the number of scan chain outputs feeding the interlinked chain of XOR logic gates and registers. Therefore, it should be appreciated that in an actual implementation that includes many scan output chains, it would be extremely difficult to decipher the scan signature to reverse engineer the logic function of a particular portion of circuitry.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 4A</figref> is an illustration showing the circuit of <figref idref="DRAWINGS">FIG. 2</figref> with an additional feedback input to the various XOR logic gates <b>203</b><i>a</i>-<b>203</b><i>c</i>, in accordance with one embodiment of the present invention. Based on use of like reference numbers for like components, it should be appreciated that the circuit of <figref idref="DRAWINGS">FIG. 4A</figref> includes each component previously described with respect to <figref idref="DRAWINGS">FIG. 2</figref>. The circuit of <figref idref="DRAWINGS">FIG. 4A</figref>, however, also includes connection of the output of the terminating XOR logic gate <b>203</b><i>c</i>, i.e., the scan signature output to a third input of each XOR logic gate <b>203</b><i>c</i>, <b>203</b><i>b</i>, and <b>203</b><i>a</i>, as indicated by connections <b>401</b>, <b>403</b>, and <b>405</b>, respectively. For descriptive purposes, the embodiment of <figref idref="DRAWINGS">FIG. 4A</figref> shows the output of the terminating XOR logic gate <b>203</b><i>c </i>connected to the third input of each XOR logic gate <b>203</b><i>a</i>-<b>203</b><i>c</i>. However, it should be appreciated that in other embodiments, the output of the terminating XOR logic gate <b>203</b><i>c </i>can be connected to the third input of any number of XOR logic gates, so long as the output of the terminating XOR logic gate <b>203</b><i>c </i>is connected to the third input of at least one XOR logic gate in the interlinked chain of XOR logic gates and registers.</p>
<p id="p-0041" num="0040">It should be appreciated that providing the lastly generated XOR logic function output signal as a feedback signal to the third input of at least one XOR logic gate serves to further increase the data tracking complexity associated with deciphering the scan signature. <figref idref="DRAWINGS">FIG. 4B</figref> is an illustration showing a truth table for a three-input XOR logic gate. The truth table shows that there are four possible input combinations that yield a high logic state “1” output and four possible input combinations that yield a low logic state “0” output. Thus, in the embodiment of <figref idref="DRAWINGS">FIG. 4A</figref>, a particular logic state output by each XOR logic gate <b>203</b><i>a</i>-<b>203</b><i>c </i>can be generated by either of four combinations of inputs. However, because of the visibility of the lastly generated XOR logic function output signal, i.e., the feedback signal, the four possible combinations of inputs that can produce a particular logic state output from a given XOR logic gate <b>203</b><i>a</i>-<b>203</b><i>c </i>actually is reduced to two unknown possible combinations of inputs. Therefore, if one were to attempt to backtrack through the interlinked chain of XOR logic gates and registers to determine the specific combination of scan chain outputs that combined to yield a particular logic state within the scan chain signature, the number of possible combinations of signals that could yield a particular logic state within the scan signature is equal to 2<sup>N</sup>, where N is equal to the number of scan chain outputs feeding the interlinked chain of XOR logic gates and registers.</p>
<p id="p-0042" num="0041">It should be appreciated that the interlinked chain of XOR logic gates and registers as described with respect to <figref idref="DRAWINGS">FIGS. 2 and 4A</figref> provides a strong encryption of the security sensitive scan output data associated with various portions of circuitry. Additionally, it should be appreciated that provision of the destructible bypass connections enables direct access to the scan output data in the secure manufacturing environment, while also enabling permanent encryption-only access to the scan output data in non-secure environments. The circuitry of <figref idref="DRAWINGS">FIGS. 2 and 4A</figref> for encrypting the scan output data can also be used to encrypt other types of security sensitive data. For example, as discussed below, an interlinked chain of XOR logic gates and registers can be used to encrypt configuration data of a PLD.</p>
<p id="p-0043" num="0042">PLDs are integrated circuit devices where the logic elements may be customized by a user. A customized PLD may be used to perform customized logic functions when the device is operated in a system. To customize a PLD, the device is loaded with configuration information, also referred to as programming data. The programming data may be stored in a flash memory chip, disk drive, or other storage device in the system. Upon power-up, the programming data may be loaded from the flash memory chip or other storage device into configuration random-access memory (CRAM) cells on the PLD. The output of each CRAM cell is either a high logic state “1” signal or a low logic state “0” signal, depending on the value of the programming data bit stored within the CRAM cell.</p>
<p id="p-0044" num="0043">The output signal from each CRAM cell may be used to control a corresponding circuit element. The circuit element may be, for example, a pass transistor, a transistor in a logic component, such as a multiplexer or demultiplexer, a transistor in a look-up table, or a transistor or other programmable circuit element in any suitable configurable logic circuit. For example, when the gate of an n-channel metal-oxide-semiconductor (NMOS) transistor that is controlled by a CRAM cell is driven high (because the CRAM cell contains a high logic state “1” signal), the transistor is turned on so that signals can pass between its drain and source terminals. Alternatively, when the gate of the NMOS transistor is driven low (because the CRAM cell contains a low logic state “0” signal), the transistor is turned off. In this way, the transistors on the PLD and the functionality of the logic on the PLD can be configured.</p>
<p id="p-0045" num="0044">It should be appreciated that given knowledge of the unconfigured architecture of the PLD, one could use the configuration data stored in the various CRAM cells of the PLD to identify the logic function and circuit layout of the configured PLD. Therefore, direct exposure of the configuration data stored in the various CRAM cells could enable a malevolent entity to steal or exploit the logic of the configured PLD. While direct exposure of the configuration data stored in the various CRAM cells is undesirable, a capability is also needed for checking the configuration data stored in the various CRAM cells.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 5A</figref> is an illustration showing a circuit for encrypting configuration data stored in CRAM cells of a PLD, in accordance with one embodiment of the present invention. Based on use of like reference numbers for like components, it should be appreciated that the circuit of <figref idref="DRAWINGS">FIG. 5A</figref> includes each component previously described with respect to <figref idref="DRAWINGS">FIG. 2</figref>. However, the inputs of the XOR logic gates <b>203</b><i>a</i>-<b>203</b><i>c </i>in the embodiment of <figref idref="DRAWINGS">FIG. 5A</figref> are defined to receive the configuration data signals from various CRAM arrays in the configuration memory of the PLD, wherein each CRAM array includes a number of interconnected CRAM cells.</p>
<p id="p-0047" num="0046">The circuit of <figref idref="DRAWINGS">FIG. 5A</figref> includes the destructible bypass connections extending from respective CRAM array output connections <b>113</b><i>a</i>-<b>113</b><i>d </i>to respective output pins <b>237</b><i>a</i>-<b>237</b><i>d</i>. It should be appreciated that each of the destructible bypass connections enables direct access to the configuration data within the CRAM arrays. Thus, while a destructible bypass connection is intact, configuration data can be directly accessed at the output connection of the corresponding CRAM array. Once the destructible bypass connection is permanently disabled, the configuration data can no longer be directly accessed. However, it should be appreciated that following the disablement of the destructible bypass connections, the configuration data can continue to be tested in an integral manner through use of the CRAM signature generated by the interlinked chain of XOR logic gates and registers. To reverse engineer the configuration data using the CRAM signature, one would be faced with having to decipher the encryption provided by the interlinked chain of XOR logic gates and registers.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 5B</figref> is an illustration showing the circuit of <figref idref="DRAWINGS">FIG. 5A</figref> with an additional feedback input to the various XOR logic gates <b>203</b><i>a</i>-<b>203</b><i>c</i>, in accordance with one embodiment of the present invention. Based on use of like reference numbers for like components, it should be appreciated that the circuit of <figref idref="DRAWINGS">FIG. 5B</figref> includes each component previously described with respect to <figref idref="DRAWINGS">FIG. 4A</figref>. Providing the lastly generated XOR logic function output signal as a feedback signal to the third input of at least one XOR logic gate serves to further increase the data tracking complexity associated with deciphering the CRAM signature. As previously discussed with respect to <figref idref="DRAWINGS">FIG. 4A</figref>, in the embodiment where the feedback signal is connected to the third input of each XOR logic gate, the number of possible combinations of signals that could combine to yield a particular logic state within the CRAM signature is equal to 2<sup>N</sup>, where N is equal to the number of CRAM cells feeding the interlinked chain of XOR logic gates and registers.</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 6</figref> is an illustration showing a flowchart of a method for encrypting digital data to defend against reverse engineering of a circuit, in accordance with one embodiment of the present invention. The method includes a first operation <b>601</b> for performing an XOR logic function on a pair of digital data signals to generate an XOR logic function output signal. The method then proceeds with an operation <b>603</b> for performing an XOR logic function on the previously generated XOR logic function output signal and another digital data signal to generate another XOR logic function output signal. Then, in an operation <b>605</b>, a determination is made as to whether or not another digital data signal is to be encrypted. It should be appreciated that each digital data signal to be encrypted is to be processed once through the XOR logic function. If operation <b>605</b> identifies another digital data signal to be encrypted, the method proceeds with re-performing operation <b>603</b> using the identified digital data signal. Otherwise, if operation <b>605</b> does not identify another digital data signal to be encrypted, the method proceeds to an operation <b>607</b>. In operation <b>607</b>, a lastly generated XOR logic function output signal is provided as an encrypted signature. The encrypted signature corresponds to an expected digital logic state when each of the digital data signals processed through the XOR logic function is correct.</p>
<p id="p-0050" num="0049">In one embodiment, the method includes an additional operation for providing the lastly generated XOR logic function output signal as a feedback signal. More specifically, the feedback signal is provided as a third input signal to at least one XOR logic function performed in operations <b>601</b> and <b>603</b>. In a particular embodiment, the feedback signal can be provided as a third input signal to each XOR logic function performed in operations <b>601</b> and <b>603</b>.</p>
<p id="p-0051" num="0050">Additionally, in one embodiment, the method includes an operation for providing a destructible bypass connection to enable access to each digital data signal prior to processing of the digital data signal through the XOR logic function. Thus, in a secure environment, the various destructible bypass connections can be used to directly examine individual digital data signals. This embodiment also includes an operation for destroying each destructible bypass connection prior to a non-secure release of the circuit. Thus, following the non-secure release of the circuit, access to the individual digital data signals is unavailable. Therefore, a malevolent entity will be confronted with the essentially impossible challenge of deciphering the encrypted digital data in order to reverse engineer the circuit. It should be appreciated that the method of <figref idref="DRAWINGS">FIG. 6</figref> can be applied to many types of security sensitive data. In a particular embodiment, each digital data signal to be encrypted represents an output signal from a scan output chain of the circuit. In another embodiment, each digital data signal to be encrypted represents a configuration data signal for the circuit, wherein the circuit is defined within a PLD.</p>
<p id="p-0052" num="0051">The method and circuitry for encrypting security sensitive data as described herein may be incorporated into a PLD. The PLD may be part of a data processing system that includes one or more of the following components: a processor, memory, input/output (I/O) circuitry, and peripheral devices. The data processing system can be used in a wide variety of applications, such as computer networking, data networking, instrumentation, video processing, digital signal processing, or any other suitable application where the advantage of using programmable or re-programmable logic is desirable. The PLD can be used to perform a variety of different logic functions. For example, the PLD can be configured as a processor or controller that works in cooperation with a system processor. The PLD may also be used as an arbiter for arbitrating access to a shared resource in the data processing system. In yet another example, the PLD can be configured as an interface between a processor and one of the other components in the system.</p>
<p id="p-0053" num="0052">While this invention has been described in terms of several embodiments, it will be appreciated that those skilled in the art upon reading the preceding specifications and studying the drawings will realize various alterations, additions, permutations and equivalents thereof. Therefore, it is intended that the present invention includes all such alterations, additions, permutations, and equivalents as fall within the true spirit and scope of the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A circuit for encrypting scan data, comprising:
<claim-text>an interlinked chain of exclusive-or logic gates and registers, wherein a first input of each exclusive-or logic gate is connected to an output of a preceding register and an input of each register is connected to an output of a preceding exclusive-or logic gate; and</claim-text>
<claim-text>a plurality of scan output chains, each of the plurality of scan output chains having an output connected to a second input of a respective exclusive-or logic gate within the interlinked chain of exclusive-or logic gates and registers,</claim-text>
<claim-text>wherein the interlinked chain of exclusive-or logic gates and registers includes an originating exclusive-or logic gate having its first input connected to an output of an originating scan output chain rather than to a preceding register, the interlinked chain of exclusive-or logic gates and registers including a terminating exclusive-or logic gate having an output defined to provide scan signature data, the scan signature data representing an encrypted version of scan test data output by each scan output chain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A circuit for encrypting scan data as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a plurality of destructible bypass connections, each of the plurality of destructible bypass connections extending from the output of a respective one of the plurality of scan output chains to an output pin, the plurality of destructible bypass connections enabling direct access to the scan test data output by each scan output chain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A circuit for encrypting scan data as recited in <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the each of the plurality of destructible bypass connections is defined to include a fuse, wherein the fuse in an intact state enables data transmission through the destructible bypass connection and the fuse in a blown state disables data transmission through the destructible bypass connection.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A circuit for encrypting scan data as recited in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein each fuse is defined to be blown either by applying a sufficient current to the destructible bypass connection that includes the fuse or by applying a laser to the fuse.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A circuit for encrypting scan data as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each of the plurality of scan output chains is associated with a portion of circuitry in a programmable logic device (PLD), each of the plurality of scan output chains and its associated portion of circuitry having an corresponding scan input chain, the scan input and output chains enabling testing of the associated portions of circuitry within the PLD.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A circuit for encrypting scan data as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each exclusive-or logic gate and register within the interlinked chain of exclusive-or logic gates and registers is defined to transmit a single bit logic signal on each of their respective inputs and outputs in accordance with a common clock signal.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A circuit for encrypting scan data as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the output of the terminating exclusive-or logic gate is connected to a third input of at least one exclusive-or logic gate within the interlinked chain of exclusive-or logic gates and registers.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A circuit for encrypting configuration data of a programmable logic device (PLD), comprising:
<claim-text>an interlinked chain of exclusive-or logic gates and registers, wherein a first input of each exclusive-or logic gate is connected to an output of a preceding register and an input of each register is connected to an output of a preceding exclusive-or logic gate; and</claim-text>
<claim-text>a plurality of configuration memory cell arrays, each of the plurality of configuration memory cell arrays having an output connected to a second input of a respective exclusive-or logic gate within the interlinked chain of exclusive-or logic gates and registers,</claim-text>
<claim-text>wherein the interlinked chain of exclusive-or logic gates and registers includes an originating exclusive-or logic gate having its first input connected to an output of an originating configuration memory cell array rather than to a preceding register, the interlinked chain of exclusive-or logic gates and registers including a terminating exclusive-or logic gate having an output defined to provide configuration signature data, the configuration signature data representing an encrypted version of configuration data output by each configuration memory cell array.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A circuit for encrypting configuration data of a PLD as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, further comprising:
<claim-text>a plurality of destructible bypass connections, each of the plurality of destructible bypass connections extending from the output of a respective one of the plurality of configuration memory cell arrays to an output pin, the plurality of destructible bypass connections enabling direct access to the configuration data output by each configuration memory cell array.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A circuit for encrypting configuration data of a PLD as recited in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the each of the plurality of destructible bypass connections is defined to include a fuse, wherein the fuse in an intact state enables data transmission through the destructible bypass connection and the fuse in a blown state disables data transmission through the destructible bypass connection.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A circuit for encrypting configuration data of a PLD as recited in <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein each fuse is defined to be blown either by applying a sufficient current to the destructible bypass connection that includes the fuse or by applying a laser to the fuse.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A circuit for encrypting configuration data of a PLD as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein each exclusive-or logic gate and register within the interlinked chain of exclusive- or logic gates and registers is defined to transmit a single bit logic signal on each of their respective inputs and outputs in accordance with a common clock signal.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A circuit for encrypting configuration data of a PLD as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the output of the terminating exclusive-or logic gate is connected to a third input of at least one exclusive-or logic gate within the interlinked chain of exclusive-or logic gates and registers.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A circuit for encrypting configuration data of a PLD as recited in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the output of the terminating exclusive-or logic gate is connected to a third input of each exclusive-or logic gate within the interlinked chain of exclusive-or logic gates and registers.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method for encrypting digital data to defend against reverse engineering of a circuit, comprising:
<claim-text>a) performing an exclusive-or logic function on a pair of digital data signals to generate an exclusive-or logic function output signal;</claim-text>
<claim-text>b) performing an exclusive-or logic function on the previously generated exclusive-or logic function output signal and another digital data signal to generate another exclusive-or logic function output signal;</claim-text>
<claim-text>c) repeating operation b) such that each digital data signal to be encrypted has been processed once through the exclusive-or logic function; and</claim-text>
<claim-text>d) providing a lastly generated exclusive-or logic function output signal as an encrypted signature, the encrypted signature corresponding to an expected digital logic state when each of the digital data signals processed through the exclusive-or logic function is correct.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A method for encrypting digital data to defend against reverse engineering of a circuit as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein each digital data signal to be encrypted represents an output signal from a scan output chain of the circuit.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method for encrypting digital data to defend against reverse engineering of a circuit as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein each digital data signal to be encrypted represents a configuration data signal for the circuit, wherein the circuit is defined within a programmable logic device.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A method for encrypting digital data to defend against reverse engineering of a circuit as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<claim-text>providing the lastly generated exclusive-or logic function output signal as a feedback signal to be used as a third input signal to at least one exclusive-or logic function performed in operations a), b), and c).</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A method for encrypting digital data to defend against reverse engineering of a circuit as recited in <claim-ref idref="CLM-00015">claim 15</claim-ref>, further comprising:
<claim-text>providing a destructible bypass connection to enable access to each digital data signal prior to processing of the digital data signal through an exclusive-or logic function.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. A method for encrypting digital data to defend against reverse engineering of a circuit as recited in <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising:
<claim-text>destroying each destructible bypass connection prior to a non-secure release of the circuit.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
