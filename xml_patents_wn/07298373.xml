<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298373-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298373</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10863092</doc-number>
<date>20040608</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>03101692</doc-number>
<date>20030611</date>
</priority-claim>
</priority-claims>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>T</subclass>
<main-group>17</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>345428</main-classification>
<further-classification>345  33</further-classification>
<further-classification>345581</further-classification>
<further-classification>345594</further-classification>
<further-classification>345617</further-classification>
<further-classification>345619</further-classification>
<further-classification>345661</further-classification>
<further-classification>382274</further-classification>
<further-classification>382299</further-classification>
<further-classification>715833</further-classification>
<further-classification>715834</further-classification>
</classification-national>
<invention-title id="d0e61">Method and user interface for modifying at least one of contrast and density of pixels of a processed image</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5270806</doc-number>
<kind>A</kind>
<name>Venable et al.</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>358500</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5739809</doc-number>
<kind>A</kind>
<name>McLaughlin et al.</name>
<date>19980400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345594</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6940526</doc-number>
<kind>B2</kind>
<name>Noda et al.</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345629</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>EP</country>
<doc-number>0 527 525</doc-number>
<kind>A2</kind>
<date>19930200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>345  33</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345594</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345617</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345661</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715813</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715833</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715834</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60484195</doc-number>
<kind>00</kind>
<date>20030701</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040252133</doc-number>
<kind>A1</kind>
<date>20041216</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Vuylsteke</last-name>
<first-name>Pieter</first-name>
<address>
<city>Mortsel</city>
<country>BE</country>
</address>
</addressbook>
<nationality>
<country>BE</country>
</nationality>
<residence>
<country>BE</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Leydig, Voit &amp; Mayer, Ltd</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>AGFA Healthcare</orgname>
<role>03</role>
<address>
<city>Mortsel</city>
<country>BE</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Tung</last-name>
<first-name>Kee M.</first-name>
<department>2628</department>
</primary-examiner>
<assistant-examiner>
<last-name>Caschera</last-name>
<first-name>Antonio A</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An image which has been subjected to image processing wherein contrast amplification and density can be specified independently is displayed on a display screen. An initial density level is specified. The contrast of pixels in the displayed image having a density substantially equal to the specified initial density is changed upon movement of an indicium in a first direction and the density of pixels in the displayed image having a density substantially equal to the specified initial density is changed upon movement of the indicium in a second direction.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="201.59mm" wi="136.65mm" file="US07298373-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="152.15mm" wi="145.54mm" file="US07298373-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="220.13mm" wi="142.75mm" file="US07298373-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="210.82mm" wi="161.88mm" file="US07298373-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="199.90mm" wi="86.36mm" file="US07298373-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="201.08mm" wi="77.13mm" file="US07298373-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="207.01mm" wi="82.30mm" file="US07298373-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="191.35mm" wi="122.51mm" orientation="landscape" file="US07298373-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="185.93mm" wi="117.86mm" orientation="landscape" file="US07298373-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="191.77mm" wi="136.14mm" orientation="landscape" file="US07298373-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="167.72mm" wi="133.18mm" file="US07298373-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<p id="p-0002" num="0001">This application claims the benefit of U.S. Provisional Patent Application No. 60/484,195, filed Jul. 1, 2003, hereby incorporated by reference. This application also claims the benefit of European Patent Application No. 03101692.6, filed Jun. 11, 2003, which is incorporated by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a method of independently modifying at least one of contrast and density of pixels of an image subjected to processing whereby contrast amplification and density can be specified independently.</p>
<p id="p-0004" num="0003">The invention further relates to a user interface for application of such a method.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0005" num="0004">Nowadays several medical image acquisition techniques and systems exist that render a digital image representation of a medical image, e.g. a radiographic image.</p>
<p id="p-0006" num="0005">One example of such a system is a computed radiography system wherein a radiation image is recorded on a temporary storage medium, more particularly a photostimulable phosphor screen. In such a system a digital image representation is obtained by scanning the screen with radiation of (a) wavelength(s) within the stimulating wavelength range of the phosphor and by detecting the light emitted by the phosphor upon stimulation.</p>
<p id="p-0007" num="0006">Other examples of computed radiography systems are direct radiography systems, for example systems wherein a radiographic image is recorded in a solid-state sensor comprising a radiation sensitive layer and a layer of electronic read out circuitry.</p>
<p id="p-0008" num="0007">Still another example of a computed radiography system is a system wherein a radiographic image is recorded on a conventional X-ray film and wherein that film is developed and subsequently subjected to image scanning.</p>
<p id="p-0009" num="0008">Still other systems such as a tomography system may be envisaged.</p>
<p id="p-0010" num="0009">The digital image representation of the medical image acquired by one of the above systems can then be used for generating a visible image on which the diagnosis can be performed. For this purpose the digital image representation is applied to a hard copy recorder or to a display device.</p>
<p id="p-0011" num="0010">Commonly the digital image representation is subjected to image processing prior to hard copy recording or display.</p>
<p id="p-0012" num="0011">In order to convert the digital image information optimally into a visible image on a medium on which the diagnosis is performed, a multiscale image processing method (also called multiresolution image processing method) has been developed by means of which the contrast of an image is enhanced.</p>
<p id="p-0013" num="0012">According to this multiscale image processing method an image represented by an array of pixel values is processed by applying the following steps. First the original image is decomposed into a sequence of detail images at multiple scales and occasionally a residual image. Next, the pixel values of the detail images are modified by applying to these pixel values at least one nonlinear monotonically increasing odd conversion function with a gradient that gradually decreases with increasing argument values. Finally, a processed image is computed by applying a reconstruction algorithm to the residual image and the modified detail images, the reconstruction algorithm being the inverse of the above decomposition process.</p>
<p id="p-0014" num="0013">The above image processing technique has been described extensively in European patent EP 527 525, the processing being referred to as MUSICA image processing (MUSICA is a registered trade name of Agfa-Gevaert N.V.).</p>
<p id="p-0015" num="0014">The described method is advantageous over conventional image processing techniques such as unsharp masking etc. because it increases the visibility of subtle details in the image and because it increases the faithfulness of the image reproduction without introducing artefacts.</p>
<p id="p-0016" num="0015">Prior to being applied to a hard copy recorder or to a display device the grey value image is pixelwise converted into a digital image representing density of the visible image.</p>
<p id="p-0017" num="0016">The conversion of grey value pixels into density values suitable for reproduction or display comprises the selection of a relevant subrange of the grey value pixel data and the conversion of the data in this subrange according to a specific gradation function. Commonly, the gradation function is defined by means of a lookup table, which, for each grey value, stores the corresponding density value.</p>
<p id="p-0018" num="0017">Preferably the relevant subrange and the gradation function to be applied are adapted to the object and to the examination type so that optimal and constant image quality can be guaranteed.</p>
<p id="p-0019" num="0018">The shape of the gradation function is critical. It determines how the subintervals of the density range of the visible image are associated with subranges of grey values, in a monotonic but mostly nonlinear way.</p>
<p id="p-0020" num="0019">In those intervals where the function is steep, a narrow subrange of grey values is mapped onto the available output density interval. On the other hand, in those intervals where the function has a gentle gradient, the available output density interval is shared by a wide subrange of grey values. If the gradation function has a gentle gradient in the low density half and evolves to steeper behaviour in the high density portion, then most of the grey values are mapped to low density, and the overall appearance of the result image will be bright. Reversely, if the gradation function takes off steeply, and evolves to the high density with decreasing gradient, then most of the grey values are mapped to high density, yielding a dark, greyish look.</p>
<p id="p-0021" num="0020">This way, it is possible to determine how the density intervals are distributed across the range of grey values, by manipulating the shape of the gradation function. As a general rule, grey value subranges that are densely populated (i.e. peaks in the grey value histogram) should be mapped onto a wide output density interval. Reversely, intervals of grey values that occur infrequently in the image should be concentrated on narrow density intervals. This paradigm known as histogram equalization leads to enhanced differentiation of grey value regions in an image.</p>
<p id="p-0022" num="0021">The density of pixels and image regions is determined by the corresponding ordinate value of the gradation function. The contrast amplification of pixels and image regions on the other hand, is determined by the corresponding derivative value (i.e. the gradient) of the gradation function. As a consequence, if the shape of the gradation function is adjusted to accommodate a large subrange of grey values within a specified density interval, i.e. if the interval has to cope with wide latitude, then at the same time the contrast in that density interval will drop. On the other hand, if a density interval is assigned to only a narrow grey value subrange, then that interval will provide enhanced contrast. If requirements with respect to density and contrast amplification are conflicting, which is often the case, then a compromise is unavoidable.</p>
<p id="p-0023" num="0022">In one embodiment of the multiscale image processing method as described in the above-mentioned European patent EP 527 525, the gradation function is applied after the reconstruction process, which is the inverse of the multiscale decomposition. The gradation function is applied to the final scale of reconstruction. As a consequence, the contrast-to-grey value relationship, which is specified by the derivative of the gradation function, is identical at all scales.</p>
<p id="p-0024" num="0023">In some cases however, it is favourable to differentiate contrast adjustment depending on grey value and scale simultaneously. E.g. in chest images it is important to have high contrast in the smaller scales (i.e. small scale contrast) at high grey values to enhance conspicuity of pneumothorax, but only moderate small scale contrast in the low grey value areas like the mediastum. At the same time, large-scale contrast in the lower and mid grey values must be appropriate to visualise e.g. pleural masses.</p>
<p id="p-0025" num="0024">In some embodiments disclosed in the above-mentioned European patent application EP 527 525 scale-dependent boosting or suppression of the contribution of detail information is applied.</p>
<p id="p-0026" num="0025">Two different implementations have been described.</p>
<p id="p-0027" num="0026">In a first implementation the modified detail images are pixelwise multiplied by a coefficient in the last stages of the reconstruction process. The value of such a coefficient depends on the brightness of the pixels of the partially reconstructed image.</p>
<p id="p-0028" num="0027">In a second implementation a partially reconstructed image is converted according to a monotonically increasing conversion function with gradually decreasing slope, for example a power function. Then the reconstruction process is continued until a full size reconstructed image is obtained. Finally the resulting image is converted according to a curve that is the inverse of the afore-mentioned conversion curve.</p>
<p id="p-0029" num="0028">Although this disclosure describes scale-dependent suppression or boosting of the contribution of detail information, it does not describe the way in which an envisaged density nor contrast amplification as a function of grey value can be obtained.</p>
<p id="p-0030" num="0029">It is an aspect of the present invention to provide a method of modifying at least one of contrast and density of pixels of a processed image.</p>
<p id="p-0031" num="0030">It is another aspect of the present invention to provide a user interface for such methods.</p>
<p id="p-0032" num="0031">Further aspects will become apparent from the description given below.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0033" num="0032">The above mentioned aspects are realised by a method of modifying at least one of contrast and density of pixels of a processed image as set out in claim <b>1</b>.</p>
<p id="p-0034" num="0033">In accordance with the present invention density and contrast in an image are modified independently. In the context of this invention the term ‘independently’ relates to processing methods in which modification of contrast does not have substantial influence on the density levels in the image and wherein modification of the density does not substantially influence the contrast in the image. Examples of such processing will be elaborated further on.</p>
<p id="p-0035" num="0034">In the context of the present invention the term indicium refers to a marker, cursor, arrow or the like by means of which a movement with two degrees of freedom can be executed. This movement will be used to control the change of density or contrast of selected pixels in the displayed image without these changes having a mutual influence.</p>
<p id="p-0036" num="0035">In one embodiment of the present invention an initial density level is specified by selecting a pixel or pixel region in the displayed image that has the envisaged initial density. According to the invention pixels in the image are modified that have a density value that is equal to or close to that initial density. This embodiment is advantageous in that the user can easily identify the density which is to be modified or of which the corresponding contrast is to be modified.</p>
<p id="p-0037" num="0036">Preferably the amount by which contrast or density is changed is largest for pixels that have a density equal to the specified initial density. The amount by which contrast or density is changed preferably gradually decreases for selected pixels that have a density which is lower or higher than the initial density.</p>
<p id="p-0038" num="0037">Another embodiment of this invention relates to a method of modifying at least one of contrast and density of the pixels of a processed image wherein the processed image and at least one of a density axis and contrast amplification axis of a coordinate system, a density histogram of said processed image, a contrast amplification curve that represents contrast amplification as a function of density applied to obtain said processed image and a movable indicium on said contrast amplification curve in a position corresponding with an initial density and contrast, are displayed on a screen.</p>
<p id="p-0039" num="0038">The indicium is moved in at least one of the directions of said axes. Upon movement of the indicium in the direction of the contrast amplification axis contrast of selected pixels that have a density value that is substantially equal to said initial density in the displayed image is changed. Upon movement of the indicium in the direction of the density axis, density of selected pixels that have a density value that is substantially equal to said initial density in the image is changed. This way, contrast and density are changed independently. Movement of the indicium is not restricted to a direction along one of the axes. Any arbitrary two-dimensional movement in the plane causes a simultaneous change of contrast and density, in accordance with the magnitudes of movement components along both axes.</p>
<p id="p-0040" num="0039">This embodiment can also be combined with the embodiment of claim <b>1</b>.</p>
<p id="p-0041" num="0040">In this embodiment an initial density level can likewise be specified by selecting a pixel or pixel region in the displayed image that has the envisaged initial density. Pixels are modified that have a density value that is equal to or close to that initial density. This embodiment is advantageous in that the user can easily identify the density which is to be modified or of which the corresponding contrast is to be modified.</p>
<p id="p-0042" num="0041">In still another embodiment an initial density can be chosen by selecting a working point in the displayed coordinate system. Modifications can be controlled by moving the working point in the direction of either density or contrast amplification axis, or in a direction that involves simultaneous adjustment of contrast and density</p>
<p id="p-0043" num="0042">Preferably the amount by which contrast or density is changed is largest for pixels that have a density equal to the initial density. The amount by which contrast or density is changed preferably gradually decreases for selected pixels that have a density which is lower or higher than the initial density.</p>
<p id="p-0044" num="0043">In each embodiment the width of the range of density values that are regarded as substantially equal to the initial density may be set by the operator and is dependent on the application.</p>
<p id="p-0045" num="0044">It is furthermore advantageous that the density histogram and/or contrast amplification curve pertaining to the image obtained as result of the movement of the indicium is displayed. To this end the original histogram and contrast amplification curve may be adapted during the modification process.</p>
<p id="p-0046" num="0045">The above methods are applicable to images that have been subjected to multiscale gradation processing as is described further on in this text. However, the method is also applicable to other implementations of contrast rendition whereby contrast amplification and density can be specified independently.</p>
<p id="p-0047" num="0046">Another aspect of the present invention relates to a user interface for an image processing and display unit.</p>
<p id="p-0048" num="0047">The user interface comprises
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0048">a window wherein a processed image is displayed,</li>
        <li id="ul0002-0002" num="0049">means such as a pointer or cursor operated by an interactive control device such as a mouse, for specifying an initial density level,</li>
        <li id="ul0002-0003" num="0050">a first indicium movable in at least one of two directions, whereby movement of said first indicium in a first direction causes a change of density of pixels that have a density value that is substantially equal to said initial density and whereby movement of said first indicium in a second direction causes a change of contrast of pixels that have a density value that is substantially equal to said initial density,
<br/>
whereby contrast and density are changed independently.
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0049" num="0051">In one embodiment the means for specifying an initial density is a second indicium which is displayed on the screen and which is movable across the displayed image. The initial density can be specified by moving this indicium past the image to a pixel or a pixel region having that specific density and by selecting the density value of a pixel covered by the indicium.</p>
<p id="p-0050" num="0052">In another embodiment the means for specifying an initial density is the same as the first indicium. In this implementation an initial density can for example be selected by indicating with a pointer a pixel having that initial density followed by entering this value. Next the same pointer can be moved in a first and a second direction thereby independently changing the density or contrast of pixels having a density substantially equal to that initial density.</p>
<p id="p-0051" num="0053">The width of the range of density values that are regarded as substantially equal to the initial density may be set by the operator and is dependent on the application.</p>
<p id="p-0052" num="0054">In still another embodiment additional items are displayed, e.g. in an additional window. In this additional window at least one of the following is displayed: a density axis and a contrast amplification axis of a coordinate system, a density histogram of a processed image, a contrast amplification curve that represents contrast amplification as a function of density applied to obtain said processed image and a third indicium on said contrast amplification curve in a position corresponding with the initial density and contrast of said processed image, a density wedge along the density axis.</p>
<p id="p-0053" num="0055">In this embodiment preferably at least one of the histogram, the contrast amplification curve and the position of the third indicium is adapted in correspondence with the movement of said second indicium.</p>
<p id="p-0054" num="0056">Alternatively, the position of said third indicium may be changed and at least one of the histogram, the contrast amplification curve and the processed image is changed upon movement of the third indicium.</p>
<p id="p-0055" num="0057">The embodiments of the methods of the present invention are generally implemented in the form of a computer program product adapted to carry out the method steps of the present invention when run on a computer. The computer program product is commonly stored in a computer readable carrier medium such as a CD-ROM. Alternatively the computer program product takes the form of an electric signal and can be communicated to a user through electronic communication.</p>
<p id="p-0056" num="0058">The methods in accordance with the present invention are applicable to any kind of monochrome digital images. They are also suited for independently adjusting the density and contrast of colour images. To this end, the colour images comprising three components for each pixel, commonly representing the red, green and blue channel inputs of video equipment (RGB), are preferably converted into a standard colour space that represents hue, saturation and luminance (HSL). If an image is represented in this colour space, then the methods in accordance with the present invention are preferably applied to the luminance component only, as if it were a monochrome image. If only this channel is affected, then the contrast and density can be adjusted without introducing colour distortions.</p>
<p id="p-0057" num="0059">The method and user interface of the present invention is suited for displaying any kind of monochrome and color images obtained from a wide variety of acquisition devices in a wide variety of fields of applications wherein interactive modifications of density and/or contrast can be performed.</p>
<p id="p-0058" num="0060">Examples of other applications than medical imaging in which the method and user interface can be applied are the following: modification of images obtained by scanning systems and digital cameras in the field of photofinishing, in aerial photography, prepress, application to video images e.g. for image restoration, digital film paste up on computer etc. The invention is not limited to the enumerated acquisition methods and enumerated fields of application.</p>
<p id="p-0059" num="0061">In the method and user interface of the present invention contrast and density are changed independently. This can be obtained with processing methods wherein contrast and density are specified independently. Examples of multiscale gradation processing methods wherein contrast and density are specified independently are described below with reference to the following drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0060" num="0062"><figref idref="DRAWINGS">FIG. 1</figref> shows an apparatus for acquisition of a digital image representation of a medical image, for processing the digital image and for generating an enhanced visible image,</p>
<p id="p-0061" num="0063"><figref idref="DRAWINGS">FIG. 2</figref> is a block scheme illustrating the image chain,</p>
<p id="p-0062" num="0064"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a first embodiment of performing the multiscale decomposition step, according to the Burt pyramid transform,</p>
<p id="p-0063" num="0065"><figref idref="DRAWINGS">FIG. 4</figref> illustrates the corresponding reconstruction step,</p>
<p id="p-0064" num="0066"><figref idref="DRAWINGS">FIG. 5</figref> shows an embodiment of multiscale gradation according to a first multiscale transform embodiment,</p>
<p id="p-0065" num="0067"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a second embodiment of performing the multiscale decomposition step, according to a dyadic wavelet transform,</p>
<p id="p-0066" num="0068"><figref idref="DRAWINGS">FIG. 7</figref> illustrates the corresponding reconstruction step,</p>
<p id="p-0067" num="0069"><figref idref="DRAWINGS">FIG. 8</figref> shows an embodiment of multiscale gradation according to the second multiscale transform embodiment</p>
<p id="p-0068" num="0070"><figref idref="DRAWINGS">FIG. 9</figref> shows the initial scale-specific gradients at large, intermediate and small scales, as a function of grey value.</p>
<p id="p-0069" num="0071"><figref idref="DRAWINGS">FIG. 10</figref> illustrates the interactive adjustment of contrast of pixels in a specified density band,</p>
<p id="p-0070" num="0072"><figref idref="DRAWINGS">FIG. 11</figref> illustrates the interactive adjustment of density of pixels in a specified density band,</p>
<p id="p-0071" num="0073"><figref idref="DRAWINGS">FIG. 12</figref> illustrates a display window and interactive controls for the adjustment of density and contrast of pixels in a specified density band, according to a second and third embodiment.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0072" num="0074">Description of an Image Acquisition System</p>
<p id="p-0073" num="0075">X-rays emitted by a source of radiation (<b>2</b>) are transmitted by a patient (not shown) and recorded on a temporary storage medium, more particularly a photostimulable phosphor screen (<b>3</b>). In an identification station (<b>4</b>) patient identification data are written into a memory device, e.g. an EEPROM provided on a cassette carrying the photostimulable phosphor screen.</p>
<p id="p-0074" num="0076">The exposed photostimulable phosphor screen is then fed into a read out apparatus (<b>1</b>) where a digital image representation of the stored radiation image is generated.</p>
<p id="p-0075" num="0077">For this purpose the exposed screen is scanned by means of radiation having (a) wavelength(s) within the stimulation wavelength range of the photostimulable phosphor.</p>
<p id="h-0006" num="0000">Image-wise modulated light is emitted by the phosphor upon stimulation. This light is detected and converted by an opto-electronic converter and subsequent A-to-D converter into a digital image representation of the radiation image.</p>
<p id="p-0076" num="0078">The digital image representation is applied to an image-processing station (<b>5</b>) to which is connected an interactive control device such as a mouse (<b>7</b>) and which can be incorporated in the read out device or provided as a separate workstation. In the image-processing station the digital image representation is subjected to different kinds of processing, among which are multiscale contrast enhancement, noise reduction and gradation processing. The modification method of the present invention is also performed on this processing station.</p>
<p id="p-0077" num="0079">The processed digital image can also be applied to an output apparatus such as a hard copy recording device (<b>6</b>) where a visible image is generated. The visible image can be used by the radiologist for making a diagnosis.</p>
<p id="h-0007" num="0000">Image Chain</p>
<p id="p-0078" num="0080">By means of the terms ‘image chain’ is meant the sequence of image operations and image processing control mechanisms that are applied either separately or in combination to the digital image representation for transforming the signal generated by the read out device into a processed digital image representation that can be applied to the output device.</p>
<p id="p-0079" num="0081">A block diagram illustrating the entire image chain is illustrated in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0080" num="0082">The image chain comprises the steps enumerated below.</p>
<p id="p-0081" num="0083">In a preliminary step the digital signal representation of an image is subjected to a conversion according to a square root function, in order to make the pixel values proportional to the square root of the radiation dose recorded on the photostimulable phosphor screen. The resulting image is called a raw digital image.</p>
<p id="p-0082" num="0084">One of the main sources of noise in the image is quantum mottle, which has a Poisson distribution. The square root conversion ensures that the noise statistics is transformed into a Gaussian distribution, with a standard deviation that is independent of dose. The latter preprocessing of the digital image is not essential, but it greatly simplifies the mathematics of the subsequent processing stages, because the noise can then be assumed roughly uniform across the raw image.</p>
<p id="p-0083" num="0085">In an alternative embodiment, the square root conversion is carried out in the read out apparatus by means of an amplifier with square root characteristic. A raw digital image is generated by applying A-to-D conversion to the resulting signal.</p>
<p id="p-0084" num="0086">In still other embodiments, the digital signal representation of an image is converted according to a logarithmic function, or according to a linear function.</p>
<p id="p-0085" num="0087">With all embodiments, the raw digital image is used for further processing.</p>
<p id="p-0086" num="0088">In a first processing step the raw digital image is decomposed into at least two detail images at successive scales and occasionally a residual image (further referred to as multiscale representation), according to a multiscale transform. The components of the multiscale representation are referred to as detail images. The pixel values of the multiscale representation correspond with the contrast of elementary image components, relative to their close neighbourhood.</p>
<p id="p-0087" num="0089">In the next step the multiscale representation may be subjected to an automatic gain adjustment procedure to cancel out disturbing fluctuations that are due to dose variations, different exposure parameters, different patient latitude etc, optionally followed by one or more of steps of reducing excess contrast and enhancing subtle contrast or edge contrast, as set forth in EP 02102368 filed Sep. 18, 2002</p>
<p id="p-0088" num="0090">Next the processed multiscale representation is subjected to a reconstruction step by applying the inverse of the decomposition transform to the modified detail images.</p>
<p id="p-0089" num="0091">In the course of reconstruction, a series of scale-specific conversion functions are consecutively applied to the partially reconstructed image, in order to adjust contrast amplification as a function of both grey value and scale. The latter process will be referred to as multiscale gradation. The thus obtained pixel values are the driving values for the hard- or softcopy reproducing device, further on referred to as density values.</p>
<p id="h-0008" num="0000">1. Multiscale Transform</p>
<p id="p-0090" num="0092">The raw digital image is subjected to a multiscale decomposition. The image is decomposed into at least two detail images representing detail at several successive scales.</p>
<p id="p-0091" num="0093">This technique has been described extensively in EP 527 525.</p>
<p id="p-0092" num="0094">The pixels of the detail images represent the amount of variation of pixel values of the original image at the scale of the detail image, whereby scale refers to spatial extent of these variations.</p>
<p id="h-0009" num="0000">A residual image can also be generated which is an approximation of the original image with omission of all variations comprised in the detail images.</p>
<p id="h-0010" num="0000">The detail images at subsequent scales (or resolution levels) are called multiscale layers, or simply layers.</p>
<p id="p-0093" num="0095">In a first embodiment of computing a multiscale transform the detail images at successively larger scales are obtained as the result of each of R iterations of the following steps, as depicted in <figref idref="DRAWINGS">FIG. 3</figref>:</p>
<p id="p-0094" num="0096">a) computing an approximation image g<sub>k+1 </sub>at a next larger scale k+1 by applying a low pass filter LP to the approximation image g<sub>k </sub>corresponding to the current iteration k, and subsampling the result in proportion to the reduction in spatial frequency bandwidth, using however the original image u<sub>0 </sub>as input to said low pass filter in the course of the first iteration;</p>
<p id="p-0095" num="0097">b) computing a detail image b<sub>k </sub>as the pixelwise difference between the approximation image u<sub>k </sub>corresponding to the current iteration and the approximation image u<sub>k+1 </sub>at a next larger scale computed according the method sub (a), both images being brought into register by proper interpolation (represented by [↑ LP] in the flow chart) of the latter image; wherein the residual image u<sub>R </sub>is equal to the approximation image produced by the last iteration.</p>
<p id="p-0096" num="0098">The corresponding reconstruction (which we will refer to as ordinary reconstruction, i.e. reconstruction without multiscale gradation) is done by applying the inverse transform, as depicted in <figref idref="DRAWINGS">FIG. 4</figref>. In the described embodiment ordinary reconstruction is implemented by iterating R times the following procedure starting from the largest scale detail image b<sub>R−1 </sub>and the residual image v<sub>R</sub>=u<sub>R</sub>: computing the approximation image v<sub>k </sub>at the current scale k by pixelwise adding the detail image b<sub>k </sub>at the same scale to the approximation image v<sub>k+1 </sub>at the larger scale corresponding to the previous iteration, both images being brought into register by proper interpolation of the latter image, using however the residual image v<sub>R </sub>instead of said larger scale approximation image in the course of the first iteration.</p>
<p id="p-0097" num="0099">The residual image will be a low-resolution image or in the extreme case, an image comprising only one single pixel, depending on the number of iterations in the decomposition.</p>
<p id="p-0098" num="0100">The latter combination of forward and inverse multiscale transform is commonly known as the Burt pyramid transform.</p>
<p id="p-0099" num="0101">In an alternative embodiment the image is decomposed into a weighted sum of predetermined basic detail images at multiple scales and occasionally a residual basic image by applying a transform to the image, the transform yielding a set of detail coefficients each expressing the relative contribution to the original image of one of a set of basis functions representing these basic detail images and occasionally a residual coefficient representing the relative contribution to the original image of a basis function representing the basic residual image.</p>
<p id="p-0100" num="0102">The basis functions are continuous and non-periodic and have zero mean value except for the basis function that represents the basic residual image. An example of such basis functions are wavelets.</p>
<p id="p-0101" num="0103">The transform is such that there exists an inverse transform which returns the original image or a close approximation thereof when being applied to the transform coefficients.</p>
<p id="p-0102" num="0104">The image can be reconstructed by applying the inverse transform to the detail coefficients and the residual coefficient if generated.</p>
<p id="p-0103" num="0105">An example of the alternative embodiment is depicted in <figref idref="DRAWINGS">FIGS. 6 and 7</figref>, where <figref idref="DRAWINGS">FIG. 6</figref> shows a forward dyadic wavelet transform and <figref idref="DRAWINGS">FIG. 7</figref> the corresponding inverse transform.</p>
<p id="p-0104" num="0106">In the forward transform, shown in <figref idref="DRAWINGS">FIG. 6</figref>, the original image u<sub>0 </sub>is split into a larger-scale approximation image u<sub>1 </sub>and a detail coefficient image b<sub>1 </sub>by applying a low-pass analysis filter LP<sub>a </sub>and high-pass analysis filter HP<sub>a</sub>, respectively, followed by subsampling of both images. This splitting process is repeated R times based on the current approximation image, each time yielding an additional detail coefficient image and an approximation image at the next larger scale.</p>
<p id="p-0105" num="0107">The flow chart of the corresponding inverse transform is shown in <figref idref="DRAWINGS">FIG. 7</figref>. Starting from the residual image v<sub>R</sub>=u<sub>R</sub>, which is an approximation image at the largest scale, an approximation image v<sub>R−1 </sub>at the next smaller scale is computed by upsampling and low-pass filtering the current approximation image v<sub>R</sub>, up-sampling and high-pass filtering the detail coefficient image b<sub>R</sub>, and pixelwise summing the latter results. Subsequent smaller scale approximation images are obtained by iterating this process R times based on the current approximation image v<sub>k </sub>and the corresponding detail coefficient image b<sub>k</sub>.</p>
<p id="p-0106" num="0108">In a preferred embodiment the high pass filters are directional, e.g. representing grey value transitions in a specific direction. In that case, the detail coefficients b<sub>k </sub>at each scale are partitioned into coefficients bh<sub>k</sub>, bv<sub>k</sub>, bd<sub>k</sub>, representing either horizontal, vertical and diagonal detail at that scale. Each of the blocks HP<sub>a </sub>then represents a bank of 3 filters, one for each direction.</p>
<p id="h-0011" num="0000">2. Reconstruction and Multiscale Gradation</p>
<p id="p-0107" num="0109">When the (optional) procedures for contrast enhancement shown s in <figref idref="DRAWINGS">FIG. 2</figref> have been performed as described in EP 02102368 filed Sep. 18, 2002, the image is reconstructed by applying to the modified detail images the image transform that is the inverse of the multiscale decomposition.</p>
<p id="p-0108" num="0110">Details on the ordinary reconstruction procedure are described higher in the paragraph relating to image decomposition.</p>
<p id="p-0109" num="0111">In a first embodiment in accordance with this invention, multiscale gradation is implemented by inserting a series of scale-specific conversion functions in the reconstruction process. At each stage in the reconstruction process where a conversion function is inserted, the latter is applied to the approximation image at a scale corresponding to the current iteration, and the result of conversion is used as the input image of the next iteration, as described below.</p>
<p id="p-0110" num="0112">Referring to <figref idref="DRAWINGS">FIG. 5</figref> which shows a multiscale gradation embodiment according to the Burt pyramid transform, the normal inverse transform is modified as follows.</p>
<p id="p-0111" num="0113">From the iteration that corresponds with the scale k=L until the smallest scale k=0, the computed approximation image v<sub>k </sub>is pixelwise converted by a scale-specific conversion function f<sub>k</sub>( ) before it is passed to the next iteration.</p>
<p id="p-0112" num="0114">As to the second multiscale transform embodiment described sub <b>1</b>, i.e. dyadic wavelet transform, the modification for implementing multiscale gradation is very similar. Referring to <figref idref="DRAWINGS">FIG. 8</figref>, from the iteration that corresponds with the scale k=L until the smallest scale k=0, the computed approximation image v<sub>k </sub>is pixelwise converted by a scale-specific conversion function f<sub>k</sub>( ) before it is passed to the next iteration.</p>
<p id="p-0113" num="0115">By an appropriate choice of the series of conversion functions f<sub>k</sub>( ) it is possible to specify the contrast amplification as a function of grey value and scale, and to specify grey value-to-density mapping independently from contrast amplification.</p>
<p id="p-0114" num="0116">To this end, the scale-specific conversion functions f<sub>k</sub>( ) are determined as will be described below, starting from a series of functions gm<sub>k</sub>( ), referred to as scale-specific gradient functions. For a specific scale k, the corresponding scale-specific gradient function gm<sub>k</sub>( ) specifies the amount of contrast amplification at that scale. Equivalently, the scale-specific gradient function at scale k specifies how much a small pixel value difference (i.e. scale-specific contrast) at that scale is amplified by the combined effect of all concatenated conversion functions f<sub>k</sub>( ) up to the smallest scale k=0.</p>
<p id="p-0115" num="0117">Also, the scale-specific gradient function gm<sub>k</sub>( ) specifies to which extent the finally reconstructed image z<sub>0 </sub>is sensitive to a unit detail arising from a pixel with unit value in the corresponding detail image, i.e. b<sub>k </sub>in case of the Burt pyramid transform, or b<sub>k+1 </sub>in case of the dyadic wavelet transform.</p>
<p id="p-0116" num="0118">The scale-specific gradient functions are equivalent to the partial derivative functions:</p>
<p id="p-0117" num="0119">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>gm</mi>
        <mi>k</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mo>∂</mo>
        <msub>
          <mi>z</mi>
          <mn>0</mn>
        </msub>
      </mrow>
      <mrow>
        <mo>∂</mo>
        <msub>
          <mi>z</mi>
          <mrow>
            <mi>k</mi>
            <mo>+</mo>
            <mn>1</mn>
          </mrow>
        </msub>
      </mrow>
    </mfrac>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>k</mi>
    <mo>=</mo>
    <mn>0</mn>
  </mrow>
  <mo>,</mo>
  <mn>1</mn>
  <mo>,</mo>
  <mi>…</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.6em" height="0.6ex"/>
  </mstyle>
  <mo>,</mo>
  <mi>L</mi>
</mrow>
</math>
</maths>
<br/>
in which z<sub>k </sub>represents the image that results from pixelwise applying the conversion function f<sub>k</sub>( ) to the approximation image v<sub>k</sub>, and t=v<sub>L</sub>, i.e. the pixel value of the partially reconstructed image at scale L, which is the largest scale involved in multiscale gradation. In the present context, the pixel values t are referred to as the large-scale average grey values.
</p>
<p id="p-0118" num="0120">Relying on the concatenation rule for derivation, the scale-specific gradient functions can be written as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>gm</i><sub>k</sub>(<i>t</i>)=<i>f</i><sub>0</sub>′(<i>F</i><sub>1</sub>(<i>t</i>))·<i>f</i><sub>1</sub>′(<i>F</i><sub>2</sub>(<i>t</i>))· . . . ·<i>f</i><sub>k</sub>′(<i>t</i>),<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
in which f<sub>k</sub>′(t) represent the derivative functions of the scale-specific conversion functions.
</p>
<p id="p-0119" num="0121">The cumulative conversion functions at subsequent scales are the concatenation of scale-specific conversion functions f<sub>k</sub>( ) from the largest scale L involved in multiscale gradation, up to the scale considered:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>k</sub>(<i>t</i>)=<i>f</i><sub>k</sub><i>∘f</i><sub>k+1</sub><i>∘ . . . ∘f</i><sub>L</sub>(<i>t</i>),<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
in which the operator ∘ stands for function concatenation.
</p>
<p id="p-0120" num="0122">The derivative of a cumulative conversion function with respect to t is equal to:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>k</sub>′(<i>t</i>)=<i>f</i><sub>k</sub>′(<i>F</i><sub>k+1</sub>(<i>t</i>))·<i>f</i><sub>k+1</sub>′(<i>F</i><sub>k+2</sub>(<i>t</i>))· . . . ·<i>f</i><sub>L</sub>′(<i>t</i>),<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
or equivalently, the derivatives of cumulative conversion functions can be expressed in terms of scale-specific gradient functions:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>0</sub>′(<i>t</i>)=<i>gm</i><sub>L</sub>(<i>t</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0121" num="0123">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msubsup>
        <mi>F</mi>
        <mi>k</mi>
        <mi>′</mi>
      </msubsup>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mfrac>
          <mrow>
            <msub>
              <mi>gm</mi>
              <mi>L</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <msub>
              <mi>gm</mi>
              <mrow>
                <mi>k</mi>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>k</mi>
      </mrow>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mn>2</mn>
  <mo>,</mo>
  <mi>…</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.6em" height="0.6ex"/>
  </mstyle>
  <mo>,</mo>
  <mi>L</mi>
</mrow>
</math>
</maths>
</p>
<p id="p-0122" num="0124">The cumulative conversion functions are then obtained by integration:</p>
<p id="p-0123" num="0125">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
  <mrow>
    <mrow>
      <msub>
        <mi>F</mi>
        <mn>0</mn>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <msubsup>
        <mo>∫</mo>
        <msub>
          <mi>t</mi>
          <mn>0</mn>
        </msub>
        <mi>t</mi>
      </msubsup>
      <mo>⁢</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>gm</mi>
            <mi>L</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>x</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>·</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>x</mi>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00003-2" num="00003.2">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>F</mi>
          <mi>k</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>t</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mrow>
          <msubsup>
            <mo>∫</mo>
            <msub>
              <mi>t</mi>
              <mn>0</mn>
            </msub>
            <mi>t</mi>
          </msubsup>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mfrac>
                <mrow>
                  <msub>
                    <mi>gm</mi>
                    <mi>L</mi>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>x</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mrow>
                  <msub>
                    <mi>gm</mi>
                    <mrow>
                      <mi>k</mi>
                      <mo>-</mo>
                      <mn>1</mn>
                    </mrow>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>x</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mfrac>
              <mo>·</mo>
              <mrow>
                <mo>ⅆ</mo>
                <mi>x</mi>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>k</mi>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mn>1</mn>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mn>2</mn>
    <mo>,</mo>
    <mi>…</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.6em" height="0.6ex"/>
    </mstyle>
    <mo>,</mo>
    <mi>L</mi>
    <mo>,</mo>
  </mrow>
</math>
</maths>
<br/>
where t<sub>0 </sub>is the abscissa t at which F<sub>k</sub>(t)=0. This parameter determines the offset of the cumulative conversion functions. For convenience, it may be set to 0; then all cumulative conversion functions will cross the origin of the coordinate system.
</p>
<p id="p-0124" num="0126">The scale-specific conversion functions f<sub>k</sub>( ) are finally obtained by inversion of the cumulative conversion functions F<sub>k</sub>(t):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>k</sub>( )=<i>F</i><sub>k</sub><i>∘F</i><sub>k+1</sub><sup>−1</sup>( ), <i>k</i>=0, 1<i>, . . . , L</i>−1<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i><sub>L</sub>( )=<i>F</i><sub>L</sub>( )<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0125" num="0127">In a preferred embodiment, function inversion is avoided by storing all functions in tabular form (i.e. as lookup tables).</p>
<p id="p-0126" num="0128">First, the tables of scale-specific gradient functions gm<sub>k</sub>( ) are computed in a way that will be described below.</p>
<p id="p-0127" num="0129">Next, the cumulative conversion functions F<sub>k</sub>(t) are computed by conventional numerical integration techniques such as the trapezoidal rule, and also stored in tabular form as N equidistant points (t<sub>i</sub>, F<sub>k</sub>(t<sub>i</sub>)), i=0, 1, . . . , N−1.</p>
<p id="p-0128" num="0130">Finally, from these tables, the scale-specific conversion functions f<sub>k</sub>( ) are easily derived, also in tabular form. The N (abscissa, ordinate) pairs that define the function f<sub>k</sub>( ) are given by (F<sub>k+1</sub>(t<sub>i</sub>), F<sub>k</sub>(t<sub>i</sub>)), for the scales k=0, 1, . . . , L−1. At scale L which is the largest scale considered in the multiscale gradation process, the function f<sub>L</sub>( ) is identical to F<sub>L</sub>( ). Hence in tabular form the latter is specified by (t<sub>i</sub>, F<sub>L</sub>(t<sub>i</sub>)).</p>
<p id="p-0129" num="0131">This way, all scale-specific conversion functions are defined by series of points, which in general, are non-equidistant. Therefore, the functions f<sub>k</sub>( ) have to be interpolated in order to be evaluated at arbitrary integer input values.</p>
<p id="h-0012" num="0000">3. Independent Adjustment of Density and Contrast</p>
<p id="p-0130" num="0132">In accordance with the process described above, the behaviour of multiscale gradation is entirely determined by the shapes of the gradient functions gm<sub>k</sub>( ) at subsequent scales. Small-scale, medium-scale and large-scale contrast are controlled by specifying appropriate scale-specific gradient functions, as described below. In accordance with the present invention the gradient functions gm<sub>k</sub>( ) have an initial specification gm<b>0</b><sub>k</sub>( ) which is either fixed or depends on the grey value histogram and which determine the initial density and contrast rendering of the image before any adjustment of density or contrast according to the present invention is carried out. Typically, the resulting image is the one that is shown on the display monitor of a workstation at the beginning of an interactive adjustment session. With each new adjustment of density or contrast amplification a new series of multiscale gradient functions is defined which are denoted by gm<sub>k</sub>( ), and which specify the density and contrast rendering of the image at the current stage of adjustment. Typically one or more subsequent adjustments of density and contrast may be required to render an image with optimal density and contrast.</p>
<p id="p-0131" num="0133">In a preferred embodiment the initial gradient functions are defined as follows.</p>
<p id="h-0013" num="0000">3a. Initial Large-scale Gradient Function</p>
<p id="p-0132" num="0134">The initial large-scale gradient function gm<b>0</b><sub>L</sub>(t) specifies the contrast amplification at a large scale L, which is the largest scale involved in multiscale gradation. In the absence of smaller scale detail, i.e. if all detail pixels b<sub>k </sub>(or b<sub>k+1 </sub>in case of dyadic wavelet transform) are equal to zero at scales k=0, 1, . . . , L−1, then it also determines how the grey values t of the large-scale approximation image v<sub>L </sub>are mapped onto the density scale y of the visible image. The integral of the large-scale gradient function is then equivalent to an ordinary gradation function y<sub>L</sub>(t) to be applied to the large-scale grey value image v<sub>L</sub>. In the normal case, i.e. when detail at smaller scale is actually present, then the integral of the function gm<b>0</b><sub>L</sub>(t) still determines the large-scale average density distribution of the visible image, which is further modulated by smaller-scale details.</p>
<p id="p-0133" num="0135">In a preferred embodiment, the large-scale gradient function gm<b>0</b><sub>L</sub>( ) is obtained as the derivative of what will be referred to as the initial large-scale gradation function y<b>0</b><sub>L</sub>(t).</p>
<p id="p-0134" num="0136">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>gm0</mi>
      <mi>L</mi>
    </msub>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mo>ⅆ</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
      </mrow>
      <mrow>
        <mo>ⅆ</mo>
        <mi>t</mi>
      </mrow>
    </mfrac>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>y0</mi>
        <mi>L</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0135" num="0137">The initial large-scale gradation function is determined as described below.</p>
<p id="p-0136" num="0138">First, a series of anchor points t<sub>k </sub>is determined from the grey value histogram his(t) of the large-scale grey image v<sub>L</sub>. Each anchor point corresponds with a predefined percentile p<sub>k </sub>of the histogram, i.e. t<sub>k </sub>are the grey values at which the cumulative histogram is equal to p<sub>k</sub>.</p>
<p id="p-0137" num="0139">Preferably, the number of anchor points nk is quite small, e.g. nk=5, and p<sub>k</sub>=0%, 15%, 50%, 85%, 100%, for k=0 . . . 4.</p>
<p id="p-0138" num="0140">The large-scale gradation function is specified by its predefined ordinate values in the anchor points:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>y</i>0<sub>L</sub>(<i>t</i><sub>k</sub>)=<i>y</i><sub>k</sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Preferred ordinate values are y<sub>k</sub>=3%, 10%, 50%, 90%, 97%, expressed as a percentage of the output range.
</p>
<p id="p-0139" num="0141">The optimal number and position of the anchor points, and the corresponding ordinate values may vary depending on the kind of images. In the special case where p<sub>k</sub>=y<sub>k </sub>for all anchor points, the gradation function is identical to the gradation function obtained by global histogram equalisation.</p>
<p id="p-0140" num="0142">The gradation function is defined by fitting a piecewise polynomial function such as a spline or a Bezier curve to the predefined anchor points. It is extrapolated beyond the range [t<sub>0</sub>, t<sub>nk−1</sub>] by linear extension segments having predefined slopes g<sub>0 </sub>and g<sub>nk−1 </sub>respectively.</p>
<p id="p-0141" num="0143">In an alternative embodiment, the grey value histogram is restricted to a subset of image pixels indicated by a binary image mask, that are judged to belong to a relevant image regions based on criteria such as local contrast to noise ratio, by a method such as described in EP 02102368 filed Sep. 18, 2002.</p>
<p id="h-0014" num="0000">3b. Initial Small-scale Gradient Function</p>
<p id="p-0142" num="0144">At the smaller scales, the so-called initial small-scale gradient function gm0<sub>S</sub>(t) has a predefined shape. The value of this function specifies to which amount the contrast of fine details will be amplified as a function of grey value. Hence, by explicitly defining the shape of this function, it is possible to enforce specific small scale contrast behaviour across the range of grey values. The initial small-scale gradient function gm0<sub>k</sub>(t) is the same for all smaller scales ranging from k=0 through a predefined scale k=S.</p>
<p id="p-0143" num="0145">As a general rule, the function should have a nominal value in the central part of the relevant grey value subrange [t<sub>0</sub>, t<sub>nk−1</sub>], and fall off towards the peripheral parts of the subrange. This empirical rule ensures that the contrast is high in the most relevant grey value subrange and gradually vanishes in lowermost and uppermost subranges, in accordance with the ‘foot’ and ‘shoulder’ behaviour of common gradation curves in digital systems [such as disclosed in copending European patent application EP 02100181.3], but also in screen-film systems, known as the H&amp;D curves.</p>
<p id="p-0144" num="0146">In the special case where the initial small-scale gradient function is chosen identical to the initial large-scale gradient function, and the further described intermediate-scale gradient functions are also identical, then the contrast behaviour is the same as if the initial large-scale gradation function y<b>0</b><sub>L</sub>(t)) is applied immediately to the final reconstruction result, i.e. if only a single gradation function is applied in the conventional way.</p>
<p id="p-0145" num="0147">In accordance with the method of the present invention, it is possible to differentiate the contrast behaviour, which is mostly related to the smaller and intermediate scales, from the density mapping behaviour which is essentially related to the larger scales, by choosing a small-scale gradient function that actually differs from the large-scale gradient function. E.g. by specifying the initial small-scale gradient function basically identical to the initial large-scale gradient function, except in the lower part of the relevant pixel subrange, where it is made higher, the contrast in the lower densities will increase without affecting the contrast in the high densities. This setting is favourable for enhancing the contrast of trabecular bone structure. Alternatively, the contrast at the skin boundaries can be raised by specifying the small-scale gradient function having high value in the darkmost part of the relevant grey value subrange. Such adjustment is recommended for better visualizing soft tissue lesions near the skin boundary. By specifying a small-scale gradient function that exceeds the large-scale gradient function everywhere, overall contrast is reinforced without significantly altering the global distribution of densities (which is determined by the large-scale gradient function).</p>
<p id="p-0146" num="0148">In a preferred embodiment the small-scale gradient function is specified to have a predefined shape independent from the large-scale gradient function. This is achieved by specifying predefined function values in the anchor points.</p>
<p id="p-0147" num="0149">This way, the range of density levels may be matched to the actual grey value range of the image according to predefined histogram percentiles by the method described above, without affecting however the contrast, which depends on an independently specified small-scale gradient function.</p>
<p id="p-0148" num="0150">In an alternative embodiment the initial small-scale gradient function is predefined by its ordinate values gm<b>0</b><sub>S</sub>(t<sub>k</sub>)=c<sub>k </sub>in the nk anchor points, expressed as a predefined percentage of the average initial large-scale gradient</p>
<p id="p-0149" num="0151">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>gm0</mi>
    <mi>Lav</mi>
  </msub>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <mrow>
        <msub>
          <mi>y0</mi>
          <mi>L</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <msub>
            <mi>t</mi>
            <mrow>
              <mi>nk</mi>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </msub>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
        <msub>
          <mi>y0</mi>
          <mi>L</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <msub>
            <mi>t</mi>
            <mn>0</mn>
          </msub>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mrow>
      <msub>
        <mi>t</mi>
        <mrow>
          <mi>nk</mi>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
      </msub>
      <mo>-</mo>
      <msub>
        <mi>t</mi>
        <mn>0</mn>
      </msub>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
</p>
<p id="p-0150" num="0152">Initial small-scale gradient values are preferably in the range between 10% and 400% of gm<b>0</b><sub>Lav</sub>, most preferably c<sub>k</sub>=100%, 170%, 250%, 100%, 25%.</p>
<p id="p-0151" num="0153">The small-scale gradient function is defined by fitting a piecewise polynomial function such as a spline or a Bezier curve to the predefined anchor points. It is extrapolated beyond the range [t<sub>0</sub>, t<sub>nk−1</sub>] by constant extension segments having ordinate values c<sub>0 </sub>and c<sub>nk−1 </sub>respectively.</p>
<p id="h-0015" num="0000">3c. Initial Intermediate-scale Gradient Functions</p>
<p id="p-0152" num="0154">Given an initial large-scale gradient function gm<b>0</b><sub>L</sub>(t) at a scale L and an initial small-scale gradient function gm<b>0</b><sub>S</sub>(t) that applies to the smaller scales from 0 through S as defined above, then the initial gradient functions at the intermediate scales from S+1 through L−1 are generated according to the following preferred embodiment:</p>
<p id="p-0153" num="0155">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>gm0</mi>
        <mi>k</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <msub>
          <mi>gm0</mi>
          <mi>S</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>t</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>·</mo>
      <msup>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <msub>
                <mi>gm0</mi>
                <mi>L</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>gm0</mi>
                <mi>S</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mfrac>
          <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mi>S</mi>
          </mrow>
          <mrow>
            <mi>L</mi>
            <mo>-</mo>
            <mi>S</mi>
          </mrow>
        </mfrac>
      </msup>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mspace width="0.8em" height="0.8ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>k</mi>
    <mo>=</mo>
    <mrow>
      <mi>S</mi>
      <mo>+</mo>
      <mn>1</mn>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>S</mi>
    <mo>+</mo>
    <mn>2</mn>
  </mrow>
  <mo>,</mo>
  <mi>…</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.6em" height="0.6ex"/>
  </mstyle>
  <mo>,</mo>
  <mrow>
    <mi>L</mi>
    <mo>-</mo>
    <mn>1</mn>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0154" num="0156">This specification of the intermediate scale gradient functions ensures a gradual transition from the large-scale gradient function to the small-scale gradient function. As a consequence, the contrast behaviour evolves gradually from the large-scale contrast behaviour specified by gm<b>0</b><sub>L</sub>(t), to the contrast behaviour specified by gm<b>0</b><sub>S</sub>(t).</p>
<p id="p-0155" num="0157">In a preferred embodiment, the small-scale parameter S is preferably set within the range [0, 4], and L should preferably be in the range [S+2, k<sub>max</sub>−1], where k<sub>max </sub>is the largest scale of the multiscale decomposition. In case the image dimensions are 2048×2048, most preferable settings are S=3 and L=7. In that case, the scales 0, 1, 2 and 3 are controlled by the same small-scale gradient function gm<b>0</b><sub>S</sub>(t), the large-scale gradient function applies to scale <b>7</b>, and a gradual transition is provided from scale <b>4</b> through scale <b>6</b>. An example of a series of these functions is illustrated in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0156" num="0158">A few alternative embodiments of methods for defining the initial gradient functions gm<b>0</b><sub>k</sub>( ) are described in EP 02102368 filed Sep. 18, 2002.</p>
<p id="h-0016" num="0000">4. Interactive Adjustment of Density and Contrast</p>
<p id="p-0157" num="0159">An image processed according to the above described multiscale gradation method and displayed on a display monitor will have appropriate density and contrast if the initial multiscale gradient functions gm<b>0</b><sub>k</sub>( ) are defined properly.</p>
<p id="p-0158" num="0160">However, the initial specification of these functions may not be optimal, or the viewing task at hand may impose special requirements on density or contrast in some density band, e.g. the density band that corresponds to the lung fields may need more contrast and lower density.</p>
<p id="p-0159" num="0161">It is possible to independently adjust the density level and the contrast of all image regions belonging to the specified density band by an interactive procedure in accordance with the findings of the present invention.</p>
<p id="p-0160" num="0162">In an interactive adjustment session, the initial state and the corresponding displayed image is determined by the series of initial multiscale gradient functions gm<b>0</b><sub>k</sub>( ) specified by one of the methods described above. With each adjustment induced by a user interaction an updated series of multiscale gradient functions gm<sub>k</sub>( ) is generated by applying changes to the initial series. Upon every change the above method of multiscale gradation is applied to the updated multiscale gradient functions and preferably the resulting image is displayed to provide the user with feedback about the adjustment. This way, any desired modification of density or contrast in parts of the image can be efficiently accomplished by one or more user-induced adjustments, thereby significantly improving the workflow, also in difficult cases that require critical adjustments.</p>
<p id="p-0161" num="0163">In a preferred embodiment the density band that requires adjustment is specified by indicating a point in the initially displayed image that has the intended density. This can be done using any device means denoted by indicium intended for indicating positions in an image, such as a cursor operated by a computer mouse. The density of the indicated point is denoted by the initial density yr<b>0</b>. The amounts of density and contrast adjustment denoted by dy and dc are indicated by the movement of a cursor in a window, or by any two-dimensional pointing device or interactive controller. Preferably, the window in which the cursor can be moved is the image window, so that the viewer doesn't have to remove focus from the image during adjustment. Alternatively, two separate one-dimensional GUI controls can be used to specify the amounts of adjustment dy and dc, such as two sliders or scroll bars.</p>
<p id="p-0162" num="0164">The adjustment parameters specify the amount of density and contrast amplification adjustment to be applied to all pixels that have a density that is substantially equal to the initial density yr<b>0</b>. The adjustment quantities are specified relative to the settings that yield the initially displayed image. Subsequent adjustment parameters may be specified still to the initially displayed image, or relative to the result of the previous adjustment, i.e. subsequent adjustments may be absolute or incremental. The starting position of the cursor used for specifying the adjustment parameters is preferably in the center of the image. Alternatively, it may be a point in a notional coordinate system within the cursor window comprising a density axis in horizontal direction and a contrast amplification axis in vertical direction, where the initial cursor position relative to the coordinate system is indicative of the initial density and contrast amplification of the selected density band.</p>
<p id="p-0163" num="0165">In a preferred embodiment the adjustment of density and contrast amplification is carried out as described below.</p>
<p id="p-0164" num="0166">First, the initial small-scale gradient function gm<b>0</b><sub>S</sub>(t) is expressed in terms of density y instead of grey value t, using the relationship t<b>0</b><sub>L</sub>(y), which is the inverse of the large-scale gradation function y<b>0</b><sub>L</sub>(t).</p>
<p id="p-0165" num="0167">Next, the small-scale gradient function is locally deformed in ordinate direction by an amount dc across a subrange centered at the initial density yr<b>0</b>, as depicted in <figref idref="DRAWINGS">FIG. 10</figref>. This can be done by representing the small-scale gradient function by a Bezier curve or a spline and using common graphical techniques to accomplish a smooth local deformation. This ensures that the magnitude of deformation is highest at the initial density yr<b>0</b>, and gradually diminishes to zero at the boundaries of the subrange. The wider the subrange that specifies the density band, the more pixels of the image will be involved in the adjustment procedure. Preferably, the subrange width is 25% of the overall density range.</p>
<p id="p-0166" num="0168">The deformed small-scale gradient function is subsequently expressed in terms of grey values t, using the initial large-scale gradation y(t)=y<b>0</b><sub>L</sub>(t) as conversion function, yielding an adjusted small-scale gradient function gm<sub>S</sub>(t).</p>
<p id="p-0167" num="0169">Next, the density adjustment is applied by locally deforming the large-scale gradation function y(t)=y<b>0</b><sub>L</sub>(t) in ordinate direction by an amount dy across a subrange centered at the grey value tr<b>0</b> that corresponds with density yr<b>0</b>, i.e. the t-value for which y<b>0</b><sub>L</sub>(tr<b>0</b>)=yr<b>0</b>, as depicted in <figref idref="DRAWINGS">FIG. 11</figref>. This is done in a similar way as the local adjustment of the small-scale gradient function described above.</p>
<p id="p-0168" num="0170">The thus adjusted large-scale gradation function is denoted by y<sub>L</sub>(t). The derivative of this function yields the adjusted large-scale gradient function gm<sub>L</sub>(t).</p>
<p id="p-0169" num="0171">A series of adjusted intermediate-scale gradient functions is obtained in a similar way as the initial gradient functions, based on the adjusted versions of the small-scale and large-scale gradient functions:</p>
<p id="p-0170" num="0172">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>gm</mi>
        <mi>k</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <msub>
          <mi>gm</mi>
          <mi>S</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>t</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>·</mo>
      <msup>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <msub>
                <mi>gm</mi>
                <mi>L</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <msub>
                <mi>gm</mi>
                <mi>S</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mfrac>
          <mrow>
            <mi>k</mi>
            <mo>-</mo>
            <mi>S</mi>
          </mrow>
          <mrow>
            <mi>L</mi>
            <mo>-</mo>
            <mi>S</mi>
          </mrow>
        </mfrac>
      </msup>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mstyle>
    <mspace width="0.8em" height="0.8ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>k</mi>
    <mo>=</mo>
    <mrow>
      <mi>S</mi>
      <mo>+</mo>
      <mn>1</mn>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mi>S</mi>
    <mo>+</mo>
    <mn>2</mn>
  </mrow>
  <mo>,</mo>
  <mi>…</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.6em" height="0.6ex"/>
  </mstyle>
  <mo>,</mo>
  <mrow>
    <mi>L</mi>
    <mo>-</mo>
    <mn>1</mn>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0171" num="0173">If finally the reconstruction procedure of multiscale gradation is applied as described higher under the heading ‘Reconstruction and multiscale gradation’, using the adjusted gradient functions gm<sub>k </sub>instead of the initial set of functions gm<b>0</b><sub>k</sub>, then an image with independently adjusted density and contrast results, in accordance with the findings of the present invention.</p>
<p id="p-0172" num="0174">The multiscale gradient functions and the large-scale gradation function are preferably specified by means of piecewise polynomials. This representation is advantageous for computing a smooth local deformation, or for computing the derivative function. Alternatively, the large-scale gradation function may be specified in the form of a table of coordinate pairs, which is an appropriate representation for computing the inverse relation t<b>0</b><sub>L</sub>(y), thereby avoiding explicit function inversion. Both the forward and inverse functions are evaluated at arbitrary points by linear interpolation of the table values. The kind of representation is not essential and is merely motivated by the mathematical simplicity of the operations that must be applied. Transition from one kind of representation to the other is done by common interpolation techniques.</p>
<p id="p-0173" num="0175">When applying density adjustment to the large-scale gradation it is important to ensure that the resulting function remains monotonic. It is also preferable to impose limits to the slope of the gradation function, and to the ordinates of the small-scale gradient function in order to avoid excessive contrast amplification.</p>
<p id="p-0174" num="0176">In a second embodiment of independent adjustment of density and contrast of pixels belonging to a specified density band, referring to <figref idref="DRAWINGS">FIG. 12</figref>, a two-dimensional graph (<b>60</b>) is displayed that plots small-scale gradient representing contrast as a function of density. At the beginning of an adjustment session, the initial gradient function gm<b>0</b><sub>S</sub>(y) (<b>61</b>) is plotted, along with the histogram (<b>62</b>) as a function of density. In addition, a density wedge (<b>63</b>) may be plotted along the density axis to explicitly display the corresponding density at each abscissa value.</p>
<p id="p-0175" num="0177">The nominal density of the density band intended to be adjusted is indicated by the user by placing a cursor (<b>64</b>) or other pointing means at the desired position along the density axis. Upon acknowledgement of the thus selected density band, the corresponding point [yr<b>0</b>, gm<b>0</b><sub>S</sub>(yr<b>0</b>)] on the contrast function plot is marked as the starting position (<b>65</b>) for subsequent adjustment. The desired adjustment of density and contrast amplification are indicated by moving a cursor (<b>66</b>) or any other pointing means relative to the marked point, either in a vertical direction for specifying contrast adjustment dc, or in a horizontal direction for specifying density adjustment dy, or in any other direction for specifying a simultaneous adjustment in proportion to the horizontal and vertical movement components. Each time a set of adjustment parameters are specified, the series of adjusted gradient functions gm<sub>k</sub>( ) and resulting image are computed as described in the first embodiment. Real-time feedback to the user is achieved by updating the displayed image (<b>67</b>) on each cursor movement. In addition the contrast function plot and the histogram may be updated for improved feedback.</p>
<p id="p-0176" num="0178">In a third embodiment, referring to <figref idref="DRAWINGS">FIG. 12</figref>, a two-dimensional graph is displayed that plots small-scale gradient representing contrast as a function of density along with the histogram and a density wedge along the density axis, as described in the previous embodiment.</p>
<p id="p-0177" num="0179">However, the nominal density of the density band intended to be adjusted is indicated by the user by indicating a point (<b>70</b>)in the displayed image having the same density, as described in the first embodiment. Similarly, the amounts of density and contrast adjustment dy and dc are indicated by the movement of a cursor in the window. The selected nominal density of the density band to be adjusted is marked on the contrast function plot as the starting position for subsequent adjustment. Upon movement of the cursor that indicates the desired amount of adjustment, the image, the histogram and the contrast function are updated, along with the initial marker and the cursor that indicates the current adjustment.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298373-20071120-M00001.NB">
<img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US07298373-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298373-20071120-M00002.NB">
<img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US07298373-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003 MATH-US-00003-2" nb-file="US07298373-20071120-M00003.NB">
<img id="EMI-M00003" he="15.49mm" wi="76.20mm" file="US07298373-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298373-20071120-M00004.NB">
<img id="EMI-M00004" he="6.01mm" wi="76.20mm" file="US07298373-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298373-20071120-M00005.NB">
<img id="EMI-M00005" he="6.35mm" wi="76.20mm" file="US07298373-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298373-20071120-M00006.NB">
<img id="EMI-M00006" he="8.13mm" wi="76.20mm" file="US07298373-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298373-20071120-M00007.NB">
<img id="EMI-M00007" he="8.13mm" wi="76.20mm" file="US07298373-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of modifying at least one of contrast and density of pixels of a processed image comprising the steps of:
<claim-text>(a) displaying said processed image on a display screen,</claim-text>
<claim-text>(b) specifying an initial density level in said processed image by covering a pixel or pixel region by means of a first indicium which is capable of responding to a user input for moving said indicium relative to the displayed processed image, the density of the pixel or pixel region covered by said indicium being the initial density,</claim-text>
<claim-text>(c) in response to a user input, moving a second indicium in at least one of two directions relative to the displayed processed image,</claim-text>
<claim-text>(d) changing the contrast of pixels in the displayed processed image which have substantially the same density as said initial density upon receiving the user input for movement of said second indicium in a first of said directions, and</claim-text>
<claim-text>(e) changing the density of pixels in the displayed processed image which have substantially the same density as said initial density upon receiving the user input for movement of said second indicium in a second of said directions,</claim-text>
<claim-text>wherein contrast and density are changed independently by modifying a multi-scale representation of said image, wherein the modification is derived from at least two gradient functions determined at different scales, and wherein a gradient function at a specific scale specifies how contrast amplification at a scale depends on density.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the amount by which the contrast of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the amount by which the density of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein said amount of density change gradually decreases for pixels that have either lower or higher density values relative to the initial density level.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the amount by which the density of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method according to <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein said amount of density change gradually decreases for pixels that have either lower or higher density values relative to the initial density level.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A computer readable medium encoded with a computer executable program code which executes the steps of:
<claim-text>(a) displaying a processed image on a display screen,</claim-text>
<claim-text>(b) specifying an initial density level in said processed image by covering a pixel or pixel region by means of a first indicium which is capable of responding to a user input for moving said indicium relative to the displayed processed image, the density of the pixel or pixel region covered by said indicium being the initial density,</claim-text>
<claim-text>(c) in response to a user input, moving a second indicium in at least one of two directions relative to the displayed processed image,</claim-text>
<claim-text>(d) changing the contrast of pixels in the displayed processed image which have substantially the same density as said initial density upon receiving the user input for movement of said second indicium in a first of said directions, and</claim-text>
<claim-text>(e) changing the density of pixels in the displayed processed image which have substantially the same density as said initial density upon receiving the user input for movement of said second indicium in a second of said directions,</claim-text>
<claim-text>wherein contrast and density are changed independently by modifying a multi-scale representation of said image, wherein the modification is derived from at least two gradient functions determined at different scales, and wherein a gradient function at a specific scale specifies how contrast amplification at a scale depends on density.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer readable medium encoded with a computer executable program code according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the amount by which the contrast of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer readable medium encoded with a computer executable program code according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the amount by which the density of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The computer readable medium encoded with a computer executable program code according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said amount of density change gradually decreases for pixels that have either lower or higher density values relative to the initial density level.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer readable medium encoded with a computer executable program code according to <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the amount by which the density of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer readable medium encoded with a computer executable program code according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein said amount of density change gradually decreases for pixels that have either lower or higher density values relative to the initial density level.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A user interface for an image processing and display unit comprising:
<claim-text>(a) a window wherein a processed image is displayed,</claim-text>
<claim-text>(b) a first indicium capable of responding to user input for moving relative to the displayed processed image, wherein the density of a pixel or pixel region covered by movement of said first indicium is an initial density, and</claim-text>
<claim-text>(c) a second indicium capable of responding to user input for moving in at least one of two directions relative to the displayed processed image,</claim-text>
<claim-text>wherein said user input for movement of said second indicium in a first direction causes a change of density of pixels in the displayed processed image that have a density value that is substantially equal to said initial density,</claim-text>
<claim-text>wherein said user input for movement of said second indicium in a second direction causes a change of contrast of pixels in the displayed processed image that have a density value that is substantially equal to said initial density, and</claim-text>
<claim-text>wherein contrast and density are changed independently by modifying a multi-scale representation of said image, wherein the modification is derived from at least two gradient functions determined at different scales, and wherein a gradient function at a specific scale specifies how contrast amplification at a scale depends on density.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The user interface for an image processing and display unit according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the amount by which the contrast of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The user interface for an image processing and display unit according to <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein the amount by which the density of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The user interface for an image processing and display unit according to <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein said amount of density change gradually decreases for pixels that have either lower or higher density values relative to the initial density level.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The user interface for an image processing and display unit according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the amount by which the density of selected pixels is changed is largest for pixels having a density equal to said initial density.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The user interface for an image processing and display unit according to <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein said amount of density change gradually decreases for pixels that have either lower or higher density values relative to the initial density level.</claim-text>
</claim>
</claims>
</us-patent-grant>
