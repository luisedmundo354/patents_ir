<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07296866-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07296866</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10941507</doc-number>
<date>20040915</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2003-325867</doc-number>
<date>20030918</date>
</priority-claim>
<priority-claim sequence="02" kind="national">
<country>JP</country>
<doc-number>2003-339356</doc-number>
<date>20030930</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>310</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>B</section>
<class>41</class>
<subclass>J</subclass>
<main-group>29</main-group>
<subgroup>38</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>347 14</main-classification>
<further-classification>347 15</further-classification>
</classification-national>
<invention-title id="d0e89">Ejection control device, liquid-ejecting apparatus, ejection control method, recording medium, and program</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4905022</doc-number>
<kind>A</kind>
<name>Nagasawa et al.</name>
<date>19900200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5126531</doc-number>
<kind>A</kind>
<name>Majima et al.</name>
<date>19920600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6631963</doc-number>
<kind>B1</kind>
<name>Ando et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6695434</doc-number>
<kind>B2</kind>
<name>Konno et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>347 43</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>EP</country>
<doc-number>0925924</doc-number>
<date>19990600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>EP</country>
<doc-number>1157844</doc-number>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>EP</country>
<doc-number>1 164 013</doc-number>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>EP</country>
<doc-number>1231066</doc-number>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>WO</country>
<doc-number>WO 01/39981</doc-number>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>347 14</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>347 15</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>27</number-of-drawing-sheets>
<number-of-figures>33</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050068357</doc-number>
<kind>A1</kind>
<date>20050331</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ikemoto</last-name>
<first-name>Yuichiro</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Takenaka</last-name>
<first-name>Kazuyasu</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ushinohama</last-name>
<first-name>Iwao</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kuwahara</last-name>
<first-name>Soichi</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Depke</last-name>
<first-name>Robert J.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<orgname>Rockey, Depke &amp; Lyons, LLC.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sony Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Nguyen</last-name>
<first-name>Thinh</first-name>
<department>2861</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An ejection control device includes a memory for storing a correspondence table between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; and a converter for converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the table. In the table, the setting of the ejecting position can be freely adjusted. In particular, an ejection pattern having ejection data bits discretely distributed for one pixel range can be easily achieved. Moreover, compliance with system changes can be achieved simply by rewriting the table.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="132.42mm" wi="150.62mm" file="US07296866-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="110.74mm" wi="117.35mm" file="US07296866-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="148.51mm" wi="153.08mm" file="US07296866-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="191.60mm" wi="143.76mm" orientation="landscape" file="US07296866-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="133.69mm" wi="128.27mm" file="US07296866-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="191.60mm" wi="134.20mm" orientation="landscape" file="US07296866-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="200.41mm" wi="131.15mm" file="US07296866-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="170.10mm" wi="150.28mm" file="US07296866-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="193.80mm" wi="139.19mm" orientation="landscape" file="US07296866-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="146.05mm" wi="130.22mm" file="US07296866-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="102.11mm" wi="161.88mm" file="US07296866-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="192.36mm" wi="157.65mm" orientation="landscape" file="US07296866-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="161.88mm" wi="139.95mm" file="US07296866-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="207.09mm" wi="116.33mm" orientation="landscape" file="US07296866-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="169.25mm" wi="145.71mm" file="US07296866-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="140.21mm" wi="131.40mm" file="US07296866-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="128.02mm" wi="93.73mm" file="US07296866-20071120-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="175.09mm" wi="133.01mm" file="US07296866-20071120-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="176.11mm" wi="132.93mm" orientation="landscape" file="US07296866-20071120-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="172.55mm" wi="131.32mm" orientation="landscape" file="US07296866-20071120-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="195.41mm" wi="105.24mm" orientation="landscape" file="US07296866-20071120-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="188.21mm" wi="148.84mm" file="US07296866-20071120-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="176.87mm" wi="130.22mm" orientation="landscape" file="US07296866-20071120-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00023" num="00023">
<img id="EMI-D00023" he="178.48mm" wi="134.79mm" orientation="landscape" file="US07296866-20071120-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00024" num="00024">
<img id="EMI-D00024" he="174.24mm" wi="129.96mm" orientation="landscape" file="US07296866-20071120-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00025" num="00025">
<img id="EMI-D00025" he="191.94mm" wi="156.89mm" orientation="landscape" file="US07296866-20071120-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00026" num="00026">
<img id="EMI-D00026" he="187.79mm" wi="151.13mm" orientation="landscape" file="US07296866-20071120-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00027" num="00027">
<img id="EMI-D00027" he="170.86mm" wi="154.01mm" file="US07296866-20071120-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<p id="p-0002" num="0001">The present application claims priority to Japanese Patent Application JP2003-325867, filed in the Japanese Patent Office Sep. 18, 2003, and Japanese Patent Application JP2003-339356, filed in the Japanese Patent Office Sep. 30, 2003; the entire contents of which are incorporated herein by reference.</p>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">1. Field of the Invention</p>
<p id="p-0004" num="0003">The present invention relates to a liquid-ejecting apparatus for ejecting droplets to an object, and to an ejection control device for controlling such an ejecting operation. Furthermore, the present invention relates to a method and a program for controlling such an ejection operation. Moreover, the present invention relates to a recording medium having the program recorded thereon.</p>
<p id="p-0005" num="0004">2. Description of the Related Art</p>
<p id="p-0006" num="0005">One of known techniques for gray-scale expression of a printing image is a pulse-number modulation technique. According to such a technique, each pixel, which is the smallest unit in an image, is expressed with a group of droplets having a small diameter. Depending on the number of droplets, the visual appearance of the diameter of each pixel changes. The visual differences in the pixel diameter give different gray-scale levels of pixels to a viewer. Here, the term “the number of droplets” refers to the number of droplets ejected to a pixel range of one pixel.</p>
<p id="p-0007" num="0006">An application of such a pulse-number modulation technique is disclosed in WO01/039981 PCT Gazette. According to WO01/039981 PCT Gazette, droplets are ejected in a consecutive manner based on gray-scale data, i.e. data for determining the number of droplets to be ejected to one pixel range. For example, according to a gray-scale-level data item PNM<b>5</b>, five droplets are to be ejected in a consecutive manner. In detail, the gray-scale data and the pulse number are compared, and a signal that allows droplets to be ejected until the pulse number exceeds the number corresponding to the gray-scale data is generated.</p>
<p id="p-0008" num="0007">However, such a technique that generates a driving signal based on the comparison result is problematic (first problem) in that it requires a complicated circuit for the ejecting position with respect to the center of the corresponding pixel.</p>
<p id="p-0009" num="0008">Furthermore, WO01/039981 PCT Gazette and Japanese Unexamined Patent Application Publication No. 2003-226017, for example, disclose a line head functioning as a head mechanism in a liquid-ejecting apparatus. Such a line head has a plurality of nozzles aligned thereon and can draw pixels simultaneously with respect to the number of nozzles provided.</p>
<p id="p-0010" num="0009">Such a line head is problematic (second problem) in view of the fact that an extremely a large number of nozzles are provided. For this reason, there are cases where some of the nozzles cannot eject droplets properly.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0011" num="0010">Accordingly, it is an object of the present invention to solve these problems by providing a technology that allows easy and accurate setting for the ejecting positions of droplets and for the ejection timing. Moreover, it is another object of the present invention to provide a technology that allows compensation for malfunction of ejection with a simple structure.</p>
<p id="p-0012" num="0011">The present invention employs one table or a plurality of tables. Here, a table is used as a correspondence between gray-scale data and ejection pattern data. In a table, each gray-scale data item is provided with one predetermined ejection pattern.</p>
<p id="p-0013" num="0012">Each ejection pattern includes ejection data bits for determining whether or not a droplet is to be ejected. The ejection data bits are arranged in a time-series manner. For example, if an ejection data bit is set at “1”, a droplet is to be ejected, whereas if an ejection data bit is set at “0”, a droplet is not to be ejected. Accordingly, the ejecting positions and timing are determined based on where the ejection data bits “1” are located.</p>
<p id="p-0014" num="0013">According to a first aspect of the present invention, an ejection control device is provided. The ejection control device includes a memory for storing a correspondence table between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; and a converter for converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the table.</p>
<p id="p-0015" num="0014">According to a second aspect of the present invention, an ejection control device is provided. Such an ejection control device includes a memory for storing multiple types of correspondence tables between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; a selector for selecting one of the tables; and a converter for converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the table selected by the selector.</p>
<p id="p-0016" num="0015">In the ejection control device according to the second aspect, the selector may select one of the tables based on the position of the corresponding pixel to be processed.</p>
<p id="p-0017" num="0016">Furthermore, in the ejection control device according to the second aspect, the selector may select one of the tables based on a random number.</p>
<p id="p-0018" num="0017">Moreover, each table may include at least one ejection pattern data item in which the ejection timing of droplets is non-consecutive.</p>
<p id="p-0019" num="0018">Furthermore, the memory may be rewritable such that the content in each table can be changed.</p>
<p id="p-0020" num="0019">According to a third aspect of the present invention, a liquid-ejecting apparatus is provided. Such a liquid-ejecting apparatus includes a memory for storing a correspondence table between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express the desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; a converter for converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the table; and an ejection driver for ejecting droplets through a corresponding nozzle based on the ejection pattern data item.</p>
<p id="p-0021" num="0020">According to a fourth aspect of the present invention, a liquid-ejecting apparatus is provided. Such a liquid-ejecting apparatus includes a memory for storing multiple types of correspondence tables between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; a selector for selecting one of the tables; a converter for converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the table selected by the selector; and an ejection driver for ejecting droplets through a corresponding nozzle based on the ejection pattern data item.</p>
<p id="p-0022" num="0021">According to a fifth aspect of the present invention, a method for controlling an ejecting operation is provided. Such a method includes the steps of referring to a correspondence table between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; and converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item based on the table.</p>
<p id="p-0023" num="0022">According to a sixth aspect of the present invention, a method for controlling an ejecting operation is provided. Such a method includes the steps of selecting one of multiple types of correspondence tables between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; and converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the selected table.</p>
<p id="p-0024" num="0023">According to a seventh aspect of the present invention, a recording medium having a program recorded thereon is provided. Such a program can be read by a computer and allows the computer to refer to a correspondence table between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets, whereby the computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item based on the table.</p>
<p id="p-0025" num="0024">According to an eighth aspect of the present invention, a recording medium having a program recorded thereon is provided. Such a program can be read by a computer and allows the computer to select one of multiple types of correspondence tables between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets, whereby the computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the selected table.</p>
<p id="p-0026" num="0025">According to a ninth aspect of the present invention, a program for allowing a computer to refer to a correspondence table between gray-scale data items and ejection pattern data items is provided. Each gray-scale data item determines the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel. Each ejection pattern data item determines the ejection timing of droplets. The computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item based on the table.</p>
<p id="p-0027" num="0026">According to a tenth aspect of the present invention, a program for allowing a computer to select one of multiple types of correspondence tables between gray-scale data items and ejection pattern data items is provided. Each gray-scale data item determines the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel. Each ejection pattern data item determines the ejection timing of droplets. The computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the selected table.</p>
<p id="p-0028" num="0027">According to an eleventh aspect of the present invention, an ejection control device for controlling ejection of droplets for a liquid-ejecting apparatus provided with an ejection head is provided. The ejection head has nozzles each being capable of ejecting droplets to multiple pixel ranges by deflection of the droplets. The ejection control device includes a determiner for determining whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection; and a converter for converting the gray-scale data item subject to conversion to an ejection pattern data item. Based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection. Based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly.</p>
<p id="p-0029" num="0028">In the ejection control device of the eleventh aspect, the second table may comprise first and second table components, the first table component being used for a nozzle which is determined to be malfunctional, the second table component being used for a nozzle adjacent to the malfunctional nozzle in the deflecting direction.</p>
<p id="p-0030" num="0029">Furthermore, one of the first and second tables may comprise multiple types of table components, and the ejection control device may further comprise a selector for selecting one of the table components for gray-scale data conversion.</p>
<p id="p-0031" num="0030">According to a twelfth aspect of the present invention, a liquid-ejecting apparatus provided with an ejection head is provided. Each of nozzles disposed in the ejection head is capable of ejecting droplets to multiple pixel ranges by deflection of the droplets. Such a liquid-ejecting apparatus includes a determiner for determining whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection; a converter for converting the gray-scale data item subject to conversion to an ejection pattern data item; and an ejection driver for ejecting droplets based on the ejection pattern data item via the ejection head. Based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection. On the other hand, based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly.</p>
<p id="p-0032" num="0031">According to a thirteenth aspect of the present invention, a method for controlling ejection of droplets for a liquid-ejecting apparatus provided with an ejection head is provided. Each of nozzles disposed in the ejection head is capable of ejecting droplets to multiple pixel ranges by deflection of the droplets. Such a method includes the steps of determining whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection; and converting the gray-scale data item subject to conversion to an ejection pattern data item. Based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection. On the other hand, based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly.</p>
<p id="p-0033" num="0032">According to a fourteenth aspect of the present invention, a recording medium having a program recorded thereon is provided. Such a program can be read by a computer and allows the computer to determine whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection. Based on the determination result, the program allows the computer to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection. On the other hand, the program allows the computer to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly if the gray-scale data item corresponds to a pixel affected by malfunction of ejection.</p>
<p id="p-0034" num="0033">According to a fifteenth aspect of the present invention, a program for allowing a computer to determine whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection is provided. Based on the determination result, the program allows the computer to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection. On the other hand, the program allows the computer to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly if the gray-scale data item corresponds to a pixel affected by malfunction of ejection.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 1</figref> is a functional block diagram of an example of the present invention;</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 2</figref> is a functional block diagram of another example of the present invention;</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a signal processing unit according to a first embodiment of the present invention;</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 4</figref> illustrates an example of a table for gray-scale data conversion;</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a signal processing unit according to a second embodiment of the present invention;</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 6</figref> illustrates other examples of tables for gray-scale data conversion;</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIGS. 7A and 7B</figref> each illustrate a table used for selecting one of the tables for gray-scale data conversion;</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a signal processing unit according to a third embodiment of the present invention;</p>
<p id="p-0043" num="0042"><figref idref="DRAWINGS">FIG. 9</figref> is a functional block diagram of another example of the present invention;</p>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 10</figref> illustrates a positional relationship between nozzles and pixel ranges in a case where droplets can be ejected from two directions in a deflective manner;</p>
<p id="p-0045" num="0044"><figref idref="DRAWINGS">FIG. 11</figref> illustrates a liquid-ejecting apparatus according to a fourth embodiment of the present invention;</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIGS. 12A and 12B</figref> each illustrate a relationship between gray-scale data and corresponding ejection patterns;</p>
<p id="p-0047" num="0046"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram illustrating reading of ejection data bits in a case where droplets can be ejected in a deflective manner from two directions;</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 14A</figref> illustrates a table for a malfunctional nozzle;</p>
<p id="p-0049" num="0048"><figref idref="DRAWINGS">FIG. 14B</figref> illustrates a table for a malfunction-related nozzle;</p>
<p id="p-0050" num="0049"><figref idref="DRAWINGS">FIG. 15</figref> is a schematic diagram of an ejecting-position determiner;</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 16</figref> is a schematic diagram of a read counter;</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 17</figref> is a schematic diagram of a read-address shifter;</p>
<p id="p-0053" num="0052"><figref idref="DRAWINGS">FIG. 18</figref> illustrates an example in which every other nozzle is malfunctional;</p>
<p id="p-0054" num="0053"><figref idref="DRAWINGS">FIG. 19</figref> illustrates an example in which adjacent nozzles are malfunctional;</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 20</figref> is a diagram in which ejection data bits are read such that droplets can be deflectively ejected from three directions;</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIGS. 21A</figref>, <b>21</b>B, and <b>21</b>C each illustrate a table for a malfunctional nozzle or a table for a nozzle affected by malfunction of ejection;</p>
<p id="p-0057" num="0056"><figref idref="DRAWINGS">FIG. 22</figref> illustrates an example in which two nozzles are malfunctional, the two nozzles having two normal nozzles therebetween;</p>
<p id="p-0058" num="0057"><figref idref="DRAWINGS">FIG. 23</figref> illustrates an example in which every other nozzle is malfunctional;</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 24</figref> illustrates an example in which adjacent nozzles are malfunctional;</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 25</figref> illustrates a liquid-ejecting apparatus according to a seventh embodiment of the present invention;</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 26</figref> illustrates a table for normal ejection and a table for malfunction-related ejection, each of the tables being provided with a set of selectable table components; and</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIGS. 27A and 27B</figref> each illustrate an example of a table used for the selection of the table components.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0063" num="0062">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, an example of an ejection control device according to the present invention is illustrated. A memory <b>1</b> is for storing a table <b>1</b>A. A read-only-memory (ROM) is commonly used for the memory <b>1</b>. Alternatively, a random-access-memory (RAM) or other semiconductor memory units may be used. If a RAM is used, the table <b>1</b>A is freely rewritable.</p>
<p id="p-0064" num="0063">Consequently, the ejecting positions can be changed to any positions. For example, for ejecting a plurality of droplets, all of the droplets can be ejected in a non-consecutive manner. In other words, each pixel can be drawn by ejecting a plurality of droplets to the corresponding pixel range in a discrete manner.</p>
<p id="p-0065" num="0064">The converter <b>2</b> refers to the table <b>1</b>A so as to convert gray-scale data S<b>1</b> corresponding to a pixel to an ejection pattern data S<b>2</b>. The ejection pattern data S<b>2</b> is read by the converter <b>2</b> based on the gray-scale data S<b>1</b> as input data. The read ejection pattern data S<b>2</b> is sent to an ejection driver.</p>
<p id="p-0066" num="0065">The ejection driver heats a heater element to form a bubble in the liquid. This generates a pressure, thus ejecting a droplet. Alternatively, the ejection driver controls expansion and contraction of a piezoelectric element to eject a droplet.</p>
<p id="p-0067" num="0066">Referring to <figref idref="DRAWINGS">FIG. 2</figref>, another example of an ejection control device according to the present invention is illustrated. Similar to the example in <figref idref="DRAWINGS">FIG. 1</figref>, the memory <b>1</b> stores tables and may be a ROM, a RAM, or other storing units.</p>
<p id="p-0068" num="0067">In this example, the memory <b>1</b> stores multiple types of tables. Referring to <figref idref="DRAWINGS">FIG. 2</figref>, n types of tables <b>1</b>A<b>1</b>, <b>1</b>A<b>2</b>, . . . , <b>1</b>An are stored in the memory <b>1</b>, n being a positive integer equal to or greater than 2. Each table has at least one correspondence relationship between a gray-scale-level data item and an ejection pattern different from another table.</p>
<p id="p-0069" num="0068">For example, an ejecting position of a droplet (ejection sub-period) in a gray-scale-level data item PNM<b>1</b>, in which one droplet is to be ejected, in one table is different from that of another table. This means that even if the same gray-scale data items are input, the ejecting positions of droplets are different depending on the types of tables used. Accordingly, based on the selection and adjustment of the tables, the result of the picture drawn is affected.</p>
<p id="p-0070" num="0069">A selector <b>3</b> is for selecting a table <b>1</b>Ai (i=1 to n) from the n types of tables. For example, according to the type of picture to be drawn or quality of the picture, an appropriate table can be selected. The types of pictures may be, for example, text, a photograph, a drawing, a video image, or a computer graphic image. The quality of the picture may be, for example, “bright quality”, “standard quality” or “draft quality” related to an amount or density of droplets to be ejected, or monochrome printing or color printing.</p>
<p id="p-0071" num="0070">Furthermore, the ejecting positions may be, for example, changed in a random manner or a pseudo-random manner. This prevents uneven distribution of the droplets. Moreover, this also prevents malfunction of ejection caused by the uneven distribution of the droplets.</p>
<p id="p-0072" num="0071">It is preferable that a table be selected based on a random number generated by a random-number generator. It is also preferable that a table be selected based on the position of a corresponding pixel.</p>
<p id="p-0073" num="0072">The selection of a table based on the position of a corresponding pixel is achieved by, for example, referring to an additional table containing a correspondence relationship between the position of a corresponding pixel and a table <b>1</b>Ai (i=1 to n). The correspondence relationship between the pixel position and the table <b>1</b>Ai (i=1 to n) may be provided for each pixel in the picture range. Furthermore, the picture range may be divided into sub-ranges, and a table may be provided for each sub-range.</p>
<p id="p-0074" num="0073">Furthermore, for each input of gray-scale data, the tables may be switched in a routine manner based on the arranged order. Furthermore, the tables may be switched in a periodical manner based on a predetermined order. Consequently, the switching of the tables may be performed for every pixel or for every group of pixels. By switching the tables for every pixel or every group of pixels, a similar effect as to where the tables are switched in a random manner or pseudo-random manner can be achieved.</p>
<p id="p-0075" num="0074">In this case, the converter <b>2</b> refers to the table <b>1</b>Ai (i=1 to n) selected by the selector <b>3</b> so as to convert gray-scale data of a pixel to a corresponding ejection pattern. The example in <figref idref="DRAWINGS">FIG. 2</figref> is different from the example in <figref idref="DRAWINGS">FIG. 1</figref> in that a table used as a reference may be different for each conversion process of gray-scale data.</p>
<p id="p-0076" num="0075">A compensation technique for malfunctional nozzles that cannot eject droplets will now be described. In such a technique, nozzles adjacent to the malfunctional nozzles are used as compensation nozzles. In detail, for example, by providing compensation data for adjacent nozzles that function properly, or by doubling the number of data for the non-ejecting portions, the non-ejecting sections can be made noticeable.</p>
<p id="p-0077" num="0076">An ejection control device for controlling droplet-ejection in a liquid-ejecting apparatus will now be described with reference to <figref idref="DRAWINGS">FIG. 9</figref>. The ejection control device includes an ejection head which is capable of ejecting droplets in a deflective manner from one nozzle to multiple pixel ranges.</p>
<p id="p-0078" num="0077">The ejection control device includes a determiner <b>101</b> for determining the ejecting position, and a converter <b>102</b> for converting gray-scale data to ejection pattern data by referring to a table.</p>
<p id="p-0079" num="0078">The determiner <b>101</b> determines whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection. Such determination is for performing different control operation for a pixel not affected by malfunction of ejection and a pixel affected by malfunction of ejection.</p>
<p id="p-0080" num="0079">Nozzles determined to be malfunctional include ones that cannot eject droplets at all and ones that cannot ejection droplets in the proper direction.</p>
<p id="p-0081" num="0080">A pixel affected by malfunction of ejection is explicitly a pixel originally subject to droplet ejection with a nozzle determined to be malfunctional. Here, a pixel facing a malfunctional nozzle corresponds to a pixel to which a droplet is ejected in a deflective manner.</p>
<p id="p-0082" num="0081">Specifically, referring to <figref idref="DRAWINGS">FIG. 10</figref>, pixel ranges N and (N+1) correspond to each other. In <figref idref="DRAWINGS">FIG. 10</figref>, reference numeral “0” indicates that a droplet is not to be deflected, and reference numeral “+1” indicates that a droplet is to be deflected.</p>
<p id="p-0083" num="0082">In this case, if a nozzle N is malfunctional, the pixel range (N+1), to which a droplet is to be ejected from the nozzle N, corresponds to a pixel affected by malfunction of ejection. <figref idref="DRAWINGS">FIG. 10</figref> illustrates a state where a droplet is deflected towards the right of the drawing.</p>
<p id="p-0084" num="0083">Moreover, a droplet can be ejected to a position corresponding to two or more pixels away from a nozzle. Furthermore, a droplet can be deflected towards the left of the drawing. In that case, reference numeral “−1” is given as the ejecting direction. Alternatively, droplets may be deflected in both left and right directions.</p>
<p id="p-0085" num="0084">The converter <b>102</b> selects one of two types of tables based on the determination result by the determiner <b>101</b>. The converter <b>102</b> then converts the gray-scale data to ejection pattern data based on the selected table. Here, if the gray-scale data subject to conversion corresponds to a pixel not affected by malfunction of ejection, the converter <b>102</b> refers to a first table <b>103</b> for the corresponding pixel so as to convert the gray-scale data to appropriate ejection pattern data.</p>
<p id="p-0086" num="0085">Furthermore, if the gray-scale data subject to conversion corresponds to a pixel affected by malfunction of ejection, the converter <b>102</b> refers to a second table <b>104</b> having ejection data bits arranged in a manner such that droplets are to be ejected only from nozzles functioning properly. Thus, the converter <b>102</b> converts the gray-scale data to appropriate ejection pattern data based on the second table <b>104</b>.</p>
<p id="p-0087" num="0086">In other words, the converter <b>102</b> refers to one of different types of tables, i.e. a table corresponding to a pixel drawn only through a normal nozzle (which will be referred to as a table for normal nozzles hereinafter) and a table corresponding to a pixel affected by malfunction of ejection (which will be referred to as a table for malfunction-related nozzles hereinafter), so as to convert the gray-scale data to appropriate ejection pattern data.</p>
<p id="p-0088" num="0087">In that case, gray-scale data corresponding to a malfunction-related nozzle is converted such that droplets can be ejected in a deflective manner only through normal nozzles. Thus, a pixel can be drawn to a desired gray-scale level at its original position while being not affected by the malfunction of ejection.</p>
<p id="p-0089" num="0088">For example, referring to <figref idref="DRAWINGS">FIG. 10</figref>, if the nozzle N is malfunctional, the nozzle N is not used for ejecting droplets to the pixel ranges N and (N+1). In other words, with respect to the pixel range N, a desired gray-scale expression can be achieved by ejecting a droplet from a nozzle (N−1). Moreover, with respect to the pixel range (N+1), a desired gray-scale expression can be achieved only by ejecting a droplet from the nozzle (N+1).</p>
<p id="p-0090" num="0089">Furthermore, it is preferable that the second table <b>104</b> includes a table component <b>104</b>A for a nozzle determined to be malfunctional, and a table component <b>104</b>B for nozzles adjacent to the malfunctional nozzle in the deflecting direction.</p>
<p id="p-0091" num="0090">Moreover, if one of the first and second tables <b>103</b> and <b>104</b> includes multiple types of table components, it is preferable that the ejection control device be provided with a selector for selecting one of the table components for gray-scale data conversion.</p>
<p id="p-0092" num="0091">According to the present invention, ejection pattern data corresponding to the input gray-scale data can be output based on the correspondence relationship in the table. Moreover, according to the table, easy and accurate setting for the ejecting positions of droplets and for the ejection timing can be achieved. Furthermore, a droplet to be originally ejected from a malfunctional nozzle can be ejected in a deflective manner from a normal nozzle. Accordingly, all pixels can be expressed with desired gray-scale levels, or with practically sufficient quality.</p>
<p id="p-0093" num="0092">Using a printer for ejecting ink droplets as an example, embodiments of a liquid-ejecting apparatus will be described. The essential features not specified in the present specification or in the drawings are selected from known ones in the technical field of the present invention.</p>
<p id="p-0094" num="0093">In the descriptions below, the embodiments are realized by hardware, but software equivalent to such hardware may be used in place of the hardware.</p>
<p id="p-0095" num="0094">In the embodiments described below, in a case where the present invention is used as a computer program, the program is stored in a recording medium which can be read by a computer.</p>
<p id="p-0096" num="0095">Such a recording medium may be, for example, a magnetic recording medium, such as a magnetic disk (flexible disk or hard disk) or a magnetic tape. Alternatively, the recording medium may be, for example, an optical recording medium, such as an optical disk, an optical tape, or a bar-code which can be read by a machine. Furthermore, the recording medium may alternatively be a semiconductor memory unit, such as a random-access-memory (RAM) or a read-only-memory (ROM); or other physical units or media used for storing computer programs.</p>
<p id="p-0097" num="0096">In a case where the present invention is realized by hardware, an application specific integrated circuit (ASIC) or other known units in the technical field of the present invention may be used.</p>
<heading id="h-0005" level="1">1. First Embodiment</heading>
<p id="p-0098" num="0097">1-1. Circuit</p>
<p id="p-0099" num="0098"><figref idref="DRAWINGS">FIG. 3</figref> is a circuit diagram of a signal processing unit according to a first embodiment of the present invention. The signal processing unit includes three main components, that is, a digital-signal processor (DSP) <b>11</b>, a head controller <b>12</b>, and head chips <b>13</b>.</p>
<p id="p-0100" num="0099">The DSP <b>11</b> receives 8-bit image data, performs multilevel error diffusion on the image data, and then converts the 8-bit image data to 4-bit gray-scale data. The gray-scale data includes information for determining the number of droplets per pixel. According to the first embodiment, one pixel corresponds to a maximum of 8 droplets.</p>
<p id="p-0101" num="0100">The gray-scale data is transferred by DMA (direct memory access) to the head controller <b>12</b>. In detail, the gray-scale data is transferred in sequence as 4-bit data in a range of 0 to 7 for every pixel, i.e. dot, from the first address to the n-th address corresponding to the width of the head.</p>
<p id="p-0102" num="0101">A pulse number modulator (PNM) <b>12</b>A converts the input 4-bit gray-scale data to 8-bit ejection-pattern data by referring to an ejection-pattern memory <b>12</b>B. Each bit in the ejection-pattern data corresponds to one ejection sub-period in a drawing period. In the first embodiment, a drawing period for one pixel includes eight ejection sub-periods.</p>
<p id="p-0103" num="0102">The ejection-pattern memory <b>12</b>B contains a look-up table <b>12</b>B<b>1</b>. <figref idref="DRAWINGS">FIG. 4</figref> illustrates an example of a look-up table <b>12</b>B<b>1</b> for gray-scale data conversion. According to this table <b>12</b>B<b>1</b>, the row addresses correspond to the gray-scale data. The gray-scale data includes first to ninth gray-scale-level data items, namely, a first gray-scale-level data item in which no droplets are ejected in a drawing period of one pixel, a second gray-scale-level data item for discharging one droplet in a drawing period of one pixel, a third gray-scale-level data item for discharging two droplets in a drawing period of one pixel, and so on.</p>
<p id="p-0104" num="0103">In <figref idref="DRAWINGS">FIG. 4</figref>, the first gray-scale-level data item is indicated by PNM<b>0</b>, the second gray-scale-level data item is indicated by PNM<b>1</b>, . . . , and the ninth gray-scale-level data item is indicated by PNM<b>8</b>. The number following PNM indicates the number of droplets included in one pixel.</p>
<p id="p-0105" num="0104">Each bit address in the columns in the table <b>12</b>B<b>1</b> corresponds to one of the eight ejection sub-periods in a drawing period of one pixel. In other words, a first column address corresponds to a first ejection sub-period, a second column address corresponds to a second ejection sub-period, a third column address corresponds to a third ejection sub-period, . . . , and an eighth column address corresponds to an eighth ejection sub-period. Consequently, each ejection data bit “0” or “1” in the corresponding column address indicates whether or not a droplet is to be ejected in the corresponding ejection sub-period.</p>
<p id="p-0106" num="0105">In <figref idref="DRAWINGS">FIG. 4</figref>, each ejection data bit “0” indicates that no droplet is to be ejected, and each ejection data bit “1” indicates that a droplet is to be ejected. For example, in the first gray-scale-level data item PNM<b>0</b>, no droplets are to be ejected. This means that all ejection data bits in the first gray-scale-level data item PNM<b>0</b> are set at “0”. Accordingly, the first gray-scale-level data item PNM<b>0</b> is given an ejection pattern “00000000”.</p>
<p id="p-0107" num="0106">Moreover, in the second gray-scale-level data item PNM<b>1</b>, for example, one droplet is to be ejected. This means that seven of the column addresses are given the ejection data bits “0”, and one of the column addresses is given the ejection data bit “1”. In <figref idref="DRAWINGS">FIG. 4</figref>, one droplet is to be ejected in the sixth ejection sub-period of the second gray-scale-level data item PNM<b>1</b>. Consequently, the second gray-scale-level data item PNM<b>1</b> is given an ejection pattern “00000100”.</p>
<p id="p-0108" num="0107">Droplets can be ejected in other ejection sub-periods by providing an ejection pattern containing an ejection data bit “1” in the desired ejection sub-period for droplet-ejection. Accordingly, the ejection timing and position of each droplet are determined based on where the corresponding ejection data bit “1” is written.</p>
<p id="p-0109" num="0108">Furthermore, in <figref idref="DRAWINGS">FIG. 4</figref>, the third gray-scale-level data item PNM<b>2</b> is given an ejection pattern “00001100”, and the fourth gray-scale-level data item PNM<b>3</b> is given an ejection pattern “00001110”. Similarly, for the remaining gray-scale-level data items, each data item is provided with an ejection pattern containing one ejection data bit “1” more than its previous data item. In <figref idref="DRAWINGS">FIG. 4</figref>, when the latter half of the sub-periods in one of the data items is completely filled with the ejection data bits “1”, a new ejection data bit “1” is added to one of the sub-periods in the front half of the subsequent data item. The ninth gray-scale-level data item PNM<b>8</b> is given an ejection pattern “11111111” in which all ejection data bits are set at “1”.</p>
<p id="p-0110" num="0109">According to the table <b>12</b>B<b>1</b> in <figref idref="DRAWINGS">FIG. 4</figref>, the ejection pattern data for all the drawing periods is set in a manner such that the ejection data bits “1” increase asymmetrically as the gray-scale-level data items becomes higher. On the other hand, the ejection timing of the droplets can be set individually for each gray-scale-level data item. This means that the ejection timing for each gray-scale-level data item can be set in a manner such that the sub-periods in which droplets are to be ejected may be separated by one non-ejecting sub-period or multiple non-ejecting sub-periods. Moreover, it is also possible to set the ejection timing of the droplets for the front half of the sub-periods for one of the gray-scale-level data items, while setting the ejection timing of the droplets for the latter half of the sub-periods for an adjacent gray-scale-level data item.</p>
<p id="p-0111" num="0110">Accordingly, the ejection data bits “1” may be set in a non-consecutive manner within the same ejection pattern, and moreover, the ejection patterns may be set in a manner such that the same ejection data bits “1” are non-consecutive between adjacent gray-scale-level data items. In contrast, such setting is difficult in conventional circuits.</p>
<p id="p-0112" num="0111">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, a buffer memory <b>12</b>C is provided for temporarily storing ejection pattern data sent from the PNM <b>12</b>A. The buffer memory <b>12</b>C has a double buffer structure that includes a RAM (random access memory) <b>1</b> and a RAM <b>2</b>. One of the RAMs <b>1</b> and <b>2</b> inputs ejection pattern data while the other reads the ejection pattern data.</p>
<p id="p-0113" num="0112">The RAMs <b>1</b> and <b>2</b> each have a memory capacity sufficient for storing ejection pattern data corresponding to the drawing range of each head chip <b>13</b>. For example, in a case where a line head having nozzles aligned thereon is used, the number of row addresses provided is set to be more than the number of nozzles provided in each head chip <b>13</b> to be driven. Furthermore, in a case where the head chips <b>13</b> reciprocate, the number of row addresses provided is set to be more than the number of pixels to be drawn in a single scan period.</p>
<p id="p-0114" num="0113">On the other hand, the number of column addresses provided is sufficient for recording an ejection pattern corresponding to each pixel. In the first embodiment, the number of column addresses provided corresponds to 8 bits.</p>
<p id="p-0115" num="0114">Alternatively, the row addresses and the column addresses may be switched, meaning that the column addresses may correspond to the pixels and the row addresses may correspond to the ejection sub-periods.</p>
<p id="p-0116" num="0115">Referring to <figref idref="DRAWINGS">FIG. 3</figref>, a write counter <b>12</b>D is provided for generating a writing address for writing ejection pattern data in the buffer memory <b>12</b>C. Since 8-bit ejection pattern data is input to the buffer memory <b>12</b>C in a parallel manner, a row address of the corresponding pixel is generated.</p>
<p id="p-0117" num="0116">On the other hand, a read counter <b>12</b>E is provided for generating a reading address for reading ejection pattern data from the buffer memory <b>12</b>C. In detail, the read counter <b>12</b>E sequentially generates an address for reading an ejection data bit for every ejection sub-period.</p>
<p id="p-0118" num="0117">Each head chip <b>13</b> ejects droplets through nozzles <b>13</b>A based on the ejection data bits sent from the buffer memory <b>12</b>C. The actual ejecting process is controlled by an ejection driver <b>13</b>B.</p>
<p id="p-0119" num="0118">In detail, <figref idref="DRAWINGS">FIG. 3</figref> illustrates an example in which a line head has a plurality of nozzles <b>13</b>A aligned in a direction perpendicular to the relative moving direction between the line head and the object to be drawn upon. Such a line head is a fixed head.</p>
<p id="p-0120" num="0119">Alternatively, the first embodiment may be applied to a case where a line head reciprocates in a direction (secondary scanning direction) perpendicular to the relative moving direction (main scanning direction) between the line head and the object to be drawn upon. In that case, the ejection data bits of multiple ejection sub-periods are sent to each head chip <b>13</b> in a parallel manner.</p>
<p id="p-0121" num="0120">Furthermore, the head chips <b>13</b> may alternatively be used in a non-line head having one nozzle or multiple nozzles, such that the head reciprocates in the secondary scanning direction. In that case, an ejection pattern is given in which each scan period corresponds to one ejection sub-period.</p>
<p id="p-0122" num="0121">1-2. Operation</p>
<p id="p-0123" num="0122">The operation of the signal processing unit shown in <figref idref="DRAWINGS">FIG. 3</figref> will now be described. First, the DSP <b>11</b> performs multilevel error diffusion on image data or text data to be drawn so as to produce gray-scale data for each pixel. The gray-scale data is then transferred to the PNM <b>12</b>A in the head controller <b>12</b>.</p>
<p id="p-0124" num="0123">While referring to the table <b>12</b>B<b>1</b> in the ejection-pattern memory <b>12</b>B, the PNM <b>12</b>A converts the gray-scale data to ejection pattern data. For example, if the gray-scale data corresponds to the first gray-scale-level data item, an ejection pattern “00000000” is output. If the gray-scale data corresponds to the second gray-scale-level data item, an ejection pattern “00001100” is output.</p>
<p id="p-0125" num="0124">The converted ejection pattern data is input to the buffer memory <b>12</b>C as 8-bit parallel data. Here, the ejection pattern data is alternately input to the RAMs <b>1</b> and <b>2</b> of the double buffer. For example, when the ejection pattern data is read from RAM <b>1</b>, the ejection pattern data is written into RAM <b>2</b>. Thus, ejection data bits in the same drawing period are read from the RAM <b>1</b> in a serial manner.</p>
<p id="p-0126" num="0125">The read ejection data bits are sent to the ejection driver <b>13</b>B of the corresponding head chip <b>13</b>. The ejection driver <b>13</b>B controls whether to eject or not to eject a droplet based on each ejection data bit. For example, the ejection driver <b>13</b>B controls the supply of current to a heater element if the droplet ejection is performed based on expansion of bubbles. Moreover, if the droplet ejection is performed based on expansion and contraction of a piezoelectric element, for example, the ejection driver <b>13</b>B controls such expansion and contraction.</p>
<p id="p-0127" num="0126">Thus, a pattern image formed of pixels having desired gray scale levels is drawn onto the object.</p>
<p id="p-0128" num="0127">1-3. Advantages of First Embodiment</p>
<p id="p-0129" num="0128">According to the signal processing unit of the first embodiment, the look-up table <b>12</b>B<b>1</b> stored in the ejection-pattern memory <b>12</b>B allows the gray-scale data to be converted to desired ejection pattern data. The look-up table <b>12</b>B<b>1</b> provides an extensive range of ejection patterns that can actually be drawn. For example, the droplets can be ejected in a non-consecutive manner.</p>
<p id="p-0130" num="0129">Furthermore, although the gray-scale level data items change at a constant rate or at a gradual rate within a certain range, the ejection data bits in the ejection patterns between different gray-scale level data items, for example, may be set in a non-consecutive manner. This allows distributed use of the nozzles for the droplet ejection. As a result, sufficient time required for refilling the liquid after each ejection process can be provided, thus improving the quality of the drawn image. Moreover, this prevents the quality of the drawn image from deteriorating, which may be caused by vibration of the housing.</p>
<p id="p-0131" num="0130">Furthermore, the first embodiment is capable of complying with system changes. For example, for changing the ejection pattern data, the only requirement is to rewrite the table <b>12</b>B<b>1</b>. Specifically, in a case where the ejection timing of droplets in each gray-scale-level data item is to be changed, or the number of droplets or the number of sub-periods per pixel is to be readjusted, such compliance with system changes can readily be performed by rewriting the table <b>12</b>B<b>1</b>.</p>
<heading id="h-0006" level="1">2. Second Embodiment</heading>
<p id="p-0132" num="0131">2-1. Circuit</p>
<p id="p-0133" num="0132"><figref idref="DRAWINGS">FIG. 5</figref> is a circuit diagram of a signal processing unit according to a second embodiment of the present invention. The signal processing unit in <figref idref="DRAWINGS">FIG. 5</figref> similarly has three components, namely, the DSP <b>11</b>, the head controller <b>12</b>, and the head chips <b>13</b>. However, the internal structure of the head controller <b>12</b> in the second embodiment is different from that of the first embodiment. Accordingly, the differences in the internal structure of the head controller <b>12</b> will be described below.</p>
<p id="p-0134" num="0133">The second embodiment has two main features. One is that a plurality of look-up tables <b>12</b>B<b>1</b> to <b>12</b>Bn for gray-scale data conversion is stored in the ejection-pattern memory <b>12</b>B. The other is that the head controller <b>12</b> is provided with a table-selector <b>12</b>F for selecting one of the look-up tables <b>12</b>Bi (i=1 to n).</p>
<p id="p-0135" num="0134">Other elements in the head controller <b>12</b>, such as the PNM <b>12</b>A, the buffer memory <b>12</b>C, the write counter <b>12</b>D, and the read counter <b>12</b>E, are equivalent to those in the first embodiment, and descriptions of those elements will thus be omitted. Accordingly, the second embodiment will be described by only pointing out the distinctive features.</p>
<p id="p-0136" num="0135"><figref idref="DRAWINGS">FIG. 6</figref> illustrates examples of look-up tables stored in the ejection-pattern memory <b>12</b>B. In detail, <figref idref="DRAWINGS">FIG. 6</figref> illustrates a state where n look-up tables are stored in the ejection-pattern memory <b>12</b>B, n being a positive integer equal to or greater than two. The ejection data bits in each gray-scale-level data item in one table are arranged differently from those in the corresponding data item of another table. It is preferable that the tables have different arrangement characteristics of the ejection patterns from one another. In other words, each table preferably has a distinctive arrangement characteristic of the ejection patterns.</p>
<p id="p-0137" num="0136">For example, the tables <b>1</b> and <b>2</b> in <figref idref="DRAWINGS">FIG. 6</figref> have distinctive characteristics in the ejection patterns of the lower gray-scale-level data items, i.e. PNM<b>1</b> to PNM <b>4</b>. In detail, in table <b>1</b>, the droplet ejection is concentrated in the latter half of the sub-periods in the lower gray-scale data items. In table <b>2</b>, the droplet ejection is concentrated between the front half and the central portion of the sub-periods. On the other hand, in table n, the timing of the droplet ejection is distributed in a discrete manner. Moreover, the droplet ejection is concentrated in the front half and the latter half of the sub-periods in the lower gray-scale-level data items. The tables in <figref idref="DRAWINGS">FIG. 6</figref> are examples in which the consecutiveness of the same ejection data bits is permitted between ejection patterns of different gray-scale-level data items.</p>
<p id="p-0138" num="0137">Alternatively, such consecutiveness of the same ejection data bits is not necessarily required in the second embodiment. In the second embodiment, however, the switching of the tables is done frequently to prevent the same ejection pattern from being used repeatedly. With respect to the ejection patterns corresponding to the same gray-scale-level data items between different tables, such consecutiveness of the same ejection data bits can generally be lowered by providing a larger number of stored tables. However, since the combination of the tables can be freely selected, it is difficult to state the general characteristics.</p>
<p id="p-0139" num="0138">The table-selector <b>12</b>F is for serially selecting a table to be used by the PNM <b>12</b>A. According to the second embodiment, the selection of the tables by the table-selector <b>12</b>F is performed based on the position of the corresponding pixel. In order to achieve this, look-up tables <b>12</b>F<b>1</b> are provided. <figref idref="DRAWINGS">FIGS. 7A and 7B</figref> illustrate examples of the look-up tables <b>12</b>F<b>1</b> for table selection. The row addresses and the column addresses in <figref idref="DRAWINGS">FIGS. 7A and 7B</figref> correspond to a range of pixels drawn by the corresponding head chip <b>13</b> to be driven.</p>
<p id="p-0140" num="0139">In a case where a sufficient number of tables for gray-scale data conversion is provided for all the pixels in the drawing range, one of the look-up tables <b>12</b>F<b>1</b> for table selection allocates an appropriate table for gray-scale data conversion for each pixel in the drawing range. Such allocation of a table is performed in a manner such that the table is not used repeatedly. On the other hand, the look-up table <b>12</b>F<b>1</b> can also allocate the same table for gray-scale data conversion for pixels located distant from each other within the same drawing range.</p>
<p id="p-0141" num="0140">Generally, as shown in <figref idref="DRAWINGS">FIGS. 7A and 7B</figref>, each look-up table <b>12</b>F<b>1</b> is formed of basic table units disposed in a repeated manner and each corresponding to a number of pixels. One of the basic table units is indicated by a section surrounded by a bold line. Specifically, <figref idref="DRAWINGS">FIG. 7A</figref> illustrates an example in which the basic table units are each composed of two rows by two columns and are disposed in a repeated manner. On the other hand, <figref idref="DRAWINGS">FIG. 7B</figref> illustrates an example in which the basic table units are each composed of three rows by three columns and are also disposed in a repeated manner.</p>
<p id="p-0142" num="0141">Referring to the look-up table <b>12</b>F<b>1</b> of <figref idref="DRAWINGS">FIG. 7A</figref>, for a pixel corresponding to a position at row <b>1</b> and column <b>1</b>, the table <b>1</b> is given for gray-scale data conversion. Furthermore, for a pixel corresponding to a position at row <b>2</b> and column <b>2</b>, a table n is given for gray-scale data conversion. According to this example, adjacent pixels are given different types of tables for gray-scale data conversion.</p>
<p id="p-0143" num="0142">The same applies to an example of the table <b>12</b>F<b>1</b> shown in <figref idref="DRAWINGS">FIG. 7B</figref>. However, according to the table <b>12</b>F<b>1</b> in <figref idref="DRAWINGS">FIG. 7B</figref>, the same type of tables appear in a repeated manner periodically in the column direction.</p>
<p id="p-0144" num="0143">Alternatively, by storing only the basic table units in the table-selector <b>12</b>F, the positional information in one of the basic table units corresponding to a pixel address may be read. For example, by determining a residue group having modulo <b>2</b>, the addresses in each basic table unit may correspond to the row and column addresses.</p>
<p id="p-0145" num="0144">Although the basic table units in the second embodiment are each composed of a square matrix having m rows by m columns, m being a positive integer equal to or greater than two, the composition of the basic table units is not limited to such a matrix. For example, each of the basic table units may alternatively be composed of a rectangular matrix in which the number of rows is greater than the number of columns, or vice versa. As a further alternative, although the control operation may become more complicated, each of the basic table units may be composed of a polygonal matrix having, for example, a substantially rhomboidal shape. In such a case, each rhomboidal-shaped basic table unit may be used as a correspondence between a pixel and the corresponding table for gray-scale data conversion.</p>
<p id="p-0146" num="0145">2-2. Operation</p>
<p id="p-0147" num="0146">The operation of the signal processing unit shown in <figref idref="DRAWINGS">FIG. 5</figref> will now be described. First, the DSP <b>11</b> performs multilevel error diffusion on image data or text data to be drawn so as to produce gray-scale data for each pixel. The gray-scale data is then transferred to the PNM <b>12</b>A in the head controller <b>12</b>.</p>
<p id="p-0148" num="0147">The PNM <b>12</b>A then sends the gray-scale data to the table-selector <b>12</b>F. The table-selector <b>12</b>F detects the position of each pixel by, for example, counting the number of inputs of the gray-scale data. When the position of each pixel is detected, the table-selector <b>12</b>F refers to the look-up table <b>12</b>F<b>1</b> so as to select an appropriate table for gray-scale data conversion based on the position of each pixel. For example, a look-up table n is selected.</p>
<p id="p-0149" num="0148">When the table for gray-scale data conversion is selected, the gray-scale data is sent to the selected table. Thus, the PNM <b>12</b>A reads the ejection pattern data corresponding to the gray-scale data. This reading process by the PNM <b>12</b>A is performed by sending determination data for the tables <b>12</b>B<b>1</b> to <b>12</b>Bn and the gray-scale data to the tables <b>12</b>B<b>1</b> to <b>12</b>Bn as input addresses so as to read the corresponding ejection pattern data. Alternatively, for example, a switch may be used to select a table for gray-scale data conversion. In this case, the selected table for the gray-scale data conversion connected via the switch is used to read the corresponding ejection pattern data.</p>
<p id="p-0150" num="0149">The process after reading the ejection pattern data is the same as in the first embodiment, and the description of such a process will thus be omitted.</p>
<p id="p-0151" num="0150">2-3. Advantages of Second Embodiment</p>
<p id="p-0152" num="0151">According to the signal processing unit of the second embodiment, the look-up tables for gray-scale data conversion can be switched according to the position of each pixel. Consequently, different types of tables for gray-scale data conversion are used for the pixels in a periodical manner. According to the second embodiment, even when data items of the same gray-scale level are input repeatedly, various types of ejection patterns can be output.</p>
<p id="p-0153" num="0152">For example, even if the gray-scale-level data items PNM<b>1</b> are repeatedly input, the ejecting positions are discretely distributed. This achieves, for example, smoother refilling of liquid after each droplet ejection process, and moreover, prevents the droplet ejection from being adversely affected by vibration of the housing of a printer, i.e. a liquid-ejecting apparatus.</p>
<p id="p-0154" num="0153">In contrast, droplets are repeatedly ejected from the same position if the ejecting positions are not discretely distributed. This may adversely affect the refilling of liquid after each droplet ejection, and thus may lead to deterioration of picture quality. Moreover, if the droplets are repeatedly ejected from the same position, the deviation of droplets from the original ejecting position due to vibration of the housing may become noticeable.</p>
<heading id="h-0007" level="1">3. Third Embodiment</heading>
<p id="p-0155" num="0154">3-1. Circuit</p>
<p id="p-0156" num="0155"><figref idref="DRAWINGS">FIG. 8</figref> is a circuit diagram of a signal processing unit according to a third embodiment of the present invention. The signal processing unit in <figref idref="DRAWINGS">FIG. 8</figref> similarly has three components, namely, the DSP <b>11</b>, the head controller <b>12</b>, and the head chips <b>13</b>. However, the internal structure of the head controller <b>12</b> in the third embodiment is different from those of the first and second embodiments. Accordingly, the differences in the internal structure of the head controller <b>12</b> will be described below.</p>
<p id="p-0157" num="0156">The third embodiment is basically a modification of the second embodiment. Specifically, the third embodiment is similar to the second embodiment in that the plurality of look-up tables <b>12</b>B<b>1</b> to <b>12</b>Bn for gray-scale data conversion is stored in the ejection-pattern memory <b>12</b>B and that the head controller <b>12</b> is provided with the table-selector <b>12</b>F for selecting one of the look-up tables <b>12</b>Bi (i=1 to n).</p>
<p id="p-0158" num="0157">On the other hand, the third embodiment is different from the second embodiment in that a random-number generator <b>12</b>G for generating a random number in synchronization with each input of gray-scale data is provided. Based on the generated random number, one of the tables <b>12</b>Bi (i=1 to n) for gray-scale data conversion is selected. In other words, according to the third embodiment, the selection of one table <b>12</b>Bi is performed regardless of the position of each pixel.</p>
<p id="p-0159" num="0158">Here, the random-number generator <b>12</b>G may alternatively be a pseudo-random number generator as long as the output interval of the same values is long enough with respect to the drawing range.</p>
<p id="p-0160" num="0159">Furthermore, it is preferable that the random numbers generated correspond to the number of the tables <b>12</b>Bi (i=1 to n) provided. Alternatively, in a case where a larger amount of random numbers are to be generated, for example, an allocation to one of the tables can be performed by determining a residue group having modulo n, n being the number of tables provided.</p>
<p id="p-0161" num="0160">3-2. Operation</p>
<p id="p-0162" num="0161">The operation of the signal processing unit shown in <figref idref="DRAWINGS">FIG. 8</figref> will now be described. First, the DSP <b>11</b> performs multilevel error diffusion on image data or text data to be drawn so as to produce gray-scale data of each pixel. The gray-scale data is then transferred to the PNM <b>12</b>A in the head controller <b>12</b>.</p>
<p id="p-0163" num="0162">The PNM <b>12</b>A then sends the gray-scale data to the table-selector <b>12</b>F. Here, a random number generated by the random-number generator <b>12</b>G is sent to the table-selector <b>12</b>F. Based on the random number, the table-selector <b>12</b>F selects one of the tables for gray-scale data conversion.</p>
<p id="p-0164" num="0163">When the table for gray-scale data conversion is selected, the gray-scale data is applied to the table. Thus, an ejection pattern corresponding to the gray-scale data is read by the PNM <b>12</b>A. This reading process is performed in the same manner as in the second embodiment. The process after the reading of the ejection pattern is performed in the same manner as in the first embodiment, and the description will thus be omitted.</p>
<p id="p-0165" num="0164">3-3. Advantages of Third Embodiment</p>
<p id="p-0166" num="0165">According to the signal processing unit of the third embodiment, the generated random number acts as a basis for selecting an appropriate look-up table for gray-scale data conversion. Consequently, different types of tables for gray-scale data conversion are used for every pixel. Similar to the second embodiment, various types of ejection patterns can be output according to the third embodiment even when data items of the same gray-scale level are input repeatedly. This achieves stable picture quality.</p>
<p id="p-0167" num="0166">Embodiments of the present invention described below will be based on a technology of deflective-ejection of droplets. Examples of such a technology are described in detail in previous applications of the present applicant. Such applications are, for example, Japanese Patent Application No. 2002-320861, Japanese Patent Application No. 2002-320862, and Japanese Patent Application No. 2003-037343. Accordingly, redundant explanations of such a deflective-ejection technology will be omitted, and only the portions relevant to the present invention will be described below.</p>
<heading id="h-0008" level="1">4. Fourth Embodiment</heading>
<p id="p-0168" num="0167">4-1. Circuit</p>
<p id="p-0169" num="0168">A fourth embodiment according to the present invention will now be described.</p>
<p id="p-0170" num="0169"><figref idref="DRAWINGS">FIG. 11</figref> is a schematic diagram of a liquid-ejecting apparatus according to the fourth embodiment of the present invention. According to such a liquid-ejecting apparatus, the ejecting direction of droplets can be deflected by using electricity. Referring to <figref idref="DRAWINGS">FIG. 10</figref>, according to the fourth embodiment, the ejecting range of each nozzle covers two pixels. Moreover, the deflecting direction of each of the nozzles aligned on the line head is the same for all the nozzles.</p>
<p id="p-0171" num="0170">In a single ejection sub-period, which is the minimum unit in a drawing period of each pixel, droplets are ejected in a deflective manner in the same direction from all nozzles or from a pair of nozzles. Moreover, in the fourth embodiment, the deflecting direction is alternately switched for every ejection sub-period.</p>
<p id="p-0172" num="0171">The liquid-ejecting apparatus for performing such deflective ejection includes three main components, namely, a DSP <b>111</b>, a head controller <b>112</b>, and head chips <b>113</b>. The DSP <b>111</b> performs multilevel error diffusion on image data so as to produce gray-scale data. In the fourth embodiment, the DSP <b>111</b> receives 8-bit image data and converts the 8-bit image data to 4-bit gray-scale data. The gray-scale data is then output from the DSP <b>111</b>.</p>
<p id="p-0173" num="0172">The gray-scale data includes information for determining the number of droplets to be ejected towards each pixel range. Accordingly, this technique in which each pixel is expressed with a group of droplets is called pulse number modulation. The value of the gray-scale data is determined based on the gray-scale level number to be expressed. In the fourth embodiment, one pixel may include a maximum of six droplets.</p>
<p id="p-0174" num="0173">The head controller <b>112</b> converts the gray-scale data to corresponding ejection pattern data, and supplies the ejection pattern data to the corresponding head chip <b>113</b> at a predetermined timing. The head controller <b>112</b> includes a PNM <b>112</b>A, an ejection-pattern memory <b>112</b>B, a table-selector <b>112</b>C, an ejecting-position determiner <b>112</b>D, a buffer memory <b>112</b>E, a write counter <b>112</b>F, and a read counter <b>112</b>G.</p>
<p id="p-0175" num="0174">While referring to a table stored in the ejection-pattern memory <b>112</b>B, the PNM <b>112</b>A converts the gray-scale data to an appropriate ejection pattern. In the fourth embodiment, the PNM <b>112</b>A converts 4-bit gray-scale data to 8-bit ejection pattern data.</p>
<p id="p-0176" num="0175">The ejection pattern data is for determining the ejection timing of droplets. In detail, the ejection pattern data contains a series of ejection data bits for determining whether or not to eject droplets.</p>
<p id="p-0177" num="0176">For example, an ejection data bit “1” indicates that a droplet is to be ejected, and an ejection data bit “0” indicates that no droplet is to be ejected. Thus, each ejection pattern data is given a sequence of numbers “0” and “1”.</p>
<p id="p-0178" num="0177">The length of each sequence corresponds to the number of ejection sub-periods included in a drawing period of one pixel. In the fourth embodiment, a drawing period of one pixel includes eight ejection sub-periods. In this case, the length of the sequence forming each ejection pattern is “8”. Each ejection data bit is for determining whether or not to eject a droplet in the corresponding ejection sub-period.</p>
<p id="p-0179" num="0178"><figref idref="DRAWINGS">FIGS. 12A and 12B</figref> each illustrate an example of an ejection pattern. Specifically, <figref idref="DRAWINGS">FIG. 12A</figref> illustrates an ejection pattern PNM<b>1</b> corresponding to a first gray-scale-level data item. In the ejection pattern PNM<b>1</b>, a droplet is to be ejected in one of the eight ejection sub-periods. There are eight possible types of patterns for the ejection pattern PNM<b>1</b>. The sub-period in which a droplet is to be actually ejected is determined based on whichever one of the possible patterns corresponds to the first gray-scale-level data item.</p>
<p id="p-0180" num="0179">On the other hand, <figref idref="DRAWINGS">FIG. 12B</figref> illustrates an ejection pattern PNM<b>2</b> corresponding to a second gray-scale-level data item. In the ejection pattern PNM<b>2</b>, droplets are to be ejected in two of the eight ejection sub-periods. There are 28 possible types of patterns for the ejection pattern PNM<b>2</b>. As shown in <figref idref="DRAWINGS">FIG. 12B</figref>, the ejection may be performed consecutively or non-consecutively. Moreover, the sub-periods in which droplets are to be actually ejected are determined based on whichever one of the possible patterns corresponds to the second gray-scale-level data item. The same applies for other gray-scale-level data items.</p>
<p id="p-0181" num="0180">The ejection-pattern memory <b>112</b>B stores multiple types of tables which function as correspondence between the gray-scale data and the ejection pattern data. According to the fourth embodiment, two types of tables are stored in the ejection-pattern memory <b>112</b>B, namely, a table <b>112</b>B<b>1</b> for normal ejection and a table <b>112</b>B<b>2</b> for malfunction of ejection.</p>
<p id="p-0182" num="0181">There is only one type of table <b>112</b>B<b>1</b> for normal ejection. In other words, for each gray-scale data, only one ejection pattern can be read from the table <b>112</b>B<b>1</b>.</p>
<p id="p-0183" num="0182">On the other hand, the table <b>112</b>B<b>2</b> includes ejection patterns that prevent an ejection data bit “1” from being given to a nozzle that is determined to be malfunctional. According to the fourth embodiment, since the ejecting direction can be deflected in two directions, the table <b>112</b>B<b>2</b> is provided with two types of table components <b>112</b>B<b>21</b> and <b>112</b>B<b>22</b>.</p>
<p id="p-0184" num="0183">The table component <b>112</b>B<b>21</b> is provided for nozzles that are determined to be malfunctional, and the table component <b>112</b>B<b>22</b> is provided for malfunction-related nozzles.</p>
<p id="p-0185" num="0184">The term “malfunction-related nozzles” refers to nozzles which are adjacent to the malfunctional nozzles in the deflecting direction.</p>
<p id="p-0186" num="0185">The relationship between the malfunctional nozzles and the malfunction-related nozzles will now be described with reference to <figref idref="DRAWINGS">FIGS. 13</figref>, <b>14</b>A, and <b>14</b>B. <figref idref="DRAWINGS">FIG. 13</figref> illustrates a state where converted ejection pattern data is written in the buffer memory <b>112</b>E. Each of the column addresses in <figref idref="DRAWINGS">FIG. 13</figref> corresponds to one of the pixel ranges. For example, in a case where deflection control is not to be performed, droplets are ejected from a nozzle n corresponding to column address n based on an ejection pattern “00001010”. On the other hand, the row addresses in <figref idref="DRAWINGS">FIG. 13</figref> correspond to the eight ejection sub-periods.</p>
<p id="p-0187" num="0186">Reference characters PNMi (i=1 to 8) in <figref idref="DRAWINGS">FIG. 13</figref> each indicate an ejection pattern in the line direction for the corresponding ejection sub-period. Moreover, the arrows indicate the deflecting direction of ejection. The deflecting direction in <figref idref="DRAWINGS">FIG. 13</figref> is equivalent to the deflecting direction shown in <figref idref="DRAWINGS">FIG. 10</figref>. Furthermore, reference numerals “+1” and “0” each indicate the shifting direction of a corresponding read address. Such values correspond to the deflecting direction, and the relationship between the values and the deflecting direction is shown in <figref idref="DRAWINGS">FIG. 10</figref>.</p>
<p id="p-0188" num="0187">According to the fourth embodiment, each droplet ejected from the corresponding nozzle can be deflected. With respect to each nozzle, it is thus necessary to read an ejection pattern while taking into consideration the deflecting direction, as indicated by the shaded areas in <figref idref="DRAWINGS">FIG. 13</figref>. With respect to the nozzle n in <figref idref="DRAWINGS">FIG. 13</figref>, droplets are ejected based on an ejection pattern “00011110”.</p>
<p id="p-0189" num="0188">Thus, if the nozzle n is malfunctional, it is necessary to determine an ejection pattern for the corresponding pixel with respect to the gray-scale data such that the ejection data bits of all shaded areas are set at “0”.</p>
<p id="p-0190" num="0189"><figref idref="DRAWINGS">FIGS. 14A and 14B</figref> illustrate examples of the table components for deflective ejection to compensate for malfunction of ejection. <figref idref="DRAWINGS">FIG. 14A</figref> corresponds to the table component <b>112</b>B<b>21</b> for nozzles that are determined to be malfunctional. <figref idref="DRAWINGS">FIG. 14B</figref> corresponds to the table component <b>112</b>B<b>22</b> for malfunction-related nozzles. Similar to <figref idref="DRAWINGS">FIG. 13</figref>, the shaded areas in <figref idref="DRAWINGS">FIGS. 14A and 14B</figref> each indicate an ejection sub-period for droplet-ejection from a nozzle n determined to be malfunctional. As is apparent from <figref idref="DRAWINGS">FIG. 14A</figref>, the ejection data bits in all shaded areas are set at “0”. On the other hand, ejection data bits “1” are given to some sub-periods other than the shaded areas so that a gray-scale level corresponding to the gray-scale data can be expressed.</p>
<p id="p-0191" num="0190">An ejection data bit “1” can be disposed in any position within a sub-period other than the shaded areas. In the fourth embodiment, an ejection data bit “1” may be disposed in any position within half of the eight ejection sub-periods, i.e. four sub-periods.</p>
<p id="p-0192" num="0191">Accordingly, the period that can be used for gray-scale expression is limited to half the overall ejection sub-periods. For this reason, if the number of gray-scale data items exceeds such a number of the sub-periods, the number of gray-scale levels that can actually be expressed is limited to half the overall number of ejection sub-periods.</p>
<p id="p-0193" num="0192">Generally, a read-only-memory (ROM) is used for the ejection-pattern memory <b>112</b>B. Alternatively, a random-access-memory (RAM) or other semiconductor memory units may be used. In a case where a RAM is used, the tables can be freely rewritten. In other words, the ejecting positions can be changed to other desired positions. Furthermore, the ejection-pattern memory <b>112</b>B may alternatively function as a storage medium that can be detached from the liquid-ejecting apparatus.</p>
<p id="p-0194" num="0193">Based on the determination result by the ejecting-position determiner <b>112</b>D, the table-selector <b>112</b>C selects a corresponding table to be used by the PNM <b>112</b>A. The determination result is used as information for determining whether the gray-scale data subject to conversion is intended for ejection through a normal nozzle or for ejection through a malfunction-related nozzle.</p>
<p id="p-0195" num="0194">For example, in a case where the gray-scale data corresponds to a pixel that is not affected by malfunction of ejection, the table-selector <b>112</b>C selects the table <b>112</b>B<b>1</b> for normal ejection. On the other hand, for example, if the gray-scale data corresponds to a pixel that is affected by malfunction of ejection, the table-selector <b>112</b>C selects either the table component <b>112</b>B<b>21</b> or the table component <b>112</b>B<b>22</b> to compensate for the malfunction of ejection.</p>
<p id="p-0196" num="0195">According to the fourth embodiment, the table component <b>112</b>B<b>21</b> is first selected, and the table component <b>112</b>B<b>22</b> is selected in the following input of subsequent gray-scale data. This is due to the fact that, according to the deflecting direction in the fourth embodiment, a nozzle determined to be malfunctional first appears and a nozzle affected by such malfunction of ejection appears afterwards. Consequently, if the deflecting direction is opposite to that in the fourth embodiment, the selection by the table-selector <b>112</b>C correspondingly becomes opposite.</p>
<p id="p-0197" num="0196">The selection between the two table components <b>112</b>B<b>21</b> and <b>112</b>B<b>22</b> can be done by, for example, a toggle switch. Such a switch is operated based on a determination result corresponding to the gray-scale data for a pixel affected by malfunction of ejection.</p>
<p id="p-0198" num="0197">Furthermore, in a case where information regarding the malfunction of ejection is given in the determination result by the ejecting-position determiner <b>112</b>D, the selection between the two table components <b>112</b>B<b>21</b> and <b>112</b>B<b>22</b> may be made based on such information. In such a case, a selection switch that operates based on the information may be provided.</p>
<p id="p-0199" num="0198">Based on a write address generated by the write counter <b>112</b>F, the ejecting-position determiner <b>112</b>D determines whether or not gray-scale data subject to conversion corresponds to a pixel affected by malfunction of ejection. <figref idref="DRAWINGS">FIG. 15</figref> is a schematic diagram of the ejecting-position determiner <b>112</b>D. The ejecting-position determiner <b>112</b>D includes a malfunctional-position-data-memory <b>112</b>D<b>1</b> and a comparator <b>112</b>D<b>2</b>. The malfunctional-position-data-memory <b>112</b>D<b>1</b> stores information regarding the positions of pixels facing nozzles determined to be malfunctional, and information regarding the positions of pixels affected by malfunction of ejection.</p>
<p id="p-0200" num="0199">The comparator <b>112</b>D<b>2</b> compares the positional information generated by the write counter <b>112</b>F with the malfunctional-position information. When the two positional information items correspond with each other, the comparator <b>112</b>D<b>2</b> determines that the corresponding gray-scale data is affected by malfunction of ejection. On the other hand, if the two positional information items do not correspond with each other, the comparator <b>112</b>D<b>2</b> determines that the gray-scale data corresponds to a pixel subject to normal drawing operation.</p>
<p id="p-0201" num="0200">If the table-selector <b>112</b>C determines that a predetermined number of gray-scale data items following the first determination input of the gray-scale data affected by the malfunction corresponds to pixels affected by malfunction of ejection, the malfunctional-position-data-memory <b>112</b>D<b>1</b> may store only the positional information of the pixel that can be read the quickest of all the pixels affected by the malfunction.</p>
<p id="p-0202" num="0201">Accordingly, the table-selector <b>112</b>C and the malfunctional-position-data-memory <b>112</b>D<b>1</b> may make an appropriate selection based on the processing content and the memory content of each other.</p>
<p id="p-0203" num="0202">The positional information sent to the comparator <b>112</b>D<b>2</b> from the write counter <b>112</b>F is an address of an ejection sub-period previous to the sub-period of the write address sent to the buffer memory <b>112</b>E for determining the pixel position corresponding to the gray-scale data to be processed by the PNM <b>112</b>A.</p>
<p id="p-0204" num="0203">The buffer memory <b>112</b>E is for temporarily storing ejection pattern data. The buffer memory <b>112</b>E includes RAMs <b>1</b> and <b>2</b>. The ejection data bit is read from and written to the RAMs <b>1</b> and <b>2</b>. In other words, while one of the RAMs <b>1</b> and <b>2</b> performs a writing operation, the other performs a reading operation.</p>
<p id="p-0205" num="0204">The write counter <b>112</b>F generates a write address for the buffer memory <b>112</b>E and positional information for the comparator <b>112</b>D<b>2</b>. Based on the generated write address, the writing operation of ejection data bits is performed.</p>
<p id="p-0206" num="0205">The read counter <b>112</b>G generates a read address for the buffer memory <b>112</b>E. Based on the generated read address, the reading operation of ejection data bits is performed. The reading operation of an ejection data bit is performed for each ejection sub-period.</p>
<p id="p-0207" num="0206">The read counter <b>112</b>G must take into consideration the deflective ejection from a corresponding nozzle for generating a read address. <figref idref="DRAWINGS">FIG. 16</figref> is a schematic diagram of the read counter <b>112</b>G. As shown in <figref idref="DRAWINGS">FIG. 16</figref>, the read counter <b>112</b>G includes a read-address generator <b>112</b>G<b>1</b> and a read-address shifter <b>112</b>G<b>2</b> for shifting the generated read address in the deflecting direction.</p>
<p id="p-0208" num="0207">The read-address shifter <b>112</b>G<b>2</b> adds an indication value for the deflecting direction to each column address in the read address input from the read-address generator <b>112</b>G<b>1</b>. For example, if no deflection is required, an indication value “0” is added, whereas if deflection is required, an indication value “1” is added. The added result is sent to the table-selector <b>112</b>C as a new column address. On the other hand, each row address is directly output to the table-selector <b>112</b>C. <figref idref="DRAWINGS">FIG. 17</figref> is a schematic diagram of the read-address shifter <b>112</b>G<b>2</b>. An adder <b>112</b>G<b>21</b> is provided for transmitting each column address.</p>
<p id="p-0209" num="0208">Like the shaded areas in <figref idref="DRAWINGS">FIG. 13</figref>, the ejection data bits are read from the buffer memory <b>112</b>E in a zigzag manner.</p>
<p id="p-0210" num="0209">Based on the read ejection data bits, each head chip <b>113</b> ejects droplets from the corresponding nozzles. The ejection of droplets is performed by an ejection driver <b>113</b>A according to a droplet-ejecting method.</p>
<p id="p-0211" num="0210">4-2. Operation</p>
<p id="p-0212" num="0211">The operation of the liquid-ejecting apparatus shown in <figref idref="DRAWINGS">FIG. 11</figref> will now be described. First, the DSP <b>111</b> performs multilevel error diffusion on 8-bit picture data, i.e. image data or text data. According to such multilevel error diffusion, the 8-bit picture data is converted to 4-bit gray-scale data.</p>
<p id="p-0213" num="0212">The gray-scale data is sent to the table-selector <b>112</b>C via the PNM <b>112</b>A. Here, the ejecting-position determiner <b>112</b>D determines whether the gray-scale data to be processed is affected or not affected by malfunction of ejection. The determination result is sent to the table-selector <b>112</b>C.</p>
<p id="p-0214" num="0213">According to the determination result, if the gray-scale data corresponds to a pixel to be drawn only through a normal nozzle, the table-selector <b>112</b>C selects the table <b>112</b>B<b>1</b> and sends the read ejection pattern to the PNM <b>112</b>A.</p>
<p id="p-0215" num="0214">On the other hand, according to the determination result, if the gray-scale data corresponds to a pixel affected by malfunction of ejection, the table-selector <b>112</b>C first selects the table component <b>112</b>B<b>21</b> and then reads a corresponding ejection pattern. In this case, the ejection pattern shown in <figref idref="DRAWINGS">FIG. 14A</figref> is read. Subsequently, the table-selector <b>112</b>C selects the table component <b>112</b>B<b>22</b> and reads a corresponding ejection pattern. In this case, the ejection pattern shown in <figref idref="DRAWINGS">FIG. 14B</figref> is read.</p>
<p id="p-0216" num="0215">Consequently, gray-scale data corresponding to a pixel to be drawn through a normal nozzle is converted to an ejection pattern by using the table <b>112</b>B<b>1</b> for normal ejection. On the other hand, gray-scale data corresponding to a pixel that is affected by malfunction of ejection is converted to an ejection pattern by using the table component <b>112</b>B<b>21</b> and the table component <b>112</b>B<b>22</b> for compensating for the malfunction of ejection.</p>
<p id="p-0217" num="0216">Accordingly, for a malfunctional nozzle, an ejection pattern whose ejection data bits are all set at “0” is read from the buffer memory <b>112</b>E. Moreover, for a subsequent nozzle following the malfunctional nozzle, an ejection pattern that maintains the gray-scale level of the pixel corresponding to the gray-scale data is read.</p>
<p id="p-0218" num="0217">Accordingly, as long as malfunctional nozzles do not continue in a repeated manner, droplets can be ejected so as to compensate for such malfunction of ejection. As a result, the gray-scale level can be properly expressed.</p>
<p id="p-0219" num="0218"><figref idref="DRAWINGS">FIG. 18</figref> illustrates an example in which the droplet ejection can be deflected in two directions. In this case, one pixel can be drawn through two nozzles. In <figref idref="DRAWINGS">FIG. 18</figref>, every other nozzle in the line direction is determined to be malfunctional.</p>
<p id="p-0220" num="0219">Referring to <figref idref="DRAWINGS">FIG. 18</figref>, each position of a malfunctional nozzle is indicated by an “x”. Moreover, the shaded areas indicate ejection data bits to be read by the malfunctional nozzles. Each shaded area is given an ejection data bit “0”. In this case where every other nozzle is malfunctional, four pixels can be drawn, each with a maximum of four droplets, as indicated by circular dots in the drawing. The ejected position of the droplets in this case is accurate. Accordingly, if the maximum value of the gray-scale data is four, there is no deterioration of the picture quality. Furthermore, even if the maximum value of the gray-scale data exceeds the value four, a picture having a substantially equivalent gray-scale can be achieved.</p>
<p id="p-0221" num="0220">Another example will be described with reference to <figref idref="DRAWINGS">FIG. 19</figref>. The example in <figref idref="DRAWINGS">FIG. 19</figref> is similar to the above example in that the droplet ejection can be deflected in two directions. The difference is that the malfunctional nozzles continue in the line direction in a repeated manner. In this case, the same compensation process as in the example in <figref idref="DRAWINGS">FIG. 18</figref> can be performed for the two outer pixels of the three consecutive pixels. In other words, if the maximum value of the gray-scale data is four, there is no deterioration of the picture quality.</p>
<p id="p-0222" num="0221">However, the pixel in the middle cannot be compensated for since the ejection data bits for all the sub-periods are set at “0”.</p>
<p id="p-0223" num="0222">4-3. Advantages of Fourth Embodiment</p>
<p id="p-0224" num="0223">According to the liquid-ejecting apparatus of the fourth embodiment, even if some of the nozzles are malfunctional, due to ejection inability or deviation, for example, droplets can still be ejected to an accurate position to achieve the proper gray-scale.</p>
<heading id="h-0009" level="1">5. Fifth Embodiment</heading>
<p id="p-0225" num="0224">5-1. Circuit</p>
<p id="p-0226" num="0225">Referring to <figref idref="DRAWINGS">FIG. 20</figref>, a fifth embodiment of the present invention is an example in which droplets can be deflected in three directions, namely, the forward direction, the right direction, and the left direction.</p>
<p id="p-0227" num="0226">The basic structure of the fifth embodiment is the same as that of the fourth embodiment. The read-address shifter <b>112</b>G<b>2</b> adds values “−1, 0, +1, −1, 0, +1, −1, 0” to the corresponding column addresses of the read addresses generated by the read-address generator <b>112</b>G<b>1</b> so that the droplets can be ejected in the directions “left-forward-right-left-forward-right-left-forward”.</p>
<p id="p-0228" num="0227">To perform such deflection control for an n-th nozzle in <figref idref="DRAWINGS">FIG. 20</figref>, it is necessary to read an ejection pattern in which the ejection data bits correspond to the shaded areas. In other words, it is necessary to read an ejection pattern “00100010”.</p>
<p id="p-0229" num="0228">As described previously, if the n-th nozzle can function properly, there is no problem in using such an ejection pattern. However, if the n-th nozzle is determined to be malfunctional, all the ejection data bits in the shaded areas must be set at “0”.</p>
<p id="p-0230" num="0229"><figref idref="DRAWINGS">FIGS. 21A</figref>, <b>21</b>B, and <b>21</b>C each illustrate a table <b>112</b>B<b>2</b> for malfunction of ejection, which is a distinctive feature of the fifth embodiment. The table <b>112</b>B<b>2</b> includes three types of table components, namely, a table component <b>112</b>B<b>21</b>, a table component <b>112</b>B<b>22</b>, and a table component <b>112</b>B<b>23</b>.</p>
<p id="p-0231" num="0230">The table component <b>112</b>B<b>21</b> is for pixels facing malfunctional nozzles. Referring to <figref idref="DRAWINGS">FIG. 21B</figref>, an example of the table component <b>112</b>B<b>21</b> is illustrated. In this example, ejection data bits “0” are provided in sub-periods in which droplets are to be ejected to an n-th pixel through a malfunctional nozzle. Specifically, the ejection data bits in row addresses of the first, fourth, and seventh bits are set at “0”.</p>
<p id="p-0232" num="0231">Accordingly, the gray-scale expression corresponding to each gray-scale-level data item PNMi (i=1, 2, 3, 4, or 5) is achieved by using the unshaded areas in the drawing. In the case of <figref idref="DRAWINGS">FIG. 21B</figref>, the droplet-ejection corresponding to the gray-scale-level data item PNM<b>1</b> is set at the 0-th bit of the row address.</p>
<p id="p-0233" num="0232">In such a case, since there are five unshaded areas in each data item, the gray-scale expression can be properly achieved with up to a maximum of five droplets.</p>
<p id="p-0234" num="0233">The two remaining table components <b>112</b>B<b>22</b> and <b>112</b>B<b>23</b> will now be described. The table component <b>112</b>B<b>22</b> is for an (n+1)th pixel affected by malfunction of ejection. Referring to <figref idref="DRAWINGS">FIG. 21C</figref>, an example of the table component <b>112</b>B<b>22</b> is illustrated. In this example, ejection data bits “0” are provided in sub-periods in which droplets are to ejected to an (n+1)th pixel through a malfunctional nozzle. Specifically, the ejection data bits in row addresses of the second and fifth bits are set at “0”.</p>
<p id="p-0235" num="0234">In this case, the gray-scale expression corresponding to each gray-scale-level data item PNMi (i=1, 2, 3, 4, or 5) is achieved by using the unshaded areas in the drawing. In the case of <figref idref="DRAWINGS">FIG. 21C</figref>, the droplet-ejection corresponding to the gray-scale-level data item PNM<b>3</b> is performed at the 0-th bit, the first bit, and the third bit of the row addresses. Since there are six unshaded areas in each data item, the gray-scale expression can be properly achieved with up to a maximum of six droplets.</p>
<p id="p-0236" num="0235">On the other hand, the table component <b>112</b>B<b>23</b> is for an (n−1)th pixel affected by malfunction of ejection. Referring to <figref idref="DRAWINGS">FIG. 21A</figref>, an example of the table component <b>112</b>B<b>23</b> is illustrated. In this example, ejection data bits “0” are provided in sub-periods in which droplets are to ejected to an (n−1)th pixel through a malfunctional nozzle. Specifically, the ejection data bits in row addresses of the 0-th bit, the third bit, and the sixth bit are set at “0”.</p>
<p id="p-0237" num="0236">In this case, the gray-scale expression corresponding to each gray-scale-level data item PNMi (i=1, 2, 3, 4, or 5) is achieved by using the unshaded areas in the drawing. In the case of <figref idref="DRAWINGS">FIG. 21A</figref>, the droplet-ejection corresponding to the gray-scale-level data item PNM<b>2</b> is performed at the first and second bits of the row addresses. Since there are five unshaded areas in each data item, the gray-scale expression can be properly achieved with up to a maximum of five droplets.</p>
<p id="p-0238" num="0237">5-2. Operation</p>
<p id="p-0239" num="0238">The operation of the liquid-ejecting apparatus according to the fifth embodiment will now be described. The operation according to the fifth embodiment is basically the same as the fourth embodiment.</p>
<p id="p-0240" num="0239">First, the DSP <b>111</b> performs multilevel error diffusion on 8-bit picture data, i.e. image data or text data. According to such multilevel error diffusion, the 8-bit picture data is converted to 4-bit gray-scale data.</p>
<p id="p-0241" num="0240">The gray-scale data is sent to the table-selector <b>112</b>C via the PNM <b>112</b>A. Here, the ejecting-position determiner <b>112</b>D determines whether the gray-scale data to be processed corresponds to a pixel to be drawn only with a normal nozzle or to a pixel that is affected by malfunction of ejection. The determination result is sent to the table-selector <b>112</b>C.</p>
<p id="p-0242" num="0241">According to the determination result, if the gray-scale data corresponds to a pixel to be drawn only through a normal nozzle, the table-selector <b>112</b>C selects the table <b>112</b>B<b>1</b> and sends the read ejection pattern to the PNM <b>112</b>A.</p>
<p id="p-0243" num="0242">On the other hand, according to the determination result, if the gray-scale data corresponds to a pixel affected by malfunction of ejection, the table-selector <b>112</b>C first selects the table component <b>112</b>B<b>23</b> and then reads a corresponding ejection pattern. In this case, the ejection pattern shown in <figref idref="DRAWINGS">FIG. 21A</figref> is read.</p>
<p id="p-0244" num="0243">Subsequently, the table-selector <b>112</b>C selects the table component <b>112</b>B<b>21</b> and reads a corresponding ejection pattern. In this case, the ejection pattern shown in <figref idref="DRAWINGS">FIG. 21B</figref> is read. Then, the table-selector <b>112</b>C selects the table component <b>112</b>B<b>22</b> and reads a corresponding ejection pattern. In this case, the ejection pattern shown in <figref idref="DRAWINGS">FIG. 21C</figref> is read.</p>
<p id="p-0245" num="0244">Consequently, gray-scale data corresponding to a pixel to be drawn through a normal nozzle is converted to an ejection pattern by using the table <b>112</b>B<b>1</b> for normal ejection. On the other hand, gray-scale data corresponding to a pixel to be drawn originally through a malfunctional nozzle is converted to an ejection pattern by using the three table components <b>112</b>B<b>21</b> to <b>112</b>B<b>23</b> for compensating for the malfunction of ejection.</p>
<p id="p-0246" num="0245">Accordingly, for a malfunctional nozzle, an ejection pattern whose ejection data bits are all set at “0” is read from the buffer memory <b>112</b>E. Moreover, for each nozzle adjacent to the malfunctional nozzle, an ejection pattern that maintains the gray-scale level of the pixel corresponding to the gray-scale data is read.</p>
<p id="p-0247" num="0246">Accordingly, if malfunctional nozzles do not continue in a repeated manner, droplets can be ejected so as to compensate for such malfunction of ejection. As a result, the gray-scale level can be properly expressed. <figref idref="DRAWINGS">FIG. 22</figref> illustrates an example in which the droplet ejection can be deflected in three directions. In this case, one pixel can be drawn through three nozzles. In <figref idref="DRAWINGS">FIG. 22</figref>, two nozzles in the line direction are determined to be malfunctional, the two malfunctional nozzles having two normal nozzles therebetween.</p>
<p id="p-0248" num="0247">Referring to <figref idref="DRAWINGS">FIG. 22</figref>, each position of a malfunctional nozzle is indicated by an “x”. Moreover, the shaded areas indicate ejection data bits to be read by the malfunctional nozzles. Each shaded area is given an ejection data bit “0”.</p>
<p id="p-0249" num="0248">In this case where two malfunctional nozzles have two normal nozzles therebetween, six pixels can be drawn, each with a maximum of five or six droplets, as indicated by circular dots in the drawing. The ejected position of the droplets in this case is accurate. Accordingly, if the maximum value of the gray-scale data is five, there is no deterioration of the picture quality in these six pixels. Furthermore, even if the maximum value of the gray-scale data exceeds the value five, the gray-scale expression with six droplets is still possible for some of the pixels, thus achieving high picture quality.</p>
<p id="p-0250" num="0249">Another example will be described with reference to <figref idref="DRAWINGS">FIG. 23</figref>. The example in <figref idref="DRAWINGS">FIG. 23</figref> is similar to the above example in that the droplet ejection can be deflected in three directions. The difference is that every other nozzle in the line direction is determined to be malfunctional. In this case, the same compensation process as in the example in <figref idref="DRAWINGS">FIG. 22</figref> can be performed for the five consecutive pixels. However, for the pixel in the center, only a maximum of three droplets can be ejected to the pixel range to prevent the number of non-ejecting sub-periods from doubling.</p>
<p id="p-0251" num="0250">The other pixel ranges can still be expressed with a maximum of five or six droplets, thus maintaining high picture quality.</p>
<p id="p-0252" num="0251">Another example will be described with reference to <figref idref="DRAWINGS">FIG. 24</figref>. The example in <figref idref="DRAWINGS">FIG. 24</figref> is similar to the above examples in that the droplet ejection can be deflected in three directions. The difference is that the malfunctional nozzles continue in the line direction in a repeated manner. In this case, a compensation process can be performed for four consecutive pixels. However, only two outer pixels of the four consecutive pixels can achieve the gray-scale expression equivalent to the other examples. The two outer pixels can be expressed with a maximum of five or six droplets.</p>
<p id="p-0253" num="0252">However, because of the non-ejecting sub-period, only a maximum of two or three droplets can be ejected to the two inner pixels. In comparison with a case where no droplet-ejection is allowed or a case where a droplet is ejected to a wrong position, the example in <figref idref="DRAWINGS">FIG. 24</figref> can still allow droplets to be ejected to their proper positions and minimally keep the picture quality from deteriorating.</p>
<p id="p-0254" num="0253">On the other hand, if the maximum value of the gray-scale data corresponding to these pixel ranges is two, the desired gray-scale expression can be accurately achieved.</p>
<p id="p-0255" num="0254">5-3. Advantages of Fifth Embodiment</p>
<p id="p-0256" num="0255">According to the liquid-ejecting apparatus of the fifth embodiment, even if some of the nozzles are determined to be malfunctional, due to ejection inability or deviation, for example, droplets can still be ejected to an accurate position to achieve the proper gray-scale level.</p>
<heading id="h-0010" level="1">6. Sixth Embodiment</heading>
<p id="p-0257" num="0256">A sixth embodiment is an example in which droplets can be deflected in four or more directions. Similar to the above embodiments, by providing a sufficient number of table components for malfunctional nozzles to perform deflective ejection, the malfunction of ejection can be compensated for. In other words, such compensation can be achieved by ejecting droplets to each pixel range from four or more directions.</p>
<heading id="h-0011" level="1">7. Seventh Embodiment</heading>
<p id="p-0258" num="0257">7-1. Circuit</p>
<p id="p-0259" num="0258"><figref idref="DRAWINGS">FIG. 25</figref> is a schematic diagram of a liquid-ejecting apparatus according to a seventh embodiment of the present invention. The structure and operation of such a liquid-ejecting apparatus of the seventh embodiment are basically the same as those of the above embodiments.</p>
<p id="p-0260" num="0259">Referring to <figref idref="DRAWINGS">FIG. 26</figref>, the distinctive feature of the seventh embodiment is that a table <b>112</b>B<b>100</b> for normal ejection and a table <b>112</b>B<b>200</b> for malfunction-related ejection are provided. Moreover, the table <b>112</b>B<b>100</b> includes a set of table components <b>112</b>B<b>101</b> to <b>112</b>B<b>10</b>N, and the table <b>112</b>B<b>200</b> includes a set of table components <b>112</b>B<b>201</b> to <b>112</b>B<b>20</b>N.</p>
<p id="p-0261" num="0260">Each of the table components <b>112</b>B<b>101</b> to <b>112</b>B<b>10</b>N corresponds to the table <b>112</b>B<b>1</b> in the fourth embodiment, and each of the table components <b>112</b>B<b>201</b> to <b>112</b>B<b>20</b>N corresponds to the table <b>112</b>B<b>2</b> in the fourth embodiment. In the seventh embodiment, the table-selector <b>112</b>C selects one of the table components in each set. The same processes as in the above embodiments are performed for the selected table component <b>112</b>B<b>10</b><i>i </i>(i=1 to N) and table component <b>112</b>B<b>20</b><i>j </i>(j=1 to N).</p>
<p id="p-0262" num="0261">The table components <b>112</b>B<b>101</b> to <b>112</b>B<b>10</b>N for normal ejection are different from one another. In detail, each table component has at least one correspondence relationship between a gray-scale-level data item and an ejection pattern different from another table. The same applies for the table components <b>112</b>B<b>201</b> to <b>112</b>B<b>20</b>N for malfunction-related ejection.</p>
<p id="p-0263" num="0262">In the seventh embodiment, the table components <b>112</b>B<b>101</b> to <b>112</b>B<b>10</b>N and the table components <b>112</b>B<b>201</b> to <b>112</b>B<b>20</b>N are switched in a random manner for every pixel. Consequently, even if the same type of gray-scale data is input, the gray-scale data is converted to a different type of ejection pattern. According to this method, even when the same type of gray-scale data is input in a consecutive manner, the ejecting positions (or the ejection timing) are distributed in a discrete manner. This achieves, for example, smoother refilling of liquid after each droplet ejection process, and moreover, prevents the droplet ejection from being adversely affected by vibration of the housing of the liquid-ejecting apparatus.</p>
<p id="p-0264" num="0263">The selecting of the table components is performed by the table-selector <b>112</b>C. In the seventh embodiment, a random-number generator <b>112</b>C<b>1</b> is provided. A random number generated by the random-number generator <b>112</b>C<b>1</b> is used as a basis for selecting one of the table components.</p>
<p id="p-0265" num="0264">Alternatively, a table may be provided in the table-selector <b>112</b>C for selecting one of the table components <b>112</b>B<b>101</b> to <b>112</b>B<b>10</b>N and one of the table components <b>112</b>B<b>201</b> to <b>112</b>B<b>20</b>N. In this case, the table in the table-selector <b>112</b>C functions as a correspondence between a position of a pixel and one of the table components <b>112</b>B<b>101</b> to <b>112</b>B<b>10</b>N, and between a position of a pixel and one of the table components <b>112</b>B<b>201</b> to <b>112</b>B<b>20</b>N. Thus, the table-selector <b>112</b>C can select a different table component corresponding to the position of every pixel.</p>
<p id="p-0266" num="0265">Similar to the above embodiments, the positional information of each pixel may be input from the write counter <b>112</b>F. Just for reference, examples of the table used for the selection of the table components are illustrated <figref idref="DRAWINGS">FIGS. 27A and 27B</figref>. <figref idref="DRAWINGS">FIG. 27A</figref> illustrates an example in which the table is formed of basic table units each composed of two rows by two columns. On the other hand, <figref idref="DRAWINGS">FIG. 27B</figref> illustrates an example in which the table is formed of basic table units each composed of three rows by three columns.</p>
<p id="p-0267" num="0266">7-2. Operation</p>
<p id="p-0268" num="0267">The operation of the liquid-ejecting apparatus shown in <figref idref="DRAWINGS">FIG. 25</figref> will now be described. First, the DSP <b>111</b> performs multilevel error diffusion on 8-bit picture data, i.e. image data or text data. According to such multilevel error diffusion, the 8-bit picture data is converted to 4-bit gray-scale data.</p>
<p id="p-0269" num="0268">The gray-scale data is sent to the table-selector <b>112</b>C via the PNM <b>112</b>A. Here, the ejecting-position determiner <b>112</b>D determines whether the gray-scale data to be processed corresponds to a pixel to be drawn only with a normal nozzle or to a pixel that is affected by malfunction of ejection. The determination result is sent to the table-selector <b>112</b>C.</p>
<p id="p-0270" num="0269">Simultaneously, based on a random number generated by the random-number generator <b>112</b>C<b>1</b>, the table-selector <b>112</b>C selects a table component <b>112</b>B<b>10</b><i>i </i>(i=1 to N) and a table component <b>112</b>B<b>20</b><i>j </i>(j=1 to N) for gray-scale data conversion. Alternatively, two random numbers may be generated such that one corresponds to the table component for normal ejection and the other corresponds to the table component for malfunction of ejection. In the case of the seventh embodiment, a single random number is used as a basis for selecting one of the table components for normal ejection and one of the table components for malfunction of ejection.</p>
<p id="p-0271" num="0270">After the selection of the table components, the table-selector <b>112</b>C chooses one of the selected table components as a reference based on the determination result so as to read an appropriate ejection pattern corresponding to the gray-scale data. As described previously, the read ejection pattern is written into the buffer memory <b>112</b>E via the PNM <b>112</b>A.</p>
<p id="p-0272" num="0271">In such a case, for a malfunctional nozzle, an ejection pattern whose ejection data bits are all set at “0” is read. Moreover, for each of nozzles adjacent to the malfunctional nozzle, an ejection pattern that maintains the gray-scale level of the pixel corresponding to the gray-scale data is read.</p>
<p id="p-0273" num="0272">7-3. Advantages of Seventh Embodiment</p>
<p id="p-0274" num="0273">In addition to the advantages of the above embodiments, the seventh embodiment advantageously prevents uneven use of the ejection patterns.</p>
<p id="p-0275" num="0274">This prevents deterioration of picture quality caused by incomplete refilling of liquid after each droplet ejection process. Moreover, even if the ejecting direction is deviated due to vibration of the housing, the seventh embodiment prevents the deviated spots from being noticeable since the ejecting positions are discretely distributed.</p>
<p id="p-0276" num="0275">The present invention described above can be applied to a printer head that ejects ink droplets. Furthermore, the present invention can also be applied to a signal processing circuit of the printer head. Moreover, the present invention can also be applied to a printer having a printer head and to other electrical devices. The object to be drawn upon by using the printer is not limited to paper, and may alternatively be other materials, such as a plastic material or a metallic material. Furthermore, the present invention can also be applied to an inspection device that ejects test samples as droplets.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An ejection control device comprising:
<claim-text>a memory for storing multiple tables providing a correlation between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets;</claim-text>
<claim-text>a selector for selecting one of the tables; and</claim-text>
<claim-text>ejecting ink from at least one ink ejection chamber based on data from the selected table.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The ejection control device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the selector selects one of the tables based on a position of a pixel that is to be processed.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The ejection control device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the selector selects one of the tables based on a random number.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The ejection control device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein each table includes at least one ejection pattern data item in which information concerning ejection timing of droplets is non-consecutive.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The ejection control device according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the memory is rewritable such that a content of each table can be changed.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A liquid-ejecting apparatus comprising:
<claim-text>a memory storing multiple tables providing a correlation between grayscale data and ejection pattern data, the gray-scale data determining a number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level for the pixel, the ejection pattern data determining an ejection timing of droplets;
<claim-text>a selector for selecting one of the tables; and</claim-text>
</claim-text>
<claim-text>an ejection driver for ejecting droplets through a corresponding nozzle based on the ejection pattern data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method for controlling an ejecting operation, comprising the steps of:
<claim-text>selecting one of multiple tables providing a correlation between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern data item determining the ejection timing of droplets; and</claim-text>
<claim-text>converting each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the selected table.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A recording medium having recorded thereon a program implemented by a processor wherein
<claim-text>the program uses multiple types of correspondence tables providing correspondence between gray-scale data items and ejection pattern data items, each gray-scale data item determining the number of droplets to be ejected to a corresponding pixel so as to express a desired grayscale level of the pixel, each ejection pattern data item determining the ejection timing of droplets, whereby the computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the selected table.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A program controlling a computer to provide a correspondence table between gray-scale data and ejection pattern data, the gray-scale data determining a number of droplets to be ejected to a corresponding pixel so as to express a desired gray-scale level of the pixel, each ejection pattern determining the ejection timing of droplets, whereby the computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item based on the table.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A program enabling a processor controlled device to select one of multiple correspondence tables between gray-scale data items and ejection pattern data items, each gray-scale data item determining a number of droplets to be ejected to a corresponding pixel so as to express a desired grayscale level of the pixel, the ejection pattern data determining the ejection timing of droplets, whereby the computer converts each gray-scale data item of the corresponding pixel to the corresponding ejection pattern data item by referring to the selected table.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. An ejection control device for controlling ejection of droplets for a liquid-ejecting apparatus provided with an ejection head, the ejection head having nozzles each being capable of ejecting droplets to multiple pixel ranges by deflection of the droplets, the ejection control device comprising:
<claim-text>a determiner for determining whether or not each grayscale data item subject to conversion corresponds to a pixel affected by malfunction of ejection; and</claim-text>
<claim-text>a converter for converting the gray-scale data item subject to conversion to an ejection pattern data item, wherein</claim-text>
<claim-text>based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection, and</claim-text>
<claim-text>based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel affected by malfunction of ejection, the converter converts the grayscale data item to the ejection pattern data item by referring to a second table an which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The ejection control device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the second table comprises first and second table components, the first table component being used for a nozzle which is determined to be malfunctional, the second table component being used for a nozzle adjacent to the malfunctional nozzle in the deflecting direction.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The ejection control device according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein one of the first and second tables comprises multiple types of table components, and wherein the ejection control device further comprises a selector for selecting one of the table components for grayscale data conversion.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A liquid-ejecting apparatus provided with an ejection head, the ejection head having nozzles each being capable of ejecting droplets to multiple pixel ranges by deflection of the droplets, the liquid-ejecting apparatus comprising:
<claim-text>a determiner for determining whether or not a grayscale data item subject to conversion corresponds to a pixel affected by malfunction of ejection;</claim-text>
<claim-text>a converter for converting the gray-scale data item subject to conversion to an ejection pattern data item, wherein</claim-text>
<claim-text>based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection, and</claim-text>
<claim-text>based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel affected by malfunction of ejection, the converter converts the grayscale data item to the ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly; and</claim-text>
<claim-text>an ejection driver for ejecting droplets based on the ejection pattern data item via the ejection head.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method for controlling ejection of droplets for a liquid-ejecting apparatus provided with an ejection head, the ejection head having nozzles each being capable of ejecting droplets to multiple pixel ranges by deflection of the droplets, the method comprising the steps of:
<claim-text>determining whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection; and</claim-text>
<claim-text>converting the gray-scale data item subject to conversion to an ejection pattern data, wherein</claim-text>
<claim-text>based on the determination result, if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, the converter converts the gray-scale data item to the ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection, and</claim-text>
<claim-text>based on the determination result by the determiner, if the gray-scale data item corresponds to a pixel affected by malfunction of ejection, the converter converts the grayscale data item to the ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from noziles that function properly.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A recording medium having recorded thereon a program which can be implemented by a processor controlled machine, wherein the program causes the processor to determine whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection, and
<claim-text>based on the determination result, the program causes the processor to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a first table for a pixel not affected by malfunction of ejection if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, whereas the program causes the processor to convert the gray-scale data item subjece to conversion to an ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly if the gray-scale data item corresponds to a pixel affected by malfunction of ejection.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A computer program for allowing a computer to determine whether or not each gray-scale data item subject to conversion corresponds to a pixel affected by malfunction of ejection,
<claim-text>wherein based on the determination result, the program controls the computer to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a first table having data for a pixel not affected by malfunction of ejection if the gray-scale data item corresponds to a pixel not affected by malfunction of ejection, whereas the program allows the computer to convert the gray-scale data item subject to conversion to an ejection pattern data item by referring to a second table in which ejection data bits are arranged in a manner such that droplets are to be deflectively ejected only from nozzles that function properly if the gray-scale data item corresponds to a pixel affected by malfunction of ejection.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
