<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298566-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298566</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11064698</doc-number>
<date>20050223</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2004-049284</doc-number>
<date>20040225</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>260</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>27</main-group>
<subgroup>36</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>21</main-group>
<subgroup>02</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>11</class>
<subclass>B</subclass>
<main-group>15</main-group>
<subgroup>12</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>360 31</main-classification>
<further-classification>360 75</further-classification>
</classification-national>
<invention-title id="d0e71">Data storage device and control method therefor involving flying height</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5831781</doc-number>
<kind>A</kind>
<name>Okamura</name>
<date>19981100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 31</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6411458</doc-number>
<kind>B1</kind>
<name>Billings et al.</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6671110</doc-number>
<kind>B2</kind>
<name>Baba et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 31</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6956707</doc-number>
<kind>B2</kind>
<name>Ottesen et al.</name>
<date>20051000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 25</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6987628</doc-number>
<kind>B1</kind>
<name>Moline et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 31</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2002/0093753</doc-number>
<kind>A1</kind>
<name>Atsumi</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>360 7303</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2002/0176195</doc-number>
<kind>A1</kind>
<name>Fung et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>JP</country>
<doc-number>2000-195210</doc-number>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>20</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>14</number-of-drawing-sheets>
<number-of-figures>15</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050185312</doc-number>
<kind>A1</kind>
<date>20050825</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ueda</last-name>
<first-name>Tetsuo</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ishibashi</last-name>
<first-name>Kazuyuki</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ishii</last-name>
<first-name>Satoshi</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Noguchi</last-name>
<first-name>Masaaki</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Townsend and Townsend and Crew LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Duncan</last-name>
<first-name>Patrick</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Hitachi Global Storage Technologies Netherlands B.V.</orgname>
<role>03</role>
<address>
<city>Amsterdam</city>
<country>NL</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Korzuch</last-name>
<first-name>William</first-name>
<department>2627</department>
</primary-examiner>
<assistant-examiner>
<last-name>Olson</last-name>
<first-name>Jason</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Embodiments of the invention are directed to detecting an abnormality in head flying height. In one embodiment, an AGC controller establishes the gain of the reproduced signal through gain adjustment using the servo AGC of the servo signal. A digital filter performs filtering processing by use of the obtained gain data g and the gain data of previous sectors. A comparative judgment section obtains filtered gain data G from the digital filter and compares the gain data G with a reference value CRITERIA to determine whether the flying height is normal or abnormal. If the gain G is larger than the reference value CRITERIA, then the data write operation is inhibited. The filter parameters of the digital filter are programmable parameters which can be set and changed.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="106.17mm" wi="203.45mm" file="US07298566-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="218.02mm" wi="106.17mm" orientation="landscape" file="US07298566-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="215.82mm" wi="64.18mm" orientation="landscape" file="US07298566-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="151.47mm" wi="125.31mm" file="US07298566-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="217.25mm" wi="113.62mm" orientation="landscape" file="US07298566-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="214.46mm" wi="91.61mm" orientation="landscape" file="US07298566-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="203.12mm" wi="143.59mm" file="US07298566-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="113.45mm" wi="111.84mm" file="US07298566-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="178.31mm" wi="145.63mm" file="US07298566-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="143.43mm" wi="147.32mm" file="US07298566-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="141.65mm" wi="141.48mm" file="US07298566-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="162.56mm" wi="152.74mm" file="US07298566-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="129.54mm" wi="121.33mm" file="US07298566-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="147.32mm" wi="105.92mm" file="US07298566-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="106.51mm" wi="140.21mm" file="US07298566-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCES TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims priority from Japanese Patent Application No. JP2004-049284, filed Feb. 25, 2004, the entire disclosure of which is incorporated herein by reference.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a data storage device and a control method therefor, and more particularly to a data storage device which determines whether the flying height of each head is normal, and a control method therefor.</p>
<p id="p-0004" num="0003">Known data storage devices use various types of media such as optical disks and magnetic tapes. Among these data storage devices are hard disk drives (HDDs), which have been widely used as storage for computers and are now essential storage devices in computer systems. Their applications, however, are not limited to computers. Due to their superior characteristics, HDDs have found application in an increasing number of fields. For example, they have been used in video recording/reproducing apparatuses and recording/reproducing apparatuses for car navigation systems and also used as removable storage (memory) for digital cameras.</p>
<p id="p-0005" num="0004">A HDD comprises: at least one magnetic disk for storing data; at least one head device portion for writing/reading data to/from the magnetic disk; at least one slider to which the head device is fixed; and an actuator for holding the slider and moving the head device portion to a desired position over the magnetic disk. A voice coil motor rotates the actuator around a pivot so as to move the head in a radial direction over the rotating magnetic disk. This allows the head device portion to access a desired track formed on the magnetic disk to read/write data.</p>
<p id="p-0006" num="0005">The actuator has a resilient suspension to which the slider is fixed. The pressure (to the head device portion) generated due to the viscosity of the air between the rotating magnetic disk and the ABS (Air Bearing Surface) surface of the slider facing the magnetic disk balances with the pressure applied (to the head device portion) by the actuator toward the magnetic disk, causing the head device portion to float above the magnetic disk with a certain gap therebetween. Such a gap between the head device portion and the magnetic disk is referred to as a head flying height.</p>
<p id="p-0007" num="0006">In some cases, the head flying height becomes abnormally high while the HDD is operating. This phenomenon is considered to be attributed to thermal asperity on the magnetic disk, a disturbance in the air bearing due to dust, or an external shock. If the head device portion floats abnormally high, the level of the magnetic signal applied from the head device portion to the magnetic disk decreases. If a write operation is performed at that time, the data may be properly written, or no data may be written at all.</p>
<p id="p-0008" num="0007">To prevent occurrence of such an error in a write operation, a technique has been proposed which detects the head flying height based on the servo gain and inhibits the data write operation when the flying height is abnormal (see Japanese Patent Laid-Open No. 2001-229637). In the HDD, the read signal read out from the magnetic disk is amplified to a certain potential through AGC (Automatic Gain Control). The level of the read signal read by the head device portion is inversely proportional to the head flying height. Therefore, the higher the flying height, the larger the gain of the AGC. The technique disclosed in Japanese Patent Laid-Open No. 2001-229637 monitors the gain of the AGC for amplification of the servo signal at the start of a write operation and compares its value with a reference value to detect an abnormality in the head flying height. If the flying height is determined to be abnormal, the technique inhibits the data write operation.</p>
<p id="p-0009" num="0008">Japanese Patent Laid-Open No. Hei 09-139040 (1997) discloses a system for monitoring changes in the head flying height based on the AGC voltage of the AGC circuit of the data reproduction processing circuit which receives the reproduced signal obtained when data stored on a disk is read out by the head and which performs predetermined data reproduction processing. The CPU compares the input AGC voltage with threshold value data DT stored in memory, and if the voltage falls outside a permissible range, the CPU outputs a flying height change detection signal FS indicating occurrence of an abnormal change in the head flying height. Further, the system disclosed measures the AGC voltage CV corresponding to the reproduced signal from the head and compares an average value CVa of the AGC voltage CV with the threshold value data DT to determine whether the AGC voltage CV falls within a permissible range indicated by the threshold value data DT.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The level of the reproduced signal of the servo signal, however, may change due to a change in the quality of the servo pattern regardless of the head flying height. However, the technique disclosed in Japanese Patent Laid-Open No. 2001-229637 determines whether the flying height is abnormal based on the AGC gain for a single servo pattern. Therefore, the technique may erroneously determine that the flying height is abnormal when it is normal, depending on a change in the level of the reproduced signal of the servo signal. This means that the write operation might be inhibited when data should be written, which is overkill.</p>
<p id="p-0011" num="0010">The technique disclosed in Japanese Patent Laid-Open No. Hei 09-139040 detects an abnormality in the head flying height by comparing an average value of the AGC voltage and a threshold value. However, the AGC gain function which provides an appropriate AGC gain value (an appropriate average AGC gain value) to be compared with the threshold value varies depending on the HDD and how an abnormality in the flying height occurs. Therefore, it is necessary to easily set and change the AGC gain function. However, the above conventional technique cannot satisfy this requirement.</p>
<p id="p-0012" num="0011">On the other hand, the head flying height changes with temperature. Specifically, the flying height increases with decreasing temperature. Accordingly, if the reference value to be compared with the AGC gain is set to a constant value based on a specific temperature, it may not be appropriate at other temperatures.</p>
<p id="p-0013" num="0012">The present invention has been devised in view of the above problems. It is, therefore, a feature of the present invention to provide a technique for facilitating design for properly detecting the head flying height in each device. Another feature of the present invention is to provide a technique capable of properly detecting the head flying height regardless of temperature variations. These and other features of the present invention will become apparent from the specification and the accompanying drawings.</p>
<p id="p-0014" num="0013">According to one aspect of the present invention, a data storage device comprises: a medium for storing data; and a head for floating above the medium and moving so as to access a storage area of the medium; wherein the data storage device determines whether a flying height of the head is normal; and wherein the data storage device further comprises: a flying height data generating section for generating flying height data based on a read signal read out from the medium by the head, the flying height data indicating the flying height of the head; a storage device for storing variable parameters; an evaluation value generating section for obtaining a plurality of pieces of flying height data generated by the flying height data generating section and processing the plurality of pieces of flying height data based on the parameters stored in the storage device to generate an evaluation value; and a determining section for determining whether the evaluation value is within a predetermined range. Thus, the data storage device generates the evaluation value by processing the plurality of pieces of flying height data based on the variable parameters, and determines whether the flying height is normal based on the evaluation value, making it easy to establish settings for each device. It should be noted that the predetermined range used by the determining section may be a range of values not less than a predetermined value, or a range of values not more than a predetermined value, or a range of values between predetermined values. This also applies to the data storage devices of the other aspects of the present invention described below.</p>
<p id="p-0015" num="0014">The above data storage device preferably further comprises: a write control section for inhibiting a data write operation to the medium if the determining section has determined that the evaluation value is outside the predetermined range. Thus, the data write operation is inhibited in the above case, making it possible to prevent occurrence of a write error when, for example, the flying height is too high and hence the data cannot be properly written.</p>
<p id="p-0016" num="0015">The above data storage device preferably further comprises: a variable gain amplifier for amplifying the read signal to a constant output power; wherein the flying height data generating section generates the flying height data based on a gain set for the variable gain amplifier. Thus, the flying height data is generated based on the gain, making it possible to efficiently determine whether the flying height is normal.</p>
<p id="p-0017" num="0016">The above data storage device may be configured such that: the head sequentially outputs read signals each corresponding to one of a plurality of pieces of servo data read out from the medium; and the flying height data generating section generates the flying height data based on gains of the read signals each corresponding to one of the plurality of pieces of servo data. Therefore, flying height determination can be carried out at a required timing by using the servo data sequentially read out from the medium.</p>
<p id="p-0018" num="0017">The evaluation value generating section may include an FIR filter which is set using the variable parameters. Use of such an FIR filter allows a suitable evaluation value to be obtained. Further, the variable parameters may include the number of taps of the FIR filter and a filter factor of each tap. This arrangement makes it possible to easily and effectively set the FIR filter. Further, the above data storage device is preferably configured such that: the head sequentially outputs read signals each corresponding to one of a plurality of pieces of servo data read out from the medium; the flying height data generating section sequentially generates the (plurality of) flying height data based on gains of the read signals each corresponding to one of the plurality of pieces of servo data; and the evaluation value generating section processes the flying height data by use of the FIR filter to generate the evaluation value, the flying height data being sequentially generated by the flying height data generating section.</p>
<p id="p-0019" num="0018">The above data storage device preferably further comprises: a temperature detecting section for detecting a temperature; and a reference value generating section for generating a reference value corresponding to the temperature detected by the temperature detecting section; wherein the determining section determines whether the evaluation value is within a range specified by the reference value. Thus, the reference value corresponding to the temperature is generated, making it possible to accurately determine whether the flying height is normal even when the flying height changes with temperature.</p>
<p id="p-0020" num="0019">According to another aspect of the present invention, a data storage device comprises: a medium for storing data; and a head for floating above the medium and moving so as to access a storage area of the medium; a data generating section for generating data corresponding to a flying height of the head; a temperature detecting section for detecting a temperature; a reference value generating section for generating a reference value based on the temperature detected by the temperature detecting section; and a determining section for, based on the generated data and the generated reference value, determining whether the flying height of the head is normal. Thus, the reference value corresponding to the temperature is generated, making it possible to accurately determine whether the flying height is normal even when the flying height changes with temperature.</p>
<p id="p-0021" num="0020">The above data storage device preferably further comprises: a data write control section for inhibiting a data write operation to the medium depending on the determination by the flying height determining section. Further, the write control section preferably inhibits the data write operation to the medium if the flying height determining section has determined that the generated data is outside a range specified by the reference value. Thus, the data write operation is inhibited in the above case, making it possible to prevent occurrence of a write error when, for example, the flying height is too high and hence the data cannot be properly written.</p>
<p id="p-0022" num="0021">The reference value generating section may process temperature data by use of a predetermined function to generate the reference value, the temperature data indicating the temperature detected by the temperature detecting section. This arrangement allows an appropriate reference value to be generated based on the temperature. Further, the function may be a linear function of the temperature data which decreases with decreasing temperature. This arrangement allows an appropriate reference value to be efficiently generated when the flying height increases with decreasing temperature.</p>
<p id="p-0023" num="0022">The reference value generating section preferably generates the reference value so as to compensate for an increase in the flying height due to a decrease in the temperature. This arrangement makes it possible to properly determine whether the head flying height is normal when the flying height increases with decreasing temperature.</p>
<p id="p-0024" num="0023">The above data storage device may further comprise: a variable gain amplifier for amplifying read signal to a constant output power, the read signal being read out from the medium by the head; wherein the data generating section generates the data based on a gain set for the variable gain amplifier. Thus, the flying height data is generated based on the gain, making it possible to efficiently determine whether the flying height is normal. Further, the above data storage device is preferably configured such that: the head sequentially outputs (a plurality of) read signals each corresponding to one of a plurality of pieces of servo data read out from the medium; and the data generating section generates the data based on gains of the read signals each corresponding to one of the plurality of pieces of servo data. Thus, the data is generated based on the plurality of gains, making it possible to more accurately determine whether the flying height is normal.</p>
<p id="p-0025" num="0024">According to still another aspect of the present invention, there is provided a method for controlling a data storage device according to a flying height of a head which floats above a medium and moves so as to access a storage area of the medium, the method comprising: generating flying height data based on a read signal read out from the medium by the head, the flying height data indicating the flying height of the head; obtaining a plurality of pieces of generated flying height data and processing the plurality of pieces of flying height data based on preset variable parameters to generate an evaluation value; and based on the evaluation value and a predetermined reference value, determining whether the flying height is normal. Thus, the method generates the evaluation value by processing the plurality of pieces of flying height data based on the variable parameters, and determines whether the flying height is normal based on the evaluation value, making it easy to establish settings for each HDD. Further, the above method may further comprise inhibiting a data write operation to the medium depending on a determination result of the determining step. Thus, the data write operation is inhibited depending on the determination result, making it possible to prevent occurrence of a write error when, for example, the flying height is too high and hence the data cannot be properly written. It should be noted that the predetermined reference value may be stored in memory (beforehand) or it may be obtained by carrying out an operation on a given value, for example.</p>
<p id="p-0026" num="0025">According to yet another aspect of the present invention, there is provided a method for controlling a data storage device, which determines whether a flying height of a head is normal, the head floating above a medium and moving so as to access a storage area of the medium, the method comprising: generating data corresponding to the flying height of the head; detecting a temperature; generating a reference value based on the detected temperature; and based on the generated data and the reference value, determining whether the flying height of the head is normal. Thus, the reference value is generated based on the temperature, making it possible to accurately determine whether the flying height is normal even when the flying height changes with temperature. Further, the above method preferably further comprises inhibiting a data write operation to the medium depending on a determination result of the determining step. Thus, the data write operation is inhibited depending on the determination result, making it possible to prevent occurrence of a write error when, for example, the flying height is too high and hence the data cannot be properly written.</p>
<p id="p-0027" num="0026">The present invention makes it possible to properly determine whether a head flying height is normal.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram schematically showing the configuration of a HDD according to a first embodiment of the present invention.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram schematically showing the drive mechanisms for a magnetic disk and head device portions according to the first embodiment.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram schematically showing the arrangement of the data stored on a recording surface of a magnetic disk according to the first embodiment.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 4</figref> is a block diagram showing the logical configuration of a R/W channel currently performing read processing according to the first embodiment.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing a servo signal according to the first embodiment.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing a logical configuration for monitoring AGC gain (head flying height) and controlling data write processing according to the first embodiment.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram showing the configuration of a digital filter according to the first embodiment.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 8</figref> is a diagram showing an exemplary configuration of a reference value table according to the first embodiment.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart for determining whether a head flying height is normal and performing write processing based on the determination according to the first embodiment.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 10</figref> includes <figref idref="DRAWINGS">FIGS. 10(</figref><i>a</i>) and <b>10</b>(<i>b</i>) which are diagrams illustrating how a head flying height changes with temperature according to a second embodiment of the present invention.</p>
<p id="p-0038" num="0037"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing a logical configuration for monitoring AGC gain (head flying height) and controlling data write processing according to the second embodiment.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 12</figref> shows measurement data indicating relationships between temperature and ordinary AGC gain.</p>
<p id="p-0040" num="0039"><figref idref="DRAWINGS">FIG. 13</figref> is a diagram showing an exemplary configuration of a reference value table according to the second embodiment.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 14</figref> is a flowchart for monitoring AGC gain (head flying height) and controlling data write processing according to the second embodiment.</p>
<p id="p-0042" num="0041"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing the configuration of the main portion of a measuring circuit for measuring the amplitude of a servo signal.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0043" num="0042">Specific embodiments of the present invention will be described below. Although the present invention is described in connection with these embodiments, it should be understood that the present invention is not limited to such embodiments. For clarity of explanation, this specification simplifies the description and drawings of the present invention and makes omissions when appropriate. A person skilled in the art can easily make alterations, additions, and substitutions to each component of the following embodiments within the scope of the present invention. It should be noted that in the following figures, like numerals are used to denote like components, and repetitive description is avoided when appropriate for clarity of explanation.</p>
<heading id="h-0006" level="1">First Embodiment</heading>
<p id="p-0044" num="0043"><figref idref="DRAWINGS">FIG. 1</figref> schematically shows the configuration of a hard disk drive (HDD) <b>100</b> according to a first embodiment of the present invention. The HDD <b>100</b> comprises a magnetic disk <b>111</b> (a medium), two head device portions <b>112</b> (heads), arm electronics (AE) <b>113</b>, a spindle motor (SPM) <b>114</b>, and a voice coil motor (VCM) <b>115</b> all contained within a chassis <b>110</b>. Furthermore, the HDD <b>100</b> comprises a circuit board <b>120</b> mounted on the outside of the chassis <b>110</b>. The circuit board <b>120</b> has mounted thereon a read/write channel (R/W channel) <b>121</b>, a motor driver unit <b>122</b>, a hard disk controller/MPU integrated circuit <b>123</b> (hereinafter referred to as HDC/MPU <b>123</b>), and RAM <b>124</b> (a memory or storage device).</p>
<p id="p-0045" num="0044">The HDC/MPU <b>123</b> receives write data from the external host. The received write data is written to the magnetic disk <b>111</b> by the head device portions <b>112</b> through the R/W channel <b>121</b> and the AE <b>113</b>. Data stored on the magnetic disk <b>111</b>, on the other hand, is read out by the head device portions <b>112</b> and output from the HDC/MPU <b>123</b> to the external host through the AE <b>113</b> and the R/W channel <b>121</b>.</p>
<p id="p-0046" num="0045">Each component of the HDD will be described below. First, brief description will be made of the drive mechanisms for the magnetic disk <b>111</b> and the head device portions <b>112</b> with reference to <figref idref="DRAWINGS">FIG. 2</figref>. The magnetic disk <b>111</b> is fixed to the rotational axis of the SPM <b>114</b>. The motor driver unit <b>122</b> drives the SPM <b>114</b> such that the magnetic disk <b>111</b> rotates at a predetermined speed. The magnetic disk <b>111</b> has formed on both sides thereof recording surfaces on which data is stored, and the head device portions <b>112</b> (not shown) are each provided for one of the recording surfaces. Each head device portion <b>112</b> is fixed to a slider <b>201</b>, which in turn is fixed to a carriage <b>202</b>. The carriages <b>202</b> are fixed to the VCM <b>115</b>, which swings so as to move the sliders <b>201</b> and the head device portions <b>112</b>.</p>
<p id="p-0047" num="0046">Each carriage <b>202</b> moves a head device portion <b>112</b> to a position above the data area on a surface of the magnetic disk <b>111</b> to write to or read from the magnetic disk <b>111</b>. Specifically, the carriages <b>202</b> swing so as to move each head device portion <b>112</b> in a radial direction over a surface of the magnetic disk <b>111</b>, enabling the head device portion <b>112</b> to access a desired area.</p>
<p id="p-0048" num="0047">Each head device portion <b>112</b> is typically made up of a write head and a read head integrally formed with each other. The write head converts an electrical signal into a magnetic field according to the data to be written to the magnetic disk <b>111</b>, while the read head converts a magnetic field generated from the magnetic disk <b>111</b> into an electrical signal. The pressure (to a head device portion) generated due to the viscosity of the air between the rotating magnetic disk <b>111</b> and the ABS (Air Bearing surface) surface of the slider <b>201</b> facing the magnetic disk <b>111</b> balances with the pressure applied (to the head device portion) by the carriage <b>202</b> toward the direction of the magnetic disk <b>111</b>, causing the head device portion <b>112</b> to float above the magnetic disk <b>111</b> with a certain gap therebetween. Such a gap is referred to as a head flying height. It should be noted that the HDD <b>100</b> may comprise one or more magnetic disks <b>111</b>, and a recording surface may be formed on one or both sides of each magnetic disk <b>111</b>.</p>
<p id="p-0049" num="0048">Referring back to <figref idref="DRAWINGS">FIG. 1</figref>, each circuit portion will be described. The AE <b>113</b> selects one of the plurality of head device portions <b>112</b> for data access, and pre-amplifies the reproduction signal reproduced by the selected head device portion <b>112</b> with a certain gain and outputs it to the R/W channel <b>121</b>. Furthermore, the AE <b>113</b> receives a write signal from the R/W channel <b>121</b> and outputs it to a selected head device portion <b>112</b>.</p>
<p id="p-0050" num="0049">The R/W channel <b>121</b> performs write processing on the data obtained from the host. Specifically, in the write processing, the R/W channel <b>121</b> code-modulates the write data supplied from the HDC/MPU <b>123</b> and then converts the code-modulated write data into a write signal (an electric current) before supplying it to the AE <b>113</b>. The R/W channel <b>121</b> also performs read processing when supplying data to the host.</p>
<p id="p-0051" num="0050">In the read processing, the R/W channel <b>121</b> amplifies the read signal supplied from the AE <b>113</b> to a given amplitude, extracts data from the amplified read signal, and performs decode processing on the data. The extracted data includes user data and servo data. The decoded read data is supplied to the HDC/MPU <b>123</b>. According to the present embodiment, the gain with which the read signal is amplified by the R/W channel <b>121</b> is used to control the write processing, as described later in detail.</p>
<p id="p-0052" num="0051">The HDC/MPU <b>123</b> is a circuit made up of an MPU and a HDC integrated on a single chip. The MPU operates according to microcode loaded into the RAM <b>124</b> and controls the entire hard disk drive <b>100</b>, such as positioning control of each head device portion <b>112</b>, interface control, and defect management, as well as performing the processing necessary for data processing. At startup of the hard disk drive <b>100</b>, the microcode to be executed on the MPU and the data necessary for the control and data processing are loaded into the RAM <b>124</b> from the magnetic disk <b>111</b> or ROM (not shown).</p>
<p id="p-0053" num="0052">The HDC/MPU <b>123</b> is provided with an interface capability to the host and receives the user data and the read and write commands sent from the host. The received user data is transferred to the R/W channel <b>121</b>. The HDC/MPU <b>123</b> also receives the data read out from the magnetic disk through the R/W channel <b>121</b> and transmits it to the host. Furthermore, the HDC/MPU <b>123</b> performs error correction (ECC) processing on the user data obtained from the host or read out from the magnetic disk <b>111</b>.</p>
<p id="p-0054" num="0053">The data read out by the R/W channel <b>121</b> includes servo data as well as user data. The HDC/MPU <b>123</b> controls positioning of each head device portion <b>112</b> by use of the servo data. The HDC/MPU <b>123</b> outputs control data to the motor driver unit <b>122</b>. The motor driver unit <b>122</b> supplies a drive current to the VCM <b>115</b> according to the control signal. Furthermore, the HDC/MPU <b>123</b> controls the data read/write processing based on the servo data. Particularly according to the present embodiment, in the write processing, the HDC/MPU <b>123</b> controls whether to permit or inhibit a data write operation to the magnetic disk <b>111</b> based on the value of the signal amplifier gain obtained from the R/W channel <b>121</b>, as described later.</p>
<p id="p-0055" num="0054">Description will be made of the data stored on the magnetic disk <b>111</b> with reference to <figref idref="DRAWINGS">FIG. 3</figref>. <figref idref="DRAWINGS">FIG. 3</figref> schematically shows the arrangement of the data stored on a recording surface of the magnetic disk <b>111</b>. As shown in <figref idref="DRAWINGS">FIG. 3</figref>, on the recording surface of the magnetic disk <b>111</b> are formed a plurality of servo areas <b>301</b> and a plurality of data areas <b>302</b> each disposed between two neighboring servo areas <b>301</b>. The plurality of servo areas <b>301</b> each extend from the center of the magnetic disk <b>111</b> in a radial direction at a predetermined angle. Thus, the servo areas <b>301</b> and the data areas <b>302</b> are alternately disposed at a predetermined angle relative to one another. Each servo area <b>301</b> stores servo data for controlling positioning of the head device portion <b>112</b>, while each data area <b>302</b> stores user data.</p>
<p id="p-0056" num="0055">Also on the recording surface of the magnetic disk <b>111</b> are formed a plurality of concentric tracks <b>303</b> with a predetermined width in a radial direction. The servo data and the user data are stored along the tracks <b>303</b>. Each track segment (<b>303</b>) between servo areas <b>301</b> includes a plurality of data sectors (in which user data is stored as a unit). The tracks <b>303</b> are grouped into a plurality of zones according to their radial position on the magnetic disk <b>111</b>. The number of sectors <b>304</b> in each track <b>303</b> varies depending on the zone to which it belongs. The example in <figref idref="DRAWINGS">FIG. 3</figref> employs three zones. The recording frequency may be changed for each zone so as to increase the recording density.</p>
<p id="p-0057" num="0056">Description will be made below of the read processing performed by the R/W channel <b>121</b>. <figref idref="DRAWINGS">FIG. 4</figref> is a block diagram showing the logical configuration of the R/W channel <b>121</b> currently performing the read processing according to the present embodiment. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the R/W channel <b>121</b> includes: a read processing section <b>410</b> for performing data read processing from the magnetic disk; and a channel control section <b>450</b> for controlling the data read processing performed by the read processing section <b>410</b>. The channel control section <b>450</b> can set parameters for the read processing section <b>410</b> so as to control the read processing. The channel control section <b>450</b> includes a register <b>451</b> for storing the parameters obtained from the read processing section <b>410</b>. According to the present embodiment, the register <b>451</b> stores the gain data obtained from an AGC (Automatic Gain Control) controller <b>415</b>.</p>
<p id="p-0058" num="0057">Description will be made of the read processing in which data is read out from the magnetic disk <b>111</b>. As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the read processing section <b>410</b> includes a VGA (Variable Gain Amp) <b>411</b>, a waveform equalizing filter <b>412</b>, an A/D converter <b>413</b>, an FIR (Finite Impulse Response) filter <b>414</b>, the AGC controller <b>415</b>, a data decoder <b>416</b>, a serial-parallel converter <b>417</b>, and a servo data decoder <b>418</b>. The AGC controller <b>415</b> is a flying height data generating section (flying height data generating section or data generating section for generating data corresponding to the head flying height).</p>
<p id="p-0059" num="0058">The VGA <b>411</b> changes its gain so as to keep the output constant under control of the AGC controller <b>415</b>. The waveform equalizing filter <b>412</b> performs waveform equalization processing on the input analog signal. The A/D converter <b>413</b> samples and quantizes the analog signal. The FIR filter <b>414</b>, which is a transversal filter, performs transversal equalization processing on the digital signal. The AGC controller <b>415</b> controls the VGA <b>411</b> so as to keep the input voltage constant. The data decoder <b>416</b> performs decode processing and demodulation processing on the input data. The serial-parallel converter <b>417</b> converts input serial data into parallel data. The servo data decoder <b>418</b> decodes the servo address of the servo signal and outputs it to the HDC/MPU <b>123</b>.</p>
<p id="p-0060" num="0059">The read signal reproduced by each head device portion <b>112</b> is input to the VGA <b>411</b> after it is pre-amplified by the AE <b>113</b> with a given gain. The VGA <b>411</b> amplifies the input signal to a signal level processable by the HDC/MPU <b>123</b>. When the reproduced signal is for user data, the AGC controller <b>415</b> tracks changes in the signal level of the reproduced signal and automatically adjusts the gain through feedback control using digital processing so as to keep the amplitude of the amplified reproduced signal within a given range. When the reproduced signal is for servo data, the AGC controller <b>415</b> determines the gain based on the head portion of the servo signal and then amplifies the subsequent portions of the servo signal with the determined constant gain.</p>
<p id="p-0061" num="0060">The waveform equalizing filter <b>412</b> has the function of a low-pass filter. For the subsequent signal processing, the waveform equalizing filter <b>412</b> removes noise from the input signal and performs waveform equalization processing for slimming the waveform. The output from the waveform equalizing filter <b>412</b> is converted into a digital signal through sampling and quantization by the A/D converter <b>413</b> and input to the FIR filter <b>414</b>.</p>
<p id="p-0062" num="0061">To accurately restore the data, the FIR filter <b>414</b> shapes the input waveform so as to equalize it to a desired waveform. The output signal from the FIR filter <b>414</b> is input to the data decoder <b>416</b>. The data decoder <b>416</b> processes the waveform equalized by the FIR filter by use of a PRML (Partial Response Maximum Likelihood) processing circuit to produce an RLL (Run Length Limited) signal. The data decoder <b>416</b> then determines the most likely data sequence based on the relationships between each piece of data according to a predetermined algorithm. Then, the data decoder <b>416</b> demodulates the coded RLL signal into the original signal. The serial data demodulated by the data decoder <b>416</b> is converted into parallel data by the serial-parallel converter <b>417</b>, and input to the HDC/MPU <b>123</b>. In the case of servo data, the servo data decoder <b>418</b> decodes the servo address of the servo signal whose waveform has been shaped by the FIR filter <b>414</b>, and outputs it to the HDC/MPU <b>123</b>.</p>
<p id="p-0063" num="0062">Description will be made below of the servo signal stored on the magnetic disk <b>111</b>. As shown in <figref idref="DRAWINGS">FIG. 5</figref>, the servo signal (the servo data reproduction signal) includes a gap, servo AGC, a servo address, and a burst pattern. The gap is used to accommodate timing deviation due to a change in the rotation, etc. The servo AGC is used to determine the AGC gain of the servo signal. The servo address includes positional information such as a cylinder ID, a servo sector number, etc. The burst pattern is obtained as a result of converting changes in the amplitude of the reproduction signal into numbers and used for tracking control (track following) by the head device portion <b>112</b>.</p>
<p id="p-0064" num="0063">When the servo AGC is reproduced, the AGC HOLD signal falls to the L (low) level and the AGC controller <b>415</b> adjusts the gain. The AGC HOLD signal then rises to the H (high) level at a predetermined timing, and the AGC controller <b>415</b> determines a value for the gain of the servo signal and maintain the gain at that value (assumes the AGC HOLD state). The servo address and the burst pattern are amplified by the VGA <b>411</b> with the determined gain. The channel controller <b>450</b> obtains gain data indicating the determined gain from the AGC controller <b>415</b> and stores it in the register <b>451</b>.</p>
<p id="p-0065" num="0064">As described above, each head device portion <b>112</b> floats above the magnetic disk <b>111</b> with a gap therebetween. However, if a head device portion <b>112</b> floats abnormally high, the data cannot be properly written to the magnetic disk <b>111</b>, or no data can be written to the magnetic disk <b>111</b> at all. This means that the previous data is left intact on the magnetic disk <b>111</b>. According to the present embodiment, if it is determined that the flying height of a head device portion <b>112</b> is abnormal, the HDD <b>100</b> inhibits data write operation to the magnetic disk <b>111</b>. This arrangement prevents erroneous data from being written, as well as preventing the situation where a notification indicating proper completion of a data write operation is issued to the host even though the previous data is left on the magnetic disk <b>111</b>.</p>
<p id="p-0066" num="0065">As the flying height of the head device portion <b>112</b> increases, the level of the signal reproduced by the head device portion <b>112</b> decreases. The AGC controller <b>415</b> tracks changes in the signal level of the reproduced signal and automatically adjusts the gain through feedback control using digital processing, as described above. When the reproduction level of a head device portion <b>112</b> is low, the gain is increased, and when the reproduction level is high, on the other hand, the gain is decreased. Therefore, the gain set by the AGC controller <b>415</b> may be monitored to obtain information about the flying height of the head device portion <b>112</b>.</p>
<p id="p-0067" num="0066">The HDD <b>100</b> of the present embodiment detects an abnormality in the head flying height based on the AGC gain in the servo data read operation and thereby prevents erroneous data from being written. The HDD <b>100</b> uses a reference value determined at the design or manufacturing stage to determine whether the flying height of a head device portion <b>112</b> is abnormal. An abnormal AGC gain value and hence an abnormality in the head flying height can be detected by comparing the reference value and the AGC gain.</p>
<p id="p-0068" num="0067">Further, the HDD <b>100</b> of the present embodiment does not compare the AGC gain value obtained from each servo sector with a reference value separately, but uses a value obtained as a result of processing a plurality of pieces of servo data by use of an evaluation function, instead. Specifically, the present embodiment preferably uses a filter function to multiply the AGC gain value of each of the plurality of servo sectors by a weighting factor and add the results together to produce a reference value for detecting an abnormality in the flying height. This arrangement can prevent occurrence of overkill (in which a write operation is inhibited when data should be written) when one AGC gain value has erroneously increased due to the quality of the servo pattern regardless of the flying height, for example.</p>
<p id="p-0069" num="0068">According to the present embodiment, parameters of the evaluation function can be set and changed. Specifically, the weighting factor by which each AGC gain value is multiplied or the number of AGC gain values (the number of pieces of servo data) to be used is stored in memory and set as a variable parameter. These parameters may be set as programmable parameters so that they can be easily changed, making it possible to efficiently design the evaluation function for each HDD.</p>
<p id="p-0070" num="0069">Description will be made below of how to determine whether the flying height of a head device portion <b>112</b> is abnormal and of the data write inhibit processing performed after the flying height is determined to be abnormal with reference to <figref idref="DRAWINGS">FIGS. 6 to 9</figref>. <figref idref="DRAWINGS">FIG. 6</figref> shows a logical configuration for monitoring the AGC gain (head flying height) and controlling the data write processing. The write processing control according to the head flying height is mainly performed within the HDC/MPU <b>123</b>. Referring to <figref idref="DRAWINGS">FIG. 6</figref>, reference numeral <b>610</b> denotes a digital filter (a specific example for providing the evaluation function). The digital filter <b>610</b> corresponds to an evaluation value generating section (evaluation value generating module) and a data generating section (data generating module) for generating data corresponding to the head flying height. Reference numeral <b>620</b> denotes a comparative judgment section (comparative judgment module) for determining occurrence of an abnormality in the flying height based on the gain data set for the VGA and a reference value registered in a reference value table <b>640</b> beforehand. Specifically, the comparative judgment section <b>620</b> determines whether the gain data is within a range indicated by the reference value.</p>
<p id="p-0071" num="0070">Reference numeral <b>630</b> denotes write control logic for controlling whether to permit or inhibit data write operation to the magnetic disk <b>111</b>. The write control logic <b>630</b> outputs to each section a write gate (WG) signal for controlling the write timing. A data write operation to the magnetic disk <b>111</b> can be inhibited by masking the WG signal. The WG signal is masked to inhibit data write operation in the event of an abnormality in the flying height, a positional error, etc. Reference numeral <b>640</b> denotes the reference value table stored in RAM <b>124</b>. The MPU which operates according to microcode can function as the digital filter <b>610</b> and the comparative judgment section <b>620</b>. The write control logic <b>630</b> may be implemented as circuit logic within the HDC/MPU <b>123</b>.</p>
<p id="p-0072" num="0071">The digital filter <b>610</b> performs filtering processing on the gain data obtained from the channel control section <b>450</b> of the R/W channel <b>121</b>. <figref idref="DRAWINGS">FIG. 7</figref> shows an exemplary configuration of the digital filter <b>610</b>. An FIR filter is preferably used as the digital filter <b>610</b>. Specifically, <figref idref="DRAWINGS">FIG. 7</figref> shows a four-dimensional FIR filter having a filter length of 5 (the number of taps is 5). The filter length (the number of taps) is set to an appropriate value for each design.</p>
<p id="p-0073" num="0072">Referring to <figref idref="DRAWINGS">FIG. 7</figref>, symbol D denotes delay operation processing (a delay element) for delaying data by one clock. Each filter factor A<sub>n-i </sub>corresponds to the variable weighting factor for a piece of gain data. As indicated by the equation in <figref idref="DRAWINGS">FIG. 7</figref>, the output G of the digital filter <b>610</b> equals the sum of the gain data g<sub>i </sub>of each of the current and previous servo sectors multiplied by a respective weighting factor A<sub>n-i</sub>. Each weighting factor A<sub>n-i </sub>may be positive or negative and is set as a programmable parameter at the design or manufacturing stage. The filter length of the digital filter <b>610</b> is also set as a variable programmable parameter. For example, it may be arranged that the output of the digital filter <b>610</b> is an average of a plurality of pieces of gain data or it is the difference between the gain data of the current servo sector and that of the immediately previous servo sector.</p>
<p id="p-0074" num="0073">The reference values for the AGC gain are registered in the reference value table <b>640</b> stored in RAM <b>124</b>. The reference values may be set based on measured value data of the gain of the AGC controller <b>415</b> obtained when the head flying height is normal, beforehand. Specifically, each reference value for detecting an abnormality in the head flying height is obtained by adding an appropriate margin value to a measured value of the AGC gain when the head flying height is normal. For example, each reference value may be set such that it is 1.1 times a measured value.</p>
<p id="p-0075" num="0074"><figref idref="DRAWINGS">FIG. 8</figref> shows an exemplary configuration of the reference value table <b>640</b>. A reference value(s) CRITERIA is preferably set for each head device portion <b>112</b> separately, as shown in <figref idref="DRAWINGS">FIG. 8</figref>. This arrangement makes it possible to set the most appropriate reference value(s) for each head device portion <b>112</b>. Furthermore, it is preferable to set the most appropriate reference value for each zone considering the fact that the flying height of each head device portion <b>112</b> may change depending on its radial position on the magnetic disk <b>111</b>. It should be noted that a measured value table may be stored instead of the reference value table, and each reference value may be calculated as necessary.</p>
<p id="p-0076" num="0075">Description will be made below of how to determine whether a head flying height is normal or abnormal and of the write operation control after the determination. In response to a data write command from the host, a head device portion <b>112</b> seeks a target track while reading servo data on the magnetic disk <b>111</b>. When the head device portion <b>112</b> has reached the target track, positioning control (tack following) is carried out over the target track using the burst pattern.</p>
<p id="p-0077" num="0076">The operation is described below with reference to the flowchart of <figref idref="DRAWINGS">FIG. 9</figref>. The servo signal reproduced by the head device portion <b>112</b> through a seek operation or track following is input to the R/W channel <b>121</b> via the AE <b>113</b> at step S<b>101</b>. The AGC controller <b>415</b> adjusts the gain of the reproduced signal based on the servo AGC of the servo signal (determines the gain of the servo signal) at step S <b>102</b>. Gain data indicating the determined gain is stored in the register <b>451</b> of the channel control section <b>450</b> at step S<b>103</b>.</p>
<p id="p-0078" num="0077">The gain data g is input to the HDC/MPU <b>123</b> from the register. The digital filter <b>610</b> performs filtering processing using the obtained gain data g and the gain data of previous sectors at step S<b>104</b>. The comparative judgment section <b>620</b> obtains the reference value CRITERIA for the present head and zone from the reference value table <b>640</b> at step S<b>105</b>. The comparative judgment section <b>620</b> also obtains the filtered gain data G from the digital filter <b>610</b>, and compares the gain data G and the reference value CRITERIA to determine whether the flying height is normal or abnormal at step <b>106</b>.</p>
<p id="p-0079" num="0078">If it is determined at step S<b>106</b> that the gain data G is equal to or less than the reference value CRITERIA, the comparative judgment section <b>620</b> determines that the head flying height (the gain data G) is normal. The comparative judgment section <b>620</b> outputs a write permit signal to the write control logic <b>630</b>. The flying height monitoring processing using the gain data G is repeated until a target address is reached. Then, data is written to the target address area at step S<b>107</b>.</p>
<p id="p-0080" num="0079">If, on the other hand, it is determined at step S<b>106</b> that the gain G is larger than the reference value CRITERIA, the comparative judgment section <b>620</b> determines that the head flying height (the gain data G) is abnormal, and data write operation to the magnetic disk <b>111</b> is inhibited at S<b>108</b>. Specifically, the comparative judgment section <b>620</b> outputs a write inhibit signal to the write control logic <b>630</b>. Receiving the write inhibit signal, the write control logic <b>630</b> masks the write gate signal (WG signal), stopping the write operation. It should be noted that after stopping the write operation, ERP (Error Recovery Procedure) processing may be carried out, such as repeating loading/unloading operation of the head device portion <b>112</b> or shaking the head device portion <b>112</b>.</p>
<p id="p-0081" num="0080">It should be noted that the relation between each component and the processing that it performs may be changed; that is, a specific processing operation may be performed by a component different from that described above. For example, part of the function of the R/W channel <b>121</b> may be performed by the HDC/MPU <b>123</b>. Further, each processing function of the present invention may be implemented by hardware or software depending on the design. The chip in which each function is implemented may also be determined depending on the design. Further, the HDD may be controlled by detecting whether the flying height is low, instead of detecting whether it is high. The present invention is advantageous when applied to information storage apparatuses using a magnetic disk. However, the present invention can be applied to information storage apparatuses using a light beam, etc. Further, the technique of the present invention for monitoring the head flying height may be applied to HDD control other than data write inhibit control. These alternative arrangements also apply to the following embodiments.</p>
<heading id="h-0007" level="1">Second Embodiment</heading>
<p id="p-0082" num="0081">The HDD of a second embodiment of the present invention differs from that (HDD <b>100</b>) of the first embodiment in the way in which each reference value CRITERIA is generated and processed. The other arrangements are substantially the same as those of the HDD <b>100</b> of the first embodiment. Therefore, the HDD of the present embodiment will be described by focusing on the above different features.</p>
<p id="p-0083" num="0082"><figref idref="DRAWINGS">FIG. 10</figref> (including <figref idref="DRAWINGS">FIGS. 10(</figref><i>a</i>) and <b>10</b>(<i>b</i>)) shows changes in a head flying height due to temperature changes and the relationship between the head flying height and a reference height which is used to determine whether the flying height is abnormal. For example, the head flying height is determined to be abnormal if the undersurface of the head device portion <b>112</b> rises above the reference height. The flying height of the head device portion <b>112</b> (the flying height of the slider) changes with temperature. The flying height of the head device portion <b>112</b> increases with decreasing temperature, as shown in <figref idref="DRAWINGS">FIG. 10(</figref><i>a</i>). The height difference between the undersurface of the head device portion <b>112</b> and the reference height (that is, the height margin for determining that the flying height of the head device portion <b>112</b> is normal) is small at low temperatures if the reference height is set to a constant value.</p>
<p id="p-0084" num="0083">On the other hand, the height difference between the undersurface of the head device portion <b>112</b> and the reference height (that is, the height margin for determining that the flying height of the head device portion <b>112</b> is normal) is large at high temperatures. Reliably detecting an abnormality in the flying height requires reducing the height difference between the undersurface of the head device portion <b>112</b> and the reference height (that is, the height margin for determining that the flying height of the head device portion <b>112</b> is normal). However, if the height margin is set to an appropriate value at low temperatures, the margin becomes too large at high temperatures, which might prevent proper detection of an abnormality in the flying height. On the other hand, if the height margin is set to an appropriate value at high temperatures, the margin becomes too small at low temperatures. As a result, the flying height might be erroneously determined to be abnormal when it is normal.</p>
<p id="p-0085" num="0084">The HDD of the present embodiment uses different reference values CRITERIA for the gain data at different temperatures. That is, the reference height is varied depending on the temperature, as shown in <figref idref="DRAWINGS">FIG. 10(</figref><i>b</i>). The reference value CRITERIA is set such that it is larger at low temperatures than at high temperatures. This means that the reference height is smaller at high temperatures than at low temperatures. This makes it possible to set the height difference between the undersurface of the head device portion <b>112</b> and the reference height (that is, the height margin for determining that the flying height of the head device <b>112</b> is normal) to an appropriate value by considering the changes in the flying height due to temperature changes. As a result, it is possible to properly detect an abnormality in the flying height regardless of temperature.</p>
<p id="p-0086" num="0085"><figref idref="DRAWINGS">FIG. 11</figref> shows a logical configuration for the HDD of the present embodiment for monitoring the AGC gain (the head flying height) and thereby controlling the data write processing. Referring to <figref idref="DRAWINGS">FIG. 11</figref>, since a digital filter <b>610</b>, a comparative judgment section <b>620</b>, and write control logic <b>630</b> are the same as the corresponding components of the first embodiment, their detailed description will be omitted. Reference numeral <b>670</b> denotes a temperature detecting section (temperature detecting module) made up of a resistance thermometer or the like. The temperature detected by the temperature detecting section is A/D converted and used by a reference value determining section <b>680</b> (reference value generating module) of the MPU for processing. The MPU operates according to microcode so as to function as the reference value determining section <b>680</b>. The reference value determining section <b>680</b> checks a reference value table <b>690</b> and determines a reference value CRITERIA corresponding to the temperature data obtained from the temperature detecting section <b>670</b>.</p>
<p id="p-0087" num="0086">The reference value determining section <b>680</b> determines a reference value CRITERIA for each temperature by use of a predetermined equation. This arrangement allows a more appropriate reference value CRITERIA to be determined for each temperature value since the detected temperature continuously changes. One exemplary equation is: CRITERIA for detected temperature=CRITERIA for first reference temperature+k(detected temperaturefirst reference temperature). The CRITERIA (reference value) for the first reference temperature can be determined by measuring an actual flying height (AGC gain) at the manufacturing stage. The symbol k is a real number and can be determined based on the relation between the temperature and the flying height (AGC gain) obtained as a result of measuring the flying height (AGC gain) at a plurality of temperatures. To calculate an appropriate value for k, the more points of measurement, the better. From the viewpoint of manufacturing efficiency, however, the less points of measurement, the better. Therefore, 2 points of measurement are preferably set.</p>
<p id="p-0088" num="0087">For example, if the CRITERIA (reference value) for each temperature is determined based on those for two reference temperatures, k is expressed as the following equation: k=(CRITERIA for first reference temperatureCRITERIA for second reference temperature)/(first reference temperaturesecond reference temperature).</p>
<p id="p-0089" num="0088"><figref idref="DRAWINGS">FIG. 12</figref> is measurement data indicating relationships between the temperature and the ordinary AGC gain. The y-axis indicates the AGC gain, while the x-axis indicates the temperature (in degrees Celsius). Measurements were made on a total of 3 products (HDDs) each including two heads (indicated by reference numerals <b>0</b>HD and <b>1</b>HD). <figref idref="DRAWINGS">FIG. 12</figref> shows the relationship between the temperature and the AGC gain for each head. As shown in the figure, the temperature and the AGC gain have a substantially linear relationship; each relationship between the temperature and the AGC gain can be approximated by a linear function.</p>
<p id="p-0090" num="0089">Therefore, for example, the AGC gain at each temperature can be estimated based on measurements of the AGC gain at two different temperatures. If the AGC gain is measured at three different temperatures, the parameter(s) of the function can be determined by a least-squares method, for example. An appropriate margin may be added to the obtained AGC gain at each temperature to produce the reference value CRITERIA used for determining whether the flying height is abnormal at each temperature.</p>
<p id="p-0091" num="0090"><figref idref="DRAWINGS">FIG. 13</figref> shows an exemplary configuration of the reference value table <b>690</b> of the present embodiment. The reference value table <b>690</b> stores a set of parameters, denoted by P, used to determine a reference value for each zone for each head. According to the above exemplary arrangement, the table stores, for each zone for each head, the first reference temperature, the CRITERIA (reference value) for the first reference temperature, and the real number k as a set of parameters P.</p>
<p id="p-0092" num="0091">The processing performed in the logical configuration shown in <figref idref="DRAWINGS">FIG. 11</figref> will be described with reference to the flowchart of <figref idref="DRAWINGS">FIG. 14</figref>. When the data write processing begins, the digital filter <b>610</b> receives gain data g from the AGC controller <b>415</b>. The digital filter <b>610</b> performs filtering processing on the gain data g to produce gain data G at step S<b>201</b>. The gain data G is supplied to the comparative judgment section <b>620</b>. At step S<b>202</b>, the reference value determining section <b>680</b> obtains temperature data indicating the temperature detected by the temperature detecting section <b>670</b>. Furthermore, the reference value determining section <b>680</b> obtains the reference value determination parameters for the target zone for the head of interest from the reference value table <b>690</b> at step S<b>203</b>.</p>
<p id="p-0093" num="0092">The reference value determining section <b>680</b> performs an operation on the obtained temperature data and reference value determination parameters to produce the reference value CRITERIA for the current temperature at step S<b>204</b>. The reference value determining section <b>680</b> then supplies the calculated reference value CRITERIA to the comparative judgment section <b>620</b>. At step S<b>205</b>, the comparative judgment section <b>620</b> compares the obtained gain data G with the reference value CRITERIA to determine whether the gain data (hence the flying height) is abnormal. This determination step and the subsequent write processing step are the same as those for the first embodiment.</p>
<p id="p-0094" num="0093">As described above, the present embodiment sets an appropriate reference value for each temperature, making it possible to provide an appropriate height margin for determining whether or not the flying height is normal based on the AGC gain and the reference value even when the flying height and hence the AGC gain change due to temperature changes. This arrangement effectively prevents occurrence of overkill at low temperatures as well as preventing the situation where an abnormality in the flying height fails to be detected at high temperatures.</p>
<p id="p-0095" num="0094">According to the present embodiment, the reference value CRITERIA for a target temperature is calculated by use of an equation determined based on parameters registered in a reference value table, as described above. However, the reference value CRITERIA for a target temperature may be (directly) determined based on the reference value CRITERIA for each temperature registered in another reference table. For example, such a table may store information about a plurality of temperature ranges with a predetermined width and a reference value CRITERIA for each temperature range. By checking such a reference value table, the reference value determining section <b>680</b> determines a reference value CRITERIA corresponding to the temperature indicated by the temperature data obtained from the temperature detecting section <b>670</b>.</p>
<p id="p-0096" num="0095">Direct use of a reference value CRITERIA stored in the table allows the processing to be performed at higher speed. Further, the above arrangement that varies the reference value CRITERIA depending on the temperature can be applied to HDDs in which a single AGC gain value is compared with the reference value CRITERIA, as well as those described above in which a plurality of AGC gain values are used to determine whether the flying height is abnormal.</p>
<heading id="h-0008" level="1">Another Embodiment</heading>
<p id="p-0097" num="0096">The first and second embodiments compare the gain set by the AGC controller <b>415</b> with a reference value. However, a HDD may be configured such that it includes a circuit for measuring the amplitude (the peak value) of the reproduced signal output from the AE <b>113</b> and compares the measured amplitude with a reference value.</p>
<p id="p-0098" num="0097"><figref idref="DRAWINGS">FIG. 15</figref> is a diagram showing the configuration of the main portion of a measuring circuit for measuring the amplitude of a servo signal. As shown in the figure, the measuring circuit includes a full-wave rectifier circuit <b>701</b>, a sample and hold circuit <b>702</b>, a capacitor <b>703</b>, and a reset switch <b>704</b>. The two input terminals of the full-wave rectifier circuit <b>701</b> are connected to the positive and negative output terminals of the AE <b>113</b> through input lines <b>801</b><i>a </i>and <b>801</b><i>b</i>, respectively. The output terminal of the sample and hold circuit <b>702</b> is connected to an A/D converter (not shown) through an output line <b>802</b>. The capacitor <b>703</b> with one end grounded and the reset switch <b>704</b> are connected with the output line <b>802</b>.</p>
<p id="p-0099" num="0098">The full-wave rectifier circuit <b>701</b> converts the reproduced signal (AC signal) output from the AE <b>113</b> into a DC signal. The sample and hold circuit <b>702</b> samples the DC signal converted from the reproduced signal and thereby obtains the amplitude of the original reproduced signal. Specifically, when the reset switch <b>704</b> is on/off controlled, the sample and hold circuit <b>702</b> charges the capacitor <b>703</b> to the maximum voltage of the reproduced signal over a predetermined period of time, thereby outputting the peak value of the reproduced signal. This peak value is converted into a digital value by the A/D converter (not shown).</p>
<p id="p-0100" num="0099">It is to be understood that the above description is intended to be illustrative and not restrictive. Many embodiments will be apparent to those of skill in the art upon reviewing the above description. The scope of the invention should, therefore, be determined not with reference to the above description, but instead should be determined with reference to the appended claims alone with their full scope of equivalents.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A data storage device for determining whether a flying height of a head is normal, said data storage device comprising:
<claim-text>a medium for storing data; and</claim-text>
<claim-text>a head configured to float above said medium and move so as to access a storage area of said medium;</claim-text>
<claim-text>a flying height data generating section configured to generate flying height data based on a read signal read out from said medium by said head, said flying height data indicating a flying height of said head;</claim-text>
<claim-text>a storage device to store variable parameters;</claim-text>
<claim-text>an evaluation value generating section configured to obtain a plurality of pieces of flying height data generated by said flying height data generating section and processing said plurality of pieces of flying height data based on said parameters stored in said storage device to generate an evaluation value; and</claim-text>
<claim-text>a determining section configured to determine whether said evaluation value is within a predetermined range.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The data storage device as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a write control section configured to inhibit a data write operation to said medium if said determing section has determined that said evaluation value is outside said predetermined range.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The data storage device as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a variable gain amplifier configured to amplify said read signal to a constant output power;</claim-text>
<claim-text>wherein said flying height data generating section generates said flying height data based on a gain set for said variable gain amplifier.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The data storage device as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein:
<claim-text>said head sequentially outputs read signals each corresponding to one of a plurality of pieces of servo data read out from said medium; and</claim-text>
<claim-text>said flying height data generating section generates said flying height data based on gains of said read signals each corresponding to one of said plurality of pieces of servo data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The data storage device as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said evaluation value generating section includes an FIR (Finite Impulse Response) filter which is set using said variable parameters.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The data storage device as claimed in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein said variable parameters include a number of taps of said FIR filter and a filter factor of each tap.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The data storage device as claimed in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein:
<claim-text>said head sequentially outputs read signals each corresponding to one of a plurality of pieces of servo data read out from said medium;</claim-text>
<claim-text>said flying height data generating section sequentially generates a plurality of said flying height data based on gains of said read signals each corresponding to one of said plurality of pieces of servo data; and</claim-text>
<claim-text>said evaluation value generating section-processes said flying height data by use of said FIR filter to generate said evaluation value, said flying height data being sequentially generated by said flying height data generating section.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The data storage device as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a temperature detecting section configured to detect a temperature; and</claim-text>
<claim-text>a reference value generating section configured to generate a reference value corresponding to said temperature detected by said temperature detecting section;</claim-text>
<claim-text>wherein said determining section determines whether said evaluation value is within a range specified by said reference value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A data storage device comprising:
<claim-text>a medium for storing data; and</claim-text>
<claim-text>a head configured to float above said medium and move so as to access a storage area of said medium;</claim-text>
<claim-text>a data generating section configured to generate data corresponding to a flying height of said head;</claim-text>
<claim-text>a temperature detecting section configured to detect a temperature;</claim-text>
<claim-text>a reference value generating section configured to calculate a reference value based on said temperature detected by said temperature detecting section; and</claim-text>
<claim-text>a determining section configured, based on said generated data and said reference value, to determine whether said flying height of said head is normal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The data storage device as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>a data write control section configured to inhibit a data write operation to said medium depending on said determination by said flying height determining section.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The data storage device as claimed in <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said write control section inhibits said data write operation to said medium if said flying height determining section has determined that said generated data is outside a range specified by said reference value.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The data storage device as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said reference value generating section processes temperature data by use of a predetermined function to generate said reference value, said temperature data indicating said temperature detected by said temperature detecting section.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The data storage device as claimed in <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein said function is a linear function of said temperature data which decreases with decreasing temperature.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The data storage device as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein said reference value generating section generates said reference value so as to compensate for an increase in said flying height due to a decrease in said temperature.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The data storage device as claimed in <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>a variable gain amplifier configured to amplify a read signal to a constant output power, said read signal being read out from said medium by said head;</claim-text>
<claim-text>wherein said data generating section generates said data based on a gain set for said variable gain amplifier.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The data storage device as claimed in <claim-ref idref="CLM-00015">claim 15</claim-ref>, wherein:
<claim-text>said head sequentially outputs a plurality of read signals each corresponding to one of a plurality of pieces of servo data read out from said medium; and</claim-text>
<claim-text>said data generating section generates said data based on gains of said read signals each corresponding to one of said plurality of pieces of servo data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method for controlling a data storage device according to a flying height of a head which floats above a medium and moves so as to access a storage area of said medium, said method comprising:
<claim-text>generating flying height data based on a read signal read out from said medium by said head, said flying height data indicating said flying height of said head;</claim-text>
<claim-text>obtaining a plurality of pieces of generated flying height data and processing said plurality of pieces of flying height data based on preset variable parameters to generate an evaluation value; and</claim-text>
<claim-text>determining whether said flying height is normal based on said evaluation value and a predetermined reference value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method as claimed in <claim-ref idref="CLM-00017">claim 17</claim-ref>, further comprising:
<claim-text>inhibiting a data write operation to said medium depending on a determination result of said determining step.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. A method for controlling a data storage device, which determines whether a flying height of a head is normal, said head floating above a medium and moving so as to access a storage area of said medium, said method comprising:
<claim-text>generating data corresponding to said flying height of said head;</claim-text>
<claim-text>detecting a temperature;</claim-text>
<claim-text>calculating a reference value based on said detected temperature; and</claim-text>
<claim-text>based on said generated data and said reference value, determining whether said flying height of said head is normal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method as claimed in <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising:
<claim-text>inhibiting a data write operation to said medium depending on a determination result of said determining step.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
