<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299227-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299227</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10658901</doc-number>
<date>20030909</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>383</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>15</main-group>
<subgroup>16</subgroup>
<symbol-position>L</symbol-position>
<classification-value>N</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>707  6</main-classification>
<further-classification>707  3</further-classification>
<further-classification>707 10</further-classification>
<further-classification>709201</further-classification>
<further-classification>709218</further-classification>
</classification-national>
<invention-title id="d0e53">Method and system for providing cascaded trie-based network packet search engines</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6430527</doc-number>
<kind>B1</kind>
<name>Waters et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>703  3</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6631419</doc-number>
<kind>B1</kind>
<name>Greene</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709238</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6691218</doc-number>
<kind>B2</kind>
<name>Brown</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711216</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6725326</doc-number>
<kind>B1</kind>
<name>Patra et al.</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711108</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6792423</doc-number>
<kind>B1</kind>
<name>Jeffries et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  6</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6836771</doc-number>
<kind>B2</kind>
<name>Brown</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  3</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6880064</doc-number>
<kind>B1</kind>
<name>Brown</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>711216</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0146009</doc-number>
<kind>A1</kind>
<name>Gupta et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>EP</country>
<doc-number>1544757</doc-number>
<kind>A2</kind>
<date>20050600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Doeringer, Wilibald et al., “Routing on Longest-Matching Prefixes”, IEEE/ACM Transactions On Networking, vol. 4, No. 1, Feb. 1996, pp. 86-97.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Jaehyung Park et al., “Parallelisation of Trie-Based Longest Prefix Matching for Fast IP Address Lookups,” Electronics Letters, Dec. 5, 2002, vol. 38 No. 25, 2 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>18</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>707  3</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707  6</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707 10</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707100</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>7071041</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707  4</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>707  5</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709238</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709201</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709218</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709219</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709225</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709226</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711108</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>711216</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>2</number-of-drawing-sheets>
<number-of-figures>3</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050055339</doc-number>
<kind>A1</kind>
<date>20050310</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Richardson</last-name>
<first-name>Nicholas J.</first-name>
<address>
<city>San Diego</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Jorgenson</last-name>
<first-name>LIsa K.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Munck</last-name>
<first-name>William A.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>STMicroelectronics, Inc.</orgname>
<role>02</role>
<address>
<city>Carrollton</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Alam</last-name>
<first-name>Shahid Al</first-name>
<department>2162</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method for providing cascaded trie-based network packet search engines is provided. A search command is received at one of the network packet search engines. The search command comprises a specific search key. A determination of a longest prefix match based on the specific search key is made at the network packet search engine. A determination is made at the network packet search engine regarding whether the longest prefix match comprises an overall longest prefix match among the cascaded network packet search engines such that any of the cascaded network packet search engines may comprise the overall longest matching prefix independently of position relative to the other cascaded network packet search engines.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="254.42mm" wi="172.72mm" file="US07299227-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="205.32mm" wi="137.41mm" file="US07299227-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="254.85mm" wi="173.57mm" file="US07299227-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention is directed in general to network routers and, more specifically, to a method and system for providing cascaded trie-based network packet search engines.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Network routers for packet-based communications protocols such as Internet Protocol (IP) direct incoming information to the next neighbor along a route to the intended destination for the packet. To do this, typically each router along the route performs route address prefix (normally referred to as just “prefix”) look-up operations on a prefix (or routing) table to determine the appropriate next hop address for the destination IP prefix. Such operations are generally performed by either an embedded network processor or, more commonly, a separate network search engine.</p>
<p id="p-0004" num="0003">Originally the hardware for network search engines employed content addressable memory (CAM), a type of memory consisting of a bit comparator and two memory elements, one storing data and the other storing a compare mask. The CAM compares incoming data with the value stored in the data memory under the control of the mask value, which may be programmed to override the comparison result to “always match”. In operation, a CAM-based network search engine functions by storing all prefixes of a routing table in a CAM array in a specific, prioritized order, with each prefix's associated next hop information stored in a corresponding location in another memory. During prefix look-up, a key is placed on the comparand (compare operand) bus of the CAM array and compared against all prefixes in the memory. The array of match results from all comparisons is sent through a priority logic unit to determine the highest priority match, with the winning match used to address the next hop memory from which the corresponding next hop information is read and returned.</p>
<p id="p-0005" num="0004">More recently, software-based network search engines employing a general-purpose processor and a normal memory have been developed. Within such devices, the processor performs prefix searches with a series of memory read and comparison operations. The routing table prefixes and next hop information are typically stored in the memory in data structures built according to one of various software algorithms developed to reduce memory usage in storing the routing table and the number of memory accesses during look-up. For these purposes, a multi-bit trie and the corresponding algorithm are among the data structures and algorithms that achieve the best data compression with a bounded number of memory accesses for search operations.</p>
<p id="p-0006" num="0005">A trie is a tree-based data structure built to represent binary strings, where each bit or group of bits in the string determines the direction taken among branches within the tree. A binary trie proceeds bit-by-bit and has at most two branches from each node, while a multi-bit trie consumes multiple bits at a time and has several branches at each node, each branch leading to the next level. The number of bits consumed or examined during branch selection at each node is referred to as a stride. A uniform width stride trie is a trie with all strides having the same width, except possibly the last stride, which may be the remainder of the prefix length after being divided by the stride width.</p>
<p id="p-0007" num="0006">Generally, the multi-bit trie algorithm works by storing and retrieving prefixes in a uniform stride width trie, grouping all branches in the same level with the same parent stride value into a table, referred to as a trie table. At each level, the corresponding stride value provides an index into a trie table entry containing the information needed to get to the next level. A multi-bit trie has the advantage that prefixes with common high order bits (strides) will share the same parent trie tables, reducing the memory required to store the prefixes.</p>
<p id="p-0008" num="0007">Routing table look-up is also performed in same width strides, with the value of the next level stride from the input search key (typically an IP address of 32 or 64 bits) decoded and processed together with the associated data field in the stride value's parent table entry. If a stored route with the same prefix stride value is determined to exist within the trie, an index is calculated using the information in the parent table, then the search continues using the table pointer and the calculated index to form an address leading to the next level trie table entry. If a match is not found, the search terminates without success. If a search reaches an end node and a match is found, the search is successful and the associated next hop information is read from the next hop table.</p>
<p id="p-0009" num="0008">In conventional processing systems that operate as described above, multiple stored prefixes may match a single destination address that is used as the search key during a look-up operation. This is due to the fact that any n-bit prefix is defined to match the search key even if the search key is longer than the prefix, provided the complete n-bit prefix matches the first n bits of the search key. Thus, for example, a 2-bit prefix and a 16-bit prefix may both match a 32-bit search key if the 2-bit prefix matches the first two bits of the search key and the 16-bit prefix matches the first sixteen bits of the search key. In order to resolve multiple matches, therefore, the search engine selects only the data associated with the longest matching prefix when responding to the look-up operation.</p>
<p id="p-0010" num="0009">However, selecting between multiple matches in this way fails to address the problem of matches found within multiple search engines. Continuing the above example, if the 2-bit prefix was in a first search engine and the 16-bit prefix was in a second search engine, both search engines would respond to the look-up operation, creating a conflict.</p>
<p id="p-0011" num="0010">Current processing systems with multiple search engines solve this problem by requiring the network processor to perform separate searches within each search engine and then to determine which of the multiple responses to accept. However, this solution is unsatisfactory as it results in a significant increase in look-up time.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0012" num="0011">In accordance with the present invention, a method and system for providing cascaded trie-based network packet search engines are provided that substantially eliminate or reduce disadvantages and problems associated with conventional methods and systems.</p>
<p id="p-0013" num="0012">According to one embodiment of the present invention, a method for providing cascaded trie-based network packet search engines is provided. The method includes receiving a search command at one of the network packet search engines. The search command comprises a specific search key. A determination of a longest prefix match based on the specific search key is made at the network packet search engine. A determination is made at the network packet search engine regarding whether the longest prefix match comprises an overall longest prefix match among the cascaded network packet search engines such that any of the cascaded network packet search engines may comprise the overall longest matching prefix independently of position relative to the other cascaded network packet search engines.</p>
<p id="p-0014" num="0013">According to another embodiment of the present invention, a method for operating a network processing unit coupled to a plurality of network packet search engines is provided. The method includes sending a search command to the plurality of network packet search engines and receiving a response to the search command from a single one of the network packet search engines. The single network packet search engine comprises an overall longest prefix match among the plurality of network packet search engines independently of position relative to the other network packet search engines.</p>
<p id="p-0015" num="0014">According to yet another embodiment of the present invention, a network packet search engine coupled to at least one other network packet search engine is provided. The network packet search engine is operable to receive a search command. The search command comprises a specific search key. The network packet search engine is also operable to determine a longest prefix match based on the specific search key, to determine whether the longest prefix match comprises an overall longest prefix match among the plurality of network packet search engines, and to respond to the search command based on the determination that the network packet search engine comprises the overall longest prefix match.</p>
<p id="p-0016" num="0015">Technical advantages of one or more embodiments of the present invention include providing an improved method for providing cascaded trie-based network packet search engines. In a particular embodiment, a longest prefix match among multiple network packet search engines may be determined by the network packet search engines themselves. Accordingly, only the network packet search engine with the longest prefix match responds to look-up operation and storage requests from the network processing unit. As a result, the network processing unit does not have to resolve conflicts created by matches found within multiple network packet search engines, which decreases look-up time. In addition, the method allows for the maximization of memory utilization in response to storage requests from the network processing unit.</p>
<p id="p-0017" num="0016">Other technical advantages will be readily apparent to one skilled in the art from the following figures, description, and claims.</p>
<p id="p-0018" num="0017">Before undertaking the DETAILED DESCRIPTION OF THE INVENTION, it may be advantageous to set forth definitions of certain words and phrases used throughout this patent document: the terms “include” and “comprise,” as well as derivatives thereof, mean inclusion without limitation; the term “or,” is inclusive, meaning and/or; the phrases “associated with” and “associated therewith,” as well as derivatives thereof, may mean to include, be included within, interconnect with, contain, be contained within, connect to or with, couple to or with, be communicable with, cooperate with, interleave, juxtapose, be proximate to, be bound to or with, have, have a property of, or the like; and the term “controller” means any device, system or part thereof that controls at least one operation, such a device may be implemented in hardware, firmware or software, or some combination of at least two of the same. It should be noted that the functionality associated with any particular controller may be centralized or distributed, whether locally or remotely. Definitions for certain words and phrases are provided throughout this patent document, those of ordinary skill in the art should understand that in many, if not most instances, such definitions apply to prior, as well as future uses of such defined words and phrases.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0018">For a more complete understanding of the present invention and its advantages, reference is now made to the following description taken in conjunction with the accompanying drawings, wherein like reference numerals represent like parts, in which:</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a processing system comprising cascaded trie-based network packet search engines in accordance with one embodiment of the present invention;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram illustrating one of the network packet search engines of <figref idref="DRAWINGS">FIG. 1</figref> in accordance with one embodiment of the present invention; and</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 3</figref> is a flow diagram illustrating a method for providing the cascaded trie-based network packet search engines of <figref idref="DRAWINGS">FIG. 1</figref> in accordance with one embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIGS. 1 through 3</figref>, discussed below, and the various embodiments used to describe the principles of the present invention in this patent document are by way of illustration only and should not be construed in any way to limit the scope of the invention. Those skilled in the art will understand that the principles of the present invention may be implemented in any suitably arranged processing system.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating a processing system <b>100</b> comprising at least two cascaded trie-based network packet search engines (NPSEs) <b>102</b> in accordance with one embodiment of the present invention. In addition to the network packet search engines <b>102</b>, the processing system <b>100</b> comprises a system controller or network processing unit (NPU) <b>104</b>, a backplane <b>106</b>, a network interface <b>108</b>, and external memories <b>110</b>. According to one embodiment, the processing system <b>100</b> may implement a portion of an Internet Protocol (IP) network router.</p>
<p id="p-0025" num="0024">The network processing unit <b>104</b> is coupled to the network packet search engines <b>102</b>, which are each coupled to a corresponding one of the external memories <b>110</b>. As used herein, “each” means every one of at least a subset of the identified items. The network processing unit <b>104</b> is also coupled to the backplane <b>106</b> and to a network through the network interface <b>108</b>.</p>
<p id="p-0026" num="0025">Each network packet search engine <b>102</b> is operable to receive addresses, commands and/or prefixes for the next hop address from the network processing unit <b>104</b> and to return the next hop address to the network processing unit <b>104</b>. In order to perform these tasks, each network packet search engine <b>102</b> is operable to transmit data table memory addresses, together with a data pointer to the next hop address within a data table, to the corresponding external memory <b>110</b>. In addition, each network packet search engine <b>102</b> is operable to receive the next hop address that is identified by the address and data pointer from the corresponding external memory <b>110</b>.</p>
<p id="p-0027" num="0026">As described in more detail below in connection with <figref idref="DRAWINGS">FIGS. 2 and 3</figref>, each network packet search engine <b>102</b> is operable to receive input data from and transmit output data to any adjacent network packet search engines <b>102</b> in order to determine the longest prefix match (LPM) among multiple network packet search engines <b>102</b>. By communicating with the other network packet search engines <b>102</b>, each of the network packet search engines <b>102</b> is operable to compare its longest prefix match with other matches that may have been found by other network packet search engines <b>102</b>. The network packet search engine <b>102</b> that determines that it has found the longest prefix match may then respond to the network processing unit <b>104</b>.</p>
<p id="p-0028" num="0027">The network packet search engines <b>102</b> may comprise either peripheral network packet search engines <b>102</b><i>a </i>or central network packet search engines <b>102</b><i>b</i>. A peripheral network packet search engine <b>102</b><i>a </i>is coupled to only one adjacent network packet search engine <b>102</b>, while a central network packet search engine <b>102</b><i>b </i>is coupled to two network packet search engines <b>102</b>.</p>
<p id="p-0029" num="0028">Although the illustrated embodiment comprises four network packet search engines <b>102</b>, it will be understood that the processing system <b>100</b> may comprise any suitable number of network packet search engines <b>102</b> without departing from the scope of the present invention. Thus, for embodiments of the processing system <b>100</b> that comprise more than two network packet search engines <b>102</b>, the processing system <b>100</b> comprises two peripheral network packet search engines <b>102</b><i>a </i>and the remaining network packet search engines <b>102</b> are central network packet search engines <b>102</b><i>b</i>. For embodiments of the processing system <b>100</b> that comprise only two network packet search engines <b>102</b>, those network packet search engines <b>102</b> are peripheral network packet search engines <b>102</b><i>a </i>and the processing system <b>100</b> comprises no central network packet search engines <b>102</b><i>b. </i></p>
<p id="p-0030" num="0029">According to one embodiment, the network packet search engines <b>102</b> may be coupled to the network processing unit <b>104</b> by a high-speed 36-bit network processor unit interface and to the external memories <b>110</b> by high-speed 36-bit static random access memory (SRAM) interfaces. For this embodiment, each interface may be implemented by a quad data rate (QDR) architecture, with the network processing unit <b>104</b> as the master for the NPU interface and the external memories <b>110</b> as the slaves for the SRAM interfaces.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram illustrating one of the network packet search engines <b>102</b> in accordance with one embodiment of the present invention. The network packet search engine <b>102</b> is operable to receive input data from and transmit output data to any adjacent network packet search engines <b>102</b>.</p>
<p id="p-0032" num="0031">The network packet search engine <b>102</b> comprises at least one prefix table <b>200</b> that is operable to store prefixes for the network packet search engine <b>102</b>. Each prefix stored in a prefix table <b>200</b> is operable to identify an address stored within the corresponding external memory <b>110</b>.</p>
<p id="p-0033" num="0032">The network packet search engine <b>102</b> also comprises a longest match right input (LMRI) node <b>202</b> for receiving the length of the longest prefix match found by the network packet search engines <b>102</b> to the right of the network packet search engine <b>102</b> and a longest match left input (LMLI) node <b>204</b> for receiving the length of the longest prefix match found by the network packet search engines <b>102</b> to the left of the network packet search engine <b>102</b>.</p>
<p id="p-0034" num="0033">The network packet search engine <b>102</b> also comprises a longest match right output (LMRO) node <b>206</b> for transmitting the length of the longest prefix match found by the network packet search engines <b>102</b> to the right of the network packet search engine <b>102</b> or by the network packet search engine <b>102</b>, whichever is longer, and a longest match left output (LMLO) node <b>208</b> for transmitting the length of the longest prefix match found by the network packet search engines <b>102</b> to the left of the network packet search engine <b>102</b> or by the network packet search engine <b>102</b>, whichever is longer.</p>
<p id="p-0035" num="0034">The network packet search engine <b>102</b> also comprises a match valid node for each of the input and output nodes to indicate whether or not the data at the corresponding node is valid. Thus, the network packet search engine <b>102</b> comprises a match valid right input (MVRI) node <b>212</b> that corresponds to the LMRI node <b>202</b>, a match valid left input (MVLI) node <b>214</b> that corresponds to the LMLI node <b>204</b>, a match valid right output (MVRO) node <b>216</b> that corresponds to the LMRO node <b>206</b>, and a match valid left output (MVLO) node <b>218</b> that corresponds to the LMLO node <b>208</b>.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 3</figref> is a flow diagram illustrating a method for providing cascaded trie-based network packet search engines <b>102</b> in accordance with one embodiment of the present invention. The method begins at step <b>300</b> where the network processing unit <b>104</b> sends a search command to each of the network packet search engines <b>102</b>.</p>
<p id="p-0037" num="0036">The search command comprises a retrieval command, an insertion command and/or any other suitable command which initiates a process to find a longest prefix match. Each search command comprises a specific search key. The retrieval command comprises a command to initiate a search for a longest prefix match within the network packet search engines <b>102</b> that may be used, for example, to identify a next hop address within one of the external memories <b>110</b> associated with the specific search key. The insertion command comprises a command to initiate a search for a longest prefix match within the network packet search engines <b>102</b> in order to select one of the network packet search engines <b>102</b> for storing the specific search key and its corresponding external memory <b>110</b> for storing a new address associated with the specific search key.</p>
<p id="p-0038" num="0037">For the following steps (steps <b>302</b>-<b>308</b>), it will be understood that these steps are performed by each of the network packet search engines <b>102</b> independently.</p>
<p id="p-0039" num="0038">At step <b>302</b>, a network packet search engines <b>102</b> searches its prefix table <b>200</b> for prefixes matching the specific search key. At decisional step <b>304</b>, the network packet search engine <b>102</b> makes a determination regarding whether or not any matches were found. If no matches were found, the method follows the No branch from decisional step <b>304</b> to step <b>306</b>. At step <b>306</b>, the length of the longest prefix match is set to zero for that network packet search engine <b>102</b>.</p>
<p id="p-0040" num="0039">Returning to decisional step <b>304</b>, if one or more matches were found, the method follows the Yes branch from decisional step <b>304</b> to step <b>308</b>. At step <b>308</b>, that network packet search engine <b>102</b> determines the length of its longest prefix match.</p>
<p id="p-0041" num="0040">At step <b>310</b>, each peripheral network packet search engine <b>102</b><i>a </i>transmits the length of its longest prefix match to its adjacent network packet search engine <b>102</b>, which may be another peripheral network packet search engine <b>102</b><i>a </i>or a central network packet search engine <b>102</b><i>b </i>depending on the number of network packet search engines <b>102</b> in the processing system <b>100</b>.</p>
<p id="p-0042" num="0041">For the following steps (steps <b>312</b>-<b>328</b>), it will be understood that these steps are performed by each of the network packet search engines <b>102</b> independently.</p>
<p id="p-0043" num="0042">At step <b>312</b>, a network packet search engine <b>102</b> receives longest match input data at one of the longest match input nodes (the LMRI node <b>202</b> or the LMLI node <b>204</b>). The longest match input data comprises the length of the longest prefix match for one of the other network packet search engines <b>102</b>, as described above in connection with <figref idref="DRAWINGS">FIG. 2</figref>. The network packet search engine <b>102</b> also receives match valid input data at the corresponding match valid input node (the MVRI node <b>212</b> or the MVLI node <b>214</b>) that indicates that the longest match input data is valid.</p>
<p id="p-0044" num="0043">At step <b>314</b>, the network packet search engine <b>102</b> compares the longest match input data received at the longest match input node <b>202</b> or <b>204</b> to the length of its own longest prefix match. At decisional step <b>316</b>, the network packet search engine <b>102</b> makes a determination regarding whether or not the longest match input data is greater than the length of its own longest prefix match. If the network packet search engine <b>102</b> determines that the longest match input data is greater than the length of its own longest prefix match, the method follows the Yes branch from decisional step <b>316</b> to step <b>318</b>.</p>
<p id="p-0045" num="0044">At step <b>318</b>, the network packet search engine <b>102</b> transmits the longest match input data to an adjacent network packet search engine <b>102</b>. This data is transmitted as longest match output data at the longest match output node <b>206</b> or <b>208</b> corresponding to the longest match input node <b>202</b> or <b>204</b> at which the, longest match input data was received. Thus, if the longest match input data was received at the LMRI node <b>202</b>, the data is transmitted as longest match output data at the LMRO node <b>206</b>. Similarly, if the longest match input data was received at the LMLI node <b>204</b>, the data is transmitted as longest match output data at the LMLO node <b>208</b>.</p>
<p id="p-0046" num="0045">In addition, the network packet search engine <b>102</b> also transmits match valid output data at the corresponding match valid output node (the MVRO node <b>216</b> or the MVLO node <b>218</b>) that indicates that the longest match output data being transmitted is valid.</p>
<p id="p-0047" num="0046">Returning to decisional step <b>316</b>, if the network packet search engine <b>102</b> determines that the longest match input data is not greater than the length of its own longest prefix match, the method follows the No branch from decisional step <b>316</b> to step <b>320</b>.</p>
<p id="p-0048" num="0047">At step <b>320</b>, the network packet search engine <b>102</b> transmits the length of its own longest prefix match to an adjacent network packet search engine <b>102</b>. This data is transmitted as longest match output data at the longest match output node <b>206</b> or <b>208</b> corresponding to the longest match input node <b>202</b> or <b>204</b> at which the longest match input data was received. Thus, if the longest match input data was received at the LMRI node <b>202</b>, the data is transmitted as longest match output data at the LMRO node <b>206</b>. Similarly, if the longest match input data was received at the LMLI node <b>204</b>, the data is transmitted as longest match output data at the LMLO node <b>208</b>.</p>
<p id="p-0049" num="0048">In addition, the network packet search engine <b>102</b> also transmits match valid output data at the corresponding match valid output node (the MVRO node <b>216</b> or the MVLO node <b>218</b>) that indicates that the longest match output data being transmitted is valid.</p>
<p id="p-0050" num="0049">At decisional step <b>322</b>, the network packet search engine <b>102</b> makes a determination regarding whether or not all expected longest match input data has been received. Thus, the peripheral network packet search engines <b>102</b><i>a </i>determine whether or not longest match input data has been received from one adjacent network packet search engine <b>102</b> and the central network packet search engines <b>102</b><i>b</i>, if any, determine whether or not longest match input data has been received from two adjacent network packet search engines <b>102</b>.</p>
<p id="p-0051" num="0050">If all longest match input data has not been received, the method follows the No branch from decisional step <b>322</b> and returns to step <b>312</b> where the network packet search engine <b>102</b> receives longest match input data at one of the longest match input nodes. However, if all longest match input data has been received, the method follows the Yes branch from decisional step <b>322</b> to decisional step <b>324</b>.</p>
<p id="p-0052" num="0051">At decisional step <b>324</b>, the network packet search engine <b>102</b> makes a determination regarding whether or not the length of its longest prefix match is greater than the length of any LPMs found by other network packet search engines <b>102</b>. Thus, if the network packet search engine <b>102</b> determines that its longest prefix match is longer than all the longest match input data received from other network packet search engines <b>102</b>, that network packet search engine <b>102</b> comprises the overall longest prefix match among the network packet search engines <b>102</b> and the method follows the Yes branch from decisional step <b>324</b> to step <b>326</b>. In this way, any of the network packet search engines <b>102</b> may comprise the overall longest matching prefix independently of its position relative to the other network packet search engines <b>102</b>.</p>
<p id="p-0053" num="0052">At step <b>326</b>, the network packet search engine <b>102</b> responds to the search command received from the network processing unit <b>104</b>, at which point the method comes to an end. According to one embodiment, the network packet search engine <b>102</b> actively responds to the network processing unit <b>104</b>. For this embodiment, if the search command comprises a retrieval command, the network packet search engine <b>102</b> uses its longest prefix match to retrieve data from the corresponding external memory <b>110</b> and transmits that data to the network processing unit <b>104</b>. Similarly, if the search command comprises an insertion command, the network packet search engine <b>102</b> stores data from the network processing unit <b>104</b> in its corresponding external memory <b>110</b>, in addition to storing the specific search key in its own prefix table <b>200</b>.</p>
<p id="p-0054" num="0053">According to another embodiment, the network packet search engine <b>102</b> passively responds to the network processing unit <b>104</b>. For this embodiment, any one of the network packet search engines <b>102</b> may provide a “not ready” signal to the network processing unit <b>104</b> until one of the network packet search engines <b>102</b> determines that its longest prefix match is the overall longest prefix match in decisional step <b>324</b>. Then, at step <b>326</b>, that network packet search engine <b>102</b>, which has stored its result (either data retrieved from the corresponding external memory <b>110</b> for a retrieval command or identifying itself as the location for storing a new prefix for an insertion command) in its output buffer, provides a “ready” signal to the network processing unit <b>104</b>. Thus, for this embodiment, the network processing unit <b>104</b> may retrieve the data from the output buffer instead of having the data actively transmitted from the network packet search engine <b>102</b>.</p>
<p id="p-0055" num="0054">For this passive embodiment, the network packet search engine <b>102</b> that provides the “not ready” signal and the network packet search engine <b>102</b> that provides the “ready” signal, along with the appropriate data in its output buffer, are synchronized such that the hand-off from one to the other occurs during a clock cycle. This prevents the possibility of having either no network packet search engines <b>102</b> or multiple network packet search engines <b>102</b> trying to communicate with the network processing unit <b>104</b> at any one time.</p>
<p id="p-0056" num="0055">Returning to decisional step <b>324</b>, if the network packet search engine <b>102</b> determines that its longest prefix match is not longer than all the longest match input data received from other network packet search engines <b>102</b>, the method follows the No branch from decisional step <b>324</b> to step <b>328</b>. At step <b>328</b>, the network packet search engine <b>102</b> may store a mock result in its output buffer as a position holder in order to ensure that correct result ordering is maintained, and the method comes to an end.</p>
<p id="p-0057" num="0056">Although the present invention has been described with several embodiments, various changes and modifications may be suggested to one skilled in the art. It is intended that the present invention encompass such changes and modifications as fall within the scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for providing cascaded network packet search engines, comprising:
<claim-text>receiving a search command at each one of a plurality of network packet search engines, the search command comprising a specific search key;</claim-text>
<claim-text>determining at each one of the network packet search engines a longest prefix match based on the specific search key;</claim-text>
<claim-text>determining at one of the network packet search engines whether its determined longest prefix match comprises an overall longest prefix match among the other determined longest prefix matches of the other network packet search engines; and</claim-text>
<claim-text>responding to the search command when its determined longest prefix match comprises the overall longest prefix match, wherein responding to the search command comprises a one of:
<claim-text>retrieving data from memory and transmitting the retrieved data, and</claim-text>
<claim-text>storing data to memory.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, responding to the search command comprising actively responding to the search command.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, responding to the search command comprising passively responding to the search command.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising storing a mock result when the longest prefix match fails to comprise the overall longest prefix match.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, the one of the network packet search engines comprising a peripheral network packet search engine, determining whether its determined longest prefix match comprises the overall longest prefix match comprising:
<claim-text>receiving longest match input data from an adjacent network packet search engine;</claim-text>
<claim-text>comparing the longest match input data to its determined longest prefix match; and</claim-text>
<claim-text>determining that its determined longest prefix match is longer than the longest match input data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, the one of the network packet search engines comprising a central network packet search engine, determining whether its determined longest prefix match comprises the overall longest prefix match comprising:
<claim-text>receiving first longest match input data from a first adjacent network packet search engine and second longest match input data from a second adjacent network packet search engine;</claim-text>
<claim-text>comparing the first longest match input data to its determined longest prefix match and the second longest match input data to its determined longest prefix match; and</claim-text>
<claim-text>determining that its determined longest prefix match is longer than the first longest match input data and longer than the second longest match input data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method for providing cascaded network packet search engines, comprising:
<claim-text>receiving a search command at each one of a plurality of network packet search engines, the search command comprising a specific search key;</claim-text>
<claim-text>at each of the network packet search engines, determining a longest prefix match for the network packet search engine based on the specific search key;</claim-text>
<claim-text>at each of the network packet search engines, determining whether its longest prefix match comprises an overall longest prefix match among the other determined longest prefix matches of the other plurality of network packet search engines; and</claim-text>
<claim-text>responding to the search command based on the determination that the longest prefix match of the network packet search engine comprises the overall longest prefix match, wherein responding to the search command comprises a one of:
<claim-text>retrieving data from memory and transmitting the retrieved data, and</claim-text>
<claim-text>storing data to memory.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, responding to the search command comprising actively responding to the search command.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, responding to the search command comprising passively responding to the search command.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising storing a mock result based on the determination that the network packet search engine fails to comprise the overall longest prefix match.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, determining whether the determined longest prefix match comprises the overall longest prefix match comprising, for each peripheral network packet search engine:
<claim-text>receiving longest match input data from an adjacent network packet search engine;</claim-text>
<claim-text>comparing the longest match input data to the determined longest prefix match; and</claim-text>
<claim-text>determining whether the determined longest prefix match is longer than the longest match input data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, determining whether the determined longest prefix match comprises the overall longest prefix match comprising, for each central network packet search engine:
<claim-text>receiving first longest match input data from a first adjacent network packet search engine and second longest match input data from a second adjacent network packet search engine;</claim-text>
<claim-text>comparing the first longest match input data to the determined longest prefix match and the second longest match input data to the determined longest prefix match; and</claim-text>
<claim-text>determining whether the determined longest prefix match is longer than the first longest match input data and longer than the second longest match input data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A network packet search engine coupled to at least one other network packet search engine, the network packet search engine operable to:
<claim-text>receive a search command, the search command comprising a specific search key,</claim-text>
<claim-text>determine a longest prefix match based on the specific search key,</claim-text>
<claim-text>determine whether its longest prefix match comprises an overall longest prefix match among another longest prefix match determined by the at least one other network packet search engine, and</claim-text>
<claim-text>respond to the search command based on the determination that the longest prefix match of the network packet search engine comprises the overall longest prefix match, wherein respond to the search command comprises a one of:
<claim-text>retrieve data from memory and transmitting the retrieved data, and</claim-text>
<claim-text>store data to memory.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The network packet search engine of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further operable to actively respond to the search command.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The network packet search engine of <claim-ref idref="CLM-00013">claim 13</claim-ref>, further operable to passively respond to the search command.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The network packet search engine of <claim-ref idref="CLM-00013">claim 13</claim-ref>, the network packet search engine comprising a peripheral network packet search engine and further operable to:
<claim-text>determine whether its determined longest prefix match comprises the overall longest prefix match by receiving longest match input data from an adjacent network packet search engine, comparing the longest match input data to its determined longest prefix match, and determining whether its determined longest prefix match is longer than the longest match input data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The network packet search engine of <claim-ref idref="CLM-00013">claim 13</claim-ref>, the network packet search engine comprising a central network packet search engine and further operable to:
<claim-text>determine whether its determined longest prefix match comprises the overall longest prefix match by receiving first longest match input data from a first adjacent network packet search engine and second longest match input data from a second adjacent network packet search engine, comparing the first longest match input data to its determined longest prefix match and the second longest match input data to its determined longest prefix match, and determining whether its determined longest prefix match is longer than the first longest match input data and longer than the second longest match input data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. A processing system, comprising:
<claim-text>a network processing unit; and</claim-text>
<claim-text>a plurality of network packet search engines coupled to the network processing unit, each network packet search engine operable to:</claim-text>
<claim-text>receive a search command from the network processing unit, the search command comprising a specific search key,</claim-text>
<claim-text>determine a longest prefix match based on the specific search key,</claim-text>
<claim-text>determine whether its determined longest prefix match comprises an overall longest prefix match among the other determined longest prefix matches of the other plurality of network packet search engines, and</claim-text>
<claim-text>respond to the search command based on the determination that the longest prefix match of the network packet search engine comprises the overall longest prefix match.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
