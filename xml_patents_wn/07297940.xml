<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07297940-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07297940</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11121199</doc-number>
<date>20050503</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>309</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>B</section>
<class>01</class>
<subclass>D</subclass>
<main-group>59</main-group>
<subgroup>44</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>01</class>
<subclass>J</subclass>
<main-group>59</main-group>
<subgroup>44</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>250282</main-classification>
<further-classification>436 89</further-classification>
<further-classification>436 90</further-classification>
<further-classification>436 96</further-classification>
<further-classification>436 94</further-classification>
<further-classification>436173</further-classification>
<further-classification>703 11</further-classification>
<further-classification>703 12</further-classification>
<further-classification>702 23</further-classification>
<further-classification>702 27</further-classification>
<further-classification>702 19</further-classification>
<further-classification>702 22</further-classification>
<further-classification>702 20</further-classification>
<further-classification>702 76</further-classification>
<further-classification>702 32</further-classification>
<further-classification>702194</further-classification>
<further-classification>503334</further-classification>
<further-classification>503335</further-classification>
<further-classification>503336</further-classification>
<further-classification>503337</further-classification>
</classification-national>
<invention-title id="d0e53">Method, apparatus, and program product for classifying ionized molecular fragments</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5538897</doc-number>
<kind>A</kind>
<name>Yates et al.</name>
<date>19960700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>436 89</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6017693</doc-number>
<kind>A</kind>
<name>Yates et al.</name>
<date>20000100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>435  5</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6582965</doc-number>
<kind>B1</kind>
<name>Townsend et al.</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>436 89</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6963807</doc-number>
<kind>B2</kind>
<name>Townsend et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702 27</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2006/0136158</doc-number>
<kind>A1</kind>
<name>Goldberg et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702 76</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00006">
<othercit>D. Harel and Y. Koren, A Fast Multi-Scale Mehtod for Drawing Large Graphs, Journal of Graph Algorithms and Applications, vol. 6 (2002), No. 3, 179-202.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00007">
<othercit>Kenneth G. Standing, <i>Peptide And Protein De Novo Sequencing By Mass Spectrometry</i>, Current Opinion in Structural Biology 2003, 13:595-601.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>Sandrine Uttenweiler-Joseph, Gitte Neubauer, Savvas Christoforidis, Marino Zerial &amp; Matthias Wilm, <i>Automated De Novo Sequencing Of Proteins Using The Differential Scanning Technique</i>, Proteomics 2001, 1,668-682.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>J. Alex Taylor &amp; Richard S. Johnson, <i>Implementation And Uses Of Automated De Novo Peptide Sequencing By Tendem Mass Spectrometry</i>, Anal. Chem. 2001, 73, 2594-2604.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Ting Chen, Ming-Yang Kao, Matthew Tepel, John Rush &amp; George M. Church, <i>A Dynamic Programming Approach To De Novo Peptide Sequencing Via Tandem Mass Spectrometry</i>, Journal Of Computational Biology, vol. 8, 2001, 325-337.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Bin Ma et al., <i>An Effective Algorithm For The Peptide De Novo Sequencing From MS/MS Spectrum</i>, Symp. Comb. Pattern Matching, 2003, 266-278.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Olaf Lubeck et al., <i>New Computational Approaches For De Novo Peptide Sequencing From MS/MS Experiments</i>, Proceedings Of The IEEE, vol. 90, 2002, 1868-1874.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Robert M. Day et al., <i>PPM-Chain-De Novo Peptide Identification Program Comparable In Performance To Sequest</i>, Proc. IEEE Computational Systems Bioinformatics, 2004, 505-508.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Bo Yan et al., <i>Separation Of Ion Types In Tandem Mass Spectrometry Data Interpretation—A Graph-Theoretic Approach</i>, Proc. Computational Systems Bioinformatics, 2004, 236-244.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>28</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>250282</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>436 89</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>436 90</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>436 96</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>436 94</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>436173</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 19</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 22</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 23</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 27</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 20</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 32</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702 76</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>702194</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>703 11</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>703 12</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>503334</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>503335</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>503336</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>503337</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>11</number-of-drawing-sheets>
<number-of-figures>13</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060249669</doc-number>
<kind>A1</kind>
<date>20061109</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bern</last-name>
<first-name>Marshall W.</first-name>
<address>
<city>San Carlos</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fay Sharpe LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Palo Alto Research Center Incorporated</orgname>
<role>02</role>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Berman</last-name>
<first-name>Jack</first-name>
<department>2881</department>
</primary-examiner>
<assistant-examiner>
<last-name>Sahu</last-name>
<first-name>Meenakshi</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Apparatus, methods, and program products are disclosed that classify spectral peaks in dissociation spectrum data and thereby improves the efficiency of molecular sequencing.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="202.27mm" wi="139.45mm" file="US07297940-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="187.88mm" wi="83.99mm" file="US07297940-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="157.06mm" wi="140.72mm" file="US07297940-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="233.09mm" wi="156.29mm" orientation="landscape" file="US07297940-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="218.69mm" wi="147.32mm" file="US07297940-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="232.33mm" wi="127.51mm" file="US07297940-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="195.66mm" wi="125.22mm" file="US07297940-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="223.52mm" wi="147.66mm" file="US07297940-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="214.29mm" wi="145.20mm" file="US07297940-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="210.14mm" wi="150.45mm" orientation="landscape" file="US07297940-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="197.27mm" wi="152.06mm" orientation="landscape" file="US07297940-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="205.06mm" wi="158.67mm" orientation="landscape" file="US07297940-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">1. Field</p>
<p id="p-0003" num="0002">This technology relates to the field of identifying a complex molecule having a structure that includes molecular subunits bound together at cleavage sites through the analysis of fragmentation spectra of the complex molecule.</p>
<p id="p-0004" num="0003">2. Background</p>
<p id="p-0005" num="0004">There are a number of techniques that can be used to identify complex molecules. Some of these techniques use fragmentation spectra of the complex molecules. Such fragmentation spectra can be generated by Tandem Mass Spectrometry (“MS/MS”) techniques as is well known in the art. Analysis of the fragmentation spectra can provide clues to the structure and the sequence of molecular subunits that make up the complex molecule.</p>
<p id="p-0006" num="0005">An ideal spectrum would contain a complete “ladder” of b-ions or y-ions from which we could simply read off the molecular subunit sequence or its reversal. Hence generation of candidate sequences is usually formulated as a longest (or best) path problem in a peak graph, which has a vertex for each peak in the spectrum and an edge connecting two peaks if they differ by the mass of a possible molecular subunit. Due to missed cleavages, peak graphs might use vertices corresponding to small mass ranges rather than peaks, and/or include edges between vertices differing by the mass of a pair of residues.</p>
<p id="p-0007" num="0006">One way to identify the structure of a complex molecule is to identify and score candidate sequences for the complex molecule in light of the fragmentation spectra. In one approach, the candidates can be found in a database of known molecules. U.S. Pat. No. 5,538,897 to Yates, III et al. (hereby incorporated by reference in its entirety) teaches such a method where the complex molecule is a protein or peptide. The difficulty with this approach is that the complex molecule needs to have been previously identified or predicted and its characteristics stored in the database. Thus, a fragmentation spectrum for a complex molecule that has not been previously characterized and entered into the database will not be identified.</p>
<p id="p-0008" num="0007">Another way to identify the structure of a complex molecule is to use the de novo sequencing approach. A method for sequencing peptides or proteins taking this approach is disclosed by U.S. Pat. No. 6,582,965 to Townsend et al. (hereby incorporated by reference in its entirety). In the de novo sequencing approach, the method attempts to generate all possible sequences of molecular subunits that could be consistent with the fragmentation spectrum. One problem with the de novo sequencing approach for proteins and peptides is that it is difficult to determine which peaks are y-ions (c-terminus fragments) and which peaks are b-ions (n-terminus fragments). The term “b/y ambiguity” identifies this difficulty. This difficulty is compounded because the fragmentation spectrum includes spectral peaks for noise (ions that are not fragments of the parent molecule) as well as spectral peaks for signals (ions that are fragments of the parent molecule). Noise in the fragmentation spectra decreases the probability of correctly sequencing a complex molecule from fragmentation spectra.</p>
<p id="p-0009" num="0008">Furthermore, it is very rare for a peptide spectrum to have a complete ladder of b- or y-ions, and hence most sequencers attempt to form a ladder from a mixture of the two types. Lutefisk (see <i>Implementation anduUses of Automated De Novo Peptide Sequencing by Tandem Mass Spectrometry, </i>by Taylor et al. (Anal. Chem., 73 (2001), 2594-2604)) turns each peak into two vertices, one at the observed mass and the other at the complementary mass. Such complementation has two drawbacks: in effect it adds many noise peaks, and it allows the use of a single peak as both a b- and a y-ion. A paper entitled <i>A Dynamic Programming Approach to De Novo Peptide Sequencing by Mass Spectrometry, </i>by Chen et al. (J. Computational Biology, 8 (2001), 325-337) showed how to correct the latter drawback with a longest-path algorithm that disallows the simultaneous use of both vertices from a single peak. A paper entitled <i>An Effective Algorithm for the Peptide De Novo Sequencing from MS/MS Spectrum, </i>by Ma et al. (Symp. Comb. Pattern Matching, 2003, 266-278) teaches a more subtle fix; they allow the simultaneous use of both vertices, but do not score the peak twice. None of these solutions, however, addresses the larger drawback—doubling the number of noise peaks.</p>
<p id="p-0010" num="0009">A paper entitled <i>New Computational Approaches for De Novo Peptide Sequencing from MS/MS Experiments, </i>by Lubeck et al., (Proc. IEEEV 90, (2002), 1868-1874) proposed the idea of classifying peaks as b-, y-, or “other” prior to running the longest-path algorithm. The longest-path algorithm would use the peak classifications and would avoid complementing every peak. Lubeck did not disclose algorithms or results.</p>
<p id="p-0011" num="0010">A paper entitled <i>PPM</i>-<i>Chain—De Novo Peptide Identification Program Comparable in Performance to Sequest, </i>by Day et al., (Proc. IEEE Computational Systems Bioinformatics, 2004, 505-508) independently proposed peak classification (as an alternative rather than as an adjunct to the longest-path algorithm), and built a three-class classifier keying on b/y pairs and the “neutral loss neighborhood” (about 30 Daltons) around each peak.</p>
<p id="p-0012" num="0011">A paper entitled <i>Separation of Ion Types in Tandem Mass Spectrometry Data Interpretation—A Graph</i>-<i>Theoretic Approach, </i>by Yan et al., (Proc. IEEE Computational Systems Bioinformatics, 2004, 236-244) disclosed the same idea and formulated the classification problem as a graph tripartition problem. They disclosed an exponential-time algorithm for an exact solution to the problem.</p>
<p id="p-0013" num="0012">Thus, it would be advantageous to find a method that is able to classify spectral peaks in the fragmentation spectra as b-ions and y-ions with weights for classification confidence, without increasing the noise in the fragmentation spectra and that uses a less computationally demanding algorithm than Yan et al.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0002" level="1">DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref> Illustrates a molecular sequencing system;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a computer system in accordance with a preferred embodiment;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a histogram of an example dissociation spectrum that can be produced by a tandem mass spectrometer and that indicates the number of ions observed at each m/z value;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 4</figref> illustrates one embodiment of a molecular fragment classification process;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 5</figref> illustrates one embodiment of a process that initializes a spring system responsive to dissociation spectrum data;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 6</figref> illustrates one embodiment of an ‘apply confidence-weighted classification’ process;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 7</figref> illustrates one embodiment of an ‘adjust spectral peak intensities’ process;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a ‘determine possible sequence of molecular subunits’ process;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 9</figref> illustrates a first portion of an edge-weighting process for the spring system;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 10</figref> illustrates a second portion of the edge-weighting process for the spring system;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 11</figref> illustrates a partitioned and classified two dimensional eigenspace resulting from the spectrum represented by <figref idref="DRAWINGS">FIG. 3</figref>;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 12</figref> illustrates a partitioned and identified two dimensional eigenspace resulting from the sequencing of the vertices classified as shown in <figref idref="DRAWINGS">FIG. 11</figref>; and</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 13</figref> illustrates a sequenced dissociation spectrum data that can result from a tandem mass spectrometer spectrum that has been analyzed by the process of <figref idref="DRAWINGS">FIG. 4</figref> and that generated the eigenspace of <figref idref="DRAWINGS">FIG. 11</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0003" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0027" num="0026">The following ‘notations and nomenclature’ are provided to assist in the understanding of the presented technology and embodiments thereof.</p>
<p id="p-0028" num="0027">Programmed routine or function—A programmed routine or a programmed function is a sequence of program code, in any programming methodology, that can be invoked, with or without parameters, to perform its designed operation responsive to any provided parameters, accessible state, and/or accessible data. A programmed routine or function can be instructions that are processed by general purpose CPU or other electronics. A programmed function generally returns a value. A programmed routine or function can often be implemented in electronics designed to perform the designated operation and can provide result values either with digital values, analog values, or a combination of digital and analog values.</p>
<p id="p-0029" num="0028">Present, presented, presenting—The result of the operation of embodiments of the technology described herein can be “presented” by the embodiment. This can include storing representations of a spectrum with spectral peaks identified by the use of the technology or displaying data from such a spectrum; displaying or storing molecular sequences identified by the use of the technology; passing data representing or derived from the use of the technology to another system (for example, a computer via use of a computer-usable data carrier such as tangible storage devices or a network—and/or using remote procedure call protocols), to another procedure, and/or to a programmed routine.</p>
<p id="p-0030" num="0029">Procedure—A procedure is a self-consistent sequence of computerized steps that lead to a desired result. These steps can be defined by one or more computer instructions. These steps can be performed by a computer executing the instructions that define the steps. Thus, the term “procedure” can refer (for example, but without limitation) to a sequence of instructions, a sequence of instructions organized within a programmed-procedure or programmed-function, or a sequence of instructions organized within programmed-processes executing in one or more computers. Such a procedure can also be implemented directly in specialized circuitry that performs the steps.</p>
<p id="p-0031" num="0030">The inventor has developed apparatus, methods, and program products that classify spectral peaks in dissociation spectrum data and thereby improves the efficiency of molecular sequencing. This is accomplished by accessing dissociation spectrum data that includes spectral peaks representing fragments of a parent molecule. The parent molecule includes molecular subunits and cleavage sites wherein each of the cleavage sites connects a first one of the molecular subunits and a second one of the molecular subunits. The spectral peaks are associated with peak intensities. Some of the spectral peaks are selected to be represented by corresponding vertices. Weighted edges are assigned to the corresponding vertices and then a confidence-weighted classification is applied to corresponding vertices responsive to the weighted edges. Once the vertices are classified, the peak intensities can be adjusted responsive to the classification and the peak intensities are presented.</p>
<p id="p-0032" num="0031">The inventor has realized that classifying peaks as b-ions, y-ions and “others”, is unnecessary to improve de novo analysis. When using classification in conjunction with the longest-path algorithm, it suffices to solve a much easier problem: divide the peaks into two groups, such that one group contains all the b-ions and the other contains all the y-ions. Such a bipartition allows one group to be complemented (subtracted from the parent ion mass) and thereby removes the b/y ambiguity of peaks without doubling the number of noise peaks. The inventor applies spectral graph partitioning—a polynomial-time algorithm—to this bipartition problem. By using a polynomial-time algorithm instead of an exponential-time algorithm, much more complex spectra can be classified.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 1</figref> illustrates operation of a molecular sequencing system <b>100</b>. In such a system, a chemical sample <b>101</b> is input to a tandem mass spectrometer <b>103</b> that generates a dissociation spectrum <b>105</b> (see <figref idref="DRAWINGS">FIG. 3</figref>). The dissociation spectrum <b>105</b> can be filtered by an optional spectrum filter <b>107</b> to pass high quality spectra to a de novo sequencer <b>109</b> that processes the dissociation spectrum <b>105</b> to determine a possible sequence of chemical subunits <b>111</b> of the chemical sample <b>101</b> that can be presented.</p>
<p id="p-0034" num="0033">One skilled in the art will understand that a tandem mass spectrometer generates the dissociation spectrum data by selecting parent molecules having a specific molecular mass (within a tolerance) in a first stage of the tandem mass spectrometer, causing the selected parent molecules to be fragmented at cleavage sites (using methods known to one skilled in the art), and accumulating the count of the resulting fragments in m/z histogram bins. A number of bins can represent a single spectral peak. Either the height or the area of the spectral peak will be referred to as the spectral peak's “intensity”.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a computer system <b>200</b> that can incorporate the disclosed technology. The computer system <b>200</b> includes a computer <b>201</b> that incorporates a CPU <b>203</b>, a memory <b>205</b>, and, in some embodiments, a network interface <b>207</b>. The network interface <b>207</b> provides the computer <b>201</b> with access to a network <b>209</b>. The computer <b>201</b> also includes an I/O interface <b>211</b> that can be connected to a user interface device(s) <b>213</b>, a storage system <b>215</b>, and a removable data device <b>217</b>. The removable data device <b>217</b> can read a tangible computer-usable data carrier <b>219</b> that typically contains a program product <b>221</b>. The storage system <b>215</b> (along with the removable data device <b>217</b>), the tangible computer-usable data carrier <b>219</b> and any network file storage comprise a file storage mechanism. The tangible computer-usable data carrier <b>219</b> can be a ROM within the computer system <b>200</b>, within replaceable ROM, a memory stick, CD, floppy, DVD or any other tangible media. The program product <b>221</b> accessed from the tangible computer-usable data carrier <b>219</b> is generally read into the memory <b>205</b> as a program <b>223</b> that instructs the CPU to perform the processes described herein as well as other processes. In addition, the program product <b>221</b> can be provided from the network (generally encoded within an electromagnetic carrier wave—including light, radio, and electronic signaling) through the network interface <b>207</b>. One skilled in the art will understand that the network <b>209</b> is another computer-usable data carrier.</p>
<p id="p-0036" num="0035">A tandem mass spectrometer <b>225</b> can be in direct communication with the I/O interface <b>211</b> and can provide dissociation spectrum data directly to the computer <b>201</b> (for example, by using a data bus (for example a USB, FireWire®, or custom connection). In addition, the tandem mass spectrometer <b>225</b> can provide dissociation spectrum data over the network <b>209</b>, or via the tangible computer-usable data carrier <b>219</b>. One skilled in the art will understand that not all of the displayed features of the computer <b>201</b> need to be present for all embodiments.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an example tandem mass spectrometer dissociation spectrum <b>300</b> of a parent molecule plotted on an x-axis in m/z <b>301</b> and a y-axis in intensity <b>303</b>. The parent molecule generally includes a number of molecular subunits connected by cleavage sites. The tandem mass spectrometer generally disassociates many of the parent molecules into at least two fragments at any of the cleavage sites. The dissociation spectrum data indicate the number of fragments produced having similar m/z. The location of the spectral peak on the x-axis in m/z <b>301</b> represents the mass of a singly charged ion. The term intensity refers to the height or area of the spectral peak. The intensity of a spectral peak indicates how often the parent molecules have been fragmented at a particular cleavage site. The m/z, intensity, structure, and shape of the spectral peak are some of the characteristics of the spectral peak.</p>
<p id="p-0038" num="0037">The tandem mass spectrometer often provides annotation information for the spectral peaks such as the m/z for selected intense spectral peaks. It can also detect doubly charged parent molecules. As previously discussed, one difficulty with this representation is that it is very difficult to determine noise peaks from dissociation (or fragmentation) spectral peaks. In the case of peptides and proteins, it is very difficult to determine which spectral peaks indicate b-ions, y-ions, a-ions, or noise. One skilled in the art will understand one of the very significant problems in protein and/or peptide sequencing is that of determining whether a spectral peak represents a y-ion, a b-ion, or noise. This is the b/y ambiguity problem.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a molecular fragment classification process <b>400</b> that can be used as, or by the de novo sequencer <b>109</b> to determine one or more possible sequences of molecular subunits that make up a parent molecule. The molecular fragment classification process <b>400</b> initiates at a ‘start’ terminal <b>401</b> and continues to an ‘access dissociation spectrum data’ procedure <b>403</b> that accesses the dissociation spectrum data. The dissociation spectrum data can be accessed from the storage system <b>215</b>, the network <b>209</b>, the tangible computer-usable data carrier <b>219</b>, or directly from the tandem mass spectrometer <b>225</b> or by any other data access technique or technology. The dissociation spectrum data includes spectral peaks. The spectral peaks have intensities, which are initially related to ion counts but may be changed responsive to subsequent computations.</p>
<p id="p-0040" num="0039">The parent molecule may be a protein, peptide, lipid, polymer (composed of a single monomer, or multiple monomers), glycan, etc. Much of the rest of this description is cast in the context of peptides and amino acids. However, one skilled in the art will understand that the techniques taught herein can be applied to other molecules that have molecular subunits connected by cleavage sites.</p>
<p id="p-0041" num="0040">Once the dissociation spectrum data is accessed, an ‘assign ranking and weighted edges to spectral peaks’ procedure <b>405</b> processes the dissociation spectrum data to identify the m/z (mass) and intensity of the spectral peaks, select the relevant spectral peaks, and ranks the spectral peaks in intensity order (irank). One skilled in the art will understand that the spectral peak data in the dissociation spectrum data is generally not directly manipulated, but rather the spectral peaks' characteristics are obtained from the dissociation spectrum data and used to establish values in data structures (often termed vertices herein) that represent the characteristics of the spectral peaks.</p>
<p id="p-0042" num="0041">The ‘assign ranking and weighted edges to spectral peaks’ procedure <b>405</b> also initializes a data structure called a spring system that establishes weighted edges between the vertices that represent the spectral peaks. Some embodiments can insert artificial vertices into the array and provide weighted edges between the artificial peaks and some or all of the spectral peak vertices. The array created by the ‘assign ranking and weighted edges to spectral peaks’ procedure <b>405</b> is analogous to a physical spring system in which the intensity of a peak is analogous to a mass and the weighted edge is analogous to a spring that provides a repulsion/attraction force between the peaks connected by the weighted edge. The inventor believes that this is the first application of a spring system to dissociation spectrum data. The ‘assign ranking and weighted edges to spectral peaks’ procedure <b>405</b> is subsequently described with respect to <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0043" num="0042">Once the spring system data structure is created, an ‘apply confidence-weighted classification to the spectral peaks’ procedure <b>407</b> applies a confidence-weighted classification process to the spring system represented by the data structure. This generates two eigenvectors that establish a two-dimensional eigenspace. The vertices that represent the spectral peaks are projected into the eigenspace and used to fit a line. In some embodiments, a second line, orthogonal to the first line, can be used to partition the eigenspace. Thus, the spectral peaks selected from the dissociation spectrum data can be classified into two or more classifications responsive to the weighted edges between the vertices representing the selected peaks.</p>
<p id="p-0044" num="0043">While one skilled in the art could believe that the classification of vertices is accomplished by determining the distance between the vertices representing the spectral peaks and the artificial peaks, such a one, after reading and understanding the disclosure herein described (for example that associated with <figref idref="DRAWINGS">FIG. 7</figref>), will appreciate that the partitioning of the spectral peaks instead depends on the partitioning of the eigenspace responsive to the projection of the vertices within the eigenspace. The ‘apply confidence-weighted classification to the spectral peaks’ procedure <b>407</b> is subsequently described with respect to <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0045" num="0044">Next an ‘adjust spectral peak intensities’ procedure <b>409</b> adjusts the spectral peak intensities responsive to the results of the ‘apply confidence-weighted classification to the spectral peaks’ procedure <b>407</b> and, in some embodiments, responsive to the intensity ranking of the spectral peaks. This is subsequently described with respect to <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0046" num="0045">Once the spectral peak intensities in the vertices have been adjusted, an optional ‘determine possible sequence of molecular subunits’ procedure <b>411</b> can be applied to the adjusted spectral peak intensities to create possible sequences of molecular subunits that are consistent with the mass of the parent molecule and the dissociation spectrum data. In addition, or separately, an optional ‘recreate spectrum’ procedure <b>412</b> can recreate a mass-over-charge spectrum based on the adjusted peak intensities, which then can be used by other sequencing processes. Regardless of which combination of the optional ‘determine possible sequence of molecular subunits’ procedure <b>411</b> or the optional ‘recreate spectrum’ procedure <b>412</b> (if any) is used, a ‘present data’ procedure <b>413</b> can be used to present the adjusted peak intensities, the classification of the vertices, the adjusted dissociation spectrum data, and/or results of the optional processes for subsequent processing by other sequencing programs, to store, display, or otherwise present the results; or to present the results of the sequencing of the molecular subunits. One skilled in the art will understand that such a sequencer can generate more than one possible molecular subunit sequence for the parent molecule. Such a one will also understand that adjusted dissociation spectrum data can be generated from the characteristics of the vertices.</p>
<p id="p-0047" num="0046">The molecular fragment classification process <b>400</b> completes through an ‘end’ terminal <b>415</b>. One skilled in the art will understand that another spectrum can be processed by restarting the molecular fragment classification process <b>400</b>. Furthermore, such a one will understand that the molecular fragment classification process <b>400</b> lends itself to parallel processor architectures.</p>
<p id="p-0048" num="0047"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a ‘spring system initialization’ process <b>500</b> that is one embodiment of the ‘assign ranking and weighted edges to spectral peaks’ procedure <b>405</b> of <figref idref="DRAWINGS">FIG. 4</figref>. The ‘spring system initialization’ process <b>500</b> operates on the spectral data characteristics that have been extracted from the data accessed by the ‘access dissociation spectrum data’ procedure <b>403</b>. The ‘spring system initialization’ process <b>500</b> can also include an ‘estimate parent ion mass’ procedure <b>503</b> that estimates the mass of the parent ion using spectral peaks that appear to be complementary pairs. This estimation includes locating the nominal mass of the complex molecule as determined by the tandem mass spectrometer from data provided in the spectral data, summing spectral peak pairs, and if the sum of the spectral peak pair is within a tolerance of the nominal mass, accumulating that sum of the spectral peak pair. Once all relevant spectral peak pair sums are accumulated, a statistical analysis is performed on the accumulated spectral peak pair sums to estimate the mass of the complex molecule.</p>
<p id="p-0049" num="0048">A ‘select spectral peaks for spring system vertices’ procedure <b>505</b> selects spectral peaks from the spectral data that have a high intensity (relative to those of similar m/z) and that do not appear to be isotopes, doubly charged, or the result of water losses (determined by the spectral peak mass and intensity relationships to nearby spectral peaks). These techniques are known to one skilled in the art.</p>
<p id="p-0050" num="0049">An ‘initialize spring system’ procedure <b>507</b> allocates sufficient memory to represent a spring system between vertices that represent the spectral peaks selected by the ‘select spectral peaks for spring system vertices’ procedure <b>505</b> as well as any artificial-vertices used in the spring system. An ‘assign weighted edge between adjacent vertices’ procedure <b>509</b> assigns weighted edges between the vertices as is subsequently described with respect to <figref idref="DRAWINGS">FIG. 9</figref> and <figref idref="DRAWINGS">FIG. 10</figref>.</p>
<p id="p-0051" num="0050"><figref idref="DRAWINGS">FIG. 6</figref> illustrates an ‘apply confidence-weighted classification’ process <b>600</b> that applies a confidence-weighted classification process (such as a spectral clustering algorithm) to the spring system that was initialized by the ‘initialize spring system’ procedure <b>507</b>. A ‘create eigenspace’ procedure <b>603</b> determines the first two eigenvectors, corresponding to the smallest eigenvalues for the spring system. The first eigenvector is a solution to a least-squares problem of minimizing the potential energy of the spring system in accordance with:</p>
<p id="p-0052" num="0051">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mn>1</mn>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>t</mi>
        </msup>
        <mo>⁢</mo>
        <mi>Dx</mi>
      </mrow>
    </mfrac>
    <mo>⁢</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <munder>
          <mo>∑</mo>
          <mrow>
            <mi>i</mi>
            <mo>,</mo>
            <mi>j</mi>
          </mrow>
        </munder>
        <mo>⁢</mo>
        <mrow>
          <msup>
            <mrow>
              <mo>(</mo>
              <mrow>
                <msub>
                  <mi>x</mi>
                  <mi>i</mi>
                </msub>
                <mo>-</mo>
                <msub>
                  <mi>x</mi>
                  <mi>j</mi>
                </msub>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <msub>
            <mi>a</mi>
            <mi>ij</mi>
          </msub>
        </mrow>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <mrow>
        <msup>
          <mi>x</mi>
          <mi>t</mi>
        </msup>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>A</mi>
            <mo>-</mo>
            <mi>D</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mi>x</mi>
    </mrow>
    <mrow>
      <msup>
        <mi>x</mi>
        <mi>t</mi>
      </msup>
      <mo>⁢</mo>
      <mi>Dx</mi>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
where A is the matrix of edge weights and D is a diagonal matrix containing the row sums of the absolute values of A's entries.
</p>
<p id="p-0053" num="0052">The second eigenvector is a vibrational mode of the spring system. In one embodiment, the inventors use the first and second eigenvectors to establish a two dimensional eigenspace R that represents the spring system. A ‘project vertices into eigenspace’ procedure <b>605</b> then maps the vertices of the spring system into R. We next fit a reference line L to the vertices in R using, for example, a least squares fit, and then use a line P, orthogonal to L, that passes through the origin of R as a partitioning line. An example R is illustrated in <figref idref="DRAWINGS">FIG. 11</figref>.</p>
<p id="p-0054" num="0053">Once the partitioning line P is established, an optional ‘group vertices by partitioning the eigenspace’ procedure <b>607</b> can classify the vertices in R into two groups (say as groups S and T) depending on which side of line P the vertex falls. For peptide spectra, vertices in the same group are likely to be the same type (for example, b-ions or y-ions). Although the vertices are separated into S and T groups, it is not known which group contains the y-ions and which group contains the b-ions. In some embodiments (for example those that sequence glycans), the eigenspace need not be partitioned because the rank of the vertex with respect to the reference line L can be sufficient to assist in the sequencing.</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 7</figref> illustrates an ‘adjust spectral peak intensities’ process <b>700</b> that can be one embodiment of the ‘adjust spectral peak intensities’ procedure <b>409</b>. The ‘adjust spectral peak intensities’ process <b>700</b> first applies a ‘complement mass for one group’ procedure <b>701</b> to complement each vertex in one of the groups by subtracting the vertex's mass from the parent molecule's mass (and optionally adjusting for any appropriate reaction mass loss/gain). Thus we can complement S to produce S′. Once we have S′, a ‘rank vertices with respect to fit’ procedure <b>703</b> ranks the vertices with respect to line L (lrank—which is the position of the vertex projected along line L). Next, a ‘reweight spectral peak’ procedure <b>705</b> re-weights the spectral peaks responsive to the intensity rank (irank) and lrank:</p>
<p id="p-0056" num="0055">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>Intensity</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <msub>
        <mi>v</mi>
        <mi>i</mi>
      </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mn>1</mn>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>·</mo>
            <mrow>
              <mi>lrank</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <msub>
                  <mi>v</mi>
                  <mi>i</mi>
                </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mi>irank</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <msub>
                <mi>v</mi>
                <mi>i</mi>
              </msub>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0057" num="0056">In protein and peptide analysis (where the spectra often only have two classifications (for example, y-ion and other; or b-ion and other) the ‘rank vertices with respect to fit’ procedure <b>703</b> limits the maximum lrank to that of the maximum lrank resulting from vertices on the positive side of L. Other types of parent molecules may not need this constraint.</p>
<p id="p-0058" num="0057">In protein and peptide analysis y-ions are often preferred. Thus, additional information can be developed by including the artificial B and Y vertices (see the subsequent discussion with respect to <figref idref="DRAWINGS">FIG. 9</figref>) in the spring system. The half of the eigenspace that contains the artificial B vertex is the half that probably includes the b-ions, while the eigenspace half that contains the artificial Y vertex is probably the half that contains the y-ions. If the artificial B and artificial Y vertices end up in the same eigenspace partition, one can determine the distance from the partition line P to the vertices to break the tie. The inventor has determined that this method correctly identifies b-ions and y-ions at least 70% of the time. While this provides a high probability of resolution for the b/y ambiguity problem, one embodiment will still try both “y-ion half” and “b-ion half” assignments of S and T in order to capture all possible sequences (for example, see the subsequent description with respect to <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0059" num="0058">Next, a ‘construct peak graph’ procedure <b>707</b> builds a Peak graph from the vertices in S′ and T with edges between two peaks that differ by the mass of one or two amino acid residues (larger amino acid masses are allowed for the initial and final gaps). The Peak graph can be presented to storage, for display, or to another procedure for subsequent processing.</p>
<p id="p-0060" num="0059"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a ‘determine possible sequence of molecular subunits’ process <b>800</b> that can use the Peak graph generated by the ‘construct peak graph’ procedure <b>707</b> to determine possible sequences for the parent molecule. A ‘compute longest path in the Peak graph’ procedure <b>801</b> uses well-known techniques for determining the longest path in the Peak graph. Once the longest path is determined, a ‘generate candidate sequences’ procedure <b>803</b> converts the path into candidate sequences for the complex molecule. A subsequent scoring procedure (not shown) can use techniques that are well known to one skilled in the art to rank the candidate sequences with respect to the likelihood that the sequence is correct for the parent molecule. In one embodiment, at least six sequences are generated. These six sequences result from: 1) using S as y-ions and where the sequence ends in R; 2) using S as y-ions and assuming the sequence ends in K; 3) using S as y-ions and assuming the sequence ends in an unknown letter; 4) using T as y-ions and assuming the sequence ends in R; 5) using T as y-ions and assuming the sequence ends in K; and 6) using T as y-ions and assuming the sequence ends in an unknown letter. The sequences can be presented to storage, for display, or to another procedure for subsequent processing.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 9</figref> illustrates an edge-weighting process <b>900</b> that can be invoked at the ‘assign weighted edge between adjacent vertices’ procedure <b>509</b> of <figref idref="DRAWINGS">FIG. 5</figref> to establish the edge weights for the spring system prior to application of the confidence-weighted classification.</p>
<p id="p-0062" num="0061">The edge-weighting process <b>900</b> is illustrated by pseudocode. Pseudocode is a generic way of describing an algorithm without use of any specific programming language syntax. Pseudocode cannot be executed on a real computer, but it models and resembles real programming code. The pseudocode is provided to aid one skilled in the art understand details of the algorithms. One skilled in the art would understand how to implement these steps using any programming language or methodology. Such a one will also understand that equivalent electronics can embody the techniques described herein. Sections of the pseudocode are extracted into Tables 1-10 and some aspects of the “syntax” of the pseudocode become more clear when the code is combined from the tables.</p>
<p id="p-0063" num="0062">The weighted edges establish affinities between the vertices in the spring system that represents the spectral peak intensities in the dissociation spectrum data. The edge-weighting process <b>900</b> initiates at a start terminal <b>901</b> and continues to a ‘spectral peak’ iteration procedure <b>903</b> that traverses the dissociation spectrum data and recognizes each relevant spectral peak. Relevant spectral peaks are, for example, those with an intensity that is above a particular threshold and/or within a range of m/z values. Once a spectral peak is recognized, an ‘initialize spectral peak vertex’ procedure <b>905</b> can allocate storage for the vertex and can assign the spectral peak intensity to the vertex as illustrated in Table 1.</p>
<p id="p-0064" num="0063">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 1</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>For each peak in spectrum { //extract peak info from spectrum</entry>
</row>
<row>
<entry/>
<entry>  New vert mz;</entry>
</row>
<row>
<entry/>
<entry>  mz.intensity = peakvalue;</entry>
</row>
<row>
<entry/>
<entry>  mz.mass = peakXposition;</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry>For each mz in spectrum {mz.irank=irank(mz)}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0065" num="0064">Once all the spectral peaks are detected from the dissociation spectrum data, a ‘rank spectral peaks by intensity’ procedure <b>906</b> provides an intensity ranking order for each spectral peak wherein, in one embodiment, the most intense spectral peak is given the intensity rank of one, the second most intense spectral peak is given the intensity rank of two, etc.</p>
<p id="p-0066" num="0065">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="70pt" align="left"/>
<colspec colname="2" colwidth="119pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="2" rowsep="1">TABLE 2</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="2" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>New vert Art_B;</entry>
<entry>// add artificial peaks</entry>
</row>
<row>
<entry/>
<entry>New vert Art_Y;</entry>
</row>
<row>
<entry/>
<entry>New vert Art_N;</entry>
</row>
<row>
<entry/>
<entry/>
<entry>// init artificial peak edges</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Edge(Art_B, Art_Y).weight = −2*Strong;</entry>
</row>
<row>
<entry/>
<entry>Edge(Art_B, Art_N).weight = −Strong;</entry>
</row>
<row>
<entry/>
<entry>Edge(Art_Y, Art_N).weight = −Strong;</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0067" num="0066">An ‘initialize artificial vertices’ procedure <b>907</b> (as illustrated in Table 2) allocates at least two artificial vertices that will be associated with the two classes of ions that we are interested in. In protein and peptide analysis the two classes of ions are b-ions and y-ions. Some embodiments (such as this one) may add another vertex to help attract noise peaks. Edges are established between the artificial vertices. In one embodiment, the edge between the two classification vertices is set to repel each other. Each of the classification vertices also has repelling edges to the noise vertex if it is used.</p>
<p id="p-0068" num="0067">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 3</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>For any two mz Vsmaller and Vlarger in spectrum {</entry>
</row>
<row>
<entry/>
<entry>  deltaMass = Vlarger.mass − Vsmaller.mass;</entry>
</row>
<row>
<entry/>
<entry>  if (compareMasses(DeltaMass, AminoAcids,Quality)) {</entry>
</row>
<row>
<entry/>
<entry>    edge(Vlarger, Vsmaller).weight += Strong*Quality;</entry>
</row>
<row>
<entry/>
<entry>  }</entry>
</row>
<row>
<entry/>
<entry>  if(compareMasses(Vlarger+Vsmaller,ParentMass,Quality)){</entry>
</row>
<row>
<entry/>
<entry>    edge(Vlarger, Vsmaller).weight += −Strong*Quality;</entry>
</row>
<row>
<entry/>
<entry>  }</entry>
</row>
<row>
<entry/>
<entry>  if (compareMasses(DeltaMass,AminoAcidpairs,Quality)){</entry>
</row>
<row>
<entry/>
<entry>    edge (Vlarger, Vsmaller).weight += Weak*Quality;</entry>
</row>
<row>
<entry/>
<entry>  }</entry>
</row>
<row>
<entry/>
<entry>  if (impossible(deltaMass)) {</entry>
</row>
<row>
<entry/>
<entry>    edge(Vlarger, Vsmaller).weight += −Strong;</entry>
</row>
<row>
<entry/>
<entry>  }</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0069" num="0068">A ‘spectral peak pair’ iteration procedure <b>909</b> (as illustrated in Table 3) then iterates once over each pair of vertices that correspond to spectral peaks in the dissociation spectrum data. As each pair of vertices is iterated, the edges between the pair are adjusted responsive to a number of conditions. For example, but without limitation, the inventors have determined that good results can be obtained for peptides by weighting the edge between the two vertices in accordance with the following.</p>
<p id="p-0070" num="0069">An ‘amino acid residue edge’ check procedure <b>911</b> determines how closely the difference in m/z between the spectral peak pairs matches an amino acid residue. If there is a close match, a Strong edge is added between the two spectral peaks. The strength of the edge can be modified by a Quality value that represents how closely the m/z difference between the spectral peaks matches the mass of an amino acid. In the following tables, the Quality variable gives the closeness of the match between the two masses. In one embodiment, Quality equals 1.0 for a perfect match, and decreases to 0.0 at a user-defined tolerance. An appropriate tolerance for an ion-trap mass spectrometer could be 0.4 daltons while an appropriate tolerance for a QTOF instrument could be 0.1 Daltons. In the pseudocode used herein, the edge programmed-method establishes an edge with the specified weight between two vertices if no edge exists. Subsequent edge programmed-method invocations add the specified weight to the existing edge. In both cases the edge weight operand can be indicated by “+=” in the pseudocode. One skilled in the art will understand that there are many different, but equivalent, ways of weighting the edges.</p>
<p id="p-0071" num="0070">A ‘complementary spectral peaks edge’ check procedure <b>913</b> determines whether sum of the m/z are about the same as the mass of the parent molecule. If so, the weight of the edge is reduced by −Strong (that can be modified by Quality) because the spectral peaks are likely to not have the same classification (that is, it is very likely that one spectral peak represents a b-ion and the other represents a y-ion; thus the two spectral peaks should be encouraged to be in different classifications and this is accomplished by adjusting the edge by a repulsive amount.</p>
<p id="p-0072" num="0071">An ‘amino acid pair’ check procedure <b>915</b> determines whether the difference in m/z between the spectral peaks matches a pair of amino acid residues. If this is true, the edge is increased by Weak as adjusted by Quality.</p>
<p id="p-0073" num="0072">An ‘impossible mass’ check procedure <b>917</b> determines whether the difference in m/z between the spectral peaks is not a residue mass or a sum of residue masses. If the difference in m/z between the spectral peaks is not a residue mass or a sum of residue masses, the edge is made less attractive by −Strong.</p>
<p id="p-0074" num="0073">One skilled in the art will understand that other embodiments can use methods for defining edges other than the establishment of the weighted edge followed by modifications to that edge that are based on characteristics of the spectral peak pair. In addition, other characteristics of the spectral peak pair, or relationships to a third spectral peak, can also be incorporated into the weighted edge between the spectral peak pair.</p>
<p id="p-0075" num="0074">Once the edges for all spectral peak pairs have been established, the edge-weighting process <b>900</b> continues to adjust the edges for each spectral peak (see <figref idref="DRAWINGS">FIG. 10</figref>) as follows:</p>
<p id="p-0076" num="0075">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="203pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 4</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>For each mz Vthis in spectrum {</entry>
</row>
<row>
<entry/>
<entry>  NoiseEdge=(Strong/rankMax)*min(Vthis.irank−1,rankMax);</entry>
</row>
<row>
<entry/>
<entry>  edge(Vthis, Art_N).weight += NoiseEdge;</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0077" num="0076">Table 4 illustrates a ‘spectral peak’ iteration procedure <b>919</b> that establishes an iteration over vertices that represent the spectral peaks in the dissociation spectrum data. After all selected vertices have been processed, the edge-weighting process <b>900</b> completes through an ‘end’ terminal <b>921</b>. As each vertex is processed, a ‘noise edge’ procedure <b>923</b> adds an edge between the processed vertex representing a spectral peak and the artificial vertex for noise. The strength of the edge is Strong divided by the maximum intensity rank as adjusted by the rank of the spectral peak. Thus, (assuming rankMax is 100) the highest intensity spectral peak has no edge to noise. While the second highest intensity spectral peak has an edge to noise of 1/100 Strong and the nth intense spectral peak (where n is rankMax+1 or higher) would be Strong.</p>
<p id="p-0078" num="0077">
<tables id="TABLE-US-00005" num="00005">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 5</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>If (compareMasses(Vthis.mass−protonMass,</entry>
</row>
<row>
<entry/>
<entry>    AminoAcidpairs,Quality)){</entry>
</row>
<row>
<entry/>
<entry>  edge(Vthis, Art_B).weight += Quality*Weak;</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0079" num="0078">Next, a ‘b-ion residue pair’ check procedure <b>925</b> (illustrated by Table 5) determines whether the spectral peak's m/z minus the proton mass matches an amino acid pair. If so, the weighted edge to Art_B is increased by Weak as adjusted by the mass accuracy (Quality) which is how closely the peak's m/z matches the mass of a pair of amino acids.</p>
<p id="p-0080" num="0079">
<tables id="TABLE-US-00006" num="00006">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="28pt" align="left"/>
<colspec colname="1" colwidth="189pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 6</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>If (compareMasses(ParentMass−Vthis.mass,</entry>
</row>
<row>
<entry/>
<entry>    AminoAcidpairs,Quality)) {</entry>
</row>
<row>
<entry/>
<entry>  edge(Vthis, Art_Y).weight += Quality*Weak;</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0081" num="0080">Next, a ‘y-ion residue pair’ check procedure <b>927</b> (illustrated by Table 6) determines whether the peak's m/z subtracted from the parent molecule's mass matches an amino acid pair. If this is true, the edge weight to Art_Y is increased by Weak as adjusted by Quality.</p>
<p id="p-0082" num="0081">
<tables id="TABLE-US-00007" num="00007">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="196pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 7</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>If (peakExists(Vthis.mass − 27.995,quality)) {</entry>
</row>
<row>
<entry/>
<entry>  if(compareMasses(Vthis.mass−protonMass,</entry>
</row>
<row>
<entry/>
<entry>      AminoAcidpairs,Quality)) {</entry>
</row>
<row>
<entry/>
<entry>    edge(Vthis, Art_B).weight += Strong*Quality;</entry>
</row>
<row>
<entry/>
<entry>  } else {</entry>
</row>
<row>
<entry/>
<entry>    edge(Vthis,Art_B).weight += Quality*Weak;</entry>
</row>
<row>
<entry/>
<entry>  }</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0083" num="0082">An ‘a-ion detection’ conditional procedure <b>928</b> (illustrated by Table 7) first determines if a peak exists that is 27.995 less than the current peak (thus indicating that the current spectral peak is a result of an additional carbon monoxide attached to the fragment). If so, a ‘residue Pair’ conditional procedure <b>929</b> determines if the spectral peak mass minus a proton matches the mass of an amino acid pair and if so a ‘strong edge’ procedure <b>930</b> increases the edge between the spectral peak and Art_B by Strong as adjusted by Quality to the mass of a pair of amino acids.</p>
<p id="p-0084" num="0083">If the ‘residue Pair’ conditional procedure <b>929</b> determines that the spectral peak's mass minus a proton mass does not match an amino acid pair, then a ‘weak edge’ procedure <b>931</b> increases the edge between the spectral peak and Art_B by Weak as adjusted by the Quality of the spectral peak to the mass of a pair of amino acids.</p>
<p id="p-0085" num="0084">
<tables id="TABLE-US-00008" num="00008">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="175pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 8</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>if (impossible(Vthis.mass−protonMass)){</entry>
</row>
<row>
<entry/>
<entry>  edge(Vthis,Art_B).weight += −Strong;</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0086" num="0085">An ‘impossible b-ion’ check procedure <b>933</b> (illustrated by Table 8) determines whether the m/z of the spectral peak minus the mass of a proton is not the mass of a low mass ion. If this is so, the edge's attraction between this vertex and Art_B is reduced by Strong.</p>
<p id="p-0087" num="0086">
<tables id="TABLE-US-00009" num="00009">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="175pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 9</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>if (impossible(ParentMass−Vthis.mass)){</entry>
</row>
<row>
<entry/>
<entry>  edge(Vthis,Art_Y).weight += −Strong</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0088" num="0087">An ‘impossible y-ion’ check procedure <b>935</b> (illustrated by Table 9) determines whether the complement of the m/z of the spectral peak is not the mass of a low mass ion. If so, the attraction of the edge between the vertex and Art_Y is reduced by Strong.</p>
<p id="p-0089" num="0088">A ‘double charge ion’ check procedure <b>937</b> (illustrated by Table 10) determines if a spectral peak exists at the m/z that is half of the m/z of the spectral peak mass plus the proton mass. If such a spectral peak exists, then the edge from the vertex to Art_Y is increased by Weak.</p>
<p id="p-0090" num="0089">
<tables id="TABLE-US-00010" num="00010">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="196pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" rowsep="1">TABLE 10</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>  if (peakexists((Vthis.mass+protonMass)/2,quality)) {</entry>
</row>
<row>
<entry/>
<entry>    edge(Vthis,Art_Y).weight += Weak;</entry>
</row>
<row>
<entry/>
<entry>  }</entry>
</row>
<row>
<entry/>
<entry>}</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0091" num="0090">One skilled in the art would understand that additional edge adjustments could be made depending on how well the spectral peak's mass matches the mass of an amino acid triple.</p>
<p id="p-0092" num="0091">How do we set Weak and Strong? We set Strong to be 6 times Weak, because (at 0.2 Dalton resolution) there are about 6 times as many distinct residue-pair masses as distinct residue masses. In addition, we have determined that graph partitioning is very robust under different weights and that the results are not very sensitive to changes in the weights.</p>
<p id="p-0093" num="0092">Finally, why is the negative weight between two peaks separated by an impossible mass only Strong rather than much stronger or even infinite? If we use extremely strong impossible edges, then a chemical noise peak with, for example, 3 impossible edges to y-ion peaks and 5 impossible edges to b-ion peaks will be pushed far to the T side (where it will then push away some real y-ions).</p>
<p id="p-0094" num="0093"><figref idref="DRAWINGS">FIG. 11</figref> illustrates a two dimensional eigenspace R <b>1100</b> using a first eigenvector coordinate <b>1101</b> as one coordinate of the eigenspace and a second eigenvector coordinate <b>1103</b> as the other coordinate. As was described with respect to <figref idref="DRAWINGS">FIG. 6</figref>, a line L <b>1105</b> fit to the vertices' locations in the eigenspace is created and a partitioning line P <b>1107</b> orthogonal to the line L <b>1105</b> is located at the origin of the two dimensional eigenspace R <b>1100</b>. Groups S and T are assigned to either side of the partitioning line P <b>1107</b>.</p>
<p id="p-0095" num="0094"><figref idref="DRAWINGS">FIG. 12</figref> illustrates the identification of the vertices resulting from sequencing the spectrum using the techniques disclosed herein for classifying the spectrum's spectral peaks.</p>
<p id="p-0096" num="0095"><figref idref="DRAWINGS">FIG. 13</figref> illustrates an analyzed dissociation spectrum data of the peptide KQEYDEAGPSIVHRK <b>1300</b>. As in <figref idref="DRAWINGS">FIG. 3</figref>, the spectrum includes a plurality of m/z mass spectral peaks <b>1301</b>. However, now the spectral peaks can be further identified as (for example) a b-ion spectral peak <b>1303</b>, a y-ion spectral peak <b>1305</b>, and a noise peak <b>1307</b></p>
<p id="p-0097" num="0096">One skilled in the art will understand that the edge method will create an edge of the specified weight if no edge previously existed between the vertices or will modify an existing edge by the supplied weight.</p>
<p id="p-0098" num="0097">One skilled in the art will understand that the techniques described herein apply generally to a parent molecule and molecular subunits as well as the peptides and amino acids used to illustrate one embodiment. In particular, a parent molecule can be at least one of a polymer, a lipid, a protein, a peptide and a glycan as well as other molecules that comprise a number of molecular subunits separated by cleavage sites each of which connect one molecular subunit with another molecular subunit.</p>
<p id="p-0099" num="0098">One skilled in the art will understand that the disclosed technology allows provides advances in the sequencing of complex molecules. Furthermore, from the foregoing, it will be appreciated that the efficient classification or partial classification of spectral peaks has (without limitation) the following advantages:</p>
<p id="p-0100" num="0099">1) A de novo sequencer can now generate fewer candidate sequences (thus the probability of each sequence being correct can be much higher);</p>
<p id="p-0101" num="0100">2) Because fewer sequences are generated, a de novo sequencer using the disclosed technology provides a faster generation of a set of sequences that is likely to contain the correct sequence;</p>
<p id="p-0102" num="0101">3) Because a de novo sequencer using the disclosed technology is faster and more accurate than the existing techniques, such a de novo sequencer can now sequence much longer peptides and even complete proteins;</p>
<p id="p-0103" num="0102">4) One embodiment modifies spectral peak intensities responsive to the peak classification. This modified spectrum can be presented to existing sequencing programs for processing. Because the modified spectrum is less ambiguous, these programs will be more likely to generate a correct sequence;</p>
<p id="p-0104" num="0103">5) Increased accuracy of de novo sequencers because of the remarkable success at solving the b/y ambiguity problem associated with dissociation spectra of proteins and peptides.</p>
<p id="p-0105" num="0104">6) Provides a computationally efficient and robust solution to the peak classification problem.</p>
<p id="p-0106" num="0105">7) The strongest class (largest number of intense peaks) repels all the others, and the attraction between noise peaks (such as internal fragments that are separated by residue masses) aids in the classification of the peaks.</p>
<p id="p-0107" num="0106">8) Some spectra have more than three classes; this can occur if there is more than one peptide or if there are many internal fragments (contiguous subsequences from the middle of the residue sequence). Such spectra are difficult for the pure longest-path prior approaches, which can easily “jump tracks” from one peptide to another. This problem is reduced by robust classification of the spectral peaks.</p>
<p id="p-0108" num="0107">Although the claimed technology has been described in terms of the presently preferred embodiments, one skilled in the art will understand that various modifications and alterations may be made without departing from the scope of the claims. Accordingly, the claims are not to be limited to the particular embodiments discussed herein.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07297940-20071120-M00001.NB">
<img id="EMI-M00001" he="8.47mm" wi="76.20mm" file="US07297940-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07297940-20071120-M00002.NB">
<img id="EMI-M00002" he="6.35mm" wi="76.20mm" file="US07297940-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed follows:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computer controlled method comprising:
<claim-text>accessing dissociation spectrum data comprising a plurality of spectral peaks representing a plurality of fragments of a parent molecule, said parent molecule comprising a plurality of molecular subunits and a plurality of cleavage sites, each of said plurality of cleavage sites connecting a first one of said plurality of molecular subunits and a second one of said plurality of molecular subunits, said plurality of spectral peaks associated with a respective plurality of peak intensities;</claim-text>
<claim-text>representing a portion of said plurality of spectral peaks as a plurality of vertices;</claim-text>
<claim-text>assigning a plurality of weighted edges to said plurality of vertices;</claim-text>
<claim-text>applying a confidence-weighted classification to said plurality of vertices responsive to said plurality of weighted edges;</claim-text>
<claim-text>adjusting said respective plurality of peak intensities responsive to the step of applying;</claim-text>
<claim-text>and presenting said respective plurality of peak intensities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computer controlled method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of presenting further comprises determining at least one possible molecular subunit sequence for a portion of said parent molecule.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computer controlled method of <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein the step of applying classifies said portion of said plurality of vertices into a plurality of classes, said plurality of classes representing a first class of spectral peaks and a second class of spectral peaks;
<claim-text>and wherein the step of presenting further comprises complementing the first class relative to the mass of said parent molecule that yielded said dissociation spectrum data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computer controlled method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of presenting further comprises:
<claim-text>generating a processed spectrum responsive to the step of adjusting;</claim-text>
<claim-text>and providing said processed spectrum to at least a portion of a sequencing program.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computer controlled method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of presenting further comprises identifying one or more of said plurality of spectral peaks in accordance with the step of adjusting.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computer controlled method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said parent molecule is one or more selected from a group consisting of a polymer, a lipid, a protein, a peptide and a glycan.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computer controlled method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said parent molecule is a protein or peptide and said plurality of molecular subunits are amino acids.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The computer controlled method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of applying further comprises:
<claim-text>generating a graph comprising said plurality of vertices representing said portion of said plurality of spectral peaks and including at least one artificial vertex;</claim-text>
<claim-text>said graph further comprising said plurality of weighted edges wherein said plurality of weighted edges represent a plurality of affinities between said plurality of vertices.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The computer controlled method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein said graph is represented by a matrix wherein said plurality of weighted edges of the graph are off-diagonal values of said matrix and the diagonal values of said matrix are the sums of the absolute values of the corresponding rows of said matrix;
<claim-text>and wherein the step of applying further comprises:</claim-text>
<claim-text>computing a plurality of eigenvectors for the generalized eigenvector problem represented by said matrix;</claim-text>
<claim-text>and weighting the i<sup>th </sup>vertex according to a combination of the i<sup>th </sup>coordinates in an eigenspace defined by said plurality of eigenvectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A computer program product comprising:
<claim-text>a computer-usable data carrier storing instructions that, when executed by a computer, cause said computer to perform a method comprising:</claim-text>
<claim-text>accessing dissociation spectrum data comprising a plurality of spectral peaks representing a plurality of fragments of a parent molecule, said parent molecule comprising a plurality of molecular subunits and a plurality of cleavage sites, each of said plurality of cleavage sites connecting a first one of said plurality of molecular subunits and a second one of said plurality of molecular subunits, said plurality of spectral peaks associated with a respective plurality of peak intensities;</claim-text>
<claim-text>representing a portion of said plurality of spectral peaks as a plurality of vertices;</claim-text>
<claim-text>assigning a plurality of weighted edges to said plurality of vertices;</claim-text>
<claim-text>applying a confidence-weighted classification to said plurality of vertices responsive to said plurality of weighted edges;</claim-text>
<claim-text>adjusting said respective plurality of peak intensities responsive to the step of applying;</claim-text>
<claim-text>and presenting said respective plurality of peak intensities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the step of presenting further comprises determining at least one possible molecular subunit sequence for a portion of said parent molecule.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The computer program product of <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the step of applying classifies said portion of said plurality of vertices into a plurality of classes, said plurality of classes representing a first class of spectral peaks and a second class of spectral peaks;
<claim-text>and wherein the step of presenting further comprises complementing the first class relative to the mass of said parent molecule that yielded said dissociation spectrum data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the step of presenting further comprises:
<claim-text>generating a processed spectrum responsive to the step of adjusting;</claim-text>
<claim-text>and providing said processed spectrum to at least a portion of a sequencing program.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the step of presenting further comprises identifying one or more of said plurality of spectral peaks in accordance with the step of adjusting.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said parent molecule is one or more selected from a group consisting of a polymer, a lipid, a protein, a peptide and a glycan.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein said parent molecule is a protein or peptide and said plurality of molecular subunits are amino acids.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer program product of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the step of applying further comprises:
<claim-text>generating a graph comprising said plurality of vertices representing said portion of said plurality of spectral peaks and including at least one artificial vertex;</claim-text>
<claim-text>said graph further comprising said plurality of weighted edges wherein said plurality of weighted edges represent a plurality of affinities between said plurality of vertices.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer program product of <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein said graph is represented by a matrix wherein said plurality of weighted edges of the graph are off-diagonal values of said matrix and the diagonal values of said matrix are the sums of the absolute values of the corresponding rows of said matrix;
<claim-text>and wherein the step of applying further comprises:</claim-text>
<claim-text>computing a plurality of eigenvectors for the generalized eigenvector problem represented by said matrix;</claim-text>
<claim-text>and weighting the i<sup>th </sup>vertex according to a combination of the i<sup>th </sup>coordinates in an eigenspace defined by said plurality of eigenvectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. An apparatus comprising:
<claim-text>a spectrum access logic configured to access dissociation spectrum data comprising a plurality of spectral peaks representing a plurality of fragments of a parent molecule, said parent molecule comprising a plurality of molecular subunits and a plurality of cleavage sites, each of said plurality of cleavage sites connecting a first one of said plurality of molecular subunits and a second one of said plurality of molecular subunits, said plurality of spectral peaks associated with a respective plurality of peak intensities;</claim-text>
<claim-text>a peak selection logic configured to represent a portion of said plurality of spectral peaks accessed by the spectrum access logic as a plurality of vertices;</claim-text>
<claim-text>an edge weight assignment logic configured to assign a plurality of weighted edges to said plurality of vertices selected by the peak selection logic;</claim-text>
<claim-text>a classification logic configured to apply a confidence-weighted classification to said plurality of vertices responsive to said plurality of weighted edges;</claim-text>
<claim-text>an adjustment logic configured to adjust said respective plurality of peak intensities responsive to the classification logic;</claim-text>
<claim-text>and a presentation logic configured to present said respective plurality of peak intensities by storing representations of a spectrum with spectral peaks identified by the use of the technology or displaying data from such a spectrum; displaying or storing molecular sequences identified by the use of the technology; passing data representing or derived from the use of the technology to another system (for example, a computer via use of a computer-usable data carrier such as tangible storage devices or a network—and/or using remote procedure call protocols), to another procedure, and/or to a programmed routine.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the presentation logic further comprises a sequence logic configured to determine at least one possible molecular subunit sequence for a portion of said parent molecule.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The apparatus of <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein the classification logic classifies said portion of said plurality of vertices into a plurality of classes, said plurality of classes representing a first class of spectral peaks and a second class of spectral peaks;
<claim-text>and wherein the presentation logic further comprises a complementation logic configured to complement the first class relative to the mass of said parent molecule that yielded said dissociation spectrum data.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the presentation logic further comprises:
<claim-text>a regeneration logic configured to generate a processed spectrum responsive to the adjustment logic;</claim-text>
<claim-text>and an output logic configured to provide said processed spectrum to at least a portion of a sequencing program.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the presentation logic further comprises an ion identification logic configured to identify one or more of said plurality of spectral peaks in accordance with the adjustment logic.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein said parent molecule is one or more selected from a group consisting of a polymer, a lipid, a protein, a peptide and a glycan.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein said parent molecule is a protein or peptide and said plurality of molecular subunits are amino acids.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, wherein the classification logic further comprises:
<claim-text>a graph generation logic configured to generate a graph comprising said plurality of vertices representing said portion of said plurality of spectral peaks and including at least one artificial vertex;</claim-text>
<claim-text>said graph further comprising said plurality of weighted edges wherein said plurality of weighted edges represent a plurality of affinities between said plurality of vertices.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The apparatus of <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein said graph is represented by a matrix wherein said plurality of weighted edges of the graph are off-diagonal values of said matrix and the diagonal values of said matrix are the sums of the absolute values of the corresponding rows of said matrix;
<claim-text>and wherein the classification logic further comprises:</claim-text>
<claim-text>an eigenvector solution logic configured to compute a plurality of eigenvectors for the generalized eigenvector problem represented by said matrix;</claim-text>
<claim-text>and a vertex evaluation logic configured to weight the i<sup>th </sup>vertex according to a combination of the i<sup>th </sup>coordinates in an eigenspace defined by said plurality of eigenvectors.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The apparatus of <claim-ref idref="CLM-00019">claim 19</claim-ref>, further comprising a tandem mass spectrometer.</claim-text>
</claim>
</claims>
</us-patent-grant>
