<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299362-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299362</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10490394</doc-number>
<date>20021028</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2001-330827</doc-number>
<date>20011029</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>794</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>1</main-group>
<subgroup>24</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713189</main-classification>
<further-classification>713193</further-classification>
<further-classification>713155</further-classification>
</classification-national>
<invention-title id="d0e71">Apparatus of a baseline DVB-CPCM</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5144665</doc-number>
<kind>A</kind>
<name>Takaragi et al.</name>
<date>19920900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6353892</doc-number>
<kind>B2</kind>
<name>Schreiber et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6535919</doc-number>
<kind>B1</kind>
<name>Inoue et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2001/0053222</doc-number>
<kind>A1</kind>
<name>Wakao et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2003/0149890</doc-number>
<kind>A1</kind>
<name>Shen et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2004/0054892</doc-number>
<kind>A1</kind>
<name>Ji et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>EP</country>
<doc-number>0766471</doc-number>
<date>19970400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>EP</country>
<doc-number>0913997</doc-number>
<date>19990500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>EP</country>
<doc-number>0957606</doc-number>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>EP</country>
<doc-number>0969668</doc-number>
<date>20000100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>EP</country>
<doc-number>1041819</doc-number>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>EP</country>
<doc-number>1079627</doc-number>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>JP</country>
<doc-number>8-331543</doc-number>
<date>19961200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>JP</country>
<doc-number>10-51778</doc-number>
<date>19980200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>JP</country>
<doc-number>10-51779</doc-number>
<date>19980200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>JP</country>
<doc-number>10-257046</doc-number>
<date>19980900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>JP</country>
<doc-number>11-331310</doc-number>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>JP</country>
<doc-number>2000-83022</doc-number>
<date>20000300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>JP</country>
<doc-number>2000-083022</doc-number>
<date>20000300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>JP</country>
<doc-number>2000-101853</doc-number>
<date>20000400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>JP</country>
<doc-number>2000-287206</doc-number>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>JP</country>
<doc-number>2001-078007</doc-number>
<date>20010300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>JP</country>
<doc-number>2001-359070</doc-number>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>WO</country>
<doc-number>99/48296</doc-number>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>WO</country>
<doc-number>01/91052</doc-number>
<date>20011100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>WO</country>
<doc-number>02/071752</doc-number>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>WO</country>
<doc-number>02/100037</doc-number>
<date>20021200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00028">
<othercit>English Language Abstract of JP10-257046.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00029">
<othercit>English Language Abstract of JP2000-83022.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00030">
<othercit>English Language Abstract of JP 2000-083022.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00031">
<othercit>English Language Abstract of JP 2000-287206.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00032">
<othercit>English Language Abstract of JP 10-257046.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00033">
<othercit>English Language Abstract of JP 11-331310.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00034">
<othercit>English Language Abstract of JP 8-331543.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00035">
<othercit>English Language Abstract of JP 2000-101853.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00036">
<othercit>English Language Abstract of JP 10-51778.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00037">
<othercit>English Language Abstract of JP 10-51779.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00038">
<othercit>English Language Abstract of JP 2001-078007.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00039">
<othercit>English Language Abstract of JP 2001-359070.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00040">
<othercit>DVB: “Call for Proposals for Content Protection and Copy Management Technologies”, which was downloaded from www.cptwg.org/Assets/DVB-CPT-CfP<sub>—</sub>rev1.2.PDF on Feb. 10, 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00041">
<othercit>R. Koenen, “Intellectual Property Management and Protection in MPEG Standards,” which was downloaded from www.cselt.it/mpeg/standards/ipmp on Sep. 24, 2001.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00042">
<othercit>B.J. Van Rijnsoever et al., Interoperable Content Protection for Digital TV, which was published on Jul. 30, 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00043">
<othercit>Electronics, No. 554, Nippon, Chumu Sha, Jul. 1, 2000, pp. 51-54.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>14</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713189</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713193</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713155</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050022227</doc-number>
<kind>A1</kind>
<date>20050127</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Shen</last-name>
<first-name>Sheng Mei</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<nationality>
<country>SG</country>
</nationality>
<residence>
<country>SG</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ji</last-name>
<first-name>Ming</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<nationality>
<country>SG</country>
</nationality>
<residence>
<country>SG</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Huang</last-name>
<first-name>Zhongyang</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<nationality>
<country>SG</country>
</nationality>
<residence>
<country>SG</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Tan</last-name>
<first-name>Jek Thoon</first-name>
<address>
<city>Singapore</city>
<country>SG</country>
</address>
</addressbook>
<nationality>
<country>SG</country>
</nationality>
<residence>
<country>SG</country>
</residence>
</applicant>
<applicant sequence="005" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Senoh</last-name>
<first-name>Takanori</first-name>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Greenblum &amp; Bernstein, P.L.C.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Matsushita Electric Industrial Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Peeso</last-name>
<first-name>Thomas R.</first-name>
<department>2132</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/JP02/11126</doc-number>
<kind>00</kind>
<date>20021028</date>
</document-id>
<us-371c124-date>
<date>20040407</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO03/039155</doc-number>
<kind>A </kind>
<date>20030508</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A Baseline DVB-CPCM is presented in this proposal to provide a secure and interoperable content delivery and transferring apparatus. The proposed Baseline DVB-CPCM is a unit to be implemented in a compliant CPCM device, and it consists of five major modules to be used for end-to end solution and content transferring between devices. These modules are CPCM Manager, Tools Box, Rights Management Module, Message Router, and CAS-CPCM Converter.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="122.85mm" wi="195.41mm" file="US07299362-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="201.85mm" wi="143.43mm" orientation="landscape" file="US07299362-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="212.26mm" wi="150.96mm" orientation="landscape" file="US07299362-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="208.45mm" wi="139.95mm" orientation="landscape" file="US07299362-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="216.58mm" wi="158.83mm" file="US07299362-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="216.24mm" wi="160.27mm" file="US07299362-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="215.05mm" wi="151.47mm" file="US07299362-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="224.03mm" wi="135.89mm" orientation="landscape" file="US07299362-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present invention relates to content protection and copy management used in broadcasting, content distribution, Video-On-Demand, especially to such applications where the protected content is delivered, and transferred between devices which can consume the content and save the content in a storage in a secure manner.</p>
<heading id="h-0002" level="1">BACKGROUND ART</heading>
<p id="p-0003" num="0002">Contents will be available easily to consumers as digital technology and media processing power become more and more advanced. Not like analogue media, digital media almost has unlimited number of copies with good quality. Thus as content owner, or content operator they will have much concern about the dangerous if content is not protected well.</p>
<p id="p-0004" num="0003">Digital TV (DTV) broadcasting has been widely deployed in the world. So far there is not much concern about the content protection and security. However as new generation DTV-STB (Set-Top-Box) that has local hard disk and digital interface like IEEE 1394, etc. is launched, content association, movie industries, and media owners are starting to worry about the content protection and copy management. Before having a complete and very secured DTV-STB, a secured content delivery and transferring mechanism, as well as a secured transmission channel, they would not allow to release contents to such applications. Therefore many parties in the world including standard bodies like MPEG, DVB, TVAnytime, content companies, CE (Consumer Electronics) manufacturers, as well as security technology providers, etc., are gathering together to work on a both interoperable and secure end-to-end solution to the content protection and copy management in such application scenario.</p>
<p id="p-0005" num="0004">Content distribution and video-on-demand is also becoming more and more demanding as multimedia data and contents can reach to anywhere and anytime. User is happy with the convenience and flexibility, and they can enjoy entertainment easily and efficiently.</p>
<p id="p-0006" num="0005">On the other hand, content owners are trying to meet the customer's needs but at the same time they also worry about the illegal usage of their property. There is a balance between two sides.</p>
<p id="p-0007" num="0006">In MPEG standardisation group, people are working towards to standardise an IPMP (Intellectual Property Management and Protection) system that involves compliant terminal. All the terminals can play back a protected content that is encrypted and protected by following the same IPMP standard, no matter what kinds of IPMP tools they use.</p>
<p id="p-0008" num="0007">DVB consortium has also issued Call for Proposal for CPCM (Content Protection and Copy Management), to mainly focus on content delivery from operator to receiver and content transferring from one DVB-CPCM device to another in a both secure and interoperable manner.</p>
<p id="p-0009" num="0008">The current DVB receiver as a DVB device cannot fulfil the both secure and interoperable requirement, especially for content transferring between DVB receiver and other storage devices like PVR, etc., which has not addressed before.</p>
<p id="p-0010" num="0009">Basically the prior art for an existing DVB receiver is shown in <figref idref="DRAWINGS">FIG. 1</figref>, to indicate how a content is delivered to DVB receiver in a secure but private way.</p>
<p id="p-0011" num="0010">Related invention is disclosed in Japanese Patent Application Nos. 2001-265908 and 2001-058236 which are filed by the present applicant.</p>
<p id="p-0012" num="0011">To design an interoperable and secure device to be used in content delivery or transmission in a secure manner;</p>
<p id="p-0013" num="0012">To design an interoperable and secure device to be used in content transferring between such devices in a secure manner;</p>
<p id="p-0014" num="0013">In the above-mentioned cases, content is protected against illegal use of the property and granted usage is properly managed and carried from one device to another within authorised domain.</p>
<heading id="h-0003" level="1">DISCLOSURE OF INVENTION</heading>
<p id="p-0015" num="0014">The device according to the present invention has the following elements.</p>
<p id="p-0016" num="0015">A means for using a standardized Baseline DVB-CPCM unit to be implemented in a compliant CPCM Device;</p>
<p id="p-0017" num="0016">A means for using sub modules of the Baseline DVB-CPCM, as well as their functions and behaviours;</p>
<p id="p-0018" num="0017">A means for using a set of messages for content transferring, tool transferring, mutual authentication between compliant CPCM Devices, as well as interfacing with proprietary CPCM tools (plug-ins);</p>
<p id="p-0019" num="0018">A means for using a set of identifiers for content management and domain management;</p>
<p id="p-0020" num="0019">A means for using CPCM Information and their sub information which is carried in a content, as well as a set of syntaxes and their semantics for such information to indicate the format of a protected content where protection information and content usage information are embedded. It is used by content provider or service operator as the standard mean to wrap up content with other information, and at the same time it is used by CPCM Device makers as the specification to build their compliant CPCM Devices.</p>
<p id="p-0021" num="0020">A means for using a unified and generic XML based schema to be able to express various kinds of usage rights and rules by different parties.</p>
<p id="p-0022" num="0021">According to a device of the present invention, the invention of Baseline DVB-CPCM solves the problem of protecting digital content from broadcasting, copying and/or transferring, and it provides good interoperability.</p>
<p id="p-0023" num="0022">The invented Baseline DVB-CPCM is the unit to be implemented in a compliant CPCM device, and it consists of five modules to realise most of the functions requested by security and interoperability. CPCM Control Information and CPCM Stream are defined in to provide specification for both operator and manufacturer to follow to have world-wide inter-operability, it includes CPCM Tool List, Rights Holder, and Tool Container. In specifying a compliant CPCM Device, a Baseline DVB-CPCM is invented including CPCM Manager, Tools Box, Rights Management, Message Router, and CAS-CPCM converter, to fulfil most of the functions for content protection and copy management</p>
<p id="p-0024" num="0023">Messaging interface and several messages are defined here for content or tool transferring between CPCM Devices, as well as for interfacing with proprietary CPCM plug-ins.</p>
<p id="p-0025" num="0024">XML structured or binary rights language can be included in CPCM Rights Holder to provide usage rules associated with each content, program or even elementary streams.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF DRAWINGS</heading>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> shows the prior art of an Existing DVB-STB to Receive Protected Content by using Different CA Systems.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 2</figref> shows the invented DVB CPCM STB with End to End Solution.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 3</figref> shows the Structure of CPCM protected content—MPEG2 system.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 4</figref> shows Illustration of the Function of Rights Management used for End to End Solution in the Broadcasting Case.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 5</figref> shows Illustration of the Function of Rights Management used for End to End Solution in the content distribution case;</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 6</figref> shows Illustration of the Tool Retrieving Function of CPCM Manager.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 7</figref> shows Content Transmission between CPCM Devices.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">BEST MODE FOR CARRYING OUT THE INVENTION</heading>
<p id="p-0033" num="0032">In the present invention, a parameter named “authorized domain” is newly provided, which specifies one or more local networks. Only reproduction/recording devices within the local network specified by the authorized domain can be authorized to perform one of reproduction and copy of CPCM (content protection and copy management) protected content so that the content can be fully secured in transferring between the devices within the network.</p>
<p id="p-0034" num="0033">The authorized domain is defined when a user makes a contract of content subscription with a content provider. Terms of the contract may be varied according to characteristics of the local network such as numbers and/or types of the devices within the local network assigned the same domain.</p>
<p id="p-0035" num="0034">For example, the authorized domain can be set by adopting a part of an IP address of the device within the local network. More specifically, in the case of the device with an IP address “dvdplayer1.seno.drl.mei.co.jp”, the authorized domain may be “seno.drl.mei.co.jp”. Then, all the devices having IP address “seno.drl.mei.co.jp” can be authorized to perform one of reproduction and copy of the contracted content. Note that a domain specifies a logical unit of a connection between the devices, which are not necessary in the form of a network.</p>
<p id="p-0036" num="0035">The basic structure of the invention is first explained.</p>
<p id="h-0006" num="0000">(1) On the Content Provider or Operator Side in a CPCM Environment:</p>
<p id="p-0037" num="0000">
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0036">1. Content is encoded using existing coding technology like MPEG-2 or MPEG4, and encrypted using existing and defined encryption tools like DES or AES. Watermarks for copy control maybe embedded in the content before the encoding. The encryption key is encrypted again using pre-defined encryption tool, to result in an encrypted encryption key and the license key that is used to encrypt the encryption key.</li>
    <li id="ul0001-0002" num="0037">2. At the same time, the ContentID is generated.</li>
    <li id="ul0001-0003" num="0038">3. CPCM Tools List indicated by ToolID is also formed based on what tool is used to protecting the content.</li>
    <li id="ul0001-0004" num="0039">4. CPCM Rights Holder contains usage rights and rules specified by content owner. These usage rights and rules can be made specific to each piece of content (by using of ContentID), or each program under one content (by using of programNumber in MPEG2 system), or even each elementary stream under one program (by using elementary_PID in MPEG2 system). The above-mentioned license key can be carried in CPCM Rights Holder, or it can be delivered to CPCM devices via some secure means, a return channel or smart card.</li>
    <li id="ul0001-0005" num="0040">5. CPCM Control Graph is created if necessary according to the detail protection and usage rules applied to different control point;</li>
    <li id="ul0001-0006" num="0041">6. CPCM Tool Container is formed by carrying necessary CPCM Tool in a protected format;</li>
    <li id="ul0001-0007" num="0042">7. CPCM Stream is created to hold the above-mentioned encrypted encryption key and any other control information for protection, such as time stamps, tool configuration messages, etc.</li>
</ul>
</p>
<p id="p-0038" num="0043">All the above CPCM information is carried in PSI in MPEG-2 system standard, and it is called CPCM Control Information.</p>
<p id="h-0007" num="0000">(2) On the Content Receiver Side in the Same CPCM Environment:</p>
<p id="p-0039" num="0044">A protected content is delivered to a compliant CPCM Device, and Baseline DVB-CPCM unit will function by activating its sub modules:
<ul id="ul0002" list-style="none">
    <li id="ul0002-0001" num="0045">1. Rights Management module will retrieve CPCM Rights Holder information. Usage rules and states associated with the content are parsed. These include usage rights of each program, elementary stream, copy information on whether or not the content (or a program) can be transferred between CPCM devices in the same authorized domain. If the license key is carried in CPCM Rights Holder, it is also retrieved after the Rights Management module makes sure that this device has the right to access a particular content or program. If not, the license key is obtained elsewhere through a secure means, maybe a smart card.</li>
    <li id="ul0002-0002" num="0046">2. CPCM Manager module will retrieve CPCM Tool List and call up the tool indicated by ToolID in the list if there is such tool in Tools Box of Baseline DVB-CPCM. If there is no such tool in the case of a new tool or upgraded tool, missing tool downloading or retrieving will be conducted in three ways: sending ToolRequest to another CPCM Device; retrieving tools from the content (if there is tools carried in Tool Container Descriptor); remotely retrieving missing tool from a URL site. The newly obtained tool will be used as proprietary CPCM tools (plug-ins).</li>
    <li id="ul0002-0003" num="0047">3. In the case of playback only, the license key stored in buffer of Baseline DVB-CPCM will be called to decrypt the encrypted encryption key in the CPCM Stream. The reconstructed key will be used to decrypt the encrypted content one unit by one unit synchronously, to play back the protected content without content storing.</li>
    <li id="ul0002-0004" num="0048">4. In the case of storing content on the top of playback, Usage rules and rights carried in the CPCM Rights Holder will be further retrieved and verified to see whether there is copy right for this program or content. In the case of broadcasting, program number like ProgramNumber is used to identify the usage right applied to which program, while in the case of content distribution, ContentID will be used to identify the usage right applied to which content.</li>
</ul>
</p>
<p id="p-0040" num="0049">After usage rule verification performed, the protected content will be played back in the same way as indicated in the above-mentioned playback case. At the same time the encrypted content will be saved in the storage of a CPCM device, together with CPCM information (CPCM Tool List, CPCM Rights Holder, CPCM Control Graph, CPCM Tool Container, and CPCM Stream where the encryption key is not encrypted).</p>
<p id="h-0008" num="0000">(3) Protected Content Transferring Between Two Compliant CPCM Devices:</p>
<p id="p-0041" num="0050">It is assumed that the protected content stored in CPCM Device A, together with CPCM Control Information. CPCM Device B is owned by the same user and considered to be in the same authorized domain.</p>
<p id="p-0042" num="0051">In the case of content distribution, the same CPCM_DomainID corresponding to one registered user has been issued as a certificate and registered to all user's CPCM devices when he makes subscription via a return channel, smart card, or other means.</p>
<p id="p-0043" num="0052">This CPCM_DomainID as a certificate is securely transmitted, delivered, and registered into user's CPCM devices, or it is registered into user's CPCM devices via a plug-in smart card. This CPCM_DomainID registered in Baseline DVB-CPCM of user's CPCM devices is used as Hardware's identifier or authorized domain identifier.</p>
<p id="p-0044" num="0053">A password assigned by the service operator may be used in this registration process. All the bill for pay-per-view or content purchase will be charged to users based on their own CPCM_DomainID and the password. All his registered CPCM devices are considered to be in the authorized domain with the same certificate of CPCM_DomainID.</p>
<p id="p-0045" num="0054">Within the same domain, each of the CPCM Devices is also assigned a CPCM_DeviceID to identify itself and to be used as address for messages sending and receiving between two CPCM devices. Each CPCM device will also have a key generation module to generate a pair of public key and private key to use to encrypt and decrypt the encryption keys in CPCM Stream.</p>
<p id="p-0046" num="0055">When CPCM Device B wants to obtain a protected content/program which is stored in the CPCM Device A, it will send a ContentRequest message to the device A, together with:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0056">a) the ContentID/ProgramNumber of the requested content/program;</li>
    <li id="ul0003-0002" num="0057">b) CPCM_DomainID in the device B;</li>
    <li id="ul0003-0003" num="0058">c) the public key—PublicKey on-line generated by (or previously embedded in) Baseline DVB-CPCM of the device B;</li>
    <li id="ul0003-0004" num="0059">d) the CPCM_DeviceID of the device B;</li>
</ul>
</p>
<p id="p-0047" num="0060">The Baseline DVB-CPCM of device A receives the ContentRequest messages with the CPCM_DomainID and the PublicKey, and it will verify:
<ul id="ul0004" list-style="none">
    <li id="ul0004-0001" num="0061">a) whether device B is in the authorized domain. It is done by either doing a mutual authentication with Device B using certificates through mutual authentication messages, or simply by checking the received CPCM_DomainID against with its, own CPCM_DomainID;</li>
    <li id="ul0004-0002" num="0062">b) whether there is such content/program with the ContentID/ProgramNumber (programNumber is used in broadcasting case);</li>
    <li id="ul0004-0003" num="0063">c) Whether there is such copy right for the requested content/program by calling the Rights Management Module to check the usage rules carried in CPCM Rights Holder.</li>
    <li id="ul0004-0004" num="0064">d) If the above-mentioned three steps are passed through, the encryption key carried by CPCM Stream which is stored in the device A, is encrypted by the received PublicKey and re-form a CPCM Stream attached to the protected content;</li>
    <li id="ul0004-0005" num="0065">e) Finally the requested content will be transferred from the device A to the device B together with the CPCM information where some CPCM information may be changed;</li>
    <li id="ul0004-0006" num="0066">f) If Copy right is Copy Once in the CPCM Rights Holder, then Copy Once will be changed into Copy No More;</li>
    <li id="ul0004-0007" num="0067">g) If the copy right information is carried in video embedded by watermarking, then a watermarking extracting tool will be called up from Tools Box to extract the copy right information. In this case if the copy right is Copy Once, then a watermarking embedding tool will be called up to embed Copy No More to the same video content;
<br/>
(4) CPCM Tool Transferring Between Two Compliant CPCM Devices:
</li>
</ul>
</p>
<p id="p-0048" num="0068">It is assumed that CPCM Tools are stored in the module of Tools Box of Baseline DVB-CPCM in the CPCM Device A.</p>
<p id="p-0049" num="0069">CPCM Device B receives a protected content and retrieves CPCM Tool List But when it is found that the tool required with ToolID is missing or cannot be found from the Tools Box of Baseline DVB-CPCM in the device B, the device B will send ToolRequest messages to the device A to request such tool, and the messages include:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0070">a) the CPCM_DomainID of the device B;</li>
    <li id="ul0005-0002" num="0071">b) the ToolID of the requested tool;</li>
    <li id="ul0005-0003" num="0072">c) the CPCM_DeviceID of the device B;</li>
</ul>
</p>
<p id="p-0050" num="0073">CPCM Rights Management module in the device A receives the ToolRequest messages with the CPCM_DomainID and the ToolID, and it will verify:
<ul id="ul0006" list-style="none">
    <li id="ul0006-0001" num="0074">a) whether device B is in the authorized domain. It is done by either doing a mutual authentication with Device B using certificates through mutual authentication messages, or simply by checking the received CPCM_DomainID against with its own CPCM_DomainID;</li>
    <li id="ul0006-0002" num="0075">b) whether there is such tool with the ToolID, by looking up the tool table list stored in the local memory such as RAM which is inside the Baseline DVB-CPCM of the device A;</li>
    <li id="ul0006-0003" num="0076">c) whether it is allowed for the tool to be transferred to another device even in the authorized domain, according to the transferring status for the requested tool;</li>
    <li id="ul0006-0004" num="0077">d) If the above-mentioned three steps are passed through, the requested tool will be transferred from the device A to the device B together with its transferring status;</li>
</ul>
</p>
<heading id="h-0009" level="1">EMBODIMENT</heading>
<p id="p-0051" num="0078">A preferred embodiment of the invention will be described below with reference to the drawings.</p>
<p id="p-0052" num="0079"><figref idref="DRAWINGS">FIG. 1</figref> shows the prior art for the current typical DTV system, and DVB-STB with a private CA system is shown as the receiver here as an example.</p>
<p id="p-0053" num="0080">In unit <b>1</b>.<b>0</b> Content Owner issues content to different operators with certain basic and common usage rules for the content;</p>
<p id="p-0054" num="0081">In unit <b>1</b>.<b>1</b> Operator A creates protected content using its tool and format although MPEG-2 standard is used here for audio, video and system encoding. The format of usage rules, the protection mechanism including protection tools used here, is based on a proprietary specification A. So a CA module in unit <b>1</b>.<b>2</b> based on such specification B has to be used to attach to the DVB-STB 1, in order to be able to receive and interpret in unit <b>1</b>.<b>3</b>, and consume the protected content in unit <b>1</b>.<b>4</b>.</p>
<p id="p-0055" num="0082">The same way is applied to Operator B and DVB-STB 2.</p>
<p id="p-0056" num="0083">In unit <b>1</b>.<b>5</b> Operator B creates protected content using its tool and format although MPEG-2 standard is used here for audio, video and system encoding. The format of usage rules, the protection mechanism including protection tools used here, is based on a proprietary specification B. So a CA module in unit <b>1</b>.<b>6</b> based on such specification B has to be used to attach to the DVB-STB 2, in order to be able to receive and interpret in unit <b>1</b>.<b>7</b>, and consume the protected content in unit <b>1</b>.<b>8</b>.</p>
<p id="p-0057" num="0084">The same way is applied to Operator C and DVB-STB 3.</p>
<p id="p-0058" num="0085">In unit <b>1</b>.<b>9</b> Operator B creates protected content using its tool and format although MPEG-2 standard is used here for audio, video and system encoding. The format of usage rules, the protection mechanism including protection tools used here, is based on a proprietary specification C. So a CA module in unit <b>1</b>.<b>10</b> based on such specification C has to be used to attach to the DVB-STB 3, in order to be able to receive and interpret in unit <b>1</b>.<b>11</b>, and consume the protected content in unit <b>1</b>.<b>12</b>.</p>
<p id="p-0059" num="0086">It is shown from the above mentioned situation, if DVB-STB 1 wants to receive and consume contents delivered by Operator B and C besides Operator A, user of DVB-STB 1 has to buy more than one CA systems which may cause much more than what user is not willing to pay.</p>
<p id="p-0060" num="0087">On the other hand it is also not possible for such DVB-STB to fulfil secure content storing and secure content transferring between different devices by carrying the same usage rules.</p>
<p id="p-0061" num="0088">Furthermore there is no any compatibility among all the existing CA systems, so that the cost for having the same DVB-STB be able to receive and consume contents from as many as operators would be very large to consumers. As new generation DVB-STB would have local storage embedded in the STB to not only receive but also store received content. Besides that, content transferring between such devices including Personal Video Recorder (PVR) would become demanding. So it is necessary to define a new DVB device to realise both interoperable and secure content delivery and transferring from end to end and also between such devices.</p>
<p id="h-0010" num="0000">End-to-End Solution</p>
<p id="p-0062" num="0089">Based on this invention, a future compliant DVB CPCM STB will contain a Baseline DVB-CPCM Module that is pre-implemented or embedded in a DVB STB, shown as in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0063" num="0090">An end to end solution based on DVB CPCM STB with the invented Baseline DVB-CPCM is illustrated in <figref idref="DRAWINGS">FIG. 2</figref>. The Baseline DVB-CPCM is specified, including its sub-function modules, CPCM Manager, Tools Box, Rights Management Module (Usage States &amp; Rules Parser), CAS-CPCM Converter between a private CAS (ECM &amp; EMM) and CPCM Usage States &amp; Rules, as well as Message Router which transmits all necessary messages.</p>
<p id="p-0064" num="0091"><figref idref="DRAWINGS">FIG. 3</figref>, the structure of MPEG-2 content protected by CPCM system is shown.</p>
<p id="p-0065" num="0092">As shown in <figref idref="DRAWINGS">FIG. 3</figref> a CPCM protected content will contain CPCM Control Information including CPCM Tool List, CPCM Right Holder and CPCM Tool Container, as well as CPCM Stream. CPCM Control Information is carried in PSI (Program Service Information) in MPEG-2 system, while CPCM Stream is carried as a specific elementary stream.</p>
<p id="p-0066" num="0093">There are two possible Use Cases for the above DVB CPCM STB.</p>
<p id="h-0011" num="0000">1) In the Case Content is Protected and Managed by the Standardized DVB CPCM System:</p>
<p id="p-0067" num="0094">Content will be encoded and encrypted with certain usage rules, and distributed/transmitted with other usage information that depends on user subscription, to DVB CPCM STB.</p>
<p id="p-0068" num="0095">Here since all elements, like encryption tool, and usage rules encoding, are based on the CPCM system, so Baseline DVB-CPCM, which is embedded in the STB will call up the decryption tool in the Tools Box, parse the usage rules by Rights Management Module, and then process the protected content.</p>
<p id="p-0069" num="0096">The encryption key is encrypted again and carried in a CPCM Stream. The key used to encrypt the encryption key, i.e., license key is either carried in Rights Holder, or made known to the DVB CPCM STB in some secure way, either via smart card, or via a return channel like modem line.</p>
<p id="p-0070" num="0097">Rights Management module in the invented Baseline DVB-CPCM of a complaint CPCM device will act for the following functions, as shown in <figref idref="DRAWINGS">FIGS. 4 and 5</figref>.</p>
<p id="p-0071" num="0098">In the <figref idref="DRAWINGS">FIG. 4</figref> for the case of broadcasting, the protected content with its CPCM information is passed to Rights Management (RM) module in the unit <b>1</b>, and CPCM Rights Holder will be retrieved in this module. Usage Rules and possibly the license key are carried in the CPCM Rights Holder.</p>
<p id="p-0072" num="0099">In the first step in the unit <b>2</b> as shown in <figref idref="DRAWINGS">FIG. 4</figref>, RM checks the content carried in CPCM Rights Holder against the CPCM_DomainID which user is entitled to receive and has registered into users. CPCM device, to verify whether this device is eligible to consume the content.
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0100">If the above result is negative, then the RM will generate an output message saying: you are not authorized, as shown in unit <b>3</b>.</li>
        <li id="ul0008-0002" num="0101">If the above result is positive, then the RM will retrieves the license Key either from Rights Holder or smart card in unit <b>4</b> to be ready for decrypting the encrypted encryption key which is carried in the CPCM Stream.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0073" num="0102">In the next step, the RM will check user's request or preference between Play or Play &amp; Copy in unit <b>5</b>.
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0000">
    <ul id="ul0010" list-style="none">
        <li id="ul0010-0001" num="0103">In the case of “Play only” requested by user, the retrieved License Key in unit <b>4</b> will be passed to unit <b>8</b> for decrypting the encrypted encryption key. The following step is to de-scramble the protected content in unit <b>9</b> and playback the content in unit <b>10</b>.</li>
        <li id="ul0010-0002" num="0104">In the case of Play &amp; Copy request by user, the RM will retrieve the Usage Rules in unit <b>6</b> to verify whether there is copy right to save the current content (or program in broadcasting case) in the storage in the complaint CPCM device.
        <ul id="ul0011" list-style="none">
            <li id="ul0011-0001" num="0105">If the above result is negative, then the RM will generate an output message saying: Copy/Move is prohibited, as shown in unit <b>7</b>.</li>
            <li id="ul0011-0002" num="0106">If the above result is positive, then the retrieved License Key in unit <b>4</b> will be passed to unit <b>8</b> for decrypting the encrypted encryption key. The following step is to de-scramble the protected content in unit <b>9</b> and playback the content in unit <b>10</b>. At the same time, in unit <b>11</b> the reconstructed encryption key is saved in Rights Management module for later use. The protected content is stored in local storage in the CPCM device in unit <b>12</b>.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0074" num="0107">In the <figref idref="DRAWINGS">FIG. 5</figref> for the case of content distribution, the protected content with its CPCM information is passed to Rights Management (RM) module in the unit <b>1</b>, and CPCM Rights Holder will be retrieved in this module. Usage Rules and possibly the license key are carried in the CPCM Rights Holder. In the first step in the unit <b>2</b> as shown in <figref idref="DRAWINGS">FIG. 5</figref>, RM checks CPCM_DomianID carried in CPCM Rights Holder against the CPCM_DomianID which has registered into user's CPCM device, to verify whether this device is in the Authorized Domain and is eligible to consume the content.
<ul id="ul0012" list-style="none">
    <li id="ul0012-0001" num="0000">
    <ul id="ul0013" list-style="none">
        <li id="ul0013-0001" num="0108">If the above result is negative, then the RM will generate an output message saying: you are not in authorized domain, as shown in unit <b>3</b>.</li>
        <li id="ul0013-0002" num="0109">If the above result is positive, then the RM will retrieves the license Key either from Rights Holder or smart card in unit <b>4</b> to be ready for decrypting the encrypted encryption key which is carried in the CPCM Stream.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0075" num="0110">In the next step, the RM will check user's request or preference between Play or Play &amp; Copy in unit <b>5</b>.
<ul id="ul0014" list-style="none">
    <li id="ul0014-0001" num="0000">
    <ul id="ul0015" list-style="none">
        <li id="ul0015-0001" num="0111">In the case of “Play only” requested by user, the retrieved License Key in unit <b>4</b> will be passed to unit <b>8</b> for decrypting the encrypted encryption key. The following step is to de-scramble the protected content in unit <b>9</b> and playback the content in unit <b>10</b>.</li>
        <li id="ul0015-0002" num="0112">In the case of Play &amp; Copy request by user, the RM will retrieve the Usage Rules in unit <b>6</b> to verify whether there is copy right to save the current content (or program in broadcasting case) in the storage in the complaint CPCM device.
        <ul id="ul0016" list-style="none">
            <li id="ul0016-0001" num="0113">If the above result is negative, then the RM will generate an output message saying: Copy/Move is prohibited, as shown in unit <b>7</b>.</li>
            <li id="ul0016-0002" num="0114">If the above result is positive, then the retrieved License Key in unit <b>4</b> will be passed to unit <b>8</b> for decrypting the encrypted encryption key. The following step is to de-scramble the protected content in unit <b>9</b> and playback the content in unit <b>10</b>. At the same time, in unit <b>11</b> the reconstructed encryption key is saved in Rights Management module for later use. The protected content is stored in local storage in the CPCM device in unit <b>12</b>.</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0076" num="0115">In <figref idref="DRAWINGS">FIG. 6</figref>, it is shown how CPCM Manager retrieves a tool, and obtains a missing tool in different ways.</p>
<p id="p-0077" num="0116">As in <figref idref="DRAWINGS">FIG. 6</figref>, CPCM Tool List is passed to CPCM Manager module in unit <b>1</b> to retrieve the requested tool. In unit <b>2</b> Tools Box will be looked up to search for the requested tool. If the requested tool exists in the Tools Box, the tool will be activated for functioning in unit <b>3</b>. Otherwise the CPCM Tool Container will be checked if it exists, shown in unit <b>4</b>.</p>
<p id="p-0078" num="0117">If the requested tool can be found in unit <b>4</b>, then the tool will be retrieved from the CPCM Tool Container and saved in the Tools Box in unit <b>5</b>. Otherwise the requested tool will be obtained from another CPCM device by sending a request message in unit <b>6</b>.</p>
<p id="p-0079" num="0118">If the tool request is accepted, then the tool will be transferred over and saved in the Tools Box in unit <b>7</b>. Otherwise the reply message will tell the reasons for the failure in unit <b>8</b>.</p>
<p id="p-0080" num="0119">In unit <b>9</b> a CPCM Plug-in module will be checked to see if there is such requested tool to use. If no, the requested tool has to be retrieved from remote side via a return channel, URL, or other means in unit <b>11</b>.</p>
<p id="h-0012" num="0000">2) In the Case Content is Protected and Managed by a Private CAS System:</p>
<p id="p-0081" num="0120">Content will be encrypted by control word in an ECM, and transmitted with their own format of EMM, to DVB CPCM STB.</p>
<p id="p-0082" num="0121">Since ECM and EMM are based on the private format of the CAS system, so a corresponding private CAS module is required in the DVB STB to decrypt and process the protected content.</p>
<p id="p-0083" num="0122">As shown in <figref idref="DRAWINGS">FIG. 2</figref>, a CPCM plug-in module (CAS-CPCM converter), such as Smart Card with DVB compliant Common Interface (CI), is provided by the CA vendor to receive and playback such content.</p>
<p id="p-0084" num="0123">Communications between a CAS-CPCM converter module and the Baseline DVB-CPCM module in the compliant CPCM device is realized across a DVB compliant Common Interface (CI). CAS is Conditional Access System.</p>
<p id="p-0085" num="0124">Next, mapping between CA system and Baseline DVB-CPCM for Storage is described.</p>
<p id="p-0086" num="0125">In the case if the content is just for playback, there is no necessity to conduct mapping. However, in the case if the content is granted to store in the DVB CPCM STB for future transferring in the authoring domain, a CAS-CPCM converter module with DVB compliant Common Interface (CI) is required to map the Usage Rules used in the private CA system to CPCM format for the Usage Rules. Besides mapping usage rules, the content also needs to be decrypted by the private CA system, and then be encrypted again by the Baseline DVB-CPCM, to store in the STB in an encrypted form together with their CPCM Control information (CPCM Tool List, CPCM Rights Holder, etc) as well as CPCM Stream to hold the encryption key and other relevant information. The following table shows the Functions of Each Modules Illustrated in <figref idref="DRAWINGS">FIG. 2</figref> for the end to end solution.</p>
<p id="p-0087" num="0126">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Functions of Each Modules Illustrated in FIG. 1</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="91pt" align="left"/>
<colspec colname="2" colwidth="126pt" align="left"/>
<tbody valign="top">
<row>
<entry>Module Name</entry>
<entry>Functions</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>Operator/Server Side</entry>
<entry/>
</row>
<row>
<entry>Rights Authoring</entry>
<entry>Editing of XML based Usage Rules</entry>
</row>
<row>
<entry>Tool</entry>
<entry>and converting it into Binary</entry>
</row>
<row>
<entry/>
<entry>format</entry>
</row>
<row>
<entry>Content Authoring Tool</entry>
<entry>Encoding and editing the content</entry>
</row>
<row>
<entry>Watermarking Tool</entry>
<entry>Embedding watermark on video or</entry>
</row>
<row>
<entry/>
<entry>audio</entry>
</row>
<row>
<entry>MPEG-2 Encoder</entry>
<entry>Creating MPEG-2 compliant Audio/</entry>
</row>
<row>
<entry/>
<entry>Video/System streams</entry>
</row>
<row>
<entry>CPCM Control Information</entry>
<entry>Creating CPCM Tool List, CPCM</entry>
</row>
<row>
<entry>Encoder</entry>
<entry>Rights Holder Descriptor, CPCM</entry>
</row>
<row>
<entry/>
<entry>Tool Container, CPCM Control</entry>
</row>
<row>
<entry/>
<entry>Graph</entry>
</row>
<row>
<entry>CPCM Tools</entry>
<entry>Encrypting a stream, hashing of</entry>
</row>
<row>
<entry/>
<entry>CPCM Control Information, etc.</entry>
</row>
<row>
<entry>Usage States &amp; Rules</entry>
<entry>Selecting and encoding usage rules</entry>
</row>
<row>
<entry>Encoder</entry>
<entry>based on user's subscription and</entry>
</row>
<row>
<entry/>
<entry>DomainID, etc.</entry>
</row>
<row>
<entry>CPCM Stream Generator</entry>
<entry>Encrypting the encryption key to</entry>
</row>
<row>
<entry/>
<entry>generate CPCM Stream. Other information</entry>
</row>
<row>
<entry/>
<entry>that a CPCM tool needs can also be put</entry>
</row>
<row>
<entry/>
<entry>in CPCM stream with proper timestamp.</entry>
</row>
<row>
<entry>Private CAS</entry>
<entry>Operation of any proprietary CA system.</entry>
</row>
<row>
<entry>Receiver/Client Side</entry>
</row>
<row>
<entry>Baseline DVB-CPCM</entry>
<entry>A Standardized Unit consisting of</entry>
</row>
<row>
<entry/>
<entry>several submodules that does CPCM</entry>
</row>
<row>
<entry/>
<entry>functions in a compliant CPCM Device</entry>
</row>
<row>
<entry>CPCM Manager</entry>
<entry>Managing tools box, parsing tool</entry>
</row>
<row>
<entry/>
<entry>list, retrieving CPCM tools; Content</entry>
</row>
<row>
<entry/>
<entry>and Domain management;</entry>
</row>
<row>
<entry>Tools Box</entry>
<entry>Holding all existing CPCM Tools;</entry>
</row>
<row>
<entry/>
<entry>Performing CPCM Tools function;</entry>
</row>
<row>
<entry>Rights Management</entry>
<entry>Parsing Binary (XML optional) based</entry>
</row>
<row>
<entry/>
<entry>Usage Rules carried in Rights Holder</entry>
</row>
<row>
<entry/>
<entry>Descriptor, and controls the consumption</entry>
</row>
<row>
<entry/>
<entry>or copy of content.</entry>
</row>
<row>
<entry>Message Router</entry>
<entry>A conceptual entity within Baseline</entry>
</row>
<row>
<entry/>
<entry>DVB-CPCM that provides Messaging</entry>
</row>
<row>
<entry/>
<entry>Interface between proprietary CPCM</entry>
</row>
<row>
<entry/>
<entry>tools or compliant CPCM Devices.</entry>
</row>
<row>
<entry>CAS-CPCM converter</entry>
<entry>Conversion of Proprietary CAS Usage</entry>
</row>
<row>
<entry/>
<entry>Rules into CPCM Usage Rules (CPCM</entry>
</row>
<row>
<entry/>
<entry>Rights Holder Descriptor) across DVB</entry>
</row>
<row>
<entry/>
<entry>Common Interface (CI), Re-Encryption,</entry>
</row>
<row>
<entry/>
<entry>forming of CPCM Stream.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0088" num="0127">Next, Baseline DVB-CPCM used in Transmission between CPCM Devices is described.</p>
<p id="p-0089" num="0128">Transmission between two compliant CPCM devices is realized through a standardized Baseline DVB-CPCM module Message Router that is pre-implemented in all CPCM devices. The communication is through messaging. interface to provide interoperability, as shown in <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0090" num="0129">Messages via Message Router (MR) provide the following transmissions between CPCM devices:
<ul id="ul0017" list-style="none">
    <li id="ul0017-0001" num="0000">
    <ul id="ul0018" list-style="none">
        <li id="ul0018-0001" num="0130">Content transferring from one to another;</li>
        <li id="ul0018-0002" num="0131">CPCM Tool transferring from one to another;</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0091" num="0132">The following identifications are defined to use for content management and user database management during content transferring and rights authentication.</p>
<p id="p-0092" num="0133">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Parameters defined for Content Transferring</entry>
</row>
<row>
<entry>in Authorized Domain</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="1" colwidth="119pt" align="left"/>
<colspec colname="2" colwidth="98pt" align="left"/>
<tbody valign="top">
<row>
<entry>IDs defined for Content</entry>
<entry/>
</row>
<row>
<entry>Management and Authorized Domain</entry>
</row>
<row>
<entry>or User Database Management</entry>
<entry>Definition and Usage</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
<row>
<entry>ContentID</entry>
<entry>An identifier assigned to each</entry>
</row>
<row>
<entry/>
<entry>content for content management</entry>
</row>
<row>
<entry>CPCM_DeviceID</entry>
<entry>An identifier assigned to each</entry>
</row>
<row>
<entry/>
<entry>CPCM compatible device to use</entry>
</row>
<row>
<entry/>
<entry>as address for sending and</entry>
</row>
<row>
<entry/>
<entry>receiving messages.</entry>
</row>
<row>
<entry>CPCM_DomainID</entry>
<entry>An identifier may obtain from</entry>
</row>
<row>
<entry/>
<entry>Operator upon user registration</entry>
</row>
<row>
<entry/>
<entry>and used for several CPCM</entry>
</row>
<row>
<entry/>
<entry>Devices in the same Authorized</entry>
</row>
<row>
<entry/>
<entry>Domain.</entry>
</row>
<row>
<entry namest="1" nameend="2" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0093" num="0134">It is assumed that an encrypted content is stored in CPCM Device A with CPCM Rights Holder containing its Usage Rules and the encryption key.</p>
<p id="h-0013" num="0000">1) Content Request Message Sending from CPCM Device B to CPCM Device A</p>
<p id="p-0094" num="0135">Now CPCM Device B sends message via Message Router to request certain content with the ContentID/ProgramNumber or possible elementary PIDs, as well as its CPCM_DomainID. Besides these parameters, CPCM Device B also generates one pair of keys and sends the PublicKey together with the above parameters to CPCM Device A, shown as in table 3.</p>
<p id="p-0095" num="0136">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 3</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Content Request Messages</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="105pt" align="left"/>
<colspec colname="2" colwidth="49pt" align="left"/>
<colspec colname="3" colwidth="42pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Messages</entry>
<entry>Length</entry>
<entry>Notes</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>ContentID/ProgramNumber</entry>
<entry> 4 bytes</entry>
<entry/>
</row>
<row>
<entry/>
<entry>CPCM_DomainID</entry>
<entry> 4 bytes</entry>
</row>
<row>
<entry/>
<entry>PublicKey</entry>
<entry>16 bytes</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
2) Verification—Mutual Authentication
</p>
<p id="p-0096" num="0137">Then, the CPCM Device A receives this message with all the parameters, searches ContentID/ProgramNumber in the storage, and verifies CPCM_DomianID against its CPCM_DomianID by CPCM Rights Management module in the Baseline DVB-CPCM. At the same time it checks the usage rules for the requested content/program, and finally grants copy or move right by sending a reply message to CPCM_Device_B.</p>
<p id="p-0097" num="0138">The reply message format is shown in Table 4, including error reporting.</p>
<p id="p-0098" num="0139">
<tables id="TABLE-US-00004" num="00004">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 4</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Response Message for Content Request</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="63pt" align="center"/>
<colspec colname="2" colwidth="7pt" align="center"/>
<colspec colname="3" colwidth="105pt" align="left"/>
<colspec colname="4" colwidth="28pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Reply Message</entry>
<entry/>
<entry/>
<entry/>
</row>
<row>
<entry/>
<entry>&amp; Codes</entry>
<entry/>
<entry>Error Reporting</entry>
<entry>Note</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="42pt" align="center"/>
<colspec colname="3" colwidth="105pt" align="left"/>
<colspec colname="4" colwidth="28pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>No</entry>
<entry>00</entry>
<entry>No such content.</entry>
<entry/>
</row>
<row>
<entry/>
<entry>No</entry>
<entry>01</entry>
<entry>You are not in the authorized</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>domain.</entry>
</row>
<row>
<entry/>
<entry>No</entry>
<entry>10</entry>
<entry>Prohibit in Copy/Move mode</entry>
</row>
<row>
<entry/>
<entry>Yes</entry>
<entry>11</entry>
<entry>Transferring is allowed</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
3) On-line Encryption for the Encryption Key to create CPCM Stream
</p>
<p id="p-0099" num="0140">After finishing the above Rights Authentication, the encryption key stored together with the content in CPCM Device A, will be encrypted by the PublicKey received from CPCM Device B to form a CPCM Stream.</p>
<p id="h-0014" num="0000">4) Content Transferring from CPCM Device A to CPCM Device B</p>
<p id="p-0100" num="0141">Now the requested content, together with Usage Rules (may changed) and the formed CPCM Stream, is transferred from CPCM Device A to CPCM Device B securely via secured channel.</p>
<p id="h-0015" num="0000">5) Tool Transferring Between CPCM Device A and CPCM Device B</p>
<p id="p-0101" num="0142">CPCM Manager in CPCM Device B retrieves CPCM Control Information carried in PSI of MPEG-2 TS stream to obtain CPCM Tool List. CPCM Manager checks the CPCM Tool List against with Tools Box in CPCM Device B, and cannot find the Tool indicated by ToolID. This may happen for the case where a new or upgraded CPCM Tool is used but the CPCM Device B does not implement.</p>
<p id="p-0102" num="0143">In this case CPCM Device B has three ways to obtain the missing CPCM Tool.
<ul id="ul0019" list-style="none">
    <li id="ul0019-0001" num="0144">a) CPCM Device B sends Tool Request Message to CPCM Device A via Message Router, to request the Tool with the ToolID. At the same time it also sends its CPCM_DomainID to CPCM Device A. The Tool Request Messages format is shown as in Table 5.</li>
</ul>
</p>
<p id="p-0103" num="0145">
<tables id="TABLE-US-00005" num="00005">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 5</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Tool Request Message Format</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="4">
<colspec colname="offset" colwidth="21pt" align="left"/>
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="70pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>Tool Request Message</entry>
<entry>Length</entry>
<entry>Note</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>ToolID</entry>
<entry>2 bytes</entry>
<entry/>
</row>
<row>
<entry/>
<entry>CPCM_DomainID</entry>
<entry>4 bytes</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0104" num="0146">CPCM Device A receives the Tool Request Message, it may choose to do a mutual authentication with Device B, and checks Tools Box with the ToolID for the transferring permission status as shown in Table 6.</p>
<p id="p-0105" num="0147">
<tables id="TABLE-US-00006" num="00006">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 6</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Tool Description in a Tools Box of CPCM Device</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="28pt" align="center"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<colspec colname="5" colwidth="42pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry/>
<entry/>
<entry/>
<entry>Status for</entry>
</row>
<row>
<entry>ToolID</entry>
<entry>Number</entry>
<entry>Function</entry>
<entry>Source</entry>
<entry>Transferring</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="28pt" align="char" char="."/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<colspec colname="5" colwidth="42pt" align="center"/>
<tbody valign="top">
<row>
<entry>00000001</entry>
<entry>1</entry>
<entry>Encryption1</entry>
<entry>Pre-</entry>
<entry>No</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>implemented</entry>
</row>
<row>
<entry>00000002</entry>
<entry>2</entry>
<entry>Encryption2</entry>
<entry>Pre-</entry>
<entry>No</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>implemented</entry>
</row>
<row>
<entry>00000004</entry>
<entry>4</entry>
<entry>Encryption3</entry>
<entry>Pre-</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>implemented</entry>
</row>
<row>
<entry>00000006</entry>
<entry>6</entry>
<entry>Digital Sign</entry>
<entry>Pre-</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>implemented</entry>
</row>
<row>
<entry>000000010</entry>
<entry>10</entry>
<entry>Watermarking</entry>
<entry>Pre-</entry>
<entry>No</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Embedding</entry>
<entry>implemented</entry>
</row>
<row>
<entry>000000011</entry>
<entry>11</entry>
<entry>Watermarking</entry>
<entry>Pre-</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Embedding</entry>
<entry>implemented</entry>
</row>
<row>
<entry>000000012</entry>
<entry>12</entry>
<entry>Watermarking</entry>
<entry>Pre-</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Detection</entry>
<entry>implemented</entry>
</row>
<row>
<entry>000000020</entry>
<entry>20</entry>
<entry>Encryption20</entry>
<entry>Loaded from</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>CPCM Device</entry>
</row>
<row>
<entry>000000021</entry>
<entry>21</entry>
<entry>Encryption21</entry>
<entry>Loaded from</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Content Stream</entry>
</row>
<row>
<entry>000000022</entry>
<entry>22</entry>
<entry>Encryption22</entry>
<entry>Loaded from</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Plug-in module</entry>
</row>
<row>
<entry>000000023</entry>
<entry>23</entry>
<entry>Encryption23</entry>
<entry>Loaded from</entry>
<entry>Yes</entry>
</row>
<row>
<entry/>
<entry/>
<entry/>
<entry>Remote URL</entry>
</row>
<row>
<entry namest="1" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0106" num="0148">If the status is yes, then CPCM Device A will send reply to CPCM Device B, followed by sending the Tool with its associated description to CPCM Device B.
<ul id="ul0020" list-style="none">
    <li id="ul0020-0001" num="0149">b) As shown in table 6, the missing tool also can be retrieved from the content stream carried in CPCM Tool Container;</li>
    <li id="ul0020-0002" num="0150">c) As shown in table 6, the missing tool also can be obtained from another CPCM device;</li>
    <li id="ul0020-0003" num="0151">d) As shown in table 6, the missing tool also can be retrieved from the remote URLs via a return channel or other means, which is out of this scope of the proposal;</li>
</ul>
</p>
<p id="p-0107" num="0152">Next standardized components in the baseline DVB-CPCM is described.</p>
<p id="p-0108" num="0153">Those function modules used in a Baseline DVB-CPCM are listed in the Table 7 below.</p>
<p id="p-0109" num="0154">
<tables id="TABLE-US-00007" num="00007">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 7</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Function Module of Baseline DVB-CPCM</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="49pt" align="left"/>
<colspec colname="2" colwidth="112pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<tbody valign="top">
<row>
<entry>Module</entry>
<entry/>
<entry/>
</row>
<row>
<entry>Name</entry>
<entry>Function Description</entry>
<entry>Suggestion</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>1. CPCM</entry>
<entry>Content Management</entry>
<entry>normative</entry>
</row>
<row>
<entry>Manager</entry>
<entry>Authorized Domain Management</entry>
</row>
<row>
<entry/>
<entry>CPCM Control Information Retrieval</entry>
</row>
<row>
<entry/>
<entry>(Tool List, CPCM Rights Holder,</entry>
</row>
<row>
<entry/>
<entry>Tool)</entry>
</row>
<row>
<entry>2. Tools Box</entry>
<entry>Holding CPCM Tools and their</entry>
<entry>normative</entry>
</row>
<row>
<entry/>
<entry>Description</entry>
</row>
<row>
<entry/>
<entry>Performing Tool's Function</entry>
</row>
<row>
<entry>3. Rights</entry>
<entry>Parsing Usage States &amp; Rules (from</entry>
<entry>normative</entry>
</row>
<row>
<entry>Management</entry>
<entry>Rights Holder Descriptor in CPCM</entry>
</row>
<row>
<entry/>
<entry>Control Information) and Storing</entry>
</row>
<row>
<entry/>
<entry>them in a secure table with its</entry>
</row>
<row>
<entry/>
<entry>ContentID</entry>
</row>
<row>
<entry>4. Message</entry>
<entry>Providing message interface to</entry>
<entry>normative</entry>
</row>
<row>
<entry>Router</entry>
<entry>CPCM devices; Routing messages</entry>
</row>
<row>
<entry/>
<entry>between proprietary CPCM tools</entry>
</row>
<row>
<entry/>
<entry>(CPCM plug-ins) and device; Routing</entry>
</row>
<row>
<entry/>
<entry>messages between CPCM devices.</entry>
</row>
<row>
<entry>5. CAS-CPCM</entry>
<entry>Transcoding Proprietary Usage Rules</entry>
<entry>Optional for</entry>
</row>
<row>
<entry>converter</entry>
<entry>into CPCM Rights Holder Descriptor</entry>
<entry>CPCM Devices;</entry>
</row>
<row>
<entry/>
<entry>via CI; Controlling re-encryption</entry>
<entry>Used for</entry>
</row>
<row>
<entry/>
<entry>using CPCM Tools in Tool Box for</entry>
<entry>backward</entry>
</row>
<row>
<entry/>
<entry>storage; Forming CPCM Stream.</entry>
<entry>Compatibility</entry>
</row>
<row>
<entry/>
<entry/>
<entry>for private CAS;</entry>
</row>
<row>
<entry>All Types</entry>
</row>
<row>
<entry>of Message</entry>
</row>
<row>
<entry>Format</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0110" num="0155">As shown in the Table 7, except the last module, all other five modules including their functions and behaviors, are needed to be normative and standardized to provide worldwide interoperability.</p>
<p id="p-0111" num="0156">The message format from/to Message Routers between CPCM devices and proprietary CPCM tools (plug-ins) will be normative, and it is used for Content transferring, Tool transferring, mutual authentication between CPCM devices, as well as interfacing with CPCM plug-ins.</p>
<p id="p-0112" num="0157">Interfaces between different modules inside a Baseline DVB-CPCM are not defined here, and it is implementation matter. Even the interface between Baseline DVB-CPCM and DVB STB is also not defined here as long as Baseline DVB-CPCM fulfils all the functions that are defined here.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) on sender side used in a complete business environment, said apparatus distributing a CPCM protected content in which content protection and copy management (CPCM) information for CPCM is attached to an encrypted content stream, said apparatus comprising:
<claim-text>means for generating said encrypted content stream on the content owner side or operator side;</claim-text>
<claim-text>means for generating said CPCM information which specifies an authorized domain which is authorized to perform one of reproduction and copy of said CPCM protected content;</claim-text>
<claim-text>means for generating said CPCM protected content by attaching said CPCM information to said encrypted content stream; and</claim-text>
<claim-text>means for delivering said CPCM protected content.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. Apparatus of a Baseline DVB-CPCM for generating content protection and copy management (CPCM) control information and generating content protection and copy management (CPCM) stream in <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising:
<claim-text>means for forming a Tool List as CPCM Tool List to list all the tools used to protecting said content by using a tool ID (identifier) to be assigned to any tool used for protecting said content including such as encryption, watermarking embedding, watermarking detecting, digital signing;</claim-text>
<claim-text>means for creating CPCM Rights Holder by including usage rules, copy rights, etc. which is related to said content in a specific format;</claim-text>
<claim-text>means for creating a CPCM Control Graph to tell a protection sequence using different tools in different position;</claim-text>
<claim-text>means for creating a CPCM Tool Container to carry a CPCM tool with certain CPCM Tool ID;</claim-text>
<claim-text>means for forming a CPCM Stream to carry key information, control information, and time stamp information which are related to those information of using said tools to protect said content.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) on receiver side, comprising:
<claim-text>means for receiving a CPCM protected content stream with its CPCM information and CPCM stream in CPCM device, said CPCM information specifying an authorized domain which is authorized to perform one of reproduction and copy of said CPCM protected content;</claim-text>
<claim-text>means for retrieving said CPCM information by said CPCM device to verify against pre-registered information in a Baseline DVB of said CPCM device to see whether said CPCM device is in an authorized domain;</claim-text>
<claim-text>means for retrieving said CPCM information by said CPCM device to decrypt said encrypted content stream;</claim-text>
<claim-text>means for storing the content in a protected form in said CPCM device; and</claim-text>
<claim-text>means for transferring the CPCM protected content from said CPCM device to another complaint CPCM device in a secure manner, after authenticating they are belong to the same authorized domain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) used for end-to-end solution on sender side, comprising:
<claim-text>means for generating a CPCM protected content stream on the content owner side or operator side;</claim-text>
<claim-text>means for forming a Tool List as CPCM Tool List to list all the tools used to protecting said content by using a tool ID code to be assigned to any tool used for protecting said content including such as encryption, watermarking embedding, watermarking detecting, digital signing;</claim-text>
<claim-text>means for creating CPCM Rights Holder by including usage rules, copy rights, etc. which is related to said content in a specific format;</claim-text>
<claim-text>means for creating a CPCM Control Graph to tell a protection sequence using different tools in different position;</claim-text>
<claim-text>means for creating a CPCM Tool Container to carry a CPCM tool with certain CPCM Tool ID;</claim-text>
<claim-text>means for forming a CPCM Stream to carry key information, control information, and time stamp information which are related to those information of using said tools to protect said content;</claim-text>
<claim-text>means for placing said CPCM information including CPCM Tool List, CPCM Rights Holder, CPCM Control Graph, CPCM Tool Container, as well as CPCM Stream in the system layer in the specified location and specified format, together with said CPCM protected content stream;</claim-text>
<claim-text>means for assigning Content ID as content identifier for content management on both operator side and user side; and</claim-text>
<claim-text>means for delivering said CPCM protected content with its said CPCM information to CPCM device in a secure manner, said CPCM device belonging to said authorized domain set by specifying CPCM_DomainID as CPCM Domain Identifier for authorized domain management.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. Apparatus of a Baseline DVB-CPCM for generating a protected content stream on the content owner side or operator side in <claim-ref idref="CLM-00003">claim 3</claim-ref>, further comprising:
<claim-text>means for embedding copy control information in a content using said CPCM tools, such as watermarking, if there is such requirement;</claim-text>
<claim-text>means for encoding a content based on existing formats such as MPEG-2 using encoding tools, to form a content stream;</claim-text>
<claim-text>means for encrypting said content stream using said CPCM tool to form a protected content.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) on receiver side, comprising:
<claim-text>means for receiving a transmitted content by a CPCM device;</claim-text>
<claim-text>means for authorizing said CPCM device to see whether it belongs to said authorized domain;</claim-text>
<claim-text>means for retrieving said CPCM information included in said transmitted content by said CPCM device to obtain said protection information;</claim-text>
<claim-text>means for verifying said usage rules of content by said CPCM device before taking action on user's request;</claim-text>
<claim-text>means for decrypting said CPCM protected content using said retrieved CPCM information by calling up CPCM tools from said CPCM device or a proprietary CPCM Plug-in module if the requested CPCM tool is missing in said CPCM device;</claim-text>
<claim-text>means for playing back said decrypted content to said user; and</claim-text>
<claim-text>means for storing the CPCM protected content with its CPCM information in said CPCM device if said user has such request.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) used for content transferring between devices, comprising:
<claim-text>means for setting a set of messages for content transferring with the data structure for several parameters used for content transferring;</claim-text>
<claim-text>means for receiving a Content Request Message which is sent with several defined parameters by CPCM device B to request a content transferring from CPCM device A;</claim-text>
<claim-text>means for verifying said several parameters received by said CPCM device A with the data pre-saved in said CPCM device A which is CPCM information specifying an authorized domain which is authorized to perform one of reproduction and copy of said CPCM protected content, to authenticate whether said CPCM device A and B are in the same domain, whether the requested content is in said CPCM device A, whether there is such copy/move rights attached to said content;</claim-text>
<claim-text>means for sending a Content Response Message with several reply messages for different cases by said CPCM device to said CPCM device B, after the above said verification; and</claim-text>
<claim-text>means for sending the requested content from said CPCM device A together with its CPCM information to said CPCM device B in a secure manner if the above said reply is positive.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. Apparatus of a Baseline DVB-CPCM for sending a Content Request Message with several defined parameters by a CPCM device B to request a tool transferring from another CPCM device A in <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising:
<claim-text>means for sending a Content Request Message with the ContentID for the requested content, the CPCM_DomainID for domain authentication, and the PublicKey for using to encrypt encryption key.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) used for CPCM tool transferring, comprising:
<claim-text>means for setting a set of messages for tool transferring with the data structure for several parameters used for tool transferring;</claim-text>
<claim-text>means for sending a Tool Request Message with several defined parameters by CPCM device B to request a tool transferring from CPCM device A;</claim-text>
<claim-text>means for verifying said several parameters received by said CPCM device A with the data pre-saved in said CPCM device A which is CPCM information specifying an authorized domain which is authorized to perform one of reproduction and copy of said CPCM protected content, to authenticate whether said CPCM device A and B are in the same domain, whether the requested tool is in said CPCM device A, whether the requested tool is allowed to transfer to another CPCM device;</claim-text>
<claim-text>means for sending a Tool Response Message with several reply messages for different cases by said CPCM device to said CPCM device B, after the above said verification; and</claim-text>
<claim-text>means for sending the requested tool from said CPCM device A together with its status for transferring to said CPCM device B in a secure manner if the above said reply is positive,</claim-text>
<claim-text>wherein said CPMP device B retrieves said CPCM tool from other sources if the above said reply is negative.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. Apparatus of a Baseline DVB-CPCM for sending a Tool Request Message with several defined parameters by a CPCM device B to request a tool transferring from another CPCM device A in <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising
<claim-text>means for sending a Tool Request Message with the ToolID for the requested tool, the CPCM_DomainID for domain authentication, and the PublicKey for using to encrypt said tool.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. Apparatus of a Baseline DVB-CPCM for retrieving said CPCM tool from other sources if the above said reply is negative in <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>means for downloading from said other sources via a return channel, a defined URL, or other means in a secure manner.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. Apparatus of a Baseline DVB-CPCM for sending a Content Request Message and sending Tool Request Message in <claim-ref idref="CLM-00007">claim 7</claim-ref>, further comprising:
<claim-text>means for using a defined CPCM_DeviceID as CPCM Device Identifier for its CPCM devices within the same authorized domain;</claim-text>
<claim-text>means for using said CPCM_DeviceID to send a message to a CPCM device that has said CPCM_DeviceID, and at the same time using another CPCM_DeviceID for the message sender's address.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. Apparatus of a Baseline DVB-CPCM (Digital Video Broadcasting for Content Protection and Copy Management) comprising:
<claim-text>CPCM Manager module for the Baseline DVB-CPCM, to retrieve CPCM information that is placed in a system layer of a received content stream, and to process said CPCM Too List information and retrieve CPCM tools indicated by ToolID in said CPCM Tool List;</claim-text>
<claim-text>Rights Management module for the Baseline DVB-CPCM, to retrieve said CPCM Rights Holder information for domain authentication, usage rules verification, and session key delivery if it is necessary;</claim-text>
<claim-text>Tools Box module for the Baseline DVB-CPCM, to hold the possible defined CPCM tools or tools transferred and retrieved from other sources, and to activate the requested tool for performing its function;</claim-text>
<claim-text>Message Router module for the Baseline DVB-CPCM, to use for message interface for sending and receiving message between CPCM devices, especially for communication between a compliant CPCM device and a proprietary CPCM Plug-in module;</claim-text>
<claim-text>CAS-CPCM Converter module for the Baseline DVB-CPCM, to use for converting usage rules set by an existing CA (Conditional System) system across the DVB compliant common interface (CI) for backward compatibility;</claim-text>
<claim-text>Key Generator module for the Baseline DVB-CPCM, to generate a pair of keys for secure content transferring.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. Apparatus of a Baseline DVB-CPCM for sending a Content Request Message and sending Tool Request Message in <claim-ref idref="CLM-00009">claim 9</claim-ref>, further comprising:
<claim-text>means for using a defined CPCM_DeviceID as CPCM Device Identifier for its CPCM devices within the same authorized domain;</claim-text>
<claim-text>means for using said CPCM_DeviceID to send a message to a CPCM device that has said CPCM_DeviceID, and at the same time using another CPCM_DeviceID for the message sender's address.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
