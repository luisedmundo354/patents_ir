<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298706-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298706</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10573774</doc-number>
<date>20050819</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2004-243920</doc-number>
<date>20040824</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>101</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>R</subclass>
<main-group>31</main-group>
<subgroup>08</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370252</main-classification>
<further-classification>370503</further-classification>
</classification-national>
<invention-title id="d0e71">Method and apparatus for power line communication</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6765889</doc-number>
<kind>B1</kind>
<name>Ludwig</name>
<date>20040700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370331</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>2003/0016123</doc-number>
<kind>A1</kind>
<name>Tager et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2004/0070912</doc-number>
<kind>A1</kind>
<name>Kopp</name>
<date>20040400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2005/0096031</doc-number>
<kind>A1</kind>
<name>Sugaya et al.</name>
<date>20050500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>4554221</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>JP</country>
<doc-number>2002-158675</doc-number>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070025262</doc-number>
<kind>A1</kind>
<date>20070201</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yoshida</last-name>
<first-name>Shigeo</first-name>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ohmi</last-name>
<first-name>Shinichiro</first-name>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yasukawa</last-name>
<first-name>Tohru</first-name>
<address>
<city>Wakayama</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yamaguchi</last-name>
<first-name>Tsuyoshi</first-name>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Wenderoth, Lind &amp; Ponack, L.L.P.</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Matsushita Electric Industrial Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Ho</last-name>
<first-name>Duc</first-name>
<department>2616</department>
</primary-examiner>
</examiners>
<pct-or-regional-filing-data>
<document-id>
<country>WO</country>
<doc-number>PCT/JP2005/015499</doc-number>
<kind>00</kind>
<date>20050819</date>
</document-id>
<us-371c124-date>
<date>20060328</date>
</us-371c124-date>
</pct-or-regional-filing-data>
<pct-or-regional-publishing-data>
<document-id>
<country>WO</country>
<doc-number>WO2006/022363</doc-number>
<kind>A </kind>
<date>20060302</date>
</document-id>
</pct-or-regional-publishing-data>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The variation cycle L of the characteristics of a transmission line is divided into a plurality of sections (n sections), a procedure is repeated in which transmission line estimation is performed for only one section among n sections in one beacon period, and thus transmission line estimation is performed for all of the n sections. The beacon period T is set based on (T=L×m/n), where n is an integer that is 2 or larger, and m is an integer that is n or larger and whose greatest common measure with n is 1.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="124.21mm" wi="210.57mm" file="US07298706-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="211.24mm" wi="137.67mm" orientation="landscape" file="US07298706-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="253.41mm" wi="103.29mm" orientation="landscape" file="US07298706-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="254.08mm" wi="112.27mm" orientation="landscape" file="US07298706-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="258.83mm" wi="111.51mm" orientation="landscape" file="US07298706-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="233.09mm" wi="171.53mm" file="US07298706-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="211.24mm" wi="156.29mm" file="US07298706-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="232.75mm" wi="169.59mm" file="US07298706-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="228.43mm" wi="169.59mm" orientation="landscape" file="US07298706-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="146.22mm" wi="161.80mm" file="US07298706-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="233.17mm" wi="168.74mm" file="US07298706-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present invention relates to a communication apparatus and a transmission line estimation method. More specifically, the present invention relates to a communication apparatus sending and receiving data based on the characteristics of a transmission line between apparatuses without lowering the throughput, and a transmission line estimation method (channel estimation) performed by the communication apparatus, by which the characteristics of the transmission line are estimated and evaluated with a high precision.</p>
<heading id="h-0002" level="1">BACKGROUND ART</heading>
<p id="p-0003" num="0002">In a communication method by which communication parameters such as a subcarrier and a modulation method used for transmission and reception are determined based on estimation on the characteristics of a transmission line, it is important to precisely determine the communication parameters that are suitable for the characteristics of the transmission line in transmission. In particular, in a communication system having attenuation characteristics that deeply depend on the frequency (power line carrier communications having a power line as a communication medium, for example), it is effective to use a multi-carrier transmission line method using a subcarrier and a modulation method that are suitable for the characteristics of the transmission line</p>
<p id="p-0004" num="0003">In a transmission line estimation method used in conventional communication systems, a transmission line is estimated periodically or when the number of retransmissions due to communication errors exceeds a specified value (considering that the characteristics of the transmission line are deteriorated) Then, based on the result of this estimation on the transmission line, new parameters are selected, and data is sent or received. This technique has been disclosed in, for example, JP2002-158675A.</p>
<p id="p-0005" num="0004">However, in an environment in which the characteristics of the transmission line vary periodically, the communication parameters selected when estimating the transmission line often do not suit for the characteristics of the transmission line when sending data if a timing of sending data is not synchronized with the periodical variation of the characteristics of the transmission line. Thus, in the above-described conventional method, the maximum communication efficiency is not always obtained even when the transmission line is estimated.</p>
<p id="p-0006" num="0005">Thus, as a countermeasure for this problem, a following method has been conventionally proposed.</p>
<p id="p-0007" num="0006">First, the variation cycle of the characteristics of a transmission line is synchronized with the frame period of a communication system, and this variation cycle is divided into a plurality of sections. Next, within one frame period, the plurality of divided sections of the transmission line are continuously estimated section by section. Then, as a result of the transmission line estimation, communication parameters obtained in a section with the highest communication efficiency are selected and then communications are performed. <figref idref="DRAWINGS">FIG. 12</figref> is a process sequence of this conventional method for estimating a transmission line.</p>
<p id="p-0008" num="0007">However, in the conventional method shown in <figref idref="DRAWINGS">FIG. 12</figref>, there is the problem that the transmission line is estimated continuously, and thus requests to estimate the transmission line and their response messages occupy the transmission line and disturb communications of stream data, audio data, or other data that is supposed to be sent. Furthermore, in this conventional method, a time from the starting point of the frame period of the communication system to the starting time of a transmission line estimation section is different for each frame period. As a result, when the band is guaranteed, for example, with time sharing, not only is scheduling for transmission line estimation complicated, but also arises a case in which a scheduling condition cannot be satisfied.</p>
<heading id="h-0003" level="1">DISCLOSURE OF THE INVENTION</heading>
<p id="p-0009" num="0008">Therefore, an object of the present invention is to provide a communication apparatus in which a transmission line is estimated in a distributed manner by a simple scheduling, so that the characteristics of the transmission line are estimated and evaluated with a high precision and thus data can be sent and received at a high throughput without affecting other streams, and a transmission line estimation method performed by the communication apparatus.</p>
<p id="p-0010" num="0009">The present invention is directed to a communication apparatus performing periodical communications with another communication apparatus via a transmission line. In order to achieve the above-described object, the communication apparatus of the present invention is provided with a communication control portion, a transmission line estimation portion, and a communication parameter determination portion.</p>
<p id="p-0011" num="0010">The communication control portion sets the communication period to (L×m/n) (L is the variation cycle of the characteristics of a transmission line, n is an integer that is 2 or larger, and m is an integer that is n or larger and whose greatest common measure with n is 1) to perform communications. The transmission line estimation portion estimates the characteristics of the transmission line within a time (L/n) after a certain offset time (L×k/n) (k is a real number that is 0 or larger) has passed since the communication period started. The communication parameter determination portion determines a communication parameter to be used by the communication control portion, based on a result of estimation by the transmission line estimation portion.</p>
<p id="p-0012" num="0011">It is preferable that the transmission line estimation portion estimates the characteristics of the transmission line at least n times. Furthermore, the communication apparatus may estimate the characteristics of the transmission line at the initial starting up or upon detecting a change in a state of the transmission line. A typical communication period is the period of beacons sent from a communication apparatus serving as a base unit. When there is a request to estimate the characteristics of the transmission line, the communication apparatus sends a request to allocate a time for estimating the characteristics of the transmission line to the communication apparatus serving as the base unit, and the characteristics of the transmission line are estimated only when permission is given. This request may be notified using the beacon frame or the polling frame to another communication apparatus. A typical variation cycle L of the characteristics of the transmission line is the half cycle of the commercial power supply cycle.</p>
<p id="p-0013" num="0012">Each of the processes performed by each of the components of the communication apparatus described above can be regarded as a transmission line estimation method that gives a series of procedures. This method is provided in the form of a program for letting a computer execute the series of procedures. This program may be introduced in a computer in the form stored in a computer-readable storage medium. Furthermore, a part of the functional blocks described above that constitute the communication apparatus may be realized as an LSI, which is an integrated circuit.</p>
<p id="p-0014" num="0013">As described above, according to the present invention, a transmission line is estimated in a distributed manner by a simple scheduling, so that the characteristics of the transmission line are estimated and evaluated with a high precision and thus data can be sent and received at a high throughput without affecting other streams.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram showing a configuration example of a communication network system using communication apparatuses according to a first embodiment of the present invention.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram showing an example of timings at which a transmission line is estimated by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing another example of timings at which a transmission line is estimated by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing another example of timings at which a transmission line is estimated by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> is a communication sequence showing the procedure following which a transmission line is estimated by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> is a diagram showing an example of a tonemap.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 7</figref> is a diagram explaining the relationship between a noise and transmission line estimation sections.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 8</figref> is another communication sequence showing the procedure following which a transmission line is estimated by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 9</figref> is a diagram explaining a method by which a beacon period is determined by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 10</figref> is a diagram explaining a method by which a beacon period is determined by the communication apparatuses according to the first embodiment of the present invention.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 11</figref> is a diagram showing an example of a communication network system in which the communication apparatuses of the present invention are applied to high-speed power line transmission.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 12</figref> is a communication sequence showing the procedure following which a transmission line is estimated by a conventional communication apparatus.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">BEST MODE FOR CARRYING OUT THE INVENTION</heading>
<p id="p-0027" num="0026">Hereinafter, embodiments of the present invention will be described with reference to the drawings.</p>
<heading id="h-0006" level="1">First Embodiment</heading>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram showing a configuration example of a communication network system using a communication apparatus <b>1</b> according to a first embodiment of the present invention. In <figref idref="DRAWINGS">FIG. 1</figref> in the communication network system of the present invention, a plurality of communication apparatuses <b>1</b> are connected to each other via a transmission line <b>2</b>. The transmission line <b>2</b> may be either wired or wireless. This embodiment will be described using, as an example, the communication network system in which one of the plurality of communication apparatuses <b>1</b> is a master unit, and this master unit periodically transmits a beacon so as to control the communications of the other communication apparatuses <b>1</b> (slave units).</p>
<p id="p-0029" num="0028">The communication apparatus <b>1</b> is provided with a communication control portion <b>11</b>, a transmission line estimation portion <b>12</b>, and a communication parameter determination portion <b>13</b>. The communication control portion <b>11</b> deals with most of the communication processes performed by the communication apparatus <b>1</b>. Basically, this communication control portion <b>11</b> performs communications with another communication apparatus <b>1</b> using communication parameters determined by the communication parameter determination portion <b>13</b>. The transmission line estimation portion <b>12</b> measures the characteristics of the transmission line <b>2</b> at predetermined periodical timings and estimates a state of the transmission line <b>2</b>. The communication parameter determination portion <b>13</b> sets or updates communication parameters based on the result obtained when transmission line estimation portion <b>12</b> estimates the transmission line <b>2</b>.</p>
<p id="p-0030" num="0029">Hereinafter, a method by which the thus configured communication apparatus <b>1</b> estimates the characteristics of a transmission line will be described. <figref idref="DRAWINGS">FIGS. 2 to 4</figref> are diagrams each showing an example of timings at which a transmission line is estimated by the communication apparatus <b>1</b> according to the first embodiment of the present invention. <figref idref="DRAWINGS">FIG. 5</figref> is a communication sequence showing the procedure following which a transmission line is estimated by the communication apparatus <b>1</b> according to the first embodiment of the present invention.</p>
<p id="p-0031" num="0030">In this embodiment, a case will be described in which in the transmission line <b>2</b> in the communication network system, a noise with a certain pattern (the mark X in <figref idref="DRAWINGS">FIG. 2</figref>) is generated with certain intervals as shown in <figref idref="DRAWINGS">FIG. 2</figref>, that is, the variation cycle of the characteristics of the transmission line corresponds to these certain intervals. In this case, the communication control portion <b>11</b> in each of the communication apparatuses <b>1</b> that constitute the communication network system sets the beacon period, which will be the communication period, in the following manner. Herein, the beacon period refers to a time interval between when a beacon is transmitted by the master unit and when its next beacon is transmitted.</p>
<p id="p-0032" num="0031">There is a case in which due to an influence of a power circuit of, for example, a household electrical appliance that is connected to a power line, the cycle of a noise pattern on the power line is the same as the half cycle of a commercial power supply (50 Hz or 60 Hz). Accordingly, when assuming a communication network system using a power line, it is necessary to consider the characteristics of a transmission line that has been synchronized with the half cycle of the commercial power supply described above (see sine waves in <figref idref="DRAWINGS">FIG. 2</figref>).</p>
<p id="p-0033" num="0032">A point of the setting is that a variation cycle L of the characteristics of the transmission line is divided into n sets of sections (n sections), a procedure is repeated in which transmission line estimation is performed for only one section among n sections in one beacon period, and thus transmission line estimation is performed for all of the n sections. A beacon period T for realizing this point is set based on “T=L×m/n”, where n is an integer that is 2 or larger, and m is an integer that is n or larger and whose greatest common measure with n is 1. Furthermore an offset time is set based on “L×k/n”, where k is a real number that satisfies 0≦k&lt;m. In this manner, when the offset time is set to enable a transmission line to be estimated within one beacon period and section by section, it is possible to deal with a variation of the transmission line quickly. It should be noted that the offset time can be set freely if dealing with a variation of the transmission line rapidly is not considered.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIGS. 2 and 3</figref> are examples in which n=3 and m=17. <figref idref="DRAWINGS">FIG. 4</figref> is an example in which n=4 and m=19. When assuming a communication network system using a power line as described above, the beacon period T is calculated using L=8.333 msec when the commercial power supply frequency is 60 Hz and using L=10 msec when the commercial power supply frequency is 50 Hz. In <figref idref="DRAWINGS">FIGS. 2 to 4</figref>, a description of the beacon itself has been omitted. Furthermore, regarding the offset time, k=16 in <figref idref="DRAWINGS">FIG. 2</figref>, k=15 in <figref idref="DRAWINGS">FIG. 3</figref>, and k=17 in <figref idref="DRAWINGS">FIG. 4</figref>. As seen in <figref idref="DRAWINGS">FIGS. 2 to 4</figref>, when the beacon period and the offset time are set based on the above-described points, after the offset time has passed, each of the transmission line estimation sections does not have the same timing as that of the commercial power supply cycle and slides therefrom. Therefore, it is possible to easily realize the transmission line estimation that does not overlap the commercial power supply cycle and that is continuous in time.</p>
<p id="p-0035" num="0034">Referring to <figref idref="DRAWINGS">FIG. 5</figref>, the procedure following which a transmission line is estimated by the communication apparatus <b>1</b> will be described in detail.</p>
<p id="p-0036" num="0035">At the initial starting up such as when the power is turned on, or upon detecting a change in the characteristics of a transmission line, a communication apparatus <b>1</b> serving as a slave unit (hereinafter, referred to as apparatus A) requests a communication apparatus <b>1</b> serving as a master unit (hereinafter, referred to as apparatus c) to allocate a time for estimating the transmission line (step <b>1</b>). When receiving the request to allocate a time for estimating the transmission line from the apparatus A, the apparatus C sends a beacon, to which information on time allocation for estimating the transmission line is added, during the next time of sending the beacon (step <b>2</b>). This information on the time allocation for estimating the transmission line refers to information showing sections that can be used for estimating the transmission line, and is typically given as the offset time from the starting time of the beacon period.</p>
<p id="p-0037" num="0036">When receiving the beacon, to which the information on time allocation for estimating the transmission line is added, from the apparatus c, the apparatus A measures the characteristics of the transmission line based on this information, after the offset time has passed since the beacon period started. In the example in <figref idref="DRAWINGS">FIG. 2</figref>, the characteristics of the transmission line are measured in a transmission line estimation section <b>2</b>/<b>3</b> (the half-tone portion <b>2</b> in the drawing). A specific method for measuring the characteristics of the transmission line is that the apparatus A sends a communication apparatus <b>1</b> serving as a slave unit of interest in the communications (hereinafter, referred to as apparatus B) a request to estimate the transmission line (step <b>3</b>), and receives a response, from the apparatus B, for the request to estimate the transmission line (step <b>4</b>). This estimation on the transmission line is, for example, performed in the following manner.</p>
<p id="p-0038" num="0037">First, a predetermined estimation series as well as the transmission line estimation request are sent from the apparatus A to the apparatus B. Based on this estimation series, the apparatus B calculates the receiving CNR (carrier to noise power ratio). Next, according to the calculated receiving CNR, the apparatus B creates a tonemap that specifies communication parameters such as a subcarrier to be used and a modulation method for each subcarrier. An example of the tonemap is shown in <figref idref="DRAWINGS">FIG. 6</figref>. Herein, the tonemap is constituted by the tonemap number for discriminating this tonemap from other tonemaps, the subcarrier number for identifying the subcarrier of interest in this tonemap, and information of use/non-use of the subcarrier and the modulation factor. The information on the modulation factor of the subcarrier may be information on the modulation type (16 QAM or 32 QAM, for example) or may be the number of bit allocation of the subcarrier (“4” in the case of 16 QAM, for example) shown in <figref idref="DRAWINGS">FIG. 6</figref>. Then, the apparatus B responds to the apparatus A by sending the transmission line estimation including the tonemap. It should be noted that the above-described multi-carrier transmission method is an example, and other methods such as a spread spectrum method also can be used. Furthermore, the information on the receiving CNR is used for determining the communication parameters but information other than this also can be used.</p>
<p id="p-0039" num="0038">With a similar process, the apparatus A measures the characteristics of the transmission line in the other transmission line estimation sections (steps 5 to 10). In the example in <figref idref="DRAWINGS">FIG. 2</figref>, the characteristics of the transmission line are measured in a transmission line estimation section <b>1</b>/<b>3</b> (the half-tone portion <b>1</b> in the drawing) and a transmission line estimation section <b>3</b>/<b>3</b> (the half-tone portion <b>3</b> in the drawing). With this process, the apparatus A completes the transmission line estimation in all of these three divided transmission line estimation sections, that is, acquisition of the tonemaps (step <b>11</b>). Then, among the plurality of acquired tonemaps, the apparatus A selects one tonemap that is optimal for use in the communications, and notifies the apparatus B of it (step <b>12</b>). With this process, the apparatuses A and B can share the optimal tonemap. Hereinafter, the communications are performed using this optimal tonemap.</p>
<p id="p-0040" num="0039">An optimal tonemap is selected, for example, in the following manner. In the example in <figref idref="DRAWINGS">FIG. 2</figref>, a noise is generated in the transmission line estimation sections <b>1</b>/<b>3</b> and <b>2</b>/<b>3</b>, and a noise is not generated in the transmission line estimation section <b>3</b>/<b>3</b> (see <figref idref="DRAWINGS">FIG. 7</figref> partially extracting and magnifying <figref idref="DRAWINGS">FIG. 2</figref>). Therefore, the tonemap of the transmission line estimation section <b>3</b>/<b>3</b> has the highest PHY rate. Accordingly, this tonemap with the highest PHY rate is selected as the tonemap used for the communications.</p>
<p id="p-0041" num="0040">Even without acquiring all of the tonemaps of the transmission line estimation sections, it is possible to select an optimal tonemap among tonemaps that have been acquired when a predetermined time-out period has passed.</p>
<p id="p-0042" num="0041">As described above, according to the communication apparatus <b>1</b> of the first embodiment of the present invention, it is possible to easily realize transmission line estimation in a distributed manner. Thus, the characteristics of the transmission line are estimated and evaluated with a high precision, and thus data can be sent and received at a high throughput.</p>
<p id="p-0043" num="0042">In the first embodiment, the integers n and m are described as fixed values, but they can be changed dynamically in accordance with, for example, a change in the transmission line based on the estimation result of the transmission line, the value of the PHY rate, or the degree of a variation of the PHY rate.</p>
<p id="p-0044" num="0043">Furthermore, in the communication sequence shown in <figref idref="DRAWINGS">FIG. 5</figref>, a relevant apparatus other than the apparatuses A, B, and C is not described, but the process is performed typically as shown in <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0045" num="0044">Referring to <figref idref="DRAWINGS">FIG. 8</figref>, information on time allocation for estimating the transmission line is added to a beacon sent from the apparatus c. The information on the time allocation for estimating the transmission line not only specifies, for the apparatus A, a time during which a request to estimate the transmission line can be sent to the apparatus B, but also prohibits the apparatuses B, C, and others from transferring data. By prohibiting apparatuses other than that sends the request from transmitting in a time during which the request to estimate the transmission line is sent (the half-tone period in <figref idref="DRAWINGS">FIG. 8</figref>), it is possible to avoid a collision, for example, between the request to estimate the transmission line and data.</p>
<p id="p-0046" num="0045">In a time during which a response to the request to estimate the transmission line is sent from the apparatus B to the apparatus A, data transfer by the apparatuses A, B, and others may be or may not be prohibited for the purpose of improving the throughput in the data transfer. <figref idref="DRAWINGS">FIG. 8</figref> is the communication sequence in which data transfer is not prohibited. Herein, when data transfer is not prohibited, it is preferable that the response from the apparatus B is given the highest priority.</p>
<p id="p-0047" num="0046">Furthermore, instead of a manner in which the receiver apparatus B responds to the transmitter apparatus A by sending the transmission line estimation at each time as described above, the plurality of transmission line estimations may be sent at one time, or the receiver apparatus B may select a tonemap based on the plurality of transmission line estimations and notify the transmitter apparatus A of the selected tonemap. In either case, the effect of the present invention is not lost.</p>
<heading id="h-0007" level="1">Second Embodiment</heading>
<p id="p-0048" num="0047">The first embodiment described above is a technique assuming that the variation cycle of the characteristics of the transmission line is known in advance. Then, in a second embodiment below, a technique will be described in which an optimal beacon period can be set automatically even when the variation cycle of the characteristics of the transmission line is not known in advance.</p>
<p id="p-0049" num="0048">For example, a case will be described in which the communication apparatus <b>1</b> can set both of a beacon period T<b>1</b> (<figref idref="DRAWINGS">FIG. 9</figref>) when the variation cycle L of the characteristics of the transmission line, which is synchronized with a commercial power supply frequency of 60 Hz, is 8.333 msec and when the integers n=3 and m=17, and a beacon period T<b>2</b> (<figref idref="DRAWINGS">FIG. 10</figref>) when the variation cycle L of the characteristics of the transmission line, which is synchronized with a commercial power supply frequency of 50 Hz, is 10 msec and when the variables n=3 and m=17. In this case, the communication apparatus <b>1</b> estimates the transmission line in all of the identical sections within a beacon period and acquires a plurality of tonemaps. <figref idref="DRAWINGS">FIGS. 9 and 10</figref> show a case of the transmission line estimation section <b>2</b> (the half-tone portions in the drawings). The offset time is given based on “L×k/n” (k is a real number that satisfies 0≦k&lt;m), and k=16 in <figref idref="DRAWINGS">FIGS. 9 and 10</figref>.</p>
<p id="p-0050" num="0049">Herein, it is assumed that the actual commercial power supply frequency is 60 Hz.</p>
<p id="p-0051" num="0050">As a result, the variation cycle L of the characteristics of the transmission line in the beacon period T<b>1</b> is synchronized more with a noise that is synchronized with the actual commercial power supply frequency (60 Hz) in the drawing (<figref idref="DRAWINGS">FIG. 9</figref>). Thus, the characteristics of the transmission line at the transmission line estimation sections <b>2</b> are substantially the same, and a similar value for the communication parameter (PHY rate) of each tonemap can be obtained in the plurality of acquired tonemaps, so that it is determined that the correlation, regarding a noise, between the beacon period T<b>1</b> and the variation cycle L is high.</p>
<p id="p-0052" num="0051">On the other hand, the variation cycle L of the characteristics of the transmission line in the beacon period T<b>2</b> is not synchronized with a noise that is synchronized with the actual commercial power supply frequency (60 Hz) in the drawing (<figref idref="DRAWINGS">FIG. 10</figref>). Thus, the characteristics of the transmission line at the transmission line estimation sections <b>2</b> are different from each other, and the communication parameter (PHY rate) of each tonemap is different for each of the plurality of acquired tonemaps. Therefore, it is determined that the correlation, regarding a noise, between the beacon period T<b>2</b> and the variation cycle L is low.</p>
<p id="p-0053" num="0052">Based on the above-described points, it is determined that the settings of a beacon period determined to have the highest correlation is synchronized most with a noise that is actually being generated. Accordingly, only by selecting the settings of the beacon period with which the correlation is high, it is possible to automatically set a beacon period that corresponds to the variation cycle of the characteristics of the transmission line.</p>
<p id="p-0054" num="0053">An optimal communication parameter that is noise-resistant is selected by setting the beacon period according to the second embodiment and then by performing the process according to the first embodiment.</p>
<p id="p-0055" num="0054">The above-described embodiments can be realized also when a CPU executes a program that can let the CPU execute the above-described procedure stored in a storage device (ROM, RAM, or hard disk, for example). In this case, the program may be executed after being stored in the storage device via a storage medium, or may be executed directly on the storage medium. The storage medium here includes a semiconductor memory such as a ROM, a RAM, and a flash memory, a magnetic disk memory such as a flexible disk and a hard disk, an optical disk such as a CD-ROM, a DVD, and a BD, and a memory card. Furthermore, the concept of the storage medium also includes a communication medium such as a telephone line and a carrier line.</p>
<p id="p-0056" num="0055">Each of the functional blocks indicated by the broken line in <figref idref="DRAWINGS">FIG. 1</figref> may be realized by an LSI, which is an integrated circuit. Each of the functional blocks may be formed on a single chip one by one, or a part or all of them may be formed on one chip. Although an LSI is used in these embodiments, this circuit may be called IC, system LSI, super LSI, or ultra LSI, depending on the difference of the degree of integration.</p>
<p id="p-0057" num="0056">It should be noted that the method for forming an integrated circuit is not limited to using an LSI, and a circuit integration maybe realized by a dedicated circuit or a general purpose processor Furthermore, it is possible to use an FPGA (field programmable gate array) that can be programmed after an LSI is produced, and a reconfigurable processor being capable of reconfiguring connections and settings of circuit cells inside of the LSI.</p>
<p id="p-0058" num="0057">Moreover, if circuit integration technology that replaces an LSI appears due to the development of semiconductor technology or derived another technology, it is natural that the functional blocks may be integrated by using that technology. There is a possibility of, for example, application of biotechnology.</p>
<p id="p-0059" num="0058">Hereinafter, an example will be described in which the present invention that has been described in the embodiments is applied to an actual network system. <figref idref="DRAWINGS">FIG. 11</figref> is a diagram showing an example of a network system in which the present invention is applied to high-speed power line transmission. In <figref idref="DRAWINGS">FIG. 11</figref>, an IEEE1394 interface, a USB interface, or so forth provided in multimedia equipment such as a personal computer, a DVD recorder, a digital TV, and a home server system is connected to a power line via an adaptor provided with the function of the present invention. With this configuration, it is possible to construct a network system in which digital data such as multimedia data can be transmitted at a high speed via a power line serving as a medium. In contrast to a conventional wired LAN, this system does not require a network cable to be newly installed and can use a power line having been installed already at home, office, or so forth without any process as a network line, so that a significant convenience in terms of cost and simplicity of installation is provided.</p>
<p id="p-0060" num="0059">The above-described embodiment is an example in which existing multimedia equipment is applied to power line communications via an adaptor converting a signal interface of the existing equipment to an interface of the power line communications. In future, however, the function of the present invention is included in multimedia equipment, so that it becomes possible to transmit data between the equipment via power codes of the multimedia equipment. In this case there is no need for the adaptor, the IEEE1394 cable, or the USB cable shown in <figref idref="DRAWINGS">FIG. 11</figref>, and thus wiring is simplified. Furthermore, since connection to the Internet via a router or connection to a wireless/wired LAN using, for example, a hub is possible, so that it is possible to expand a LAN system using the high-speed power line transmission system of the present invention. Furthermore, in the power line transmission method, communication data runs via a power line. Therefore, in contrast to a wireless LAN, there is no problem that radio waves are intercepted, resulting in data leakage. The power line transmission method also has a security effect to protect data. Data running on the power line can be protected by IPsec in IP protocol, encoding the contents themselves, or other DRM methods, for example.</p>
<p id="p-0061" num="0060">As described above, by installing a QoS function including a copyright protection function by encoding the contents and the effect of the present invention (band allocation flexibly addressing improvement in throughput, increased retransmission, and variation in traffic), AV contents with a high quality can be transmitted via a power line.</p>
<heading id="h-0008" level="1">INDUSTRIAL APPLICABILITY</heading>
<p id="p-0062" num="0061">The communication apparatus and the transmission line estimation method of the present invention can be used, for example, in a communication system in which the characteristics of a transmission line vary at a certain cycle, and are particularly useful, for example, when the characteristics of the transmission line are required to be estimated and evaluated with a high precis ion so that data is sent and received at a high throughput.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A communication apparatus performing periodic communications with another communication apparatus via a transmission line, comprising:
<claim-text>a communication control portion operable to set a communication period to L×m/n to perform communications, wherein L is a variation cycle of characteristics of a transmission line, n is an integer that is 2 or larger, and m is an integer that is greater than or equal to n and whose greatest common measure with n is 1,</claim-text>
<claim-text>a transmission line estimation portion operable to estimate the characteristics of the transmission line within a time L/n after a certain offset time has passed since the communication period started, and</claim-text>
<claim-text>a communication parameter determination portion operable to determine a communication parameter to be used by the communication control portion, based on a result of estimation by the transmission line estimation portion.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The communication apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the offset time is L×k/n, and k is a real number that satisfies 0≦k&lt;m.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The communication apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the transmission line estimation portion estimates the characteristics of the transmission line at least n times.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The communication apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the transmission line estimation portion estimates the characteristics of the transmission line at an initial starting up of the communication apparatus or upon a detection of a change in a state of the transmission line.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The communication apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the communication period is a period of beacons sent from a communication apparatus serving as a master unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The communication apparatus according to <claim-ref idref="CLM-00005">claim 5</claim-ref>,
<claim-text>wherein the communication control portion is operable to send a request to allocate a time for estimating the characteristics of the transmission line to the communication apparatus serving as the master unit.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The communication apparatus according to <claim-ref idref="CLM-00006">claim 6</claim-ref>,
<claim-text>wherein the communication control portion is operable to notify another communication apparatus of an allocation of a time for estimating the characteristics of the transmission line using a beacon frame or a polling frame, and the transmission line estimation portion is operable to estimate the characteristics of the transmission line only when permission is given.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The communication apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the variation cycle L of the characteristics of the transmission line is a half cycle of a commercial power supply cycle.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A transmission line estimation method executed by a communication apparatus performing periodic communications with another communication apparatus via a transmission line, comprising:
<claim-text>setting a communication period to L×m/n to perform communications, wherein L is a variation cycle of characteristics of a transmission line, n is an integer that is 2 or larger, and m is an integer that is greater than or equal to n and whose greatest common measure with n is 1,</claim-text>
<claim-text>estimating the characteristics of the transmission line within a time L/n after a certain offset time has passed since the communication period started, and</claim-text>
<claim-text>determining a communication parameter to be used in the communications, based on a result of said estimating.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. An integrated circuit used for a communication apparatus performing periodic communications with another communication apparatus via a transmission line,
<claim-text>wherein circuits are integrated that function as:
<claim-text>a communication control portion operable to set a communication period to L×m/n to perform communications, wherein L is a variation cycle of characteristics of a transmission line, n is an integer that is 2 or larger, and m is an integer that is greater than or equal to n and whose greatest common measure with n is 1,</claim-text>
<claim-text>a transmission line estimation portion operable to estimate the characteristics of the transmission line within a time L/n after a certain offset time has passed since the communication period started, and</claim-text>
<claim-text>a communication parameter determination portion operable to determine a communication parameter to be used by the communication control portion, based on a result of estimation by the transmission line estimation portion.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A beacon period determination method executed by a communication apparatus performing periodical communications with another communication apparatus via a transmission line, comprising:
<claim-text>determining an offset time based on one section among a plurality of sections which is obtained by dividing a variation cycle, and</claim-text>
<claim-text>setting a beacon period that is synchronized with a power supply cycle, based on the offset time.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The beacon period determination method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising estimating, based on the offset time, characteristics of the transmission line that is synchronized with the power supply cycle.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The beacon period determination method according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, further comprising:
<claim-text>estimating, based on the offset time, characteristics of the transmission line;</claim-text>
<claim-text>determining a correlation, regarding a noise, between the beacon period and the variation cycle, based on a tonemap obtained from a result of estimation in the estimating step; and</claim-text>
<claim-text>setting a beacon period that is determined to have high correlation.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
