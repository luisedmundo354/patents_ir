<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298384-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298384</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10341423</doc-number>
<date>20030114</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2002-012795</doc-number>
<date>20020122</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>1075</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>09</class>
<subclass>G</subclass>
<main-group>5</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>345633</main-classification>
<further-classification>345619</further-classification>
<further-classification>345632</further-classification>
</classification-national>
<invention-title id="d0e71">Mixed reality presenting apparatus and image processing method</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5252141</doc-number>
<kind>A</kind>
<name>Inoue et al.</name>
<date>19931000</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>136251</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5279679</doc-number>
<kind>A</kind>
<name>Murakami et al.</name>
<date>19940100</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>136246</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5673082</doc-number>
<kind>A</kind>
<name>Wells et al.</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348139</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5815411</doc-number>
<kind>A</kind>
<name>Ellenby et al.</name>
<date>19980900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702150</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6239915</doc-number>
<kind>B1</kind>
<name>Takagi et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>359629</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>7119831</doc-number>
<kind>B2</kind>
<name>Ohto et al.</name>
<date>20061000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>348135</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2002/0057280</doc-number>
<kind>A1</kind>
<name>Anabuki et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>345633</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>2002/0095265</doc-number>
<kind>A1</kind>
<name>Satoh et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>702 94</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00009">
<othercit>Azuma et al., Improving Static and Dynamic Registration in an Optical See-through HMD, ACM SIGGRAPH, 1994, pp. 197-204 and Appendices A-F.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Azuma, A Survey of Augmented Reality, In Presence: Teleoperatos and Virtual Environments Aug. 6, 1997, pp. 1-48.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Ryugo Kijima, et al., “-ReflexHMD- Development of HMD having Vestibule Reflecting Function”, TVRSJ, vol. 6, No. 2, pp. 107-114 (2001).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>345629</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345633</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>9</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20030137524</doc-number>
<kind>A1</kind>
<date>20030724</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Anabuki</last-name>
<first-name>Mahoro</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yamamoto</last-name>
<first-name>Hiroyuki</first-name>
<address>
<city>Kanagawa</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Fitzpatrick, Cella, Harper &amp; Scinto</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Canon Kabushiki Kaisha</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Tung</last-name>
<first-name>Kee M.</first-name>
<department>2628</department>
</primary-examiner>
<assistant-examiner>
<last-name>Good-Johnson</last-name>
<first-name>Motilewa</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A mixed reality presenting apparatus for merging an incident real-space image and a generated virtual-space image comprises a measuring section which measures the orientation of a unit for entering the real-space image and the speed or acceleration thereof; a virtual-space image generating section which generates virtual-space image data on the basis of the measurement result; a correcting optical system which corrects the path of light passing therethrough; and a correcting optical system control section which controls the correcting optical system on the basis of the measured speed or acceleration.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="80.77mm" wi="110.83mm" file="US07298384-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="104.39mm" wi="111.00mm" file="US07298384-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="115.65mm" wi="111.93mm" file="US07298384-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="237.74mm" wi="153.75mm" orientation="landscape" file="US07298384-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="218.27mm" wi="177.63mm" file="US07298384-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="117.94mm" wi="130.81mm" file="US07298384-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="234.10mm" wi="162.39mm" orientation="landscape" file="US07298384-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="113.79mm" wi="142.92mm" file="US07298384-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="240.96mm" wi="151.21mm" orientation="landscape" file="US07298384-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="235.63mm" wi="129.03mm" file="US07298384-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to prevention of registration error of a real-space image and a virtual-space image, which is caused when combining the virtual-space image with the real-space image.</p>
<p id="p-0004" num="0003">2. Description of the Related Art</p>
<p id="p-0005" num="0004">Recently, studies on mixed reality (hereinafter abbreviated as “MR”) carried out to achieve seamless mixture of a real space and a virtual space are more active than ever.</p>
<p id="p-0006" num="0005">The aim of MR is to achieve coexistence of a virtual-reality (hereinafter abbreviated as “VR”) world, which is conventionally capable of being experienced in circumstances separated from the real space, and the real space. MR has attracted attention as a technique for improving VR.</p>
<p id="p-0007" num="0006">Expected applications of MR include new areas quite different in quality from those of conventional VR, such as medical assisting applications, in which a view of the inside of a body is presented to a physician, and work assisting applications in which an assembly procedure for a product overlaid on an actual article in a factory.</p>
<p id="p-0008" num="0007">A common requirement for these application is a technique for eliminating a “registration error” of the real space and the virtual space. One registration error is a dynamic registration error caused by a time lag produced between a displacement of an MR presenting apparatus and reflection of that displacement in the display of the virtual-space image. Elimination of this registration error (hereinafter referred to as a “dynamic registration error”) is a problem to be solved by the present invention. This will be described in detail.</p>
<p id="p-0009" num="0008">The MR presenting apparatus measures the position and orientation of a viewpoint for observation of the real space, generates virtual-space image data on the basis of the measurement result, merging a virtual-space image formed by visualizing the generated data and a real-space scene, and displays the merged image. In this method, known as “optical see-through”, the merging is accomplished by means of an optical system such as a half mirror. <figref idref="DRAWINGS">FIG. 1</figref> illustrates this configuration. It takes time to go through the process from measuring of the position and orientation of the viewpoint to displaying the virtual-space image. When the viewpoint of the observer moves, therefore, the position and orientation of the viewpoint upon looking at the real-space scene would differ from the position and orientation of the observer's viewpoint measured upon generating data for the virtual-space image to be merged with the scene. Merging the real-space scene and the virtual-space image, which have viewpoints with different positions and orientations from each other, produces a registration error of the two images. This is the “dynamic registration error”. <figref idref="DRAWINGS">FIG. 2</figref> illustrates the occurrence of such a registration error.</p>
<p id="p-0010" num="0009">Efforts have been made to eliminate the registration error described above.</p>
<p id="p-0011" num="0010">For example, there is proposed a method for eliminating the “dynamic registration error” of a real-space and a virtual space by moving the display area of a virtual space image in line with movement of the apparatus. The paper “—ReflexHMD—Development of HMD having Vestibule Reflecting Function” (Ryugo KIJIMA, et al., TVRSJ, Vol. 6, No. 2, pp. 107-114, 2001) discloses a method of preparing in-advance virtual-space image data for an area larger than the HMD field of view, cutting an area corresponding to a real-space image based on measured data of the rotation angular velocity data of the HMD as measured by a gyro-sensor from the thus prepared data, displaying the cut area, and merging the same with the real-space scene. This method is effective for eliminating a “dynamic registration error”.</p>
<p id="p-0012" num="0011">However, the above-mentioned method causes a problem in that it requires a lot of time for processing because of the necessity to generate virtual space image data for an area larger than the field of view. For merging a real space and a virtual space, a process known as “video see-through” is known. This process includes electrically merging, in a merging apparatus such as a computer, a virtual-space image with a real-space image captured in real-time by means of a camera or the like. The above-mentioned method is not applicable to this process, however.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0013" num="0012">The present invention was developed in view of the circumstances described above, and has as an object to the elimination of a registration error caused by a time lag produced before reflection of the movement of a mixed reality presenting apparatus, which merges a virtual-space image with a real-space imaged captured in real-time, in the display of the virtual-space image.</p>
<p id="p-0014" num="0013">To achieve the aforementioned object, the present invention features the following configurations.</p>
<p id="p-0015" num="0014">A first aspect of the invention provides a mixed reality presenting apparatus for merging an incident real-space image and a generated virtual-space image, comprising a measuring section which measures the orientation of a unit for inputting the real-space image and the speed or acceleration thereof; a virtual-space image generating section which generates virtual space image data on the basis of the measurement result, a corresponding optical system which corrects path of light passing therethrough; and a correcting optical system control section which controls the correcting optical system on the basis of the measured speed or acceleration.</p>
<p id="p-0016" num="0015">Another aspect of the present invention provides an image processing method comprising the steps of determining the orientation of an apparatus into which a real-space image and the speed or acceleration thereof; generating virtual space image data on the basis of the measurement result; and merging the real-space image incident in real-time and the generated virtual space image, and inhibiting a registration error of the incident real-space image and the generated virtual-space image caused by a time lag in generating the virtual space image by controlling a correcting optical system which corrects the path of light passing therethrough on the basis of the measured speed or acceleration.</p>
<p id="p-0017" num="0016">Still another aspect of the present invention provides a mixed reality presenting apparatus for merging an incident real-space image and a generated virtual-space image, comprising a measuring section which measures the position of a viewpoint and the speed or acceleration for detecting the position of the incident real-space image; a virtual space image generating section which generates the virtual space image in response to the measured position; a correcting optical system which corrects the path of a light passing therethrough; a control section which controls the correcting optical system in response to the measured speed or acceleration; and a merging section which merges the virtual-space image generated by the virtual space image generating section with the incident real-space image via the correcting optical system controlled by the control section.</p>
<p id="p-0018" num="0017">Other features and advantages of the present invention will be apparent from the following description taken in conjunction with the accompanying drawings, in which like reference characters designate the same or similar parts throughout the figures thereof.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 1</figref> illustrates the configuration of an optical see-through type MR presenting apparatus.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 2</figref> illustrates the configuration of a “dynamic registration error”.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustrating a schematic configuration of an MR presenting apparatus of a first embodiment of the present invention.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating the processing procedure of the first embodiment of the invention.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a configuration in which a “dynamic registration error” is eliminated by the first embodiment of the invention.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram illustrating a schematic configuration of an MR presenting apparatus of a second embodiment of the invention.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a configuration in which a “dynamic registration error” is eliminated by the second embodiment of the invention.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram illustrating a schematic configuration of an MR presenting apparatus of a third embodiment of the invention.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 9</figref> is a flowchart illustrating the processing procedure of the third embodiment of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0028" num="0027">Preferred embodiments of the present invention will now be described with reference to the attached drawings.</p>
<heading id="h-0005" level="1">First Embodiment</heading>
<p id="p-0029" num="0028">The first embodiment of the invention is an application of the invention to a telescopic MR presenting apparatus. The telescopic MR presenting apparatus, in which a telescope portion comprises an MR presenting apparatus, is for enabling a user of this apparatus (hereinafter referred to as an “observer”) to merge a virtual-space image with a real-space scene by looking through the MR presenting apparatus. The observer looks at an image formed by overlaying the virtual-space image on the real-space scene while moving the MR presenting apparatus.</p>
<p id="p-0030" num="0029">The MR presenting apparatus of the first embodiment of the invention is of the optical see-through type. <figref idref="DRAWINGS">FIG. 3</figref> is a block diagram illustrating a schematic configuration of the MR presenting apparatus of the first embodiment of the invention.</p>
<p id="p-0031" num="0030">Reference numeral <b>1</b> represents a first measuring section, comprising, for example, a magnetic sensor (formed of a magnetic transmitter fixed in the real space and a magnetic tracker attached to the MR presenting apparatus). The first measuring section <b>1</b> measures the position and orientation of the MR presenting apparatus in the real space and outputs the measured data to a virtual-space image generating section <b>2</b>. The first measuring section <b>1</b> may comprise a gyro-sensor or the like, to measure only the orientation of the MR presenting apparatus in the real space and output the measured data to the virtual-space image generating section <b>2</b>.</p>
<p id="p-0032" num="0031">Reference numeral <b>2</b> represents the virtual-space image generating section which comprises a computer or the like. The virtual-space image generating section <b>2</b> calculates position data and orientation data of the observer's viewpoint in the real space from the position data and the orientation data of the MR presenting apparatus received from the first measuring section <b>1</b>. For example, on the assumption that, when using the MR presenting apparatus, the observer looks into an eyepiece (not shown) of the telescope portion in the apparatus, the position and orientation of the eyepiece are deemed to be the position and orientation of the observer's viewpoint. In this case, the position data and the orientation data of the MR presenting apparatus measured by the measuring section <b>1</b> are converted by the virtual space image generating section <b>2</b> into position data and orientation data of the eyepiece, and the result of the conversion is treated thereafter as position data and orientation data of the observer's viewpoint. Then, the virtual-space image generating section <b>2</b> generates virtual-space image data in response to the calculated position data and orientation data of the observer's viewpoint. When receiving only the posture data of the MR presenting apparatus from the first measuring section <b>1</b>, position data and orientation data of the observer's viewpoint in the real space are calculated from the predetermined position data of the MR presenting apparatus and the received orientation data, and virtual-space image data corresponding to these data is generated. These virtual-space data will be merged with a scene in the real space observed by means of the MR presenting apparatus, including, for example, character information explaining the scene being observed, or image data simulating a scene in which virtual buildings are formed in the scene opening out before the user. The generated image data are sent to the virtual-space image display section <b>3</b>.</p>
<p id="p-0033" num="0032">Reference numeral <b>3</b> represents a virtual-space image display section comprising a liquid crystal panel or the like. The virtual-space image display section <b>3</b> displays the virtual-space image data received from the virtual-space image generating section <b>2</b> in the form of an image. The light from the displayed image enters a combining optical system <b>7</b>.</p>
<p id="p-0034" num="0033">Reference numeral <b>4</b> represents a second measuring section comprising an acceleration sensor or a gyro-sensor. The second measuring section <b>4</b> measures the speed or acceleration of the MR presenting apparatus in the real space and outputs the measurement result to a correcting optical system control section <b>5</b>. When there is a combining optical system control section <b>8</b>, the result of measurement is also output thereto. The second measuring section <b>4</b> may measure the parallel displacement speed, or may measure the rotation angular velocity, or measure both. The second measuring section <b>4</b> may measure the parallel displacement acceleration, or may measure the rotation angular acceleration, or may measure both. The second measuring section <b>4</b> may be identical to the first measuring section. In this case, the measuring section which measures the position and posture of the MR presenting apparatus simultaneously measures the speed or the acceleration of the MR presenting apparatus. The structure of the MR presenting apparatus is simpler.</p>
<p id="p-0035" num="0034">Reference numeral <b>5</b> represents the correcting optical system control section comprising a microcomputer or the like. The correcting optical system control section <b>5</b> calculates an amount of control for the correcting optical system <b>6</b> from the speed data or the acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the correcting optical system <b>6</b> on the basis of the thus calculated value.</p>
<p id="p-0036" num="0035">Reference numeral <b>6</b> represents a correcting optical system comprising a variable angle prism or the like. The correcting optical system <b>6</b> causes refraction of the external light incident from the real space by deforming or moving in response to a control signal sent from the correcting optical system control section <b>5</b>.</p>
<p id="p-0037" num="0036">The second measuring section <b>4</b>, the correcting optical system control section <b>5</b> and the correcting optical system <b>6</b> are applications of a vibration isolator attached to a regular blur-correcting image capture apparatus.</p>
<p id="p-0038" num="0037">Reference numeral <b>7</b> represents the merging optical system comprising a half mirror or the like. The merging optical system <b>7</b> merges image light incident from the virtual-space image display section <b>3</b> and external light from the real space, which is incident through the correcting optical system <b>6</b>, and makes the resultant merged light fall on the observer's viewpoint. When there is a merging optical system control section <b>8</b>, it rotates or moves the combining optical system <b>7</b> to direct the merged light towards the observer's viewpoint on the basis of a control signal sent from the merging optical system control section <b>8</b>.</p>
<p id="p-0039" num="0038">Reference numeral <b>8</b> represents the synthesizing optical system control section comprising a microcomputer or the like. The merging optical system control section <b>8</b> calculates an amount of control for the merging optical system <b>6</b> from the speed data or acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the merging optical system <b>7</b> on the basis of the thus calculated value. The merging optical system control section <b>8</b> is not necessary for the present invention.</p>
<p id="p-0040" num="0039">Control of this embodiment having the above-mentioned configuration will now be described. <figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating the processing procedure in the first embodiment of the present invention.</p>
<p id="p-0041" num="0040">In step S<b>10</b>, the first measuring section <b>1</b> measures the position and orientation, or only the orientation, of the MR presenting apparatus, and calculates position data and posture data of the observer's viewpoint from the measured data. When only the orientation is measured is the previously stored position data used as the position data of the observer's viewpoint.</p>
<p id="p-0042" num="0041">In step S<b>11</b>, the virtual-space image generating section <b>2</b> receives the position data and the posture data of the observer's viewpoint from the first measuring section <b>1</b>, and generates virtual-space image data in response to the received data.</p>
<p id="p-0043" num="0042">In step S<b>20</b>, the second measuring section <b>4</b> measures the speed or acceleration of the MR presenting apparatus. The term “speed” as used herein means a parallel displacement speed, or an angular rotation speed, or both. The term “acceleration” as used herein means a parallel displacement acceleration, or an angular rotation acceleration, or both. For the parallel displacement speed and the parallel displacement acceleration, vertical components and horizontal components of the MR presenting apparatus are measured. For the angular rotation speed and the angular rotation acceleration, components around the vertical axis and around the horizontal axis of the MR presenting apparatus are measured.</p>
<p id="p-0044" num="0043">In step S<b>21</b>, the correcting optical system control section <b>5</b> calculates an amount of control for the correcting optical system <b>6</b> from the speed data and the acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal on the basis of the thus calculated value to the correcting optical system <b>6</b>. The amount of control for the correcting optical system <b>6</b> is determined so as to eliminate a “dynamic registration error” of a real-space scene and a virtual-space image at the observer's viewpoint. This will be described in detail in the following paragraphs.</p>
<p id="p-0045" num="0044">When the MR presenting apparatus is moving, it takes some time for this movement to be reflected in the virtual-space image data generated by the virtual-space image generating section <b>2</b>. This produces a registration error, as shown in <figref idref="DRAWINGS">FIG. 2</figref>, of the real-space scene and the virtual-space image at the observer's viewpoint. The correcting optical system <b>6</b> refracts the external light incident from the real space in the vertical and horizontal directions of the MR presenting apparatus so as to correct this registration error. If the refraction angle is correct, the “dynamic registration error” is eliminated, as shown in <figref idref="DRAWINGS">FIG. 5</figref>. The refraction angle depends upon the amount of change (amount of deformation or amount of displacement) of the correcting optical system <b>6</b>. The amount of change of the correcting optical system <b>6</b> is controlled by the correcting optical system control section <b>5</b>. The amount of control is determined in response to the speed or acceleration of the MR presenting apparatus measured by the second measuring section <b>4</b>. For example, when the second measuring section <b>4</b> measures the angular rotation speed of the MR presenting apparatus, the correcting optical system control section <b>5</b> determines an amount of control so that the real-space scene is displaced by amounts calculated from the following formulae (1) and (2) at the observer's viewpoint:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Rx=L×t</i>1×ω<i>x</i>  (1)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Ry=L×t</i>1×ω<i>y</i>  (2)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0045">Rx: Amount of displacement of the real-space scene in the horizontal direction of the MR presenting apparatus;</li>
    <li id="ul0001-0002" num="0046">Ry: Amount of displacement of the real-space scene in the vertical direction of the MR presenting apparatus;</li>
    <li id="ul0001-0003" num="0047">L: Distance between the rotation center of the MR presenting apparatus and the observer's viewpoint, previously assumed;</li>
    <li id="ul0001-0004" num="0048">ωx: Angular rotation speed around the vertical axis of the MR presenting apparatus;</li>
    <li id="ul0001-0005" num="0049">ωy: Angular rotation speed around the horizontal axis of the MR presenting apparatus;</li>
    <li id="ul0001-0006" num="0050">t<b>1</b>: Average time required from the moment of measurement of position and orientation of the MR presenting apparatus to the moment of display of the virtual-space image;
<br/>
and where t<b>1</b> is the sum of the time required from the start of measurement by the first measuring section to output of the measured data and the time required for generating the virtual-space image data by the virtual-space image generating section <b>2</b>. The former is intrinsic to the first measuring section, and is substantially constant. The latter varies somewhat depending on the generated virtual-space image data.
</li>
</ul>
</p>
<p id="p-0046" num="0051">Since L×t<b>1</b> is a constant in Formulae (1) and (2), calculation can be accomplished in a very short period of time. A “dynamic registration error” produced by the movement of the MR presenting apparatus during this processing is therefore substantially negligible. As a result, if the real-space scene moves by an amount derived from Formulae (1) and (2) from the observer's viewpoint, the “dynamic registration error” of the real-space scene and the virtual-space image can be eliminated.</p>
<p id="p-0047" num="0052">The actual time required from the measurement of position and orientation of the observer's viewpoint by the first measuring section <b>1</b> up to display of the virtual-space image differs from the average time. Strictly speaking, displacement by an amount obtained from Formulae (1) and (2) is insufficient to completely eliminate the “dynamic registration error” of the real-space scene and the virtual-space image. This problem can be solved by minimizing the difference between the actual time and the average time thereof required during the period from the moment when the first measuring section <b>1</b> measures position and orientation of the observer's viewpoint to the moment when the virtual-space image is displayed.</p>
<p id="p-0048" num="0053">An amount of control for the correcting optical system <b>6</b> has been determined from Formulae (1) and (2) in the above-mentioned case. Other formulae can however be used. For example, Formulae (1) and (2) may be used by defining t<b>1</b> as the “actual time required for the period from the moment of measurement of position and orientation of the MR presenting apparatus to the point in time when the virtual-space image is displayed. As a result, the “dynamic registration error” of the real-space scene and the virtual-space image can be completely eliminated.</p>
<p id="p-0049" num="0054">Formulae may be used in which ωx and ωy are expressed as ωx(t) and ωy(t), with the variable t representing time. Therefore “t<b>1</b>×ωx” in Formulae (1) and “t<b>1</b>×ωy” in Formula (2) should be replaced by “∫t<b>1</b>×ωx(t)” and “∫t<b>2</b>×ωy(t)”, respectively (the range of integration covers the period from measurement of the position and orientation of the MR presenting apparatus to the point in time when the virtual-space image is displayed, or the average time required during the period from measurement of the position and orientation of the MR presenting apparatus to the moment when the virtual-space image is displayed.</p>
<p id="p-0050" num="0055">In step S<b>22</b>, the correcting optical system control section <b>6</b> varies (is deformed or displaced) with a control signal received from the correcting optical system control section <b>5</b>. This change causes refraction of the external light incident from the real space.</p>
<p id="p-0051" num="0056">The variation of the correcting optical system <b>6</b> in step S<b>22</b> is an application of the anti-vibration technique applied to an image pickup device having a common blur-correcting function. For example, when the correcting optical system <b>6</b> comprises a variable angle prism, the prism apex angle is controlled in response to a control signal received from the correcting optical system control section <b>5</b>. When the correcting optical system <b>6</b> comprises a group of lenses whose refraction angle varies with the position at which the light passes through the correcting optical system <b>6</b>, the position of the correcting optical system <b>6</b> is controlled in response to a control signal received from the correcting optical system control section <b>5</b>.</p>
<p id="p-0052" num="0057">In step S<b>30</b>, the presence or absence of the merging optical system control section <b>8</b> is determined. In the absence of the combining optical system control section <b>8</b>, the process advances to step S<b>50</b>.</p>
<p id="p-0053" num="0058">Otherwise, in step S<b>40</b>, the combining optical system control section <b>8</b> calculates a value for the merging optical system <b>7</b> from speed data or acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the merging optical system <b>7</b> on the basis of the thus calculated value. Control of the merging optical system <b>7</b> is carried out so as to adjust the path of external light incident from the real space after passing through the correcting optical system <b>6</b>, and the image light incident from the virtual-space image display section <b>3</b> so that merged light of both is properly incident at the observer's viewpoint.</p>
<p id="p-0054" num="0059">In step S<b>41</b>, the merging optical system <b>7</b> changes (rotation or movement) in response to a control signal received from the merging optical system control section <b>8</b>.</p>
<p id="p-0055" num="0060">In step S<b>50</b>, the virtual-space image display section <b>3</b> displays the virtual space image data in the form of an image. The light from the displayed image enters the merging optical system <b>7</b>, and is projected towards the observer's viewpoint. Simultaneously, the external light, after entering from the real space and passed through the correcting optical system <b>6</b>, is also incident on the merging optical system <b>7</b> and projected towards the observer's viewpoint. The resultant change of the correcting optical system <b>6</b> eliminates the “dynamic registration error” of the real-space scene and the virtual space image at the observer's viewpoint.</p>
<p id="p-0056" num="0061">When the real-space scene and the virtual-space image are projected onto the observer's viewpoint, the real-space scene which should originally be incident perpendicularly to the observer's viewpoint is actually incident diagonally with respect to the observer's viewpoint because of the presence of the correcting optical system <b>6</b>, resulting in a distorted image. By extending the optical path from the correcting optical system <b>6</b> to the observer's viewpoint, the refraction angle of the external light of the real space to be corrected becomes smaller, so that distortion of the real-space scene becomes negligible.</p>
<p id="p-0057" num="0062">In step S<b>60</b>, it is checked whether or not operation of the apparatus is to be discontinued. Operation of the apparatus is discontinued by causing the system to terminate operation in step S<b>70</b>. When operation of the apparatus is not to be discontinued, the process goes back to step S<b>10</b> and the above-mentioned processing is repeated.</p>
<p id="p-0058" num="0063">The above-mentioned description of the first embodiment of the invention has covered a case where the invention is embodied as a telescope-type MR presenting apparatus. The apparatus of the invention may also be a head-mounted display type MR presenting apparatus.</p>
<heading id="h-0006" level="1">Second Embodiment</heading>
<p id="p-0059" num="0064">A second embodiment of the present invention will now be described. The second embodiment also covers an optical see-through type telescopic MR presenting apparatus. <figref idref="DRAWINGS">FIG. 6</figref> is a block diagram illustrating a schematic configuration of-the MR presenting apparatus in the second embodiment of the invention.</p>
<p id="p-0060" num="0065">The second embodiment has the same configuration as that of the first embodiment, except for different operations of part of the configuration. The same reference numerals as in the MR presenting apparatus of the first embodiment are assigned to corresponding components, and only components of different operations from the first embodiment will be described.</p>
<p id="p-0061" num="0066">Reference numeral <b>3</b> represents a virtual-space image display section which comprises a liquid crystal panel or the like. The virtual-space image display section <b>3</b> displays virtual-space image data received from the virtual space image generating section <b>2</b> in the form of an image. The light of this image is incident on the correcting optical system <b>6</b>.</p>
<p id="p-0062" num="0067">Reference numeral <b>6</b> represents the correcting optical system which comprises a variable angle prism or the like. The correcting optical system <b>6</b> causes refraction of the image light incident from the virtual space image display section <b>3</b> by deforming or moving in response to the control signal sent from the correcting optical system control section <b>5</b>.</p>
<p id="p-0063" num="0068">Reference numeral <b>7</b> represents a merging optical system which comprises a half mirror or the like. The merging optical system <b>7</b> merges the image light after passing through the correcting optical system <b>6</b> and incident from the virtual-space image display section <b>3</b> and the external light incident from the real space, and causes the resultant merged light to be incident on the observer's viewpoint. When a merging optical system control section <b>8</b> is provided, the merged light is made incident properly on the observer's viewpoint through rotation or movement on the basis of the control signal sent from the merging optical system control section <b>8</b>.</p>
<p id="p-0064" num="0069">Control of the second embodiment of the invention will now be described. The processing procedure in the second embodiment of the invention is quite the same as that in the first embodiment. Only portions different in processing details will be described. The reference numerals correspond to those shown in the flowchart illustrating the processing procedure in the first embodiment of the invention shown in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0065" num="0070">In step S<b>21</b>, the correcting optical system control section <b>5</b> calculates the amount of control for the correcting optical system <b>6</b> from the speed data or the acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the correcting optical system <b>6</b> on the basis of the calculated value. The amount of control for the correcting optical system <b>6</b> is determined so as to eliminate the “dynamic registration error” of the real-space scene and virtual-space image at the observer's viewpoint. This will be described further in detail.</p>
<p id="p-0066" num="0071">When the MR presenting apparatus is moving, it takes some time for this movement to be reflected in the virtual-space image data generated by the virtual-space image generating section <b>2</b>. As a result, a registration error, as shown in <figref idref="DRAWINGS">FIG. 2</figref>, of the real-space scene and the virtual-space image at the observer's viewpoint is produced. The correcting optical system <b>6</b> causes refraction of the path of the image light incident from the virtual-space image display section <b>3</b> in the vertical and the horizontal directions of the MR presenting apparatus. An appropriate refraction angle would eliminate the registration error as shown in <figref idref="DRAWINGS">FIG. 7</figref>. The refraction angle depends upon the amount of change (amount of deformation or amount of movement) of the correcting optical system <b>6</b>. The amount of change of the correcting optical system <b>6</b> is controlled by the correcting optical system control section <b>5</b>. The amount of control is determined in response to the speed or acceleration of the MR presenting apparatus measured by the second measuring section <b>4</b>. For example, when the second measuring section <b>4</b> measures the rotation angular speed of the MR presenting apparatus, the correcting optical system control section <b>5</b> determines an amount of control so that the virtual-space image at the observer's viewpoint moves by amounts calculated by the following Formulae (3) and (4):
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Vx=L×t</i>1×ω<i>x</i>  (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>Vy=L×t</i>1×ω<i>y</i>  (4)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where,
<ul id="ul0002" list-style="none">
    <li id="ul0002-0001" num="0072">Vx: Amount of displacement of the virtual-space image in the horizontal direction of the MR presenting apparatus;</li>
    <li id="ul0002-0002" num="0073">Vy: Amount of displacement of the virtual-space image in the vertical direction of the MR presenting apparatus;</li>
    <li id="ul0002-0003" num="0074">L: Distance between a previously assumed rotation center of the MR presenting apparatus and the observer's viewpoint;</li>
    <li id="ul0002-0004" num="0075">ωx: Angular rotation speed of the MR presenting apparatus around the vertical axis;</li>
    <li id="ul0002-0005" num="0076">ωy: Angular rotation speed of the MR presenting apparatus around the horizontal axis; and</li>
    <li id="ul0002-0006" num="0077">t<b>1</b>: Average time required from the moment when measuring the position and orientation of the MR presenting apparatus to the moment when displaying the virtual-space image; and as in the first embodiment, t<b>1</b> represents the sum of the time required from the start of measurement by the first measuring section up to output of the measurement data and the time required for the virtual space image generating section <b>2</b> to generate the virtual space image data.</li>
</ul>
</p>
<p id="p-0067" num="0078">In Formulae (3) and (4), L×t<b>1</b> is a constant. It is therefore possible to accomplish calculation of these Formulae in a very short period of time. Therefore, the “dynamic registration error” occurring as a result of movement of the MR presenting apparatus during this processing can substantially be disregarded. If the virtual space image moves by amounts available from Formulae (3) and (4) at the observer's viewpoint, the “dynamic registration error” of the real space scene and the virtual-space image would be eliminated.</p>
<p id="p-0068" num="0079">When there is a difference between an actual time and the average time required from the moment of measurement of the position and orientation of the observer's viewpoint by the first measuring section <b>1</b> to the moment of display of the virtual space image, the “dynamic registration error” of the real space scene and the virtual-space image cannot completely be eliminated with movement by an amount obtained from Formulae (3) and (4). This problem can be solved by minimizing the difference between the actual time and the average time required from the moment of measurement of the position and orientation of the observer's viewpoint by the first measuring section <b>1</b> through the moment of display of the virtual space image by configuring the virtual space image generating section <b>2</b> with a high-performance equipment.</p>
<p id="p-0069" num="0080">While an amount of control for the correcting optical system <b>6</b> is determined by use of Formulae (3) and (4) in this case, other formulae may be used. For example, the formulae may assume that t<b>1</b> in Formulae (3) and (4) is “an actual time required from the moment of measurement of the position and orientation of the MR presenting apparatus to the moment of display of the virtual-space image”. The “dynamic registration error” of the real-space scene and the virtual-space image is thus completely eliminated.</p>
<p id="p-0070" num="0081">In other applicable formulae, ωx and ωy may be expressed by means of ωx(t) and ωy(t) and the variable t representing the time on the basis of integral values of speeds ωx and ωy and a predicted value by a Kalman filter, and “t<b>1</b>×ωx” in Formula (3) and “t<b>1</b>×ωy” in Formula (4) are replaced by “∫t×ωx(t)” and “∫t×ωy(t)”, respectively (the range of integration covers the time from the moment of measurement of the position and orientation of the MR presenting apparatus to the moment of display of the virtual-space image, or the average time required from the moment of measurement of the position and orientation of the MR presenting apparatus to the moment of display of the virtual space image).</p>
<p id="p-0071" num="0082">In step S<b>22</b>, the correcting optical system <b>6</b> changes (is deformed or moved) in response to a control signal received from the correcting optical system control section <b>5</b>. This change causes refraction of the image light incident from the virtual space image display section <b>3</b>.</p>
<p id="p-0072" num="0083">In step S<b>40</b>, the merging optical system control section <b>8</b> calculates an amount of control for the merging optical system <b>7</b> from the speed data or the acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the merging optical system <b>7</b> on the basis of the thus calculated value. The merging optical system <b>7</b> is controlled so that the paths of the external light incident from the real space and the image light incident from the virtual space image display section <b>3</b> after passing through the correcting optical system <b>6</b> are adjusted, and a merged light of the both is incident properly on the observer's viewpoint.</p>
<p id="p-0073" num="0084">In step S<b>50</b>, the virtual-space image display section <b>3</b> displays the virtual-space image data in the form of an image. The thus displayed image light is incident on the correcting optical system <b>6</b>, passes through the merging optical system <b>7</b>, and is projected onto the observer's viewpoint. Simultaneously, the external light from the real space is also incident on the merging optical system <b>7</b>, and projected onto the observer's viewpoint. The change of the correcting optical system <b>6</b> eliminates the “dynamic registration error” of the real space scene and the virtual-space image at the observer's viewpoint.</p>
<p id="p-0074" num="0085">When the real space scene and the virtual-space image are projected onto the observer's viewpoint, the virtual-space image which should originally be incident perpendicularly on the observer's viewpoint is diagonally incident on the observer's viewpoint, resulting in a distorted image. A longer optical path between the correcting optical system <b>6</b> and the observer's viewpoint permits minimization of the refraction angle of the virtual-space image necessary for correction, and the distortion of the virtual-space image can be disregarded.</p>
<p id="p-0075" num="0086">The above-mentioned second embodiment has covered a case where the invention is embodied as a telescopic MR presenting apparatus. The invention may also be embodied in the form of a head-mounted type MR presenting apparatus (head-mounted display).</p>
<p id="p-0076" num="0087">There is conceivable an embodiment worked out by combining the first embodiment and the second embodiment. More specifically, correction of the “dynamic registration error” may be achieved by providing two correcting optical systems, causing refraction of the external light incident from the real space, and causing refraction of the image light incident from the virtual-space image display section <b>3</b>.</p>
<heading id="h-0007" level="1">Third Embodiment</heading>
<p id="p-0077" num="0088">A third embodiment of the present invention will now be described. The third embodiment covers a video see-through type telescopic MR presenting apparatus. <figref idref="DRAWINGS">FIG. 8</figref> is a block diagram illustrating a schematic configuration of the MR presenting apparatus of the third embodiment of the invention. The third embodiment is substantially the same as the first embodiment except that the configuration achieving the MR presentation based on the optical see-through process is replaced by a configuration achieving an MR presentation based on the video see-through process. The same components as in the MR presenting apparatus of the first embodiment are assigned the same reference numerals.</p>
<p id="p-0078" num="0089">Reference numeral <b>1</b> represents a first measuring section which comprises a magnetic sensor (a magnetic transmitter fixed in the real space and a magnetic tracker attached to the MR presenting apparatus or the like). The first measuring section <b>1</b> measures the position and orientation of the viewpoint of the real-space image pickup section <b>9</b> in the real space, and outputs the measured data to a virtual-space image generating section <b>2</b>. The first measuring section <b>1</b> comprises a gyrosensor or the like, may measure only the orientation of the real-space image pickup section <b>9</b> in the real space and output the measured data to the virtual-space image generating section <b>2</b>.</p>
<p id="p-0079" num="0090">Reference numeral <b>2</b> represents the virtual-space image generating section which comprises a computer or the like. The virtual space image generating section <b>2</b> receives position data and orientation data of the viewpoint of the real-space image pickup section <b>9</b> from the first measuring section <b>1</b>, and generates, from these data, virtual-space image data in response to these data. When receiving only the orientation data of the viewpoint of the real space image pickup section <b>9</b> from the first measuring section <b>1</b>, the virtual-space image generating section <b>2</b> generates, from the position data of the predetermined viewpoint of the real-space image pickup section <b>9</b> and the received orientation data, corresponding virtual-space image data. This virtual-space image data is for merging with real-space image data which is picked up by the real-space image pickup section <b>9</b> and incorporated by a real-space image incorporating section <b>10</b>, and may include character information for explaining a scene currently in sight, or may be image data simulating a state of the scene in sight in which virtual buildings are built. The generated image data are sent to an image merging section <b>11</b>.</p>
<p id="p-0080" num="0091">Reference numeral <b>4</b> represents a second measuring section which comprises an acceleration sensor or a gyrosensor. The second measuring section <b>4</b> measures the speed or acceleration of the MR presenting apparatus in a real space, and outputs the measurement result to the correcting optical system control section <b>5</b>. The second measuring section <b>4</b> may be one which measures the parallel displacement speed, or one which measures the angular rotation speed, or one which measures both. The second measuring section <b>4</b> may be one which measures the parallel displacement acceleration, or one which measures the rotation angular acceleration, or one which measures both. The second measuring section <b>4</b> may be identical with the first measuring section <b>1</b>. In this case, the measuring section which measures the position and orientation of the MR presenting apparatus simultaneously measures also the speed or acceleration of the MR presenting apparatus. The MR presenting apparatus has a simpler construction.</p>
<p id="p-0081" num="0092">Reference numeral <b>5</b> represents the correcting optical system control section which comprises a microcomputer or the like. The correcting optical system control section <b>5</b> calculates an amount of control for the correcting optical system <b>6</b> from the speed data or the acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the correcting optical system <b>6</b> on the basis of the thus calculated value.</p>
<p id="p-0082" num="0093">Reference numeral <b>6</b> represents the correcting optical system which comprises a variable angle prism or the like. The correcting optical system <b>6</b> causes refraction of an external light incident from the real space by deforming or moving in response to a control signal sent from the correcting optical system control section <b>5</b>.</p>
<p id="p-0083" num="0094">The second measuring section <b>4</b>, the correcting optical system control section <b>5</b>, and the correcting optical system <b>6</b> are applications of a vibration-proof technique as applied to an image capture apparatus having a regular blur-correcting function.</p>
<p id="p-0084" num="0095">Reference numeral <b>9</b> represents the real space image pickup section which comprises a camera or the like. The real space image pickup section <b>9</b> captures a real-space such as an outdoor landscape, and outputs the image thus captures as real-space image data to the real-space image incorporating section <b>10</b>.</p>
<p id="p-0085" num="0096">Reference numeral <b>10</b> represents the real-space image incorporating section which comprises a video capture card or the like. The real-space image incorporating section <b>10</b> converts the real-space image data sent from the real-space image pickup section <b>9</b> into a form suitable for an image merging section <b>11</b>, and outputs the result of conversion to the image combining section <b>11</b>.</p>
<p id="p-0086" num="0097">Reference numeral <b>11</b> represents the image merging section which comprises a computer or the like. The image merging section <b>11</b> merges the virtual-space image data sent from the virtual-space image generating section <b>2</b> with the real-space image data sent from the real-space image incorporating section <b>10</b>, and outputs the merged image data to a merged image display section <b>12</b>.</p>
<p id="p-0087" num="0098">Reference numeral <b>12</b> represents the merged image display section which comprises a liquid crystal display or the like. The merged image display section <b>12</b> displays merged image data sent from the image merging section <b>11</b>. The light of this display is incident at the observer's viewpoint.</p>
<p id="p-0088" num="0099">Control of this embodiment having the above-mentioned configuration will now be described. <figref idref="DRAWINGS">FIG. 9</figref> is a flowchart illustrating the processing procedure in the third embodiment of the invention.</p>
<p id="p-0089" num="0100">In step S<b>100</b>, the first measuring section <b>1</b> measures the position and orientation of the viewpoint of the real-space image pickup section <b>9</b>, or only the orientation thereof. When only the orientation is measured, previously retained position data is used as a position data for the real-space image pickup section <b>9</b>.</p>
<p id="p-0090" num="0101">In step S<b>110</b>, the virtual-space image generating section <b>2</b> receives the position data and the orientation data of the viewpoint of the real-space image pickup section <b>9</b>, and generates virtual-space image data in response to these data.</p>
<p id="p-0091" num="0102">In step S<b>200</b>, the second measuring section <b>4</b> measures the speed or acceleration of the MR presenting apparatus. The term speed as herein used shall mean a parallel moving speed, or a angular rotation speed, or both. The term acceleration as herein used shall mean a parallel moving acceleration, or an angular rotation acceleration, or both. The parallel moving speed and the parallel moving acceleration are determined by measuring vertical-direction and horizontal-direction components of the MR presenting apparatus. In determining the angular rotation speed and the angular rotation acceleration, the components around the vertical axis and around the horizontal axis of the MR presenting apparatus are measured.</p>
<p id="p-0092" num="0103">In step S<b>210</b>, the correcting optical system control section <b>5</b> calculates the amount of control for the correcting optical system <b>6</b> from the speed data or the acceleration data of the MR presenting apparatus received from the second measuring section <b>4</b>, and sends a control signal to the correcting optical system <b>6</b> on the basis of the thus calculated value. The amount of control for the correcting optical system <b>6</b> is determined so as to eliminate the “dynamic registration error” occurring when merging the real-space image data output by the real-space image incorporating section <b>10</b> with the virtual-space image data output by the virtual-space image generating section <b>2</b>. This will be described further in detail.</p>
<p id="p-0093" num="0104">When the MR presenting apparatus is moving, if the timing of shooting of the real space by the real-space image pickup section <b>9</b> and the timing of measuring the position and orientation of the real-space image pickup section <b>9</b> by the first measuring section <b>1</b> are not combined, a “dynamic registration error” of the real-space image and the virtual-space image is produced. The correcting optical system <b>6</b> causes refraction of the path of the external light incident from the real space on the real-space image pickup section <b>9</b> in the vertical and horizontal directions of the MR presenting apparatus so as to eliminate this registration error. An appropriate refraction angle ensures elimination of the “dynamic registration error”. The refraction angle depends upon the amount of change (amount of deformation or amount of displacement) of the correcting optical system <b>6</b>. The amount of change of the correcting optical system <b>6</b> is controlled by the correcting optical system control section <b>5</b>. The amount of control is determined in response to the speed or acceleration of the MR presenting apparatus measured by the second measuring section <b>4</b>. For example, when the second measuring section <b>4</b> measures the angular rotation speed of the MR presenting apparatus, the correcting optical system control section <b>5</b> determines an amount of control so that the real-space scene moves by amounts derived from the following formulae (5) and (6) on the plane of incidence on the real-space image pickup section <b>9</b>:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R′x=L×t</i>2<i>×ωx</i>  (5)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R′y=L×t</i>2<i>×ωy</i>  (6)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where,
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0105">R′x: Amount of displacement of the real-space scene in the horizontal direction of the MR presenting apparatus;</li>
    <li id="ul0003-0002" num="0106">R′y: Amount of displacement of the real-space scene in the vertical direction of the MR presenting apparatus;</li>
    <li id="ul0003-0003" num="0107">L: Distance between a previously assumed rotation center of the MR presenting apparatus and the real-space image pickup section <b>9</b>;</li>
    <li id="ul0003-0004" num="0108">ωx: Angular rotation speed around the vertical axis of the MR presenting apparatus;</li>
    <li id="ul0003-0005" num="0109">ωy: Angular rotation speed around the horizontal axis of the MR presenting apparatus; and</li>
    <li id="ul0003-0006" num="0110">t<b>2</b>: Time difference between the moment of measurement of the position and orientation (or only the orientation) of the real-space image pickup section <b>9</b> and the moment of shooting a real-space image by the real-space image pickup section <b>9</b>.
<br/>
Since L×t<b>2</b> is a constant in Formulae (5) and (6), calculation can be accomplished in a very short period of time. The “dynamic registration error” produced along with movement of the MR presenting apparatus during this processing can therefore be substantially disregarded. As a result, the “dynamic registration error” of the real-space image and the virtual-space image can be eliminated by moving the real-space scene by amounts derived from Formulae (5) and (6) on the plane of incidence on the real-space image pickup section <b>9</b>.
</li>
</ul>
</p>
<p id="p-0094" num="0111">The amount of control for the correcting optical system <b>6</b> is determined in the above-mentioned case by use of Formulae (5) and (6). Other formulae are however applicable. For example, in other applicable formulae, ωx and ωy may be expressed by means of ωx(t) and ωy(t) and a variable t representing the time on the basis of integral values of speeds ωx and ωy and a predicted value by a Kalman filter, and “t<b>2</b>×ωx” in Formula (5) and “t<b>2</b>×ωy” in Formula (6) are replaced by “∫t×ωx(t)” and “∫t×ωy(t)”, respectively (the range of integration covers the period between the moment of measurement of the position and orientation (or only the orientation) of the real-space image pickup section <b>9</b> and the moment of shooting of the real-space image by the real-space image pickup section <b>9</b>).</p>
<p id="p-0095" num="0112">In step S<b>220</b>, the correcting optical system <b>6</b> changes (is deformed or moved) in response to the control signal received from the correcting optical system control section <b>5</b>. This change causes refraction of the external light incident from the real space.</p>
<p id="p-0096" num="0113">The change of the correcting optical system <b>6</b> in step S<b>220</b> is an application of an anti-vibration technique applied to a regular pickup apparatus having a blur-correcting function.</p>
<p id="p-0097" num="0114">In step S<b>300</b>, the real-space image pickup section <b>9</b> shoots the real-space scene incident after passing through the correcting optical system <b>6</b>. The projected position of the real-space scene thus captured moves along with the change of the correcting optical system <b>6</b> occurring in step S<b>220</b>.</p>
<p id="p-0098" num="0115">When the real-space scene is projected onto the real-space image pickup section <b>9</b>, the real-space scene which should originally be incident perpendicularly on the real-space image pickup section <b>9</b> is diagonally incident at the real-space image pickup section <b>9</b>, resulting in a distorted image. A longer optical path between the correcting optical system <b>6</b> and the real-space image pickup section <b>9</b> permits minimization of the refraction angle of the external light of the real-space necessary for correction, and the distortion of the real-space scene can be disregarded.</p>
<p id="p-0099" num="0116">In step S<b>310</b>, the real-space image incorporating section <b>10</b> converts the real-space image captured by the real-space image pickup section <b>9</b> into a form suitable for the image merging section <b>11</b>, and outputs the same to the image merging section <b>11</b>.</p>
<p id="p-0100" num="0117">In step S<b>400</b>, the image merging section <b>11</b> merges the virtual-space image data sent from the virtual-space image generating section <b>2</b> with the real-space image data sent from the real-space image incorporating section <b>10</b>, and outputs the merged image data to the merged image display section <b>12</b>. The registration error caused by the-difference between the timing of shooting of the real space by the real-space image pickup section <b>9</b> and the timing of measurement of the position and orientation of the MR presenting apparatus by the first measuring section <b>1</b> is eliminated.</p>
<p id="p-0101" num="0118">In step S<b>500</b>, the merged image display section <b>12</b> displays the merged image. The displayed image light is projected onto the observer's viewpoint.</p>
<p id="p-0102" num="0119">In step S<b>600</b>, it is checked whether or not the operation of the apparatus is to be discontinued. When discontinuing operation of the apparatus, the system is stopped in step S<b>700</b>, and when not ending the operation, the process goes back to step S<b>100</b> to repeat the above-mentioned steps.</p>
<p id="p-0103" num="0120">The aforementioned third embodiment has been described as to a case where the present invention is applied in the form of a telescopic MR presenting apparatus. The invention may be applied in the form of a head-mounted type MR presenting apparatus (head-mounted display).</p>
<p id="p-0104" num="0121">A registration error caused by a time lag until reflection of the movement of the MR presenting apparatus into the display of the virtual space image by combining the first embodiment and the third embodiment of the present invention, in an MR presenting apparatus capable of being switched over between the optical see-through type and the video see-through type.</p>
<heading id="h-0008" level="1">Other Embodiments</heading>
<p id="p-0105" num="0122">The object of the present invention is achieved also by supplying a recording medium recording software for realizing the functions of the aforementioned embodiments of the invention in a system or an apparatus, and causing a computer (or a CPU or an MPU) of such a system or an apparatus to read out the program code stored in the recording medium for execution. In this case, the program code itself read out from the recording medium achieves the functions of the above-mentioned embodiments, and the recording medium storing the program code embodies the present invention. Execution of the program code read out by the computer permits the functions of the aforementioned embodiments to be achieved. In addition, an operating system (OS) running on the computer conducts all or part of the actual processes on the basis of the instructions in the program code, and the above-mentioned functions of the embodiments are thus achieved.</p>
<p id="p-0106" num="0123">Furthermore, the program code read out from the recording medium may be written into an expansion card inserted into the computer or a memory of an expansion unit connected to the computer, and then a CPU or the like of the expansion card or the expansion unit executes all or part of the actual processes on the basis of the instructions in the program code, thereby achieving the functions of the above-mentioned embodiments. These cases are also included within the scope of the present invention.</p>
<p id="p-0107" num="0124">Many widely differing embodiments of the present invention can be made without departing from the spirit and scope thereof, and it is to be understood that the invention is not limited to the specific embodiments thereof except as defined in the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A mixed reality presenting apparatus for merging an input real-space image and a generated virtual-space image, comprising:
<claim-text>a measuring section which measures the orientation of a unit for inputting said real-space image and the speed or acceleration thereof;</claim-text>
<claim-text>a virtual-space image generating section which generates virtual-space image data on the basis of the measurement result;</claim-text>
<claim-text>a correcting optical system which corrects a light path of said real-space image;</claim-text>
<claim-text>a correcting optical system control section which controls said correcting optical system on the basis of said measured speed or acceleration, so that a dynamic registration error is reduced; and</claim-text>
<claim-text>a merging section for merging said real-space image whose light path is corrected by said correcting optical system and said virtual-space image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A mixed reality presenting apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said measuring section further measures the position of said apparatus.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A mixed reality presenting apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said correcting optical system control section adjusts the amount of correction of said correcting optical system in response to the time required for generating the virtual-space image by said virtual-space image generating section.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A mixed reality presenting apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein an amount of correction of the course of light passing through said correcting optical system is set in response to an average time required for generating the virtual-space image data by said virtual-space image generating section.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A mixed reality presenting apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a real-space image pickup section which picks up external light incident from a real space; and</claim-text>
<claim-text>a display section which displays a merged image formed by the merging section.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. An image processing method comprising the steps of:
<claim-text>measuring the orientation of an apparatus for inputting a real-space image and the speed or acceleration thereof;</claim-text>
<claim-text>generating virtual-space image data on the basis of the measurement result;</claim-text>
<claim-text>controlling a correcting optical system which corrects a light path of said real-space image on the basis of said measured speed or acceleration, so that a dynamic registration error is reduced; and</claim-text>
<claim-text>merging said real-space image whose light path is corrected by said correcting optical system and said virtual-space image.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A mixed reality presenting apparatus for merging an input real-space image and a generated virtual-space image, comprising:
<claim-text>a measuring section which measures the orientation of a unit for inputting said real-space image and the speed or acceleration thereof;</claim-text>
<claim-text>a virtual-space image generating section which generates virtual-space image data on the basis of the measurement result;</claim-text>
<claim-text>a virtual-space image display section which displays the generated virtual-space image based on the generated virtual-space image;</claim-text>
<claim-text>a correcting optical system which corrects a light path of said displayed virtual-space image;</claim-text>
<claim-text>a correcting optical system control section which controls said correcting optical system on the basis of said measured speed or acceleration, so that a dynamic registration error is reduced; and</claim-text>
<claim-text>a merging section for merging said real-space image and said displayed virtual-space image whose light path is corrected by said correcting optical system.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
