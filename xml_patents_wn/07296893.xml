<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07296893-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07296893</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11032469</doc-number>
<date>20050107</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<us-term-of-grant>
<us-term-extension>394</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>10</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>A</section>
<class>61</class>
<subclass>B</subclass>
<main-group>3</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>351205</main-classification>
<further-classification>351246</further-classification>
</classification-national>
<invention-title id="d0e53">Transformation methods of wavefront maps from one vertex distance to another</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6550917</doc-number>
<kind>B1</kind>
<name>Neal et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6786603</doc-number>
<kind>B2</kind>
<name>Altmann</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6817714</doc-number>
<kind>B2</kind>
<name>Altmann</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0189690</doc-number>
<kind>A1</kind>
<name>Mihashi et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00005">
<othercit>Liang et al., “Objective measurement of wave aberrations of the human eye with the use of Hartmann-Shack wave-front sensor” <i>Journal of the Optical Society of America </i>(Jul. 1994) 11(7):1949-1957.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>351200</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>351204</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>351205</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>351211-216</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>351221</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>351246</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>9</number-of-drawing-sheets>
<number-of-figures>11</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60550514</doc-number>
<kind>00</kind>
<date>20040303</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050195364</doc-number>
<kind>A1</kind>
<date>20050908</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Dai</last-name>
<first-name>Guangming</first-name>
<address>
<city>Fremont</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Townsend and Townsend and Crew LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>VISX, Incorporated</orgname>
<role>02</role>
<address>
<city>Santa Clara</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Sugarman</last-name>
<first-name>Scott J.</first-name>
<department>2873</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The present invention provides methods, systems and software for scaling optical aberration measurements of optical systems. In one embodiment, the present invention provides a method of reconstructing optical tissues of an eye. The method comprises transmitting an image through the optical tissues of the eye. Aberration data from the transmitted image is measured across the optical tissues of the eye at a first plane. A conversion algorithm is applied to the data, converting it to corrective optical power data that can be used as a basis for constructing a treatment for the eye at a second plane.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="213.61mm" wi="292.35mm" file="US07296893-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="200.74mm" wi="150.96mm" orientation="landscape" file="US07296893-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="133.86mm" wi="129.46mm" file="US07296893-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="214.29mm" wi="148.34mm" file="US07296893-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="183.64mm" wi="145.80mm" file="US07296893-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="207.86mm" wi="121.75mm" file="US07296893-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="164.42mm" wi="136.31mm" file="US07296893-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="100.58mm" wi="135.97mm" file="US07296893-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="216.49mm" wi="152.32mm" file="US07296893-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="76.37mm" wi="156.21mm" file="US07296893-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This is a nonprovisional patent application which claims the benefit under 35 USC 119(e) of U.S. Provisional Patent Application No. 60/550,514 filed Mar. 3, 2004, the full disclosure of which is incorporated herein by reference.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention generally relates to scaling optical aberration measurements of optical systems. More particularly, the invention relates to improved methods and systems for processing optical power measurements taken at a first plane and converting those power measurements to corrective optical power measurements that can be used at a second plane. The present invention may be useful in any of a variety of ocular treatment modalities, including ablative laser eye surgery, contact lenses, spectacles, intraocular lenses, and the like.</p>
<p id="p-0004" num="0003">Known laser eye surgery procedures generally employ an ultraviolet or infrared laser to remove a microscopic layer of stromal tissue from the cornea of the eye. The laser typically removes a selected shape of the corneal tissue, often to correct refractive errors of the eye. Ultraviolet laser ablation results in photodecomposition of the corneal tissue, but generally does not cause significant thermal damage to adjacent and underlying tissues of the eye. The irradiated molecules are broken into smaller volatile fragments photochemically, directly breaking the intermolecular bonds.</p>
<p id="p-0005" num="0004">Laser ablation procedures can remove the targeted stroma of the cornea to change the cornea's contour for varying purposes, such as for correcting myopia, hyperopia, astigmatism, and the like. Control over the distribution of ablation energy across the cornea may be provided by a variety of systems and methods, including the use of ablatable masks, fixed and moveable apertures, controlled scanning systems, eye movement tracking mechanisms, and the like. In known systems, the laser beam often comprises a series of discrete pulses of laser light energy, with the total shape and amount of tissue removed being determined by the shape, size, location, and/or number of laser energy pulses impinging on the cornea. A variety of algorithms may be used to calculate the pattern of laser pulses used to reshape the cornea so as to correct a refractive error of the eye. Known systems make use of a variety of forms of lasers and/or laser energy to effect the correction, including infrared lasers, ultraviolet lasers, femtosecond lasers, wavelength multiplied solid-state lasers, and the like. Alternative vision correction techniques make use of radial incisions in the cornea, intraocular lenses, removable corneal support structures, and the like.</p>
<p id="p-0006" num="0005">Known corneal correction treatment methods have generally been successful in correcting standard vision errors, such as myopia, hyperopia, astigmatism, and the like. However, as with all successes, still further improvements would be desirable. Toward that end, wavefront measurement systems are now available to accurately measure the refractive characteristics of a particular patient's eye. One exemplary wavefront technology system is the VISX WaveScan® System, which uses a Hartmann-Shack wavefront lenslet array that can quantify aberrations throughout the entire optical system of the patient's eye, including first- and second-order sphero-cylindrical errors, coma, and third and fourth-order aberrations related to coma, astigmatism, and spherical aberrations.</p>
<p id="p-0007" num="0006">Wavefront measurement of the eye may be used to create a high order aberration map or wavefront elevation map that permits assessment of aberrations throughout the optical pathway of the eye, e.g., both internal aberrations and aberrations on the corneal surface. The aberration map may then be used to compute a custom ablation pattern for allowing a surgical laser system to correct the complex aberrations in and on the patient's eye. Known methods for calculation of a customized ablation pattern using wavefront sensor data generally involves mathematically modeling an optical surface of the eye using expansion series techniques. More specifically, Zernike polynomials have been employed to model the optical surface, as proposed by Liang et al., in <i>Objective Measurement of Wave Aberrations of the Human Eye with the Use of a Harman</i>-<i>Shack Wave</i>-<i>front Sensor, </i>Journal Optical Society of America, July, 1994, vol. 11, No. 7, pp. 1949-1957, the entire contents of which is hereby incorporated by reference. Coefficients of the Zernike polynomials are derived through known fitting techniques, and the refractive correction procedure is then determined using the shape of the optical surface of the eye, as indicated by the mathematical series expansion model.</p>
<p id="p-0008" num="0007">Optical measurements such as wavefront measurements are often taken at a measurement plane, whereas optical treatments may be needed at a treatment plane that is different from the measurement plane. Thus, power adjustments are often used when devising optical treatments for patients. For example, power adjustments can be used by optometrists when prescribing spectacles for patients. Typically, refractive measurements are made by an optometer at a measurement plane some distance anterior to the eye, and this distance may not coincide with the spectacle plane. Thus, the measured power corresponding to the measurement plane may need to be converted to a corrective power corresponding to the spectacle or treatment plane. Similarly, when wavefront measurements are obtained with wavefront devices, in many cases the measured map is conjugated at the pupil plane, which is not the same as the corneal plane or spectacle plane. To enhance the effectiveness of a refractive surgical procedure, vertex correction may be needed to adjust the power of the measured maps. Yet there remains a lack of efficient methods and systems for such power conversions.</p>
<p id="p-0009" num="0008">Therefore, in light of above, it would be desirable to provide improved methods and systems for processing optical data taken at a measurement plane and converting that optical data to corrective optical data that can be used at a treatment plane.</p>
<heading id="h-0003" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">The present invention provides methods and systems for processing optical power measurements taken at a first plane and converting those power measurements to corrective optical power measurements that can be used at a second plane.</p>
<p id="p-0011" num="0010">In one aspect, the present invention provides a method of determining a refractive treatment shape for ameliorating a vision condition in a patient. The method comprises measuring a wavefront aberration of an eye of the patient in order to provide a measurement surface aberration, deriving a treatment surface aberration of the eye based on the measurement surface aberration, and determining the refractive treatment shape based on the treatment surface aberration of the eye. The wavefront aberration can correspond to a measurement surface that is disposed at or near a pupil plane of the eye, and the treatment surface aberration can correspond to a treatment surface that is disposed at or near an anterior surface of a cornea of the eye. The treatment surface aberration may be derived using a difference between the measurement surface and the treatment surface.</p>
<p id="p-0012" num="0011">In another aspect, the present invention provides a method of ameliorating a vision condition in a patient. The method comprises measuring a wavefront aberration of an eye of the patient in order to provide a measurement surface aberration, deriving a treatment surface aberration of the eye from the measurement surface aberration, determining a refractive treatment shape based on the treatment surface aberration of the eye, and applying the refractive treatment shape to the eye of the patient to ameliorate the vision condition. The wavefront aberration can correspond to a measurement surface that is disposed at or near a pupil plane of the eye. The treatment surface aberration can correspond to a treatment surface that is disposed at or near an anterior corneal surface of the eye, or a treatment surface that corresponds to a spectacle plane of the eye. Relatedly, the treatment surface may be disposed posterior to a pupil plane of the eye. The treatment surface aberration may be based on a difference between the measurement surface and the treatment surface.</p>
<p id="p-0013" num="0012">In a related aspect, the refractive treatment shape can be applied to the eye of the patient in a variety of treatment modalities. For example, the treatment shape can be applied by ablating a corneal surface of the patient to provide a corneal surface shape that corresponds to the refractive treatment shape. The treatment shape may also be applied by providing the patient with a contact lens that has a shape that corresponds to the refractive treatment shape. Further, the treatment shape may be applied by providing the patient with a spectacle lens that has a shape that corresponds to the refractive treatment shape. What is more, the treatment shape can be applied by providing the patient with an intra-ocular lens that has a shape that corresponds to the refractive treatment shape.</p>
<p id="p-0014" num="0013">In another aspect, the present invention provides a system for generating a refractive treatment shape for ameliorating a vision condition in an eye of a patient. The system comprises an input module that accepts a measurement surface aberration, a transformation module that derives a treatment surface aberration based on the measurement surface aberration, and an output module that generates the refractive treatment shape based on the treatment surface aberration. The measurement surface aberration may be based on a wavefront aberration of the eye. The wavefront aberration can correspond to a measurement surface that is disposed at or near a pupil plane of the eye. The treatment surface aberration can correspond to a treatment surface that is disposed at or near an anterior corneal surface of the eye, or a treatment surface that corresponds to a spectacle plane of the eye. Relatedly, the treatment surface may be disposed posterior to a pupil plane of the eye. The treatment surface aberration may be based on a difference between the measurement surface and the treatment surface.</p>
<p id="p-0015" num="0014">In another aspect, the present invention provides a system for ameliorating a vision condition in an eye of a patient. The system comprises an input module that accepts a measurement surface aberration, a transformation module that derives a treatment surface aberration based on the measurement surface aberration, an output module that generates a refractive treatment shape based on the treatment surface aberration, and a laser system that directs laser energy onto the eye according to the refractive treatment shape so as to reprofile a surface of the eye from an initial shape to a subsequent shape, the subsequent shape having correctively improved optical properties for ameliorating the vision condition. The measurement surface aberration may be based on a wavefront aberration of the eye. The wavefront aberration can correspond to a measurement surface that is disposed at or near a pupil plane of the eye, and the treatment surface aberration can correspond to a treatment surface that is disposed at or near an anterior surface of a cornea of the eye. The treatment surface aberration can be derived based on a difference between the measurement surface and the treatment surface.</p>
<p id="p-0016" num="0015">In some aspects, the treatment surface aberration may be a treatment surface wavefront map. In other aspects, the measurement surface aberration may be a measurement surface wavefront map. The treatment surface wavefront map may be derived at least in part by local slope scaling of the measurement surface wavefront map. In still other aspects, the treatment surface wavefront map may be derived at least in part by applying a scaling factor of 1/(1+Pd) to a slope of the measurement surface wavefront map, where P represents a local curvature of the measurement surface wavefront map and d represents a difference between the measurement surface and the treatment surface. In a related aspect, a difference between the measurement surface and a retinal surface of the eye corresponds to a first vertex measure, and a difference between the treatment surface and the retinal surface of the eye corresponds to a second vertex measure. P may be based on a second derivative of the measurement surface wavefront map. P may also be based on a pupil radius of the eye.</p>
<p id="p-0017" num="0016">In some aspects, the treatment surface wavefront map can be derived according to an iterative Fourier reconstruction algorithm. What is more, the measurement surface aberration may reflect low order and/or high order aberrations of the eye of the patient.</p>
<p id="p-0018" num="0017">In another aspect, the present invention provides a system for generating a prescription for ameliorating a vision condition in an eye of a patient. The system comprises an input that accepts irregular aberration data corresponding to an aberration measurement surface adjacent a pupil plane of the eye, a transformation module that derives a treatment surface aberration corresponding to a treatment surface that is disposed adjacent an anterior surface of a cornea of the eye, and an output module that generates the prescription based on the treatment surface aberration. The treatment surface aberration can be derived from the irregular aberration data using a difference between the measurement surface and the treatment surface.</p>
<p id="p-0019" num="0018">These and other aspects will be apparent in the remainder of the figures, description, and claims.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a laser ablation system according to an embodiment of the present invention.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a simplified computer system according to an embodiment of the present invention.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a wavefront measurement system according to an embodiment of the present invention.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 3A</figref> illustrates another wavefront measurement system according to an embodiment of the present invention.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 4</figref> schematically represents a simplified set of modules that carry out one method of the present invention.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 5</figref> is a flow chart that schematically illustrates a method of determining a refractive treatment shape according to one embodiment of the present invention.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a model optical system.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a comparison between vertex corrected power calculations based on algorithms provided by the present invention with calculations based on a classical formula.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a wavefront before and after a vertex correction.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0029" num="0028">The present invention provides methods, software, and systems for processing optical power measurements taken at a first plane and converting those power measurements to corrective optical power measurements that can be used at a second plane.</p>
<p id="p-0030" num="0029">The present invention is generally useful for enhancing the accuracy and efficacy of laser eye surgical procedures, such as photorefractive keratectomy (PRK), phototherapeutic keratectomy (PTK), laser in situ keratomileusis (LASIK), and the like. The present invention can provide enhanced optical accuracy of refractive procedures by improving the methodology for processing measured optical errors of the eye and hence calculate a more accurate refractive ablation program. In one particular embodiment, the present invention is related to therapeutic wavefront-based ablations of pathological eyes.</p>
<p id="p-0031" num="0030">The present invention can be readily adapted for use with existing laser systems, wavefront measurement systems, and other optical measurement devices. While the systems, software, and methods of the present invention are described primarily in the context of a laser eye surgery system, it should be understood the present invention may be adapted for use in alternative eye treatment procedures and systems such as spectacle lenses, intraocular lenses, contact lenses, corneal ring implants, collagenous corneal tissue thermal remodeling, and the like.</p>
<p id="p-0032" num="0031">Turning now to the drawings, <figref idref="DRAWINGS">FIG. 1</figref> illustrates a laser eye surgery system <b>10</b> of the present invention, including a laser <b>12</b> that produces a laser beam <b>14</b>. Laser <b>12</b> is optically coupled to laser delivery optics <b>16</b>, which directs laser beam <b>14</b> to an eye E of patient P. A delivery optics support structure (not shown here for clarity) extends from a frame <b>18</b> supporting laser <b>12</b>. A microscope <b>20</b> is mounted on the delivery optics support structure, the microscope often being used to image a cornea of eye E.</p>
<p id="p-0033" num="0032">Laser <b>12</b> generally comprises an excimer laser, ideally comprising an argon-fluorine laser producing pulses of laser light having a wavelength of approximately 193 nm. Laser <b>12</b> will preferably be designed to provide a feedback stabilized fluence at the patient's eye, delivered via delivery optics <b>16</b>. The present invention may also be useful with alternative sources of ultraviolet or infrared radiation, particularly those adapted to controllably ablate the corneal tissue without causing significant damage to adjacent and/or underlying tissues of the eye. Such sources include, but are not limited to, solid state lasers and other devices which can generate energy in the ultraviolet wavelength between about 185 and 215 nm and/or those which utilize frequency-multiplying techniques. Hence, although an excimer laser is the illustrative source of an ablating beam, other lasers may be used in the present invention.</p>
<p id="p-0034" num="0033">Laser system <b>10</b> will generally include a computer or programmable processor <b>22</b>. Processor <b>22</b> may comprise (or interface with) a conventional PC system including the standard user interface devices such as a keyboard, a display monitor, and the like. Processor <b>22</b> will typically include an input device such as a magnetic or optical disk drive, an internet connection, or the like. Such input devices will often be used to download a computer executable code from a tangible storage media <b>29</b> embodying any of the methods of the present invention. Tangible storage media <b>29</b> may take the form of a floppy disk, an optical disk, a data tape, a volatile or non-volatile memory, RAM, or the like, and the processor <b>22</b> will include the memory boards and other standard components of modem computer systems for storing and executing this code. Tangible storage media <b>29</b> may optionally embody wavefront sensor data, wavefront gradients, a wavefront elevation map, a treatment map, a corneal elevation map, and/or an ablation table. While tangible storage media <b>29</b> will often be used directly in cooperation with a input device of processor <b>22</b>, the storage media may also be remotely operatively coupled with processor by means of network connections such as the internet, and by wireless methods such as infrared, Bluetooth, or the like.</p>
<p id="p-0035" num="0034">Laser <b>12</b> and delivery optics <b>16</b> will generally direct laser beam <b>14</b> to the eye of patient P under the direction of a computer <b>22</b>. Computer <b>22</b> will often selectively adjust laser beam <b>14</b> to expose portions of the cornea to the pulses of laser energy so as to effect a predetermined sculpting of the cornea and alter the refractive characteristics of the eye. In many embodiments, both laser beam <b>14</b> and the laser delivery optical system <b>16</b> will be under computer control of processor <b>22</b> to effect the desired laser sculpting process, with the processor effecting (and optionally modifying) the pattern of laser pulses. The pattern of pulses may by summarized in machine readable data of tangible storage media <b>29</b> in the form of a treatment table, and the treatment table may be adjusted according to feedback input into processor <b>22</b> from an automated image analysis system in response to feedback data provided from an ablation monitoring system feedback system. Optionally, the feedback may be manually entered into the processor by a system operator. Such feedback might be provided by integrating the wavefront measurement system described below with the laser treatment system <b>10</b>, and processor <b>22</b> may continue and/or terminate a sculpting treatment in response to the feedback, and may optionally also modify the planned sculpting based at least in part on the feedback. Measurement systems are further described in U.S. Pat. No. 6,315,413, the full disclosure of which is incorporated herein by reference.</p>
<p id="p-0036" num="0035">Laser beam <b>14</b> may be adjusted to produce the desired sculpting using a variety of alternative mechanisms. The laser beam <b>14</b> may be selectively limited using one or more variable apertures. An exemplary variable aperture system having a variable iris and a variable width slit is described in U.S. Pat. No. 5,713,892, the full disclosure of which is incorporated herein by reference. The laser beam may also be tailored by varying the size and offset of the laser spot from an axis of the eye, as described in U.S. Pat. Nos. 5,683,379, 6,203,539, and 6,331,177, the full disclosures of which are incorporated herein by reference.</p>
<p id="p-0037" num="0036">Still further alternatives are possible, including scanning of the laser beam over the surface of the eye and controlling the number of pulses and/or dwell time at each location, as described, for example, by U.S. Pat. No. 4,665,913, the full disclosure of which is incorporated herein by reference; using masks in the optical path of laser beam <b>14</b> which ablate to vary the profile of the beam incident on the cornea, as described in U.S. Pat. No. 5,807,379, the full disclosure of which is incorporated herein by reference; hybrid profile-scanning systems in which a variable size beam (typically controlled by a variable width slit and/or variable diameter iris diaphragm) is scanned across the cornea; or the like. The computer programs and control methodology for these laser pattern tailoring techniques are well described in the patent literature.</p>
<p id="p-0038" num="0037">Additional components and subsystems may be included with laser system <b>10</b>, as should be understood by those of skill in the art. For example, spatial and/or temporal integrators may be included to control the distribution of energy within the laser beam, as described in U.S. Pat. No. 5,646,791, the full disclosure of which is incorporated herein by reference. Ablation effluent evacuators/filters, aspirators, and other ancillary components of the laser surgery system are known in the art. Further details of suitable systems for performing a laser ablation procedure can be found in commonly assigned U.S. Pat. Nos. 4,665,913, 4,669,466, 4,732,148, 4,770,172, 4,773,414, 5,207,668, 5,108,388, 5,219,343, 5,646,791 and 5,163,934, the complete disclosures of which are incorporated herein by reference. Basis data can be further characterized for particular lasers or operating conditions, by taking into account localized environmental variables such as temperature, humidity, airflow, and aspiration.</p>
<p id="p-0039" num="0038"><figref idref="DRAWINGS">FIG. 2</figref> is a simplified block diagram of an exemplary computer system <b>22</b> that may be used by the laser surgical system <b>10</b> of the present invention. Computer system <b>22</b> typically includes at least one processor <b>52</b> which may communicate with a number of peripheral devices via a bus subsystem <b>54</b>. These peripheral devices may include a storage subsystem <b>56</b>, comprising a memory subsystem <b>58</b> and a file storage subsystem <b>60</b>, user interface input devices <b>62</b>, user interface output devices <b>64</b>, and a network interface subsystem <b>66</b>. Network interface subsystem <b>66</b> provides an interface to outside networks <b>68</b> and/or other devices, such as the wavefront measurement system <b>30</b>.</p>
<p id="p-0040" num="0039">User interface input devices <b>62</b> may include a keyboard, pointing devices such as a mouse, trackball, touch pad, or graphics tablet, a scanner, foot pedals, a joystick, a touchscreen incorporated into the display, audio input devices such as voice recognition systems, microphones, and other types of input devices. User input devices <b>62</b> will often be used to download a computer executable code from a tangible storage media <b>29</b> embodying any of the methods of the present invention. In general, use of the term “input device” is intended to include a variety of conventional and proprietary devices and ways to input information into computer system <b>22</b>.</p>
<p id="p-0041" num="0040">User interface output devices <b>64</b> may include a display subsystem, a printer, a fax machine, or non-visual displays such as audio output devices. The display subsystem may be a cathode ray tube (CRT), a flat-panel device such as a liquid crystal display (LCD), a projection device, or the like. The display subsystem may also provide a non-visual display such as via audio output devices. In general, use of the term “output device” is intended to include a variety of conventional and proprietary devices and ways to output information from computer system <b>22</b> to a user.</p>
<p id="p-0042" num="0041">Storage subsystem <b>56</b> can store the basic programming and data constructs that provide the functionality of the various embodiments of the present invention. For example, a database and modules implementing the functionality of the methods of the present invention, as described herein, may be stored in storage subsystem <b>56</b>. These software modules are generally executed by processor <b>52</b>. In a distributed environment, the software modules may be stored on a plurality of computer systems and executed by processors of the plurality of computer systems. Storage subsystem <b>56</b> typically comprises memory subsystem <b>58</b> and file storage subsystem <b>60</b>.</p>
<p id="p-0043" num="0042">Memory subsystem <b>58</b> typically includes a number of memories including a main random access memory (RAM) <b>70</b> for storage of instructions and data during program execution and a read only memory (ROM) <b>72</b> in which fixed instructions are stored. File storage subsystem <b>60</b> provides persistent (non-volatile) storage for program and data files, and may include tangible storage media <b>29</b> (<figref idref="DRAWINGS">FIG. 1</figref>) which may optionally embody wavefront sensor data, wavefront gradients, a wavefront elevation map, a treatment map, and/or an ablation table. File storage subsystem <b>60</b> may include a hard disk drive, a floppy disk drive along with associated removable media, a Compact Digital Read Only Memory (CD-ROM) drive, an optical drive, DVD, CD-R, CD-RW, solid-state removable memory, and/or other removable media cartridges or disks. One or more of the drives may be located at remote locations on other connected computers at other sites coupled to computer system <b>22</b>. The modules implementing the functionality of the present invention may be stored by file storage subsystem <b>60</b>.</p>
<p id="p-0044" num="0043">Bus subsystem <b>54</b> provides a mechanism for letting the various components and subsystems of computer system <b>22</b> communicate with each other as intended. The various subsystems and components of computer system <b>22</b> need not be at the same physical location but may be distributed at various locations within a distributed network. Although bus subsystem <b>54</b> is shown schematically as a single bus, alternate embodiments of the bus subsystem may utilize multiple busses.</p>
<p id="p-0045" num="0044">Computer system <b>22</b> itself can be of varying types including a personal computer, a portable computer, a workstation, a computer terminal, a network computer, a control system in a wavefront measurement system or laser surgical system, a mainframe, or any other data processing system. Due to the ever-changing nature of computers and networks, the description of computer system <b>22</b> depicted in <figref idref="DRAWINGS">FIG. 2</figref> is intended only as a specific example for purposes of illustrating one embodiment of the present invention. Many other configurations of computer system <b>22</b> are possible having more or less components than the computer system depicted in <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0046" num="0045">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, one embodiment of a wavefront measurement system <b>30</b> is schematically illustrated in simplified form. In very general terms, wavefront measurement system <b>30</b> is configured to sense local slopes of a gradient map exiting the patient's eye. Devices based on the Hartmann-Shack principle generally include a lenslet array to sample the gradient map uniformly over an aperture, which is typically the exit pupil of the eye. Thereafter, the local slopes of the gradient map are analyzed so as to reconstruct the wavefront surface or map.</p>
<p id="p-0047" num="0046">More specifically, one wavefront measurement system <b>30</b> includes an image source <b>32</b>, such as a laser, which projects a source image through optical tissues <b>34</b> of eye E so as to form an image <b>44</b> upon a surface of retina R. The image from retina R is transmitted by the optical system of the eye (e.g., optical tissues <b>34</b> ) and imaged onto a wavefront sensor <b>36</b> by system optics <b>37</b>. The wavefront sensor <b>36</b> communicates signals to a computer system <b>22</b>′ for measurement of the optical errors in the optical tissues <b>34</b> and/or determination of an optical tissue ablation treatment program. Computer <b>22</b>′ may include the same or similar hardware as the computer system <b>22</b> illustrated in <figref idref="DRAWINGS">FIGS. 1 and 2</figref>. Computer system <b>22</b>′ may be in communication with computer system <b>22</b> that directs the laser surgery system <b>10</b>, or some or all of the components of computer system <b>22</b>, <b>22</b>′ of the wavefront measurement system <b>30</b> and laser surgery system <b>10</b> may be combined or separate. If desired, data from wavefront sensor <b>36</b> may be transmitted to a laser computer system <b>22</b> via tangible media <b>29</b>, via an I/O port, via an networking connection <b>66</b> such as an intranet or the Internet, or the like.</p>
<p id="p-0048" num="0047">Wavefront sensor <b>36</b> generally comprises a lenslet array <b>38</b> and an image sensor <b>40</b>. As the image from retina R is transmitted through optical tissues <b>34</b> and imaged onto a surface of image sensor <b>40</b> and an image of the eye pupil P is similarly imaged onto a surface of lenslet array <b>38</b>, the lenslet array separates the transmitted image into an array of beamlets <b>42</b>, and (in combination with other optical components of the system) images the separated beamlets on the surface of sensor <b>40</b>. Sensor <b>40</b> typically comprises a charged couple device or “CCD,” and senses the characteristics of these individual beamlets, which can be used to determine the characteristics of an associated region of optical tissues <b>34</b>. In particular, where image <b>44</b> comprises a point or small spot of light, a location of the transmitted spot as imaged by a beamlet can directly indicate a local gradient of the associated region of optical tissue.</p>
<p id="p-0049" num="0048">Eye E generally defines an anterior orientation ANT and a posterior orientation POS. Image source <b>32</b> generally projects an image in a posterior orientation through optical tissues <b>34</b> onto retina R as indicated in <figref idref="DRAWINGS">FIG. 3</figref>. Optical tissues <b>34</b> again transmit image <b>44</b> from the retina anteriorly toward wavefront sensor <b>36</b>. Image <b>44</b> actually formed on retina R may be distorted by any imperfections in the eye's optical system when the image source is originally transmitted by optical tissues <b>34</b>. Optionally, image source projection optics <b>46</b> may be configured or adapted to decrease any distortion of image <b>44</b>.</p>
<p id="p-0050" num="0049">In some embodiments, image source optics <b>46</b> may decrease lower order optical errors by compensating for spherical and/or cylindrical errors of optical tissues <b>34</b>. Higher order optical errors of the optical tissues may also be compensated through the use of an adaptive optic element, such as a deformable mirror (described below). Use of an image source <b>32</b> selected to define a point or small spot at image <b>44</b> upon retina R may facilitate the analysis of the data provided by wavefront sensor <b>36</b>. Distortion of image <b>44</b> may be limited by transmitting a source image through a central region <b>48</b> of optical tissues <b>34</b> which is smaller than a pupil <b>50</b>, as the central portion of the pupil may be less prone to optical errors than the peripheral portion. Regardless of the particular image source structure, it will be generally be beneficial to have a well-defined and accurately formed image <b>44</b> on retina R.</p>
<p id="p-0051" num="0050">In one embodiment, the wavefront data may be stored in a computer readable medium <b>29</b> or a memory of the wavefront sensor system <b>30</b> in two separate arrays containing the x and y wavefront gradient values obtained from image spot analysis of the Hartmann-Shack sensor images, plus the x and y pupil center offsets from the nominal center of the Hartmann-Shack lenslet array, as measured by the pupil camera <b>51</b> (<figref idref="DRAWINGS">FIG. 3</figref>) image. Such information contains all the available information on the wavefront error of the eye and is sufficient to reconstruct the wavefront or any portion of it. In such embodiments, there is no need to reprocess the Hartmann-Shack image more than once, and the data space required to store the gradient array is not large. For example, to accommodate an image of a pupil with an 8 mm diameter, an array of a 20×20 size (i.e., 400 elements) is often sufficient. As can be appreciated, in other embodiments, the wavefront data may be stored in a memory of the wavefront sensor system in a single array or multiple arrays.</p>
<p id="p-0052" num="0051">While the methods of the present invention will generally be described with reference to sensing of an image <b>44</b>, it should be understood that a series of wavefront sensor data readings may be taken. For example, a time series of wavefront data readings may help to provide a more accurate overall determination of the ocular tissue aberrations. As the ocular tissues can vary in shape over a brief period of time, a plurality of temporally separated wavefront sensor measurements can avoid relying on a single snapshot of the optical characteristics as the basis for a refractive correcting procedure. Still further alternatives are also available, including taking wavefront sensor data of the eye with the eye in differing configurations, positions, and/or orientations. For example, a patient will often help maintain alignment of the eye with wavefront measurement system <b>30</b> by focusing on a fixation target, as described in U.S. Pat. No. 6,004,313, the full disclosure of which is incorporated herein by reference. By varying a position of the fixation target as described in that reference, optical characteristics of the eye may be determined while the eye accommodates or adapts to image a field of view at a varying distance and/or angles.</p>
<p id="p-0053" num="0052">The location of the optical axis of the eye may be verified by reference to the data provided from a pupil camera <b>52</b>. In the exemplary embodiment, a pupil camera <b>52</b> images pupil <b>50</b> so as to determine a position of the pupil for registration of the wavefront sensor data relative to the optical tissues.</p>
<p id="p-0054" num="0053">An alternative embodiment of a wavefront measurement system is illustrated in <figref idref="DRAWINGS">FIG. 3A</figref>. The major components of the system of <figref idref="DRAWINGS">FIG. 3A</figref> are similar to those of <figref idref="DRAWINGS">FIG. 3</figref>. Additionally, <figref idref="DRAWINGS">FIG. 3A</figref> includes an adaptive optical element <b>53</b> in the form of a deformable mirror. The source image is reflected from deformable mirror <b>98</b> during transmission to retina R, and the deformable mirror is also along the optical path used to form the transmitted image between retina R and imaging sensor <b>40</b>. Deformable mirror <b>98</b> can be controllably deformed by computer system <b>22</b> to limit distortion of the image formed on the retina or of subsequent images formed of the images formed on the retina, and may enhance the accuracy of the resultant wavefront data. The structure and use of the system of <figref idref="DRAWINGS">FIG. 3A</figref> are more fully described in U.S. Pat. No. 6,095,651, the full disclosure of which is incorporated herein by reference.</p>
<p id="p-0055" num="0054">The components of an embodiment of a wavefront measurement system for measuring the eye and ablations comprise elements of a VISX WaveScan®, available from VISX, I<smallcaps>NCORPORATED </smallcaps>of Santa Clara, Calif. One embodiment includes a WaveScan® with a deformable mirror as described above. An alternate embodiment of a wavefront measuring system is described in U.S. Pat. No. 6,271,915, the full disclosure of which is incorporated herein by reference.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 4</figref> schematically illustrates a simplified set of modules, or a correction system <b>100</b>, for carrying out a method according to one embodiment of the present invention. Correction system <b>100</b> can be integrated or interfaced with, for example, computer system <b>22</b>, or otherwise used in conjunction with laser surgical system <b>10</b>. The modules may be software modules on a computer readable medium that is processed by processor <b>52</b> (<figref idref="DRAWINGS">FIG. 2</figref>), hardware modules, or a combination thereof. Any of a variety of commonly used platforms, such as Windows, MacIntosh, and Unix, along with any of a variety of commonly used programming languages, may be used to implement the present invention.</p>
<p id="p-0057" num="0056">Correction system <b>100</b> can be configured to generate a refractive treatment shape <b>110</b> for ameliorating a vision condition in a patient. An input module <b>102</b> typically receives a measurement surface aberration <b>120</b>, such as wavefront aberration data from wavefront sensors, which characterize aberrations and other optical characteristics of the entire optical tissue system imaged. Often, the wavefront aberration corresponds to a measurement surface that is disposed at or near a pupil plane of the eye. The data from the wavefront sensors are typically generated by transmitting an image (such as a small spot or point of light) through the optical tissues, as described above. Measurement surface aberration <b>120</b> can include an array of optical gradients or a gradient map.</p>
<p id="p-0058" num="0057">Correction system <b>100</b> can include a transformation module <b>104</b> that derives a treatment surface aberration. The treatment surface aberration can correspond to a treatment surface that is disposed at or near an anterior corneal surface of the eye, or a treatment surface that corresponds to a spectacle plane of the eye. Relatedly, the treatment surface may be disposed posterior to a pupil plane of the eye. Often, the treatment surface aberration is derived from measurement surface aberration <b>120</b> using a difference between the measurement surface and the treatment surface. For example, optical gradient data from input module <b>102</b> may be transmitted to transformation module <b>104</b>, where a treatment surface aberration is mathematically reconstructed based on the optical gradient data.</p>
<p id="p-0059" num="0058">Correction system <b>100</b> can include an output module <b>106</b>, such that the treatment surface aberration generated by transformation module <b>104</b> can then be transmitted to output module <b>106</b> where a refractive treatment shape <b>110</b> can be generated based on the treatment surface aberration. Refractive treatment shape <b>110</b> may be transmitted to a laser treatment apparatus for generation of a laser ablation treatment for the patient. Similarly, refractive treatment shape <b>110</b> may form the basis for fabrication of contact lenses, spectacles, or intra-ocular lenses.</p>
<p id="p-0060" num="0059">As can be appreciated, the present invention should not be limited to the order of steps, or the specific steps illustrated, and various modifications to the method, such as having more or less steps, may be made without departing from the scope of the present invention.</p>
<p id="p-0061" num="0060">In one embodiment, the present invention provides a method of determining a refractive treatment shape for ameliorating a vision condition in a patient. <figref idref="DRAWINGS">FIG. 5</figref> depicts the steps of an exemplary method according to the present invention. The refractive treatment shape can be based on a treatment surface aberration that is derived from a measurement surface aberration.</p>
<p id="h-0006" num="0000">I. Measurement Surface Aberration</p>
<p id="p-0062" num="0061">In general terms, a measurement surface aberration can be determined from optical data corresponding to a measurement surface. For example, a measurement surface aberration can be determined by measuring a wavefront aberration of an eye of a patient. A wavefront measurement system that includes a wavefront sensor (such as a Hartmann-Shack sensor) may be used to obtain one or more measurement surface aberrations (e.g. wavefront maps) of the optical tissues of the eye. The wavefront map may be obtained by transmitting an image through the optical tissues of the eye and sensing the exiting wavefront surface. From the wavefront map, it is possible to calculate a surface gradient or gradient map across the optical tissues of the eye. A gradient map may comprise an array of the localized gradients as calculated from each location for each lenslet of the Hartmann-Shack sensor.</p>
<p id="p-0063" num="0062">A. Measurement Surface</p>
<p id="p-0064" num="0063">There are a variety of devices and methods for measuring surface characteristics of optical systems. The category of aberroscopes or aberrometers includes classical phoropter and wavefront approaches. Classical phoropters can be used to record optical data corresponding to a measurement surface that is disposed anterior to the cornea of an eye. For example, phoropters can measure low order aberrations at a distance of about 12.5 mm anterior to the corneal surface. In many cases, this will correspond to a spectacle plane of the eye. Wavefront devices are often used to measure both low order and high order aberrations adjacent a pupil plane, which can be about 3.5 mm posterior to the corneal surface. Another category of measuring approaches includes topography based measuring devices and methods. Topography typically involves providing optical data corresponding to a measurement surface that is disposed at or near the corneal surface of the eye.</p>
<p id="p-0065" num="0064">B. Aberration</p>
<p id="p-0066" num="0065">As noted above, the measurement surface aberration can be based on a refractive measurement as determined by an optometer, or any of a wide variety of devices for obtaining irregular aberration data. Similarly, the measurement surface aberration can be a measurement surface wavefront map, as determined by a wavefront measurement device. What is more, the measurement surface aberration may reflect both low order and high order aberrations of the eye of a patient.</p>
<p id="h-0007" num="0000">II. Treatment Surface Aberration</p>
<p id="p-0067" num="0066">When a measurement surface aberration of an optical system has been determined, it is then possible to derive a treatment surface aberration of the optical system. In the case of refractive surgical methods, for example, a treatment surface aberration corresponding to a corneal plane can be derived from a measurement surface aberration as determined in a plane other than the corneal plane.</p>
<p id="p-0068" num="0067">A. Treatment Surface</p>
<p id="p-0069" num="0068">The treatment surface aberration corresponds to a treatment surface, which is typically disposed at or near an anterior surface of a cornea of an eye. Often, the treatment surface will correspond to a corneal plane associated with the eye, as in the case of ablative laser eye surgery or contact lens treatments. At other times, the treatment surface may correspond to a spectacle plane associated with the eye, as in the case of spectacle treatments. Further, the treatment surface can be posterior to the pupil plane of the eye, as in the case of intraocular lens treatments.</p>
<p id="p-0070" num="0069">B. Derivation of Treatment Surface Aberration</p>
<p id="p-0071" num="0070">The treatment surface aberration can be derived from the measurement surface aberration, based on a difference between the measurement surface and the treatment surface. The difference between the measurement surface and the treatment surface, for example, can include a distance measurement that represents a difference between the two surfaces. In some embodiments, the distance measurement is based on a vertex distance difference, the vertex distance difference reflecting a distance between a vertex of the measurement surface and a vertex of the treatment surface.</p>
<p id="p-0072" num="0071">1. Classical Vertex Correction Formulas</p>
<p id="p-0073" num="0072">Traditionally, the power of a lens is measured in diopters, and can be defined as the reciprocal of the lens focal length in meters. <figref idref="DRAWINGS">FIG. 6</figref> shows a schematic diagram of an optical system. The system includes a first plane disposed at a first distance from a focal plane, the first distance corresponding to a first focal length, and a second plane disposed at a second distance from the focal plane, the second distance corresponding to a second focal length. Although the first and second planes are illustrated as flat surfaces, these planes can also represent curved surfaces such as lenses, wavefronts, and other representations of optical surfaces. In the exemplary optical system depicted by <figref idref="DRAWINGS">FIG. 6</figref> legend (a), the focal plane may be associated with a retinal plane, the first plane may be associated with a spectacle plane, and the second plane may be associated with a corneal plane.</p>
<p id="p-0074" num="0073">A treatment surface can correspond to, or be based upon, a spectacle surface, corneal surface, pupil surface, and the like. A spectacle surface is typically about 12.5 mm anterior to the cornea of the eye. A pupil surface or plane is typically about 3.5 mm posterior to the cornea of the eye. An intraocular lens surface is usually about 0.5 mm posterior to the pupil surface or plane of the eye. A contact lens surface is typically at or slightly anterior to the cornea of the eye. If the treatment surface and the measurement surface are substantially in the same plane, there may be no need for a vertex correction.</p>
<p id="p-0075" num="0074">When prescribing spectacles, for example, an optometrist may first make or consider an aberration measurement such as a refractive measurement of the eye, where the aberration measurement corresponds to a measurement surface at or near a pupil plane or surface of the eye. Because the treatment surface may not be the same as the measurement surface, it is often desirable to make a power adjustment in order to determine the corrective surface shape or treatment surface aberration. In the case of spectacles, the treatment surface is disposed anterior to the corneal surface, usually by about 12.5 mm.</p>
<p id="p-0076" num="0075">Likewise, when prescribing contact lenses, an optometrist can consider a refractive correction corresponding to the spectacle plane, and make a power adjustment to account for the difference between the spectacle plane and the corneal plane. In this case, the adjustment often depends on a vertex distance, corresponding to the distance between the posterior surface of the spectacle lens and the anterior surface of the cornea.</p>
<p id="p-0077" num="0076">Thus, given a measurement surface aberration, it is possible to derive a treatment surface aberration based on a difference between the treatment surface and the measurement surface. Often, the difference will be a vertex distance between the treatment surface and the measurement surface. As further discussed below, the treatment surface aberration can then be used to determine a refractive treatment shape. In the case of corrective spectacles, the refractive treatment shape can be a basis for a prescription for the patient, where the treatment shape corresponds to the spectacle plane or surface.</p>
<p id="p-0078" num="0077">Typically, the measurement surface aberration corresponds to a first power data, and the treatment surface aberration corresponds to a derived second power data. The second power data can be derived from the first power data and the distance between the measurement surface and the treatment. To achieve the effect of a power change, in terms of a vertex correction, a vertex distance measure can be based on a difference between the measurement surface and the treatment surface. The vertex correction represents a power change between the first power data and the second power data. In this sense, the derivation of the second power corresponds to a vertex correction of the first power. The vertex of a lens curve can be defined as the apex of the lens curve, or as the point on the lens curve in which the lens curve axis intersects it.</p>
<p id="p-0079" num="0078">a. Traditional (Non Wavefront)</p>
<p id="p-0080" num="0079">Traditional phoropters can be used to make traditional optical aberration measurements such as sphere and cylinder. Such aberration measurements are often expressed in terms of dioptric power. Referring again to <figref idref="DRAWINGS">FIG. 6</figref> legend (a), assuming the power corresponding to the second plane, e.g. a corneal plane, is S, and the power corresponding the first plane, e.g. a spectacle plane, is S′, it is possible to describe the relationship between the two powers with the following equations.</p>
<p id="p-0081" num="0080">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>S</mi>
          <mo>=</mo>
          <mfrac>
            <mn>1</mn>
            <mi>f</mi>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msup>
                <mi>S</mi>
                <mi>′</mi>
              </msup>
              <mo>=</mo>
              <mfrac>
                <mn>1</mn>
                <mrow>
                  <mi>f</mi>
                  <mo>+</mo>
                  <mi>d</mi>
                </mrow>
              </mfrac>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mfrac>
                <mi>S</mi>
                <mrow>
                  <mn>1</mn>
                  <mo>+</mo>
                  <mi>dS</mi>
                </mrow>
              </mfrac>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0082" num="0081">Power can be expressed in units of diopters. f represents the distance between the focal plane and the second plane, although here this term is not a factor in the relationship between the two power measurements S and S′. d represents the vertex distance between the first and second planes. Where a first plane treatment surface is disposed anterior to a second plane measurement surface, d will typically have a positive value. For example, for spectacle treatments, d can be about 0.0125 m, and for refractive surgery treatments, d can be about 0.0035 m. Conversely, where the first plane treatment shape is disposed posterior to a second plane measurement surface, d will typically have a negative value. For example, for intraocular lens treatments, d can be about −0.0005 m.</p>
<p id="p-0083" num="0082">Sphere is a low order aberration corresponding to defocus, and cylinder is a low order aberration corresponding to astigmatism. To consider a combination of sphere and cylinder powers, it is possible to replace S by (S+C) where C stands for cylinder power at the maximum meridian. Thus, cylinder at the spectacle plane can be represented by C′, where</p>
<p id="p-0084" num="0083">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>C</mi>
          <mi>′</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mi>S</mi>
              <mo>+</mo>
              <mi>C</mi>
            </mrow>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mrow>
                <mi>d</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>+</mo>
                    <mi>C</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mfrac>
          <mo>-</mo>
          <mrow>
            <msup>
              <mi>S</mi>
              <mi>′</mi>
            </msup>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0085" num="0084">These formulae can be used to calculate the power change associated with a vertex distance.</p>
<p id="p-0086" num="0085">b. Wavefront</p>
<p id="p-0087" num="0086">In addition to the traditional phoropter approaches discussed above, it is also possible to evaluate optical systems based on wavefront analysis. Wavefront analysis can be useful in evaluating low order and high order aberrations. Referring again to <figref idref="DRAWINGS">FIG. 6</figref>, it is possible to consider the first and second planes as associated with a general wavefront. The wavefront can begin at a virtual focal point corresponding to the focal plane, and propagate from plane two toward plane one. For each point along the wavefront surface, a local slope can be calculated. For example, the local slope can be the first derivative of the surface at a certain point. The local slope reflects a surface value at that point, as well as the surface values of the surrounding points. The local slope can be a direction-dependent vector. Because the wavefront local slopes are proportional to the local focal length, as the wavefront is propagated forward, the slope of the wavefront can be scaled by a factor of a such that:</p>
<p id="p-0088" num="0087">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>α</mi>
        <mo>=</mo>
        <mfrac>
          <mi>f</mi>
          <mrow>
            <mi>f</mi>
            <mo>+</mo>
            <mi>d</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>4</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where f is the focal length of the wavefront and d is the vertex distance. Here, the vertex distance can represent a difference between the measurement surface, or plane two, and the treatment surface, or plane one. Thus, by making an initial measurement of the wavefront at plane two, it is possible to calculate a new wavefront surface at plane where individual points on the new surface have a local curvature that is derived by the scaling factor as discussed above. In the exemplary optical system depicted by <figref idref="DRAWINGS">FIG. 6</figref> legend (b), the first plane can represent a corneal plane, the second plane can represent a pupil plane, and the focal plane can represent a retinal plane. If the treatment surface is anterior to the measurement surface, then the vertex distance is positive, and if the treatment surface is posterior to the measurement surface, then the vertex distance is negative. Similarly, for the myopia case, because the power is negative, the focal length could take a negative value. Generally a can have a positive value, as the absolute value of f is often much larger than d.
</p>
<p id="p-0089" num="0088">As discussed above, vertex correction can be used with traditional aberrometry approaches. It is also possible to use vertex correction with wavefront approaches. Here, W(x,y) represents the wavefront at the measurement plane and W′(x,y) represents the wavefront at the treatment plane with vertex distance of d. The local slope is assumed to be scaled, as discussed above. Thus, the following equations are partial derivatives of the corrected wavefront at the treatment plane.</p>
<p id="p-0090" num="0089">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mfrac>
            <mrow>
              <mo>∂</mo>
              <msup>
                <mi>W</mi>
                <mi>′</mi>
              </msup>
            </mrow>
            <mrow>
              <mo>∂</mo>
              <mi>x</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mi>f</mi>
              <mrow>
                <mi>f</mi>
                <mo>+</mo>
                <mi>d</mi>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mfrac>
              <mrow>
                <mo>∂</mo>
                <mi>W</mi>
              </mrow>
              <mrow>
                <mo>∂</mo>
                <mi>x</mi>
              </mrow>
            </mfrac>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mo>∂</mo>
              <msup>
                <mi>W</mi>
                <mi>′</mi>
              </msup>
            </mrow>
            <mrow>
              <mo>∂</mo>
              <mi>y</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mi>f</mi>
              <mrow>
                <mi>f</mi>
                <mo>+</mo>
                <mi>d</mi>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mfrac>
              <mrow>
                <mo>∂</mo>
                <mi>W</mi>
              </mrow>
              <mrow>
                <mo>∂</mo>
                <mi>y</mi>
              </mrow>
            </mfrac>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>5</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0091" num="0090">It can be demonstrated that the classical formula for vertex correction holds with the assumption that the local slopes can be scaled according to a scaling factor of f/(f+d). The following examples illustrate this principle with respect to (i) sphere, or defocus, (ii) cylinder, or astigmatism, (iii) coma, and (iv) spherical aberration. Wavefronts can be expressed in terms of polynomial equations. This equation is useful for the derivations that follow.</p>
<p id="p-0092" num="0091">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mfrac>
          <mrow>
            <msup>
              <mo>∂</mo>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <msup>
              <mi>W</mi>
              <mi>′</mi>
            </msup>
          </mrow>
          <mrow>
            <mo>∂</mo>
            <msup>
              <mi>r</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mfrac>
              <msup>
                <mi>x</mi>
                <mn>2</mn>
              </msup>
              <mrow>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
                <mo>+</mo>
                <msup>
                  <mi>y</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mfrac>
              <mrow>
                <msup>
                  <mo>∂</mo>
                  <mn>2</mn>
                </msup>
                <mo>⁢</mo>
                <msup>
                  <mi>W</mi>
                  <mi>′</mi>
                </msup>
              </mrow>
              <mrow>
                <mo>∂</mo>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mi>xy</mi>
              </mrow>
              <mrow>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
                <mo>+</mo>
                <msup>
                  <mi>y</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mfrac>
              <mrow>
                <msup>
                  <mo>∂</mo>
                  <mn>2</mn>
                </msup>
                <mo>⁢</mo>
                <msup>
                  <mi>W</mi>
                  <mi>′</mi>
                </msup>
              </mrow>
              <mrow>
                <mrow>
                  <mo>∂</mo>
                  <mi>x</mi>
                </mrow>
                <mo>⁢</mo>
                <mrow>
                  <mo>∂</mo>
                  <mi>y</mi>
                </mrow>
              </mrow>
            </mfrac>
          </mrow>
          <mo>+</mo>
          <mrow>
            <mfrac>
              <msup>
                <mi>y</mi>
                <mn>2</mn>
              </msup>
              <mrow>
                <msup>
                  <mi>x</mi>
                  <mn>2</mn>
                </msup>
                <mo>+</mo>
                <msup>
                  <mi>y</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <msup>
                    <mo>∂</mo>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>W</mi>
                    <mi>′</mi>
                  </msup>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msup>
                    <mi>y</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>6</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0093" num="0092">(i) Sphere</p>
<p id="p-0094" num="0093">In the following discussion, Zernike polynomials are used to represent the ocular aberrations. Starting with a sphere, where W(r)=c<sub>2</sub><sup>0</sup>√{square root over (3)}(2r<sup>2</sup>−1), corresponding to the wavefront at the second plane, the curvature of the converted wavefront W′(r) at the first plane can be expressed as</p>
<p id="p-0095" num="0094">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mfrac>
                <mrow>
                  <msup>
                    <mo>∂</mo>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>W</mi>
                    <mi>′</mi>
                  </msup>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msup>
                    <mi>r</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mrow>
                  <mfrac>
                    <msup>
                      <mi>x</mi>
                      <mn>2</mn>
                    </msup>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                  <mo>⁢</mo>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mo>∂</mo>
                        <mn>2</mn>
                      </msup>
                      <mo>⁢</mo>
                      <msup>
                        <mi>W</mi>
                        <mi>′</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mo>∂</mo>
                      <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                </mrow>
                <mo>+</mo>
                <mrow>
                  <mfrac>
                    <mrow>
                      <mn>2</mn>
                      <mo>⁢</mo>
                      <mi>xy</mi>
                    </mrow>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                  <mo>⁢</mo>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mo>∂</mo>
                        <mn>2</mn>
                      </msup>
                      <mo>⁢</mo>
                      <msup>
                        <mi>W</mi>
                        <mi>′</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mrow>
                        <mo>∂</mo>
                        <mi>x</mi>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo>∂</mo>
                        <mi>y</mi>
                      </mrow>
                    </mrow>
                  </mfrac>
                </mrow>
                <mo>+</mo>
                <mrow>
                  <mfrac>
                    <msup>
                      <mi>y</mi>
                      <mn>2</mn>
                    </msup>
                    <mrow>
                      <msup>
                        <mi>x</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                  <mo>⁢</mo>
                  <mfrac>
                    <mrow>
                      <msup>
                        <mo>∂</mo>
                        <mn>2</mn>
                      </msup>
                      <mo>⁢</mo>
                      <msup>
                        <mi>W</mi>
                        <mi>′</mi>
                      </msup>
                    </mrow>
                    <mrow>
                      <mo>∂</mo>
                      <msup>
                        <mi>y</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                  </mfrac>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mo>=</mo>
                <mi/>
                <mo>⁢</mo>
                <mrow>
                  <mn>4</mn>
                  <mo>⁢</mo>
                  <msqrt>
                    <mn>3</mn>
                  </msqrt>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>c</mi>
                    <mn>2</mn>
                    <mn>0</mn>
                  </msubsup>
                  <mo>⁢</mo>
                  <mfrac>
                    <mi>f</mi>
                    <mrow>
                      <mi>f</mi>
                      <mo>+</mo>
                      <mi>d</mi>
                    </mrow>
                  </mfrac>
                </mrow>
              </mrow>
              <mo>,</mo>
              <mi>or</mi>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mfrac>
            <mrow>
              <msup>
                <mo>∂</mo>
                <mn>2</mn>
              </msup>
              <mo>⁢</mo>
              <msup>
                <mi>W</mi>
                <mi>′</mi>
              </msup>
            </mrow>
            <mrow>
              <mo>∂</mo>
              <msup>
                <mi>r</mi>
                <mn>2</mn>
              </msup>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mn>4</mn>
            <mo>⁢</mo>
            <msqrt>
              <mn>3</mn>
            </msqrt>
            <mo>⁢</mo>
            <msubsup>
              <mi>c</mi>
              <mn>2</mn>
              <mn>0</mn>
            </msubsup>
            <mo>⁢</mo>
            <mfrac>
              <mi>f</mi>
              <mrow>
                <mi>f</mi>
                <mo>+</mo>
                <mi>d</mi>
              </mrow>
            </mfrac>
          </mrow>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where the curvature of the vertex corrected wavefront can be calculated using Equation (6). Here, r represents the normalized pupil radius with values from 0 to 1, x and y are the normalized values in x- and y-axis, f is the local focal length, or the reciprocal of local power, and c<sub>2</sub><sup>0 </sup>is the Zernike coefficient of defocus term. From the definition of power, we have
</p>
<p id="p-0096" num="0095">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mfrac>
            <mrow>
              <msup>
                <mo>∂</mo>
                <mn>2</mn>
              </msup>
              <mo>⁢</mo>
              <mi>W</mi>
            </mrow>
            <mrow>
              <mo>∂</mo>
              <msup>
                <mi>r</mi>
                <mn>2</mn>
              </msup>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mn>4</mn>
            <mo>⁢</mo>
            <msqrt>
              <mn>3</mn>
            </msqrt>
            <mo>⁢</mo>
            <msubsup>
              <mi>c</mi>
              <mn>2</mn>
              <mn>0</mn>
            </msubsup>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mi>S</mi>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mfrac>
                <mn>1</mn>
                <msup>
                  <mi>R</mi>
                  <mn>2</mn>
                </msup>
              </mfrac>
              <mo>⁢</mo>
              <mrow>
                <mfrac>
                  <mrow>
                    <msup>
                      <mo>∂</mo>
                      <mn>2</mn>
                    </msup>
                    <mo>⁢</mo>
                    <mi>W</mi>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <msup>
                      <mi>r</mi>
                      <mn>2</mn>
                    </msup>
                  </mrow>
                </mfrac>
                <mo>.</mo>
                <mstyle>
                  <mtext>
</mtext>
                </mstyle>
                <mo>⁢</mo>
                <msup>
                  <mi>S</mi>
                  <mi>′</mi>
                </msup>
              </mrow>
            </mrow>
            <mo>=</mo>
            <mrow>
              <mfrac>
                <mn>1</mn>
                <msup>
                  <mi>R</mi>
                  <mn>2</mn>
                </msup>
              </mfrac>
              <mo>⁢</mo>
              <mfrac>
                <mrow>
                  <msup>
                    <mo>∂</mo>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>W</mi>
                    <mi>′</mi>
                  </msup>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msup>
                    <mi>r</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>9</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
From Equations (8) and (9), we obtain the following formula
</p>
<p id="p-0097" num="0096">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>S</mi>
          <mi>′</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mfrac>
              <mi>f</mi>
              <mrow>
                <mi>f</mi>
                <mo>+</mo>
                <mi>d</mi>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>S</mi>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mi>S</mi>
              <mrow>
                <mn>1</mn>
                <mo>+</mo>
                <mi>Sd</mi>
              </mrow>
            </mfrac>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>10</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0098" num="0097">Equation (10) is the classical formula for vertex correction of pure sphere power, thus demonstrating that vertex correction can be effectively used in wavefront analysis.</p>
<p id="p-0099" num="0098">(ii) Cylinder</p>
<p id="p-0100" num="0099">In another example for astigmatism, W(r, θ)=c<sub>2</sub><sup>2 </sup>√{square root over (6)}r<sup>2 </sup>sin 2θ+c<sub>2</sub><sup>2</sup>√{square root over (6)}r<sup>2 </sup>cos 2θ corresponds to the wavefront at the second plane, a similar approach can be used to obtain the curvature of the corrected wavefront as</p>
<p id="p-0101" num="0100">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mfrac>
                <mrow>
                  <msup>
                    <mo>∂</mo>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>W</mi>
                    <mi>′</mi>
                  </msup>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msup>
                    <mi>r</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
              <mo>=</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mn>2</mn>
                      <mo>⁢</mo>
                      <msqrt>
                        <mn>6</mn>
                      </msqrt>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>c</mi>
                        <mn>2</mn>
                        <mrow>
                          <mo>-</mo>
                          <mn>2</mn>
                        </mrow>
                      </msubsup>
                      <mo>⁢</mo>
                      <mi>sin</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <mn>2</mn>
                      <mo>⁢</mo>
                      <mi>θ</mi>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <mn>2</mn>
                      <mo>⁢</mo>
                      <msqrt>
                        <mn>6</mn>
                      </msqrt>
                      <mo>⁢</mo>
                      <msubsup>
                        <mi>c</mi>
                        <mn>2</mn>
                        <mn>2</mn>
                      </msubsup>
                      <mo>⁢</mo>
                      <mi>cos</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <mn>2</mn>
                      <mo>⁢</mo>
                      <mi>θ</mi>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>⁢</mo>
                <mfrac>
                  <mi>f</mi>
                  <mrow>
                    <mi>f</mi>
                    <mo>+</mo>
                    <mi>d</mi>
                  </mrow>
                </mfrac>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mrow>
                    <msup>
                      <mo>∂</mo>
                      <mn>2</mn>
                    </msup>
                    <mo>⁢</mo>
                    <mi>W</mi>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <msup>
                      <mi>r</mi>
                      <mn>2</mn>
                    </msup>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <mi>f</mi>
                    <mrow>
                      <mi>f</mi>
                      <mo>+</mo>
                      <mi>d</mi>
                    </mrow>
                  </mfrac>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Denoting P′ and P as the curvatures of W′ (converted wavefront) and W (measured wavefront) respectively,
</p>
<p id="p-0102" num="0101">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msup>
                <mi>P</mi>
                <mi>′</mi>
              </msup>
              <mo>=</mo>
              <mrow>
                <mi>P</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mfrac>
                  <mi>f</mi>
                  <mrow>
                    <mi>f</mi>
                    <mo>+</mo>
                    <mi>d</mi>
                  </mrow>
                </mfrac>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mi>P</mi>
                  <mrow>
                    <mn>1</mn>
                    <mo>+</mo>
                    <mi>Pd</mi>
                  </mrow>
                </mfrac>
                <mo>.</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
By replacing P with S+C, it is possible to obtain the classical vertex correction for cylinder
</p>
<p id="p-0103" num="0102">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>C</mi>
          <mi>′</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mi>S</mi>
              <mo>+</mo>
              <mi>C</mi>
            </mrow>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mrow>
                <mi>d</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>+</mo>
                    <mi>C</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mfrac>
          <mo>-</mo>
          <mrow>
            <msup>
              <mi>S</mi>
              <mi>′</mi>
            </msup>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>13</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0104" num="0103">(iii) Coma</p>
<p id="p-0105" num="0104">In addition to the low order wavefront vertex corrections discussed above, it is also possible to use vertex correction with wavefront measurements that include high order aberrations. For example, horizontal coma can be expressed as W(r, θ)=√{square root over (8)}c<sub>3</sub><sup>1</sup>(3r<sup>3</sup>−2r)cos θ, again corresponding to the wavefront at the second plane. With an approach similar to that described above, it is possible to calculate the derivatives to x and to y and then calculate the curvature to r as</p>
<p id="p-0106" num="0105">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mfrac>
                <mrow>
                  <msup>
                    <mo>∂</mo>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>W</mi>
                    <mi>′</mi>
                  </msup>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msup>
                    <mi>r</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mi>f</mi>
                  <mrow>
                    <mi>f</mi>
                    <mo>+</mo>
                    <mi>d</mi>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <mn>18</mn>
                <mo>⁢</mo>
                <msqrt>
                  <mn>8</mn>
                </msqrt>
                <mo>⁢</mo>
                <msubsup>
                  <mi>c</mi>
                  <mn>3</mn>
                  <mn>1</mn>
                </msubsup>
                <mo>⁢</mo>
                <mi>x</mi>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mrow>
                    <msup>
                      <mo>∂</mo>
                      <mn>2</mn>
                    </msup>
                    <mo>⁢</mo>
                    <mi>W</mi>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <msup>
                      <mi>r</mi>
                      <mn>2</mn>
                    </msup>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <mi>f</mi>
                    <mrow>
                      <mi>f</mi>
                      <mo>+</mo>
                      <mi>d</mi>
                    </mrow>
                  </mfrac>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>14</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Denoting P′ and P as the curvatures of W′ (converted wavefront) and W (measured wavefront) respectively,
</p>
<p id="p-0107" num="0106">
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msup>
                <mi>P</mi>
                <mi>′</mi>
              </msup>
              <mo>=</mo>
              <mrow>
                <mi>P</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mfrac>
                  <mi>f</mi>
                  <mrow>
                    <mi>f</mi>
                    <mo>+</mo>
                    <mi>d</mi>
                  </mrow>
                </mfrac>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mi>P</mi>
                  <mrow>
                    <mn>1</mn>
                    <mo>+</mo>
                    <mi>Pd</mi>
                  </mrow>
                </mfrac>
                <mo>.</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>15</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0108" num="0107">(iv) Spherical Aberrations</p>
<p id="p-0109" num="0108">In another example, a spherical aberration can be expressed as W(r)=√{square root over (5)}c<sub>4</sub><sup>0</sup>(6r<sup>4</sup>−6r<sup>2</sup>+1). Again, with an approach similar to that described above, it is possible to calculate the derivatives to x and to y and then calculate the curvature to r to determine the curvature of the corrected wavefront as</p>
<p id="p-0110" num="0109">
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mfrac>
                <mrow>
                  <msup>
                    <mo>∂</mo>
                    <mn>2</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>W</mi>
                    <mi>′</mi>
                  </msup>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msup>
                    <mi>r</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mi>f</mi>
                  <mrow>
                    <mi>f</mi>
                    <mo>+</mo>
                    <mi>d</mi>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mn>72</mn>
                      <mo>⁢</mo>
                      <msup>
                        <mi>r</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                    <mo>-</mo>
                    <mn>12</mn>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>⁢</mo>
                <msqrt>
                  <mn>5</mn>
                </msqrt>
                <mo>⁢</mo>
                <msubsup>
                  <mi>c</mi>
                  <mn>4</mn>
                  <mn>0</mn>
                </msubsup>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mrow>
                    <msup>
                      <mo>∂</mo>
                      <mn>2</mn>
                    </msup>
                    <mo>⁢</mo>
                    <mi>W</mi>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <msup>
                      <mi>r</mi>
                      <mn>2</mn>
                    </msup>
                  </mrow>
                </mfrac>
                <mo>⁢</mo>
                <mrow>
                  <mfrac>
                    <mi>f</mi>
                    <mrow>
                      <mi>f</mi>
                      <mo>+</mo>
                      <mi>d</mi>
                    </mrow>
                  </mfrac>
                  <mo>.</mo>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>16</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Denoting P′ and P as the curvatures of W′ (converted wavefront) and W (measured wavefront) respectively,
</p>
<p id="p-0111" num="0110">
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <msup>
                <mi>P</mi>
                <mi>′</mi>
              </msup>
              <mo>=</mo>
              <mrow>
                <mi>P</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mfrac>
                  <mi>f</mi>
                  <mrow>
                    <mi>f</mi>
                    <mo>+</mo>
                    <mi>d</mi>
                  </mrow>
                </mfrac>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mrow>
                <mfrac>
                  <mi>P</mi>
                  <mrow>
                    <mn>1</mn>
                    <mo>+</mo>
                    <mi>Pd</mi>
                  </mrow>
                </mfrac>
                <mo>.</mo>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>17</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0112" num="0111">Therefore, for low order aberrations as well as for high order aberrations, it can be shown that by means of a slope scaling as applied in wavefront, it is possible to achieve the effect of power change as defined in a classical sense. Such approaches can be useful in determining treatment surface aberrations based on measurement surface aberrations.</p>
<p id="p-0113" num="0112">2. New Algorithm for Vertex Correction</p>
<p id="p-0114" num="0113">Treatment surface aberrations can also be determined based on various algorithmic approaches. In some embodiments, the treatment surface aberration is a treatment surface wavefront map. The treatment surface wavefront map can be derived at least in part by local slope scaling of a measurement surface wavefront map. For example, a treatment surface wavefront map can be derived at least in part by applying a scaling factor of 1/(1+Pd) to a slope of a measurement surface wavefront map, where P represents a local curvature of the measurement surface wavefront map and d represents a difference between a measurement surface and a treatment surface. For example, P can be based on a second derivative of the measurement surface wavefront map. P can also be based on a pupil radius of the eye. The following examples illustrate algorithmic approaches that incorporate such principles.</p>
<p id="p-0115" num="0114">a. Constant HOA</p>
<p id="p-0116" num="0115">This algorithm assumes that the average curvature for low order aberrations (LOA), as manifested by sphere and cylinder power terms, is affected by vertex distance change. High order aberrations (HOA) are considered as local irregularity add-ons to the mean curvature, and are not affected by vertex distance change. Thus, a total wavefront map can be separated into low order and high order portions as shown by the following formula
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i>(<i>x,y</i>)=<i>W</i><sub>L</sub>(<i>x,y</i>)+<i>W</i><sub>H</sub>(<i>x,y</i>).  (18)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0117" num="0116">For the low order portion, it is possible to obtain the sphere and cylinder power terms by means of a Zernike decomposition method
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>[<i>S,C]=ZD[W</i><sub>L</sub>(<i>x,y</i>)],  (19)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where S and C represent the sphere and cylinder power terms, respectively, and ZD represents a Zernike decomposition operator. The vertex corrected sphere S′ and cylinder C′ power terms can be obtained from the following formulae
</p>
<p id="p-0118" num="0117">
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msup>
            <mi>S</mi>
            <mi>′</mi>
          </msup>
          <mo>=</mo>
          <mfrac>
            <mi>S</mi>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mi>dS</mi>
            </mrow>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>20</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msup>
          <mi>C</mi>
          <mi>′</mi>
        </msup>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mi>S</mi>
              <mo>+</mo>
              <mi>C</mi>
            </mrow>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mrow>
                <mi>d</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>S</mi>
                    <mo>+</mo>
                    <mi>C</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mfrac>
          <mo>-</mo>
          <mrow>
            <msup>
              <mi>S</mi>
              <mi>′</mi>
            </msup>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>21</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0119" num="0118">The vertex corrected wavefront can then be obtained by adding the uncorrected high order portion of the original wavefront with the Zernike expansion operator applied to the corrected sphere S′ and cylinder C′ as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i>′(<i>x,y</i>)=<i>ZE</i>(<i>S′,C</i>′)+<i>W</i><sub>H</sub>(<i>x,y</i>),  (22)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where ZE stands for a Zernike expansion operator.
</p>
<p id="p-0120" num="0119">b. Varying HOA</p>
<p id="p-0121" num="0120">This algorithm segments the wavefront measurement into multiple portions, and is designed to have each portion of the corrected wavefront focused on or toward the focal point of the optical system, regardless of the wavefront shape. Thus, the local slope of each portion of the wavefront measurement can be scaled by a factor of f/(f+d) where f represents the local focal length and d represents the vertex distance. By applying the following algorithms, it is possible to obtain the vertex corrected wavefront:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0121">1. Calculate x- and y-gradient by the following algorithm:
        <ul id="ul0003" list-style="none">
            <li id="ul0003-0001" num="0122">Along the x axis:</li>
            <li id="ul0003-0002" num="0123">a. ∂W/∂x=[W(i, j+1)−W(i, j)]/dx if [i,j] lands on left edge</li>
            <li id="ul0003-0003" num="0124">b. ∂W/∂x=[W(i, j)−W(i, j−1)]/dx if [i,j] lands on right edge</li>
            <li id="ul0003-0004" num="0125">c. ∂W/∂x=[W(i, j +1)−W(i, j−1)]/2dx otherwise within pupil</li>
            <li id="ul0003-0005" num="0126">Along the y axis:</li>
            <li id="ul0003-0006" num="0127">d. ∂W/∂y=[W(i, j)−W(i+1, j)]/dy if [i,j] lands on upper edge</li>
            <li id="ul0003-0007" num="0128">e. ∂W/∂y=[W(i−1, j)−W(i, j)]/dy if [i,j] lands on lower edge</li>
            <li id="ul0003-0008" num="0129">f. ∂W/∂y=[W(i−1, j)−W(i+1, j)]/2dy otherwise within pupil</li>
            <li id="ul0003-0009" num="0130">If [i,j] is outside the pupil, the data is not considered.</li>
        </ul>
        </li>
        <li id="ul0002-0002" num="0131">2. Calculate local curvature P using this algorithm:</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0122" num="0132">
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mrow>
        <mi>a</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>Calculate</mi>
      </mrow>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <msup>
            <mo>∂</mo>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <msup>
            <mi>x</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
    </mrow>
    <mo>,</mo>
    <mrow>
      <mfrac>
        <mrow>
          <msup>
            <mo>∂</mo>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <msup>
            <mi>y</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>and</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <msup>
            <mo>∂</mo>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mrow>
            <mo>∂</mo>
            <mi>x</mi>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>∂</mo>
            <mi>y</mi>
          </mrow>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>from</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <mo>∂</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <mi>x</mi>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>and</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <mo>∂</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <mi>y</mi>
        </mrow>
      </mfrac>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00017-2" num="00017.2">
<math overflow="scroll">
  <mrow>
    <mi>using</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mi>algorithm</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>⁢</mo>
    <mn>1.</mn>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00017-3" num="00017.3">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mi>b</mi>
      <mo>.</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <msup>
            <mo>∂</mo>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <msup>
            <mi>r</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mfrac>
          <msup>
            <mi>x</mi>
            <mn>2</mn>
          </msup>
          <mrow>
            <msup>
              <mi>x</mi>
              <mn>2</mn>
            </msup>
            <mo>+</mo>
            <msup>
              <mi>y</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <msup>
              <mo>∂</mo>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <mi>W</mi>
          </mrow>
          <mrow>
            <mo>∂</mo>
            <msup>
              <mi>x</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mfrac>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <mi>xy</mi>
          </mrow>
          <mrow>
            <msup>
              <mi>x</mi>
              <mn>2</mn>
            </msup>
            <mo>+</mo>
            <msup>
              <mi>y</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <msup>
              <mo>∂</mo>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <mi>W</mi>
          </mrow>
          <mrow>
            <mrow>
              <mo>∂</mo>
              <mi>x</mi>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>∂</mo>
              <mi>y</mi>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
      <mo>+</mo>
      <mrow>
        <mfrac>
          <msup>
            <mi>y</mi>
            <mn>2</mn>
          </msup>
          <mrow>
            <msup>
              <mi>x</mi>
              <mn>2</mn>
            </msup>
            <mo>+</mo>
            <msup>
              <mi>y</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <msup>
              <mo>∂</mo>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <mi>W</mi>
          </mrow>
          <mrow>
            <mo>∂</mo>
            <msup>
              <mi>y</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
      </mrow>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00017-4" num="00017.4">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mrow>
        <mi>c</mi>
        <mo>.</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>Calculate</mi>
      </mrow>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>local</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>curvature</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>P</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <msup>
          <mi>R</mi>
          <mn>2</mn>
        </msup>
      </mfrac>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <msup>
            <mo>∂</mo>
            <mn>2</mn>
          </msup>
          <mo>⁢</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <msup>
            <mi>r</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>R</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>being</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>pupil</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.8em" height="0.8ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>radius</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
</math>
</maths>
<ul id="ul0004" list-style="none">
    <li id="ul0004-0001" num="0000">
    <ul id="ul0005" list-style="none">
        <li id="ul0005-0001" num="0133">3. Scale the wavefront local curvature with this algorithm:</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0123" num="0134">
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
  <mrow>
    <mfrac>
      <mrow>
        <mo>∂</mo>
        <msup>
          <mi>W</mi>
          <mi>′</mi>
        </msup>
      </mrow>
      <mrow>
        <mo>∂</mo>
        <mi>x</mi>
      </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>Pd</mi>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <mo>∂</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <mi>x</mi>
        </mrow>
      </mfrac>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00018-2" num="00018.2">
<math overflow="scroll">
  <mrow>
    <mfrac>
      <mrow>
        <mo>∂</mo>
        <msup>
          <mi>W</mi>
          <mi>′</mi>
        </msup>
      </mrow>
      <mrow>
        <mo>∂</mo>
        <mi>y</mi>
      </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <mrow>
          <mn>1</mn>
          <mo>+</mo>
          <mi>Pd</mi>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <mo>∂</mo>
          <mi>W</mi>
        </mrow>
        <mrow>
          <mo>∂</mo>
          <mi>y</mi>
        </mrow>
      </mfrac>
    </mrow>
  </mrow>
</math>
</maths>
<ul id="ul0006" list-style="none">
    <li id="ul0006-0001" num="0000">
    <ul id="ul0007" list-style="none">
        <li id="ul0007-0001" num="0135">4. Reconstruct the corrected wavefront W′(x,y) with this algorithm:
        <ul id="ul0008" list-style="none">
            <li id="ul0008-0001" num="0136">a. Calculate Fourier transform of ∂W′/∂x and ∂W′/∂y to get c<sub>u </sub>and c<sub>v</sub>, respectively.</li>
            <li id="ul0008-0002" num="0137">b. Multiply u with c<sub>u </sub>and v with c<sub>v </sub>and divide by u<sup>2</sup>+v<sup>2</sup>.</li>
            <li id="ul0008-0003" num="0138">c. Inverse Fourier transform to get W′(x,y).</li>
            <li id="ul0008-0004" num="0139">d. Calculate ∂W′/∂x and ∂W′/∂y using algorithm 1, adjusted with the edge being the entire frame as oppose to pupil edge.</li>
            <li id="ul0008-0005" num="0140">e. Replace ∂W′/∂x and ∂W′/∂y with values from step 3 within the pupil, leave values outside pupil untouched.</li>
            <li id="ul0008-0006" num="0141">f. Determine if a predefined criteria is met, or if a predetermined number of iterations have been completed. If not, go to step (a) and repeat through step (f).</li>
            <li id="ul0008-0007" num="0142">g. Provide an estimate of W′(x,y).</li>
        </ul>
        </li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0124" num="0143">A predefined criteria of step (f) could be, for example, the RMS error of the reconstructed wavefront based on a comparison between W′<sub>i </sub>and W′<sub>i−1</sub>, in the ith and (i−1)th iterations, respectively. Alternatively, other optical quality gauges may be used. In one embodiment, the predetermined number of iterations in step (f) is 10. As illustrated in the above algorithm, it is possible to derive a treatment surface wavefront map based on an iterative Fourier reconstruction algorithm. Thus the entire algorithm, steps 1 to 4, uses both Fourier reconstruction (step 4) and local slope scaling (step 3).</p>
<p id="p-0125" num="0144">The theory behind Fourier reconstruction can be described as follows. Suppose wavefront W(x,y) is expanded into Fourier series as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i>(<i>x,y</i>)=∫∫<i>c</i>(<i>u,v</i>) exp[<i>i</i>2π(<i>ux+vy</i>)]<i>dudv,</i>  (23)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where c(u, v) is the expansion coefficient. Taking partial derivative to x and y, respectively in the above equation, provides
</p>
<p id="p-0126" num="0145">
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <mfrac>
                  <mrow>
                    <mo>∂</mo>
                    <mrow>
                      <mi>W</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>x</mi>
                          <mo>,</mo>
                          <mi>y</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <mi>x</mi>
                  </mrow>
                </mfrac>
                <mo>=</mo>
                <mrow>
                  <mi>ⅈ2π</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>∫</mo>
                    <mrow>
                      <mo>∫</mo>
                      <mrow>
                        <mrow>
                          <mi>uc</mi>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mi>u</mi>
                              <mo>,</mo>
                              <mi>v</mi>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <mi>exp</mi>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>[</mo>
                            <mrow>
                              <mi>ⅈ2π</mi>
                              <mo>⁡</mo>
                              <mrow>
                                <mo>(</mo>
                                <mrow>
                                  <mi>ux</mi>
                                  <mo>+</mo>
                                  <mi>vy</mi>
                                </mrow>
                                <mo>)</mo>
                              </mrow>
                            </mrow>
                            <mo>]</mo>
                          </mrow>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <mo>ⅆ</mo>
                          <mi>u</mi>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <mo>ⅆ</mo>
                          <mi>v</mi>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mrow>
                <mfrac>
                  <mrow>
                    <mo>∂</mo>
                    <mrow>
                      <mi>W</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>x</mi>
                          <mo>,</mo>
                          <mi>y</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <mi>y</mi>
                  </mrow>
                </mfrac>
                <mo>=</mo>
                <mrow>
                  <mi>ⅈ2π</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <mo>∫</mo>
                    <mrow>
                      <mo>∫</mo>
                      <mrow>
                        <mrow>
                          <mi>vc</mi>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mrow>
                              <mi>u</mi>
                              <mo>,</mo>
                              <mi>v</mi>
                            </mrow>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <mi>exp</mi>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>[</mo>
                            <mrow>
                              <mi>ⅈ2π</mi>
                              <mo>⁡</mo>
                              <mrow>
                                <mo>(</mo>
                                <mrow>
                                  <mi>ux</mi>
                                  <mo>+</mo>
                                  <mi>vy</mi>
                                </mrow>
                                <mo>)</mo>
                              </mrow>
                            </mrow>
                            <mo>]</mo>
                          </mrow>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <mo>ⅆ</mo>
                          <mi>u</mi>
                        </mrow>
                        <mo>⁢</mo>
                        <mrow>
                          <mo>ⅆ</mo>
                          <mi>v</mi>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>24</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0127" num="0146">Denoting c<sub>u </sub>to be the Fourier transform of x-derivative of W(x,y) and c<sub>v </sub>to be the Fourier transform of y-derivative of W(x,y), provides</p>
<p id="p-0128" num="0147">
<maths id="MATH-US-00020" num="00020">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <mfrac>
                  <mrow>
                    <mo>∂</mo>
                    <mrow>
                      <mi>W</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>x</mi>
                          <mo>,</mo>
                          <mi>y</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <mi>x</mi>
                  </mrow>
                </mfrac>
                <mo>=</mo>
                <mrow>
                  <mo>∫</mo>
                  <mrow>
                    <mo>∫</mo>
                    <mrow>
                      <mrow>
                        <msub>
                          <mi>c</mi>
                          <mi>u</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>u</mi>
                            <mo>,</mo>
                            <mi>v</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>exp</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>[</mo>
                          <mrow>
                            <mi>ⅈ2π</mi>
                            <mo>⁡</mo>
                            <mrow>
                              <mo>(</mo>
                              <mrow>
                                <mi>ux</mi>
                                <mo>+</mo>
                                <mi>vy</mi>
                              </mrow>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                          <mo>]</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo>ⅆ</mo>
                        <mi>u</mi>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo>ⅆ</mo>
                        <mi>v</mi>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mrow>
                <mfrac>
                  <mrow>
                    <mo>∂</mo>
                    <mrow>
                      <mi>W</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>x</mi>
                          <mo>,</mo>
                          <mi>y</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mrow>
                    <mo>∂</mo>
                    <mi>y</mi>
                  </mrow>
                </mfrac>
                <mo>=</mo>
                <mrow>
                  <mo>∫</mo>
                  <mrow>
                    <mo>∫</mo>
                    <mrow>
                      <mrow>
                        <msub>
                          <mi>c</mi>
                          <mi>v</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mrow>
                            <mi>u</mi>
                            <mo>,</mo>
                            <mi>v</mi>
                          </mrow>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mi>exp</mi>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>[</mo>
                          <mrow>
                            <mi>ⅈ2π</mi>
                            <mo>⁡</mo>
                            <mrow>
                              <mo>(</mo>
                              <mrow>
                                <mi>ux</mi>
                                <mo>+</mo>
                                <mi>vy</mi>
                              </mrow>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                          <mo>]</mo>
                        </mrow>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo>ⅆ</mo>
                        <mi>u</mi>
                      </mrow>
                      <mo>⁢</mo>
                      <mrow>
                        <mo>ⅆ</mo>
                        <mi>v</mi>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>25</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Comparing these two sets of equations, provides
</p>
<p id="p-0129" num="0148">
<maths id="MATH-US-00021" num="00021">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mo>{</mo>
        <mtable>
          <mtr>
            <mtd>
              <mrow>
                <mrow>
                  <msub>
                    <mi>c</mi>
                    <mi>u</mi>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>u</mi>
                      <mo>,</mo>
                      <mi>v</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>ⅈ2</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>π</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>uc</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>u</mi>
                        <mo>,</mo>
                        <mi>v</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
          <mtr>
            <mtd>
              <mrow>
                <mrow>
                  <msub>
                    <mi>c</mi>
                    <mi>v</mi>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>u</mi>
                      <mo>,</mo>
                      <mi>v</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>=</mo>
                <mrow>
                  <mi>ⅈ2</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>π</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>vc</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>u</mi>
                        <mo>,</mo>
                        <mi>v</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mtd>
          </mtr>
        </mtable>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>26</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Combining these two equations with u multiplied in both sides of the first equation and v multiplied in both sides of the second equation, provides
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>uc</i><sub>u</sub>(<i>u,v</i>)+<i>vc</i><sub>v</sub>(<i>u,v</i>)=<i>i</i>2π(<i>u</i><sup>2</sup><i>+v</i><sup>2</sup>)<i>c</i>(<i>u,v</i>).  (27)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Therefore, the Fourier transform of wavefront can be obtained as
</p>
<p id="p-0130" num="0149">
<maths id="MATH-US-00022" num="00022">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>c</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>u</mi>
              <mo>,</mo>
              <mi>v</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mfrac>
              <mrow>
                <mi>i</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <mrow>
                      <msub>
                        <mi>uc</mi>
                        <mi>u</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>u</mi>
                          <mo>,</mo>
                          <mi>v</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>+</mo>
                    <mrow>
                      <msub>
                        <mi>vc</mi>
                        <mi>v</mi>
                      </msub>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>u</mi>
                          <mo>,</mo>
                          <mi>v</mi>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mrow>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mrow>
                  <mi>π</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <msup>
                        <mi>u</mi>
                        <mn>2</mn>
                      </msup>
                      <mo>+</mo>
                      <msup>
                        <mi>v</mi>
                        <mn>2</mn>
                      </msup>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mfrac>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>-</mo>
            <mrow>
              <mfrac>
                <mi>i</mi>
                <mrow>
                  <mn>2</mn>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>π</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <msup>
                          <mi>u</mi>
                          <mn>2</mn>
                        </msup>
                        <mo>+</mo>
                        <msup>
                          <mi>v</mi>
                          <mn>2</mn>
                        </msup>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mfrac>
              <mo>⁡</mo>
              <mrow>
                <mo>[</mo>
                <mrow>
                  <mrow>
                    <mi>u</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo>∫</mo>
                      <mrow>
                        <mo>∫</mo>
                        <mrow>
                          <mfrac>
                            <mrow>
                              <mo>∂</mo>
                              <mrow>
                                <mi>W</mi>
                                <mo>⁡</mo>
                                <mrow>
                                  <mo>(</mo>
                                  <mrow>
                                    <mi>x</mi>
                                    <mo>,</mo>
                                    <mi>y</mi>
                                  </mrow>
                                  <mo>)</mo>
                                </mrow>
                              </mrow>
                            </mrow>
                            <mrow>
                              <mo>∂</mo>
                              <mi>x</mi>
                            </mrow>
                          </mfrac>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.em" height="0.ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <mi>exp</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.em" height="0.ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <mrow>
                            <mo> </mo>
                            <mrow>
                              <mo>[</mo>
                              <mrow>
                                <mrow>
                                  <mo>-</mo>
                                  <mi>ⅈ2π</mi>
                                </mrow>
                                <mo>⁢</mo>
                                <mrow>
                                  <mo>(</mo>
                                  <mrow>
                                    <mi>ux</mi>
                                    <mo>+</mo>
                                    <mi>vy</mi>
                                  </mrow>
                                </mrow>
                              </mrow>
                            </mrow>
                            <mo>]</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>+</mo>
                  <mrow>
                    <mi>v</mi>
                    <mo>⁢</mo>
                    <mrow>
                      <mo>∫</mo>
                      <mrow>
                        <mo>∫</mo>
                        <mrow>
                          <mfrac>
                            <mrow>
                              <mo>∂</mo>
                              <mrow>
                                <mi>W</mi>
                                <mo>⁡</mo>
                                <mrow>
                                  <mo>(</mo>
                                  <mrow>
                                    <mi>x</mi>
                                    <mo>,</mo>
                                    <mi>y</mi>
                                  </mrow>
                                  <mo>)</mo>
                                </mrow>
                              </mrow>
                            </mrow>
                            <mrow>
                              <mo>∂</mo>
                              <mi>y</mi>
                            </mrow>
                          </mfrac>
                          <mo>⁢</mo>
                          <mrow>
                            <mi>exp</mi>
                            <mo>⁡</mo>
                            <mrow>
                              <mo>[</mo>
                              <mrow>
                                <mo>-</mo>
                                <mrow>
                                  <mi>ⅈ2π</mi>
                                  <mo>⁡</mo>
                                  <mrow>
                                    <mo>(</mo>
                                    <mrow>
                                      <mi>ux</mi>
                                      <mo>+</mo>
                                      <mi>vy</mi>
                                    </mrow>
                                    <mo>)</mo>
                                  </mrow>
                                </mrow>
                              </mrow>
                              <mo>]</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>]</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>28</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
Hence, taking an inverse Fourier transform, it is possible to obtain the wavefront as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>W</i>(<i>x,y</i>)=∫∫<i>c</i>(<i>u,v</i>) exp[<i>i</i>2π(<i>ux+vy</i>)]<i>dudv. </i>  (29)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
III. Refractive Treatment Shape
</p>
<p id="p-0131" num="0150">Once a treatment surface aberration has been derived by a method as described above, it is possible to determine a prescription or a refractive treatment shape based on the treatment surface aberration. For example, a prescription can be derived for ameliorating a vision condition in an eye of a patient. A refractive treatment shape can be determined based on the treatment surface aberration of the eye, and a refractive treatment shape can be embodied in any of a variety of corrective optical devices or procedures, including refractive laser surgery, spectacles, contact lenses, intraocular lenses, and the like.</p>
<p id="h-0008" num="0000">IV. Example: Evaluating Classical Formulas and New Algorithms</p>
<p id="p-0132" num="0151">In some embodiments, it is useful to evaluate the convergence of Fourier reconstruction used in the vertex correction algorithms discussed above. Such approaches are discussed in commonly owned patent application Ser. No. 10/601,048 filed Jun. 20, 2003, the entirety of which is hereby incorporated by reference. It is also useful to evaluate the accuracy of the varying high order aberration algorithm as compared to the classical formulas discussed above (i.e. sphere, sphere and cylinder). For example, one test is to show the comparison between the algorithmic approaches and the traditional approaches for myopic, hyperopic, and astigmatism cases. <figref idref="DRAWINGS">FIG. 7</figref> shows the comparison of vertex corrected sphere and cylinder using the varying high order aberration algorithm described above as compared to classical formulas (i.e. sphere, sphere and cylinder) for (a) hyperopia+3D; (b) myopia−3D; (c) astigmatism−2DS/−1.5DC. It is quite clear that the results are very good. Good results can be shown by a small error. For example, if the difference is less than 0.05D, or smaller than 2.5%, it can generally be considered good. For pure sphere cases (e.g. myopia and hyperopia), the error can be larger, due to coarse sampling of wavefront data in the calculation.</p>
<p id="p-0133" num="0152">For high order aberrations, it has been shown with two examples (i.e. coma, spherical aberrations) in theory that the vertex corrected wavefront follows the power relationship given by the classical formula of vertex correction. <figref idref="DRAWINGS">FIG. 8</figref> shows wavefront surface plots of a pre-vertex correction (left panel) and post-vertex correction (right panel) corresponding to a 12.5 mm vertex correction as accomplished by a varying high order aberration algorithm.</p>
<p id="p-0134" num="0153">In terms of the efficiency of a varying high order aberration algorithm, the following table shows the running time taken for such a vertex correction algorithm with respect to the number of iterations taken in the Fourier reconstruction, corresponding to step 4 of the algorithm, in a 1.13 GHz laptop computer. With 10 iterations, the algorithm can take more than 2 seconds in real time. Fortunately, this vertex correction may only be needed when a treatment table is generated, which in itself may take minutes. Treatment tables are files that can store commands for a laser to deliver individual laser pulses, in the context of a laser ablation treatment. For example, the commands can be for laser pulse duration and size.</p>
<p id="p-0135" num="0154">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="175pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry/>
<entry>Iterations</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="8">
<colspec colname="offset" colwidth="42pt" align="left"/>
<colspec colname="1" colwidth="28pt" align="center"/>
<colspec colname="2" colwidth="28pt" align="center"/>
<colspec colname="3" colwidth="21pt" align="center"/>
<colspec colname="4" colwidth="28pt" align="center"/>
<colspec colname="5" colwidth="21pt" align="center"/>
<colspec colname="6" colwidth="28pt" align="center"/>
<colspec colname="7" colwidth="21pt" align="center"/>
<tbody valign="top">
<row>
<entry/>
<entry>1</entry>
<entry>2</entry>
<entry>5</entry>
<entry>10</entry>
<entry>20</entry>
<entry>50</entry>
<entry>200</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="7" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="8">
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="28pt" align="center"/>
<colspec colname="3" colwidth="28pt" align="center"/>
<colspec colname="4" colwidth="21pt" align="center"/>
<colspec colname="5" colwidth="28pt" align="center"/>
<colspec colname="6" colwidth="21pt" align="center"/>
<colspec colname="7" colwidth="28pt" align="center"/>
<colspec colname="8" colwidth="21pt" align="center"/>
<tbody valign="top">
<row>
<entry>Time (s)</entry>
<entry>0.340</entry>
<entry>0.521</entry>
<entry>1.231</entry>
<entry>2.303</entry>
<entry>4.256</entry>
<entry>10.40</entry>
<entry>41.34</entry>
</row>
<row>
<entry namest="1" nameend="8" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0136" num="0155">Thus in one embodiment, as part of the algorithm, Fourier reconstruction can require about 10 iterations to achieve planned results given by 100-micron sampling rate.</p>
<p id="p-0137" num="0156">While the exemplary embodiments have been described in some detail, by way of example and for clarity of understanding, those of skill in the art will recognize that a variety of modification, adaptations, and changes may be employed. Hence, the scope of the present invention should be limited solely by the appending claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07296893-20071120-M00001.NB">
<img id="EMI-M00001" he="22.27mm" wi="76.20mm" file="US07296893-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07296893-20071120-M00002.NB">
<img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US07296893-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07296893-20071120-M00003.NB">
<img id="EMI-M00003" he="7.03mm" wi="76.20mm" file="US07296893-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07296893-20071120-M00004.NB">
<img id="EMI-M00004" he="14.48mm" wi="76.20mm" file="US07296893-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07296893-20071120-M00005.NB">
<img id="EMI-M00005" he="7.45mm" wi="76.20mm" file="US07296893-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07296893-20071120-M00006.NB">
<img id="EMI-M00006" he="23.62mm" wi="76.20mm" file="US07296893-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07296893-20071120-M00007.NB">
<img id="EMI-M00007" he="20.83mm" wi="76.20mm" file="US07296893-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07296893-20071120-M00008.NB">
<img id="EMI-M00008" he="7.03mm" wi="76.20mm" file="US07296893-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07296893-20071120-M00009.NB">
<img id="EMI-M00009" he="15.16mm" wi="76.20mm" file="US07296893-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07296893-20071120-M00010.NB">
<img id="EMI-M00010" he="13.80mm" wi="76.20mm" file="US07296893-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07296893-20071120-M00011.NB">
<img id="EMI-M00011" he="6.69mm" wi="76.20mm" file="US07296893-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07296893-20071120-M00012.NB">
<img id="EMI-M00012" he="15.16mm" wi="76.20mm" file="US07296893-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013" nb-file="US07296893-20071120-M00013.NB">
<img id="EMI-M00013" he="13.80mm" wi="76.20mm" file="US07296893-20071120-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US07296893-20071120-M00014.NB">
<img id="EMI-M00014" he="15.16mm" wi="76.20mm" file="US07296893-20071120-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US07296893-20071120-M00015.NB">
<img id="EMI-M00015" he="13.80mm" wi="76.20mm" file="US07296893-20071120-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016" nb-file="US07296893-20071120-M00016.NB">
<img id="EMI-M00016" he="14.48mm" wi="76.20mm" file="US07296893-20071120-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00017 MATH-US-00017-2 MATH-US-00017-3 MATH-US-00017-4" nb-file="US07296893-20071120-M00017.NB">
<img id="EMI-M00017" he="25.74mm" wi="76.20mm" file="US07296893-20071120-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00018 MATH-US-00018-2" nb-file="US07296893-20071120-M00018.NB">
<img id="EMI-M00018" he="13.80mm" wi="76.20mm" file="US07296893-20071120-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00019" nb-file="US07296893-20071120-M00019.NB">
<img id="EMI-M00019" he="14.14mm" wi="76.20mm" file="US07296893-20071120-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00020" nb-file="US07296893-20071120-M00020.NB">
<img id="EMI-M00020" he="14.14mm" wi="76.20mm" file="US07296893-20071120-M00020.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00021" nb-file="US07296893-20071120-M00021.NB">
<img id="EMI-M00021" he="7.45mm" wi="76.20mm" file="US07296893-20071120-M00021.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00022" nb-file="US07296893-20071120-M00022.NB">
<img id="EMI-M00022" he="20.83mm" wi="76.20mm" file="US07296893-20071120-M00022.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of determining a refractive treatment shape for ameliorating a vision condition in a patient, the method comprising:
<claim-text>a) measuring a wavefront aberration of an eye of the patient, the wavefront aberration corresponding to a measurement surface that is disposed at or near a pupil plane of the eye, in order to provide a measurement surface aberration comprising a measurement surface wavefront map;</claim-text>
<claim-text>b) deriving a treatment surface aberration of the eye, the treatment surface aberration corresponding to a treatment surface of the eye and comprising a treatment surface wavefront map derived at least in part by local slope scaling of the measurement surface wavefront map, the treatment surface aberration derived from the measurement surface aberration using a difference between the measurement surface and the treatment surface; and</claim-text>
<claim-text>c) determining the refractive treatment shape based on the treatment surface aberration of the eye.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the treatment surface is disposed at or near an anterior corneal surface of the eye.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the treatment surface corresponds to a spectacle plane of the eye.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the treatment surface is disposed posterior to a pupil plane of the eye.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the treatment surface wavefront map is derived at least in part by applying a scaling factor of 1/(1+Pd) to a slope of the measurement surface wavefront map, where P represents a local curvature of the measurement surface wavefront map and d represents a difference between the measurement surface and the treatment surface.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein P is based on a second derivative of the measurement surface wavefront map.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein P is based on a pupil radius of the eye.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the treatment surface wavefront map is derived according to an iterative Fourier reconstruction algorithm.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the iterative Fourier reconstruction algorithm comprises 10 iterations.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the measurement surface aberration reflects low order and high order aberrations of the eye of the patient.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein a difference between the measurement surface and a retinal surface of the eye corresponds to a first vertex measure, and a difference between the treatment surface and the retinal surface of the eye corresponds to a second vertex measure.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A method of ameliorating a vision condition in a patient, the method comprising:
<claim-text>a) measuring a wavefront aberration of an eye of the patient, the wavefront aberration corresponding to a measurement surface that is disposed at or near a pupil plane of the eye, in order to provide a measurement surface aberration, wherein the measurement surface aberration comprises low order and high order aberrations of the eye of the patient;</claim-text>
<claim-text>b) deriving a treatment surface aberration of the eye, the treatment surface aberration corresponding to a treatment surface of the eye, the treatment surface aberration derived from the measurement surface aberration using a difference between the measurement surface and the treatment surface;</claim-text>
<claim-text>c) determining a refractive treatment shape based on the treatment surface aberration of the eye; and</claim-text>
<claim-text>d) applying the refractive treatment shape to the eye of the patient to ameliorate the vision condition.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the treatment surface is disposed at or near an anterior corneal surface of the eye, and the refractive treatment shape is applied to the eye of the patient in a treatment modality selected from the group consisting of:
<claim-text>(i) ablating a corneal surface of the eye to provide a corneal surface shape that corresponds to the refractive treatment shape, and</claim-text>
<claim-text>(ii) providing the patient with a contact lens that has a shape that corresponds to the refractive treatment shape.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the treatment surface corresponds to a spectacle plane of the eye, and the refractive treatment shape is applied to the eye of the patient by providing the patient with a spectacle lens that has a shape that corresponds to the refractive treatment shape.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00012">claim 12</claim-ref>, wherein the treatment surface is disposed posterior to a pupil plane of the eye, and the refractive treatment shape is applied to the eye of the patient by providing the patient with an intra-ocular lens that has a shape that corresponds to the refractive treatment shape.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A system for generating a refractive treatment shape for ameliorating a vision condition in an eye of a patient, the system comprising:
<claim-text>a) an input module that accepts a measurement surface aberration, the measurement surface aberration based on a wavefront aberration the eye, the wavefront aberration corresponding to a measurement surface that is disposed at or near a pupil plane of the eye, wherein a difference between the measurement surface and a retinal surface of the eye corresponds to a first vertex measure;</claim-text>
<claim-text>b) a transformation module that derives a treatment surface aberration, the treatment surface aberration corresponding to a treatment surface of the eye, the treatment surface aberration derived from the measurement surface aberration using a difference between the measurement surface and the treatment surface, wherein a difference between the treatment surface and the retinal surface of the eye corresponds to a second vertex measure; and</claim-text>
<claim-text>c) an output module that generates the refractive treatment shape based on the treatment surface aberration.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The system of <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the treatment surface is disposed at or near an anterior corneal surface of the eye.</claim-text>
</claim>
</claims>
</us-patent-grant>
