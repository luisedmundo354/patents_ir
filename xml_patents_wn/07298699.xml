<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298699-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298699</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10426289</doc-number>
<date>20030430</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>982</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>26</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370232</main-classification>
</classification-national>
<invention-title id="d0e53">Rate-based integral control scheme for active queue management</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6690645</doc-number>
<kind>B1</kind>
<name>Aweya et al.</name>
<date>20040200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370230</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6788697</doc-number>
<kind>B1</kind>
<name>Aweya et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370412</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2002/0105908</doc-number>
<kind>A1</kind>
<name>Blumer et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370230</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0067878</doc-number>
<kind>A1</kind>
<name>Zboril</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370235</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00005">
<othercit>Aweya, J. et al., “A Control Theoretic Approach to Active Queue Management,” <i>Computer Networks</i>, vol. 36, Issue 2-3, Jul. 2001, pp. 203-235.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>Braden, D. et al., “Recommendation on Queue Management and Congestion Avoidance in the Internet,” <i>IETF RFC 2309</i>, Apr. 1998.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00007">
<othercit>Chait, Y et al., “Fixed and Adaptive Model-Based Controllers for Active Queue Management,” <i>Proc. American Control Conf., </i>Arlington, VA, Jun. 25-27, 2001, pp. 2981-2986.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>Cnodder, S.D. et al. “A Rate Based Red Mechanism,” <i>Proc. NOSSDAV 2000, </i>Chapel Hill, North Carolina, Jun. 26-28, 2000, pp. 602-609.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Feng, W. et al., “A Self-Configuring RED,” <i>Proc. IEEE INFOCOM'99, </i>1999, pp. 1320-1328.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Feng, W. et al., “BLUE: A New Class of Active Queue Management Algorithms”, <i>Technical Report </i>CSE-TR-387-99, Dept. of EECS, University of Michigan, Apr. 1999.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Floyd, S. et al., “Random Early Detection Gateway for Congestion Avoidance,” <i>IEEE/ACM Trans. Networking, </i>vol. 1, No. 4, Aug. 1993, pp. 397-413.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Hollot, C.V. et al., “A Control Theoretic Analysis of RED,” <i>Proc. IEEE INFOCOM 2001, </i>2001, pp. 1510-1519.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Hollot, C.V. et al., “On Designing Improved Controllers for AQM Routers Supporting TCP Flows,” <i>Proc. IEEE INFOCOM 2001, </i>2001, pp. 1726-1734.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Kharitonov, V.L. et al., “Robust Stability of Time-delay Systems,” <i>IEEE Trans. Automatic Control, </i>vol. 39, No. 12, Dec. 1994, pp. 2388-2397.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Kunniyur, S. et al., “End-to-end Congestion Control: Utility Functions, Random Losses and ECN Marks,” <i>Proc. IEEE INFOCOM'2000, </i>Tel Aviv, Israel, Mar. 2000, pp. 1323-1332.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>Misra, V. et al. “Fluid-based Analysis of a Network of AQM Routers Supporting TCP Flows with an Application to RED,” <i>Proc. ACM SIGCOMM 2000, </i>2000, pp. 151-160.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>Morris, R. et al., “Scalable TCP Congestion Control,” <i>Proc. IEEE INFOCOM 2000, </i>pp. 1176-1183.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>Ott, T.J. et al., “SRED: Stablized RED”, <i>Proc. IEEE INFOCOM'99, </i>NY, Mar. 21-25, 1999, pp. 1346-1355.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>Silva, G.J. et al., “New Results on the Synthesis of PID Controllers,” <i>IEEE Trans. Automatic Control, </i>vol. 47, No. 2, Feb. 2002, pp. 241-252.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Silva, G.J. et al., “Stabilization of Time Delay Systems,” <i>Proc. American Control Conf., </i>Chicago, Illinois, Jun. 2000, pp. 963-970.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Su, L. et al., “An Active Queue Management Scheme for Internet Congestion Control and its Application to Differentiated Services,” <i>Proc. ICCCN 2000, </i>Las Vegas, Nevada, Oct. 2000, pp. 62-68.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00022">
<othercit>Villamizar, C. et al., “High Performance TCP in ANSNET,” <i>ACM Computer Commun. Rev., </i>vol. 24, No. 5, Oct. 1995.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370231</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370232</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370236</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Montuno</last-name>
<first-name>Delfin</first-name>
<address>
<city>Kanata</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>CA</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Aweya</last-name>
<first-name>James</first-name>
<address>
<city>Kanata</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>CA</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ouellette</last-name>
<first-name>Michel</first-name>
<address>
<city>Plantagenet</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>CA</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Felske</last-name>
<first-name>Kent</first-name>
<address>
<city>Kanata</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>CA</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Ridout &amp; Maybee LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Nortel Networks Limited</orgname>
<role>03</role>
<address>
<city>St. Laurent</city>
<country>CA</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>To</last-name>
<first-name>Doris H.</first-name>
<department>2616</department>
</primary-examiner>
<assistant-examiner>
<last-name>Rose</last-name>
<first-name>Kerri M</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Disclosed is an Active Queue Management method and apparatus which uses traffic rate information for congestion control. Using a nonlinear fluid-flow model of Traffic Control Protocol, an integral controller in a closed loop configuration with gain settings characterized for stable operation allows a matching of the aggregate rate of the active TCP connections to the available capacity. Further disclosed is a method for calculation of the regime of gains for which stable operation of a given network obtains. This approach allows for capacity matching while maintaining minimal queue size and high link utilization.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="193.04mm" wi="161.37mm" file="US07298699-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="221.32mm" wi="143.34mm" orientation="landscape" file="US07298699-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="207.86mm" wi="126.24mm" orientation="landscape" file="US07298699-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="210.99mm" wi="163.07mm" orientation="landscape" file="US07298699-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="180.34mm" wi="151.38mm" orientation="landscape" file="US07298699-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="170.18mm" wi="101.43mm" file="US07298699-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="163.07mm" wi="147.49mm" orientation="landscape" file="US07298699-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="165.02mm" wi="152.82mm" orientation="landscape" file="US07298699-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="209.30mm" wi="135.38mm" file="US07298699-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="155.87mm" wi="136.40mm" file="US07298699-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="207.52mm" wi="164.42mm" file="US07298699-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates generally to network queue management, and more particularly to a technique for active queue management using integral control and rate-based information.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Congestion control in the Internet has primarily been the responsibility of the end-to-end congestion control mechanisms of TCP (Transmission Control Protocol). However, with the rapid growth of the Internet and the stringent requirements for quality of service (QoS) support, it has become clear that the Internet could not exclusively rely on the end hosts to perform the end-to-end congestion control. Mechanisms are needed in the intermediate network elements to complement the end hosts congestion control mechanisms. Recognizing this, the Internet Engineering Tasks Force (IETF) has advocated the deployment of active queue management (AQM) mechanisms at the intermediate network elements (routers, switches, etc.) as a means of congestion control.</p>
<p id="p-0004" num="0003">To perform AQM, the network elements are equipped with the means to detect incipient congestion and to signal the traffic sources before congestion actually occurs. AQM mechanisms allow the network elements to send explicit/implicit feedback of congestion to the end hosts by marking/dropping packets. The end hosts in turn react to the packet marking/dropping by reducing their data transmission rates. The main goals of AQM are to reduce the average queue lengths in the network elements and thereby decrease the end-to-end delay experienced by end user traffic, and maximize the utilization of network resources by reducing the packet loss that occurs when queues overflow.</p>
<p id="p-0005" num="0004">The traditional queue management mechanism is “drop tail” which is simple to implement and is widely deployed. With drop tail mechanism, packets are dropped only at buffer overflow at which point congestion signals are conveyed to the end hosts. This results in a significantly long time period between the instant when congestion occurs and the instant when the end hosts reduce their data transmission rates. During this time period, more packets may be sent by the end hosts which could be eventually dropped. Drop tail can lead to problematic global synchronization of the traffic sources (where the sources ramp their traffic rates and backoff at the same time) and periods of low link utilization.</p>
<p id="p-0006" num="0005">A number of AQM schemes have been proposed which use either queue size information for congestion control (so-called queue-based schemes) or traffic rate information (so-called rate-based schemes). Queue-based AQM schemes adapt their marking/dropping probabilities in a manner that depends on the queue size at the link. With small buffers they tend to perform poorly. For example, studies have shown that a technique such as RED (Random Early Detection) described by S. Floyd and V. Jacobson in “Random Early Detection Gateway for Congestion Avoidance,” <i>IEEE/ACM Trans. Networking</i>, Vol. 1, No. 4, August 1993, pp. 397-413 performs well only when the queuing capacity is greater than the bandwidth-delay product. Quite naturally the dependence of a queue-based scheme on queue size information for control will require that there be sufficient buffering for effective process tracking and control.</p>
<p id="p-0007" num="0006">Very small buffers tend to complicate the control problem in this case.</p>
<p id="p-0008" num="0007">A number of recent studies such as C. V. Hollot, V. Misra, D. Townsley, and W. B. Gong, “A Control Theoretic Analysis of RED,” <i>Proc. IEEE INFOCOM </i>2001, 2001, pp. 1510-1519, C. V. Hollot, V. Misra, D. Townsley, and W. B. Gong, “On Designing Improved Controllers for AQM Routers Supporting TCP Flows,” <i>Proc. IEEE INFOCOM </i>2001, 2001, pp. 1726-1734, Y. Chait, C. V. Hollot, and V. Misra, “Fixed and Adaptive Model-Based Controllers for Active Queue Management,” <i>Proc. American Control Conf</i>., Arlington, Va., June 25-27 2001, pp. 2981-2986, and V. Misra, W. B. Gong, and D. Townsley, “Fluid-based Analysis of a Network of AQM Routers Supporting TCP Flows with an Application to RED,” <i>Proc. ACM SIGCOMM </i>2000, 2000, pp. 151-160, have described queue-based AQM schemes which explicitly rely on dynamic modeling and feedback control principles. Central to these studies is the recognition that AQM schemes are essentially feedback control systems and that the principles of control theory can provide critical insight and guidance into the analysis and design of such schemes. The fluid flow analytical model of TCP described in “Fluid-based Analysis of a Network of AQM Routers Supporting TCP Flows with an Application to RED” by Misra et al. particularity expresses TCP dynamics in a form that allows control theoretic approaches to be applied for AQM design and analysis.</p>
<p id="p-0009" num="0008">In view of the foregoing, it would be desirable to provide a technique for network queue management which overcomes the above-described inadequacies and shortcomings.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">An object of the present invention is to provide an improved rate-based integral control scheme for active queue management.</p>
<p id="p-0011" num="0010">According to an aspect of the invention there is provided a method for controlling a data flow in a data network, starting with selecting a stable integral controller gain k<sub>i</sub>. Next measuring a data arrival rate R(n) at time n. Next, calculating a normalized error signal e(n), according to the relation
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>(<i>n</i>)=(<i>T</i>(<i>n</i>)−<i>R</i>(<i>n</i>))/<i>x, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where T(n) is an assigned capacity at time n, and x is a nominal packet size. Next, a mark/drop probability p(n) is computed according to the relation
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i>(<i>n</i>)=min { max [<i>p</i>(<i>n−</i>1)+<i>k</i><sub>i</sub><i>·Δt·e</i>(<i>n</i>),0<i>],p</i><sub>max</sub>}<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where Δt is the time interval between a (n−1)<sup>th </sup>and the n<sup>th </sup>computation, and 0&lt;p<sub>max</sub>≦1. Finally a packet mark/drop routine is executed based upon the calculated mark/drop probability p(n).
</p>
<p id="p-0012" num="0011">Conveniently, the data arrival rate may be filtered by use of an exponentially weighted moving average scheme according to the relation
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i>′(<i>n</i>)=(1−β)·<i>R</i>′(<i>n−</i>1)+β·<i>R</i>(<i>n</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0013" num="0012">where β is a filter gain parameter such that 0&lt;β&lt;1,</p>
<p id="p-0014" num="0013">R′(n−1) is the filtered data arrival rate at time n−1, and</p>
<p id="p-0015" num="0014">R′(n) is the desired filtered data arrival rate at time n.</p>
<p id="p-0016" num="0015">According to another aspect of the invention, preceding the packet/mark drop routine may be a bypassing routine involving the steps of testing the data arrival rate R(n) against a rate threshold T<sub>L</sub>; and if the data arrival rate R(n) is below or equal to the rate threshold T<sub>L </sub>then bypassing the step of executing a packet mark/drop routine.</p>
<p id="p-0017" num="0016">Conveniently, the packet mark/drop routine may be realized according to a random number generator mark/drop scheme.</p>
<p id="p-0018" num="0017">Also conveniently, the stable integral controller gain may be chosen from a pre-calculated regime of stable gains. A method for pre-calculating the regime may be as follows; starting with (1) obtaining for said network a value for said network a set of parameters k, d<sub>0</sub>, and τ, where k is a steady-state gain of said network, d<sub>0 </sub>is a time delay of said network, and τ is a time constant of said network. Next step (<b>2</b>) determining the root z<sub>1 </sub>in the interval</p>
<p id="p-0019" num="0018">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>0</mn>
          <mo>,</mo>
          <mfrac>
            <mi>π</mi>
            <mn>2</mn>
          </mfrac>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>of</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mrow>
        <mi>cot</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <msub>
            <mi>z</mi>
            <mn>1</mn>
          </msub>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mi>τ</mi>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <msub>
        <mi>z</mi>
        <mn>1</mn>
      </msub>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
and then computing the range of stable gains for k<sub>i </sub>for this particular network as
</p>
<p id="p-0020" num="0019">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mo>-</mo>
      <mfrac>
        <mi>τ</mi>
        <msubsup>
          <mi>kd</mi>
          <mn>0</mn>
          <mn>2</mn>
        </msubsup>
      </mfrac>
    </mrow>
    <mo>⁢</mo>
    <msub>
      <mi>z</mi>
      <mn>1</mn>
    </msub>
    <mo>⁢</mo>
    <msqrt>
      <mrow>
        <msubsup>
          <mi>z</mi>
          <mn>1</mn>
          <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <mfrac>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <msup>
            <mi>τ</mi>
            <mn>2</mn>
          </msup>
        </mfrac>
      </mrow>
    </msqrt>
  </mrow>
  <mo>&lt;</mo>
  <msub>
    <mi>k</mi>
    <mi>i</mi>
  </msub>
  <mo>&lt;</mo>
  <mn>0.</mn>
</mrow>
</math>
</maths>
</p>
<p id="p-0021" num="0020">In accordance with another other aspect of the present invention, there is provided an apparatus for controlling a data flow in a data network, the apparatus being configured according to the methods described above.</p>
<p id="p-0022" num="0021">In accordance with another aspect of the present invention, there is provided an article of manufacture carrying instructions for a method for controlling a data flow in a data network. In a separate aspect, there is provided a signal embodied in a carrier wave representing instructions for a method for controlling a data flow in a data network according to an integral control scheme.</p>
<p id="p-0023" num="0022">The present invention will now be described in more detail with reference to exemplary embodiments thereof as shown in the appended drawings. While the present invention is described below with reference to the preferred embodiments, it should be understood that the present invention is not limited thereto. Those of ordinary skill in the art having access to the teachings herein will recognize additional implementations, modifications, and embodiments, which are within the scope of the present invention as disclosed and claimed herein.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0024" num="0023">The invention will be further understood from the following detailed description of embodiments of the invention and accompanying drawings, in which:</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 1</figref> is a diagram of an Active Queue Management controller in an Intermediate Network Element according to an embodiment of the invention.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 2</figref> is a diagram of a closed loop control system according to an embodiment of the invention.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 3</figref> is a plot of a typical open loop response of the TCP/AQM plant according to an embodiment of the invention.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 4</figref> is a plot of the two terms in Equation (30) for a general system.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 5</figref> is a block diagram of a routine for determining the stable integral gains for a closed-loop TCP/AQM system according to an embodiment of the invention.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 6</figref> is a plot of an example of the real and imaginary parts of F*(jω) according to an example embodiment of the invention.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 7</figref> is a plot of the step response of an example Integral Controller according to <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 8</figref> is a block diagram of a mark/drop probability computation routine according to an embodiment of the invention.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram of a packet drop/mark routine according to an embodiment of the invention.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram of an overall control routine according to an embodiment of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0035" num="0034">A high level depiction of an implementation of the active queue management integral control scheme according to a possible embodiment is given in <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0036" num="0035">Users <b>100</b> communicate with End Network Elements <b>105</b> which pass packet data either directly or through Intermediate Network Elements <b>115</b>, to other End Network Elements <b>105</b>. End-to-end congestion control mechanisms under normal TCP (Transmission Control Protocol) rely upon Implicit/Explicit Feedback Signals <b>110</b>. Examples of Implicit/Explicit Feedback Signals <b>110</b> typically include duplicate TCP acknowledgement packets, timeouts, and marked packets.</p>
<p id="p-0037" num="0036">In order to meet the stringent requirements for Quality of Service (QoS) of users, and the increases in data volume with the rapid growth of the Internet, it is advantageous to provide congestion control mechanisms at intermediate points to complement the end hosts congestion control mechanisms. According to one aspect of the invention, Intermediate Network Element <b>115</b> has been equipped with such a mechanism for congestion control.</p>
<p id="p-0038" num="0037">Within Intermediate Network Element <b>115</b> are a Integral Controller <b>120</b>, a queue means <b>130</b>, an arrival rate measurement means <b>122</b>, a target rate measurement means <b>126</b>, a packet mark/drop module <b>128</b>, and a mark/drop probability control means <b>124</b> by which the Integral Controller <b>120</b> influences the packet mark/drop module <b>128</b> according to a scheme described hereafter.</p>
<p id="p-0039" num="0038">A control system oriented depiction of the system of <figref idref="DRAWINGS">FIG. 1</figref> may be seen in <figref idref="DRAWINGS">FIG. 2</figref> where the closed-loop system is represented as having two main elements; TCP/AQM plant <b>210</b> and the control-function means <b>220</b>. The control system functions by comparing a desired Target-Rate “T” <b>226</b> with an Actual-Rate “R” <b>222</b> via a summer <b>240</b> which generates a control error “e” <b>250</b> by determining the difference between the two rates. This difference is used as an input to the control-function means <b>220</b> which generates a mark/drop probability threshold “p” <b>224</b>. Changes in the threshold for marking or dropping packets results in an eventual change in the Actual-Rate “R” <b>222</b> as the effects propagate through the system. As with all closed loop systems, the control-function means <b>220</b> must have a control function response chosen so as to render a stable closed-loop system response. If this condition is not met the resultant performance will be deleterious to the network operation, possibly to the point of causing performance degradation.</p>
<p id="p-0040" num="0039">In order to be able to determine the stability requirements for the control-function means, the open loop transfer function for TCP/AQM plant <b>210</b> must be established. This may be done as follows.</p>
<p id="p-0041" num="0040">A simplified rate-based fluid-flow model of a TCP source i assessing a single link is described by the following nonlinear differential equation:</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mover>
              <mi>r</mi>
              <mo>.</mo>
            </mover>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>t</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mrow>
              <msubsup>
                <mi>d</mi>
                <mi>i</mi>
                <mn>2</mn>
              </msubsup>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mfrac>
          <mo>-</mo>
          <mrow>
            <mi>θ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>r</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>r</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>t</mi>
                  <mo>-</mo>
                  <mrow>
                    <msub>
                      <mi>d</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>t</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mi>p</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>t</mi>
                  <mo>-</mo>
                  <mrow>
                    <msub>
                      <mi>d</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>t</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where {dot over (r)} denotes the time-derivative of r, r<sub>i </sub>is rate of the TCP source (in packets per second), d<sub>i </sub>is the round-trip time (RTT) of the TCP source (in seconds), p is the marking/dropping probability of a TCP packet at the link, and θ is a parameter characteristic of the type of TCP source. This model of TCP ignores the slow-start and the timeout behavior of TCP. Note that r<sub>i </sub>and p are bounded, respectively, as follows; r<sub>i</sub>ε[0,C], pε[0,1], where C is the link capacity (in packets per second).
</p>
<p id="p-0043" num="0042">Denoting p<sub>0 </sub>as the steady-state (or operating point) of the marking/dropping probability of a TCP source and assuming a constant RTT d<sub>0</sub>, the steady-state throughput r<sub>0 </sub>can be obtained as</p>
<p id="p-0044" num="0043">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mn>0</mn>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msubsup>
              <mi>d</mi>
              <mn>0</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>-</mo>
          <mrow>
            <mi>θ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <msubsup>
              <mi>r</mi>
              <mn>0</mn>
              <mn>2</mn>
            </msubsup>
            <mo>⁢</mo>
            <msub>
              <mi>p</mi>
              <mn>0</mn>
            </msub>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>or</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>r</mi>
          <mn>0</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>d</mi>
              <mn>0</mn>
            </msub>
          </mfrac>
          <mo>⁢</mo>
          <mrow>
            <msqrt>
              <mfrac>
                <mn>1</mn>
                <mrow>
                  <mi>θ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>p</mi>
                    <mn>0</mn>
                  </msub>
                </mrow>
              </mfrac>
            </msqrt>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0045" num="0044">If the parameter θ takes on the value of ⅔, the steady-state throughput of TCP is obtained as</p>
<p id="p-0046" num="0045">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>r</mi>
    <mn>0</mn>
  </msub>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mn>1</mn>
      <msub>
        <mi>d</mi>
        <mn>0</mn>
      </msub>
    </mfrac>
    <mo>⁢</mo>
    <mrow>
      <msqrt>
        <mfrac>
          <mn>3</mn>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <msub>
              <mi>p</mi>
              <mn>0</mn>
            </msub>
          </mrow>
        </mfrac>
      </msqrt>
      <mo>.</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0047" num="0046">Making the approximation relating data transmission rate and window size
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>r</i><sub>i</sub>(<i>t</i>)≈<i>W</i><sub>i</sub>(<i>t</i>)/<i>d</i><sub>i</sub>(<i>t</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and assuming d<sub>i</sub>(t)=d<sub>i</sub>=constant, it obtains that
</p>
<p id="p-0048" num="0047">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mover>
          <mi>r</mi>
          <mo>.</mo>
        </mover>
        <mi>i</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>t</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
      <mfrac>
        <mo>ⅆ</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>t</mi>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>W</mi>
              <mi>i</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <mrow>
              <msub>
                <mi>d</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mrow>
        <mfrac>
          <mn>1</mn>
          <msub>
            <mi>d</mi>
            <mi>i</mi>
          </msub>
        </mfrac>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <mo>ⅆ</mo>
            <mrow>
              <msub>
                <mi>W</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mrow>
            <mo>ⅆ</mo>
            <mi>t</mi>
          </mrow>
        </mfrac>
      </mrow>
      <mo>-</mo>
      <mrow>
        <mfrac>
          <mrow>
            <msub>
              <mi>W</mi>
              <mi>i</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <msubsup>
            <mi>d</mi>
            <mi>i</mi>
            <mn>2</mn>
          </msubsup>
        </mfrac>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <mo>ⅆ</mo>
            <msub>
              <mi>d</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mrow>
            <mo>ⅆ</mo>
            <mi>t</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mrow>
    <mo>≈</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <msub>
          <mi>d</mi>
          <mi>i</mi>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <mrow>
        <mfrac>
          <mrow>
            <mo>ⅆ</mo>
            <mrow>
              <msub>
                <mi>W</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mrow>
            <mo>ⅆ</mo>
            <mi>t</mi>
          </mrow>
        </mfrac>
        <mo>.</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
With this, it can be seen that making the approximation r<sub>i</sub>(t)≈W<sub>i</sub>(t)/d<sub>i</sub>(t) shows that the rate-based fluid-flow model of a TCP source is essentially equivalent to a window-based nonlinear fluid-flow TCP model.
</p>
<p id="p-0049" num="0048">Assuming a constant RTT d<sub>0</sub>, rewrite the initial equation as</p>
<p id="p-0050" num="0049">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>f</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <msub>
                <mi>r</mi>
                <mi>i</mi>
              </msub>
              <mo>,</mo>
              <msub>
                <mi>r</mi>
                <mrow>
                  <mi>i</mi>
                  <mo>,</mo>
                  <mi>d</mi>
                </mrow>
              </msub>
              <mo>,</mo>
              <mi>p</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msub>
              <mover>
                <mi>r</mi>
                <mo>.</mo>
              </mover>
              <mi>i</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <msubsup>
                <mi>d</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
            </mfrac>
            <mo>-</mo>
            <mrow>
              <mi>θ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <msub>
                  <mi>r</mi>
                  <mi>i</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <msub>
                  <mi>r</mi>
                  <mrow>
                    <mi>i</mi>
                    <mo>,</mo>
                    <mi>d</mi>
                  </mrow>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <mi>p</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>d</mi>
                      <mn>0</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>2</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>r</i><sub>i,d</sub>(<i>t</i>){dot over (=)}<i>r</i><sub>i</sub>(<i>t−d</i><sub>0</sub>).<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0051" num="0050">Using Taylor series expansion, the small-signal linearization of
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>f</i>(<i>r</i><sub>i</sub><i>,r</i><sub>i,d</sub><i>,p</i>)=<i>{dot over (r)}</i><sub>i</sub>(<i>t</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
about an operating point (r<sub>0</sub>,p<sub>0</sub>) is given as
</p>
<p id="p-0052" num="0051">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mrow>
            <mrow>
              <mrow>
                <msub>
                  <mrow>
                    <mrow>
                      <mrow>
                        <mi>δ</mi>
                        <mo>⁢</mo>
                        <mrow>
                          <msub>
                            <mover>
                              <mi>r</mi>
                              <mo>.</mo>
                            </mover>
                            <mi>i</mi>
                          </msub>
                          <mo>⁡</mo>
                          <mrow>
                            <mo>(</mo>
                            <mi>t</mi>
                            <mo>)</mo>
                          </mrow>
                        </mrow>
                      </mrow>
                      <mo>=</mo>
                      <mrow>
                        <mrow>
                          <msub>
                            <mrow>
                              <mo> </mo>
                              <mfrac>
                                <mrow>
                                  <mo>∂</mo>
                                  <mi>f</mi>
                                </mrow>
                                <mrow>
                                  <mo>∂</mo>
                                  <msub>
                                    <mi>r</mi>
                                    <mi>i</mi>
                                  </msub>
                                </mrow>
                              </mfrac>
                              <mo></mo>
                            </mrow>
                            <mrow>
                              <msub>
                                <mi>r</mi>
                                <mn>0</mn>
                              </msub>
                              <mo>,</mo>
                              <msub>
                                <mi>p</mi>
                                <mn>0</mn>
                              </msub>
                            </mrow>
                          </msub>
                          <mo>⁢</mo>
                          <mi>δ</mi>
                          <mo>⁢</mo>
                          <mstyle>
                            <mspace width="0.3em" height="0.3ex"/>
                          </mstyle>
                          <mo>⁢</mo>
                          <mrow>
                            <msub>
                              <mi>r</mi>
                              <mi>i</mi>
                            </msub>
                            <mo>⁡</mo>
                            <mrow>
                              <mo>(</mo>
                              <mi>t</mi>
                              <mo>)</mo>
                            </mrow>
                          </mrow>
                        </mrow>
                        <mo>+</mo>
                        <mfrac>
                          <mrow>
                            <mo>∂</mo>
                            <mi>f</mi>
                          </mrow>
                          <mrow>
                            <mo>∂</mo>
                            <msub>
                              <mi>r</mi>
                              <mrow>
                                <mi>i</mi>
                                <mo>,</mo>
                                <mi>d</mi>
                              </mrow>
                            </msub>
                          </mrow>
                        </mfrac>
                      </mrow>
                    </mrow>
                    <mo></mo>
                  </mrow>
                  <mrow>
                    <msub>
                      <mi>r</mi>
                      <mn>0</mn>
                    </msub>
                    <mo>,</mo>
                    <msub>
                      <mi>p</mi>
                      <mn>0</mn>
                    </msub>
                  </mrow>
                </msub>
                <mo>⁢</mo>
                <mi>δ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <msub>
                    <mi>r</mi>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>d</mi>
                    </mrow>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>t</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>+</mo>
              <mfrac>
                <mrow>
                  <mo>∂</mo>
                  <mi>f</mi>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <mi>p</mi>
                </mrow>
              </mfrac>
            </mrow>
            <mo></mo>
          </mrow>
          <mrow>
            <msub>
              <mi>r</mi>
              <mn>0</mn>
            </msub>
            <mo>,</mo>
            <msub>
              <mi>p</mi>
              <mn>0</mn>
            </msub>
          </mrow>
        </msub>
        <mo>⁢</mo>
        <mi>δ</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mi>p</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>t</mi>
              <mo>-</mo>
              <msub>
                <mi>d</mi>
                <mn>0</mn>
              </msub>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>δ<i>r</i><sub>i</sub>(<i>t</i>)=<i>r</i><sub>i</sub>(<i>t</i>)−<i>r</i><sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>δ<i>r</i><sub>i,d</sub>(<i>t</i>)=<i>r</i><sub>i,d</sub>(<i>t</i>)−<i>r</i><sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>δ<i>p</i>(<i>t−d</i><sub>0</sub>)=<i>p</i>(<i>t−d</i><sub>0</sub>)−<i>p</i><sub>0 </sub><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and
</p>
<p id="p-0053" num="0052">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <msub>
    <mrow>
      <mrow>
        <msub>
          <mrow>
            <mrow>
              <msub>
                <mrow>
                  <mfrac>
                    <mrow>
                      <mo>∂</mo>
                      <mi>f</mi>
                    </mrow>
                    <mrow>
                      <mo>∂</mo>
                      <msub>
                        <mi>r</mi>
                        <mi>i</mi>
                      </msub>
                    </mrow>
                  </mfrac>
                  <mo></mo>
                </mrow>
                <mrow>
                  <msub>
                    <mi>r</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>,</mo>
                  <msub>
                    <mi>p</mi>
                    <mn>0</mn>
                  </msub>
                </mrow>
              </msub>
              <mo>=</mo>
              <mfrac>
                <mrow>
                  <mo>∂</mo>
                  <mi>f</mi>
                </mrow>
                <mrow>
                  <mo>∂</mo>
                  <msub>
                    <mi>r</mi>
                    <mrow>
                      <mi>i</mi>
                      <mo>,</mo>
                      <mi>d</mi>
                    </mrow>
                  </msub>
                </mrow>
              </mfrac>
            </mrow>
            <mo></mo>
          </mrow>
          <mrow>
            <msub>
              <mi>r</mi>
              <mn>0</mn>
            </msub>
            <mo>,</mo>
            <msub>
              <mi>p</mi>
              <mn>0</mn>
            </msub>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mi>θ</mi>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <msub>
            <mi>r</mi>
            <mn>0</mn>
          </msub>
          <mo>⁢</mo>
          <msub>
            <mi>p</mi>
            <mn>0</mn>
          </msub>
          <mo>⁢</mo>
          <mfrac>
            <mrow>
              <mo>∂</mo>
              <mi>f</mi>
            </mrow>
            <mrow>
              <mo>∂</mo>
              <mi>p</mi>
            </mrow>
          </mfrac>
        </mrow>
      </mrow>
      <mo></mo>
    </mrow>
    <mrow>
      <msub>
        <mi>r</mi>
        <mn>0</mn>
      </msub>
      <mo>,</mo>
      <msub>
        <mi>p</mi>
        <mn>0</mn>
      </msub>
    </mrow>
  </msub>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mo>-</mo>
      <mi>θ</mi>
    </mrow>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.3em" height="0.3ex"/>
    </mstyle>
    <mo>⁢</mo>
    <msubsup>
      <mi>r</mi>
      <mn>0</mn>
      <mn>2</mn>
    </msubsup>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0054" num="0053">The linearized equation (3) then becomes
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>δ<i>{dot over (r)}</i><sub>i</sub>(<i>t</i>)=−θ<i>r</i><sub>0</sub><i>p</i><sub>0</sub>(δ<i>r</i><sub>i</sub>(<i>t</i>)+δ<i>r</i><sub>i,d</sub>(<i>t</i>))−θ<i>r</i><sub>0</sub><sup>2</sup><i>δp</i>(<i>t−d</i><sub>0</sub>).  (4)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0055" num="0054">Making the approximation r<sub>i</sub>(t)≈r<sub>i,d</sub>(t) in (4), it follows that
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>δ<i>{dot over (r)}</i><sub>i</sub>(<i>t</i>)=−2<i>θr</i><sub>0</sub><i>p</i><sub>0</sub><i>δr</i><sub>i</sub>(<i>t</i>)−θ<i>r</i><sub>0</sub><sup>2</sup><i>δp</i>(<i>t−d</i><sub>0</sub>)  (5)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0056" num="0055">Assume that the link of capacity C is shared by a constant number N of TCP sources. The aggregate rate on the link R(t) is given by</p>
<p id="p-0057" num="0056">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <munderover>
            <mo>∑</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <msub>
              <mi>r</mi>
              <mi>i</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mi>R</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>6</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0058" num="0057">From (6), the equilibrium point of the system can be expressed as</p>
<p id="p-0059" num="0058">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>i</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>N</mi>
            </munderover>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <msub>
              <mi>r</mi>
              <mn>0</mn>
            </msub>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msub>
              <mi>R</mi>
              <mn>0</mn>
            </msub>
            <mo>=</mo>
            <mrow>
              <mi>ρ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>C</mi>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mi>or</mi>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>7</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>r</mi>
            <mn>0</mn>
          </msub>
          <mo>=</mo>
          <mfrac>
            <mrow>
              <mi>ρ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>C</mi>
            </mrow>
            <mi>N</mi>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>8</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where ρε(0,1] is a target utilization factor. From (1) and (8), the equilibrium point of the marking/dropping probability can be expressed as
</p>
<p id="p-0060" num="0059">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>p</mi>
          <mn>0</mn>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mrow>
              <msubsup>
                <mi>d</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
              <mo>⁢</mo>
              <mi>θ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msubsup>
                <mi>r</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <msup>
                <mi>N</mi>
                <mn>2</mn>
              </msup>
              <msup>
                <mrow>
                  <mi>θ</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <msub>
                        <mi>d</mi>
                        <mn>0</mn>
                      </msub>
                      <mo>⁢</mo>
                      <mi>ρ</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <mi>C</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mn>2</mn>
              </msup>
            </mfrac>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>9</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0061" num="0060">Defining δR(t)=R(t)−R<sub>0</sub>, it is known from (6) that</p>
<p id="p-0062" num="0061">
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>δ</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>R</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munderover>
            <mo>∑</mo>
            <mrow>
              <mi>i</mi>
              <mo>=</mo>
              <mn>1</mn>
            </mrow>
            <mi>N</mi>
          </munderover>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>r</mi>
                <mi>i</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>and</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>10</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mtable>
        <mtr>
          <mtd>
            <mrow>
              <mrow>
                <mi>δ</mi>
                <mo>⁢</mo>
                <mrow>
                  <mover>
                    <mi>R</mi>
                    <mo>.</mo>
                  </mover>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>t</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <munderover>
                  <mo>∑</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>=</mo>
                    <mn>1</mn>
                  </mrow>
                  <mi>N</mi>
                </munderover>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mi>δ</mi>
                  <mo>⁢</mo>
                  <mrow>
                    <msub>
                      <mover>
                        <mi>r</mi>
                        <mo>.</mo>
                      </mover>
                      <mi>i</mi>
                    </msub>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>t</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>θ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>r</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>⁢</mo>
                  <msub>
                    <mi>p</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>⁢</mo>
                  <mrow>
                    <munderover>
                      <mo>∑</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>N</mi>
                    </munderover>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>δ</mi>
                      <mo>⁢</mo>
                      <mstyle>
                        <mspace width="0.3em" height="0.3ex"/>
                      </mstyle>
                      <mo>⁢</mo>
                      <mrow>
                        <msub>
                          <mi>r</mi>
                          <mi>i</mi>
                        </msub>
                        <mo>⁡</mo>
                        <mrow>
                          <mo>(</mo>
                          <mi>t</mi>
                          <mo>)</mo>
                        </mrow>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <munderover>
                    <mo>∑</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>=</mo>
                      <mn>1</mn>
                    </mrow>
                    <mi>N</mi>
                  </munderover>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>θ</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msubsup>
                      <mi>r</mi>
                      <mn>0</mn>
                      <mn>2</mn>
                    </msubsup>
                    <mo>⁢</mo>
                    <mi>δ</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <mrow>
                      <mi>p</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mrow>
                          <mi>t</mi>
                          <mo>-</mo>
                          <msub>
                            <mi>d</mi>
                            <mn>0</mn>
                          </msub>
                        </mrow>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
        <mtr>
          <mtd>
            <mrow>
              <mo>=</mo>
              <mi/>
              <mo>⁢</mo>
              <mrow>
                <mrow>
                  <mrow>
                    <mo>-</mo>
                    <mn>2</mn>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>θ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>r</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>⁢</mo>
                  <msub>
                    <mi>p</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>⁢</mo>
                  <mi>δ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>R</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mi>t</mi>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <mi>N</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>θ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>r</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                  <mo>⁢</mo>
                  <mi>δ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>p</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>t</mi>
                        <mo>-</mo>
                        <msub>
                          <mi>d</mi>
                          <mn>0</mn>
                        </msub>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mtd>
        </mtr>
      </mtable>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>11</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0063" num="0062">Substituting the equilibrium points (r<sub>0</sub>,p<sub>0</sub>) in (11), it follows that</p>
<p id="p-0064" num="0063">
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>δ</mi>
          <mo>⁢</mo>
          <mrow>
            <mover>
              <mi>R</mi>
              <mo>.</mo>
            </mover>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>t</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mrow>
              <mo>-</mo>
              <mfrac>
                <mrow>
                  <mn>2</mn>
                  <mo>⁢</mo>
                  <mi>N</mi>
                </mrow>
                <mrow>
                  <msubsup>
                    <mi>d</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                  <mo>⁢</mo>
                  <mi>ρ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>C</mi>
                </mrow>
              </mfrac>
            </mrow>
            <mo>⁢</mo>
            <mi>δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mi>R</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mi>θ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <msup>
                  <mi>ρ</mi>
                  <mn>2</mn>
                </msup>
                <mo>⁢</mo>
                <msup>
                  <mi>C</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
              <mi>N</mi>
            </mfrac>
            <mo>⁢</mo>
            <mi>δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mi>p</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>t</mi>
                  <mo>-</mo>
                  <msub>
                    <mi>d</mi>
                    <mn>0</mn>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.8em" height="0.8ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>or</mi>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>12</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mfrac>
              <mrow>
                <msubsup>
                  <mi>d</mi>
                  <mn>0</mn>
                  <mn>2</mn>
                </msubsup>
                <mo>⁢</mo>
                <mi>ρ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mi>C</mi>
              </mrow>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mi>N</mi>
              </mrow>
            </mfrac>
            <mo>⁢</mo>
            <mi>δ</mi>
            <mo>⁢</mo>
            <mrow>
              <mover>
                <mi>R</mi>
                <mo>.</mo>
              </mover>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>t</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mrow>
                <mo>-</mo>
                <mi>δ</mi>
              </mrow>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>R</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mfrac>
                <mrow>
                  <mi>θ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msubsup>
                    <mi>d</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>ρ</mi>
                    <mn>3</mn>
                  </msup>
                  <mo>⁢</mo>
                  <msup>
                    <mi>C</mi>
                    <mn>3</mn>
                  </msup>
                </mrow>
                <mrow>
                  <mn>2</mn>
                  <mo>⁢</mo>
                  <msup>
                    <mi>N</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
              </mfrac>
              <mo>⁢</mo>
              <mi>δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>p</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>t</mi>
                    <mo>-</mo>
                    <msub>
                      <mi>d</mi>
                      <mn>0</mn>
                    </msub>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mi>τ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mover>
                  <mi>R</mi>
                  <mo>.</mo>
                </mover>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mo>+</mo>
            <mrow>
              <mi>δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mrow>
                <mi>R</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>t</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>-</mo>
              <mi>k</mi>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mi>p</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>t</mi>
                  <mo>-</mo>
                  <msub>
                    <mi>d</mi>
                    <mn>0</mn>
                  </msub>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>13</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where
</p>
<p id="p-0065" num="0064">
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
  <mi>τ</mi>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mfrac>
        <mrow>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <mo>⁢</mo>
          <mi>ρ</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>C</mi>
        </mrow>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mi>N</mi>
        </mrow>
      </mfrac>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>and</mi>
      <mo>⁢</mo>
      <mstyle>
        <mspace width="0.8em" height="0.8ex"/>
      </mstyle>
      <mo>⁢</mo>
      <mi>k</mi>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mi>θ</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <mo>⁢</mo>
          <msup>
            <mi>ρ</mi>
            <mn>3</mn>
          </msup>
          <mo>⁢</mo>
          <msup>
            <mi>C</mi>
            <mn>3</mn>
          </msup>
        </mrow>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <msup>
            <mi>N</mi>
            <mn>2</mn>
          </msup>
        </mrow>
      </mfrac>
      <mo>.</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0066" num="0065">Taking the Laplace transform of (13) it obtains that
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>τ<i>s</i><img id="CUSTOM-CHARACTER-00001" he="2.79mm" wi="3.13mm" file="US07298699-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/>(<i>s</i>)+<img id="CUSTOM-CHARACTER-00002" he="2.79mm" wi="3.13mm" file="US07298699-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/>(<i>s</i>)=−<i>ke</i><sup>−d</sup><sup><sub2>0</sub2></sup><sup>s</sup><i>P</i>(<i>s</i>),  (14)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where <img id="CUSTOM-CHARACTER-00003" he="2.79mm" wi="3.13mm" file="US07298699-20071120-P00001.TIF" alt="custom character" img-content="character" img-format="tif"/>(s) is the Laplace transform of δR(t) and e<sup>−sd</sup><sup><sub2>0</sub2></sup>P(s) is the Laplace transform of δp(t−d<sub>0</sub>).
</p>
<p id="p-0067" num="0066">The open-loop transfer function of the TCP/AQM plant may be obtained from (14) as</p>
<p id="p-0068" num="0067">
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>G</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>s</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
                            <mo>⁢</mo>
              <mrow>
                <mo>(</mo>
                <mi>s</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mrow>
              <mi>P</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>s</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mo>-</mo>
                <msup>
                  <mi>ke</mi>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>d</mi>
                        <mn>0</mn>
                      </msub>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>s</mi>
                  </mrow>
                </msup>
              </mrow>
              <mrow>
                <mrow>
                  <mi>τ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>s</mi>
                </mrow>
                <mo>+</mo>
                <mn>1</mn>
              </mrow>
            </mfrac>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>15</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0069" num="0068">In (15), −k represents the steady-state (or static) gain of the TCP/AQM plant, d<sub>0 </sub>represents the time delay (or dead time), and τ represents the time constant of the plant.</p>
<p id="p-0070" num="0069">The step response of the model (15) is
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i>(<i>t</i>)=−<i>k</i>(1<i>−e</i><sup>−(t−d</sup><sup><sub2>0</sub2></sup><sup>)/τ</sup>).  (16)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0071" num="0070">From (16), it follows that the average residence time is</p>
<p id="p-0072" num="0071">
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>T</mi>
          <mi>av</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <msubsup>
                <mo>∫</mo>
                <mn>0</mn>
                <mi>∞</mi>
              </msubsup>
              <mo>⁢</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mi>R</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>∞</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                    <mo>-</mo>
                    <mrow>
                      <mi>R</mi>
                      <mo>⁡</mo>
                      <mrow>
                        <mo>(</mo>
                        <mi>t</mi>
                        <mo>)</mo>
                      </mrow>
                    </mrow>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.2em" height="0.2ex"/>
                </mstyle>
                <mo>⁢</mo>
                <mrow>
                  <mo>ⅆ</mo>
                  <mi>t</mi>
                </mrow>
              </mrow>
            </mrow>
            <mrow>
              <mo>-</mo>
              <mi>k</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mi>τ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msup>
                <mi>e</mi>
                <mrow>
                  <msub>
                    <mi>d</mi>
                    <mn>0</mn>
                  </msub>
                  <mo>⁢</mo>
                  <mstyle>
                    <mtext>/</mtext>
                  </mstyle>
                  <mo>⁢</mo>
                  <mi>τ</mi>
                </mrow>
              </msup>
            </mrow>
            <mo>≈</mo>
            <mrow>
              <msub>
                <mi>d</mi>
                <mn>0</mn>
              </msub>
              <mo>+</mo>
              <mi>τ</mi>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>17</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0073" num="0072">The ratio</p>
<p id="p-0074" num="0073">
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>η</mi>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <msub>
              <mi>d</mi>
              <mn>0</mn>
            </msub>
            <mrow>
              <msub>
                <mi>d</mi>
                <mn>0</mn>
              </msub>
              <mo>+</mo>
              <mi>τ</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mfrac>
            <msub>
              <mi>d</mi>
              <mn>0</mn>
            </msub>
            <msub>
              <mi>T</mi>
              <mi>av</mi>
            </msub>
          </mfrac>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>18</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
is called the normalized dead time and has the property 0≦η≦1. This quantity can be used to characterize the difficulty of controlling a process. It is sometimes called the controllability ratio. It has been observed that processes with small η are easy to control and that the difficulty in controlling the system increases as η increases. The parameters in the model (15) are represented graphically in <figref idref="DRAWINGS">FIG. 3</figref>. The parameter −k′ is simply the gain corresponding to the time distance d<sub>0</sub>+τ.
</p>
<p id="p-0075" num="0074">The goal of the control system is to mark/drop packets such that the aggregate rate of the active TCP connections will match the available capacity while at the same time maintain minimal queue size and high link utilization. Having established an expression for the open loop transfer function for TCP/AQM plant <b>210</b>, it is now possible to consider an expression for the system as a whole.</p>
<p id="p-0076" num="0075">Returning to <figref idref="DRAWINGS">FIG. 2</figref> and noting again that Target-Rate “T” <b>226</b> is the control target, Actual-Rate “R” <b>222</b> is the output of the plant (actual traffic arrival rate), mark/drop probability threshold “p” <b>224</b> is the control input, TCP/AQM plant <b>210</b> given by (15) as the plant to be controlled, and C(s), the control-function means <b>220</b> is to be a integral controller.</p>
<p id="p-0077" num="0076">The Laplace expression for the case of a integral controller may be written as,</p>
<p id="p-0078" num="0077">
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mi>C</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>s</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mfrac>
            <msub>
              <mi>k</mi>
              <mi>i</mi>
            </msub>
            <mi>s</mi>
          </mfrac>
        </mrow>
        <mo>,</mo>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>19</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where k<sub>i </sub>is integral gain of the controller.
</p>
<p id="p-0079" num="0078">The closed-loop transfer function of the TCP/AQM plant is then given as</p>
<p id="p-0080" num="0079">
<maths id="MATH-US-00020" num="00020">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>G</mi>
            <mi>AQM</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>s</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mrow>
                <mi>C</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>s</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <mi>G</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>s</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
            <mrow>
              <mn>1</mn>
              <mo>+</mo>
              <mrow>
                <mrow>
                  <mi>C</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>⁢</mo>
                <mrow>
                  <mi>G</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>s</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mrow>
            <mfrac>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <msub>
                    <mi>kk</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
                <mo>⁢</mo>
                <msup>
                  <mi>e</mi>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <msub>
                        <mi>d</mi>
                        <mn>0</mn>
                      </msub>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>s</mi>
                  </mrow>
                </msup>
              </mrow>
              <mrow>
                <mrow>
                  <mi>τ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msup>
                    <mi>s</mi>
                    <mn>2</mn>
                  </msup>
                </mrow>
                <mo>+</mo>
                <mi>s</mi>
                <mo>-</mo>
                <mrow>
                  <msub>
                    <mi>kk</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>⁢</mo>
                  <msup>
                    <mi>e</mi>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <msub>
                          <mi>d</mi>
                          <mn>0</mn>
                        </msub>
                      </mrow>
                      <mo>⁢</mo>
                      <mi>s</mi>
                    </mrow>
                  </msup>
                </mrow>
              </mrow>
            </mfrac>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>20</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0081" num="0080">The objective now is to determine the values of the parameter k<sub>i </sub>for which the closed-loop system is stable.</p>
<p id="p-0082" num="0081">Using an extension of the Hermite-Biehler Theorem applicable to quasipolynomials a detailed analytical characterization of the stabilizing feedback gains of the closed-loop TCP/AQM system may be performed as follows.</p>
<p id="p-0083" num="0082">The characteristic equation of a control system with time delay can be expressed in the general form as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>(<i>s</i>)=<i>d</i>(<i>s</i>)+<i>e</i><sup>−sT</sup><sup><sub2>1</sub2></sup><i>n</i><sub>1</sub>(<i>s</i>)+<i>e</i><sup>−sT</sup><sup><sub2>2</sub2></sup><i>n</i><sub>2</sub>(<i>s</i>)+ . . . +<i>e</i><sup>sT</sup><sup><sub2>m</sub2></sup><i>n</i><sub>m</sub>(<i>s</i>),  (21)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where d(s), n<sub>i</sub>(s) for i=1,2, . . . , m, are polynomials with real coefficients.
</p>
<p id="p-0084" num="0083">Characteristic equations of the form (21) are also referred to as quasipolynomials. It can be shown that the so-called Hermite-Biehler Theorem for Hurwitz polynomials does not carry over to arbitrary functions f(s) of the complex variable s. However, a suitable extension of the Hermite-Biehler Theorem can be developed to study the stability of certain classes of quasipolynomials characterized as follows.</p>
<p id="p-0085" num="0084">If the following assumptions are made in (21)
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>A</i>1:deg[<i>d</i>(<i>s</i>)]=<i>n </i>and deg[<i>n</i><sub>i</sub>(<i>s</i>)]≦<i>n </i>for <i>i=</i>1,2<i>, . . . , m; </i><?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>A2:0&lt;T<sub>1</sub>&lt;T<sub>2</sub>&lt; . . . &lt;T<sub>m</sub>,<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
then instead of (21), one can consider the quasipolynomial
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>*(<i>s</i>)=<i>e</i><sup>sT</sup><sup><sub2>m</sub2></sup><i>F</i>(<i>s</i>)=<i>e</i><sup>sT</sup><sup><sub2>m</sub2></sup><i>d</i>(<i>s</i>)+<i>e</i><sup>s(T</sup><sup><sub2>m</sub2></sup><sup>−T</sup><sup><sub2>1</sub2></sup><sup>)</sup><i>n</i><sub>1</sub>(<i>s</i>)+<i>e</i><sup>s(T</sup><sup><sub2>m</sub2></sup><sup>−T</sup><sup><sub2>2</sub2></sup><sup>)</sup><i>n</i><sub>2</sub>(<i>s</i>)+ . . . +<i>n</i><sub>m</sub>(<i>s</i>).  (22)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0086" num="0085">Since e<sup>sT</sup><sup><sub2>m </sub2></sup>does not have any finite roots, the roots of F(s) are identical to those of F*(s). The quasipolynomial F*(s), however, has a principal term, i.e., the coefficient of the term containing the highest powers of s and e<sup>s </sup>is nonzero. It then follows that this quasipolynomial is either of the delay (i.e., retarded) or of the neutral type. From this, it follows that the stability of the system with characteristic equation (21) is equivalent to the condition that all the roots of F*(s) be in the open left-half plane. Equivalently, it can be stated that F*(s) is Hurwitz or stable. The theorem below gives necessary and sufficient conditions for the stability of F*(s):</p>
<p id="p-0087" num="0086">Theorem 1: Let F*(s) be given by (22), and write
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>*(<i>j</i>ω)=<i>F</i><sub>r</sub>(ω)+<i>jF</i><sub>i</sub>(ω)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0088" num="0087">where F<sub>r</sub>(ω) and F<sub>i</sub>(ω) represent the real and imaginary parts of F*(s), respectively. Under assumptions A1 and A2, F*(s) is stable if and only if</p>
<p id="p-0089" num="0088">1) F<sub>r</sub>(ω) and F<sub>i</sub>(ω) have only simple real roots and these interlace</p>
<p id="p-0090" num="0089">2) {dot over (F)}<sub>i</sub>(ω<sub>0</sub>)F<sub>r</sub>(ω<sub>0</sub>)−{dot over (F)}<sub>r</sub>(ω<sub>0</sub>){dot over (F)}<sub>r</sub>(ω<sub>0</sub>)&gt;0, for some ω<sub>0 </sub>in (−∞,∞);
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0090">where {dot over (F)}<sub>r</sub>(ω) and {dot over (F)}<sub>i</sub>(ω) denote the first derivative with respect to ω of F<sub>r</sub>(ω) and F<sub>i</sub>(ω), respectively.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0091" num="0091">Using this theorem the set of all integral gains that stabilize the first-order TCP/AQM plant with time delay described by (15) may be characterized. A key step in applying Theorem 1 to check stability is to ensure that F<sub>r</sub>(ω) and F<sub>i</sub>(ω) have only real roots. Such a property can be ensured by using the following result:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0092">Theorem 2: Let M and L denote the highest powers of s and e<sup>s</sup>, respectively, in F*(s). Let η be an appropriate constant such that the coefficients of the terms of highest degree in F<sub>r</sub>(ω) and F<sub>i</sub>(ω) do not vanish at ω=η. Then for the equations F<sub>r</sub>(ω)=0 or F<sub>i</sub>(ω)=0 to have only real roots, it is necessary and sufficient that in the intervals
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>−2<i>l</i>π+η≦ω≦2<i>lπ+η,l=</i>1,2,3, . . .<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0092" num="0093">F<sub>r</sub>(ω) or F<sub>i</sub>(ω) have exactly 4lL+M real roots starting with a sufficiently large l.</p>
<p id="p-0093" num="0094">It is now possible to determine analytically the region in the k<sub>i </sub>parameter space for which the closed-loop TCP/AQM plant is stable.</p>
<p id="p-0094" num="0095">First analyze the system given by (20) without time delay, i.e., d<sub>0</sub>=0. In this case, the closed-loop characteristic equation of the system is given by
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>(<i>s</i>)=τ<i>s</i><sup>2</sup><i>+s−kk</i><sub>i</sub>.  (23)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0095" num="0096">For this second-order polynomial, it can be determined necessary and sufficient conditions that the controller and the plant parameters have to satisfy to guarantee the stability of the delay-free closed-loop system. Solving the characteristic equation (23) for the roots, it follows that</p>
<p id="p-0096" num="0097">
<maths id="MATH-US-00021" num="00021">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>s</mi>
          <mrow>
            <mn>1</mn>
            <mo>,</mo>
            <mn>2</mn>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mrow>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
              <mo>±</mo>
              <msqrt>
                <mrow>
                  <mn>1</mn>
                  <mo>+</mo>
                  <mrow>
                    <mn>4</mn>
                    <mo>⁢</mo>
                    <mi>τ</mi>
                    <mo>⁢</mo>
                    <mstyle>
                      <mspace width="0.3em" height="0.3ex"/>
                    </mstyle>
                    <mo>⁢</mo>
                    <msub>
                      <mi>kk</mi>
                      <mi>i</mi>
                    </msub>
                  </mrow>
                </mrow>
              </msqrt>
            </mrow>
            <mrow>
              <mn>2</mn>
              <mo>⁢</mo>
              <mi>τ</mi>
            </mrow>
          </mfrac>
          <mo>.</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>24</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0097" num="0098">Given that τ&gt;0 and k&gt;0 are always true for the TCP/AQM plant, the closed-loop delay-free system is stable for the following condition
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>k<sub>i</sub>&lt;0.  (25)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0098" num="0099">Next, let us consider the case where the time delay of the plant model is greater than zero, i.e., d<sub>0</sub>&gt;0. The closed-loop characteristic equation of the system is then
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>(<i>s</i>)=−<i>kk</i><sub>i</sub><i>e</i><sup>−d</sup><sup><sub2>0</sub2></sup><sup>s</sup>+(1<i>+τs</i>)<i>s.</i>  (26)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0099" num="0100">It is necessary to determine the set of all stabilizing gains for the system.</p>
<p id="p-0100" num="0101">In order to study the stability of the closed-loop system, it is necessary to determine if all the roots of (26) lie in the open left half plane. The presence of the exponential term e<sup>−d</sup><sup><sub2>0</sub2></sup><sup>s </sup>results in the number of roots of F(s) being infinite and this makes the stability check very difficult. However, Theorem 1 can be invoked to determine the set of all stabilizing gains k<sub>i</sub>. This procedure is explained as follows.</p>
<p id="p-0101" num="0102">First consider the quasipolynomial F*(s) defined by
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>*(<i>s</i>)=<i>e</i><sup>d</sup><sup><sub2>0</sub2></sup><sup>s</sup><i>F</i>(<i>s</i>)=−<i>kk</i><sub>i</sub>+(1<i>+τs</i>)<i>se</i><sup>d</sup><sup><sub2>0</sub2></sup><sup>s</sup>.  (27)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0102" num="0103">Substituting s=jω, and using the relationship e<sup>d</sup><sup><sub2>0</sub2></sup><sup>jω</sup>=cos(d<sub>0</sub>ω)+j sin(d<sub>0</sub>ω), the following expression results
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>*(<i>j</i>ω)=<i>F</i><sub>r</sub>(ω)+<i>jF</i><sub>i</sub>(ω)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>r</sub>(ω)=−<i>kk</i><sub>i</sub>−ω sin(<i>d</i><sub>0</sub>ω)−τω<sup>2 </sup>cos(<i>d</i><sub>0</sub>ω)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>i</sub>(ω)=ω[ cos(<i>d</i><sub>0</sub>ω)−τω sin(<i>d</i><sub>0</sub>ω)]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0103" num="0104">For convenience of analysis, make the following change of variables, z=d<sub>0</sub>ω. Thus, it is possible to rewrite the real and imaginary parts of F*(jω) as</p>
<p id="p-0104" num="0105">
<maths id="MATH-US-00022" num="00022">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>F</mi>
            <mi>r</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>z</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>-</mo>
            <msub>
              <mi>kk</mi>
              <mi>i</mi>
            </msub>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mfrac>
              <mn>1</mn>
              <msub>
                <mi>d</mi>
                <mn>0</mn>
              </msub>
            </mfrac>
            <mo>⁢</mo>
            <mi>z</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mi>sin</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>z</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mfrac>
              <mi>τ</mi>
              <msubsup>
                <mi>d</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
            </mfrac>
            <mo>⁢</mo>
            <msup>
              <mi>z</mi>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <mrow>
              <mi>cos</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>z</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>28</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>F</mi>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>z</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <msub>
              <mi>d</mi>
              <mn>0</mn>
            </msub>
          </mfrac>
          <mo>-</mo>
          <mrow>
            <mi>z</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mi>cos</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mi>z</mi>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>-</mo>
          <mrow>
            <mfrac>
              <mi>τ</mi>
              <msubsup>
                <mi>d</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
            </mfrac>
            <mo>⁢</mo>
            <msup>
              <mi>z</mi>
              <mn>2</mn>
            </msup>
            <mo>⁢</mo>
            <mrow>
              <mrow>
                <mi>sin</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>z</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>29</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0105" num="0106">Theorem 1 requires a check of two conditions to ensure the stability of the quasipolynomial F*(s).</p>
<p id="p-0106" num="0107">Check of Condition 2 of Theorem 1: First check if
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>E</i>(ω<sub>0</sub>)=<i>{dot over (F)}</i><sub>i</sub>(ω<sub>0</sub>)<i>F</i><sub>r</sub>(ω<sub>0</sub>)−<i>F</i><sub>i</sub>(ω<sub>0</sub>)<i>{dot over (F)}</i><sub>r</sub>(ω<sub>0</sub>)&gt;0<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
for some ω<sub>0 </sub>in (−∞,∞).
</p>
<p id="p-0107" num="0108">Taking ω<sub>0</sub>=z<sub>0</sub>=0, for instance, gives F<sub>r</sub>(z<sub>0</sub>)=−kk<sub>i </sub>and F<sub>i</sub>(z<sub>0</sub>)=0. Also obtained is
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>{dot over (F)}</i><sub>r</sub>(<i>z</i><sub>0</sub>)=0<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
and
</p>
<p id="p-0108" num="0109">
<maths id="MATH-US-00023" num="00023">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mover>
          <mi>F</mi>
          <mo>.</mo>
        </mover>
        <mi>i</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>z</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <msub>
                <mi>d</mi>
                <mn>0</mn>
              </msub>
              <mo>-</mo>
              <mrow>
                <mi>τ</mi>
                <mo>⁢</mo>
                <mstyle>
                  <mspace width="0.3em" height="0.3ex"/>
                </mstyle>
                <mo>⁢</mo>
                <msup>
                  <mi>z</mi>
                  <mn>2</mn>
                </msup>
              </mrow>
            </mrow>
            <msubsup>
              <mi>d</mi>
              <mn>0</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mi>cos</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>z</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mo>-</mo>
      <mrow>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mi>τ</mi>
              </mrow>
              <mo>+</mo>
              <msub>
                <mi>d</mi>
                <mn>0</mn>
              </msub>
            </mrow>
            <msubsup>
              <mi>d</mi>
              <mn>0</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mi>z</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mi>sin</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>z</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
  <mrow>
    <mrow>
      <mo>⇒</mo>
      <mrow>
        <msub>
          <mover>
            <mi>F</mi>
            <mo>.</mo>
          </mover>
          <mi>i</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <msub>
            <mi>z</mi>
            <mn>0</mn>
          </msub>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>.</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0109" num="0110">From these it may be seen that</p>
<p id="p-0110" num="0111">
<maths id="MATH-US-00024" num="00024">
<math overflow="scroll">
<mrow>
  <mrow>
    <mi>E</mi>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <msub>
        <mi>z</mi>
        <mn>0</mn>
      </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mo>(</mo>
      <mfrac>
        <mn>1</mn>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>)</mo>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo>-</mo>
          <msub>
            <mi>kk</mi>
            <mi>i</mi>
          </msub>
        </mrow>
        <mo>)</mo>
      </mrow>
      <mo>.</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0111" num="0112">Given that for the TCP/AQM plant the conditions τ&gt;0 and k&gt;0 hold true, it is required that F<sub>r</sub>(z<sub>0</sub>)=−kk<sub>i</sub>&gt;0 (i.e., k<sub>i</sub>&lt;0) for E(z<sub>0</sub>)&gt;0. This result is consistent with that given in (25).</p>
<p id="p-0112" num="0113">Check of Condition 1 of Theorem 1: Now check the interlacing of the roots of F<sub>r</sub>(z) and F<sub>i</sub>(z). The roots of the imaginary part, i.e., F<sub>i</sub>(z)=0 can be determined from (29). This yields</p>
<p id="p-0113" num="0114">
<maths id="MATH-US-00025" num="00025">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mi>z</mi>
      <msub>
        <mi>d</mi>
        <mn>0</mn>
      </msub>
    </mfrac>
    <mo>⁡</mo>
    <mrow>
      <mo>[</mo>
      <mrow>
        <mrow>
          <mi>cos</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>z</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
          <mfrac>
            <mi>τ</mi>
            <msub>
              <mi>d</mi>
              <mn>0</mn>
            </msub>
          </mfrac>
          <mo>⁢</mo>
          <mi>z</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>sin</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>z</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
      <mo>]</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mn>0.</mn>
</mrow>
</math>
</maths>
</p>
<p id="p-0114" num="0115">It may be seen from this equation that z=0 is a root of F<sub>i</sub>(z), or</p>
<p id="p-0115" num="0116">
<maths id="MATH-US-00026" num="00026">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>cot</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>z</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mi>τ</mi>
            <msub>
              <mi>d</mi>
              <mn>0</mn>
            </msub>
          </mfrac>
          <mo>⁢</mo>
          <mi>z</mi>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>30</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0116" num="0117">One root of the imaginary part F<sub>i</sub>(z) is z<sub>0</sub>=0 but the other roots are difficult to find and require an analytical solution of (30). However, a plot of the two terms in (30), (i.e., cot(z) and</p>
<p id="p-0117" num="0118">
<maths id="MATH-US-00027" num="00027">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mi>τ</mi>
      <msub>
        <mi>d</mi>
        <mn>0</mn>
      </msub>
    </mfrac>
    <mo>⁢</mo>
    <mi>z</mi>
  </mrow>
  <mo>)</mo>
</mrow>
</math>
</maths>
<br/>
can be used to understand the nature of the real solution. It is possible to plot these two terms for arbitrarily selected values of k, τ and d<sub>0</sub>. The general nature of the plots, however, does not change with the use of other values. Arranged in increasing order of magnitude, denote the positive real roots of (30) by z<sub>j</sub>, j=1,2,3, . . . From <figref idref="DRAWINGS">FIG. 4</figref>, it may be clearly seen that the non-negative real roots of the imaginary part F<sub>i</sub>(z) satisfy
</p>
<p id="p-0118" num="0119">
<maths id="MATH-US-00028" num="00028">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>z</mi>
            <mn>1</mn>
          </msub>
          <mo>⁢</mo>
          <mi>ε</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mn>0</mn>
              <mo>,</mo>
              <mfrac>
                <mi>π</mi>
                <mn>2</mn>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>z</mi>
            <mn>2</mn>
          </msub>
          <mo>⁢</mo>
          <mi>ε</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>π</mi>
              <mo>,</mo>
              <mfrac>
                <mrow>
                  <mn>3</mn>
                  <mo>⁢</mo>
                  <mi>π</mi>
                </mrow>
                <mn>2</mn>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>z</mi>
            <mn>3</mn>
          </msub>
          <mo>⁢</mo>
          <mi>ε</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mi>π</mi>
              </mrow>
              <mo>,</mo>
              <mfrac>
                <mrow>
                  <mn>5</mn>
                  <mo>⁢</mo>
                  <mi>π</mi>
                </mrow>
                <mn>2</mn>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>z</mi>
            <mn>4</mn>
          </msub>
          <mo>⁢</mo>
          <mi>ε</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mn>3</mn>
                <mo>⁢</mo>
                <mi>π</mi>
              </mrow>
              <mo>,</mo>
              <mfrac>
                <mrow>
                  <mn>7</mn>
                  <mo>⁢</mo>
                  <mi>π</mi>
                </mrow>
                <mn>2</mn>
              </mfrac>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mi>Ä</mi>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>31</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0119" num="0120">Theorem 2 may now be applied to check if F<sub>i</sub>(z) has only real roots. Substitute s<sub>1</sub>=d<sub>0</sub>s in the expression for F*(s) (in (27)). It may now be seen that the new quasipolynomial in s<sub>1 </sub>yields M=2 and L=1. Choose</p>
<p id="p-0120" num="0121">
<maths id="MATH-US-00029" num="00029">
<math overflow="scroll">
<mrow>
  <mi>η</mi>
  <mo>=</mo>
  <mfrac>
    <mi>π</mi>
    <mn>4</mn>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
to satisfy the requirement that F<sub>i</sub>(z) does not vanish at ω=η, i.e., sin(η)≠0. From <figref idref="DRAWINGS">FIG. 4</figref>, it may be seen that in the interval
</p>
<p id="p-0121" num="0122">
<maths id="MATH-US-00030" num="00030">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mo>[</mo>
      <mrow>
        <mn>0</mn>
        <mo>,</mo>
        <mrow>
          <mrow>
            <mn>2</mn>
            <mo>⁢</mo>
            <mi>π</mi>
          </mrow>
          <mo>-</mo>
          <mfrac>
            <mi>π</mi>
            <mn>4</mn>
          </mfrac>
        </mrow>
      </mrow>
      <mo>]</mo>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mo>[</mo>
      <mrow>
        <mn>0</mn>
        <mo>,</mo>
        <mfrac>
          <mrow>
            <mn>7</mn>
            <mo>⁢</mo>
            <mi>π</mi>
          </mrow>
          <mn>4</mn>
        </mfrac>
      </mrow>
      <mo>]</mo>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
F<sub>i</sub>(z)=0 has 3 real roots including a root at the origin z<sub>0</sub>=0. It is further apparent that F<sub>i</sub>(z) is an odd function. It therefore follows that in the interval
</p>
<p id="p-0122" num="0123">
<maths id="MATH-US-00031" num="00031">
<math overflow="scroll">
<mrow>
  <mrow>
    <mo>[</mo>
    <mrow>
      <mrow>
        <mo>-</mo>
        <mfrac>
          <mrow>
            <mn>7</mn>
            <mo>⁢</mo>
            <mi>π</mi>
          </mrow>
          <mn>4</mn>
        </mfrac>
      </mrow>
      <mo>,</mo>
      <mfrac>
        <mrow>
          <mn>7</mn>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mn>4</mn>
      </mfrac>
    </mrow>
    <mo>]</mo>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
F<sub>i</sub>(z) will have 5 real roots. It is also possible to observe that F<sub>i</sub>(z) has one real root in
</p>
<p id="p-0123" num="0124">
<maths id="MATH-US-00032" num="00032">
<math overflow="scroll">
<mrow>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mn>7</mn>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mn>4</mn>
      </mfrac>
      <mo>,</mo>
      <mfrac>
        <mrow>
          <mn>9</mn>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mn>4</mn>
      </mfrac>
    </mrow>
    <mo>]</mo>
  </mrow>
  <mo>.</mo>
</mrow>
</math>
</maths>
<br/>
Thus, F<sub>i</sub>(z) has 4L+M=6 real roots in the interval
</p>
<p id="p-0124" num="0125">
<maths id="MATH-US-00033" num="00033">
<math overflow="scroll">
<mrow>
  <mrow>
    <mo>[</mo>
    <mrow>
      <mrow>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mn>2</mn>
          </mrow>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mi>π</mi>
          <mn>4</mn>
        </mfrac>
      </mrow>
      <mo>,</mo>
      <mrow>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mi>π</mi>
          <mn>4</mn>
        </mfrac>
      </mrow>
    </mrow>
    <mo>]</mo>
  </mrow>
  <mo>.</mo>
</mrow>
</math>
</maths>
<br/>
Furthermore, F<sub>i</sub>(z) has 2 real roots in each of the intervals
</p>
<p id="p-0125" num="0126">
<maths id="MATH-US-00034" num="00034">
<math overflow="scroll">
<mrow>
  <mrow>
    <mo>[</mo>
    <mrow>
      <mrow>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mi>lπ</mi>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mi>π</mi>
          <mn>4</mn>
        </mfrac>
      </mrow>
      <mo>,</mo>
      <mrow>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>l</mi>
              <mo>+</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mi>π</mi>
          <mn>4</mn>
        </mfrac>
      </mrow>
    </mrow>
    <mo>]</mo>
  </mrow>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.8em" height="0.8ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mi>and</mi>
    <mo>⁢</mo>
    <mstyle>
      <mspace width="0.8em" height="0.8ex"/>
    </mstyle>
    <mo>[</mo>
    <mrow>
      <mrow>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mn>2</mn>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>l</mi>
              <mo>+</mo>
              <mn>1</mn>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mi>π</mi>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mi>π</mi>
          <mn>4</mn>
        </mfrac>
      </mrow>
      <mo>,</mo>
      <mrow>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mn>2</mn>
          </mrow>
          <mo>⁢</mo>
          <mi>lπ</mi>
        </mrow>
        <mo>+</mo>
        <mfrac>
          <mi>π</mi>
          <mn>4</mn>
        </mfrac>
      </mrow>
    </mrow>
    <mo>]</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
for l=1,2,3, . . . Hence it follows that F<sub>i</sub>(z) has exactly 4lL+M real roots in the interval
</p>
<p id="p-0126" num="0127">
<maths id="MATH-US-00035" num="00035">
<math overflow="scroll">
<mrow>
  <mo>[</mo>
  <mrow>
    <mrow>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mn>2</mn>
        </mrow>
        <mo>⁢</mo>
        <mi>lπ</mi>
      </mrow>
      <mo>+</mo>
      <mfrac>
        <mi>π</mi>
        <mn>4</mn>
      </mfrac>
    </mrow>
    <mo>,</mo>
    <mrow>
      <mrow>
        <mn>2</mn>
        <mo>⁢</mo>
        <mi>lπ</mi>
      </mrow>
      <mo>+</mo>
      <mfrac>
        <mi>π</mi>
        <mn>4</mn>
      </mfrac>
    </mrow>
  </mrow>
  <mo>]</mo>
</mrow>
</math>
</maths>
<br/>
for l=1,2,3, . . . , which by Theorem 2 implies that F<sub>i</sub>(z) has only real roots.
</p>
<p id="p-0127" num="0128">F<sub>r</sub>(z) can now be evaluated at the roots of the imaginary part F<sub>i</sub>(z). For z<sub>0</sub>=0, it was obtained previously F<sub>r</sub>(z<sub>0</sub>)=−kk<sub>i</sub>. Now using (28), the following obtains for z<sub>j</sub>, j=1,2,3, . . . ,</p>
<p id="p-0128" num="0129">
<maths id="MATH-US-00036" num="00036">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>F</mi>
      <mi>r</mi>
    </msub>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <msub>
        <mi>z</mi>
        <mi>j</mi>
      </msub>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mo>-</mo>
      <msub>
        <mi>kk</mi>
        <mi>i</mi>
      </msub>
    </mrow>
    <mo>-</mo>
    <mrow>
      <mfrac>
        <mn>1</mn>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <msub>
        <mi>z</mi>
        <mi>j</mi>
      </msub>
      <mo>⁢</mo>
      <mrow>
        <mi>sin</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <msub>
            <mi>z</mi>
            <mi>j</mi>
          </msub>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>-</mo>
    <mrow>
      <mfrac>
        <mi>τ</mi>
        <msubsup>
          <mi>d</mi>
          <mn>0</mn>
          <mn>2</mn>
        </msubsup>
      </mfrac>
      <mo>⁢</mo>
      <msubsup>
        <mi>z</mi>
        <mi>j</mi>
        <mn>2</mn>
      </msubsup>
      <mo>⁢</mo>
      <mrow>
        <mrow>
          <mi>cos</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>z</mi>
              <mi>j</mi>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>.</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0129" num="0130">Using</p>
<p id="p-0130" num="0131">
<maths id="MATH-US-00037" num="00037">
<math overflow="scroll">
<mrow>
  <mfrac>
    <mi>z</mi>
    <msub>
      <mi>d</mi>
      <mn>0</mn>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <mi>cot</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>z</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mi>τ</mi>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
from (30) in the above equation, it obtains that
</p>
<p id="p-0131" num="0132">
<maths id="MATH-US-00038" num="00038">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <msub>
            <mi>F</mi>
            <mi>r</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>z</mi>
              <mi>j</mi>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mrow>
              <mrow>
                <mo>-</mo>
                <msub>
                  <mi>kk</mi>
                  <mi>i</mi>
                </msub>
              </mrow>
              <mo>-</mo>
              <mfrac>
                <mrow>
                  <mrow>
                    <mi>sin</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <msub>
                        <mi>z</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                  <mo>⁢</mo>
                  <mrow>
                    <mi>cot</mi>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <msub>
                        <mi>z</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
                <mi>τ</mi>
              </mfrac>
              <mo>-</mo>
              <mrow>
                <mfrac>
                  <mi>τ</mi>
                  <msubsup>
                    <mi>d</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                </mfrac>
                <mo>⁢</mo>
                <msubsup>
                  <mi>z</mi>
                  <mi>j</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>⁢</mo>
                <mrow>
                  <mi>cos</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <msub>
                      <mi>z</mi>
                      <mi>j</mi>
                    </msub>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mstyle>
              <mtext>
</mtext>
            </mstyle>
            <mo>⇒</mo>
            <mrow>
              <msub>
                <mi>F</mi>
                <mi>r</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <msub>
                  <mi>z</mi>
                  <mi>j</mi>
                </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mrow>
              <mo>-</mo>
              <msub>
                <mi>kk</mi>
                <mi>i</mi>
              </msub>
            </mrow>
            <mo>-</mo>
            <mrow>
              <mrow>
                <mfrac>
                  <mi>τ</mi>
                  <msubsup>
                    <mi>d</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                </mfrac>
                <mo>⁡</mo>
                <mrow>
                  <mo>[</mo>
                  <mrow>
                    <msubsup>
                      <mi>z</mi>
                      <mi>j</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <mfrac>
                      <msubsup>
                        <mi>d</mi>
                        <mn>0</mn>
                        <mn>2</mn>
                      </msubsup>
                      <msup>
                        <mi>τ</mi>
                        <mn>2</mn>
                      </msup>
                    </mfrac>
                  </mrow>
                  <mo>]</mo>
                </mrow>
              </mrow>
              <mo>⁢</mo>
              <mrow>
                <mi>cos</mi>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <msub>
                    <mi>z</mi>
                    <mi>j</mi>
                  </msub>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>32</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0132" num="0133">Therefore
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i><sub>r</sub>(<i>z</i><sub>j</sub>)=−<i>k[k</i><sub>i</sub><i>+a</i>(<i>z</i><sub>j</sub>)],  (33)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where
</p>
<p id="p-0133" num="0134">
<maths id="MATH-US-00039" num="00039">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>a</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>z</mi>
              <mi>j</mi>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mfrac>
              <mi>τ</mi>
              <msubsup>
                <mi>kd</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
            </mfrac>
            <mo>⁡</mo>
            <mrow>
              <mo>[</mo>
              <mrow>
                <msubsup>
                  <mi>z</mi>
                  <mi>j</mi>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <mfrac>
                  <msubsup>
                    <mi>d</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                  <msup>
                    <mi>τ</mi>
                    <mn>2</mn>
                  </msup>
                </mfrac>
              </mrow>
              <mo>]</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mi>cos</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <msub>
                  <mi>z</mi>
                  <mi>j</mi>
                </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>34</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0134" num="0135">From the previous results, F<sub>r</sub>(z<sub>0</sub>)=−kk<sub>i</sub>&gt;0 (i.e., k<sub>i</sub>&lt;0). Then interlacing of the roots of F<sub>r</sub>(z) and F<sub>i</sub>(z) is equivalent to F<sub>r</sub>(z<sub>1</sub>)&lt;0, F<sub>r</sub>(z<sub>2</sub>)&gt;0, F<sub>r</sub>(z<sub>3</sub>)&lt;0, and so on. Using this fact, the result F<sub>r</sub>(z<sub>0</sub>)=−kk<sub>i</sub>&gt;0 and Equation (33), it may be seen that</p>
<p id="p-0135" num="0136">
<maths id="MATH-US-00040" num="00040">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mrow>
              <msub>
                <mi>F</mi>
                <mi>r</mi>
              </msub>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <msub>
                  <mi>z</mi>
                  <mn>0</mn>
                </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>&gt;</mo>
            <mn>0</mn>
          </mrow>
          <mo>⇒</mo>
          <mrow>
            <msub>
              <mi>k</mi>
              <mi>i</mi>
            </msub>
            <mo>&lt;</mo>
            <mn>0</mn>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mrow>
                <msub>
                  <mi>F</mi>
                  <mi>r</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <msub>
                    <mi>z</mi>
                    <mn>1</mn>
                  </msub>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&lt;</mo>
              <mn>0</mn>
            </mrow>
            <mo>⇒</mo>
            <mrow>
              <msub>
                <mi>k</mi>
                <mi>i</mi>
              </msub>
              <mo>&gt;</mo>
              <mrow>
                <mo>-</mo>
                <mrow>
                  <mi>a</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <msub>
                      <mi>z</mi>
                      <mi>i</mi>
                    </msub>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <msub>
            <mi>a</mi>
            <mn>1</mn>
          </msub>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mrow>
                <msub>
                  <mi>F</mi>
                  <mi>r</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <msub>
                    <mi>z</mi>
                    <mn>2</mn>
                  </msub>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&gt;</mo>
              <mn>0</mn>
            </mrow>
            <mo>⇒</mo>
            <mrow>
              <msub>
                <mi>k</mi>
                <mi>i</mi>
              </msub>
              <mo>&lt;</mo>
              <mrow>
                <mo>-</mo>
                <mrow>
                  <mi>a</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <msub>
                      <mi>z</mi>
                      <mn>2</mn>
                    </msub>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <msub>
            <mi>a</mi>
            <mn>2</mn>
          </msub>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mrow>
            <mrow>
              <mrow>
                <msub>
                  <mi>F</mi>
                  <mi>r</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <msub>
                    <mi>z</mi>
                    <mn>3</mn>
                  </msub>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>&lt;</mo>
              <mn>0</mn>
            </mrow>
            <mo>⇒</mo>
            <mrow>
              <msub>
                <mi>k</mi>
                <mi>i</mi>
              </msub>
              <mo>&gt;</mo>
              <mrow>
                <mo>-</mo>
                <mrow>
                  <mi>a</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <msub>
                      <mi>z</mi>
                      <mn>3</mn>
                    </msub>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
          <mo>=</mo>
          <msub>
            <mi>a</mi>
            <mn>3</mn>
          </msub>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mtext>
</mtext>
        </mstyle>
        <mo>⁢</mo>
        <mi>⋮</mi>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>35</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0136" num="0137">The following observations can now be made (noting that for the TCP/AQM plant the τ&gt;0, d<sub>0</sub>≧0 and k&gt;0 hold true);
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0138">Observation 1: From (31), it is seen that z<sub>j </sub>for odd values of j (1, 3, 5, . . . ), are in the first quadrant. Thus, for odd values of j, cos(z<sub>j</sub>)&gt;0 and from (34), it may be concluded that a(z<sub>j</sub>)&gt;0 for odd values of the parameter j.</li>
        <li id="ul0006-0002" num="0139">Observation 2: Similarly, it is seen from (31) that Z<sub>j </sub>for even values of j, (2, 4, 6, . . . ) are in the third quadrant. Thus, for even values of j, cos(z<sub>j</sub>)&lt;0 and from (34), it follows that a(z<sub>j</sub>)&lt;0 for even values of the parameters</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0137" num="0140">All the set of inequalities obtained above can now be rewritten as</p>
<p id="p-0138" num="0141">
<maths id="MATH-US-00041" num="00041">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <munder>
            <mi>max</mi>
            <mrow>
              <mrow>
                <mrow>
                  <mi>j</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                </mrow>
                <mo>,</mo>
                <mn>3</mn>
                <mo>,</mo>
                <mn>5</mn>
                <mo>,</mo>
                <mi>…</mi>
              </mrow>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
            </mrow>
          </munder>
          <mo>⁢</mo>
          <mrow>
            <mo>{</mo>
            <msub>
              <mi>a</mi>
              <mi>j</mi>
            </msub>
            <mo>}</mo>
          </mrow>
        </mrow>
        <mo>&lt;</mo>
        <msub>
          <mi>k</mi>
          <mi>i</mi>
        </msub>
        <mo>&lt;</mo>
        <mrow>
          <munder>
            <mi>min</mi>
            <mrow>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>0</mn>
              </mrow>
              <mo>,</mo>
              <mn>2</mn>
              <mo>,</mo>
              <mn>4</mn>
              <mo>,</mo>
              <mn>6</mn>
              <mo>,</mo>
              <mi>…</mi>
            </mrow>
          </munder>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mo>{</mo>
              <msub>
                <mi>a</mi>
                <mi>j</mi>
              </msub>
              <mo>}</mo>
            </mrow>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>36</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0139" num="0142">From (30) and the relationship 1+tan<sup>2</sup>(z<sub>j</sub>)=sec<sup>2</sup>(z<sub>j</sub>), it follows that</p>
<p id="p-0140" num="0143">
<maths id="MATH-US-00042" num="00042">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>cos</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>z</mi>
              <mi>j</mi>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>±</mo>
            <msqrt>
              <mfrac>
                <mn>1</mn>
                <mrow>
                  <mn>1</mn>
                  <mo>+</mo>
                  <mrow>
                    <msup>
                      <mi>tan</mi>
                      <mn>2</mn>
                    </msup>
                    <mo>⁡</mo>
                    <mrow>
                      <mo>(</mo>
                      <msub>
                        <mi>z</mi>
                        <mi>j</mi>
                      </msub>
                      <mo>)</mo>
                    </mrow>
                  </mrow>
                </mrow>
              </mfrac>
            </msqrt>
          </mrow>
          <mo>=</mo>
          <mrow>
            <mo>±</mo>
            <mrow>
              <mfrac>
                <msub>
                  <mi>z</mi>
                  <mi>j</mi>
                </msub>
                <msqrt>
                  <mrow>
                    <msubsup>
                      <mi>z</mi>
                      <mi>j</mi>
                      <mn>2</mn>
                    </msubsup>
                    <mo>+</mo>
                    <mfrac>
                      <msubsup>
                        <mi>d</mi>
                        <mn>0</mn>
                        <mn>2</mn>
                      </msubsup>
                      <msup>
                        <mi>τ</mi>
                        <mn>2</mn>
                      </msup>
                    </mfrac>
                  </mrow>
                </msqrt>
              </mfrac>
              <mo>.</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>37</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0141" num="0144">From the foregoing analysis z<sub>j</sub>, j=1,2,3, . . . , are solutions of (30). Now using the above expression, it is possible to rewrite a(z<sub>j</sub>) defined in (34) as</p>
<p id="p-0142" num="0145">
<maths id="MATH-US-00043" num="00043">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>a</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>z</mi>
              <mi>j</mi>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <mo>±</mo>
            <mfrac>
              <mi>τ</mi>
              <msubsup>
                <mi>kd</mi>
                <mn>0</mn>
                <mn>2</mn>
              </msubsup>
            </mfrac>
          </mrow>
          <mo>⁢</mo>
          <msub>
            <mi>z</mi>
            <mi>j</mi>
          </msub>
          <mo>⁢</mo>
          <msqrt>
            <mrow>
              <msubsup>
                <mi>z</mi>
                <mi>j</mi>
                <mn>2</mn>
              </msubsup>
              <mo>+</mo>
              <mfrac>
                <msubsup>
                  <mi>d</mi>
                  <mn>0</mn>
                  <mn>2</mn>
                </msubsup>
                <msup>
                  <mi>τ</mi>
                  <mn>2</mn>
                </msup>
              </mfrac>
            </mrow>
          </msqrt>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>38</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where according to Observations 1 and 2 above, the plus sign (+) is used for odd values of j, and the minus sign (−) is used for even values of j.
</p>
<p id="p-0143" num="0146">With (38) it is possible to make the following observation:
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0147">Observation 3: Since z<sub>1</sub>&lt;z<sub>2</sub>&lt;z<sub>3</sub>&lt;z<sub>4</sub>&lt; . . . , from (38) (and Observations 1 and 2), it is seen that a(z<sub>j</sub>) is a monotonically increasing function for odd values of j (1, 3, 5, . . . ), i.e., a(z<sub>1</sub>)&lt;a(z<sub>3</sub>)&lt;a(z<sub>5</sub>)&lt; . . . , and a(z<sub>j</sub>) is a monotonically decreasing function for even values of j (0, 2, 4, 6, . . . ), i.e., a(z<sub>0</sub>)&gt;a(z<sub>2</sub>)&gt;a(z<sub>4</sub>)&gt;a(z<sub>6</sub>)&gt; . . . It is also clear that a(z<sub>0</sub>)=0, z<sub>0</sub>=0.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0144" num="0148">From this observation, the bounds for k<sub>i </sub>in (36) can now be expressed as</p>
<p id="p-0145" num="0149">
<maths id="MATH-US-00044" num="00044">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <mo>-</mo>
            <mrow>
              <mi>a</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <msub>
                  <mi>z</mi>
                  <mn>1</mn>
                </msub>
                <mo>)</mo>
              </mrow>
            </mrow>
          </mrow>
          <mo>&lt;</mo>
          <msub>
            <mi>k</mi>
            <mi>i</mi>
          </msub>
          <mo>&lt;</mo>
          <mn>0</mn>
        </mrow>
        <mo>,</mo>
        <mrow>
          <msub>
            <mi>z</mi>
            <mn>1</mn>
          </msub>
          <mo>⁢</mo>
          <mi>ε</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mn>0</mn>
                <mo>,</mo>
                <mfrac>
                  <mi>π</mi>
                  <mn>2</mn>
                </mfrac>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>.</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>39</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0146" num="0150">Therefore, for the interlacing property to hold it must be that</p>
<p id="p-0147" num="0151">
<maths id="MATH-US-00045" num="00045">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mo>-</mo>
          <mfrac>
            <mi>τ</mi>
            <msubsup>
              <mi>kd</mi>
              <mn>0</mn>
              <mn>2</mn>
            </msubsup>
          </mfrac>
        </mrow>
        <mo>⁢</mo>
        <msub>
          <mi>z</mi>
          <mn>1</mn>
        </msub>
        <mo>⁢</mo>
        <msqrt>
          <mrow>
            <mrow>
              <mrow>
                <msubsup>
                  <mi>z</mi>
                  <mn>1</mn>
                  <mn>2</mn>
                </msubsup>
                <mo>+</mo>
                <mfrac>
                  <msubsup>
                    <mi>d</mi>
                    <mn>0</mn>
                    <mn>2</mn>
                  </msubsup>
                  <msup>
                    <mi>τ</mi>
                    <mn>2</mn>
                  </msup>
                </mfrac>
              </mrow>
              <mo>&lt;</mo>
              <msub>
                <mi>k</mi>
                <mi>i</mi>
              </msub>
              <mo>&lt;</mo>
              <mn>0</mn>
            </mrow>
            <mo>,</mo>
            <mrow>
              <msub>
                <mi>z</mi>
                <mn>1</mn>
              </msub>
              <mo>∈</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mn>0</mn>
                    <mo>,</mo>
                    <mfrac>
                      <mi>π</mi>
                      <mn>2</mn>
                    </mfrac>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>.</mo>
              </mrow>
            </mrow>
          </mrow>
        </msqrt>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>40</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0148" num="0152">Note that for the values of k<sub>i </sub>in this range, the interlacing property and the fact that the root of F<sub>i</sub>(z) are all real can be used in Theorem 2 to guarantee that F<sub>r</sub>(z) also has only real roots. At this point, it is seen that all the conditions of Theorem 1 are satisfied.</p>
<p id="p-0149" num="0153">It is possible to summarize the algorithm for determining the integral controller parameters as shown in <figref idref="DRAWINGS">FIG. 5</figref>. The process initiates, at step <b>400</b>, by obtaining for a network a set of parameters k, d<sub>0</sub>, and τ, where k is a steady-state gain of said network, d<sub>0 </sub>is a time delay of said network, and τ is a time constant of said network. Next, at step <b>410</b>, determining the root z<sub>1 </sub>in the interval</p>
<p id="p-0150" num="0154">
<maths id="MATH-US-00046" num="00046">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>z</mi>
    <mn>1</mn>
  </msub>
  <mo>∈</mo>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mfrac>
        <mi>π</mi>
        <mn>2</mn>
      </mfrac>
    </mrow>
    <mo>)</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0151" num="0155">
<maths id="MATH-US-00047" num="00047">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>cot</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>z</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mi>τ</mi>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <mi>z</mi>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
Next at step <b>420</b>, computing the range of stable gains for k<sub>i </sub>for this particular network as
</p>
<p id="p-0152" num="0156">
<maths id="MATH-US-00048" num="00048">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mo>-</mo>
      <mfrac>
        <mi>τ</mi>
        <msubsup>
          <mi>kd</mi>
          <mn>0</mn>
          <mn>2</mn>
        </msubsup>
      </mfrac>
    </mrow>
    <mo>⁢</mo>
    <msub>
      <mi>z</mi>
      <mn>1</mn>
    </msub>
    <mo>⁢</mo>
    <msqrt>
      <mrow>
        <msubsup>
          <mi>z</mi>
          <mn>1</mn>
          <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <mfrac>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <msup>
            <mi>τ</mi>
            <mn>2</mn>
          </msup>
        </mfrac>
      </mrow>
    </msqrt>
  </mrow>
  <mo>&lt;</mo>
  <msub>
    <mi>k</mi>
    <mi>i</mi>
  </msub>
  <mo>&lt;</mo>
  <mn>0.</mn>
</mrow>
</math>
</maths>
</p>
<p id="p-0153" num="0157">As an example illustrating the use of the algorithm, consider the sample problem of characterizing the stabilizing integral controller gains for a TCP/AQM system with nominal operating parameters of T=ρC=45 Mbps, N=800, and d<sub>0</sub>=55 msec. We also select a small nominal packet size of 64 bytes which we use only for the computation of the stability region. A smaller packet size is selected for this purpose because of the fluid-flow model used in the TCP/AQM control problem. For this system k=1.0515×10<sup>6 </sup>and τ=0.1652. Note that in deriving the control parameters, T is the control target and the TCP parameter θ=⅔. Following the procedure described in <figref idref="DRAWINGS">FIG. 5</figref>, compute</p>
<p id="p-0154" num="0158">
<maths id="MATH-US-00049" num="00049">
<math overflow="scroll">
<mrow>
  <msub>
    <mi>z</mi>
    <mn>1</mn>
  </msub>
  <mo>⁢</mo>
  <mi>ε</mi>
  <mo>⁢</mo>
  <mstyle>
    <mspace width="0.3em" height="0.3ex"/>
  </mstyle>
  <mo>⁢</mo>
  <mrow>
    <mo>(</mo>
    <mrow>
      <mn>0</mn>
      <mo>,</mo>
      <mfrac>
        <mi>π</mi>
        <mn>2</mn>
      </mfrac>
    </mrow>
    <mo>)</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
satisfying (30) to obtain z<sub>1</sub>=0.54583. From this, it is possible to obtain the range of stable k<sub>i </sub>gains as −1.8184×10<sup>−5</sup>&lt;k<sub>i</sub>&lt;0.
</p>
<p id="p-0155" num="0159">As a simple assessment of the region of gains obtained, the system controller response and the system step response of a gain chosen from within the region may be examined. Set the controller gain k<sub>i </sub>(inside the stabilizing range) as −1.5×10<sup>−6</sup>.</p>
<p id="p-0156" num="0160">With this value of k<sub>i</sub>, the characteristic quasipolynomial of the system is given by
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>*(<i>s</i>)=1.5773+(1+0.1652<i>s</i>)<i>se</i><sup>d</sup><sup><sub2>0</sub2></sup><sup>s</sup>.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0157" num="0161">Substituting s=jω, it follows that
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>*(<i>j</i>ω)=[1.5773−ω sin(<i>d</i><sub>0</sub>ω)−0.1 652ω<sup>2 </sup>cos(<i>d</i><sub>0</sub>ω)]<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>+j[ω cos(d<sub>0</sub>ω)−0.1652ω<sup>2 </sup>sin(d<sub>0</sub>ω)]<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0158" num="0162"><figref idref="DRAWINGS">FIG. 6</figref> shows the plot of the real and imaginary parts of F*(jω). It can be observed that the real and imaginary parts interlace.</p>
<p id="p-0159" num="0163">Further, it is possible to plot the resultant step response of the closed-loop TCP/AQM system as shown in <figref idref="DRAWINGS">FIG. 7</figref>. It can be seen from this figure that the closed-loop system is stable and the system output R(t) tracks the step input signal T(t).</p>
<p id="p-0160" num="0164">Choosing which gain is most appropriate for a given system is a decision of the system engineer. Increased integral controller gain improves the steady-state error and provides robustness with respect to parameter variations, but high gains may destabilize the system. Having available a range over which all gains are stable provides the advantage to the system engineer of being able to emphasize whichever aspect of controller performance is most desired, while at the same time ensuring that the system performance remains within bounds.</p>
<p id="p-0161" num="0165">Once the stabilizing integral controller gains have been determined (based upon a TCP/AQM model using small nominal packet size e.g. 64 byte packets), the integral control algorithm can easily be constructed. The integral controller output (19) is given in the s-domain as</p>
<p id="p-0162" num="0166">
<maths id="MATH-US-00050" num="00050">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>P</mi>
      <mi>i</mi>
    </msub>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>s</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>C</mi>
          <mi>i</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>s</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>·</mo>
      <mrow>
        <mi>E</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>s</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <msub>
          <mi>k</mi>
          <mn>1</mn>
        </msub>
        <mi>s</mi>
      </mfrac>
      <mo>·</mo>
      <mrow>
        <mrow>
          <mi>E</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>s</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>.</mo>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where E(s) is the Laplace transform of the control error e(t)=T−R(t).
</p>
<p id="p-0163" num="0167">Denoting t<sub>m</sub>, m=1,2,3, . . . as the sampling instants (i.e., the times the controller reads the input values), then in the continuous-time domain, the controller output is given as</p>
<p id="p-0164" num="0168">
<maths id="MATH-US-00051" num="00051">
<math overflow="scroll">
<mrow>
  <mrow>
    <msub>
      <mi>p</mi>
      <mi>i</mi>
    </msub>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mi>t</mi>
      <mo>)</mo>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>k</mi>
      <mi>i</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <msubsup>
        <mo>∫</mo>
        <mn>0</mn>
        <mn>1</mn>
      </msubsup>
      <mo>⁢</mo>
      <mrow>
        <mrow>
          <mi>e</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>h</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.2em" height="0.2ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>ⅆ</mo>
          <mi>h</mi>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0165" num="0169">It follows that</p>
<p id="p-0166" num="0170">
<maths id="MATH-US-00052" num="00052">
<math overflow="scroll">
<mrow>
  <mfrac>
    <mrow>
      <mo>ⅆ</mo>
      <mrow>
        <msub>
          <mi>p</mi>
          <mi>i</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>t</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mrow>
      <mo>ⅆ</mo>
      <mi>t</mi>
    </mrow>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>k</mi>
      <mi>i</mi>
    </msub>
    <mo>⁢</mo>
    <mrow>
      <mrow>
        <mi>e</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>t</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>.</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0167" num="0171">If this derivative is approximated by the backward difference, the following discrete-time approximation may be obtained</p>
<p id="p-0168" num="0172">
<maths id="MATH-US-00053" num="00053">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>p</mi>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>t</mi>
              <mi>m</mi>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>-</mo>
        <mrow>
          <msub>
            <mi>p</mi>
            <mi>i</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <msub>
              <mi>t</mi>
              <mrow>
                <mi>m</mi>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msub>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mi>Δ</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.3em" height="0.3ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>t</mi>
      </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>k</mi>
        <mi>i</mi>
      </msub>
      <mo>⁢</mo>
      <mrow>
        <mi>e</mi>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <msub>
            <mi>t</mi>
            <mi>m</mi>
          </msub>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
where Δt=t<sub>m</sub>−t<sub>m−1</sub>, m=1, 2, 3, . . . , is the sampling interval.
</p>
<p id="p-0169" num="0173">This leads to the following recursive equation for the I-controller
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i><sub>i</sub>(<i>t</i><sub>m</sub>)=p<sub>i</sub>(<i>t</i><sub>m−1</sub>)+<i>k</i><sub>i</sub><i>Δte</i>(<i>t</i><sub>m</sub>).<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0170" num="0174">A flow chart for the control algorithm and the packet mark/drop routine are shown in <figref idref="DRAWINGS">FIG. 8</figref> and <figref idref="DRAWINGS">FIG. 9</figref>. In the figures, the discrete sampling instants are simply represented as n=0Δt,1Δt,2Δt,3Δt, . . . Note that no packet marking/dropping takes place when R(t)≦T<sub>L </sub>in <figref idref="DRAWINGS">FIG. 9</figref>. The parameter T<sub>L </sub>rate threshold is simply a threshold lower than or equal to the control target T during which no packets are marked/dropped even though the mark/drop probability p(t) can be greater than zero. This simple mechanism helps to further minimize oscillations in link utilization and keep the utilization around the control target. Given that the models used in the design of the control system are approximations of the real TCP/AQM plant (i.e., neglect TCP slow start, timeouts), additional mechanisms may be useful to enhance the performance.</p>
<p id="p-0171" num="0175">It is also important to note that rate measurements are usually noisy and as a result will require some low pass filtering. A simple exponentially weighted moving average (EWMA) filter, for example, can be used for this. The EWMA filter can be expressed as
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (R)}</i>(<i>t</i><sub>m</sub>)=(1−β)<i>{circumflex over (R)}</i>(<i>t</i><sub>m−1</sub>)+β<i>R</i>(<i>t</i><sub>m</sub>),0&lt;β&lt;1.<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0172" num="0176">As shown in <figref idref="DRAWINGS">FIG. 8</figref> the process initiates, at step <b>600</b>, at discrete time n=0, by initializing certain parameters. The timer is set to Δt time units, and mark/drop probability p(<b>0</b>), and Rate signal R(<b>0</b>) are set to initial values. The initial mark/drop probability is used in the mark/drop routine until further samples are available. A nominal packet size of x is also chosen at step <b>600</b>. Δt step <b>610</b>, the timer is reset to Δt time units to advance to the next discrete time interval. Then at step <b>620</b> the data arrival rate R is measured.</p>
<p id="p-0173" num="0177">At step <b>630</b> there is an optional step of pre-filtering the data arrival rate as described previously.</p>
<p id="p-0174" num="0178">At step <b>640</b> the assigned capacity is determined. Typically this is a given for a particular network configuration, but may vary as circumstances warrant, for example if the network is modified.</p>
<p id="p-0175" num="0179">At step <b>650</b> an error signal e(n) is calculated as the difference between the assigned capacity and the measured (and possibly filtered) data arrival rate The error signal is normalized by the nominal packet size x so that the measurements R and T will be consistent with the packet size x used in the computations of the stability gain.</p>
<p id="p-0176" num="0180">At step <b>660</b>, a current mark/drop probability p(n) is calculated as per an integral controller using the stable gain k<sub>i </sub>established at step <b>600</b>.</p>
<p id="p-0177" num="0181">The mark/drop probability calculated at step <b>660</b> may be used as the mark/drop probability until the next measurement time as tracked by the timer, at which point a new mark/drop probability will be calculated. In addition, the filtered arrival rate R′(n) if filtering is used, is stored to be used at the next measurement time.</p>
<p id="p-0178" num="0182">The process may then loop back to step <b>610</b> upon timer expiration for another iteration of the process.</p>
<p id="p-0179" num="0183"><figref idref="DRAWINGS">FIG. 9</figref> presents a flowchart of a random number generator mark/drop routine. The decision to accept or mark/drop an incoming packet in the routine is based upon the outcome of a comparison of a randomly generated number P<sub>r</sub>ε[0,1] and the mark/drop probability p(n). The procedure can be described as follows.</p>
<p id="p-0180" num="0184">Upon a packet arrival at the queue, at step <b>700</b> a determination is made whether the arrival rate is less than or equal to a no-mark/drop rate threshold. If the rate is less than or equal to the rate threshold, then the incoming packet is queued at step <b>740</b>. If the rate is not less than or equal the rate threshold, then the routine moves to step <b>710</b> where a random number p<sub>r</sub>ε[0,1] is generated. At step <b>720</b> a determination of whether the random number p<sub>r </sub>is less than or equal to the calculated mark/drop probability p(n) is made.</p>
<p id="p-0181" num="0185">If the probability p<sub>r </sub>is less than or equal, then the packet is marked/dropped at step <b>730</b>. If not, the packet is queued at step <b>740</b>.</p>
<p id="p-0182" num="0186"><figref idref="DRAWINGS">FIG. 10</figref> provides a high-level description of the overall integral control scheme according to an embodiment of the invention. At module <b>800</b> TCP/AQM parameters representative of the specific data network to be controlled are obtained. At module <b>805</b> these parameters are used to calculate a regime of stable gains for integral gain k<sub>i </sub>for an integral controller. At module <b>810</b> a particular gain is selected from the regime calculated in the previous step. At module <b>825</b>, an ongoing mark/drop probability calculation occurs, using the previously selected gain from module <b>810</b>, and using a measured data arrival rate from module <b>815</b> and an assigned capacity T(n) and nominal packet size x. At module <b>830</b> a current mark/drop probability is calculated. The module <b>835</b> generates a random number in the range [0,1]. Module <b>840</b> utilizes the current mark/drop probability p(n) calculated by module <b>830</b>, and the random number calculated by module <b>835</b> to make a determination to mark/drop or queue an incoming packet.</p>
<p id="p-0183" num="0187">While the invention has been described in conjunction with specific embodiments thereof, it is evident that many alternatives, modifications, and variations will be apparent to those skilled in the art in light of the foregoing description. Accordingly, it is intended to embrace all such alternatives, modifications, and variations as fall within the spirit and broad scope of the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298699-20071120-M00001.NB">
<img id="EMI-M00001" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298699-20071120-M00002.NB">
<img id="EMI-M00002" he="8.47mm" wi="76.20mm" file="US07298699-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298699-20071120-M00003.NB">
<img id="EMI-M00003" he="7.03mm" wi="76.20mm" file="US07298699-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298699-20071120-M00004.NB">
<img id="EMI-M00004" he="15.92mm" wi="76.20mm" file="US07298699-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298699-20071120-M00005.NB">
<img id="EMI-M00005" he="8.13mm" wi="76.20mm" file="US07298699-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298699-20071120-M00006.NB">
<img id="EMI-M00006" he="6.69mm" wi="76.20mm" file="US07298699-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298699-20071120-M00007.NB">
<img id="EMI-M00007" he="7.03mm" wi="76.20mm" file="US07298699-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298699-20071120-M00008.NB">
<img id="EMI-M00008" he="9.91mm" wi="76.20mm" file="US07298699-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298699-20071120-M00009.NB">
<img id="EMI-M00009" he="9.57mm" wi="76.20mm" file="US07298699-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07298699-20071120-M00010.NB">
<img id="EMI-M00010" he="8.81mm" wi="76.20mm" file="US07298699-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07298699-20071120-M00011.NB">
<img id="EMI-M00011" he="16.59mm" wi="76.20mm" file="US07298699-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07298699-20071120-M00012.NB">
<img id="EMI-M00012" he="7.79mm" wi="76.20mm" file="US07298699-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013" nb-file="US07298699-20071120-M00013.NB">
<img id="EMI-M00013" he="32.85mm" wi="76.20mm" file="US07298699-20071120-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US07298699-20071120-M00014.NB">
<img id="EMI-M00014" he="20.15mm" wi="76.20mm" file="US07298699-20071120-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US07298699-20071120-M00015.NB">
<img id="EMI-M00015" he="6.69mm" wi="76.20mm" file="US07298699-20071120-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016" nb-file="US07298699-20071120-M00016.NB">
<img id="EMI-M00016" he="7.45mm" wi="76.20mm" file="US07298699-20071120-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00017" nb-file="US07298699-20071120-M00017.NB">
<img id="EMI-M00017" he="9.57mm" wi="76.20mm" file="US07298699-20071120-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00018" nb-file="US07298699-20071120-M00018.NB">
<img id="EMI-M00018" he="6.69mm" wi="76.20mm" file="US07298699-20071120-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00019" nb-file="US07298699-20071120-M00019.NB">
<img id="EMI-M00019" he="6.35mm" wi="76.20mm" file="US07298699-20071120-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00020" nb-file="US07298699-20071120-M00020.NB">
<img id="EMI-M00020" he="7.45mm" wi="76.20mm" file="US07298699-20071120-M00020.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00021" nb-file="US07298699-20071120-M00021.NB">
<img id="EMI-M00021" he="7.03mm" wi="76.20mm" file="US07298699-20071120-M00021.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00022" nb-file="US07298699-20071120-M00022.NB">
<img id="EMI-M00022" he="15.49mm" wi="76.20mm" file="US07298699-20071120-M00022.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00023" nb-file="US07298699-20071120-M00023.NB">
<img id="EMI-M00023" he="7.79mm" wi="76.20mm" file="US07298699-20071120-M00023.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00024" nb-file="US07298699-20071120-M00024.NB">
<img id="EMI-M00024" he="6.35mm" wi="76.20mm" file="US07298699-20071120-M00024.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00025" nb-file="US07298699-20071120-M00025.NB">
<img id="EMI-M00025" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00025.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00026" nb-file="US07298699-20071120-M00026.NB">
<img id="EMI-M00026" he="6.35mm" wi="76.20mm" file="US07298699-20071120-M00026.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00027" nb-file="US07298699-20071120-M00027.NB">
<img id="EMI-M00027" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00027.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00028" nb-file="US07298699-20071120-M00028.NB">
<img id="EMI-M00028" he="6.69mm" wi="76.20mm" file="US07298699-20071120-M00028.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00029" nb-file="US07298699-20071120-M00029.NB">
<img id="EMI-M00029" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00029.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00030" nb-file="US07298699-20071120-M00030.NB">
<img id="EMI-M00030" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00030.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00031" nb-file="US07298699-20071120-M00031.NB">
<img id="EMI-M00031" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00031.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00032" nb-file="US07298699-20071120-M00032.NB">
<img id="EMI-M00032" he="6.35mm" wi="76.20mm" file="US07298699-20071120-M00032.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00033" nb-file="US07298699-20071120-M00033.NB">
<img id="EMI-M00033" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00033.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00034" nb-file="US07298699-20071120-M00034.NB">
<img id="EMI-M00034" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00034.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00035" nb-file="US07298699-20071120-M00035.NB">
<img id="EMI-M00035" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00035.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00036" nb-file="US07298699-20071120-M00036.NB">
<img id="EMI-M00036" he="6.69mm" wi="76.20mm" file="US07298699-20071120-M00036.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00037" nb-file="US07298699-20071120-M00037.NB">
<img id="EMI-M00037" he="6.35mm" wi="76.20mm" file="US07298699-20071120-M00037.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00038" nb-file="US07298699-20071120-M00038.NB">
<img id="EMI-M00038" he="15.49mm" wi="76.20mm" file="US07298699-20071120-M00038.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00039" nb-file="US07298699-20071120-M00039.NB">
<img id="EMI-M00039" he="7.79mm" wi="76.20mm" file="US07298699-20071120-M00039.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00040" nb-file="US07298699-20071120-M00040.NB">
<img id="EMI-M00040" he="18.03mm" wi="76.20mm" file="US07298699-20071120-M00040.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00041" nb-file="US07298699-20071120-M00041.NB">
<img id="EMI-M00041" he="5.33mm" wi="76.20mm" file="US07298699-20071120-M00041.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00042" nb-file="US07298699-20071120-M00042.NB">
<img id="EMI-M00042" he="12.70mm" wi="76.20mm" file="US07298699-20071120-M00042.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00043" nb-file="US07298699-20071120-M00043.NB">
<img id="EMI-M00043" he="8.81mm" wi="76.20mm" file="US07298699-20071120-M00043.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00044" nb-file="US07298699-20071120-M00044.NB">
<img id="EMI-M00044" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00044.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00045" nb-file="US07298699-20071120-M00045.NB">
<img id="EMI-M00045" he="8.81mm" wi="76.20mm" file="US07298699-20071120-M00045.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00046" nb-file="US07298699-20071120-M00046.NB">
<img id="EMI-M00046" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00046.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00047" nb-file="US07298699-20071120-M00047.NB">
<img id="EMI-M00047" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00047.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00048" nb-file="US07298699-20071120-M00048.NB">
<img id="EMI-M00048" he="8.47mm" wi="76.20mm" file="US07298699-20071120-M00048.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00049" nb-file="US07298699-20071120-M00049.NB">
<img id="EMI-M00049" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00049.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00050" nb-file="US07298699-20071120-M00050.NB">
<img id="EMI-M00050" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00050.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00051" nb-file="US07298699-20071120-M00051.NB">
<img id="EMI-M00051" he="7.03mm" wi="76.20mm" file="US07298699-20071120-M00051.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00052" nb-file="US07298699-20071120-M00052.NB">
<img id="EMI-M00052" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00052.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00053" nb-file="US07298699-20071120-M00053.NB">
<img id="EMI-M00053" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00053.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00054" nb-file="US07298699-20071120-M00054.NB">
<img id="EMI-M00054" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00054.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00055" nb-file="US07298699-20071120-M00055.NB">
<img id="EMI-M00055" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00055.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00056" nb-file="US07298699-20071120-M00056.NB">
<img id="EMI-M00056" he="8.47mm" wi="76.20mm" file="US07298699-20071120-M00056.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00057" nb-file="US07298699-20071120-M00057.NB">
<img id="EMI-M00057" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00057.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00058" nb-file="US07298699-20071120-M00058.NB">
<img id="EMI-M00058" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00058.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00059" nb-file="US07298699-20071120-M00059.NB">
<img id="EMI-M00059" he="8.47mm" wi="76.20mm" file="US07298699-20071120-M00059.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00060" nb-file="US07298699-20071120-M00060.NB">
<img id="EMI-M00060" he="5.67mm" wi="76.20mm" file="US07298699-20071120-M00060.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00061" nb-file="US07298699-20071120-M00061.NB">
<img id="EMI-M00061" he="6.01mm" wi="76.20mm" file="US07298699-20071120-M00061.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00062" nb-file="US07298699-20071120-M00062.NB">
<img id="EMI-M00062" he="8.47mm" wi="76.20mm" file="US07298699-20071120-M00062.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for controlling a data flow in a data network, the method comprising:
<claim-text>selecting a stable integral controller gain k<sub>i </sub>for said data network;</claim-text>
<claim-text>measuring a data arrival rate R(n) at time n;</claim-text>
<claim-text>calculating a normalized error signal e(n), according to the relation
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>(<i>n</i>)=(<i>T</i>(<i>n</i>)−<i>R</i>(<i>n</i>))/<i>x, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where T(n) is an assigned capacity at time n, and x is a nominal packet size;</claim-text>
</claim-text>
<claim-text>computing a mark/drop probability p(n) according to the relation
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i>(<i>n</i>)=min { max [<i>p</i>(<i>n−</i>1)+<i>k</i><sub>i</sub><i>·Δt·e</i>(<i>n</i>),0],<i>p</i><sub>max</sub>}<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where Δt is the time interval between a (n−1)<sup>th </sup>and the n<sup>th </sup>computation, and 0&lt;p<sub>max</sub>≦1; and</claim-text>
</claim-text>
<claim-text>executing a packet mark/drop routine based upon the calculated mark/drop probability p(n).</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the step of selecting a stable integral controller gain k<sub>i </sub>for said data network is preceded by the step of:
<claim-text>pre-calculating a range within which all gains k<sub>i </sub>result in a stable gain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the step of pre-calculating a range within which all gains k<sub>i </sub>result in a stable gain for said data network, is determined according to the method of:
<claim-text>obtaining for said network a value for said network a set of parameters k<sub>i </sub>
<claim-text>d<sub>0i </sub>and τ,</claim-text>
<claim-text>where k is a steady-state gain of said network,</claim-text>
<claim-text>d<sub>0 </sub>is a time delay of said network, and</claim-text>
<claim-text>τ is a time constant of said network;</claim-text>
</claim-text>
<claim-text>determining a z<sub>1 </sub>in the interval</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00054" num="00054">
<math overflow="scroll">
<mrow>
  <mo>(</mo>
  <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mfrac>
      <mi>π</mi>
      <mn>2</mn>
    </mfrac>
  </mrow>
  <mo>)</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>satisfying</claim-text>
<claim-text>
<maths id="MATH-US-00055" num="00055">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>cot</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <msub>
          <mi>z</mi>
          <mn>1</mn>
        </msub>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mi>τ</mi>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <msub>
        <mi>z</mi>
        <mn>1</mn>
      </msub>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>and computing a range of stable gains k<sub>i </sub>for said data network according to</claim-text>
<claim-text>
<maths id="MATH-US-00056" num="00056">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mo>-</mo>
      <mfrac>
        <mi>τ</mi>
        <msubsup>
          <mi>kd</mi>
          <mn>0</mn>
          <mn>2</mn>
        </msubsup>
      </mfrac>
    </mrow>
    <mo>⁢</mo>
    <msub>
      <mi>z</mi>
      <mn>1</mn>
    </msub>
    <mo>⁢</mo>
    <msqrt>
      <mrow>
        <msubsup>
          <mi>z</mi>
          <mn>1</mn>
          <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <mfrac>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <msup>
            <mi>τ</mi>
            <mn>2</mn>
          </msup>
        </mfrac>
      </mrow>
    </msqrt>
  </mrow>
  <mo>&lt;</mo>
  <msub>
    <mi>k</mi>
    <mi>i</mi>
  </msub>
  <mo>&lt;</mo>
  <mn>0.</mn>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the step of measuring a data arrival rate R(n) at time n further comprises:
<claim-text>filtering the data arrival rate R(n) according to the relation:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i>′(<i>n</i>)=(1−β)·<i>R</i>′(<i>n</i>−1)+β<i>R</i>(<i>n</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where β is a filter gain parameter such that 0&lt;β&lt;1,</claim-text>
<claim-text>R′(n−1) is the filtered data arrival rate at time n−1, and</claim-text>
<claim-text>R′(n) is the desired filtered data arrival rate at time n.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising a step, preceding the step of executing a packet mark/drop routine, of:
<claim-text>testing the data arrival rate R(n) against a rate threshold T<sub>L</sub>; and</claim-text>
<claim-text>if the data arrival rate R(n) is below or equal to the rate threshold T<sub>L </sub>then bypassing the step of executing a packet mark/drop routine.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the step of executing a packet mark/drop routine further comprises:
<claim-text>marking/dropping packets according to a random number generator mark/drop scheme.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. An apparatus for controlling a data flow in a data network, said apparatus configured according to the method of any of <claim-ref idref="CLM-00001">claims 1</claim-ref>-<b>6</b>.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. An apparatus for controlling a data flow in a data network, the apparatus comprising:
<claim-text>a integral controller having a integral controller gain k<sub>i </sub>setting for which the said network is stable;</claim-text>
<claim-text>a data arrival rate measurer for measuring data arrival rate R(n) at time n;</claim-text>
<claim-text>an error signal calculator for calculating a normalized error signal e(n), according to the relation
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>(<i>n</i>)=(<i>T</i>(<i>n</i>)−<i>R</i>(<i>n</i>))/<i>x, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where T(n) is an assigned capacity at time n, and x is a nominal packet size;</claim-text>
</claim-text>
<claim-text>a mark/drop probability processor for computing a mark/drop probability p(n), according to the relation
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i>(<i>n</i>)=min { max [<i>p</i>(<i>n−</i>1)+<i>k</i><sub>i</sub><i>·Δt·e</i>(<i>n</i>),0<i>],p</i><sub>max</sub>}<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where Δt is the time interval between a (n−1)<sup>th </sup>and the n<sup>th </sup>computation, and 0&lt;p<sub>max</sub>≦1; and</claim-text>
</claim-text>
<claim-text>a packet mark/drop module for executing a packet mark/drop routine based upon the calculated mark/drop probability p(n).</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the integral controller gain k<sub>i </sub>setting for which the said network is stable is chosen from a pre-calculated range within which all gains k<sub>i </sub>are gains for which said network is stable.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the pre-calculated range within which all gains k<sub>i </sub>are gains for which said network is stable, is determined according to the method of:
<claim-text>obtaining for said network a value for said network of a set of parameters
<claim-text>k, d<sub>0</sub>, and τ,</claim-text>
<claim-text>where k is a steady-state gain of said network,</claim-text>
<claim-text>d<sub>0 </sub>is a time delay of said network, and</claim-text>
<claim-text>τ is a time constant of said network;</claim-text>
</claim-text>
<claim-text>determining a z<sub>1 </sub>in the interval</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00057" num="00057">
<math overflow="scroll">
<mrow>
  <mo>(</mo>
  <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mfrac>
      <mi>π</mi>
      <mn>2</mn>
    </mfrac>
  </mrow>
  <mo>)</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>satisfying</claim-text>
<claim-text>
<maths id="MATH-US-00058" num="00058">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>cot</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <msub>
          <mi>z</mi>
          <mn>1</mn>
        </msub>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mi>τ</mi>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <msub>
        <mi>z</mi>
        <mn>1</mn>
      </msub>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>and computing a range of stable gains k<sub>i </sub>for said data network according to</claim-text>
<claim-text>
<maths id="MATH-US-00059" num="00059">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mo>-</mo>
      <mfrac>
        <mi>τ</mi>
        <msubsup>
          <mi>kd</mi>
          <mn>0</mn>
          <mn>2</mn>
        </msubsup>
      </mfrac>
    </mrow>
    <mo>⁢</mo>
    <msub>
      <mi>z</mi>
      <mn>1</mn>
    </msub>
    <mo>⁢</mo>
    <msqrt>
      <mrow>
        <msubsup>
          <mi>z</mi>
          <mn>1</mn>
          <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <mfrac>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <msup>
            <mi>τ</mi>
            <mn>2</mn>
          </msup>
        </mfrac>
      </mrow>
    </msqrt>
  </mrow>
  <mo>&lt;</mo>
  <msub>
    <mi>k</mi>
    <mi>i</mi>
  </msub>
  <mo>&lt;</mo>
  <mn>0.</mn>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the data arrival rate measurer for measuring data arrival rate R(n) at time n further comprises:
<claim-text>a filter for filtering the data arrival rate R(n) according to the relation:
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i>′(<i>n</i>)=(1−β)·<i>R</i>′(<i>n−</i>1)+β·<i>R</i>(<i>n</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where β is a filter gain parameter such that 0&lt;β&lt;1,</claim-text>
<claim-text>R′(n−1) is the filtered data arrival rate at time n−1, and</claim-text>
<claim-text>R′(n) is the desired filtered data arrival rate at time n.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> further comprising:
<claim-text>a test module for testing the data arrival rate R(n) against a rate threshold T<sub>L</sub>; and</claim-text>
<claim-text>if the data arrival rate R(n) is below or equal to the rate threshold T<sub>L </sub>then bypassing the packet mark/drop module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the packet mark/drop module further comprises:
<claim-text>a random number generator drop scheme module.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method of determining for a integral controller controlling the flow of data for a data network, a range within which all gains k<sub>i </sub>result in a stable gain for said data network, comprising the steps of:
<claim-text>obtaining for said data network a set of parameters k, d<sub>0</sub>, and τ,
<claim-text>where k is a steady-state gain of said network,</claim-text>
<claim-text>d<sub>0 </sub>is a time delay of said network, and</claim-text>
<claim-text>τ is a time constant of said network;</claim-text>
</claim-text>
<claim-text>determining a z<sub>1 </sub>in the interval</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00060" num="00060">
<math overflow="scroll">
<mrow>
  <mo>(</mo>
  <mrow>
    <mn>0</mn>
    <mo>,</mo>
    <mfrac>
      <mi>π</mi>
      <mn>2</mn>
    </mfrac>
  </mrow>
  <mo>)</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>satisfying</claim-text>
<claim-text>
<maths id="MATH-US-00061" num="00061">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mi>cot</mi>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <msub>
          <mi>z</mi>
          <mn>1</mn>
        </msub>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mi>τ</mi>
        <msub>
          <mi>d</mi>
          <mn>0</mn>
        </msub>
      </mfrac>
      <mo>⁢</mo>
      <msub>
        <mi>z</mi>
        <mn>1</mn>
      </msub>
    </mrow>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
</claim-text>
<claim-text>and computing a range of stable gains k<sub>i </sub>for said data network according to</claim-text>
<claim-text>
<maths id="MATH-US-00062" num="00062">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <mo>-</mo>
      <mfrac>
        <mi>τ</mi>
        <msubsup>
          <mi>kd</mi>
          <mn>0</mn>
          <mn>2</mn>
        </msubsup>
      </mfrac>
    </mrow>
    <mo>⁢</mo>
    <msub>
      <mi>z</mi>
      <mn>1</mn>
    </msub>
    <mo>⁢</mo>
    <msqrt>
      <mrow>
        <msubsup>
          <mi>z</mi>
          <mn>1</mn>
          <mn>2</mn>
        </msubsup>
        <mo>+</mo>
        <mfrac>
          <msubsup>
            <mi>d</mi>
            <mn>0</mn>
            <mn>2</mn>
          </msubsup>
          <msup>
            <mi>τ</mi>
            <mn>2</mn>
          </msup>
        </mfrac>
      </mrow>
    </msqrt>
  </mrow>
  <mo>&lt;</mo>
  <msub>
    <mi>k</mi>
    <mi>i</mi>
  </msub>
  <mo>&lt;</mo>
  <mn>0.</mn>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. An article of manufacture carrying instructions for controlling a data flow in a data network, said instructions including:
<claim-text>instructions for selecting a stable gain of a integral controller gain k<sub>i </sub>for said data network;</claim-text>
<claim-text>instructions for measuring a data arrival rate R(n) at time n;</claim-text>
<claim-text>instructions for calculating a normalized error signal e(n), according to the relation
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>e</i>(<i>n</i>)=(<i>T</i>(<i>n</i>)−<i>R</i>(<i>n</i>))/<i>x, </i><?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where T(n) is an assigned capacity at time n, and x is a nominal packet size;</claim-text>
</claim-text>
<claim-text>instructions for computing a mark/drop probability p(n) according to the relation
<claim-text>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>p</i>(<i>n</i>)=min { max [<i>p</i>(<i>n−</i>1)+<i>k</i><sub>i</sub><i>·Δt·e</i>(<i>n</i>),0],<i>p</i><sub>max</sub>}<?in-line-formulae description="In-line Formulae" end="tail"?>
</claim-text>
<claim-text>where Δt is the time interval between a (n−1)<sup>th </sup>and the n<sup>th </sup>computation, and 0&lt;p<sub>max</sub>≦1; and</claim-text>
</claim-text>
<claim-text>instructions for executing a packet mark/drop routine based upon the calculated mark/drop probability p(n).</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
