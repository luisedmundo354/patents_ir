<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299353-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299353</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10638839</doc-number>
<date>20030811</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>FR</country>
<doc-number>02 11007</doc-number>
<date>20020905</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>646</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>1</main-group>
<subgroup>24</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713159</main-classification>
<further-classification>713161</further-classification>
<further-classification>713162</further-classification>
<further-classification>713168</further-classification>
<further-classification>713193</further-classification>
</classification-national>
<invention-title id="d0e71">Firewall system for interconnecting two IP networks managed by two different administrative entities</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5819019</doc-number>
<kind>A</kind>
<name>Nelson</name>
<date>19981000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5953707</doc-number>
<kind>A</kind>
<name>Huang et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 10</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6067634</doc-number>
<kind>A</kind>
<name>Nelson</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714  4</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>EP</country>
<doc-number>0 909 074</doc-number>
<date>19990400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>WO</country>
<doc-number>WO 99-48261</doc-number>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>Preliminary Search Report for corresponding French Application, FR 0211007 dated May 6, 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>713154</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713161</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713162</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713168</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>713193</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>5</number-of-drawing-sheets>
<number-of-figures>6</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040049701</doc-number>
<kind>A1</kind>
<date>20040311</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Le Pennec</last-name>
<first-name>Jean-François</first-name>
<address>
<city>Nice</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Bruno</last-name>
<first-name>Aurélien</first-name>
<address>
<city>Nice</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Grisi</last-name>
<first-name>Nicolas</first-name>
<address>
<city>La Colle sur Loup</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="004" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Sommerlatt</last-name>
<first-name>Jean-Marie</first-name>
<address>
<city>Le Raincy</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>AT&amp;T Corp.</orgname>
<role>02</role>
<address>
<city>New York</city>
<state>NY</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Peeso</last-name>
<first-name>Thomas R.</first-name>
<department>2132</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Firewall system for interconnecting a first IP network (<b>10</b>) to a second IP network (<b>16</b>), these networks belonging to two different entities having each a different administration wherein any data packet transmitted/received by the first IP network is filtered by using a first firewall function and any data packet transmitted/received by the second IP network is filtered by using a second firewall function. The system comprises essentially a single firewall device (<b>20</b>) including filtering means (<b>41, 43</b>) performing both first firewall function and second firewall function, a console port (<b>37</b>) enabling the administrator in charge of each IP network to enter filtering rules for updating the associated firewall function and control means (<b>39, 47, 49</b>) interconnecting the console port and the filtering means for transmitting thereto the filtering rules so that each administrator may independently manage the system from the console port.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="54.27mm" wi="174.67mm" file="US07299353-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="161.29mm" wi="179.07mm" file="US07299353-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="170.86mm" wi="167.56mm" file="US07299353-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="205.06mm" wi="171.03mm" file="US07299353-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="210.74mm" wi="173.23mm" file="US07299353-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="219.63mm" wi="180.17mm" file="US07299353-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present invention relates generally to firewall mechanisms which are used to connect two data transmission networks such as Intranet networks belonging to two different entities each having a specific administrative control, and in particular to a firewall system for interconnecting two IP networks managed by two different administrators.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Today, network security techniques are using a firewall, which is generally known as a combination of hardware and software used to implement a security policy governing network traffic between two or more networks, some of which may be private as being under administrative control of a customer or network provider (e.g., organizational networks) and some of which may not be under administrative control (e.g., the Internet) also called a public network. A network firewall commonly serves as a primary line of defense against external threats to an organization's computer systems, networks, and critical information. Firewalls can also be used to partition networks isolate or interconnect VPNs.</p>
<p id="p-0004" num="0003">Using other words, a Firewall is a system designed to prevent unauthorized access to or from a private network. Firewalls are frequently used to prevent unauthorized Internet users from accessing private networks connected to the Internet, especially Intranets having firewalls can also be used between two Intranets. All messages entering or leaving the Intranet pass through the firewall, which examines each message and blocks those that do not meet the specified security criteria. They may also be used to interconnect private networks managed by two different administrative entities. In that case, generally, two firewalls are cascaded with an intermediate link called a DMZ, each firewall being managed by a different administrative authority.</p>
<p id="p-0005" num="0004">Firewalls perform various decision-making processes and principally the in particular perform packet filtering which consists of looking at each packet entering or leaving the associated network and accepting or rejecting this packet based on user-defined rules. However, other security-related functions can be implemented in a firewall such as an application gateway by applying a security mechanism to specific applications such as FTP and Telnet servers, circuit-level gateway by applying a security mechanism when a TCP or UDP connection is established and a proxy server which enables the establishment of a connection on behalf of a client between the proxy server and destination device.</p>
<p id="p-0006" num="0005">In addition to these security-related functions, firewalls can also perform routing functions that are associated with the network being protected and that are conventionally associated with a separate/individual router. Routing is the process of deciding the disposition of each packet that a routing device handles. This applies to incoming packets, outbound packets leaving a network for external destinations, and packets being routed among internal networks. Ultimately, there can be only two possibilities for the packets: forward or discard. The routing mechanism uses a routing table and a destination IP address in the packet header to make a decision.</p>
<p id="p-0007" num="0006">A routing configuration that reflects the network topology is generally used so that the firewall is able to deliver legitimate packets to their desired destinations. A firewall routing table contains a list of IP network addresses for which the firewall is intended to provide routing services. If the lookup of the routing table is successful for a packet, the table provides either the address of the next router to send the packet or the interface to be used for sending the packet out. If the table lookup fails, the packet is discarded and an ICMP “unreachable” message is generally returned to the source indicating that the packet was undeliverable.</p>
<p id="p-0008" num="0007">However, such routing mechanism is too dynamic and unreliable and cannot be used to implement a security policy. As such, a security technique called stateful inspection or dynamic packet filtering is often used. Whereas classic packet filtering is based only on header information on each individual packet without considering any prior packets, the stateful inspection filtering allows both complex combinations of payload (message content) and context established by prior packets to influence filtering decisions. As with packet filtering, stateful inspection is implemented as an “add-on” to routing. The principle motivation for stateful inspection is a compromise between performance and security. As a routing “add-on,” stateful inspection provides much better performance than the proxies. It also provides an increase in the level of firewall function beyond simple packet filtering. Like proxies, much more complex access control criteria can be specified and like packet filtering, stateful inspection depends on a high quality (i.e. correct) underlying routing implementation.</p>
<p id="p-0009" num="0008">But, in any case, two physically different firewalls are implemented one after the other in an interconnection between Intranet networks because each network is administratively managed by a different organization that wants to have a dedicated administrative access to the firewall for defining rules and taking logs. Some of the rules are common but are run twice which decrease the overall system performance. The expense and complexity are high, and reliability is low because two serial devices are used. Configuration is more complex because there is an additional link between the two firewalls.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0010" num="0009">Accordingly, the main object of the invention is to replace the classic firewall system having two physically different firewalls in series by a firewall system having a single firewall device for interconnecting two IP networks belonging to two different entities and managed by two different administrations.</p>
<p id="p-0011" num="0010">The invention relates therefore to a firewall system for interconnecting a first IP network to a second IP network, these networks belonging to two different entities having each a different administration wherein any data packet transmitted or received by the first IP network is filtered by using a first firewall function and any data packet transmitted or received by the second IP network is filtered by using a second firewall function. The system comprises essentially a single firewall device including filtering means for performing both a first firewall function and a second firewall function, a console port enabling the administrator in charge of administrating each IP network to enter filtering rules for updating the associated firewall function and control means for interconnecting the console port and filtering means for transmitting filtering rules so that each administrator may independently manage their respective system from a console port.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">The above and other objects, features and advantages of the invention will be better understood by reading the following more particular description of the invention in conjunction with the accompanying drawings wherein:</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> is a block-diagram of a prior system including two firewalls for interconnecting two IP networks belonging to two different entities having two different administrators.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> is a block-diagram of the same system as the one illustrated in <figref idref="DRAWINGS">FIG. 1</figref> but wherein the two firewalls have been replaced by a single firewall according to the invention.</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> is a block-diagram representing the functional blocks of a firewall device.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIGS. 4A and 4B</figref> are block-diagrams representing respectively the functional blocks of a firewall system according to the invention for the data path from the first network to the second network and for the data path from the second network to the first network.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 5</figref> is a schematic diagram representing the method achieving the rule merging.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 1</figref> shows a classic system where two networks NET<b>1</b> <b>10</b> and NET<b>2</b> <b>16</b> belonging to two different administrative entities, are securely interconnected via a complex firewall system comprising a first firewall FW<b>1</b> <b>12</b> and a second firewall FW<b>2</b> <b>14</b>. The administrator, referenced as MG<b>1</b> <b>11</b> of NET <b>1</b>, manages FW<b>1</b> while the administrator of MG<b>2</b> <b>17</b> of NET<b>2</b> manages FW<b>2</b>. A LAN <b>15</b> interconnects FW<b>1</b> and FW<b>2</b> which is, in this example, a demilitarized zone DMZ <b>15</b> shared by the two companies. Common servers may be implemented in this zone such as a web server SR <b>18</b>. Both entities may use such a server. Such a zone is also called a community of interest COI.</p>
<p id="p-0019" num="0018">The system illustrated in <figref idref="DRAWINGS">FIG. 1</figref> is expensive and adds an overhead to the path since firewall processing is performed twice. Furthermore, any failure on one of the two firewalls stops traffic. These drawbacks are overcome by the Firewall system according to the invention illustrated in <figref idref="DRAWINGS">FIG. 2</figref> wherein the two firewalls FW<b>1</b> and FW<b>2</b> are replaced by a single physical device FW <b>20</b> which can also provide a locally demilitarized zone to connect an externally shared server such as SR <b>18</b>. The single firewall <b>20</b> allows MG<b>1</b> <b>11</b> and MG<b>2</b> <b>17</b> to manage respectively manage their logical firewall part within the dual firewall system.</p>
<p id="p-0020" num="0019">In such a system, no visibility to the configuration on one side is provided to the administrator of the other side but the rules that can be aggregated allow optimizing the performance of the solution. Therefore the cost of such implementation will be lower and the reliability better.</p>
<p id="p-0021" num="0020">A standard firewall with its functional blocks is represented in <figref idref="DRAWINGS">FIG. 3</figref>. Note that a firewall is normally divided into two devices which are functionally identical for the two data paths except for the stateful inspection mechanism which includes an additional control flow between the transmit and receive sides. Insofar as the functional blocks are the same for the two data paths, only the firewall device controlling the data path outputting from the NET<b>1</b> is represented in <figref idref="DRAWINGS">FIG. 3</figref>.</p>
<p id="p-0022" num="0021">The functional blocks of the firewall include in transmission order from NET<b>1</b> <b>10</b> to DMZ <b>15</b>, a first Network Address Translation (NAT) function NATin <b>30</b>, which is optional insofar as the NAT is necessary only if there is a mapping rule for changing the source IP address, and for forwarding data to a second block called FILTin <b>31</b>. The latter function performs filtering on the input interface and forwards granted packets to IPgw <b>35</b>, which is the forwarding engine of the firewall. A routing decision is based on routing defined by the routing control point RCP <b>34</b>. RCP maintains the routes with its peer routing devices and updates the forwarding table of the IP gateway <b>35</b>. Based on these rules, a packet may be sent to an integrated function, such as an application proxy PXY <b>36</b> or a server entity SRV <b>38</b> for authentication, encryption or other service module like DHCP service. It may also be sent to RCP if the packet is a routing update message. Otherwise, the main path is to forward the packet to the output interface. In that case, the packet has again to path through two blocks: a first filtering block for output packets FILTout <b>33</b> followed by a second NAT function NATout <b>32</b>. This second NAT is active only if there is a mapping rule for changing the destination IP address. Then, the packet is sent out of the firewall, into the DMZ <b>15</b> in the example. The need for output filtering and NAT is mainly for packets modified in the proxy and servers for which the input rules are irrelevant. These blocks should exist even if the NAT functions are not used.</p>
<p id="p-0023" num="0022">In the filtering block <b>31</b>, filtering rules determine whether or not a packet will be allowed through IP Filtering, into the kernel's TCP/IP routines or out onto the network. The Access List based Static filtering filters the packets using statically configured filters based on the following fields:</p>
<p id="p-0024" num="0023">Range of Source and Destination addresses</p>
<p id="p-0025" num="0024">Protocol Type (e.g. TCP, UDP, ICMP, IGMP, RSVP, OSPF, IGP, EGP, NVP)</p>
<p id="p-0026" num="0025">Source and Destination Port numbers</p>
<p id="p-0027" num="0026">TOS (Type of Service) field</p>
<p id="p-0028" num="0027">IP Options</p>
<p id="p-0029" num="0028">IP Fragmentation</p>
<p id="p-0030" num="0029">ICMP type and code</p>
<p id="p-0031" num="0030">Ack and Rst bit of TCP</p>
<p id="p-0032" num="0031">For IP Accounting, input and output rules can be also separately setup, recording the number of bytes that pass through. Each time a rule match occurs, the byte count of the packet is added to the rule (allowing for cascading statistics to be collected). IP accounting data may be kept either in the filtering module or in the IP Gateway module IPgw <b>35</b>. Raw data is given to control block CTRL <b>39</b> which gathers the data so as to provide it to the administrative entity. IP routing in IPgw <b>35</b> is a option that allows for forwarding packets according to routing rules defined in the routing control point RCP. Server <b>38</b> and proxy <b>36</b> support may also be included.</p>
<p id="p-0033" num="0032">Other functions may be integrated in server <b>38</b> or proxy <b>36</b> such as the IP Authentication function. In that case, packets which are authenticated, are only passed through the firewall loops once to prevent double-processing.</p>
<p id="p-0034" num="0033">Encryption such as IPsec tunneling is a function very often used in a firewall. As it is not possible to scan an encrypted tunnel, the decrypted packet coming from the encryption module will have to path through the output filtering function and therefore will be scanned.</p>
<p id="p-0035" num="0034">It must be noted that control block CTRL<b>1</b> <b>39</b>, administrating the firewall performs user (administrator of the firewall) authentication, configuration, log, statistics and problem determination so it has a link to any of the internal functional blocks (the links are not shown on the drawing as being not functional paths but only control means). The access to the firewall for administration can be always done through CONSOLE PORT <b>37</b>. The configuration may allow as well access to control CTRL <b>39</b> from NET<b>1</b> or DMZ sides even if the latter is not recommended for security reasons.</p>
<p id="p-0036" num="0035">According to the invention, a single firewall device illustrated in <figref idref="DRAWINGS">FIG. 4A and 4B</figref> replaces the two classical cascaded firewalls. As explained hereafter, the functional blocks are the same as in a classical firewall but they are not duplicated in two firewalls. In reference to <figref idref="DRAWINGS">FIG. 4A</figref> representing the firewall for data path from NET<b>1</b> to NET<b>2</b>, the first and last functions are the network address translation in blocks NATin<b>1</b> <b>30</b> and NATout<b>2</b> <b>42</b>. The associated rules may be needed between the input interface and the internal DMZ or between the DMZ and the output interface or both. The rules require the following parameters</p>
<p id="p-0037" num="0036">Original Source, Original Destination, Original Service referring to the source and destination address and service of the packet before translation and Translated Source, Translated Destination, Translated Service referring to those parameters after translation.</p>
<p id="p-0038" num="0037">A type of translation parameter (for example SNAT as static NAT, DNAT as Dynamic NAT, MASQUERADING also called Port address translation).</p>
<p id="p-0039" num="0038">The administrator of the locally attached network only manages NAT on its local interface. So only one input NAT NATin<b>1</b> <b>30</b> is implemented on NET<b>1</b> side and managed by the NET<b>1</b> administrator while the output NAT NATout<b>2</b> <b>42</b> is interfacing NET<b>2</b> and managed by the NET<b>2</b> administrator.</p>
<p id="p-0040" num="0039">As in a classical firewall, an essential function is the filtering, as already mentioned in reference to <figref idref="DRAWINGS">FIG. 3</figref>, achieved in the block FILTin<b>12</b> <b>41</b>. Some rules are associated with this function, such as Sequence Number Hardening rules, Stateful Inspection rules, Time-Sensitive Rules, Static Filtering Rules Per logical firewall split between input and output filtering blocks. Insofar as the data packets can be processed by further functions in a server or a proxy as already mentioned, another filtering block FILTout<b>12</b> <b>43</b> is necessary before NATout<b>2</b> <b>42</b>. The function of the output block is the same as the function of the block FILTin<b>12</b> located at the input.</p>
<p id="p-0041" num="0040">Importing/Exporting routing Rules are also defined for all packets but set by each administrator on the corresponding IP gateway also called Virtual routing and forwarding engine referenced as IPgw<b>1</b> <b>35</b> and IPgw<b>2</b> <b>45</b> located between blocks FILTin<b>12</b> <b>41</b> and FILTout<b>12</b> <b>42</b>. Each gateway gets the forwarding rules thanks to a dedicated Routing Control Point RCP<b>1</b> <b>34</b> and RCP<b>2</b> <b>44</b> respectively managing and advertising the routes for IPgw<b>1</b> and IPgw<b>2</b>. The administrators must exchange some information for providing route advertisement between these two gateways but no common block is required for that in a design using two different gateways. An optional design based on a single shared IP gateway is feasible when no routing visibility constraint exist between the two external networks NET<b>1</b> and NET<b>2</b> or if the IP gateway can be managed by only one of the administrator, the other one advertising its network routes thanks to an external router to the internal IP gateway and associated Routing Control Point.</p>
<p id="p-0042" num="0041">IP accounting information, gathered by one administrative entity from functional blocks such as NAT <b>30</b> and <b>42</b>, FILTERING blocks <b>41</b> and <b>43</b>, and IP gateways <b>35</b> and <b>45</b>, is stored in dedicated control block either CTRL<b>1</b> <b>39</b> or CTRL<b>2</b> <b>49</b>. Global statistics of the aggregated traffic are stored in COMMON CTRL <b>47</b>.</p>
<p id="p-0043" num="0042">Other dedicated administrative functions such as Email Notification, network management and Password security are managed separately in CTRL<b>1</b> <b>39</b> and CTRL<b>2</b> <b>49</b>. Original firewall configuration from each administrator is also kept in the respective control block. The security and integrity of each part of the configuration are achieved thanks to certified configuration (certificates) that allows reducing to a single equipment this dual entity without security issue.</p>
<p id="p-0044" num="0043">The existing dedicated proxy such as PXY<b>1</b> <b>36</b> and PXY<b>2</b> <b>46</b>, and server functions such as SRV<b>1</b> <b>38</b> and SRV<b>2</b> <b>48</b> continue to be dedicated in the proposed design being each attached to the corresponding IPgateway block respectively IPgw<b>1</b> <b>35</b> and IPgw<b>2</b> <b>45</b>.</p>
<p id="p-0045" num="0044">The connection from IPgw<b>1</b> to IPgw<b>2</b> may be considered as the remaining DMZ and may provide an external connection for external servers such as SR <b>18</b>.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 4B</figref> shows the flow for traffic from NET<b>2</b> <b>16</b> to NET<b>1</b> <b>10</b>. Most of the functional blocks are common with the opposite flow described in <figref idref="DRAWINGS">FIG. 4A</figref> since they are the same blocks as for legacy simple firewalls.</p>
<p id="p-0047" num="0046">The main differences concern blocks NATin<b>2</b> <b>42</b>′ and block FILTin<b>21</b> <b>43</b>′ on NET<b>2</b> side and blocks NATout<b>1</b> <b>30</b>′ and block FILTout<b>21</b> <b>41</b>′ on NET<b>1</b> side.</p>
<p id="p-0048" num="0047">NATin<b>2</b> <b>42</b>′ has a strong relationship with NATout<b>2</b> <b>42</b> since, as soon as one NAT mapping is defined in one of the two blocks, the reverse mapping has to be activated on the other block as a swap back function. Similarly NATout<b>1</b> <b>30</b>′ and NATin<b>1</b> <b>30</b> have the same link between them.</p>
<p id="p-0049" num="0048">FILTin<b>21</b> and FILTout<b>12</b> have no relationship except for stateful inspection rules insofar as one flow identified on one side will be granted on the other side. This means that dynamic rules are added on both blocks thanks to the stateful inspection function as done for legacy firewalls. The same stateful link may be implemented between FILTout <b>21</b> and FILTin<b>12</b>.</p>
<p id="p-0050" num="0049">Referring again to <figref idref="DRAWINGS">FIG. 4A and 4B</figref>, an essential feature of the invention is the MERGE block <b>40</b> used to merge the rules. Before explaining the merging process, it is useful to mention that the filtering mechanism of a firewall applies the rules in a sequence mode by using a list of rules. If the incoming packet matches the first rule, it exits the filtering block and is forwarded to the next firewall functional block. If not, the second rule is applied and so on. Normally it should match a rule. For security reasons, the last rule applied is an implicit rule to deny all the unmatched messages. The unmatched messages are messages which have not matched a rule before the end of the rule sequence. As the last rule is most often a “deny all”, a packet arriving at this last rule is discarded. In a dual firewall mechanism according to the invention, it is therefore essential to merge the rules so as to apply a reduced number of rules.</p>
<p id="p-0051" num="0050">The merging process is done independently for FILTin<b>12</b> or FILTout<b>12</b>. Thanks to this mechanism, the dual administrated Firewall can check for redundant rules from each administrator in order to optimize the performance. Neither of the two administrators may gain access to the result of the merging in order to protect the rules knowledge but the administrator of each side can identify that his rules have been correctly implemented thanks to the identification of the merging done rule by rule.</p>
<p id="p-0052" num="0051">In a classical system, the cascade of two firewalls means that on each direction output rules on one firewall are followed by input rules on the second firewall. This is no longer the case with the proposed rules merging function since most of the filtering rules can be run once in a simplified model integrating the two logical firewalls as it will be explained with more details hereafter.</p>
<p id="p-0053" num="0052">Two sets of logs are built and managed by CTRL<b>1</b> and CTRL<b>2</b> insofar as each rule even after merging is identified with its parent rule from each side. Each administrator may define each information, rule or file as common or local so that some logs or alarms for example may be shared. In that case, the control is given to the common control Block COMMON CTRL <b>47</b> which handles all common features, files and services. The Common features include the Configuration Interface used by both administrators to set each new configuration from each side, the Activity Viewer which shows in real time the traffic from NET<b>1</b> to NET<b>2</b> including the DMZ activity, the Logging mechanism of alerts and events that defines to which block CTRL<b>1</b>, CTRL<b>2</b> or COMMON CTRL the events have to be stored, the hardware management for installation and problem determination and the user authentication interface as a common mechanism required to identify administrators of each logical firewall entity on login request coming from CONSOLE PORT <b>37</b> or interfaces with NET<b>1</b> or NET<b>2</b>.</p>
<p id="p-0054" num="0053">For comparison, a legacy firewall includes as control block what is in CTRL<b>1</b> and COMMON CONTROL except that in such case, identification to which logical firewall the user belongs is not necessary and logging of traffic information does not have to be define since only one set of log files is available.</p>
<p id="p-0055" num="0054">An administrator may allow or not the access to the other side of the firewall administration on its direct access interface. On a legacy firewall, the administration using for example telnet is feasible from any interface. Of course, the administrator can lock some ports such as the public network interface. On a dual firewall, the administrator of each side manages this authorization and therefore the access using other ports or interfaces than the one dedicated to its network may be locked. This means that the port lock cannot be done at the protocol level, for example authorizing telnet or not on a port, because the administrator of one side wants to keep this protocol access on an interface for himself but not for the administrator of the other side. A more complex filtering mechanism using an external authentication server such as TACACS or RADIUS is recommended to securely authenticate the user and its rights to one side or the other of the dual firewall. If there is a need to allow administration from the different interfaces, the authentication servers of the two administrative entities should be linked together to allow forwarding of the authentication to the appropriate server.</p>
<p id="p-0056" num="0055">In reference to <figref idref="DRAWINGS">FIG. 5</figref>, a merge function using 2 input configuration files <b>50</b> and <b>51</b> has to be considered. The merge function has to take into account the rules that can be fully merged or partially merged and the order to apply them against the remaining set of rules. It is based on a tree per configuration that allows a new common tree to be built and then leaf merged.</p>
<p id="p-0057" num="0056">The remaining merged set of rules becomes the applied common set of rules. Whether this configuration file is visible to both administrative entities or visible to only one or none of them depends on the agreement between companies.</p>
<p id="p-0058" num="0057">In order to explain how rules can be merged, it is necessary to detail how, in a standard firewall, the filtering rules are built with the same structure for defining them which looks like the following set of fields by rule: “Action”, “ProtocolType”, “@sourceA”, “@destinationB”, “PortNumber”, “Options”.</p>
<p id="p-0059" num="0058">The fields value or content may be as an example:</p>
<p id="p-0060" num="0059">“Action” is Permit or Deny</p>
<p id="p-0061" num="0060">“Protocol Type” defines the protocol on which this rule is applied (i.e. IP, TCP, UDP . . . )</p>
<p id="p-0062" num="0061">“@sourceA” describes the Source IP address of IP Datagram</p>
<p id="p-0063" num="0062">“@destinationB” describes the Destination IP address of IP Datagram</p>
<p id="p-0064" num="0063">“PortNumber” defines the specific port number related of the chosen protocol</p>
<p id="p-0065" num="0064">“Options” defines the additional parameters which can be set to create rules more precise (i.e. Tos, Dscp, . . . )</p>
<p id="p-0066" num="0065">In the firewall system according to the invention the two administrators can define the filtering rules. To know which administrator has defined the rules an implicit Tag is added in the rule structure.</p>
<p id="p-0067" num="0066">This tag is coded with 3 bits and has 5 different states:</p>
<p id="p-0068" num="0067">“0” coded “000”: describes that this rule has been defined in CTRL<b>1</b> <b>39</b>,</p>
<p id="p-0069" num="0068">“1” coded “001”: describes that this rule has been defined in CTRL<b>2</b> <b>49</b>,</p>
<p id="p-0070" num="0069">“2” coded “010”: describes that this rule has been defined in CTRL<b>1</b> <b>39</b> and in CTRL<b>2</b> <b>49</b>,</p>
<p id="p-0071" num="0070">“3” coded “011”: describes that the rule defined in CTRL<b>2</b> <b>49</b> includes the rule defined in CTRL<b>1</b> <b>39</b>,</p>
<p id="p-0072" num="0071">“4” coded “100”: describes that the rule defined in CTRL<b>1</b> <b>39</b> includes the rule defined in CTRL<b>2</b> <b>49</b>.</p>
<p id="p-0073" num="0072">In order to separate action logs (for debugging purpose) by Control Block CTRL<b>1</b> <b>39</b> and CTRL<b>2</b> <b>49</b> and using a secure way, a point of reference makes the correspondence between the Tag Number and at which Control Block the rule is referring to:</p>
<p id="p-0074" num="0073">Tag Value=0 then Control Block of reference is CTRL<b>1</b> <b>39</b>,</p>
<p id="p-0075" num="0074">Tag Value=1 then Control Block of reference is CTRL<b>2</b> <b>49</b>,</p>
<p id="p-0076" num="0075">Tag Value=2 then Control Blocks of reference are CTRL<b>1</b> <b>39</b> and CTRL<b>2</b> <b>49</b>,</p>
<p id="p-0077" num="0076">Tag Value=3 then Control Block of reference is CTRL<b>2</b> <b>49</b>,</p>
<p id="p-0078" num="0077">Tag Value=4 then Control Block of reference is CTRL<b>1</b> <b>39</b>.</p>
<p id="p-0079" num="0078">The first step is to compare a rule from the configuration file CF<b>1</b> <b>50</b> (defined through CTRL<b>1</b> <b>39</b>) with rules from the configuration file CF<b>2</b> <b>51</b> (defined through CTRL<b>2</b> <b>49</b>) in order to check whether a CF<b>1</b> rule can be merged with one of the CF<b>2</b> rules. When a rule processing is completed, the next rule from CF<b>1</b> is put in the merging process block <b>40</b>.</p>
<p id="p-0080" num="0079">The checking process for identifying a possible merge is done in step <b>52</b>. The comparison is done against the 5 fields of a rule as mentioned above.</p>
<p id="p-0081" num="0080">The minimum requirements to merge two rules are to have the same Action, the same Protocol and the same Port number if present plus overlapping Source Addresses and/or Destination Addresses.</p>
<p id="p-0082" num="0081">If these requirements are met then the rules can be merged and the checking process <b>52</b> forwards the corresponding rules to the checking process <b>53</b>.</p>
<p id="p-0083" num="0082">If one requirement is missing, then the rules cannot be merged and then the checking process <b>52</b> forwards the rules to the process <b>56</b>.</p>
<p id="p-0084" num="0083">The process <b>56</b> modifies rule<b>1</b> and rule<b>2</b> by adding the appropriate TAG values (0 for rule<b>1</b> and 1 for rule <b>2</b>) and placing the two rules in the rule config file <b>60</b>. The corresponding rule<b>2</b> with TAG=0 is kept in CF<b>2</b> rules config file <b>51</b> as it can be merged with a next CF<b>1</b> rule. In that case the TAG value in COMMON RULE CONFIG <b>60</b> may be overwritten</p>
<p id="p-0085" num="0084">When a merge is possible, the step <b>53</b> checks if the two rules (rule<b>1</b> and rule<b>2</b>) are the same. If Yes, this process sends only the rule<b>1</b> to the process <b>57</b>, which modifies the rule<b>1</b> by adding the TAG value 2 and put it in the rule config file <b>60</b>. If the rule<b>1</b> and rule<b>2</b> are in some aspect different then the two rules are forwarded to step <b>54</b>.</p>
<p id="p-0086" num="0085">Step <b>54</b> checks if rule<b>1</b> is included in term of Source/Destination addresses in rule<b>2</b>.</p>
<p id="p-0087" num="0086">If yes, the process <b>54</b> sends rule<b>1</b> to the process <b>58</b> which modifies rule<b>1</b> by adding the tag value 3, and sends it in the rule config file <b>60</b>. If rule<b>1</b> is not included in rule<b>2</b> then the two rules are forwarded to step <b>55</b>.</p>
<p id="p-0088" num="0087">Step <b>55</b> reversely checks if rule<b>2</b> is included in term of Source/Destination addresses in rule<b>1</b>.</p>
<p id="p-0089" num="0088">If yes, the process of step <b>55</b> sends rule<b>2</b> to step <b>59</b> which modifies the rule by adding the tag value 4 and put it in the rule config file <b>60</b> If the rule<b>2</b> is not included in rule<b>1</b> then the two rules are re-forwarded to the checking process <b>52</b>, which knows that these rules have been already checked, and then send them to the process of step <b>56</b>, as they cannot be merged in an improved way.</p>
<p id="p-0090" num="0089">Note that the Rule inclusion is different whether the rule is a DENY or PERMIT rule.
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0090">A PERMIT rule A is included into another permit rule B if subnet space—source or destination—of the former is larger than the one of the latter. The most restrictive one in terms of addressing space is kept: rule B.</li>
        <li id="ul0002-0002" num="0091">A DENY rule A is included into another deny rule B if subnet space—source or destination—of the former is smaller than the one of the latter. The most restrictive one is kept: rule B.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0091" num="0092">When two rules match, the checking with the remaining part of the list is stopped. An improved merging process with more than one pass is possible. It may be recommended when the number of rules is very important. It that case, multiple inclusion of rules may be used.</p>
<p id="p-0092" num="0093">The merging process will be better understood with the following example wherein the list of CF<b>1</b> rules and the list of CF<b>2</b> rules are as follows:</p>
<p id="h-0006" num="0000">CF<b>1</b> List of Rules</p>
<p id="p-0093" num="0094">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="35pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<colspec colname="5" colwidth="28pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="5" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Permit</entry>
<entry>TTCP</entry>
<entry>172.20.0.0</entry>
<entry>192.0.0.0</entry>
<entry>23</entry>
</row>
<row>
<entry/>
<entry>Permit</entry>
<entry>ICMP</entry>
<entry>any</entry>
<entry>any</entry>
</row>
<row>
<entry/>
<entry>Deny</entry>
<entry>IP</entry>
<entry>192.168.10.0</entry>
<entry>192.168.20.0</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
<br/>
CF<b>2</b> List of Rules
</p>
<p id="p-0094" num="0095">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="6">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="35pt" align="left"/>
<colspec colname="2" colwidth="42pt" align="left"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<colspec colname="4" colwidth="49pt" align="left"/>
<colspec colname="5" colwidth="28pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="5" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Permit</entry>
<entry>ICMP</entry>
<entry>172.0.0.0</entry>
<entry>192.168.0.0</entry>
<entry/>
</row>
<row>
<entry/>
<entry>Permit</entry>
<entry>TCP</entry>
<entry>any</entry>
<entry>any</entry>
<entry>23</entry>
</row>
<row>
<entry/>
<entry>Permit</entry>
<entry>UDP</entry>
<entry>172.0.0.0</entry>
<entry>192.0.0.0</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="5" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0095" num="0096">The first CF<b>1</b> rule is compared to CF<b>2</b> rule <b>1</b>:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0097">The protocol types are not the same then these rules cannot be merged.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0096" num="0098">The first CF<b>1</b> rule is compared to CF<b>2</b> rule <b>2</b>:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0099">The CF<b>1</b> rule <b>1</b> is included in CF<b>2</b> rule <b>2</b>, then these rules can be merged: CF<b>1</b> Rule <b>1</b> is kept.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0097" num="0100">The second CF<b>1</b> rule is compared to CF<b>2</b> rule <b>1</b>
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0101">The CF<b>2</b> rule <b>1</b> is included in CF<b>1</b> rule <b>2</b>, then these rules can be merged: CF<b>2</b> Rule <b>1</b> is kept.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0098" num="0102">The third CF<b>1</b> rule is compared to CF<b>2</b> rule <b>1</b>
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0000">
    <ul id="ul0010" list-style="none">
        <li id="ul0010-0001" num="0103">The Action fields are not the same then these rules cannot be merged.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0099" num="0104">The third CF<b>1</b> rule is compared to CF<b>2</b> rule <b>2</b>
<ul id="ul0011" list-style="none">
    <li id="ul0011-0001" num="0000">
    <ul id="ul0012" list-style="none">
        <li id="ul0012-0001" num="0105">The Action fields are not the same then these rules cannot be merged.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0100" num="0106">The third CF<b>1</b> rule is compared to CF<b>2</b> rule <b>3</b>
<ul id="ul0013" list-style="none">
    <li id="ul0013-0001" num="0000">
    <ul id="ul0014" list-style="none">
        <li id="ul0014-0001" num="0107">The Action fields are not the same then these rules cannot be merged.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0101" num="0108">In this example, the common configuration file CF<b>12</b> got after rules comparison and merging is the following:</p>
<p id="p-0102" num="0109">
<tables id="TABLE-US-00003" num="00003">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="5">
<colspec colname="offset" colwidth="14pt" align="left"/>
<colspec colname="1" colwidth="42pt" align="left"/>
<colspec colname="2" colwidth="49pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<colspec colname="4" colwidth="56pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>Permit</entry>
<entry>TCP</entry>
<entry>172.20.0.0</entry>
<entry>192.0.0.0</entry>
</row>
<row>
<entry/>
<entry>Permit</entry>
<entry>ICMP</entry>
<entry>172.0.0.0</entry>
<entry>192.168.0.0</entry>
</row>
<row>
<entry/>
<entry>Deny</entry>
<entry>IP</entry>
<entry>192.168.10.0</entry>
<entry>192.168.20.0</entry>
</row>
<row>
<entry/>
<entry>Permit</entry>
<entry>UDP</entry>
<entry>172.0.0.0</entry>
<entry>192.0.0.0</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="4" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A firewall system for interconnecting a first IP network to a second IP network, wherein a data packet transmitted or received by the first IP network is filtered by using a first firewall function and a data packet transmitted or received by the second IP network is filtered by using a second firewall function, the firewall system comprising:
<claim-text>a console port for enabling an administrator to administer each lP network and to enter filtering rules for updating the associated firewall function;</claim-text>
<claim-text>control means for interconnecting to the console port;</claim-text>
<claim-text>a firewall device in communication with the console port, and comprising a filtering means for performing both the first firewall function and the second firewall function, and for transmitting filtering rules so that each administrator of the first IP network and the second IP network independently manages their respective networks from the console port;</claim-text>
<claim-text>wherein the filtering means further comprises a first filtering unit for performing the first filtering function and a second filtering unit for performing the second firewall function; and</claim-text>
<claim-text>a second network address translation unit interconnected between the second IP network and the second filtering unit for changing a destination IP address of a packet transmitted to the second IP network and for changing the source IP address of a packet received from the second IP network.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The firewall system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising an IP gateway interconnected between the first filtering unit and the second filtering unit for determining the routing rules to be applied to data packets, and a routing control point in communication with the IP gateway for providing routing rules.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The firewall system of <claim-ref idref="CLM-00001">claim 1</claim-ref>, comprising a first IP gateway in communication with the first IP network for retrieving routing rules from a first routing control point, and a second IP gateway in communication with the second IP network for retrieving routing rules from a second routing control point.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The firewall system of <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein said control means includes a common control unit connected to the console port for identifying the administrator entering filtering rules through the console port, and a first control unit and a second control unit respectively in communication with the first and second IP networks, for managing the filtering rules.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The firewall system of <claim-ref idref="CLM-00004">claim 4</claim-ref>, further comprising a merge unit connected to the first control unit and to the second control unit for determining whether a rule entered by an administrator is redundant with respect to one of the rules entered by the other administrator.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The firewall system of <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein the merge unit determines whether to merge two rules when the two rules correspond to the same action, the same protocol, the same port number, or when there is an overlapping source address and/or destination address.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The firewall system of <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the merge unit determines whether two rules are identical and if so, transmits one of the rules to a common rule configuration file to be used as filtering rule for both the first and second firewall functions.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The firewall system of <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein the merge unit determines whether one of two rules is included in the other rule, when the rules are not identical and if so, transmits the included rule to the common rule configuration file.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The firewall system of <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein a tag is added to each rule before sending the rule to the common rule configuration file, the tag being used to identify the type of rule as determined by the merge unit.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The firewall system of <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the merge unit compares a rule entered by the administrator with a subsequent rule entered by the other administrator when the merge unit decides not to merge the two rules and stops comparing when the merge unit decides to merge the rules.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The firewall system of <claim-ref idref="CLM-00010">claim 10</claim-ref>, wherein the firewall device comprises a first firewall device and a second firewail device which are functionally identical for processing respectively the data packets in the data path from the first IP network to the second IP network and the data packets in the data path from the second IP network and the first IP network.</claim-text>
</claim>
</claims>
</us-patent-grant>
