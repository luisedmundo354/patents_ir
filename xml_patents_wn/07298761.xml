<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298761-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298761</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10434201</doc-number>
<date>20030509</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>903</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>16</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>22</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>B</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>Q</subclass>
<main-group>7</main-group>
<subgroup>20</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370466</main-classification>
<further-classification>370310</further-classification>
<further-classification>455 412</further-classification>
<further-classification>455449</further-classification>
</classification-national>
<invention-title id="d0e53">Link path searching and maintaining method for a bluetooth scatternet</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>6535498</doc-number>
<kind>B1</kind>
<name>Larsson et al.</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370338</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6834192</doc-number>
<kind>B1</kind>
<name>Watanabe et al.</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>455444</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>2002/0039357</doc-number>
<kind>A1</kind>
<name>Lipasti et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370338</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2002/0044549</doc-number>
<kind>A1</kind>
<name>Johansson et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370386</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2003/0110291</doc-number>
<kind>A1</kind>
<name>Chen</name>
<date>20030600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709244</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2003/0202477</doc-number>
<kind>A1</kind>
<name>Zhen et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370248</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>11</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370466</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370310</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455 411- 413</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455444</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455449</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>14</number-of-drawing-sheets>
<number-of-figures>15</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040223512</doc-number>
<kind>A1</kind>
<date>20041111</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Hong</last-name>
<first-name>Alexander T. P.</first-name>
<address>
<city>Taipei</city>
<country>TW</country>
</address>
</addressbook>
<nationality>
<country>TW</country>
</nationality>
<residence>
<country>TW</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Bacon &amp; Thomas, PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Institute for Information Industry</orgname>
<role>03</role>
<address>
<city>Taipei</city>
<country>TW</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Rao</last-name>
<first-name>Seema S.</first-name>
<department>2616</department>
</primary-examiner>
<assistant-examiner>
<last-name>Wu</last-name>
<first-name>Jianye</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A link path search and maintain method for establishing link search table between two bluetooth devices such that the devices can transfer data to/from others device located in a bluetooth scatternet. When initialization of a slave bluetooth device, the new member in a bluetooth piconet receives a link search table that transmitted from a master bluetooth device to establish a local link search table; as the link is broken or the link search table needs be updated, the slave bluetooth device executes a link search establishment transmission procedure or a link search establishment receiving procedure to update the local link search table or establish a new link search table. Then, the slave bluetooth device encapsulates the bluetooth data packet according the information of the local link search table in order to transfer data packet in a scatternet.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="250.44mm" wi="155.19mm" file="US07298761-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="263.14mm" wi="179.49mm" file="US07298761-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="194.99mm" wi="149.52mm" orientation="landscape" file="US07298761-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="136.65mm" wi="143.68mm" file="US07298761-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="235.97mm" wi="122.17mm" file="US07298761-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="259.93mm" wi="159.94mm" file="US07298761-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="238.42mm" wi="117.26mm" orientation="landscape" file="US07298761-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="209.47mm" wi="149.10mm" file="US07298761-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="232.33mm" wi="115.15mm" file="US07298761-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="218.19mm" wi="158.16mm" file="US07298761-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="198.29mm" wi="134.54mm" file="US07298761-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="237.66mm" wi="144.53mm" file="US07298761-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="202.44mm" wi="149.44mm" file="US07298761-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="181.36mm" wi="146.13mm" orientation="landscape" file="US07298761-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="250.44mm" wi="146.56mm" orientation="landscape" file="US07298761-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to the technical field of bluetooth scatternet and, more particularly, to a link path searching and maintaining method that is used in a bluetooth scatternet.</p>
<p id="p-0004" num="0003">2. Description of Related Art</p>
<p id="p-0005" num="0004"><figref idref="DRAWINGS">FIG. 1</figref> shows a method for transferring data in a bluetooth network. The whole network is divided into several isolated piconets. In each piconet, there are one master bluetooth device and multiple salve bluetooth devices. The master device controls the data transfer procedure to and from the target slave device in a piconet. In the specification of bluetooth, a scatternet that is formed by multiple piconets is mentioned. However, in the specification, there is no rule and guideline provided for data transfer in a scatternet. As shown in <figref idref="DRAWINGS">FIG. 2</figref>, although all piconets can form a scatternet, in accordance with the current specification and technology of piconet and scatternet, data can only be transferred inside a specific piconet but not crossing the boundary of the piconet. That is, data cannot be transferred in a scatternet, link search table cannot be established and initialized in a scatternet and link search table cannot be updated as the link is broken in a scatternet. Therefore, there is a need to have a novel design to transfer data in a scatternet that can mitigate and/or obviate the aforementioned problems.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0006" num="0005">The object of the present invention is to provide a link path searching and maintaining method capable of establishing link search table between two bluetooth devices located in a scatternet based on the bluetooth technology, so as to remove the limitation of the current bluetooth technology that can only transfer data in a piconet.</p>
<p id="p-0007" num="0006">One object of the present invention is to provide a link path search and maintain method for establishing link search table between two bluetooth devices such that the devices can transfer data to/from others device located in a bluetooth scatternet. The method comprises the steps of: (A) when initialization of a slave bluetooth device that add in a bluetooth piconet, the slave bluetooth device receives a link search table that transmitted from a master bluetooth device to establish a local link search table; (B) as the link is broken or the link search table needs be updated, the slave bluetooth device executes a link search establishment transmission procedure; and (C) the slave bluetooth device executes a link search establishment receiving procedure as receives a link search packet to update the local link search table or establish a new link search table. Then, the slave bluetooth device encapsulates the bluetooth data packet according the information of the local link search table in order to transfer data packet in a scatternet.</p>
<p id="p-0008" num="0007">Another object of the present invention is to provide a link searching and maintaining method for establishing a link search table between two bluetooth devices located in a bluetooth scatternet, the bluetooth device comprises a link update variable, a link update timer, an initialization procedure executing timer, an initialization procedure trigger timer, a missing timer and a link search table which sends a link searching packet to establish the link search table, wherein the link searching packet comprises a link number field, a source IP address field, a source bluetooth address (BD_Addr) field, a sender bluetooth address (BD_Addr) field, a link search number field, and multiple search link identification fields, the method comprising: (A) filling the corresponding fields of the link search packet; (B) enabling the link update variable and link update timer; (C) filling the link number field with 0; and (D) encapsulating with the bluetooth packet header and transmitting through the bluetooth channel.</p>
<p id="p-0009" num="0008">Other objects, advantages, and novel features of the invention will become more apparent from the following detailed description when taken in conjunction with the accompanying drawings.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> shows the data transfer in a conventional bluetooth piconet;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> shows multiple piconets forming a scatternet in conventional bluetooth;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> shows system architecture of a bluetooth device in accordance with the present invention;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> shows the architecture of the baseband driver of the present invention;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 5</figref> shows the flowchart for link search of the present invention;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 6</figref> shows the link search packet format of the present invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 7</figref> shows the procedure for establishing link search establishment of the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 8</figref> shows the flowchart for establishing and initializing the link search table of the present invention;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 9</figref> shows the flowchart for updating the link search table as a link is broken in accordance with the present invention;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 10</figref> shows the flowchart for receiving link search packet of a bluetooth device in accordance with the present invention;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 11</figref> shows the flowchart for comparing the comparison table and the link search table in accordance with the present invention;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 12</figref> shows the flowchart for re-transmitting the link search packet in accordance with the present invention;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 13</figref> shows scatternet system architecture for transmitting the link search packet from node A to node J in accordance with the present invention; and</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 14</figref> shows the link search table for transmitting the link search packet from node A to node J of as shown in <figref idref="DRAWINGS">FIG. 13</figref>;</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENT</heading>
<p id="p-0024" num="0023">Referring now to <figref idref="DRAWINGS">FIG. 3</figref>, there is illustrated the system architecture of a bluetooth device in accordance with the present invention. The device has a bluetooth protocol layer <b>100</b> and a bluetooth baseband and physical layer <b>200</b>. The bluetooth protocol layer <b>100</b> has a logical link control and adaptation protocol (L2CAP) <b>120</b> and a link manager protocol (LMP) <b>110</b> for handling the corresponding protocol of bluetooth technology. The bluetooth baseband and physical layer <b>200</b> has a baseband processor <b>210</b> and a RF circuit <b>220</b> for handling the corresponding baseband and radio frequency of bluetooth technology. When exhausting the bandwidth of bluetooth channel and affecting the data transmitting by executing the link searching method of the present invention, it can add a bluetooth baseband and physical layer <b>300</b>, an inter-link layer <b>140</b>, a baseband drivers <b>130</b> as shows in <figref idref="DRAWINGS">FIG. 3</figref>. The bluetooth baseband and physical layer <b>300</b> executes exclusively for link manager protocol (LPM) and connects with the baseband drivers <b>130</b>. The inter-link layer <b>140</b> provides an interface between the logical link control and adaptation protocol (L2CAP) <b>110</b> and the baseband drivers <b>130</b>.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 4</figref> shows an architecture of the baseband driver <b>130</b> of the present invention that comprises a control entity <b>131</b>, a data transmission procedure <b>132</b>, a service manager <b>133</b>, a driver for data transmission baseband processor <b>134</b>, a link detection procedure <b>135</b> and a driver for link management baseband processor <b>136</b>. In comparison with the conventional bluetooth baseband driver, the link detection procedure <b>135</b> and the driver for link management baseband processor <b>136</b> are provided to execute the management of links for preventing the bandwidth of the data transmission from being reduced.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 5</figref> shows an embodiment of the link path searching method for a bluetooth scatternet according to the present invention, which transfers data packet between bluetooth devices in a scatternet. The bluetooth device according to the present invention comprises multiple link detection timers, a detection procedure timer, a master/slave flag, an initialization procedure executing timer, an initialization procedure trigger timer and a missing timer. The link path searching method executes a link initialization procedure (P<b>501</b>) first. When resetting or initializing a link, the link initialization procedure determines whether the bluetooth device is a slave or a master device and initializes the corresponding timers. In the link search establishment procedure (P<b>502</b>), it searches all possible paths for transferring data packet and establishes a link path table. Then, when the corresponding link detection timer of a link expires after a pre-determined period, the link detection procedure (P<b>503</b>) is resumed to detect whether the link exists or not. If the link is not existed, the process goes back to the link initialization procedure (P<b>501</b>). If the link is existed, it further determines whether to execute the link initialization procedure again. If yes, the process goes back to link initialization procedure (P<b>501</b>), otherwise the process goes back to the link detection procedure (P<b>503</b>).</p>
<p id="p-0027" num="0026">The link path searching and maintaining method for a bluetooth scatternet according to present invention generates a link search packet by internal mechanism of the inter-link layer <b>140</b>. <figref idref="DRAWINGS">FIG. 6</figref> shows the data packet format of the link search packet according to present invention, which includes a link field length, a link number, a search field length, an IP version flag, a source IP, a source BD_addr, a sender BD_addr, a link search number, and multiple search link IDs (ID<b>1</b>, ID<b>2</b>, IDn). The bluetooth devices broadcast link search packets on the bluetooth channel to establish a link search table, and the bluetooth device comprises a link update variable and a link update timer.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 7</figref> schematically illustrates the link search establishment procedure (P<b>502</b>) in accordance with the present invention. It comprises a link search table establishment and initialization procedure (P<b>701</b>), a link search establishment transmission procedure (P<b>702</b>) and a link search establishment receiving procedure (P<b>703</b>). <figref idref="DRAWINGS">FIG. 8</figref> shows the flowchart for the link search table establishment and initialization procedure (P<b>701</b>). <figref idref="DRAWINGS">FIG. 9</figref> shows the flowchart for the link search establishment transmission procedure (P<b>702</b>) that is triggered when a link is broken or the bluetooth device cannot find the target bluetooth device for transferring data packets thereto. <figref idref="DRAWINGS">FIG. 10</figref> shows the flowchart for the link search establishment receiving procedure (P<b>703</b>) that is triggered when a bluetooth device receives a link search packet.</p>
<p id="p-0029" num="0028">As shown in <figref idref="DRAWINGS">FIG. 8</figref>, in step S<b>801</b>, when a new bluetooth device is involved in a piconet, the new device executes the standard bluetooth link procedure. In step <b>802</b>, the new device is linked with the piconet in the logical link control and adaptation protocol (L2CAP) layer, and the slave bluetooth device requests the master bluetooth device to send its corresponding link search table. In step <b>803</b>, the master bluetooth device sends the corresponding link search table to the slave bluetooth device. In step <b>804</b>, the new device establishes or updates the local link search table based on the received link search table. In step <b>805</b>, the new device fills the corresponding fields in a packet according to the local link search table to transmit the packet.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 9</figref> shows the flowchart for the link search establishment transmission procedure (P<b>702</b>) that is triggered when a link is broken or the bluetooth device cannot find the target bluetooth device for transferring data packets thereto. In step S<b>901</b>, it fills the corresponding fields of the link search packet, wherein the link search number is filled with number 1 to indicate that the link search packet is first transmitted. The source IP field is filled with the IP of the bluetooth device. The source BD_Addr field is filled with the bluetooth address of the bluetooth device to map the IP address and the bluetooth address. The sender BD_Addr field is filled with the bluetooth address of the bluetooth device to indicate that the device is the first device to send the link search packet.</p>
<p id="p-0031" num="0030">In step S<b>902</b>, it enables the link update variable and link update timer. In step S<b>903</b>, the link number field is filled with number 0 to indicate that the packet is a link search packet and is transmitted for broadcasting. In step S<b>904</b>, the link search packet is encapsulated with the bluetooth packet header and transmitted through the bluetooth channel.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 10</figref> shows the flowchart for the link search establishment receiving procedure (P<b>703</b>) that is triggered when a bluetooth device receives a link search packet. In step S<b>1001</b>, the bluetooth device that receives a link search packet unpacks the link search packet. In step S<b>1002</b>, it is determined whether the link number field is equal to 0 or not. If the link number field is not equal to 0, it means that the packet is a data packet and a data packet transmission/receiving procedure is performed (step S<b>1003</b>). If the link number field is equal to 0, it means that the packet is a link search packet and the process goes to step S<b>1004</b>.</p>
<p id="p-0033" num="0032">In step S<b>1004</b>, the corresponding fields of the received link search packet are recorded to a comparison table in the bluetooth device. The corresponding fields are IP version flag, source IP, and source BD_addr and sender BD_addr. It also records the link search number with value m and corresponding search link IDm to the comparison table.</p>
<p id="p-0034" num="0033">In step S<b>1005</b>, each field in the comparison table and the link search table is compared to generate a flag. In step S<b>1006</b>, according to the flag, it determines whether to re-transmit the received link search packet or not. If yes, the received link search packet is re-transmitted (step S<b>1007</b>).</p>
<p id="p-0035" num="0034">If it decides not to re-transmit the received link search packet, step S<b>1008</b> is executed to determine whether to enable link update variable or not. If the link update variable is not enabled, it means that the bluetooth device did not transmit a link search packet and has never executed the link search establishment transmission procedure (P<b>702</b>). Then, the process goes to the link search establishment transmission procedure (P<b>702</b>). If the link update variable is enabled, it means that the bluetooth device has transmitted a link search packet and has executed the link search establishment transmission procedure (P<b>702</b>). Therefore, it updates the link update timer in step S<b>1009</b>.</p>
<p id="p-0036" num="0035">In step S<b>1010</b>, it determines whether the bluetooth device receives other link search packet or not. If the bluetooth device receives other link search packet, the process goes back to step S<b>1001</b>. In step S<b>1011</b>, it determines whether the link update timer is expired or not. If the link update timer is not expired, it means that the bluetooth device can continuously receive the link search packet transmitted from other bluetooth device and then the process goes back to step S<b>1010</b>. In step S<b>1011</b>, if the link update timer is expired, it means that there is no bluetooth device in the scatternet to transmit the link search packet, and then step S<b>1012</b> is executed to disable the link update variable of the bluetooth device. In step S<b>1013</b>, the records in the comparison table are cleared.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 11</figref> shows the flowchart for comparing the comparison table and the link search table in step S<b>1005</b>. In step S<b>111</b>, it retrieves the corresponding data from the comparison table. In step S<b>112</b>, it determines whether the source IP address is equal to the IP address of the bluetooth device or not. If the source IP address is not equal to the IP address of the bluetooth device, step S<b>113</b> is executed to determine whether the source BD_addr is equal to the BD_addr of the bluetooth device or not. If the source BD_addr is not equal to the BD_addr of the bluetooth device, step S<b>114</b> is executed to determine whether the sender BD_addr is equal to the BD_addr of the bluetooth device or not. The comparisons in the steps S<b>112</b>, S<b>113</b> and S<b>114</b> are provided to prevent the bluetooth device from receiving the link search packets that are sent by itself.</p>
<p id="p-0038" num="0037">If the sender BD_addr is not equal to the BD_addr of the bluetooth device, step S<b>115</b> is executed to determine whether the link search number is equal to a specific number, for example15, or not. If the link search number is not equal to 15, it records the source IP address, source BD_addr and multiple search link IDs to the link search table of the bluetooth (step S<b>116</b>). In step S<b>117</b>, it generates a flag for continuously transmitting the link search packet.</p>
<p id="p-0039" num="0038">If the source IP address is equal to the IP address of the bluetooth device in step S<b>112</b>, or the source BD_addr is equal to the BD_addr of the bluetooth device in step S<b>113</b>, or the sender BD_addr is equal to the BD_addr of the bluetooth device in step S<b>114</b>, it means that the bluetooth device receives the link search packet that is sent by itself. Then, step S<b>118</b> is executed to stop the searching procedure and generate a stop searching flag. In step S<b>115</b>, if the link search number is equal to 15, step S<b>118</b> is also executed to stop the searching procedure.</p>
<p id="p-0040" num="0039">If it decides to re-transmit the received link search packed in step S<b>1006</b>, step S<b>1007</b> is executed to re-transmit the received link search packet. <figref idref="DRAWINGS">FIG. 12</figref> shows the flowchart for re-transmitting the received link search packet in step S<b>1007</b>. In step S<b>121</b>, it fills the ID of the link that receives the search link packet into the search link IDm field of the search link packet. It retrieves corresponding search link IDs in the comparison table and fills the same into the search link field of the search link packet (step S<b>122</b>). In step S<b>123</b>, it adds 1 to the link search number field and fills the sender BD_addr with the bluetooth address of the bluetooth device. In step S<b>124</b>, it fills the source IP address and the source BD_addr with data retrieved from the comparison table. In step S<b>124</b>, it fills the link number field with 0 and encapsulates the link search packet with the standard bluetooth header, and then the packet is transmitted by the bluetooth channel.</p>
<p id="p-0041" num="0040"><figref idref="DRAWINGS">FIG. 13</figref> shows a scatternet system architecture for transmitting the link search packet from node A to node J in accordance with the present invention. <figref idref="DRAWINGS">FIG. 14</figref> shows the variations of the fields in the link search packet from node A to node J of <figref idref="DRAWINGS">FIG. 13</figref>. There is a link between nodes A and J. When the link is broken, the node A sends a link search packet to find a data transfer path between nodes A and J. In step <b>1</b>, node A broadcasts a link search packet by the bluetooth channel for being received by the node B. From the view point of node B, the link search packet is sent by node A, thus the search link ID<b>1</b> field is null.</p>
<p id="p-0042" num="0041">In step <b>2</b>, the link search packet is sent by node B and received by node D. From the view point of node D, the link search packet is sent by node B and received by node B using the link <b>3</b>, and thus the search link ID<b>1</b> field is filled with 3 and the sender BD_addr field is filled with the bluetooth address of node B (BD_B).</p>
<p id="p-0043" num="0042">In step <b>3</b>, the link search packet is sent by node D and received by node E. From the view point of node E, the link search packet is sent by node D and received by node D using the link <b>5</b>. Thus, the search link ID<b>1</b> field is filled with 3, the search link id<b>2</b> field is filled with 5 and the sender BD_addr field is filled with the bluetooth address of node D (BD_D). The subsequent steps are similar to those described aforementioned. Finally, node J can establish a link search table with node A when the step <b>7</b> is finished.</p>
<p id="p-0044" num="0043">In view of the foregoing, it is known that the present invention utilizes the steps in <figref idref="DRAWINGS">FIG. 8</figref> to establish and initialize the link search table and steps in <figref idref="DRAWINGS">FIG. 9</figref>, <figref idref="DRAWINGS">FIG. 10</figref>, <figref idref="DRAWINGS">FIG. 11</figref> and <figref idref="DRAWINGS">FIG. 12</figref> to update and re-transmit the link search table so as to achieve the purpose of transferring data packets in a bluetooth scatternet, thereby removing the limitation of the conventional bluetooth technology that can only transfer data in a piconet.</p>
<p id="p-0045" num="0044">Although the present invention has been explained in relation to its preferred embodiment, it is to be understood that many other possible modifications and variations can be made without departing from the spirit and scope of the invention as hereinafter claimed.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A link searching and maintaining method for establishing a link search table between a first bluetooth device in one piconet to a second bluetooth device in another piconet with both piconets located in a bluetooth scatternet, each bluetooth device including a link update variable, a link update timer, an initialization procedure executing timer, an initialization procedure trigger timer, a missing timer and a link search table, wherein the first Bluetooth device sends a link searching packet to the second bluetooth device to establish the link search table, wherein the link searching packet comprises a link number field, a source IP address field, a source bluetooth address (BD_Addr) field, a sender bluetooth address (BD_Addr) field, a link search number field, and multiple search link identification fields, the method comprising:
<claim-text>(A) filling the corresponding fields of the link search packet;</claim-text>
<claim-text>(B) enabling the link update variable and link update timer;</claim-text>
<claim-text>(C) filling the link number field with 0; and</claim-text>
<claim-text>(D) encapsulating with the bluetooth packet header and transmitting through the bluetooth channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the corresponding fields of the link search packet includes the source IP, source BD_Addr, sender BD_Addr, link search number and multiple search link fields.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when the bluetooth device in a scatternet receives a link search packet, the following steps are executed:
<claim-text>(E) un-packing the link search packet;</claim-text>
<claim-text>(F) determining whether the link number field of the link search packet is equal 0 or not;</claim-text>
<claim-text>(G) recording the corresponding fields of the link search packet to a comparison table if step (F) determines that value of the link number field is equal 0;</claim-text>
<claim-text>(H) comparing each field in the comparison table and the link search table and generating a flag;</claim-text>
<claim-text>(I) determining whether to re-transmit the received link search packed or not according to the flag;</claim-text>
<claim-text>(J) determining whether the link update variable is enabled or not if step (I) decides not to re-transmit the received link search packet;</claim-text>
<claim-text>(K) updating the link update timer if step (J) decides that the link update variable is enabled;</claim-text>
<claim-text>(L) determining whether others link search packet is received or not;</claim-text>
<claim-text>(M) determining whether the link update timer is expired or not if step (L) decides no other link search packet is received;</claim-text>
<claim-text>(N) disabling the link update variable of the bluetooth device if step (M) decides that the link update timer is expired; and</claim-text>
<claim-text>(O) clearing the records in the comparison table.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The link searching and maintaining method for establishing 1a ink search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein when step
<claim-text>(M) determines that the link update timer is not expired, step (L) is executed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein when step (L) determines that there is other link search packet received, step (E) is executed.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein when step (J) determines that the link update variable is not enabled, step (A) is executed.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein step (H) further comprises:
<claim-text>(H1) retrieving data from the comparison table;</claim-text>
<claim-text>(H2) determining whether the source IP address is equal to the IP address of the bluetooth device or not;</claim-text>
<claim-text>(H3) determining whether the source BD_addr is equal to the BD_addr of the bluetooth device or not if step (H2) determines that the source PP address is not equal to the IP address of the bluetooth device;</claim-text>
<claim-text>(H4) determining whether the sender BD_addr is equal to the BD_addr of the bluetooth device or not if step (H3) determines that the source BD_addr is not equal to the BD_addr of the bluetooth device;</claim-text>
<claim-text>(H5) determining whether the link search number is equal to a pre-determined value or not if step (H4) determines that the sender BD_addr is not equal to the BD_addr of the bluetooth device;</claim-text>
<claim-text>(H6) recording corresponding data to the link search table of the bluetooth device;</claim-text>
<claim-text>(H7) generating a flag for continuously transmitting the link search packet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein, in step (H5), the pre-determined value is equal 15.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00007">claim 7</claim-ref>, wherein when step (H2) determines that the source IP address is equal to the IP address of the bluetooth device, step (H3) determines that the source BD_addr is equal to the BD_addr of the bluetooth device, step (H4) determines that the sender BD_addr is equal to the BD_addr of the bluetooth device, or step (H5) determines that the link search number is equal to 15, step
<claim-text>(H8) is executed f or stopping the searching procedure and generating a stop searching flag.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein when step (I) determines to re-transmit the received link search packet, it further comprises:
<claim-text>(I1) filling the ID of the link that receives the search link packet into the search link IDm field of the search link packet;</claim-text>
<claim-text>(I2) retrieving corresponding search link IDs in the comparison table and filling the same into the search link field of the search link packet;</claim-text>
<claim-text>(I3) adding 1 to the link search number field and filling the sender BD_addr with the bluetooth address of the bluetooth device;</claim-text>
<claim-text>(I4) filling the source IP address, source BD_addr with data retrieving from the comparison table; and</claim-text>
<claim-text>(I5) encapsulating the link search packet with the standard bluetooth header and transmitting the packet by the bluetooth channel.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The link searching and maintaining method for establishing a link search table between two bluetooth devices as claimed in <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein when step (F) determines that value of the link number field is not equal to 0, a data packet transmission/receiving procedure is further executed.</claim-text>
</claim>
</claims>
</us-patent-grant>
