<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298460-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298460</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11324424</doc-number>
<date>20060103</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>P</subclass>
<main-group>3</main-group>
<subgroup>36</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>356 28</main-classification>
</classification-national>
<invention-title id="d0e43">Method for determining motion using a velocity predictor</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>3922093</doc-number>
<kind>A</kind>
<name>Dandliker et al.</name>
<date>19751100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>4225240</doc-number>
<kind>A</kind>
<name>Balasubramanian</name>
<date>19800900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>356512</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>4546347</doc-number>
<kind>A</kind>
<name>Kirsch</name>
<date>19851000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>4799055</doc-number>
<kind>A</kind>
<name>Nestler et al.</name>
<date>19890100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5288993</doc-number>
<kind>A</kind>
<name>Bidiville et al.</name>
<date>19940200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5473344</doc-number>
<kind>A</kind>
<name>Bacon et al.</name>
<date>19951200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>5578813</doc-number>
<kind>A</kind>
<name>Allen et al.</name>
<date>19961100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>5644139</doc-number>
<kind>A</kind>
<name>Allen et al.</name>
<date>19970700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>5703356</doc-number>
<kind>A</kind>
<name>Bidlville et al.</name>
<date>19971200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>5729008</doc-number>
<kind>A</kind>
<name>Blalock et al.</name>
<date>19980300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>5729009</doc-number>
<kind>A</kind>
<name>Dandliker et al.</name>
<date>19980300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>5786804</doc-number>
<kind>A</kind>
<name>Gordon</name>
<date>19980700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>5825044</doc-number>
<kind>A</kind>
<name>Allen et al.</name>
<date>19981000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>5854482</doc-number>
<kind>A</kind>
<name>Bidlville et al.</name>
<date>19981200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>5907152</doc-number>
<kind>A</kind>
<name>Dandliker et al.</name>
<date>19990500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>5963197</doc-number>
<kind>A</kind>
<name>Bacon et al.</name>
<date>19991000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>5994710</doc-number>
<kind>A</kind>
<name>Knee et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>6031218</doc-number>
<kind>A</kind>
<name>Piot et al.</name>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>6037643</doc-number>
<kind>A</kind>
<name>Knee</name>
<date>20000300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>6057540</doc-number>
<kind>A</kind>
<name>Gordon et al.</name>
<date>20000500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>6097371</doc-number>
<kind>A</kind>
<name>Siddiqui et al.</name>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>6151015</doc-number>
<kind>A</kind>
<name>Badyal et al.</name>
<date>20001100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>6172354</doc-number>
<kind>B1</kind>
<name>Adan et al.</name>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>6225617</doc-number>
<kind>B1</kind>
<name>Dandliker et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>6233368</doc-number>
<kind>B1</kind>
<name>Badyal et al.</name>
<date>20010500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>6281881</doc-number>
<kind>B1</kind>
<name>Siddiqui et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>6281882</doc-number>
<kind>B1</kind>
<name>Gordon et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>6326950</doc-number>
<kind>B1</kind>
<name>Liu</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>6330057</doc-number>
<kind>B1</kind>
<name>Lederer et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>6351257</doc-number>
<kind>B1</kind>
<name>Liu</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>6396479</doc-number>
<kind>B2</kind>
<name>Gordon</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>6421045</doc-number>
<kind>B1</kind>
<name>Venkat et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>6424407</doc-number>
<kind>B1</kind>
<name>Kinrot et al.</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>6433780</doc-number>
<kind>B1</kind>
<name>Gordon et al.</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>6452683</doc-number>
<kind>B1</kind>
<name>Kinrot et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>6455840</doc-number>
<kind>B1</kind>
<name>Oliver et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>6462330</doc-number>
<kind>B1</kind>
<name>Venkat et al.</name>
<date>20021000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>6476970</doc-number>
<kind>B1</kind>
<name>Smith</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>6529184</doc-number>
<kind>B1</kind>
<name>Julienne</name>
<date>20030300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>6585158</doc-number>
<kind>B2</kind>
<name>Norskog</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00041">
<document-id>
<country>US</country>
<doc-number>6603111</doc-number>
<kind>B2</kind>
<name>Dietz et al.</name>
<date>20030800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00042">
<document-id>
<country>US</country>
<doc-number>6621483</doc-number>
<kind>B2</kind>
<name>Wallace et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00043">
<document-id>
<country>US</country>
<doc-number>6657184</doc-number>
<kind>B2</kind>
<name>Anderson et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00044">
<document-id>
<country>US</country>
<doc-number>6664948</doc-number>
<kind>B2</kind>
<name>Crane et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00045">
<document-id>
<country>US</country>
<doc-number>6674475</doc-number>
<kind>B1</kind>
<name>Anderson</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00046">
<document-id>
<country>US</country>
<doc-number>6677929</doc-number>
<kind>B2</kind>
<name>Gordon et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00047">
<document-id>
<country>US</country>
<doc-number>6703599</doc-number>
<kind>B1</kind>
<name>Casebolt et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00048">
<document-id>
<country>US</country>
<doc-number>6737636</doc-number>
<kind>B2</kind>
<name>Dietz et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00049">
<document-id>
<country>US</country>
<doc-number>6774351</doc-number>
<kind>B2</kind>
<name>Black</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00050">
<document-id>
<country>US</country>
<doc-number>6774915</doc-number>
<kind>B2</kind>
<name>Rensberger</name>
<date>20040800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00051">
<document-id>
<country>US</country>
<doc-number>6795056</doc-number>
<kind>B2</kind>
<name>Norskog et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00052">
<document-id>
<country>US</country>
<doc-number>6809723</doc-number>
<kind>B2</kind>
<name>Davis</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00053">
<document-id>
<country>US</country>
<doc-number>6819314</doc-number>
<kind>B2</kind>
<name>Black</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00054">
<document-id>
<country>US</country>
<doc-number>6823077</doc-number>
<kind>B2</kind>
<name>Dietz et al.</name>
<date>20041100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00055">
<document-id>
<country>US</country>
<doc-number>2007/0055461</doc-number>
<kind>A1</kind>
<name>Buckner</name>
<date>20070300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>702 36</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>17</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>356 28</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>12</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20070165207</doc-number>
<kind>A1</kind>
<date>20070719</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Xu</last-name>
<first-name>Yansun</first-name>
<address>
<city>Mountain View</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Todoroff</last-name>
<first-name>Brian D.</first-name>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Nuttle</last-name>
<first-name>William</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Silicon Light Machines Corporation</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Tarcza</last-name>
<first-name>Thomas H.</first-name>
<department>3662</department>
</primary-examiner>
<assistant-examiner>
<last-name>Ratcliffe</last-name>
<first-name>Luke D.</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A method is provided for determining motion of an optical sensor including a periodic photo-diode array relative to a surface. The method includes steps of (i) generating sets of quasi-sinusoidal signals responsive to motion along first and second directions; (ii) combining the sets of signals to generate a wrapped phase angle value for each direction at a first time; (iii) combining the sets of signals at a second time to generate a second wrapped phase angle value for each direction; (iv) computing wrapped phase angle changes for each direction between the first time and the second time; (v) computing velocity predictors for each direction using corrected average phase angle changes from a number of preceding successive frames; (vi) calculating the number of full 27π rotations needed to unwrap the phase angle changes for each direction using the velocity predictors; and (vii) computing the unwrapped or corrected phase angle changes.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="108.80mm" wi="249.68mm" file="US07298460-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="205.82mm" wi="101.35mm" file="US07298460-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="251.38mm" wi="111.59mm" orientation="landscape" file="US07298460-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="238.51mm" wi="160.87mm" orientation="landscape" file="US07298460-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="257.22mm" wi="183.98mm" orientation="landscape" file="US07298460-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="158.07mm" wi="152.23mm" file="US07298460-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="234.44mm" wi="186.86mm" file="US07298460-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="201.76mm" wi="116.25mm" file="US07298460-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="203.03mm" wi="99.40mm" file="US07298460-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">TECHNICAL FIELD</heading>
<p id="p-0002" num="0001">The present invention relates generally to signal processing, and more particularly to a signal processing method for use with an optical navigation system to determine motion of an optical sensor relative to a surface.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Signal processing methods are used in a wide range of applications including, for example, measuring an output from a photo-detector of an array in an optical navigation system. Optical navigation systems, such as an optical computer mouse, trackball or touch pad, are well known for inputting data into and interfacing with personal computers and workstations. Such devices allow rapid relocation of a cursor on a monitor, and are useful in many text, database and graphical programs. A user controls the cursor, for example, by moving the mouse over a surface to move the cursor in a direction and over distance proportional to the movement of the mouse. Alternatively, movement of the hand over a stationary device may be used for the same purpose.</p>
<p id="p-0004" num="0003">The dominant technology used today for optical mice relies on a light source illuminating a surface, a two-dimensional (2D) array of photosensitive elements to capture the resultant images, and a signal processor that correlates successive images to detect and quantify the motion of the mouse. The image can be produced in a number of ways including illuminating the surface at or near grazing incidence to produce and image shadows due to roughness of the surface, illumination with a coherent light source to produce a speckle image of the surface, or the use of a pattern printed onto the surface itself. Regardless of the imaging method used to produce a trackable image, a processor captures the image and does a series of correlations between successive images to determine the most likely motion between frames. A similar method can be used with a linear sensor to track one dimension (1D) motion. In either case, the correlation used to track the motion of the image requires a great deal of processing and results in an unsatisfactory power consumption that limits the usefulness of the technique in power sensitive applications, such as wireless mice.</p>
<p id="p-0005" num="0004">An alternative method to correlation uses an array of photosensitive elements or detectors, such as photodiodes, in which the output of the individual elements in the array are combined or wired together in a repeating pattern spanning two or more detectors to track motion along one axis or in one dimension. Generally, the detectors are wired in groups to detect of motion through movement of a light-dark pattern known as speckle. Speckle is the complex interference pattern generated by scattering of coherent light off of an optically rough surface and detected by a photosensitive element, such as a photodiode, with a finite angular field-of-view or numerical aperture. The image mapped to or captured on the comb-array may be magnified or de-magnified to achieve matching and so that the distribution of spatial frequencies in the image is roughly centered around the spatial frequencies of the array. Through use of signal processing, it is possible to track the movement of this image as it moves back and forth across the comb-array and from that tracking derive the motion of the surface relative to the array.</p>
<p id="p-0006" num="0005">Although a significant improvement over prior art, these speckle-based devices have not been wholly satisfactory for a number of reasons. In particular, optical navigation systems using the above comb-array have not demonstrated the accuracy demanded in state-of-the-art pointing devices today, which generally must have a path error of less than about 1%. Furthermore, the above approach involves processing signals from multiple signal processing paths, and suffers from relatively complex signal processing requirements increasing power consumption of the device or system.</p>
<p id="p-0007" num="0006">Accordingly, there is a need for a signal processor or signal processing circuit and method that is capable of tracking motion from an optical sensor in one or more directions or dimensions with an acceptable path error in any direction (i.e. on-axis as well as off-axis directions). It is desirable that the circuit and method achieve this end without increasing the complexity and power consumption of the signal processor or the optical navigation system in which it is used. It is still further desirable that the method reduces the power consumption of the system, thereby making it more suitable for power sensitive applications such as wireless mice.</p>
<p id="p-0008" num="0007">The present invention provides a solution to this and other problems, and offers further advantages over conventional signal processing methods.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0009" num="0008">These and various other features and advantages of the present invention will be apparent upon reading of the following detailed description in conjunction with the accompanying drawings and the appended claims provided below, where:</p>
<p id="p-0010" num="0009"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a diffraction pattern of light reflected from a surface;</p>
<p id="p-0011" num="0010"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a speckle in an interference pattern of light reflected from a rough surface;</p>
<p id="p-0012" num="0011"><figref idref="DRAWINGS">FIG. 3</figref> is a functional block diagram of a speckle-based optical navigation system according to an embodiment of the present invention;</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 4</figref> is a schematic block diagram of a speckle based linear or one-dimensional (1D) comb-array having a four (4) photosensitive elements per period configuration, and for which a signal processing method according to the present invention is useful;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIGS. 5A and 5B</figref> are schematic block diagrams of a 2D comb-array having photosensitive elements grouped in a 4×4 elements-per-cell configuration according to an embodiment of the present invention;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 6</figref> is graphs of phase angle changes over time for a signal from a periodic 2D comb-array of photo-detectors;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart of a signal processing method according to an embodiment of the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 8</figref> is a graph of circular trajectories at a low speed of 1 cm/s for an optical navigation system over a surface detected by a signal processing method using a velocity predictor to unwrap phase angle values according to an embodiment of the present invention;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 9</figref> (prior art) is a graph of circular trajectories at a low speed for an optical navigation system over a surface detected by a signal processing method using past phase angle values to predict current phase angle values according to a conventional signal processing method;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 10</figref> is a graph of circular trajectories for an optical navigation system moved at 25 cm/s over a surface detected by a signal processing method using a velocity predictor to unwrap the phase angle values according to an embodiment of the present invention; and</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 11</figref> (prior art) is a graph of circular trajectories for an optical navigation system moved at 25 cm/s over a surface detected by a signal processing method using past phase angle values to predict current phase angle values according to a conventional signal processing method (without using a velocity predictor).</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0021" num="0020">The present invention is directed generally to signal processing, and more particularly, to a signal processing method for use with an optical navigation system for determining motion of an optical sensor including a periodic photo-diode array relative to a surface using a velocity predictor.</p>
<p id="p-0022" num="0021">Optical navigation systems can include, for example, an optical computer mouse, trackballs and the like, and are well known for inputting data into and interfacing with personal computers and workstations. For purposes of clarity, many of the details of optical navigation systems in general and optical sensors for optical navigation systems in particular that are widely known and are not relevant to the present invention have been omitted from the following description. Optical navigation systems and optical sensors are described, for example, in co-pending, commonly assigned U.S. patent application Ser. No. 11/129,967, entitled, “Optical Positioning Device Having Shaped Illumination,” filed on May 16, 2005 by Clinton B. Carlisle et al., and incorporated herein by reference in its entirety.</p>
<p id="p-0023" num="0022">In the following description, for purposes of explanation, numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be evident, however, to one skilled in the art that the present invention may be practiced without these specific details. In other instances, well-known structures, and techniques are not shown in detail or are shown in block diagram form in order to avoid unnecessarily obscuring an understanding of this description.</p>
<p id="p-0024" num="0023">Reference in the description to “one embodiment” or “an embodiment” means that a particular feature, structure, or characteristic described in connection with the embodiment is included in at least one embodiment of the invention. The appearances of the phrase “one embodiment” in various places in the specification do not necessarily all refer to the same embodiment. The term “to couple” as used herein may include both to directly connect and to indirectly connect through one or more intervening components.</p>
<p id="h-0005" num="0000">Introduction to Speckle-Based Optical Sensors</p>
<p id="p-0025" num="0024">Operating principles of speckle-based optical sensors will now be described with reference to <figref idref="DRAWINGS">FIGS. 1 and 2</figref>.</p>
<p id="p-0026" num="0025">Referring to <figref idref="DRAWINGS">FIG. 1</figref>, laser light of a wavelength indicated is depicted as a first incident wave <b>102</b> and a second incident wave <b>104</b> to a surface, each making an angle of incidence θ with respect to the surface normal. A diffraction pattern <b>106</b> results which has a periodicity of λ/2 sin θ.</p>
<p id="p-0027" num="0026">In contrast, referring to <figref idref="DRAWINGS">FIG. 2</figref>, any general surface with morphological irregularities of dimensions greater than the wavelength of the incident light (i.e. roughly &gt;1 μm) will tend to scatter light <b>202</b> into a complete hemisphere in approximately a Lambertian fashion. If a coherent light source, such as a laser is used, the spatially coherent, scattered light will create a complex interference pattern <b>204</b> upon detection by a square-law detector with finite aperture. This complex interference pattern <b>204</b> of light and dark areas is termed speckle. Preferably, as shown in <figref idref="DRAWINGS">FIG. 2</figref>, the main contribution for the measured speckle pattern <b>204</b> comes from rays <b>206</b> between the surface normal <b>208</b> and angle θ <b>210</b>, not from the extreme rays <b>212</b>. Speckle is essentially the random interference pattern generated by scattering of coherent light off of a rough surface and detected by an intensity photosensitive element, such as a photodiode, with a finite angular field-of-view or numerical aperture (NA). The exact nature and contrast of the speckle pattern depends on the surface roughness, the wavelength of light and its degree of spatial-coherence, and the light-gathering or imaging optics of the sensor. Although often highly complex, a speckle pattern is distinctly characteristic of a section of any rough surface that is imaged by the optics and, as such, can be employed to identify a location on the surface as it is displaced transversely to the laser and optics-sensor assembly.</p>
<p id="p-0028" num="0027">Speckle is expected to come in all sizes up to the spatial frequency set by the effective aperture of the optics, conventionally defined in term of its numerical aperture NA=sin θ as shown <figref idref="DRAWINGS">FIG. 2</figref>. Following Goodman [J. W. Goodman, “Statistical Properties of Laser Speckle Patterns” in “Laser Speckle and Related Phenomena” edited by J. C. Dainty, Topics in Applied Physics volume 9, Springer-Verlag (1984)—in particular, see page 39-40.], the size statistical distribution is expressed in terms of the speckle intensity auto-correlation. The “average” speckle diameter is defined as:</p>
<p id="p-0029" num="0028">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>a</mi>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mi>λ</mi>
            <mrow>
              <mi>sin</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>θ</mi>
            </mrow>
          </mfrac>
          <mo>=</mo>
          <mfrac>
            <mi>λ</mi>
            <mi>NA</mi>
          </mfrac>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>1</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where λ is the wavelength of the coherent light, NA is the numerical aperture of the photosensitive element, and θ is the angle of incidence.
</p>
<p id="p-0030" num="0029">It is interesting to note that the spatial frequency spectral density of the speckle intensity, which by Wiener-Khintchine theorem, is simply the Fourier transform of the intensity auto-correlation. The finest possible speckle, a<sub>min</sub>=λ/2NA, is set by the unlikely case where the main contribution comes from the extreme rays <b>212</b> of <figref idref="DRAWINGS">FIG. 2</figref> (i.e. rays at±θ), and contributions from most “interior” rays interfere destructively. The cut-off spatial frequency is therefore f<sub>co</sub>=1/(λ/2NA) or 2NA/λ.</p>
<p id="p-0031" num="0030">Note that the numerical aperture may be different for spatial frequencies in the image along one dimension (say “x”) than along the orthogonal dimension (“y”). This could be caused, for instance, by an optical aperture which is longer in one dimension than another (for example, an ellipse instead of a circle), or by anamorphic lenses. In these cases the speckle pattern <b>204</b> will also be anisotropic, and the average speckle size will be different in the two dimensions.</p>
<p id="p-0032" num="0031">One advantage of a laser speckle-based optical sensor is that it can operate with illumination light that arrives at near-normal incidence angles. Sensors that employ imaging optics and incoherent light arriving at grazing incident angles to a rough surface also can be employed for transverse displacement sensing. But, since the grazing incidence angle of the illumination is desired to create appropriately large bright-dark shadows of the surface terrain in the image, the system is inherently optically inefficient, as a significant fraction of the light is reflected off in a specular manner away from the sensor and thus contributes nothing to the image formed. In contrast, a speckle-based sensor can make efficient use of a larger fraction of the illumination light from the laser source, thereby enabling the development of an optically efficient displacement sensor.</p>
<p id="h-0006" num="0000">Optical Navigation Systems</p>
<p id="p-0033" num="0032">A functional block diagram of one embodiment of an optical navigation system for which the optical sensor and signal processing method of the present invention is particularly useful is shown in <figref idref="DRAWINGS">FIG. 3</figref>. Referring to <figref idref="DRAWINGS">FIG. 3</figref>, an optical navigation system <b>300</b> generally includes an optical head <b>302</b> having an illuminator <b>304</b> with a light source <b>306</b> and illumination optics <b>308</b> to illuminate a portion of a surface <b>310</b>, imaging optics <b>312</b> to map or image a pattern of the by the surface, and an optical sensor <b>314</b> to sense or detect change in the pattern. The optical sensor <b>314</b> includes one or more one-dimensional (1D) or two-dimensional (2D) arrays <b>316</b> each having a number of photosensitive elements, such as photodiodes <b>318</b>, on which light reflected from the surface <b>310</b> is received. The array(s) <b>316</b> may be configured to provide displacement measurements along two orthogonal axes, x and y. The optical navigation system <b>300</b> further includes front-end electrics <b>320</b>, signal processing circuitry <b>322</b>, and interface circuitry <b>324</b>. Groups of photodiodes <b>318</b> in the array(s) <b>316</b> may be combined using passive electronic components in the front-end electrics <b>320</b> to produce group signals. These group signals may subsequently algebraically combined by the signal processing circuitry <b>322</b> using an algorithm <b>326</b> to produce to produce a signal providing information on the magnitude and direction of displacement of the sensor <b>314</b> in x and y directions. The signal may be converted by the interface circuitry <b>324</b> to produce Δx, Δy data <b>328</b> which may be output by the system <b>300</b>.</p>
<p id="p-0034" num="0033">Generally, the signal processing method of the present invention is applicable to both speckle and non-speckle based optical sensors having either multiple 1D arrays or 2D arrays. The 2D array may be either a periodic, 2D comb-array, which includes a number of regularly spaced photosensitive elements having 1D or 2D periodicity, a quasi-periodic 2D array (such as one having Penrose tiling), or a non-periodic 2D array, which has a regular pattern but doesn't include periodicities.</p>
<p id="p-0035" num="0034">A linear or 1D comb-array is an array having multiple photosensitive elements that are connected in a periodic manner, so the array acts as a fixed template that interrogates one spatial frequency component of the signal. An embodiment of one such 1D comb-array is shown in <figref idref="DRAWINGS">FIG. 4</figref>. The connection of multiple photosensitive elements in a periodic manner enables the comb-array to serve effectively as a correlator at one spatial frequency K (defined by a pitch of the photosensitive elements in the array and the collection optics). <figref idref="DRAWINGS">FIG. 4</figref> shows a general configuration (along one axis) of a 1D comb-array <b>402</b> of photosensitive elements, such as photodiodes <b>404</b>, wherein the combination of interlaced groups of photosensitive elements serves as a periodic filter on spatial frequencies of light-dark signals <b>405</b> produced by the speckle (or non-speckle) images. In the embodiment shown, the 1D comb-array <b>402</b> in consists of a number of photodiode sets or periods, each having four of photodiodes <b>404</b>, labeled here as A, B, C, and D. Currents or signals from corresponding or similarly labeled photodiodes <b>404</b> in each period are electrically connected (wired sum) to form four line signals <b>406</b> coming out from the array <b>402</b>. Background suppression and signal accentuation is accomplished by using differential analog circuitry <b>408</b> to generate an in-phase differential current signal, labeled here as C<sub>out</sub>, and differential analog circuitry <b>410</b> to generate a quadrature differential current signal, labeled here as S<sub>out</sub>. Comparing the phase of the in-phase and quadrature signals permits determination of the magnitude and direction of motion of the 1D comb-array <b>402</b> relative to a scattering surface.</p>
<p id="p-0036" num="0035">Referring to <figref idref="DRAWINGS">FIG. 4</figref>, the in-phase C<sub>out </sub>and the quadrature S<sub>out </sub>signals are obtained by taking the underlying speckle pattern and processing them according to the cosine and sine templates, <b>412</b> and <b>414</b> respectively. Preferably, the system is designed so that an optical “light-dark” signal pattern, i.e., speckle, has a size substantially equal to the period of the comb-array—four (4) photodiodes <b>404</b> or pixels in the embodiment of <figref idref="DRAWINGS">FIG. 4</figref>. The in-phase signal current is obtained from C<sub>out</sub>=A−C, and the quadrature signal current from S<sub>out</sub>=B−D as shown in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0037" num="0036">In a preferred embodiment the optical sensor includes the detectors or photosensitive elements are arrayed in two dimensions (2D), as shown in <figref idref="DRAWINGS">FIGS. 5A and 5B</figref>. The performance of the 2D comb detector array is expected to be superior to the 1D×1D case since each point in the image, in the average, traverses a much longer path inside the 2D detector active area in all directions and therefore contributes more to the displacement estimation. <figref idref="DRAWINGS">FIGS. 5A and 5B</figref> are schematic block diagrams of a 2D comb-array having photosensitive elements grouped in a 4×4 elements-per-cell configuration. Referring to <figref idref="DRAWINGS">FIGS. 5A and 5B</figref>, the 2D comb-array <b>502</b> has multiple photosensitive elements <b>504</b> arranged or grouped into cells <b>506</b>, each cell having photosensitive elements grouped in a 4×4 elements-per-cell (or 4×4 elements/period) configuration. Photosensitive elements <b>504</b> within a cell <b>506</b> with the same letter and same number, as shown in the detail of <figref idref="DRAWINGS">FIG. 5B</figref>, as well as corresponding elements of all cells in the 2D comb-array <b>502</b> with the same number, are electrically connected or wired-sum to yield eight signals A<b>1</b> through D<b>2</b>. The eight wired-sum signals are further combined with differential amplifiers <b>508</b> to provide four signals containing the in-phase and quadrature information in the x and y directions.</p>
<p id="p-0038" num="0037">Although the detector or photosensitive elements shown in <figref idref="DRAWINGS">FIGS. 5A and 5B</figref> are equal in size and square, it will be understood that is a particular embodiment of a 2D array which is not necessary to practice the invention.</p>
<p id="h-0007" num="0000">Signal Processing</p>
<p id="p-0039" num="0038">A signal processing method according to the present invention will now be described in detail with reference to <figref idref="DRAWINGS">FIGS. 5A</figref>, <b>5</b>B, <b>6</b> and <b>7</b>.</p>
<p id="p-0040" num="0039">The image captured on the 2D comb detector array of <figref idref="DRAWINGS">FIGS. 5A and 5B</figref> is (de)-magnified such that the spatial frequency distribution of the image is roughly centered around the spatial frequency of the detector array. Through the processing of the four quasi-sinusoidal outputs (CC, CS, SC, and SS) representing separate in-phase and quadrature signals for motion along two orthogonal axes, it is possible to track the 2D movement of the image as it moves across the detector array and derive the motion of the surface relative to the detector array along the two orthogonal axes.</p>
<p id="p-0041" num="0040">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>ϕ</mi>
          <mi>x</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msup>
              <mi>tan</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msup>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mi>Q</mi>
                <mi>I</mi>
              </mfrac>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>tan</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msup>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mrow>
                  <mi>CS</mi>
                  <mo>+</mo>
                  <mi>SC</mi>
                </mrow>
                <mrow>
                  <mi>CC</mi>
                  <mo>-</mo>
                  <mi>SS</mi>
                </mrow>
              </mfrac>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>2</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where φ<sub>x </sub>is the phase angle value in the x direction, and CC, CS, SC, and SS are the four quasi-sinusoidal output signals from the array shown in <figref idref="DRAWINGS">FIG. 5A</figref> and described above.
</p>
<p id="p-0042" num="0041">For a 2D motion, the phase angle value in a y direction, φ<sub>y</sub>, can be computed similarly using equation 3.0 shown below.</p>
<p id="p-0043" num="0042">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>ϕ</mi>
          <mi>y</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <msup>
            <mi>tan</mi>
            <mrow>
              <mo>-</mo>
              <mn>1</mn>
            </mrow>
          </msup>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mi>CS</mi>
                <mo>-</mo>
                <mi>SC</mi>
              </mrow>
              <mrow>
                <mi>CC</mi>
                <mo>+</mo>
                <mi>SS</mi>
              </mrow>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>3</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0044" num="0043">The velocity of the movement of the sensor relative to the surface can now be determined by tracking the phase angle changes over time, that is from frame to frame using the following equation:</p>
<p id="p-0045" num="0044">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mi>Velocity</mi>
        <mo>=</mo>
        <mrow>
          <mo>(</mo>
          <mfrac>
            <mrow>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>ϕ</mi>
            </mrow>
            <mrow>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>t</mi>
            </mrow>
          </mfrac>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>4</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0046" num="0045">The phase angle changes Δφ<sub>x </sub>and Δφ<sub>y </sub>represent the movement of an image across the detector in 2D. For the 2D comb array shown in <figref idref="DRAWINGS">FIGS. 5A and 5B</figref>, the phase angle changes Δφ<sub>x </sub>and Δφ<sub>y </sub>from the previous sample frame are proportional to the detected 2D displacements along the two orthogonal axes between the current and previous sample frames. Note also, because Δt or the sampling rate is constant velocity is proportional to Δφ. Accordingly, the terms velocity and Δφ are used interchangeably throughout the remainder of this description.</p>
<p id="p-0047" num="0046">Optionally, at each sample frame radius values R<sub>x </sub>and R<sub>y </sub>are computed as well as phase angle values φ<sub>x </sub>and φ<sub>y </sub>using the following equations:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>x</sub>=√{square root over ((<i>CC−SS</i>)<sup>2</sup>+(<i>CS+SC</i>)<sup>2</sup>)}{square root over ((<i>CC−SS</i>)<sup>2</sup>+(<i>CS+SC</i>)<sup>2</sup>)}  (5.0)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i><sub>y</sub>=√{square root over ((<i>CC+SS</i>)<sup>2</sup>+(<i>CS−SC</i>)<sup>2</sup>)}{square root over ((<i>CC+SS</i>)<sup>2</sup>+(<i>CS−SC</i>)<sup>2</sup>)}  (6.0)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0048" num="0047">R<sub>x </sub>and R<sub>y </sub>indicate the contrast of the detected quasi-sinusoidal signals, and can be used as weighting factors in average velocity calculations and/or as an indication of quality of the received signal.</p>
<p id="p-0049" num="0048">Due to the mathematical nature of the inverse tangent function (i.e., tan(φ)=tan(φ+2πN)), where N is a whole number greater than or equal to 1, the computed phase angles φ<sub>x </sub>and φ<sub>y </sub>are always wrapped within the range of [−π, +π]. Thus, to compute the correct 2D displacements between two successive frames, the phase angle changes Δφ<sub>x </sub>and Δφ<sub>y </sub>need to be unwrapped to account for any additional full 2π rotations that may have occurred between the two sample frames (see graphs <b>602</b>, <b>604</b> and <b>606</b> of <figref idref="DRAWINGS">FIG. 6</figref>). The dotted curves of graphs <b>602</b> and <b>604</b> represent the wrapped phase angle value over time computed from the inverse tangent function, and the solid curve of graph <b>606</b> represents the unwrapped phase angle value over time. In particular, the solid curve of graph <b>606</b> shows the unwrapped or actual phase angle value representing the movement of an image across the detector in one of a pair of 2D axes over time. As graphically shown in <figref idref="DRAWINGS">FIG. 6</figref>, unwrapping involves shifting the wrapped phase angle value from the inverse tangent function by 2πN, where N is a whole number of one or more.</p>
<p id="p-0050" num="0049">It will be appreciated that additional information is needed to unwrap these phase angle values. One possible approach to unwrapping the phase angles is to reference the phase angle values from the previous sample frame, and assuming that the phase angle changes between two successive frames are always within the range of [−π, +π]. This approach, however, will limit the maximum detectable speed of the motion to the Nyquist limit (i.e., the highest frequency signal that can be detected at a given sampling rate). For example, for a 2D comb detector array having a period or M value of 4, a 20 μm detector pitch, 2× magnification and operating at a 10 kHz sampling rate, the maximum detectable speed is given by the following equation:</p>
<p id="p-0051" num="0050">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>V</mi>
          <mi>max</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <mi>M</mi>
            <mo>×</mo>
            <mi>Pitch</mi>
          </mrow>
          <mrow>
            <mn>2</mn>
            <mo>×</mo>
            <mi>Magnification</mi>
            <mo>×</mo>
            <mi>Δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mi>t</mi>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>7</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where Pitch is the detector cell pitch and (1/Δt) is the sampling rate. Thus, for the detector described above V<sub>max </sub>using this approach is 20 cm/second. This approach has some severe limitations that lead to significant error under normal operating conditions of an optical navigation system, such as an optical mouse.
<br/>
Phase Unwrapping Using Velocity Predictor
</p>
<p id="p-0052" num="0051">A signal processing method according to the present invention that will unwrap phase angle values calculated from the inverse tangent function, more accurately without imposing limitations on maximum detectable speed of motion, will now be described. For development of the method in the following description it is assumed the ith frame currently being sampled, and Δφ<sub>x, i </sub>and Δφ<sub>y, i </sub>represent the phase angle changes (wrapped) between the current and previous frames, calculated from the inverse tangent function. Thus:</p>
<p id="p-0053" num="0052">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>Δ</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <msub>
            <mi>ϕ</mi>
            <mrow>
              <mi>x</mi>
              <mo>,</mo>
              <mi>i</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>ϕ</mi>
              <mrow>
                <mi>x</mi>
                <mo>,</mo>
                <mi>i</mi>
              </mrow>
            </msub>
            <mo>-</mo>
            <mrow>
              <msub>
                <mi>ϕ</mi>
                <mrow>
                  <mi>x</mi>
                  <mo>,</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
              </msub>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>where</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>ϕ</mi>
                <mrow>
                  <mi>x</mi>
                  <mo>,</mo>
                  <mi>i</mi>
                </mrow>
              </msub>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>tan</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msup>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mrow>
                  <msub>
                    <mi>CS</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>SC</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
                <mrow>
                  <msub>
                    <mi>CC</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>-</mo>
                  <msub>
                    <mi>SS</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </mfrac>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>8</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>Δ</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <msub>
            <mi>ϕ</mi>
            <mrow>
              <mi>y</mi>
              <mo>,</mo>
              <mi>i</mi>
            </mrow>
          </msub>
        </mrow>
        <mo>=</mo>
        <mrow>
          <mrow>
            <msub>
              <mi>ϕ</mi>
              <mrow>
                <mi>y</mi>
                <mo>,</mo>
                <mi>i</mi>
              </mrow>
            </msub>
            <mo>-</mo>
            <mrow>
              <msub>
                <mi>ϕ</mi>
                <mrow>
                  <mi>y</mi>
                  <mo>,</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>-</mo>
                    <mn>1</mn>
                  </mrow>
                </mrow>
              </msub>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <mi>where</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.8em" height="0.8ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>ϕ</mi>
                <mrow>
                  <mi>y</mi>
                  <mo>,</mo>
                  <mi>i</mi>
                </mrow>
              </msub>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <msup>
              <mi>tan</mi>
              <mrow>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </msup>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mfrac>
                <mrow>
                  <msub>
                    <mi>CS</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>-</mo>
                  <msub>
                    <mi>SC</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
                <mrow>
                  <msub>
                    <mi>CC</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>+</mo>
                  <msub>
                    <mi>SS</mi>
                    <mi>i</mi>
                  </msub>
                </mrow>
              </mfrac>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>9</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0054" num="0053">Letting ΔΦ<sub>x,i </sub>and ΔΦ<sub>y,i </sub>be the corrected (unwrapped) phase angle changes between the current and previous frames, the average phase changes along the X and Y axes between two successive frames (i.e., the average velocities), &lt;ΔΦ<sub>x</sub>&gt;<sub>i </sub>and &lt;ΔΦ<sub>y</sub>&gt;<sub>i </sub>can be computed using the ΔΦ<sub>x,(i-j) </sub>and ΔΦ<sub>y,(i-j) </sub>values from the past K frames.</p>
<p id="p-0055" num="0054">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mrow>
            <mo>〈</mo>
            <mrow>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>Φ</mi>
                <mi>x</mi>
              </msub>
            </mrow>
            <mo>〉</mo>
          </mrow>
          <mi>i</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
          <mo>⁢</mo>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <msub>
              <mi>ΔΦ</mi>
              <mrow>
                <mi>x</mi>
                <mo>,</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>-</mo>
                    <mi>j</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msub>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>10</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mrow>
            <mo>〈</mo>
            <msub>
              <mi>ΔΦ</mi>
              <mi>y</mi>
            </msub>
            <mo>)</mo>
          </mrow>
          <mi>i</mi>
        </msub>
        <mo>=</mo>
        <mrow>
          <mfrac>
            <mn>1</mn>
            <mi>K</mi>
          </mfrac>
          <mo>⁢</mo>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>Φ</mi>
                <mrow>
                  <mi>y</mi>
                  <mo>,</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>-</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </msub>
            </mrow>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>11</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0056" num="0055">The average velocity values computed from the above equations are referred to hereinafter as “Velocity Predictors.” These velocity predictors can be used to unwrap phase angle values, and changes in phase angles calculated from the inverse tangent function. The method or process begins with calculating the number of full 2π rotations needed to unwrap the phase angles assuming that the phase angle changes between the current and previous frames would be within the range of [(&lt;ΔΦ<sub>x</sub>&gt;<sub>i</sub>−π), (&lt;ΔΦ<sub>x</sub>&gt;<sub>i</sub>+π)] or [(&lt;ΔΦ<sub>y</sub>&gt;<sub>i</sub>−π), (&lt;ΔΦ<sub>y</sub>&gt;<sub>i</sub>+π)]. The number (N) of full 2π rotations is calculated using the following equations:</p>
<p id="p-0057" num="0056">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>N</mi>
          <mrow>
            <mi>x</mi>
            <mo>,</mo>
            <mi>i</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mi>INTEGER</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <mrow>
                  <mi>Δ</mi>
                  <mo>⁢</mo>
                  <mstyle>
                    <mspace width="0.3em" height="0.3ex"/>
                  </mstyle>
                  <mo>⁢</mo>
                  <msub>
                    <mi>ϕ</mi>
                    <mrow>
                      <mi>x</mi>
                      <mo>,</mo>
                      <mi>i</mi>
                    </mrow>
                  </msub>
                </mrow>
                <mo>-</mo>
                <msub>
                  <mrow>
                    <mo>〈</mo>
                    <msub>
                      <mi>ΔΦ</mi>
                      <mi>x</mi>
                    </msub>
                    <mo>〉</mo>
                  </mrow>
                  <mi>i</mi>
                </msub>
                <mo>+</mo>
                <mi>π</mi>
              </mrow>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mi>π</mi>
              </mrow>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>12</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>N</mi>
          <mrow>
            <mi>y</mi>
            <mo>,</mo>
            <mi>i</mi>
          </mrow>
        </msub>
        <mo>=</mo>
        <mrow>
          <mi>INTEGER</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mfrac>
              <mrow>
                <msub>
                  <mi>Δϕ</mi>
                  <mrow>
                    <mi>y</mi>
                    <mo>,</mo>
                    <mi>i</mi>
                  </mrow>
                </msub>
                <mo>-</mo>
                <msub>
                  <mrow>
                    <mo>〈</mo>
                    <msub>
                      <mi>ΔΦ</mi>
                      <mi>y</mi>
                    </msub>
                    <mo>〉</mo>
                  </mrow>
                  <mi>i</mi>
                </msub>
                <mo>+</mo>
                <mi>π</mi>
              </mrow>
              <mrow>
                <mn>2</mn>
                <mo>⁢</mo>
                <mi>π</mi>
              </mrow>
            </mfrac>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>13</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where Δφ<sub>x,i </sub>and Δφ<sub>y,i </sub>are the uncorrected or wrapped phase angle changes, &lt;ΔΦ<sub>x</sub>&gt;<sub>i </sub>and &lt;ΔΦ<sub>y&gt;</sub><sub>i </sub>are the velocity predictors, and the INTEGER function returns the largest integer value that is not greater than the function's argument. The unwrapped or corrected phase angle changes can then be computed as follows:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>ΔΦ<sub>x,i</sub>=Δφ<sub>x,i</sub>−2<i>π×N</i><sub>x,i</sub>  (14.0)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>ΔΦ<sub>y,i</sub>=Δφ<sub>y,i</sub>−2<i>π×N</i><sub>y,i</sub>  (15.0)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0058" num="0057">It will be appreciated that this method of unwrapping phase angle values for detecting motion does not impose limitations on maximum detectable speed of motion, but it does impose limitations on maximum detectable acceleration (or deceleration). For example, using a 2D comb detector array having the values or characteristics given above in connection with equation 7.0, i.e., a period or M value of 4, a 20 μm detector pitch, 2× magnification and operating at a 10 kHz sampling rate, the maximum detectable acceleration (A<sub>max</sub>) can be calculated from the following equation:</p>
<p id="p-0059" num="0058">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mi>A</mi>
          <mi>max</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <mi>M</mi>
            <mo>×</mo>
            <mi>Pitch</mi>
          </mrow>
          <mrow>
            <mn>2</mn>
            <mo>×</mo>
            <mi>Magnification</mi>
            <mo>×</mo>
            <mi>Δ</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <msup>
              <mi>t</mi>
              <mn>2</mn>
            </msup>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>16.0</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0060" num="0059">where Pitch is the detector cell pitch and (1/Δt) is the sampling rate. Thus, for the detector described above the A<sub>max </sub>is about 2000 m/s<sup>2 </sup>or 200* G. When the acceleration exceeds A<sub>max</sub>, for any difference in the predicted velocity and the true velocity that is greater than π, the predictor can no longer discriminate between acceleration and deceleration. However, the typical motion that is detectable by most optical navigation systems, such as optical mice, is not likely to exceed such a large, 200* G, acceleration or deceleration.</p>
<p id="p-0061" num="0060">A flowchart of a method for detecting motion of an optical sensor relative to a surface, including a step of unwrapping phase angle values according to an embodiment of the present invention, is shown <figref idref="DRAWINGS">FIG. 7</figref>. Briefly, the method involves: (i) generating sets of quasi-sinusoidal signals (CC, CS, SC, and SS) responsive to motion along each of a first and a second axes or direction (<b>702</b>); (ii) combining the sets of signals to generate a phase angle value for each direction at a first time (<b>704</b>); (iii) combining the sets of signals at a second time (frame) subsequent to the first time (frame) to generate a second phase angle value for each direction (<b>706</b>); (iv) computing wrapped phase angle changes (Δφ<sub>x </sub>and Δφ<sub>y</sub>) for each direction between the first time and the second time (<b>708</b>); (v) computing velocity predictors for each direction using average velocity values (unwrapped average phase angle changes) from K preceding successive frames (<b>710</b>); calculating the number of full 2π rotations needed to unwrap the phase angle changes for each direction using the velocity predictors (<b>712</b>); and computing the unwrapped or corrected phase angle changes (<b>714</b>). They are then combined to determine the movement of an image across the detector in two dimensions or directions over time.</p>
<p id="h-0008" num="0000">Improvements on Velocity Predictor Estimation</p>
<p id="p-0062" num="0061">It will be appreciated that selection of the number of frames to average over (i.e., the K value) is critical in obtaining an accurate estimation of the velocity predictors. A larger K value will yield a better estimation at slow speed of motion where the noise in the phase measurement is significant, while a smaller K value may estimate velocity more accurately with very fast motion or in the presence of higher accelerations. Thus, it is important to choose a K value that can cover a wide range of speeds fairly accurately. It has been found that setting the K value around 64 frames provides a reasonably good prediction on speed of the motion over a wide range of velocities from about 0.1 inch/second to over 20 inch/second.</p>
<p id="p-0063" num="0062">In another embodiment, the sampling rate can be dynamically adjusted or adapt ed based on an estimated or past speed of the motion to further improve this velocity predictor estimation. That is, the sampling rate can be reduced (i.e., increase Δt) when the estimated motion is slow and the sampling rate can be increased (i.e., decrease Δt) when the detected motion speeds up.</p>
<p id="p-0064" num="0063">In yet another embodiment, the velocity predictor estimation is improved by computing the radius-weighted average velocities from the past K frames, since the radius values, R<sub>x,i </sub>and R<sub>y,i</sub>, are very good indicators of the detected signal contrast and hence the quality of the associated phase measurement. In this embodiment, the velocity predictor values may be calculated as follows:</p>
<p id="p-0065" num="0064">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mrow>
            <mo>〈</mo>
            <mrow>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>Φ</mi>
                <mi>x</mi>
              </msub>
            </mrow>
            <mo>〉</mo>
          </mrow>
          <mi>i</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>R</mi>
                <mrow>
                  <mi>x</mi>
                  <mo>,</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>-</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </msub>
              <mo>×</mo>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>Φ</mi>
                <mrow>
                  <mi>x</mi>
                  <mo>,</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>-</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </msub>
            </mrow>
          </mrow>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <msub>
              <mi>R</mi>
              <mrow>
                <mi>x</mi>
                <mo>,</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>-</mo>
                    <mi>j</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msub>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>17</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
  <mtr>
    <mtd>
      <mrow>
        <msub>
          <mrow>
            <mo>〈</mo>
            <mrow>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>Φ</mi>
                <mi>y</mi>
              </msub>
            </mrow>
            <mo>〉</mo>
          </mrow>
          <mi>i</mi>
        </msub>
        <mo>=</mo>
        <mfrac>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <mrow>
              <msub>
                <mi>R</mi>
                <mrow>
                  <mi>y</mi>
                  <mo>,</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>-</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </msub>
              <mo>×</mo>
              <mi>Δ</mi>
              <mo>⁢</mo>
              <mstyle>
                <mspace width="0.3em" height="0.3ex"/>
              </mstyle>
              <mo>⁢</mo>
              <msub>
                <mi>Φ</mi>
                <mrow>
                  <mi>y</mi>
                  <mo>,</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>i</mi>
                      <mo>-</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </msub>
            </mrow>
          </mrow>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>j</mi>
                <mo>=</mo>
                <mn>1</mn>
              </mrow>
              <mi>K</mi>
            </munderover>
            <mo>⁢</mo>
            <msub>
              <mi>R</mi>
              <mrow>
                <mi>y</mi>
                <mo>,</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>i</mi>
                    <mo>-</mo>
                    <mi>j</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </msub>
          </mrow>
        </mfrac>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mn>18</mn>
          <mo>⁢</mo>
          <mstyle>
            <mtext>.</mtext>
          </mstyle>
          <mo>⁢</mo>
          <mn>0</mn>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
where R<sub>x,i </sub>and R<sub>y,i </sub>are computed using equations 5.0 and 6.0 given above.
</p>
<p id="p-0066" num="0065">In summary, the advantages of the signal averaging circuit and method of the present invention over previous or conventional circuits and methods include improved accuracy of a phase angle unwrapping algorithm employed in quasi-sinusoidal signal processing, and hence the performance of the motion tracking by a comb-detector array without imposing additional limitations on the detectable speed of the motion. The method also enables fairly accurate detection of very high-speed motion (i.e., greater than 20 inch/second) with limited data sampling rate (i.e., less than 40 kHz). This last advantage is particularly desirable in applications, such as wireless optical mice, where the sampling rate is limited due to certain power consumption budget.</p>
<p id="p-0067" num="0066">The advantages of the signal averaging circuit and method of the present invention over previous or conventional circuits and methods will now be described in detail with reference to <figref idref="DRAWINGS">FIGS. 8 through 11</figref>.</p>
<p id="h-0009" num="0000">Results of Prototype Testing</p>
<p id="p-0068" num="0067"><figref idref="DRAWINGS">FIGS. 8 and 9</figref> show traces of 1 cm/s circular motion of 1 cm radius detected using a 2D comb detector array similar to that described above with reference to <figref idref="DRAWINGS">FIGS. 5A and 5B</figref>. In particular, <figref idref="DRAWINGS">FIG. 8</figref> shows motion detection using velocity predictor to uncover the missing phase angle rotations at the signal processing stage according to an embodiment of the present invention. <figref idref="DRAWINGS">FIG. 9</figref> shows motion detection using past phase angle values to uncover the missing phase angle rotations. Referring to <figref idref="DRAWINGS">FIGS. 8 and 9</figref> it is seen that when the speed of the motion is at 1 cm/s, the phase angle changes between frames are very small (i.e., much less than π or a 180 degree phase angle rotation) with a 10 kHz-sampling rate, determination of motion using the velocity predictor (shown in <figref idref="DRAWINGS">FIG. 8</figref>) is substantially the same as that using past phase angle values to predict the missing phase angle rotations (shown in <figref idref="DRAWINGS">FIG. 9</figref>).</p>
<p id="p-0069" num="0068"><figref idref="DRAWINGS">FIGS. 10 and 11</figref> show traces of 25 cm/s circular motion of 1 cm radius using a 2D comb detector array with and without the use of velocity predictors respectively. In particular, <figref idref="DRAWINGS">FIG. 10</figref> shows detection of 25 cm/s motion using the velocity predictor according to an embodiment of the present invention. <figref idref="DRAWINGS">FIG. 11</figref> shows a motion detection attempt using past phase angle values to predict the missing phase angle rotations. From these figures it is seen that when the speed of the motion increases to 25 cm/s or beyond, the phase angle changes between frames are large (180 to 360 degrees or more), and with a 10 kHz-sampling rate it is not possible to detect or estimate the motion correctly without the use of the velocity predictor of the present invention.</p>
<p id="p-0070" num="0069">The foregoing description of specific embodiments and examples of the invention have been presented for the purpose of illustration and description, and although the invention has been described and illustrated by certain of the preceding examples, it is not to be construed as being limited thereby. They are not intended to be exhaustive or to limit the invention to the precise forms disclosed, and many modifications, improvements and variations within the scope of the invention are possible in light of the above teaching. It is intended that the scope of the invention encompass the generic area as herein disclosed, and by the claims appended hereto and their equivalents.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298460-20071120-M00001.NB">
<img id="EMI-M00001" he="6.35mm" wi="76.20mm" file="US07298460-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298460-20071120-M00002.NB">
<img id="EMI-M00002" he="6.69mm" wi="76.20mm" file="US07298460-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298460-20071120-M00003.NB">
<img id="EMI-M00003" he="6.69mm" wi="76.20mm" file="US07298460-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298460-20071120-M00004.NB">
<img id="EMI-M00004" he="6.35mm" wi="76.20mm" file="US07298460-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005" nb-file="US07298460-20071120-M00005.NB">
<img id="EMI-M00005" he="7.03mm" wi="76.20mm" file="US07298460-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298460-20071120-M00006.NB">
<img id="EMI-M00006" he="14.82mm" wi="76.20mm" file="US07298460-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298460-20071120-M00007.NB">
<img id="EMI-M00007" he="19.73mm" wi="76.20mm" file="US07298460-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298460-20071120-M00008.NB">
<img id="EMI-M00008" he="14.82mm" wi="76.20mm" file="US07298460-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298460-20071120-M00009.NB">
<img id="EMI-M00009" he="7.03mm" wi="76.20mm" file="US07298460-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07298460-20071120-M00010.NB">
<img id="EMI-M00010" he="34.54mm" wi="76.20mm" file="US07298460-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for detecting movement of a surface relative to an optical sensor having an array of photosensitive elements, the method comprising steps of:
<claim-text>generating at least one set of quasi-sinusoidal signals responsive to motion of light received on the array in at least a first direction;</claim-text>
<claim-text>combining said at least one set of quasi-sinusoidal signals to generate a phase angle value for said first direction at a first time;</claim-text>
<claim-text>combining said at least one set of quasi-sinusoidal signals at a second time to generate a phase angle value for said first direction at the second time;</claim-text>
<claim-text>computing wrapped phase angle changes for said first direction;</claim-text>
<claim-text>computing the unwrapped phase angle changes for said first direction; and</claim-text>
<claim-text>determining a value of distance moved in the first direction; and</claim-text>
<claim-text>wherein the step of computing the unwrapped phase angle changes for said first direction comprises the step of computing velocity predictors for said first direction using average velocity values from a number, K, of preceding successive frames, where K is a whole number greater than or equal to two.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of computing velocity predictors for the said first direction using average velocity values comprises the step of computing average phase angle changes along the said first direction using K sets of unwrapped phase angle changes from the preceding successive K frames.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of computing wrapped phase angle changes comprises the step of computing changes in phase angles between two successive sample frames, calculated from an inverse tangent function using at least one set of quasi-sinusoidal signals responsive to motion.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the step of generating at least one set of quasi-sinusoidal signals comprises the step of generating at least two sets of quasi-sinusoidal signals, the first set related to motion in the first direction and a second set related to motion in a second direction.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A method according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein the step of determining a value of distance moved comprises the step of determining a value of distance moved in two-dimensions.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. A method according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising the step of computing radius values in addition to phase angle values at each sample frame as an indication of the quality of the at least two sets of quasi-sinusoidal signals related to motion in the first direction and in the second direction.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. A method according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein the computed radius values are used as weighting factors in computing velocity predictors for the first direction and the second direction using unwrapped average phase angle changes from a number, K, of preceding successive frames.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A signal processing circuit for detecting movement of a surface relative to an optical sensor having an array of photosensitive elements, the circuit comprising:
<claim-text>means for generating at least one set of quasi-sinusoidal signals responsive to motion of light received on the array in at least a first direction;</claim-text>
<claim-text>means for combining said at least one set of quasi-sinusoidal signals to generate a phase angle value for said first direction at a first time, and combining said at least one set of quasi-sinusoidal signals at a second time to generate a phase angle value for said first direction at the second time;</claim-text>
<claim-text>means for computing wrapped phase angle changes for said first direction from the phase angle values generated at said first and second times;</claim-text>
<claim-text>means for computing the unwrapped phase angle changes for said first direction;</claim-text>
<claim-text>means for determining a value of distance moved in the first direction; and</claim-text>
<claim-text>wherein the means for computing the unwrapped phase angle changes comprises means for computing velocity predictors for said first direction using average velocity values from a number, K, of preceding successive frames, where K is a whole number greater than or equal to two.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A circuit according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the means for computing velocity predictors for the said first direction using average velocity values comprises means for computing average phase angle changes along the said first direction using K sets of phase angle changes from the preceding successive K frames.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. A circuit according to <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein the means for computing wrapped phase angle changes comprises means for computing changes in phase angles between two successive sample frames, calculated from an inverse tangent function using at least one set of quasi-sinusoidal signals responsive to motion.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A signal processing circuit for detecting movement of a surface relative to an optical sensor having an array of photosensitive elements, the circuit comprising:
<claim-text>means for generating at least one set of quasi-sinusoidal signals responsive to motion of light received on the array in at least a first direction;</claim-text>
<claim-text>means for combining said at least one set of quasi-sinusoidal signals to generate a phase angle value for said first direction at a first time, and combining said at least one set of quasi-sinusoidal signals at a second time to generate a phase angle value for said first direction at the second time;</claim-text>
<claim-text>means for computing wrapped phase angle changes for said first direction from the phase angle values generated at said first and second times;</claim-text>
<claim-text>means for computing the unwrapped phase angle changes for said first direction;</claim-text>
<claim-text>means for determining a value of distance moved in the first direction; and</claim-text>
<claim-text>wherein the means for generating at least one set of quasi-sinusoidal signals comprises means for generating at least two sets of quasi-sinusoidal signals, the first set related to motion in the first direction and a second set related to motion in a second direction.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A circuit according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein the means for determining a value of distance moved comprises means for determining a value of distance moved in two-dimensions.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A method for detecting movement of a surface relative to an optical sensor having an array of photosensitive elements, the method comprising steps of:
<claim-text>generating at least two sets of quasi-sinusoidal signals responsive to motion of light received on the array, the first set of quasi-sinusoidal signals related to motion in a first direction and the second set of quasi-sinusoidal signals related to motion in a second direction;</claim-text>
<claim-text>at a first time combining said first set of quasi-sinusoidal signals to generate a wrapped phase angle value for said first direction at the first time, and combining said second set of quasi-sinusoidal signals to generate a wrapped phase angle value for said second direction at the first time;</claim-text>
<claim-text>at a second time combining said first set of quasi-sinusoidal signals to generate a wrapped phase angle value for said first direction at the second time, and combining said second set of quasi-sinusoidal signals to generate a wrapped phase angle value for said second direction at the second time;</claim-text>
<claim-text>computing wrapped phase angle changes between the first time and the second time for said first and second directions;</claim-text>
<claim-text>computing the unwrapped phase angle changes for said first and second directions using velocity predictors computed for said first and second directions;</claim-text>
<claim-text>determining a value of distance moved in the first and the second directions; and</claim-text>
<claim-text>wherein the step of computing the unwrapped phase angle changes for said first and second directions comprises the step of computing velocity predictors for said first and second directions using average velocity values from a number, K, of preceding successive frames, where K is a whole number greater than or equal to two.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the step of computing velocity predictors for said first and second directions using average velocity values comprises the step of computing average phase angle changes along said first and second directions using K sets of phase angle changes from the preceding successive K frames.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. A method according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein the step of computing wrapped phase angle changes comprises the step of computing changes in phase angles between two successive sample frames, calculated from an inverse tangent function using at least two sets of quasi-sinusoidal signals responsive to motion in the said first and second directions.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A method according to <claim-ref idref="CLM-00013">claim 13</claim-ref>, further comprising the step of computing radius values in addition to phase angle values at each sample frame as an indication of the quality of the at least two sets of quasi-sinusoidal signals related to motion in the first direction and in the second direction.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. A method according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein the computed radius values are used as weighting factors in computing velocity predictors for the first direction and the second direction using unwrapped average phase angle changes from a number, K, of preceding successive frames.</claim-text>
</claim>
</claims>
</us-patent-grant>
