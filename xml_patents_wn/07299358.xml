<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299358-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299358</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10619031</doc-number>
<date>20030714</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="regional">
<country>EP</country>
<doc-number>02293057</doc-number>
<date>20021210</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>762</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>713176</main-classification>
<further-classification>713165</further-classification>
<further-classification>713187</further-classification>
<further-classification>713193</further-classification>
<further-classification>726 26</further-classification>
<further-classification>726 27</further-classification>
</classification-national>
<invention-title id="d0e71">Indirect data protection using random key encryption</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4238854</doc-number>
<kind>A</kind>
<name>Ehrsam et al.</name>
<date>19801200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713165</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5416840</doc-number>
<kind>A</kind>
<name>Cane et al.</name>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 52</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5421006</doc-number>
<kind>A</kind>
<name>Jablon et al.</name>
<date>19950500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5944821</doc-number>
<kind>A</kind>
<name>Angelo</name>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5958051</doc-number>
<kind>A</kind>
<name>Renaud et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 22</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6014745</doc-number>
<kind>A</kind>
<name>Ashe</name>
<date>20000100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6931530</doc-number>
<kind>B2</kind>
<name>Pham et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713165</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>7055175</doc-number>
<kind>B1</kind>
<name>Le Pennec et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 24</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>7082615</doc-number>
<kind>B1</kind>
<name>Ellison et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>7114082</doc-number>
<kind>B2</kind>
<name>Klein</name>
<date>20060900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713193</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>7174457</doc-number>
<kind>B1</kind>
<name>England et al.</name>
<date>20070200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713168</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>EP</country>
<doc-number>0 816 970</doc-number>
<kind>A</kind>
<date>19980100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>EP</country>
<doc-number>0 843 249</doc-number>
<kind>A</kind>
<date>19980500</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>EP</country>
<doc-number>0 849 657</doc-number>
<kind>A</kind>
<date>19980600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>WO</country>
<doc-number>WO 00 10283</doc-number>
<kind>A</kind>
<date>20000200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>WO</country>
<doc-number>WO 01 24012</doc-number>
<kind>A</kind>
<date>20010400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>15</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>10</number-of-drawing-sheets>
<number-of-figures>15</number-of-figures>
</figures>
<us-related-documents>
<us-provisional-application>
<document-id>
<country>US</country>
<doc-number>60399592</doc-number>
<kind>00</kind>
<date>20020730</date>
</document-id>
</us-provisional-application>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040054907</doc-number>
<kind>A1</kind>
<date>20040318</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Chateau</last-name>
<first-name>Alain</first-name>
<address>
<city>Cagnes sur Mer</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Azema</last-name>
<first-name>Jerome</first-name>
<address>
<city>Villeneuve-Loubet</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Haidamous</last-name>
<first-name>Constantin</first-name>
<address>
<city>Rosny sous Bois</city>
<country>FR</country>
</address>
</addressbook>
<nationality>
<country>FR</country>
</nationality>
<residence>
<country>FR</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Wu</last-name>
<first-name>Dolly Y.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="02" rep-type="attorney">
<addressbook>
<last-name>Brady</last-name>
<first-name>W. James</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
<agent sequence="03" rep-type="attorney">
<addressbook>
<last-name>Telecky, Jr.</last-name>
<first-name>Frederick J.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Texas Instruments Incorporated</orgname>
<role>02</role>
<address>
<city>Dallas</city>
<state>TX</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Barron, Jr.</last-name>
<first-name>Gilberto</first-name>
<department>2132</department>
</primary-examiner>
<assistant-examiner>
<last-name>Dinh</last-name>
<first-name>Minh</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A computing platform (<b>10</b>) protects system firmware (<b>30</b>) using a manufacturer certificate (<b>36</b>). The manufacturer certificate binds the system firmware (<b>30</b>) to the particular computing platform (<b>10</b>). The manufacturer certificate may also store configuration parameters and device identification numbers. A secure run-time platform data checker (<b>200</b>) and a secure run-time checker (<b>202</b>) check the system firmware during operation of the computing platform (<b>10</b>) to ensure that the system firmware (<b>30</b>) or information in the manufacturer certificate (<b>36</b>) has not been altered. Application software files (<b>32</b>) and data files (<b>34</b>) are bound to the particular computing device (<b>10</b>) by a platform certificate (<b>38</b>). A key generator may be used to generate a random key and an encrypted key may be generated by encrypting the random key using a secret identification number associated with the particular computing platform (<b>10</b>). Only the encrypted key is stored in the platform certificate (<b>36</b>).</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="144.86mm" wi="205.40mm" file="US07299358-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="205.06mm" wi="172.47mm" file="US07299358-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="253.07mm" wi="177.88mm" file="US07299358-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="266.87mm" wi="175.77mm" file="US07299358-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="254.93mm" wi="143.17mm" file="US07299358-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="229.62mm" wi="160.27mm" file="US07299358-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="267.46mm" wi="168.99mm" file="US07299358-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="207.69mm" wi="149.52mm" orientation="landscape" file="US07299358-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="228.26mm" wi="170.69mm" orientation="landscape" file="US07299358-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="248.33mm" wi="165.02mm" file="US07299358-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="201.17mm" wi="141.82mm" file="US07299358-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">CROSS-REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">This application claims the benefit of the filing date of copending provisional application U.S. Ser. No. 60/399,592, filed Jul. 30, 2002, entitled “Firmware Run-Time Authentication” to Balard et al.</p>
<p id="p-0003" num="0002">This application also claims priority under the Paris Convention for the Protection of Intellectual Property of Application Number 02293057.2, filed Dec. 10, 2002 in the European Patent Office. No foreign application for this same subject matter has been filed that has a filing date before Dec. 10, 2002.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">STATEMENT OF FEDERALLY SPONSORED RESEARCH OR DEVELOPMENT</heading>
<p id="p-0004" num="0003">Not Applicable</p>
<heading id="h-0003" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0005" num="0004">1. TECHNICAL FIELD</p>
<p id="p-0006" num="0005">This invention relates in general to processing devices and, more particularly, to a secure computing system.</p>
<p id="p-0007" num="0006">2. Description of the Related Art</p>
<p id="p-0008" num="0007">Present day computing devices take many forms and shapes. Traditional computing devices include personal computers. More recently, mobile computing devices, such as PDA (personal digital assistants) and smart phones have blurred the distinction between computing devices and telecommunications devices. Further, computing devices are being used in manners virtually invisible to the user, such as controllers in automobiles.</p>
<p id="p-0009" num="0008">Manufacturers of computing devices, or parts of computing devices such as processors, have heretofore been unable to provide security to the operation of their device. One particular well-known security hazard involves attacks on a computing device by third parties. Using a variety of techniques, an attacker may change system files, application files, or data in the computing device. In some cases, such attacks are an annoyance; in other cases, the attacks can result in tremendous expenses to the owner.</p>
<p id="p-0010" num="0009">Not all unauthorized modifications of a computing device are caused by third parties. Some modifications of the intended operation of a computing device are caused by the user. For example, a user may change a device's intended settings, sometimes with the aid of unauthorized software, to “improve” the operation of a device. In some cases, such as the modification of firmware on an automobile controller, such changes could be extremely dangerous.</p>
<p id="p-0011" num="0010">In other cases, a user may want to transfer data or programs from a first device to a second device. This may be improper due to copyright restrictions or may involve moving software to a platform where it is not stable.</p>
<p id="p-0012" num="0011">Manufacturers are increasingly aware of the need to verify the origin and integrity of system firmware, software and data. While some mechanisms have had some success, such as digital certificates to verify the origin of a software provider, these measures have proven incomplete and easily circumvented, particular by sophisticated attackers or users.</p>
<p id="p-0013" num="0012">Therefore, a need has arisen for a secure computing platform.</p>
<heading id="h-0004" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0014" num="0013">In the present invention, security is provided to electronic files stored in an externally-accessible memory of a computing device using a secret identification number for the computing device in a secure memory that is not externally-accessible. A random key is associated with a selected electronic file and an encoded key is generated by symmetrically encrypting the random key using the secret identification number. A digital certificate is associated with the electronic file, where the digital certificate contains the encrypted key, such that the electronic file can be accessed only after restoring the random key through decryption of the encrypted key with the secret identification number.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWINGS</heading>
<p id="p-0015" num="0014">For a more complete understanding of the present invention, and the advantages thereof, reference is now made to the following descriptions taken in conjunction with the accompanying drawings, in which:</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a basic block diagram showing various protection mechanisms used to protect firmware, application software, and data in a mobile computing environment;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a preferred embodiment for a manufacturer certificate shown in <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart showing the use of the manufacturer certificate in a secure boot loader and a secure boot checker program;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a flow chart describing the authentication of the manufacturer's public key as stored in the manufacturer certificate;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a flow chart describing authentication of the certificate signature field in a manufacturer certificate;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a flow chart describing authentication of the originator's public key field in a manufacturer certificate;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a flow chart authenticating the firmware bound to a manufacturer certificate;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 8</figref> is a flow chart describing die identification code verification in a manufacturer certificate;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> is a flow chart describing the operation of a secure run-time platform data checker and a secure run-time checker;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> illustrates the binding of an application file or data file to a computing platform through a platform certificate;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 11</figref> illustrates the unbinding of an application or data file from the platform certificate necessary to execute the application or use the data file within an application;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 12</figref> describes a particular use of the manufacturer and/or platform certificate to securely store a IMEI (International Mobile Equipment Identity) number in external memory;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 13</figref> illustrates a block diagram of using fields in the manufacture certificate to control the operation of the device;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 14</figref> illustrates a variation on <figref idref="DRAWINGS">FIG. 13</figref> where configuration data is stored in a data file protected by a platform certificate; and</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 15</figref> illustrates an alternative design for accessing the device <b>10</b> is a certain mode, such as a test mode.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION OF THE INVENTION</heading>
<p id="p-0031" num="0030">The present invention is best understood in relation to <figref idref="DRAWINGS">FIGS. 1-15</figref> of the drawings, like numerals being used for like elements of the various drawings.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a basic block diagram showing various protection mechanisms used to protect firmware, application software, and data in a mobile computing environment. While the invention is discussed herein with regard to a mobile computing device, such as a mobile phone or PDA, it is applicable to other computing devices as well.</p>
<p id="p-0033" num="0032">The circuitry of mobile computing device <b>10</b> of <figref idref="DRAWINGS">FIG. 1</figref> is divided into three major blocks. A baseband processing system <b>12</b>, an external non-volatile memory system <b>14</b>, and a RF (radio frequency) system <b>16</b>. The baseband processing system is responsible for processing data prior to RF modulation. In <figref idref="DRAWINGS">FIG. 1</figref>, the baseband processing system <b>12</b> embeds an internal memory subsystem <b>18</b>, including SRAM (static random access memory) <b>20</b>, ROM (read-only memory) <b>22</b> and a fused memory array (eFuse) <b>24</b>. One or more processing devices <b>26</b>, such as general purpose processors, digital signal processors, and coprocessors, are coupled to the internal memory subsystem <b>18</b>. Input/Output (I/O) circuitry <b>28</b> is coupled to the processor(s) <b>26</b> and internal memory subsystem <b>18</b>.</p>
<p id="p-0034" num="0033">Firmware <b>30</b>, application software <b>32</b> and data files <b>34</b> are stored in the external non-volatile memory system <b>14</b>. Firmware <b>30</b> is the basic system code stored on the device by the manufacturer prior to sale. The firmware <b>30</b> is permanently resident on the platform, although it may be updated by the manufacturer to add functionality or to correct errors. In many cases, it is extremely important that only the firmware <b>30</b> placed on the device <b>10</b> by the manufacturer is used, and that the firmware not be modified or replaced by anyone other than the manufacturer or someone working under the authority of the manufacturer. Hence, security is an extremely important issue with regard to firmware <b>30</b>. Additionally, it is important that unauthorized firmware is not executed. Security may also be an issue with regard to application software <b>32</b> and data files <b>34</b>. For application software <b>32</b> and data files <b>34</b>, it is often important to ensure the integrity of these files; for example, it may be desirable to ensure that the files are not modified, deleted or replaced by other “virus” software. Also, it is often important to prevent the copying of application software <b>32</b> and data files <b>34</b> (such as music and video files) to protect the copyrights of the owner of the underlying work.</p>
<p id="p-0035" num="0034">As shown in <figref idref="DRAWINGS">FIG. 1</figref>, two types of protection mechanisms may be used to protect the contents of the external memory, which is often easily accessible. With regard to the firmware, a “manufacturer” certificate <b>36</b> binds the firmware to the particular computing device <b>10</b> (multiple manufacturer certificates may be bound to respective firmware tasks). Similarly, application software <b>32</b> and data files <b>34</b> are bound to the particular computing device <b>10</b> by respective “platform” certificates <b>38</b>. These certificates, described in detail below, can be used to prevent modification of (and optionally to preserve the confidentiality of) the firmware, application software and data, and further prevent copying the firmware, application software and data to another device.</p>
<p id="p-0036" num="0035">The security features described herein make use of several encryption techniques. In “symmetric-key” (or “secret key”) cryptography, the same secret key is used for both encryption and decryption. An example of a symmetric-key cryptosystem is DES (Data Encryption Standard). In “asymmetric” (or “public-key”) cryptography, a pair of keys are used, a secret key and a public key. A key generation algorithm produces the matched pair of keys, such that information may be encrypted using the public key (which may be published to prospective senders) and decrypted using the private key (which is maintained in secret by the recipient) and, conversely, information encrypted with the private key can be decrypted with the public key. Deducing the private key from the public key is not computationally feasible. Using an asymmetric cryptosystem, parties with no prior security arrangement can exchange information, since the private key need not be sent through a secure channel. RSA encryption (developed by RSA Security, Inc.) is an example of public key cryptography.</p>
<p id="p-0037" num="0036">A one-way hash function takes a variable-length input and produces a fixed-length output, known as a “message digest” or “hash”. The hash function ensures that, if the information is changed in any way, an entirely different output value is produced. Hash algorithms are typically used in verifying the integrity of data. SHA-1 (160 bit hash) and MD5 (128 bit hash) are examples of one-way hash functions.</p>
<p id="p-0038" num="0037">A digital signature enables the recipient of information to verify the authenticity of the information's origin, and also verify that the information is intact. Typically, the sender signs a message by computing its hash and encrypting the hash with the sender's private key. The recipient verifies the signature on the message by decrypting it with sender's public key (thus obtaining the transmitted hash), computing the hash of the received message, and comparing the two. Thus, public key digital signatures provide authentication and data integrity. A digital signature also provides non-repudiation, which means that it prevents the sender from disclaiming the origin of the information. DSA (Digital Signature Algorithm) is an example of a digital signature cryptosystem.</p>
<p id="p-0039" num="0038">One issue with public key cryptosystems is that users must be constantly vigilant to ensure that they are encrypting or decrypting with the correct public key, to be protected against man-in-the-middle attacks (where an attacker intercepts packets in a data stream, modifies the packets, and passes them to their intended destination by claiming to be the original sender). A digital certificate is a form of digital passport or credential that simplifies the task of establishing whether a public key truly belongs to the purported owner. In its simplest form, a certificate is the user's public key that has been digitally signed by someone trusted, such as a certificate authority. A certificate can also contain additional information such as version number, user ID number, expiration date, and so on.</p>
<p id="p-0040" num="0039">Certain code and keys are maintained internally on the baseband processing system <b>12</b> in support of other security features. Several system programs are located in ROM <b>22</b>, in order to prevent any malicious tampering. The programs include the Secure Boot Loader (described in detail in connection with <figref idref="DRAWINGS">FIG. 3</figref>), the Secure Reset Boot Checker (described in detail in connection with <figref idref="DRAWINGS">FIG. 3</figref>), the Secure Run-Time Platform Data Checker (described in detail in connection with <figref idref="DRAWINGS">FIG. 9</figref>), the Secure Run-Time Checker (described in detail in connection with <figref idref="DRAWINGS">FIG. 9</figref>), the Secure Run-Time Loader (described in detail in connection with <figref idref="DRAWINGS">FIGS. 10 and 11</figref>), and various cryptographic software to support data encryption and hashing. Some or all of the cryptographic techniques may be performed in conjunction with a dedicated crypto-processor.</p>
<p id="p-0041" num="0040">In addition, in the preferred embodiment, certain system data is maintained on the eFuse Array <b>24</b> (or other permanent memory internal to the baseband processing system <b>12</b>). After the data is written to the array, further writing to the particular location is disabled, such that the data cannot be overwritten.</p>
<p id="p-0042" num="0041">A die identification number is a unique number associated with each individual device. In the preferred embodiment, this number is stored as DIE_ID_FUSE in the eFuse array <b>24</b> at the time of manufacture. This identification code is not considered secret and may be read by non-secure software.</p>
<p id="p-0043" num="0042">The manufacturer's public key (the “manufacturer” being the manufacture of device <b>10</b>) is also stored in the eFuse array <b>24</b> after hashing as H_Man_Pub_Key. The location storing H_Man_Pub_Key does not need to be protected from external access, since the manufacturer's public key is not secret; however, it should be protected from modification after writing. Use of H_Man_Pub_Key is discussed in greater detail in connection with <figref idref="DRAWINGS">FIG. 4</figref>. It should be noted that the hashing of the manufacturer's public key is optional; hashing is used to compact long keys to reduce the amount of memory needed to store the key.</p>
<p id="p-0044" num="0043">A test ID, or other access ID, may also be hashed and stored in the eFuse array <b>24</b>. The hashed test ID (H_Test_ID) may be used to prevent unauthorized access to the device in test mode, where certain protections are disabled. This aspect is discussed in greater detail in connection with <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0045" num="0044">A Key Encryption Key (KEK) is a secret key preferably generated by a random number generator internal to the baseband processor at the time of production of the device. The KEK is stored in the eFuse array <b>24</b> and is not modifiable or externally accessible. The KEK for a particular device, therefore, cannot be determined even by the manufacturer. The KEK is used to dynamically provide additional encrypted keys for the platform certificates <b>38</b>, as described in greater detail in connection with <figref idref="DRAWINGS">FIGS. 10 and 11</figref>.</p>
<p id="p-0046" num="0045"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a preferred embodiment for a manufacturer certificate <b>36</b>. It should be understood that a manufacture certificate <b>36</b> for a particular device could contain more or less fields than the embodiment shown in <figref idref="DRAWINGS">FIG. 2</figref>. A summary of the fields of the for the manufacturer certificate <b>36</b> of <figref idref="DRAWINGS">FIG. 2</figref> are described in Table 1.</p>
<p id="p-0047" num="0046">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 1</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Manufacturer Certificate</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="77pt" align="left"/>
<colspec colname="2" colwidth="91pt" align="left"/>
<colspec colname="3" colwidth="49pt" align="left"/>
<tbody valign="top">
<row>
<entry>Field Name</entry>
<entry>Function</entry>
<entry>Security</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>CERT_SIZE</entry>
<entry>Certificate's size (in bytes)</entry>
<entry/>
</row>
<row>
<entry>CERT_TYPE</entry>
<entry>Certificate's type:</entry>
</row>
<row>
<entry/>
<entry>Manufacturer</entry>
</row>
<row>
<entry>DEBUG_REQ</entry>
<entry>Debug request</entry>
</row>
<row>
<entry>CODE_ADDR</entry>
<entry>Address where is stored the</entry>
</row>
<row>
<entry/>
<entry>code to verify</entry>
</row>
<row>
<entry>CODE_SIZE</entry>
<entry>Size of the software module</entry>
</row>
<row>
<entry/>
<entry>(in bytes)</entry>
</row>
<row>
<entry>CODE_START_ADDR</entry>
<entry>Address of software entry</entry>
</row>
<row>
<entry/>
<entry>point</entry>
</row>
<row>
<entry>MAN_PUB_KEY</entry>
<entry>Manufacturer's Public Key</entry>
</row>
<row>
<entry>ORIG_PUB_KEY</entry>
<entry>Originator's Public Key</entry>
</row>
<row>
<entry>ORIG_PUB_KEY_SIG</entry>
<entry>Signature of Originator's</entry>
<entry>Originator's</entry>
</row>
<row>
<entry/>
<entry>Public Key by the</entry>
<entry>Public Key,</entry>
</row>
<row>
<entry/>
<entry>Manufacturer</entry>
<entry>hashed and</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encrypted using</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Manufacturer's</entry>
</row>
<row>
<entry/>
<entry/>
<entry>private key</entry>
</row>
<row>
<entry>SW_SIG</entry>
<entry>Software signature by the</entry>
<entry>Firmware code</entry>
</row>
<row>
<entry/>
<entry>Originator</entry>
<entry>hashed and</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encrypted using</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Originator's</entry>
</row>
<row>
<entry/>
<entry/>
<entry>private key</entry>
</row>
<row>
<entry>DIE_ID</entry>
<entry>Die ID number</entry>
</row>
<row>
<entry>CONF_PARAM</entry>
<entry>Platform configuration</entry>
</row>
<row>
<entry/>
<entry>parameters:</entry>
</row>
<row>
<entry/>
<entry>DPLL frequency</entry>
</row>
<row>
<entry/>
<entry>Memory access wait-state</entry>
</row>
<row>
<entry/>
<entry>Initial values of HW</entry>
</row>
<row>
<entry/>
<entry>configuration parameters such</entry>
</row>
<row>
<entry/>
<entry>as RF parameters (filters,</entry>
</row>
<row>
<entry/>
<entry>gains) or battery management</entry>
</row>
<row>
<entry/>
<entry>parameters (charging curves)</entry>
</row>
<row>
<entry>PLATFORM_DATA</entry>
<entry>Data related to the hardware</entry>
</row>
<row>
<entry/>
<entry>Platform:</entry>
</row>
<row>
<entry/>
<entry>IMEI number</entry>
</row>
<row>
<entry/>
<entry>. . .</entry>
</row>
<row>
<entry>SIG_CERT</entry>
<entry>Certificate signature by the</entry>
<entry>Manufacturer</entry>
</row>
<row>
<entry/>
<entry>manufacturer</entry>
<entry>certificate</entry>
</row>
<row>
<entry/>
<entry/>
<entry>fields hashed</entry>
</row>
<row>
<entry/>
<entry/>
<entry>and encrypted</entry>
</row>
<row>
<entry/>
<entry/>
<entry>using</entry>
</row>
<row>
<entry/>
<entry/>
<entry>Manufacturer's</entry>
</row>
<row>
<entry/>
<entry/>
<entry>private key</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0048" num="0047">The certificate size (CERT_SIZE) and certificate type (CERT_TYPE) fields indicate the size and the type (i.e., “manufacturer”) of the manufacturer certificate <b>36</b>. The debug request (DEBUG_REQ) may be set by the manufacturer to enable or disable emulation on the device. As described below, only the manufacturer can set the value of this field. The code address (CODE_ADDR) field indicates the starting address of the code in the external memory <b>14</b>. The code size field (CODE_SIZE) indicates the size (in bytes) of the firmware. The code starting address (CODE_START_ADDR) indicates the entry point of the firmware at execution.</p>
<p id="p-0049" num="0048">The manufacturer certificate <b>36</b> further includes the manufacturer's public key (MAN_PUB_KEY) and the software originator's public key (ORIG_PUB_KEY); this assumes that the firmware is generated by a third party with its own signature. If the firmware is generated by the manufacturer, a second public key for the manufacturer can be optionally be used. A signature for the originator's public key is generated by hashing ORIG_PUB_KEY and encrypting the hashed ORIG_PUB_KEY using the manufacturer's private key (MAN_PRI_KEY).</p>
<p id="p-0050" num="0049">A software signature is generated by hashing the code of firmware <b>30</b> and encrypting the resulting hashed code using the originator's private key (ORIG_PRI_KEY). Since ORIG_PRI_KEY is private to the originator, the SW_SIG must be provided to the manufacturer by the originator.</p>
<p id="p-0051" num="0050">The DIE_ID of the particular device <b>10</b> is added to the manufacturer certificate <b>36</b>. This couples the code to a single device, preventing copying of the firmware to a different device.</p>
<p id="p-0052" num="0051">Configuration parameters are set in the CONF_PARAM field of the manufacturer certificate <b>36</b>. As described in connection with <figref idref="DRAWINGS">FIGS. 13 and 14</figref>, information in this field can be used to set functionality in the device <b>10</b>. For example, parameters in the CONF_PARAM field could be used to set DPLL (digital phase lock loop) frequencies, memory access wait states, filter and gain values in the RF circuitry <b>16</b>, and battery management parameters (such as charging curves).</p>
<p id="p-0053" num="0052">Data unique to the particular device can be stored in the PLATFORM_DATA field. For example, an IMEI number can be stored in this field. This aspect is described in greater detail in connection with <figref idref="DRAWINGS">FIG. 12</figref>.</p>
<p id="p-0054" num="0053">A manufacturer certificate signature (SIG_CERT) prevents tampering with any of the fields of the manufacturer certificate <b>36</b>. The SIG_CERT is generated by hashing the other fields of the manufacturer certificate and encrypting the hashed code with the MAN_PRI_KEY.</p>
<p id="p-0055" num="0054"><figref idref="DRAWINGS">FIG. 3</figref> is a flow chart showing the use of the manufacturer certificate <b>36</b> in a secure boot loader <b>50</b> and a secure boot checker program <b>52</b>, preferably stored ROM <b>22</b> to protect the programs from alteration of program flows. The secure boot loader determines whether boot system firmware is available for uploading at power-up. If so, the secure boot loader first loads a flash programmer. The flash programmer is used to load the system boot firmware. The flash programmer must also have a manufacturer certificate <b>36</b> and the secure boot loader is responsible for ensuring the authenticity and integrity of the flash programmer's manufacturer certificate and the code of the flash programmer program prior to any execution of the flash programmer. The flash programmer then uploads the system boot firmware.</p>
<p id="p-0056" num="0055">The secure reset boot checker <b>52</b> checks the authenticity and integrity of the certificate of the system boot firmware (and any other firmware) stored in external memory <b>14</b> before its execution. Upon execution of the secure boot loader <b>50</b> or secure reset boot checker <b>52</b>, the device <b>10</b> is configured to disallow any interruption or other bypassing of their execution prior to completion.</p>
<p id="p-0057" num="0056">In step <b>54</b>, the secure boot loader <b>50</b> and secure reset boot checker <b>52</b> await a power-on or system reset. In step <b>56</b>, upon a power-on or system reset, the secure boot loader <b>50</b> checks a chosen interface, such as the UART (universal asynchronous receiver/transmitter), for a synchronization signal on the interface's physical bus. If no activity is detected on the physical bus after a time-out or a watchdog reset (step <b>58</b>), then it is assumed that no system firmware download is forthcoming and control switches to the secure reset boot checker <b>52</b>.</p>
<p id="p-0058" num="0057">Assuming that download activity is detected on the physical bus, steps <b>60</b> through <b>70</b> check the manufacturer certificate <b>36</b> of the flash programmer prior to any execution of the flash programmer. In step <b>60</b>, the manufacturer's public key (MAN_PUB_KEY) from the manufacturer certificate of the flash programmer is authenticated. Authentication of MAN_PUB_KEY is illustrated in <figref idref="DRAWINGS">FIG. 4</figref>.</p>
<p id="p-0059" num="0058"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a flow chart describing the authentication of the manufacturer's public key as stored in the manufacturer certificate <b>36</b>. In step <b>100</b>, MAN_PUB_KEY from the manufacturer certificate of the firmware (in this case, the flash programmer) is hashed and, in step <b>102</b>, the resulting hash is compared to H_MAN_PUB_KEY from the eFuse memory array <b>24</b>. If there is a match in step <b>104</b>, then the authentication returns a “pass”; otherwise a fail is returned.</p>
<p id="p-0060" num="0059">In an alternative embodiment, a hashed value for the manufacturer's public key is stored in manufacturer certificate <b>36</b>; in this case, hashing step <b>100</b> can be eliminated. Also, only a predetermined number of least significant bits of the hashed manufacturer's public key can be stored in the eFuse memory <b>14</b>; in this case, only corresponding bits would be compared in step <b>104</b>.</p>
<p id="p-0061" num="0060">Referring again to <figref idref="DRAWINGS">FIG. 3</figref>, if the authentication of the manufacturer's public key results in a “fail” in step <b>62</b>, then the process is aborted in step <b>64</b>, and the loading of the flash programmer ceases. The device <b>10</b> is reset and the downloading of the flash programmer can be re-attempted.</p>
<p id="p-0062" num="0061">If the authentication of the manufacturer's public key results in a “pass” in step <b>62</b>, then the certificate signature (SIG_CERT) is authenticated in step <b>66</b>.</p>
<p id="p-0063" num="0062"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a flow chart describing the SIG_CERT authentication. In step <b>110</b>, the fields of the manufacturer certificate <b>36</b>, other than the SIG_CERT field, are hashed. In step <b>112</b>, the SIG_CERT field of the manufacturer certificate <b>36</b> is decrypted using the MAN_PUB_KEY. It should be noted that the authentication of the manufacturer certificate is performed after the authentication of MAN_PUB_KEY; therefore, the SIG_CERT can only be decrypted properly if it was originally encrypted using the manufacturer's private key. The hash of the certificate from step <b>110</b> is compared with the decrypted SIG_CERT in step <b>114</b>. If there is a match in step <b>116</b>, then the authentication is passed; otherwise, it is failed. A failed authentication indicates that one or more of the fields of the manufacturer certificate <b>36</b> for the firmware have been altered.</p>
<p id="p-0064" num="0063">Referring again to <figref idref="DRAWINGS">FIG. 3</figref>, if the authentication of the manufacturer certificate signature results in a “fail” in step <b>68</b>, then the process is aborted in step <b>64</b>, and the loading of the flash programmer ceases. The device <b>10</b> is reset and the downloading of the flash programmer can be re-attempted.</p>
<p id="p-0065" num="0064">Assuming the authentication of the manufacturer certificate signature passes, then step <b>70</b> authenticates the originator's public key field of the manufacturer certificate (ORIG_PUB_KEY) and authenticates the actual firmware code, with respect to the originator's public key and the software signature (SW_SIG).</p>
<p id="p-0066" num="0065"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a flow chart describing the authentication of ORIG_PUB_KEY. In step <b>120</b>, ORIG_PUB_KEY_SIG is decrypted using MAN_PUB_KEY. The ORIG_PUB_KEY field of the manufacturer certificate <b>36</b> is hashed in step <b>122</b> and compared to the decrypted signature in step <b>124</b>. If there is a match in decision block <b>126</b>, the authentication passes; otherwise it fails, indicating that either the ORIG_PUB_KEY or the ORIG_PUB_KEY_SIG has been modified.</p>
<p id="p-0067" num="0066"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a flow chart authenticating the firmware bound to the manufacturer certificate <b>36</b>. In step <b>130</b>, the SW_SIG field of the manufacturer certificate <b>36</b> is decrypted using the ORIG_PUB_KEY, which has previously been authenticated. In step <b>132</b>, the firmware <b>30</b> is hashed. The resultant hash is compared to the decrypted signature in block <b>134</b>. If there is a match in decision block <b>136</b>, the authentication passes; otherwise it fails, indicating that the firmware has been modified.</p>
<p id="p-0068" num="0067">Referring again to <figref idref="DRAWINGS">FIG. 3</figref>, if the authentication of either the originator's public key or of the firmware (in this case the flash programmer) fails in step <b>72</b>, then the process is aborted in step <b>64</b>, and the loading of the flash programmer ceases. The device <b>10</b> is reset and the downloading of the flash programmer can be re-attempted.</p>
<p id="p-0069" num="0068">If all authentication tests are passed, then the flash programmer executes in block <b>74</b>. The flash programmer loads the system boot software and forces a reset in step <b>76</b>. Typically, the flash programmer is erased from memory prior to the reset.</p>
<p id="p-0070" num="0069">The secure reset boot checker <b>52</b> will run after a timeout in decision block <b>58</b>. This will normally happen after completion of a flash programmer execution (unless there is another firmware download) or after a power-on or reset when there is no firmware download pending. The secure reset boot checker authenticates fields in the system boot software, as opposed to the manufacturer certificate of the flash programmer, as discussed in connection with the operation of the secure boot loader.</p>
<p id="p-0071" num="0070">In step <b>78</b>, manufacturer's public key of the manufacturer certificate <b>36</b> associated with the system boot software is authenticated using the authentication process shown in <figref idref="DRAWINGS">FIG. 4</figref>. If the authentication fails in decision block <b>80</b>, then the process is aborted in block <b>64</b>.</p>
<p id="p-0072" num="0071">If the manufacturer's public key authentication passes in decision block <b>80</b>, then the system boot firmware certificate (CERT_SIG) is authenticated in block <b>82</b>. Authentication of the firmware certificate is shown in <figref idref="DRAWINGS">FIG. 5</figref>. If the authentication fails in decision block <b>84</b>, then the process is aborted in block <b>64</b>.</p>
<p id="p-0073" num="0072">If the firmware certificate authentication passes in decision block <b>84</b>, then the originator's public key (ORIG_PUB_KEY) is authenticated in block <b>86</b>. Authentication of the originator's public key is shown in <figref idref="DRAWINGS">FIG. 6</figref>. If the authentication fails in decision block <b>88</b>, then the process is aborted in block <b>64</b>.</p>
<p id="p-0074" num="0073">If the originator's public key authentication passes in decision block <b>88</b>, then the system boot firmware is authenticated in block <b>90</b>. Authentication of the firmware is shown in <figref idref="DRAWINGS">FIG. 7</figref>. If the authentication fails in decision block <b>92</b>, then the process is aborted in block <b>64</b>.</p>
<p id="p-0075" num="0074">If the firmware authentication passes in decision block <b>92</b>, then the die identification code is verified in block <b>94</b>. <figref idref="DRAWINGS">FIG. 8</figref> is a flow chart describing die identification code verification. In step <b>140</b>, if the DIE_ID field of the manufacturer certificate <b>36</b> is set to “0”, then a “0” is returned. Otherwise, the DIE_ID field is compared to the DIE_ID_FUSE value stored in the eFuse memory <b>14</b>. A value is returned indicating whether or not the two fields matched.</p>
<p id="p-0076" num="0075">Referring again to <figref idref="DRAWINGS">FIG. 3</figref>, if the DIE_ID field is set to “0”, then the Die ID validity status is returned and the process continues in block <b>96</b>.</p>
<p id="p-0077" num="0076">If the DIE_ID field is not set to “0”, and the die ID in the manufacturer certificate <b>36</b> does not match the DIE_ID_FUSE in the eFuse memory <b>24</b>, then certain features may be disabled; however, some features may remain available, such as the ability to make emergency calls.</p>
<p id="p-0078" num="0077">The secure boot loader and secure reset boot checker ensure that only valid firmware is loaded onto the device <b>10</b>, either at the time of manufacture, or for upgrades. User or third party modification or replacement of the stored firmware is prevented, since no system firmware can be loaded without encryption using the manufacturer's private key.</p>
<p id="p-0079" num="0078">Nonetheless, even with protected installation of the firmware, additional measures are taken to prevent alteration of the firmware, or specific data, during execution of the firmware. This additional security prevents disclosure of data stored in the device by altering execution privileges or the re-use of device <b>10</b> with unauthorized firmware.</p>
<p id="p-0080" num="0079">During operation of the device <b>10</b>, after loading the system firmware, the secure run-time platform data checker and the secure run-time checker ensure that the system software is not modified and ensures that settings provided in the PLATFORM_DATA field of the manufacturer certificate <b>36</b> of the system software.</p>
<p id="p-0081" num="0080"><figref idref="DRAWINGS">FIG. 9</figref> is a flow chart describing the operation of the secure run-time platform data checker and the secure run-time checker. The secure run-time platform data checker <b>200</b> prevents alteration of specific data associated with the device <b>10</b> that is stored in the PLATFORM_DATA field of the manufacturer certificate <b>36</b>. The secure run-time checker <b>202</b> prevents alteration or swapping of firmware.</p>
<p id="p-0082" num="0081">In step <b>204</b>, a secure service call is initiated. In the preferred embodiment, the secure service call is initiated upon detection of a period of inactivity of the processor(s) <b>26</b>, such that the checkers <b>200</b> and <b>202</b> cause minimal interference with other applications. The secure service call may also be initiated from an on-chip hardware timer which ensures that the service call is performed within a pre-set time, regardless of available periods of inactivity. The pre-set time can be configured at boot time according the a configuration parameter stored in the CONFIG_PARAM field of the manufacturer certificate <b>36</b>. Also, a secure service call can be initiated upon a request from a software application. Once the secure service call is initiated, all interrupts are disabled such that the processor executing the secure run-time platform data checker <b>200</b> and secure run-time checker <b>202</b> cannot be interrupted nor deviated from execution of the checker tasks until completion.</p>
<p id="p-0083" num="0082">With regard to the secure run-time platform data checker, in step <b>206</b>, the manufacturer's public key (MAN_PUB_KEY) stored in the manufacturer certificate <b>36</b> is authenticated, as previously described in connection with <figref idref="DRAWINGS">FIG. 4</figref>. Authenticating MAN_PUB_KEY prevents substitution of false public key/private key combination for later authentication steps.</p>
<p id="p-0084" num="0083">If the manufacturer's public key authentication fails in step <b>208</b>, then the secure run-time platform data checker process <b>200</b> is aborted and the device is reset in step <b>210</b>.</p>
<p id="p-0085" num="0084">Assuming the manufacturer's public key authentication passes in step <b>208</b>, then the system boot firmware certificate is authenticated in step <b>212</b>. Authentication of the system boot firmware certificate is performed as previously described in connection with <figref idref="DRAWINGS">FIG. 5</figref>. This step ensures that no changes have been made to the data in the manufacturer certificate <b>36</b>, particularly to the values stored in the PLATFORM_DATA field.</p>
<p id="p-0086" num="0085">If the system boot firmware certificate authentication fails in step <b>214</b>, then the secure run-time platform data checker process <b>200</b> is aborted and the device is reset in step <b>210</b>.</p>
<p id="p-0087" num="0086">If the DIE_ID of the manufacturer certificate is not set to zero, then the DIE_ID field is compared to DIE_ID_FUSE stored in the eFuse memory <b>24</b>. A successful comparison guarantees that the platform related data in the manufacturer certificate belong to the platform. If the DIE_ID of the manufacturer certificate is set to zero, a successful comparison of the PLATFORM_DATA field read from the manufacturer certificate <b>36</b> with the PLATFORM_DATA field associated with the platform certificate <b>38</b> guarantees that the platform related data in the manufacturer certificate belongs to the platform.</p>
<p id="p-0088" num="0087">The validity status of the platform data is returned to the calling software (if any) in step <b>218</b>. If the platform data does not match the expected platform data, certain features of the device may be disabled; however, some features may remain available, such as the ability to make emergency calls.</p>
<p id="p-0089" num="0088">Steps <b>220</b> through <b>240</b> describe the operation of the secure run-time checker <b>202</b>. These steps can be run on each firmware task. In step <b>220</b>, the manufacturer's public key (MAN_PUB_KEY) stored in the manufacturer certificate <b>36</b> of the firmware under test is authenticated, as previously described in connection with <figref idref="DRAWINGS">FIG. 4</figref>. Authenticating MAN_PUB_KEY prevents substitution of false public key/private key combination for later authentication steps.</p>
<p id="p-0090" num="0089">If the manufacturer's public key authentication fails in step <b>222</b>, then, if the firmware under test is the system boot firmware (step <b>224</b>), the secure run-time checker process <b>202</b> is aborted and the device is, reset in step <b>210</b>. If the firmware under test is other than the system boot firmware, then execution is aborted in step <b>226</b>.</p>
<p id="p-0091" num="0090">Assuming the manufacturer's public key authentication passes in step <b>222</b>, then the firmware certificate (SIG_CERT) of the firmware under test is authenticated in step <b>228</b>. Authentication of the firmware certificate is performed as previously described in connection with <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0092" num="0091">If the firmware certificate authentication fails in step <b>230</b>, then, if the firmware under test is the system boot firmware (step <b>224</b>), the secure run-time checker process <b>202</b> is aborted and the device is reset in step <b>210</b>. If the firmware under test is other than the system boot firmware, then execution is aborted in step <b>226</b>.</p>
<p id="p-0093" num="0092">Assuming the firmware certificate authentication passes in step <b>230</b>, then the originator's public key (ORIG_PUB_KEY) is authenticated in step <b>232</b>. Authentication of the ORIG_PUB_KEY of the manufacturer certificate of the firmware under test is performed as described in connection with <figref idref="DRAWINGS">FIG. 6</figref>.</p>
<p id="p-0094" num="0093">If the originator's public key authentication fails in step <b>234</b>, then, if the firmware under test is the system boot firmware (step <b>224</b>), the secure run-time checker process <b>202</b> is aborted and the device is reset in step <b>210</b>. If the firmware under test is other than the system boot firmware, then execution is aborted in step <b>226</b>.</p>
<p id="p-0095" num="0094">If the originator's public key authentication passes in step <b>234</b>, then the firmware is authenticated in step <b>236</b>. Firmware authentication is performed as described in connection with <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0096" num="0095">If the firmware authentication fails in step <b>238</b>, then, if the firmware under test is the system boot firmware (step <b>224</b>), the secure run-time checker process <b>202</b> is aborted and the device is reset in step <b>210</b>. If the firmware under test is other than the system boot firmware, then execution is aborted in step <b>226</b>.</p>
<p id="p-0097" num="0096">If all authentication tests pass, then the Die ID is verified in step <b>240</b>. Verification of the Die ID is performed as previously described in connection with <figref idref="DRAWINGS">FIG. 8</figref>.</p>
<p id="p-0098" num="0097">The validity status of the Die ID is returned to the calling software (if any) in step <b>242</b>. If the DIE_ID field is not set to “0”, and the die ID in the manufacturer certificate <b>36</b> does not match the DIE_ID_FUSE in the eFuse memory <b>24</b>, then certain features may be disabled; however, some features may remain available, such as the ability to make emergency calls.</p>
<p id="p-0099" num="0098">After completion of the checker tasks <b>200</b> and <b>202</b>, if the firmware is successfully tested, previous processing resumes from the point of stoppage and interrupts are re-enabled.</p>
<p id="p-0100" num="0099">By performing firmware and platform data authentication during execution of the firmware, firmware replacement after initiation can be detected and thwarted. By managing the processor's state before and after executing the checking tasks <b>200</b> and <b>202</b>, the tasks can be executed without re-initialization of the system.</p>
<p id="p-0101" num="0100"><figref idref="DRAWINGS">FIG. 10</figref> illustrates the binding of a platform certificate <b>38</b> to an application file <b>32</b> or data file <b>34</b>. Table 2 lists the fields for a preferred embodiment of a platform certificate.</p>
<p id="p-0102" num="0101">
<tables id="TABLE-US-00002" num="00002">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="1">
<colspec colname="1" colwidth="217pt" align="center"/>
<thead>
<row>
<entry namest="1" nameend="1" rowsep="1">TABLE 2</entry>
</row>
</thead>
<tbody valign="top">
<row>
<entry namest="1" nameend="1" align="center" rowsep="1"/>
</row>
<row>
<entry>Platform Certificate</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="3">
<colspec colname="1" colwidth="56pt" align="left"/>
<colspec colname="2" colwidth="105pt" align="left"/>
<colspec colname="3" colwidth="56pt" align="left"/>
<tbody valign="top">
<row>
<entry>Field Name</entry>
<entry>Function</entry>
<entry>Security</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
<row>
<entry>CERT_SIZE</entry>
<entry>Certificate's size (in bytes)</entry>
<entry/>
</row>
<row>
<entry>CERT_TYPE</entry>
<entry>Certificate's type: Platform</entry>
</row>
<row>
<entry>CONFID_REQ</entry>
<entry>Confidentiality request (S/W</entry>
</row>
<row>
<entry/>
<entry>encryption)</entry>
</row>
<row>
<entry>APPLI_ID</entry>
<entry>Identifier of the application</entry>
</row>
<row>
<entry/>
<entry>proprietary of the code and/or data</entry>
</row>
<row>
<entry/>
<entry>certified by this certificate</entry>
</row>
<row>
<entry>CODE_ADDR</entry>
<entry>Address where are stored the code</entry>
</row>
<row>
<entry/>
<entry>and/or data to verify</entry>
</row>
<row>
<entry>CODE_SIZE</entry>
<entry>Size of the certified code and/or</entry>
</row>
<row>
<entry/>
<entry>data (in bytes)</entry>
</row>
<row>
<entry>IV</entry>
<entry>Initial Vector value for bulk</entry>
</row>
<row>
<entry/>
<entry>encryption/decryption in CBC</entry>
</row>
<row>
<entry/>
<entry>mode</entry>
</row>
<row>
<entry>ENC_SW_KEY</entry>
<entry>Encrypted SW symmetrical key</entry>
<entry>Random number</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encrypted using</entry>
</row>
<row>
<entry/>
<entry/>
<entry>KEK</entry>
</row>
<row>
<entry>SW_SIG</entry>
<entry>Code and/or data signature by the</entry>
<entry>Application code</entry>
</row>
<row>
<entry/>
<entry>SW symmetrical key</entry>
<entry>hash encrypted by</entry>
</row>
<row>
<entry/>
<entry/>
<entry>random number</entry>
</row>
<row>
<entry/>
<entry/>
<entry>key (SW_KEY)</entry>
</row>
<row>
<entry>SIG_CERT</entry>
<entry>Certificate signature by the SW</entry>
<entry>Manufacturer</entry>
</row>
<row>
<entry/>
<entry>symmetrical key</entry>
<entry>certificate fields</entry>
</row>
<row>
<entry/>
<entry/>
<entry>hashed and</entry>
</row>
<row>
<entry/>
<entry/>
<entry>encrypted by</entry>
</row>
<row>
<entry/>
<entry/>
<entry>random number</entry>
</row>
<row>
<entry/>
<entry/>
<entry>key (SW_KEY)</entry>
</row>
<row>
<entry namest="1" nameend="3" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0103" num="0102">The platform certificate <b>38</b> makes use of the KEK stored in eFuse memory <b>14</b>. In the preferred embodiment, the KEK is a random number generated on-chip during production, such that the value of the KEK is not known to anyone. The KEK in the eFuse memory <b>14</b> such that it is not accessible through I/O ports or to application software. It is desirable that each chip's KEK be used in a manner that it cannot be externally determined or intercepted by other programs. While storage of the KEK in the eFuse memory <b>14</b> allows determination through physical observation of the fuses in the fused memory, such observation can only upon destruction of the chip itself; since each chip generates its own KEK, knowledge of one chip's KEK will not compromise the security of other chips.</p>
<p id="p-0104" num="0103">The KEK is used to encrypt other software keys that are randomly generated during operation of the device. As shown in <figref idref="DRAWINGS">FIG. 9</figref>, a random number generator <b>250</b> (which could be either a hardware or software implementation) generates a random software key (SW_KEY) as necessary. Hence, each application may be associated with a different software key. SW_KEY is encrypted using the KEK in step <b>252</b> and stored in the platform certificate <b>38</b> as ENC_SW_KEY. Since ENC_SW_KEY can only be decrypted using the KEK, and since the KEK is secret and internal to the chip, ENC_SW_KEY can only be decrypted to applications that have access to the KEK. Thus, only the system software in ROM should have access to the KEK.</p>
<p id="p-0105" num="0104">Other secured values in the platform certificate <b>38</b> are encrypted using SW_KEY. Although not part of the certificate itself, the application file <b>32</b> or data file <b>34</b> may be optionally encrypted by SW_KEY responsive to a confidentiality request as shown in encryption step <b>254</b> and <b>256</b>. Whether or not the application file <b>32</b> or data file <b>34</b> is encrypted will also affect the software signature (SW_SIG) or signature certificate (SIG_CERT). The software file <b>32</b> or data file (optionally encrypted) is hashed in step <b>258</b> and encrypted by SW_KEY in step <b>260</b>. This value is stored as SW_SIG. The certificate fields are hashed in step <b>262</b> and encrypted by SW_KEY in step <b>264</b>. This value is store as SIG_CERT.</p>
<p id="p-0106" num="0105">The platform certificate associates an application or data file with the device <b>10</b> upon which it is loaded. Once associated, the application or data file cannot be transferred to another device, since the platform certificate will be invalid. Further, the APPLI_ID field can be used to associate an application file <b>32</b> or data file <b>34</b> with a particular program. This could be used, for example, to allow access to an audio or video file only in connection with a specific media player application, even if the format of the audio or video file was a standard format capable of being played by various applications.</p>
<p id="p-0107" num="0106"><figref idref="DRAWINGS">FIG. 11</figref> illustrates the unbinding of an application or data file from the platform certificate necessary to execute the application or use the data file within an application. In step <b>270</b>, SW_KEY is derived from the ENC_SW_KEY of the platform certificate <b>38</b> using the KEK from eFuse memory <b>14</b>. SW_KEY is used to decrypt the SIG_CERT field of platform certificate <b>38</b> in step <b>272</b> and to decrypt the SW_SIG field in step <b>274</b>.</p>
<p id="p-0108" num="0107">The fields of the platform certificate <b>38</b>, other then the SIG_CERT field are hashed in step <b>276</b>. The hash is compared to the decrypted SW_CERT field in step <b>278</b>. Similarly, the stored application or data file is hashed in step <b>280</b> and the hash is compared to the decrypted SW_SIG field from step <b>274</b> in step <b>282</b>. If either the comparison in step <b>278</b> or the comparison in step <b>300</b> indicates a mismatch, a system error occurs in step <b>302</b>. Otherwise, the application is executed (or the data file is used by an application) after optional decryption in steps <b>304</b> and <b>306</b>.</p>
<p id="p-0109" num="0108">The platform certificate provides significant advantages over the prior art. The binding of a software or data file to a device <b>10</b> helps to uncover any modification of the original software module and prevents any copy of the source from running on another similar platform, offering an efficient protection against cloning attacks, specifically important for copyright management and media protection.</p>
<p id="p-0110" num="0109">The solution offers a high level of security since it is based on strong cryptographic techniques, such as one-way hash and bulk encryption, for platform signature and verification. The solution can easily be adapted to any computing hardware platform. The use of the KEK and a software key randomly-generated at the time of binding allows for external storage of the encrypted key in external memory. An unlimited number of different software keys can be used for the application and data files. Further, the use of symmetric bulk encryption techniques for the calculation of the signatures significantly reduces processor computing loads relative to asymmetric techniques.</p>
<p id="p-0111" num="0110"><figref idref="DRAWINGS">FIG. 12</figref> describes a particular use of the manufacturer and/or platform certificate to securely store a IMEI (International Mobile Equipment Identity) number in external memory. The IMEI number is specified in the UMTS (Universal Mobile Telephone Service) standard, release <b>5</b>, to protect both the phone manufacturer and the operator against clones and obsolete or non-conforming user equipment. The IMEI number must be stored somewhere in the mobile phone and sent to the serving network on demand. The protection of the IMEI number against tampering by any means (hardware, software or physical) has significantly increased the required security level of mobile devices. To prevent tampering, many manufacturers have stored the IMEI number, which is unique for each phone, on the chip late in the production process. Storing the number on-chip in a manner which is tamper-proof, however, is an expensive proposition.</p>
<p id="p-0112" num="0111">As shown in <figref idref="DRAWINGS">FIG. 12</figref>, the IMEI can be stored in external memory in the manufacturer certificate (specifically, the PLATFORM_DATA field), which is customized for each phone, and/or in external memory bound to a platform certificate. The baseband processing system <b>12</b> can access the IMEI in external memory either from the manufacturer certificate <b>36</b> of the system boot firmware or from a memory location bound to a platform certificate <b>38</b>.</p>
<p id="p-0113" num="0112">If the IMEI number is changed in the PLATFORM_DATA field of the manufacturer certificate <b>36</b>, it will be detected by the secure reset boot checker prior to execution of the system boot software. If changed after the system boot software is loaded, a change in the IMEI number will be detected by the secure run-time platform data checker.</p>
<p id="p-0114" num="0113">If the IMEI is stored in external memory bound to a platform certificate, any change in the IMEI will be detected as an invalid SW_SIG. Using the platform certificate, the IMEI can be stored in any location in the external memory.</p>
<p id="p-0115" num="0114">The device <b>10</b> can be programmed to allow emergency calls even if the IMEI results in an invalid manufacturer certificate <b>36</b> or invalid platform certificate <b>38</b>.</p>
<p id="p-0116" num="0115"><figref idref="DRAWINGS">FIG. 13</figref> illustrates a block diagram for using fields in the manufacture certificate <b>36</b> to control the operation of the device <b>10</b>. As shown in <figref idref="DRAWINGS">FIG. 13</figref>, the DEBUG_REQ field of the manufacturer certificate <b>36</b> is used to control test access and emulation circuitry <b>320</b>. Parameters set forth in the CONF_PARAM field of the manufacturer certificate <b>36</b> can be used to control any aspect of the operation of device <b>10</b>, by configuring hardware or software appropriately, as shown in blocks <b>322</b> and <b>324</b>.</p>
<p id="p-0117" num="0116">In operation, the system boot software accesses the configuration parameters from the manufacturer's certificate to configure the hardware and software resources. Placing the configuration parameters in the manufacturer's certificate <b>36</b> allows the manufacturer to design a device that has flexible hardware and/or software configurations and safely and securely configure the device as appropriate.</p>
<p id="p-0118" num="0117">One use of securely storing configuration parameters in a manufacturer's certificate <b>36</b> would be to allow the device <b>10</b> to enter configurations in controlled situations, where the configuration would leave the device <b>10</b> vulnerable to attack. For example, during a test mode, the device <b>10</b> could be placed in a configuration where certain normally hidden memory locations would be accessible to reading and/or writing. Also, certain hardware parameters, such as memory performance settings, bus speeds, processing speeds, and so on, may be changed during a test mode for analyzing system operations.</p>
<p id="p-0119" num="0118">A second use of securing storing configuration parameters in a manufacturer's certificate would be to control the performance of a device <b>10</b>. As is well known in the computing industry, some users reconfigure hardware and/or software parameters to push a device to its limits. For example, many user's “overclock” a personal computers processor speed by changing the system clock speed or the multiple of the system clock at which the processor operates. Additionally, memory settings can be changed to improve memory access and throughput. While overclocking can improve the performance of a computing device, it can also reduce hardware lifetimes by operating hardware at temperatures beyond their specification. Further, computing devices may operate erratically at the overclocked settings. Overclocked settings can thus be costly to manufacturers in terms of warranty and support.</p>
<p id="p-0120" num="0119">By setting parameters in the manufacturer certificate <b>36</b>, attempts to change performance settings would be thwarted, since the settings are defined in the manufacture certificate <b>36</b>, which can only be changed under the authority of the manufacturer. System boot software would configure the device after a reset to the defined parameters. Any attempt to change the authorized settings in the certificate would be detected by the secure reset boot checker <b>52</b> (after a reset) or the secure run-time checker <b>202</b>. Any attempt to change the configuration parameters by software outside of the system firmware would be detected by the secure run-time platform data checker <b>200</b>.</p>
<p id="p-0121" num="0120">A third use of securing storing configuration parameters in a manufacturer's certificate would be to provide a single device that has different performance capabilities and/or different functionality settings. The device could be sold according to its configuration settings, which are stored in the manufacturer certificate <b>36</b>, such that the configurations could not be modified by the user or a third party. The device <b>10</b> could be easily upgraded by the manufacturer.</p>
<p id="p-0122" num="0121">For example, a mobile computing device platform could be designed to run at multiple processor speeds and have different optional functionalities, such as wireless networking, audio and video capabilities. The device could be sold at a desired configuration that could be upgraded at a later date without expensive hardware upgrades, such as PC cards or memory port enhancements.</p>
<p id="p-0123" num="0122"><figref idref="DRAWINGS">FIG. 14</figref> illustrates a variation on <figref idref="DRAWINGS">FIG. 13</figref> where configuration data is stored in a data file <b>34</b> protected by a platform certificate. Any attempt to change the data file <b>34</b> storing the configuration parameters would be detected by the system firmware. The secure run-time platform data checker <b>200</b> could be modified to check the contents of the data file during operation of the device.</p>
<p id="p-0124" num="0123"><figref idref="DRAWINGS">FIG. 15</figref> illustrates an alternative design for accessing the device <b>10</b> is a certain mode, such as a test mode shown in <figref idref="DRAWINGS">FIG. 15</figref>. This design stores the hash of an access code (H_Test_ID). This code could be stored the eFuse memory <b>24</b>. To access the test mode, the party would need to enter an access code (Input_Test_ID). Input_Test_ID is hashed in block <b>330</b> and compared to H_Test_ID in block <b>332</b>. If the hashed access code from block <b>330</b> matches the stored hashed access code, then entry to the mode is enabled.</p>
<p id="p-0125" num="0124">In operation, the H_Test_ID will normally be significantly smaller in size than Input_Test_ID, reducing the storage space needed to store the access code. To gain entry to the desired mode, however, a party will need to supply a much larger number. While it is possible multiple inputs may hash to match H_Test_ID, it is statistically improbable that an improper input access code will result in a match using present day hashing algorithms such as SHA-1 or ND5.</p>
<p id="p-0126" num="0125">Additionally, the design of <figref idref="DRAWINGS">FIG. 15</figref> provides an additional security benefit. Even if the stored hash, H_Test_ID, becomes known, determination of an input code which would hash to H_Test_ID would be computationally difficult.</p>
<p id="p-0127" num="0126">While the use of the hashed access code has been described in connection with test mode access, it could be used to provide security in any appropriate situation, such as access to change system parameters, as discussed above.</p>
<p id="p-0128" num="0127">Although the Detailed Description of the invention has been directed to certain exemplary embodiments, various modifications of these embodiments, as well as alternative embodiments, will be suggested to those skilled in the art. The invention encompasses any modifications or alternative embodiments that fall within the scope of the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A computing device comprising:
<claim-text>a processing system;</claim-text>
<claim-text>an externally-accessible memory coupled to the processing system;</claim-text>
<claim-text>a secret identification number generated for the computing device and stored in a secure memory that is not externally-accessible;</claim-text>
<claim-text>a key generator for generating a random key associated with a selected electronic file to be stored in the externally-accessible memory;</claim-text>
<claim-text>a symmetrical encryption system to generate an encrypted key by symmetrically encrypting the random key using the secret identification number;</claim-text>
<claim-text>wherein the processing system associates a digital certificate with an electronic file, where the digital certificate contains the encrypted key, such that the electronic file can be accessed only after the processing system restores the random key through decryption of the encrypted key with the secret identification number;</claim-text>
<claim-text>wherein the random key is used to sign the digital certificate, the electronic file is encrypted using the random key, the electronic file is accessed when the digital certificate is verified using the random key and the encrypted electronic file is decrypted using the random key; and</claim-text>
<claim-text>the externally-accessible memory further comprising an asymmetric manufacture certificate to bind firmware to the processing system.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The computing device of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein digital certificate contains a software signature; wherein the software signature comprises a hash of the electronic file that is symmetrically encrypted using the random key.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The computing device of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein the digital certificate further contains a signature for selected fields of the digital certificate, wherein the selected fields of the digital certificate are hashed and encrypted using the random key.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The computing device of <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the encrypted key is stored in the externally-accessible memory.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The computing device of <claim-ref idref="CLM-00001">claim 1</claim-ref>
<claim-text>wherein the encryption of the electronic file can be bypassed and the digital certificate allows modification detection and authentication of the electronic file.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The computing device of <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the random key directly encrypts the electronic file, without an additional level of encryption.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The computing device of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising
<claim-text>an internal permanent memory in the processing system;</claim-text>
<claim-text>the internal permanent memory for storing a first manufacturer's public key, wherein the first manufacturer's public key is optionally hashed and cannot be modified after writing into permanent memory;</claim-text>
<claim-text>the externally-accessible memory comprises the manufacturer certificate for asymmetric encryption and for prevention of firmware modification and copying; wherein the manufacturer certificate comprises a second manufacturer's public key; and</claim-text>
<claim-text>the processor for comparing the first and second manufacturer public keys and generating a pass or fail output to indicate a match.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The device of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein a hashed value of the second manufacturer's public key is stored in the manufacturer certificate.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A method of providing security to files stored in an externally-accessible memory of a computing device comprising the steps of:
<claim-text>storing a secret identification number for the computing device in a secure memory that is not externally-accessible;</claim-text>
<claim-text>generating a random key;</claim-text>
<claim-text>generating an encrypted key by symmetrically encrypting the random key using the secret identification number;</claim-text>
<claim-text>associating a digital certificate with an electronic file, where the digital certificate contains the encrypted key, such that the electronic file can be accessed only after restoring the random key through decryption of the encrypted key with the secret identification number;</claim-text>
<claim-text>using the random key to sign the digital certificate, and encrypting the electronic file using the random key, and wherein the electronic file is accessed when the digital certificate is verified using the random key and the encrypted electronic file is decrypted using the random key; and</claim-text>
<claim-text>binding firmware to the computing device by an asymmetric manufacture certificate in the externally-accessible memory.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> wherein the associating step includes the step of generating a software signature encrypted using the random key and storing the software signature in the digital certificate; wherein the software signature comprises a hash of the electronic file that is symmetrically encrypted using the random key.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00010">claim 10</claim-ref> wherein the associating step includes the step of generating a signature for selected fields of the digital certificate, wherein the selected fields of the digital certificate are coded and encrypted using the random key.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> and further comprising the step of storing the encrypted key in the externally-accessible memory.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> and further comprising the step of symmetrically decrypting the encrypted key using the secret identification number upon a request to access the electronic file.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The method of <claim-ref idref="CLM-00013">claim 13</claim-ref> and further comprising the step of decrypting one or more fields of the digital certificate using the encrypted key.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> and further comprising the step of decrypting an encrypted electronic file using the encrypted key.</claim-text>
</claim>
</claims>
</us-patent-grant>
