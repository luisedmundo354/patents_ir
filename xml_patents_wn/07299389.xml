<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299389-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299389</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10765895</doc-number>
<date>20040129</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2003-022235</doc-number>
<date>20030130</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>724</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>R</subclass>
<main-group>31</main-group>
<subgroup>28</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>01</class>
<subclass>R</subclass>
<main-group>31</main-group>
<subgroup>26</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>714724</main-classification>
<further-classification>324765</further-classification>
</classification-national>
<invention-title id="d0e71">Test circuit, integrated circuit, and test method</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5940414</doc-number>
<kind>A</kind>
<name>Takano et al.</name>
<date>19990800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714733</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6180426</doc-number>
<kind>B1</kind>
<name>Lin</name>
<date>20010100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>438 15</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6586266</doc-number>
<kind>B1</kind>
<name>Lin</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>438 15</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>2003/0199119</doc-number>
<kind>A1</kind>
<name>Lin</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>438107</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2005/0210347</doc-number>
<kind>A1</kind>
<name>Gossmann</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714724</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>JP</country>
<doc-number>10246755</doc-number>
<kind>A</kind>
<date>19980900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>JP</country>
<doc-number>A 2001-183424</doc-number>
<date>20010700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00008">
<othercit>U.S. Appl. No. 10/766,038, filed Jan. 29, 2004, Nishida et al.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>13</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>None</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>16</number-of-drawing-sheets>
<number-of-figures>24</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20040260992</doc-number>
<kind>A1</kind>
<date>20041223</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Nishida</last-name>
<first-name>Haruo</first-name>
<address>
<city>Sapporo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ishida</last-name>
<first-name>Takuya</first-name>
<address>
<city>Sapporo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Oliff &amp; Berridge, PLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Seiko Epson Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Britt</last-name>
<first-name>Cynthia</first-name>
<department>2117</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A test circuit comprises a selector SEL<b>1</b> having a first input to which signals M<b>1</b>OUT from a macro block MB<b>1</b> are input and a second input to which test input signals TIN<b>1</b> and TIN<b>2</b> for a macro block MB<b>2</b> are input, and a selector SEL<b>2</b> having a first input to which a signal SQ from the SEL<b>1</b> is input and a second input to which a signal M<b>2</b>OUT from the MB<b>2</b> is input. In a first test mode in which the MB<b>1</b> is tested, the SEL<b>1</b> outputs the signals M<b>1</b>OUT from the MB<b>1</b> to a first input of the SEL<b>2</b>, and the SEL<b>2</b> outputs the signal SQ from the SEL<b>1</b> to the MB<b>1</b>. In a second test mode in which the MB<b>2</b> is tested, the SEL<b>1</b> outputs the test input signals TIN<b>1</b> and TIN<b>2</b> for the MB<b>2</b> to the MB<b>2</b>, and the SEL<b>2</b> outputs the signals M<b>2</b>OUT from the MB<b>2</b> as a test output signal TOUT for the MB<b>2. </b></p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="82.04mm" wi="150.45mm" file="US07299389-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="171.70mm" wi="144.78mm" file="US07299389-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="119.89mm" wi="158.50mm" file="US07299389-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="217.85mm" wi="164.76mm" file="US07299389-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="103.46mm" wi="161.21mm" file="US07299389-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="235.46mm" wi="139.45mm" orientation="landscape" file="US07299389-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="180.09mm" wi="153.50mm" file="US07299389-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="212.43mm" wi="112.95mm" orientation="landscape" file="US07299389-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="231.06mm" wi="165.18mm" file="US07299389-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="245.62mm" wi="169.76mm" orientation="landscape" file="US07299389-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="182.96mm" wi="157.99mm" file="US07299389-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="219.29mm" wi="151.81mm" file="US07299389-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="218.61mm" wi="159.17mm" orientation="landscape" file="US07299389-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="232.66mm" wi="144.44mm" orientation="landscape" file="US07299389-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="226.48mm" wi="143.93mm" orientation="landscape" file="US07299389-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="231.22mm" wi="135.30mm" orientation="landscape" file="US07299389-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="223.60mm" wi="152.65mm" orientation="landscape" file="US07299389-20071120-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<p id="p-0002" num="0001">Japanese Patent Application No. 2003-22235, filed on Jan. 30, 2003, is hereby incorporated by reference in its entirety.</p>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">The present invention relates to a test circuit, an integrated circuit, and a test method.</p>
<p id="p-0004" num="0003">Recently, as integrated circuits have become larger, attempts to detect faults (such as wiring defects or element defects) in the entire circuit comprising such integrated circuits have run into problems in that the test pattern has become more complicated, and thus the development of such a test pattern is taking longer and is more expensive. A test method called a scan method is known as a means of solving this problem, as disclosed in Japanese Patent Application Laid-Open No. 2001-183424.</p>
<p id="p-0005" num="0004">With this scan method, after the logic design has been completed and a net list of the circuit has been created, scan flip-flops (scanner circuits) are inserted into the circuit (net list). More specifically, flip-flops (hereinafter abbreviated to FF) within the circuit are replaced by scan FFs. A net list of these scan FFs is then used to perform fault simulations and create (automatically generate) a text pattern. This test pattern is used to test trial products or mass-produced products.</p>
<p id="p-0006" num="0005">However, even when this scan method is used, it is becoming difficult to create the test pattern and improve the fault detection rate with large-scale integrated circuits. In particular, a method of integrated circuit design that has recently become popular is to form circuits with specific functions into blocks, then connect together macro blocks (macro cells) that are circuit blocks formed in this manner. For example, it is possible to design an integrated circuit (ASIC) for a specific purpose involving the USB 2.0 function, by connecting together a macro block that conforms to the USB 2.0 Transceiver Macrocell Interface (UTMI) specification, a circuit (serial interface engine) that controls that UTMI block, and a user-customized circuit. In such a case, it is comparatively simple to create a test pattern for each of these macro blocks, but a technical problem occurs in that it is not simple to create a test pattern for detecting faults (wiring defects) in the connecting portions between the macro blocks.</p>
<p id="p-0007" num="0006">A further technical problem is caused by the huge number of terminals (pins) involved with integrated circuits, making it necessary to reduce that number as far as possible. It is therefore preferable to minimize the number of test terminals as far as possible.</p>
<heading id="h-0002" level="1">BRIEF SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">According to one aspect of the present invention, there is provided a test circuit for an integrated circuit comprising a plurality of macro blocks, the test circuit comprising:</p>
<p id="p-0009" num="0008">a first selector having a first input to which an output signal from a first macro block is input and a second input to which a test input signal for a second macro block is input; and</p>
<p id="p-0010" num="0009">a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input,</p>
<p id="p-0011" num="0010">wherein during a first test mode for testing the first macro block, the first selector outputs to the first input of the second selector the output signal that has been input from the first macro block to the first input of the first selector, and the second selector outputs to the first macro block the output signal that has been input from the first selector to the first input of the second selector, and</p>
<p id="p-0012" num="0011">wherein during a second test mode for testing the second macro block, the first selector outputs to the second macro block the test input signal for the second macro block that has been input to the second input of the first selector, and the second selector outputs the output signal from the second macro block that has been input to the second input of the second selector, as a test output signal for the second macro block.</p>
<p id="p-0013" num="0012">According to another aspect of the present invention, there is provided a test method that uses a test circuit comprising a first selector having a first input to which an output signal from a first macro block is input and a second input to which a test input signal for a second macro block is input, and a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input,</p>
<p id="p-0014" num="0013">wherein during a first test mode for testing the first macro block, the output signal from the first macro block that has been input to the first input of the first selector is output to the first input of the second selector, and the output signal from the first selector that has been input to the first input of the second selector is output to the first macro block, and</p>
<p id="p-0015" num="0014">wherein during a second test mode for testing the second macro block, the test input signal for the second macro block that has been input to the second input of the first selector is output to the second macro block, and the output signal from the second macro block that has been input to the second input of the second selector is output as a test output signal for the second macro block.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE SEVERAL VIEWS OF THE DRAWING</heading>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIGS. 1A and 1B</figref> are illustrative of a method of testing an integrated circuit that comprises macro blocks;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref> shows an example of a configuration of a test circuit in accordance with an embodiment of the present application;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIGS. 3A and 3B</figref> are illustrative of an operation of the test circuit;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 4</figref> is illustrative of a method of setting the scan paths for a macro block and the test circuit;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIGS. 5A and 5B</figref> are illustrative of the scan method;</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart of a test method that utilizes the scan method;</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 7</figref> shows an example of a test circuit that comprises a dummy scan FF;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIGS. 8A</figref>, <b>8</b>B, and <b>8</b>C are illustrative of the dummy scan FF;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 9</figref> shows a detailed example of a test circuit in accordance with this embodiment;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 10</figref> shows an example of a buffer address map;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIGS. 11A to 11D</figref> are illustrative of the test buffer, test transmission buffer, and test reception buffer of this embodiment;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 12</figref> shows an example of a configuration of a communications sequencer;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 13</figref> is a waveform chart illustrating an operation of the test circuit and the communications sequencer;</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 14</figref> is a waveform chart further illustrating the operation of the test circuit and the communications sequencer;</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 15</figref> shows an example of the macro block MB<b>1</b>; and</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 16</figref> shows an example of the macro block MB<b>2</b>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE EMBODIMENT</heading>
<p id="p-0032" num="0031">One embodiment is described below. Note that the embodiment described below does not in any way limit the scope of the present invention defined by the claims laid out herein. In addition, the overall configuration of the embodiments below should not be taken as limiting the subject matter defined by the claims herein.</p>
<p id="h-0005" num="0000">1. Detection of Faults in Connecting Portions Between Macro Blocks</p>
<p id="p-0033" num="0032">An example of an integrated circuit formed by connecting together a plurality of macro blocks MB<b>1</b> and MB<b>2</b> (macro cells or circuit blocks) is shown in <figref idref="DRAWINGS">FIG. 1A</figref>. To detect faults in such an integrated circuit, it is possible to use a known scan method to set a scan path to MB<b>1</b>, for fault detection within the macro block MB<b>1</b> as shown by way of example in <figref idref="DRAWINGS">FIG. 1B</figref>. To detect faults within the macro block MB<b>2</b>, it is possible to input test input signals TIN from test input terminals (pins) TPI and output test output signals TOUT that are the results of those tests from test output terminals TPO, by way of example.</p>
<p id="p-0034" num="0033">However, the method shown in <figref idref="DRAWINGS">FIG. 1B</figref> has a technical problem in that it is difficult to detect faults in a connecting portion <b>10</b> (the wiring for I signals SC<b>12</b> and J signals SC<b>21</b>). In other words, it is difficult to create a test pattern that can achieve a fault detection rate of at least 90 percent in the connecting portion <b>10</b> (the signals SC<b>12</b> and SC<b>21</b>), even if the scan path to the macro block MB<b>1</b> is tested. For that reason, the development of a test pattern tends to be time-consuming and expensive.</p>
<p id="p-0035" num="0034">Since the method of <figref idref="DRAWINGS">FIG. 1B</figref> necessitates the provision of (I+J) test terminals TPI and TPO, the number of terminals increases, leading to an increase in the cost of the integrated circuit. In such a case, it is desirable to implement a test circuit that enables a simplification of fault detection in the connecting portion <b>10</b> between the macro blocks MB<b>1</b> and MB<b>2</b>.</p>
<p id="h-0006" num="0000">2. Test Circuit</p>
<p id="p-0036" num="0035">An example of the configuration of a test circuit TC in accordance with this embodiment, and an integrated circuit comprising the same, is shown in <figref idref="DRAWINGS">FIG. 2</figref>. Note that the test circuit TC and integrated circuit of this embodiment need not necessarily comprise all the structural components shown in <figref idref="DRAWINGS">FIG. 2</figref>; some of them could be omitted. In addition, the integrated circuit of this embodiment could also comprise three or more macro blocks.</p>
<p id="p-0037" num="0036">The macro blocks MB<b>1</b> and MB<b>2</b> shown in <figref idref="DRAWINGS">FIG. 2</figref> are circuit blocks having circuits that have one or more functions (such as a communications circuit, a circuit for controlling such a communications circuit, a circuit for interfacing with a bus, RAM, a CPU, a DSP, a liquid-crystal driver, a CCD controller, or a user-customized circuit).</p>
<p id="p-0038" num="0037">More specifically, MB<b>2</b> could be a macro block for communications which comprises physical-layer circuit for communications, by way of example; even more specifically, it could be a macro block that conforms to the UTMI specifications (a specific interface standard). MB<b>1</b> could be a macro block comprising a circuit (SIE) for controlling MB<b>2</b>, a buffer, an interface circuit, or a user-customized circuit, by way of example. In other words, MB<b>1</b> is a macro block configured by a logic circuit and MB<b>2</b> is a macro block that comprises an analog circuit such as a physical-layer circuit for communications.</p>
<p id="p-0039" num="0038">The test circuit TC comprises a selector SEL<b>1</b> (a first selector). In this case, SEL<b>1</b> has a first input to which output signals M<b>1</b>OUT from MB<b>1</b> (the first macro block) are input. The test input signal TIN for MB<b>2</b> (the second macro block) is input to a second input thereof. The selection operation of this SEL<b>1</b> is controlled by a select signal SS<b>1</b>.</p>
<p id="p-0040" num="0039">The test circuit TC also comprises a selector SEL<b>2</b> (a second selector). In this case, an output signal SQ from SEL<b>1</b> is input to a first input of SEL<b>2</b>. Output signals M<b>2</b>OUT from MB<b>2</b> are input to a second input thereof. The selection operation of this SEL<b>2</b> is controlled by a select signal SS<b>2</b>.</p>
<p id="p-0041" num="0040">In a first test mode for testing MB<b>1</b> (such as a scan mode), the selector SEL<b>1</b> selects a number of the output signals M<b>1</b>OUT (such as I signals) from MB<b>1</b> that are input to the first input thereof, and outputs the resultant output signal SQ to the first input of SEL<b>2</b>, as shown in <figref idref="DRAWINGS">FIG. 3A</figref>. The SEL<b>2</b> outputs the output signal SQ from the selector SEL<b>1</b>, which is input to the first input thereof, to MB<b>1</b> as a number of input signals M<b>1</b>IN (such as J signals). In this first mode, a test pattern signal (logic test pattern) is input from a terminal DTIN (such as a data input terminal or scan-in terminal SCIN), as shown in <figref idref="DRAWINGS">FIG. 3A</figref>. The test is done by comparing the result that is output from a terminal DTOUT (such as a data output terminal or a scan-out terminal SCOUT) with an expected value.</p>
<p id="p-0042" num="0041">As shown in <figref idref="DRAWINGS">FIG. 3B</figref>, in a second test mode for testing MB<b>2</b>, on the other hand, SEL<b>1</b> takes a number of the test input signals TIN (such as I signals) for MB<b>2</b>, which are input to the second input thereof, and outputs them to MB<b>2</b> as a number of input signals M<b>2</b>IN (such as I signals). In addition, SEL<b>2</b> takes a number of the output signals M<b>2</b>OUT (such as J signals) from MB<b>2</b>, which are input to the second input thereof, and outputs them as test output signals TOUT for MB<b>2</b>. In this second test mode, test input signals (a logic test pattern and a transmission data signal) are input from terminals TPI. Test output signals (the results of the logic test pattern and a reception data signal) that are output from terminals TPO are compared with expected values and are inspected.</p>
<p id="p-0043" num="0042">Note that in an ordinary operating mode that is not the first and second test modes (a mode in which the integrated circuit operates in a normal manner), the output signals M<b>1</b>OUT from the macro block MB<b>1</b> are input through the selector SEL<b>1</b> to the macro block MB<b>2</b> as the input signals M<b>2</b>IN to the macro block MB<b>2</b>. The output signals M<b>2</b>OUT from the macro block MB<b>2</b> are input through the selector SEL<b>2</b> to the macro block MB<b>1</b> as the input signals M<b>1</b>IN to the macro block MB<b>1</b>.</p>
<p id="p-0044" num="0043">The test input signals TIN could be signals that are input through a buffer or the like to test input terminals TPI, or they could be signals that are output from a circuit that is not shown in the figure (such as the communications sequencer that will be described later). Similarly, the test output signals TOUT could be output through a buffer or the like to the test output terminals TPO, or they could be output to a circuit that is not shown in the figure (such as the communications sequencer).</p>
<p id="p-0045" num="0044">The test circuit TC of this embodiment shown in <figref idref="DRAWINGS">FIG. 2</figref> makes it possible to detect faults (wiring defects) in a connecting portion <b>12</b> between the macro block MB<b>1</b> and the test circuit TC, using the first test mode shown in <figref idref="DRAWINGS">FIG. 3A</figref>. It is also possible to detect faults in a connecting portion <b>14</b> between the test circuit TC and the macro block MB<b>2</b> in the second test mode shown in <figref idref="DRAWINGS">FIG. 3B</figref>. As a result, this makes it possible to detect faults in the connecting portion <b>10</b> between the macro blocks MB<b>1</b> and MB<b>2</b> of <figref idref="DRAWINGS">FIG. 1</figref>.</p>
<p id="p-0046" num="0045">Moreover, the test pattern for detecting faults in the connecting portion <b>12</b> by the first test mode of <figref idref="DRAWINGS">FIG. 3A</figref> can be creates in a comparatively simple manner (automatic generation). It is also simple to detect faults in the connecting portion <b>14</b> by the second test mode of <figref idref="DRAWINGS">FIG. 3B</figref>. In addition, the use of the test input signals TIN and the test output signals TOUT makes it possible to simplify these tests, even when the macro block MB<b>2</b> comprises analog circuits such as a physical-layer circuit for communications. This embodiment therefore makes it, possible to shorten the test pattern development period and reduce the cost thereof, and also increase the fault detection ratio and thus improve the reliability of the integrated circuit.</p>
<p id="h-0007" num="0000">3. Scan Method</p>
<p id="p-0047" num="0046">It is desirable that the first test mode of <figref idref="DRAWINGS">FIG. 3A</figref> is a scan mode in which testing is done by a scan method. As shown by way of example in <figref idref="DRAWINGS">FIG. 4</figref>, a scan path is set up, not only for the macro block MB<b>1</b> but also for the test circuit TC. In other words, not only flip-flops within the macro block MB<b>1</b> but also flip-flops within the test circuit TC are replaced by scan FFs (scan circuits), and a scan path (a scan chain) linking those scan FFs is created. In other words, the macro block MB<b>1</b> and the test circuit TC are viewed as a single macro block MB<b>12</b> and a known scan tester tool is used to insert scan FFs into the net list for MB<b>12</b> (setting a scan path).</p>
<p id="p-0048" num="0047">A circuit comprising flip-flops FF<b>1</b>, FF<b>2</b>, and FF<b>3</b> and conbination logic circuits CM<b>1</b> and CM<b>2</b> is shown by way of example in <figref idref="DRAWINGS">FIG. 5A</figref>. When this circuit is tested by the scan method, the flip-flops FF<b>1</b>, FF<b>2</b>, and FF<b>3</b> are replaced by scan flip-flops SFF<b>1</b>, SFF<b>2</b>, and SFF<b>3</b> that have selectors SL<b>1</b>, SL<b>2</b>, and SL<b>3</b>, as shown in <figref idref="DRAWINGS">FIG. 5B</figref>. Scan paths SCP<b>1</b> and SCP<b>2</b> are provided to bypass the ordinary paths through the conbination logic circuits CM<b>1</b> and CM<b>2</b>.</p>
<p id="p-0049" num="0048">First of all, a scan enable signal SCEN is set to a first level (such as high level) and a scan path side (the SCIN side) is selected in the selectors SL<b>1</b>, SL<b>2</b>, and SL<b>3</b>. A test pattern signal is input sequentially in series from the scan-in terminal SCIN to set a test pattern signal with respect to the flip-flops FF<b>1</b>, FF<b>2</b>, and FF<b>3</b>.</p>
<p id="p-0050" num="0049">The scan enable signal SCEN is then set to a second level (such as low level) and an ordinary path side is selected in the selectors SL<b>1</b>, SL<b>2</b>, and SL<b>3</b>. A clock signal CK is made active for one clock pulse, by way of example, and output signals from the flip-flops FF<b>1</b> and FF<b>2</b> are input to the combined circuits CM<b>1</b> and CM<b>2</b> and also output signals from CM<b>1</b> and CM<b>2</b> are held in FF<b>2</b> and FF<b>3</b>.</p>
<p id="p-0051" num="0050">The scan enable signal SCEN is then set to the first level, to select the scan path side (SCIN side) in the selectors SL<b>1</b>, SL<b>2</b>, and SL<b>3</b>. A test result signal that is held in the flip-flops FF<b>1</b>, FF<b>2</b>, and FF<b>3</b> is output serially from the scan-out terminal SCOUT through the scan paths SCP<b>1</b> and SCP<b>2</b>, for comparison with an expected value. This makes it possible to test for element defects in the flip-flops FF<b>1</b>, FF<b>2</b>, and FF<b>3</b> and conbination logic circuits CM<b>1</b> and CM<b>2</b>, as well as wiring defects in the circuit therebetween.</p>
<p id="p-0052" num="0051">A flowchart of a test method using the scan method is shown in <figref idref="DRAWINGS">FIG. 6</figref>. First of all, the circuit is designed and a net list of the designed circuit is created (steps S<b>1</b> and S<b>2</b>). A known scan tester tool is then used to insert scan FFs into the designed circuit and a net list comprising the scan FFs is created (steps S<b>3</b> and S<b>4</b>). A logic simulation is performed, using the net list that comprises the scan FFs, and a test pattern is created (automatic generation) (steps S<b>5</b> and S<b>6</b>). The circuit is subsequently laid out and mask data is generated (steps S<b>7</b> and S<b>8</b>). The test pattern created (automatically generated) in step S<b>6</b> is used for testing trial products or mass-produced products (step S<b>9</b>).</p>
<p id="p-0053" num="0052">Use of the above-described scan method increases the size of the macro block slightly, but it enables a simplification of the generation of test patterns and an increase in the fault detection rate, because it makes it possible to cut out the conbination logic circuits between the scan FFs and thus perform partial testing.</p>
<p id="p-0054" num="0053">With this embodiment, the macro block MB<b>1</b> and the test circuit TC are viewed as a single macro block MB<b>12</b>, as shown in <figref idref="DRAWINGS">FIG. 4</figref>, and a scan path from the scan-in terminal SCIN to the scan-out terminal SCOUT is set for the macro block MB<b>1</b> and the test circuit TC (a scan FF is inserted). It therefore becomes simple to create a test pattern that enables the detection of faults (wiring defects) in the connecting portion <b>12</b> between the macro block MB<b>1</b> and the test circuit TC, at a high fault detection rate. This makes it possible to reduce the test pattern development period, at a lower cost.</p>
<p id="h-0008" num="0000">4. Dummy Scan Flip-Flops</p>
<p id="p-0055" num="0054">With this embodiment, one or a plurality of dummy scan flip-flops DSFF could be comprised within the test circuit TC, as shown in <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0056" num="0055">As shown by way of example in <figref idref="DRAWINGS">FIG. 7</figref>, the number of output signals M<b>1</b>OUT from the macro block MB<b>1</b> is I and the number of input signals from the test circuit TC to MB<b>1</b> is J (where I&gt;J, and I and J are each a natural number or an integer greater than or equal to two). In other words, the number of output signals M<b>1</b>OUT is greater than the number of input signals M<b>1</b>IN. To implement the method of <figref idref="DRAWINGS">FIG. 4</figref> of setting an integrated scan path for the test circuit TC and the macro block MB<b>1</b> when there is a difference in the numbers of signals in this manner, one or a plurality of dummy scan flip-flops DSFF is comprised within the test circuit TC as shown in <figref idref="DRAWINGS">FIG. 7</figref>.</p>
<p id="p-0057" num="0056">More specifically, (I−J) dummy scan flip-flops DSFF are provided in the test circuit TC to hold (I−J) output signals (the Jth to Ith output signals) of the I output signals (first to Ith output signals). In the scan mode described with reference to frequency (the first test mode), the configuration is such that the dummy scan flip-flops DSFF output the held output signals through the scan path (the path from the scan-in terminal, through the scan flip-flops, to the scan-out terminal). In other words, the DSFFs hold signals that have been input from the scan flip-flops of the previous stage, then output the held signals to the scan flip-flops in the subsequent stage.</p>
<p id="p-0058" num="0057">For example, the three (generally speaking: (I−J)) dummy flip-flops DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b> shown in <figref idref="DRAWINGS">FIG. 8A</figref> are comprised within the net list created at step S<b>2</b> in <figref idref="DRAWINGS">FIG. 6</figref>. (I−J) output signals DIN<b>1</b>, DIN<b>2</b>, and DIN<b>3</b> (the Jth to Ith output signals) of the I output signals from the selector SEL<b>1</b> are connected to data terminals D of DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b>.</p>
<p id="p-0059" num="0058">The scan method described at steps S<b>4</b> and S<b>5</b> of <figref idref="DRAWINGS">FIG. 6</figref> replaces DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b> in the net list with the dummy scan flip-flops DSFF<b>1</b>, DSFF<b>2</b>, and DSFF<b>3</b> of <figref idref="DRAWINGS">FIG. 8B</figref> (dummy flip-flops that are meaningless in the ordinary operating mode and are disabled therein).</p>
<p id="p-0060" num="0059">During the scan mode, the DIN side is selected for SL<b>1</b>, SL<b>2</b>, and SL<b>3</b>, and signal DIN<b>1</b>, DIN<b>2</b>, and DIN<b>3</b> (the (I−J) output signals of the scan flip-flops of the selector SEL<b>1</b> or the stage after SEL<b>1</b>) are held in DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b>. Subsequently, the SCIN side is selected for SL<b>1</b>, SL<b>2</b>, and SL<b>3</b>, and the signals DIN<b>1</b>, DIN<b>2</b>, and DIN<b>3</b> held in DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b> (DSFF<b>1</b> to DSFF<b>3</b>) are output serially from SCIN, through the scan path to SCOUT.</p>
<p id="p-0061" num="0060">The situation of the scan path that is set for the macro block MB<b>1</b> and the test circuit TC is shown schematically in <figref idref="DRAWINGS">FIG. 8C</figref>. As shown by way of example in <figref idref="DRAWINGS">FIG. 8C</figref>, since there are two (I) output signals M<b>1</b>OUT-<b>1</b> and M<b>1</b>OUT-<b>2</b> from MB<b>1</b> to TC and one input signal from TC to MB<b>1</b>, one (I−J) dummy scan flip-flop DSFF<b>1</b> is provided.</p>
<p id="p-0062" num="0061">The output signal M<b>1</b>OUT-<b>1</b> from a flip-flop FF<b>6</b> within MB<b>1</b> is input to the first input of SEL<b>1</b>-<b>1</b> (a first selector) and a test input signal TIN-<b>1</b> from a test input terminal TPI-<b>1</b> is input to the second input thereof. An output signal SQ-<b>1</b> of SEL<b>1</b>-<b>1</b> is input to the dummy scan flip-flop DSFF<b>1</b> provided within TC.</p>
<p id="p-0063" num="0062">Similarly, the output signal M<b>1</b>OUT-<b>2</b> from a flip-flop FF<b>5</b> within MB<b>1</b> is input to the first input of SEL<b>1</b>-<b>2</b> (another first selector) and a test input signal TIN-<b>2</b> from a test input terminal TPI-<b>2</b> is input to the second input thereof. An output signal SQ-<b>2</b> of SEL<b>1</b>-<b>2</b> is input to the data terminal of the flip-flop FF<b>2</b> provided within TC.</p>
<p id="p-0064" num="0063">The output signal SQ-<b>2</b> from SEL<b>1</b>-<b>2</b> is also input to the first input of SEL<b>2</b> (the second selector) and the output signal M<b>2</b>OUT from MB<b>2</b> is input to the second input thereof. The-output signal TOUT from SEL<b>2</b> is output to the test output terminal TPO, or to a flip-flop FF<b>4</b> within MB<b>1</b>.</p>
<p id="p-0065" num="0064">In the scan mode, the signals (values) held in DSFF<b>1</b>, FF<b>2</b>, FF<b>3</b>, FF<b>4</b>, FF<b>5</b>, and FF<b>6</b> through the scan path from SCIN to SCOUT are output in series from SCOUT, enabling the implementation of testing by this scan method.</p>
<p id="p-0066" num="0065">The above-described configuration makes it possible to detect wiring defects in the remaining (I−J) signals M<b>2</b>OUT by the scan method described with reference to <figref idref="DRAWINGS">FIG. 4</figref>, even when the number I of signals M<b>1</b>OUT is greater than the number J of signals M<b>1</b>IN, as shown in <figref idref="DRAWINGS">FIG. 7</figref>. In other words, these (I−J) signals can be output along the scan path from SCIN, through MB<b>1</b> and TC, to SCOUT when in scan mode. As a result, it is possible to detect faults more reliably.</p>
<p id="p-0067" num="0066">Note that the dummy flip-flops DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b> before the substitution for scan flip-flops have nothing connected to Q terminals thereof in <figref idref="DRAWINGS">FIG. 8A</figref>. There is a possibility that these flip-flops DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b> with nothing connected to the Q terminals could be perceived as disabled flip-flops and deleted, depending on the specifications of the net list creation tool. To prevent such a situation, therefore, the Q terminals of DFF<b>1</b>, DFF<b>2</b>, and DFF<b>3</b> could be connected to nodes that have no adverse effect on ordinary operation (such as nodes of the test buffer that will be described later).</p>
<p id="h-0009" num="0000">5. Detailed Example</p>
<p id="h-0010" num="0000">5.1 Overall Configuration</p>
<p id="p-0068" num="0067">A detailed example of the configuration of the test circuit TC is shown in <figref idref="DRAWINGS">FIG. 9</figref>. Note that the test circuit of this embodiment need nor necessarily comprise all of the structural components shown in <figref idref="DRAWINGS">FIG. 9</figref>; some of them could be omitted.</p>
<p id="p-0069" num="0068">In <figref idref="DRAWINGS">FIG. 9</figref>, TPI denotes a test input terminal and TPO denotes a test output terminal. Similarly, TPCK denotes a test clock terminal and TPRS denotes a reset terminal. TPAD, TPWR, and TPRD denote an address terminal, a write terminal, and a read terminal for the buffer (register). TPMD<b>1</b> and TPMD<b>2</b> denote test mode terminals. PDP and PDM denote terminals for differential signals DP and DM (data positive and data negative) as defined under USB.</p>
<p id="p-0070" num="0069">MB<b>2</b> in <figref idref="DRAWINGS">FIG. 9</figref> denotes a macro block that comprises a physical-layer circuit PHY for data communications. This MB<b>2</b> is a macro block such as one that conforms to the UTMI specifications (generally speaking: communications macro block specifications). Note that this macro block MB<b>2</b> also has functions for receiving a transmission data signal that has be transmitted over USB by using DP and DM, as a received data signal in loopback mode.</p>
<p id="p-0071" num="0070">The test circuit TC comprises a communications sequencer CSQ. This communications sequencer CSQ is a sequencer for performing signal transmission and reception processing (handshake processing) by a predetermined communications protocol (a communications protocol conforming to the communications macro block specification) to and from the macro block MB<b>2</b>. A transmission data signal from this communications sequencer CSQ (a transmission buffer TXB for testing) is input to the selector SEL<b>1</b> as a test input signal TIN<b>1</b> for MB<b>2</b>. A test output signal TOUT<b>1</b> (TOUT) from the selector SEL<b>2</b> is input to the communications sequencer CSQ (a test reception buffer RXB) as a reception data signal.</p>
<p id="p-0072" num="0071">More specifically, the communications sequencer CSQ performs processing for transmitting a transmission data signal for the macro block MB<b>2</b> through the selector SEL<b>1</b> to MB<b>2</b>, in the second test mode that was described with reference to <figref idref="DRAWINGS">FIG. 3B</figref>. It also performs processing for receiving a reception data signal from MB<b>2</b> through SEL<b>2</b>.</p>
<p id="p-0073" num="0072">The communications sequencer CSQ comprises the test transmission buffer TXB and the test reception buffer RXB. TXB is a buffer (register) that stores the transmission data signal (TIN<b>1</b>) for MB<b>2</b>. RXB is a buffer. (register) that stores a reception data signal (TOUT<b>1</b>) from MB<b>2</b>. In other words, TXB stores a signal TI that has been input from the test input terminals TPI, as a transmission data signal. RXB stores a reception data signal from MB<b>2</b> and outputs the stored reception data signal as a signal TO from the test output terminals TPO.</p>
<p id="p-0074" num="0073">More specifically, the test transmission buffer TXB stores the transmission data signal TI that has been input from the test input terminals TPI. After the accumulation of the transmission data signal TI by TXB is complete (after a predetermined number of bytes of the transmission data signal have been stored), the communications sequencer CSQ performs processing to transmit the stored transmission data signal through the selector SEL<b>1</b> to the macro block MB<b>2</b>. The communications sequencer CSQ also performs processing to receive the reception data signal TOUT<b>1</b> from MB<b>2</b>, which has been set to loopback mode. The test reception buffer RXB stores the received reception data signal TOUT<b>1</b> and outputs the stored reception data signal to the test output terminals TPO.</p>
<p id="p-0075" num="0074">Note that the configuration could be such that only one of the transmission buffer TXB and the reception buffer RXB is provided in the test circuit TC. TXB and RXB could be provided within the communications sequencer CSQ or they could be provided externally.</p>
<p id="p-0076" num="0075">The test circuit TC comprises a test buffer TSB. This TSB is a buffer (register) that stores a test input signal and a test output signal. More specifically, TSB stores the signal TI from the test input terminals TPI and outputs it as a test input signal TIN<b>2</b> to the selector SEL<b>1</b>. TSB also stores a test output signal TOUT<b>2</b> from the selector SEL<b>2</b> and outputs it as the signal TO from the test output terminals TPO.</p>
<p id="p-0077" num="0076">The test circuit TC also comprises a decoder DEC. This DEC outputs control signals to the various circuits of the test circuit, based on signals from the test terminals of the integrated circuit. More specifically, an address signal TAD for specifying addresses (register addresses) in the buffers TXB, RXB, and TSB and a write signal TWR and a read signal TRD for those buffers are input to the decoder DEC. In addition, test mode signals TMD<b>1</b> and TMD<b>2</b> (signals for switching between the first and second test modes and for switching between the test modes and the ordinary operating mode), a test clock signal TCK, and a test reset signal TRS are input thereto. The decoder DEC performs decoding processing based on these signals that are input from the test terminals, and generates control signals DCTL<b>1</b> and DCTL<b>2</b> for the communications sequencer CSQ (TXB, RXB) and the test buffer TSB and the select signals SS<b>1</b> and SS<b>2</b> for the selectors SEL<b>1</b> and SEL<b>2</b>.</p>
<p id="p-0078" num="0077">The communications sequencer CSQ (TXB, RXB) performs processing for storing the transmission data signal and the reception data signal in TXB and RXB and outputting the transmission data signal and the reception data signal from TXB and RXB, based on the control signal DCTL<b>1</b> from the decoder DEC and the test clock signal TCK. The test buffer TSB performs processing for storing the test input signal and the test output signal in the TSB and outputting the test input signal and the test output signal from the TSB, based on the control signal DCTL<b>2</b> from the decoder DEC and the test clock signal TCK.</p>
<p id="p-0079" num="0078">When both of the signals TMD<b>1</b> and TMD<b>2</b> are at low level (a first level), the decoder DEC sets the select signal SS<b>1</b> to high to cause the selection of the signals M<b>2</b>OUT to the selector SEL<b>1</b> or set the signal SS<b>1</b> to low to cause the selection of M<b>2</b>OUT to the selector SEL<b>2</b>. This turns the operating mode into an ordinary operating mode (a mode that is not a test mode).</p>
<p id="p-0080" num="0079">When the signal TMD<b>1</b> is at high (a second level), both the signals SS<b>1</b> and SS<b>2</b> are set to high to cause the selection of the signals M<b>1</b>OUT to SEL<b>1</b> and the selection of the signal SQ to SEL<b>2</b>. This turns the operating mode to the first test mode for testing the macro block MB<b>1</b>.</p>
<p id="p-0081" num="0080">When the signal TMD<b>2</b> is at high, both the signals SS<b>1</b> and SS<b>2</b> are set to low to cause the selection of the signals TIN<b>1</b> and TIN<b>2</b> to SEL<b>1</b> and also the signals M<b>2</b>OUT to SEL<b>2</b>. This turns the operating mode to the second test mode for testing the macro block MB<b>2</b>.</p>
<p id="h-0011" num="0000">5.2 Buffer Configuration</p>
<p id="p-0082" num="0081">An address map of the test transmission buffer TXB, the test reception buffer RXB, and the test buffer TSB is shown in <figref idref="DRAWINGS">FIG. 10</figref>.</p>
<p id="p-0083" num="0082">In this embodiment, each of the transmission buffer TXB and the reception buffer RXB has a four-stage (generally speaking: a plurality of stages) buffer configuration (FIFO configuration). In other words, TxBuf<b>0</b>, TxBuf<b>1</b>, TxBuf<b>2</b>, and TxBuf<b>3</b> in <figref idref="DRAWINGS">FIG. 10</figref> correspond to the four stages of the transmission buffer TXB, and RxBuf<b>0</b>, RxBuf<b>1</b>, RxBuf<b>2</b>, and RxBuf<b>3</b> correspond to the four stages of the reception buffer RXB. Each buffer in these four stages has an 8-bit configuration. In other words, TxBuf<b>0</b>[<b>7</b>] to TxBuf<b>0</b>[<b>0</b>] in <figref idref="DRAWINGS">FIG. 10</figref> represent the bits of TxBuf<b>0</b>. The other buffers TxBuf<b>1</b>, TxBuf<b>2</b>, and TxBuf<b>3</b> are similar. In addition, RxBuf<b>0</b>[<b>7</b>] to RxBuf<b>0</b>[<b>0</b>] represent the bits of RxBuf<b>0</b>. The other buffers RxBuf<b>1</b>, RxBuf<b>2</b>, RxBuf<b>3</b> are similar.</p>
<p id="p-0084" num="0083">In the embodiment shown in <figref idref="DRAWINGS">FIG. 10</figref>, if the addresses specified by the signal TAD from the terminal TPAD are in the range of 0×0 to 0×7 (hexadecimal notation), addresses in one or other of the transmission buffer TXB and the reception buffer RXB are specified. When the write signal TWR from the terminal TPWR becomes active, the transmission buffer TXB is specified, whereas when the read signal TRD from the terminal TPRD becomes active, the reception buffer RXB is specified.</p>
<p id="p-0085" num="0084">When the addresses specified by the signal TAD are in the range of 0×8 to 0×F, on the other hand, addresses in the test buffer TSB are specified. The specification of read or write is done by the read signal TRD or the write signal TWR. Functions such as TXMODE, XCVRSELECT, TERMSELECT, . . . TXSTART are allocated to the bits of the test buffer TSB, as shown in <figref idref="DRAWINGS">FIG. 10</figref>.</p>
<p id="p-0086" num="0085">For example, TXMODE is a bit that sets the transmission mode of the communications sequencer CSQ. If TXMODE is set to 0, the communications sequencer CSQ transmits four bytes (generally speaking: a plurality of bytes) of transmission data and stops. If TXMODE is set to 1, on the other hand, CSQ continues to transmit single bytes of transmission data that has been stored in TxBuf<b>0</b>.</p>
<p id="p-0087" num="0086">In addition, bits such as XCVRSELECT, TERMSELECT, OPMODE<b>1</b>, . . . SUSPEND are bits for setting the input terminals (M<b>2</b>IN) of the macro block MB<b>2</b> to a desired signal level (high level or low level). Bits such as MonRXACTIVE, MonRXERROR, MonLINESTATE<b>1</b>, and MonLINESTATEO are bits for monitoring the signal level of the output terminals (M<b>2</b>OUT) of the macro block MB<b>2</b>.</p>
<p id="p-0088" num="0087">TXSTART is a bit that instructs the start of transmission (transmission for testing) with respect to the communications sequencer CSQ, such that setting TXSTART to 1 starts the transmission. When the transmission is complete, TXSTART is cleared to 0. When TXMODE is 1, 0 is written to TXSTART to stop the transmission.</p>
<p id="p-0089" num="0088">In an integrated circuit, an increase in the number of terminals leads to an increase in the fabrication cost. For that reason, it is desirable to reduce the number of test terminals to as few as possible. With this embodiment, the numbers of the test terminals TPI and TPO of <figref idref="DRAWINGS">FIG. 9</figref> are reduced by the method described below.</p>
<p id="p-0090" num="0089">Assume that the input signal necessary for testing the macro block MB<b>2</b> has M bits, by way of example. In such a case, the test buffer TSB of this embodiment receives these M bits of the test input signal by receiving K bits of the test input signal at a time (where M&gt;K, and M and K are each a natural number or an integer greater than or equal to two) from a number K of the test input terminals TPI, as shown in <figref idref="DRAWINGS">FIGS. 11A and 11B</figref>. The stored signal is output to the selector SEL<b>1</b> as the test input signal TIN<b>2</b>. This makes it possible to reduce the number of the test input terminals TPI to K terminals, although M terminals were necessary originally.</p>
<p id="p-0091" num="0090">If all of the bits XCVRSELECT to SUSPEND of <figref idref="DRAWINGS">FIG. 10</figref> were set to external terminals as TPI, by way of example, 12 (M) terminals would be necessary. In contrast thereto, the test buffer TSB takes in and stores the 12 bits (M bits) of the test input signals (XCVRSELECT to SUSPEND) by taking in 4 bits (K bits) of the test input signals at a time from TPI, as shown in <figref idref="DRAWINGS">FIGS. 11A and 11B</figref>. This means that the number of TPI terminals can be set to four, enabling a reduction in the number of terminals of the integrated circuit.</p>
<p id="p-0092" num="0091">Assume that the number of bits of the transmission data signal and the reception data signal is N. In such a case, the test transmission buffer TXB of this embodiment receives and stores these N bits of the transmission data signal (test input signal) by receiving K bits of the transmission data signal at a time from K test input terminals TPI (where N&gt;K, and N and K are each a natural number or an integer greater than or equal to two), as shown in <figref idref="DRAWINGS">FIGS. 11C and 11D</figref>. The stored signal is output to the selector SEL<b>1</b> as the test input signal TIN<b>1</b>. This makes it possible to reduce the number of the test input terminals TPI to K terminals, from the N terminals that were necessary originally. Similarly, the test reception buffer RXB stores N bits of the reception data signal (the test output signal) from the macro block MB<b>2</b> and outputs the stored reception data signal by outputting K bits of the reception data signal at a time to K test output terminals TPO, as shown in <figref idref="DRAWINGS">FIGS. 11C and 11D</figref>. This means that the number of TPO terminals can be reduced to K, although N terminals were necessary originally.</p>
<p id="p-0093" num="0092">If all of the bits TxBuf<b>0</b>[<b>7</b>] to TxBuf<b>0</b>[<b>0</b>] of <figref idref="DRAWINGS">FIG. 10</figref> were set to external terminals as TPI and all of the bits RxBuf<b>0</b>[<b>7</b>] to RxBuf<b>0</b>[<b>0</b>] were set to external terminals as TPO, the numbers of each of TPI and TPO would be eight (N terminals), making it necessary to have a total of 16 terminals. In contrast thereto, <figref idref="DRAWINGS">FIGS. 11C and 11D</figref> show that the transmission buffer TXB receives and stores the 8-bit (N-bit) transmission data signal by receiving four bits (K bits) of the transmission data signal at a time from TPI. Similarly, the reception buffer RXB outputs the 8-bit reception data signal by outputting four bits of the reception data signal at a time to TPO. This makes it possible to set the numbers of TPI and TPO terminals to four (K terminals) each, enabling a reduction in the number of terminals of the integrated circuit.</p>
<p id="p-0094" num="0093">In addition, the four (K) terminals TPI and TPO are connected in common to the buffers TXB, RXB, and TSB, as shown in <figref idref="DRAWINGS">FIGS. 9 and 10</figref>, and the address signal TAD is used to specify the address of each bit in the buffers TXB, RXB, and TSB. This enables a further decrease in the number of terminals of the integrated circuit.</p>
<p id="h-0012" num="0000">5.3 Communication Sequencer</p>
<p id="p-0095" num="0094">An example of the configuration of the communications sequencer CSQ is shown in <figref idref="DRAWINGS">FIG. 12</figref>. It should be noted, however, that the configuration of the communications sequencer CSQ is not limited to that shown in <figref idref="DRAWINGS">FIG. 12</figref>.</p>
<p id="p-0096" num="0095">The communications sequencer CSQ comprises a transmission sequencer TSQ. This TSQ is a sequencer for implementing transmission processing with the macro block MB<b>2</b> by handshake. More specifically, the transmission sequencer TSQ outputs a signal TXVALID (transmission start signal), which indicates that a transmission data signal DATAIN is valid, to the macro block MB<b>2</b>. MB<b>2</b> views DATAIN during the period in which TXVALID is active as one packet. This signal TXVALID is output as the signal TIN<b>1</b> through SEL<b>1</b> to MB<b>2</b>, as shown in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0097" num="0096">The transmission sequencer TSQ receives a signal TXREADY, which indicates that the buffering of DATAIN is complete, from MB<b>2</b>. This signal TXREADY is input from MB<b>2</b> through SEL<b>2</b> to the transmission sequencer TSQ as the signal TOUT<b>1</b>, as shown in <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0098" num="0097">The transmission sequencer TSQ uses a control signal TCTL (such as a transmission start signal) to control the transmission buffer TXB. More specifically, it controls the accumulation of the signal TI from the test input terminals TPI by the transmission buffer TXB. It also controls the output of the signal DATAIN to the macro block MB<b>2</b> by the transmission buffer TXB. In this case, the signal TI is stored in the transmission buffer TXB of this embodiment at a clock frequency CF<b>2</b> that is lower than a clock frequency CF<b>1</b> (such as 60 MHz), during the output of the signal DATAIN. This makes it possible to use the lower clock frequency CF<b>2</b> for the accumulation of the signal TI, to maintain some leeway. It is therefore possible to obtain stable test results with few variations, even when there are large parasitic capacitances in the test input terminals TPI.</p>
<p id="p-0099" num="0098">The communications sequencer CSQ comprises a reception sequencer RSQ. This RSQ is a sequencer for implementing reception processing with the macro block MB<b>2</b> by handshake. More specifically, the reception sequencer RSQ receives from the macro block MB<b>2</b> a signal RXACTIVE that indicates that there is activity on the bus, a signal RXVALID that indicates that a reception data signal DATAOUT is valid, and a signal RXERROR that indicates that there was an error during packet reception. These signals RXACTIVE, RXVALID, and RXERROR are input from MB<b>2</b> of <figref idref="DRAWINGS">FIG. 9</figref>, through SEL<b>2</b>, to the reception sequencer RSQ as the signal TOUT<b>1</b>.</p>
<p id="p-0100" num="0099">The reception sequencer RSQ uses a control signal RCTL to control the test reception buffer RXB. More specifically, it controls the accumulation of the signal DATAOUT from the macro block MB<b>2</b> by the reception buffer RXB. It also controls the output of the signal TO to the test output terminals TPO by the reception buffer RXB. In this case, the configuration of this embodiment is such that the signal TO is output at a clock frequency CF<b>3</b> that is lower than the clock frequency CF<b>1</b> (such as 60 MHz), during the accumulation of the signal DATAOUT (CF<b>3</b> could also be the same as CF<b>2</b>). This makes it possible to use the lower clock frequency CF<b>3</b> for the output of the signal TO, to maintain some leeway. It is therefore possible to obtain stable test results with few variations, even when there are large parasitic capacitances in the test output terminals TPO.</p>
<p id="p-0101" num="0100">The description now turns to details of the operation of the test circuit TC and the communications sequencer CSQ, using the waveform charts shown in <figref idref="DRAWINGS">FIGS. 13 and 14</figref>.</p>
<p id="p-0102" num="0101">First of all, all of the PLLSELECT, OSCENB, CLKSELECT<b>1</b>, and CLKSELECT<b>0</b> signals of <figref idref="DRAWINGS">FIG. 10</figref> are set to 0 by an external tester using the test terminals to set the address signal TAD to 0×B, the write signal TWR to active (low level), and also the signal TI to 0×0, as shown at C<b>1</b>. The tester then sets TXMODE of <figref idref="DRAWINGS">FIG. 10</figref> to 0 by setting TAD to 0×8, TWR to active, and also TI to 0×0, as shown at C<b>2</b>. This sets the communications sequencer CSQ to a mode in which four bytes (a plurality of bytes) of the transmission data signal are transmitted sequentially.</p>
<p id="p-0103" num="0102">The tester then writes 1 to all the bits of the four-stage buffers TxBuf<b>0</b> to TxBuf<b>3</b> of the transmission buffer TXB of <figref idref="DRAWINGS">FIG. 10</figref>, by setting the address signal TAD to 0×0 to 0×7, the write signal TWR to active, and also TI to 0×F, as shown at C<b>3</b>. In this case, the write processing is done at the lower clock frequency CF<b>2</b>. The tester then sets TXSTART of <figref idref="DRAWINGS">FIG. 10</figref> to 1 by setting the address signal TAD to 0×F, the write signal TWR to active, and also the signal TI to 0×1, as shown at C<b>4</b>. This starts the automatic transmission processing by the communications sequencer CSQ.</p>
<p id="p-0104" num="0103"><figref idref="DRAWINGS">FIG. 14</figref> is a waveform chart showing the portion C<b>5</b> of <figref idref="DRAWINGS">FIG. 13</figref> enlarged. When the transmission processing of the communications sequencer CSQ (the transmission sequencer TSQ) starts, the signal TXVALID goes active at D<b>1</b> in <figref idref="DRAWINGS">FIG. 14</figref> and the macro block MB<b>2</b> makes the signal TXREADY go active at D<b>2</b>. The transmission data signal DATAIN (FF) is transmitted to MB<b>2</b> at D<b>3</b>.</p>
<p id="p-0105" num="0104">When the macro block MB<b>2</b> receives the transmission data signal DATAIN, transmission processing over the USB starts, using the differential signals DP and DM, as shown at D<b>4</b>. The macro block MB<b>2</b> that has been set to loopback mode receives the transmission data signal that it has transmitted as a reception data signal in loopback mode. The macro block MB<b>2</b> makes the signal RXACTIVE go active, as shown at D<b>5</b>. MB<b>2</b> subsequently makes the signal RXVALID go active, as shown at D<b>6</b> and D<b>7</b>. When that happens, the communications sequencer CSQ (the reception sequencer RSQ) that has received that signal stores the reception data signal DATAOUT (FF) from MB<b>2</b> in the test reception buffer RXB, as shown at D<b>8</b> and D<b>9</b>. The accumulation processing in this case is done at the higher the clock frequency CF<b>1</b>.</p>
<p id="p-0106" num="0105">Subsequently, the tester causes the reception data signal TO that has been stored in the reception buffer RXB to be read by the tester through the test output terminals TPO, as shown at C<b>7</b> in <figref idref="DRAWINGS">FIG. 13</figref>, by setting the address signal TAD to 0×0 to 0×7 and the read signal TRD to active, as shown at C<b>6</b>. The read-out processing in this case is done at the lower clock frequency CF<b>3</b>. The tester then performs comparison processing between the read-out values and expected values, and determines a pass if they match the expected values or a failure if they do not match. This completes the testing.</p>
<p id="h-0013" num="0000">6. Macro Blocks</p>
<p id="p-0107" num="0106">An example of the macro block MB<b>1</b> is shown in <figref idref="DRAWINGS">FIG. 15</figref>. Note that the macro block MB<b>1</b> of this embodiment is not limited to the configuration shown in <figref idref="DRAWINGS">FIG. 15</figref>. The macro block MB<b>1</b> of <figref idref="DRAWINGS">FIG. 15</figref> comprises a serial interface engine (SIE) <b>30</b>, an end point management circuit <b>40</b>, a buffer management circuit <b>50</b>, a buffer <b>60</b>, a bulk transfer management circuit <b>70</b>, and a direct memory access controller (DMAC) <b>80</b>.</p>
<p id="p-0108" num="0107">The SIE <b>30</b> is a circuit that performs various types of processing such as USB packet transfer processing. This SIE <b>30</b> (generally speaking: a first interface circuit) comprises a packet handler circuit <b>32</b>, a suspend-and-resume control circuit <b>34</b>, and a transaction management circuit <b>36</b>. In this case, the packet handler circuit <b>32</b> is a circuit for assembling (generating) or analyzing packets formed of headers and data, and it generates and analyzes CRCs. The suspend-and-resume control circuit <b>34</b> is a circuit that performs sequence control during the suspension and resumption of processing. The transaction management circuit <b>36</b> is a circuit for managing transactions made up of token, data, handshake, and other packets. When a token packet is received, the transaction management circuit <b>36</b> confirms whether or not that packet has the device's own address and, if it does have that address, it performs processing to transfer data packets, then processing for transferring a handshake packet.</p>
<p id="p-0109" num="0108">The end point management circuit <b>40</b> is a circuit for managing the end points that form entrances to the various storage areas of the buffer <b>60</b>, and it comprises components such as registers (a register set) for storing attribute information for those end points.</p>
<p id="p-0110" num="0109">The buffer management circuit <b>50</b> is a circuit for managing the buffer <b>60</b>, and is formed of components such as RAM. More specifically, it generates write addresses or read addresses and performs processing to write data to the buffer <b>60</b> or read data from the buffer <b>60</b>.</p>
<p id="p-0111" num="0110">The buffer <b>60</b> (packet buffer or packet storage means) is designed to store data (packets) temporarily, for transfer through USB, and it has various functions such as compensating for any speed difference between the data transfer speed of USB (the first bus) and the data transfer speed of EBUS (a second bus). Note that EBUS is an external bus that connects together devices such as hard disk drives, optical disk drives, MPEG encoders, and MPEG decoders.</p>
<p id="p-0112" num="0111">The bulk transfer management circuit <b>70</b> is a circuit for managing bulk transfers under USB. The DMAC <b>80</b> (generally speaking: a second interface circuit) is a DMA controller for performing DMA transfers to and from an external device through EBUS.</p>
<p id="p-0113" num="0112">An example of the macro block MB<b>2</b> is shown in <figref idref="DRAWINGS">FIG. 16</figref>. Note that the macro block MB<b>2</b> of this embodiment is not limited to the configuration shown in <figref idref="DRAWINGS">FIG. 16</figref>.</p>
<p id="p-0114" num="0113">The macro block MB<b>2</b> comprises a data handler circuit <b>90</b>, a clock generation circuit <b>92</b>, a high-speed (HS) circuit <b>94</b>, and a full-speed (FS) circuit <b>96</b>. These circuits are logic-level circuits. MB<b>2</b> also comprises an analog front-end circuit <b>98</b> (transmission and reception circuit) that is a physical-layer circuit PHY.</p>
<p id="p-0115" num="0114">The data handler circuit <b>90</b> performs various types of processing for transferring data in conformation with a standard such as USB 2.0. More specifically, during transmission, it performs processing such as attaching synchronization (SYNC), start of packet (SOP), and end of packet (EOP) codes to the data to be transmitted, and bit stuffing. During reception, on the other hand, it performs processing to detect and remove the SYNC, SOP, and EOP codes, and bit unstuffing. In addition, the data handler circuit <b>90</b> generates various timing signals for controlling the data transmission and reception.</p>
<p id="p-0116" num="0115">With USB 2.0, an HS mode (generally speaking: a first transfer mode) and an FS mode (generally speaking: a second transfer mode) are defined. HS mode is a new transfer mode that has been defined by USB 2.0. FS mode is a transfer mode that was defined previously by the prior-art USB 1.1.</p>
<p id="p-0117" num="0116">The clock generation circuit <b>92</b> is a circuit that generates clocks of various frequencies, such as the 480-MHz clock for HS and the 60-MHz system clock, and it comprises an oscillation circuit (OSC), a PLL 480M, and a PLL 60M.</p>
<p id="p-0118" num="0117">In this case, the OSC generates a base clock in combination with other components such as an external oscillator, by way of example. The PLL 480M is a phase-locked loop (PLL) that generates the 480-MHz clock necessary for HS mode as well as the 60-MHz clock necessary for FS mode and the system clock, based on the base clock generated by the oscillation circuit (OSC). The PLL 60M is a PPL that generates the 60-MHz clock necessary for the system clock and FS mode, based on the base clock generated by the oscillation circuit (OSC).</p>
<p id="p-0119" num="0118">The HS circuit <b>94</b> is a logic circuit for transmitting and receiving data in HS mode, which has a data transfer speed of 480 Mbps. The FS circuit <b>96</b> is a logic circuit for transmitting and receiving data in FS mode, which has a data transfer speed of 12 Mbps.</p>
<p id="p-0120" num="0119">The analog front-end circuit <b>98</b> (transmission and reception circuit) is an analog circuit comprising drivers and receivers for transmission and reception in FS and HS modes, and it uses the differential signals DP and DM for transmission and reception processing. This analog front-end circuit <b>98</b> could comprise an HS-mode driver and receiver for transmission and reception in HS mode and an FS-mode driver and receiver for transmission and reception in FS mode.</p>
<p id="p-0121" num="0120">Note that the present invention is not limited to this embodiment and thus various modifications thereto are possible within the scope of the invention laid out herein.</p>
<p id="p-0122" num="0121">For example, the configurations of the test circuit and the first and second macro blocks are not limited to those described with reference to <figref idref="DRAWINGS">FIGS. 2</figref>, <b>7</b>, <b>9</b>, <b>15</b>, and <b>16</b>, and various modifications thereto are possible.</p>
<p id="p-0123" num="0122">The selectors SEL<b>1</b> and SEL<b>2</b> described with reference to this embodiment are comprised within the range of the present invention, even when used in circuits equivalent to the dummy scan flip-flops DSFF, the communications sequencer CSQ, the test transmission buffer TXB, the test reception buffer RXB, and the test buffer TSB.</p>
<p id="p-0124" num="0123">In addition, terminology (such as: UTMI, SIE, DMAC, HS mode, FS mode, three items, four stages, and four bytes) that is derived from generic terminology defined within this document (such as: communications macro block specification, first interface circuit, second interface circuit, first transfer mode, second transfer mode, (I−J) items, plurality of stages, and plurality of bytes) could be replaced by other terminology used within this document.</p>
<p id="p-0125" num="0124">Part of requirements of a claim of the present invention could be omitted from a dependent claim which depends on that claim. Moreover, part of requirements of any independent claim of the present invention could be made to depend on any other independent claim.</p>
<p id="p-0126" num="0125">The specification discloses the following matters about the configuration of the embodiments described above.</p>
<p id="p-0127" num="0126">According to one embodiment of the present invention, there is provided a test circuit for an integrated circuit comprising a plurality of macro blocks, the test circuit comprising: a first selector having a first input to which an output signal from a first macro block is input and a second input to which a test input signal for a second macro block is input; and a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input, wherein during a first test mode for testing the first macro block, the first selector outputs to the first input of the second selector the output signal that has been input from the first macro block to the first input of the first selector, and the second selector outputs to the first macro block the output signal that has been input from the first selector to the first input of the second selector, and wherein during a second test mode for testing the second macro block, the first selector outputs to the second macro block the test input signal for the second macro block that has been input to the second input of the first selector, and the second selector outputs the output signal from the second macro block that has been input to the second input of the second selector, as a test output signal for the second macro block.</p>
<p id="p-0128" num="0127">With this embodiment, the output signals from the first macro block are output to the first macro block through the first and second selectors in the first test mode. On the other hand, in the second test mode, a test input signal for the second macro block is output to the second macro block, and the output signals from the second macro block are output as test output signals for the second macro block.</p>
<p id="p-0129" num="0128">This configuration makes it possible to detect faults in the connecting portion between the first macro block and the test circuit by using the first test mode. It also makes it possible to detect faults in the connecting portion between the test circuit and the second macro block by using the second test mode. This enables the detection of faults in the connecting portions between the first and second macro blocks.</p>
<p id="p-0130" num="0129">Note that in an ordinary operating mode (a mode that is not the first and second test modes), the configuration could be such that the first selector outputs to the second macro block an output signal from the first macro block that has been input to the first input thereof and the second selector outputs to the first macro block an output signal from the second macro block that has been input to the second input thereof.</p>
<p id="p-0131" num="0130">In addition, the test input signal for the second macro block could be input from test input terminals, or it could be input from another circuit. Similarly, the test output signal for the second macro block could be output to test output terminals, or it could be output to another circuit. The output signal from the first selector could be input to the first input of the second selector through another circuit. Furthermore, the inputs provided for the first and second selectors are not limited to the first and second inputs; it is equally possible to have three or more inputs.</p>
<p id="p-0132" num="0131">In this configuration, a scan path may be set for the test circuit together with the first macro block, and the first test mode may be a scan mode in which testing is performed by a scan method that uses the scan path.</p>
<p id="p-0133" num="0132">In this case, the setting of the scan path means the setting of a path from one or more scan-in terminals, through a scan flip-flop (scan circuit), to one or more scan-out terminals.</p>
<p id="p-0134" num="0133">In this configuration, when the number of the output signals from the first macro block to the test circuit is I and the number of input signals from the test circuit to the first macro block is J (where I&gt;J, and I and J are each a natural number or an integer greater than or equal to two), the test circuit further may comprise (I−J) dummy scan flip-flops to hold (I−J) output signals among the I output signals from the first selector, and the dummy scan flip-flops may output the held output signals through the scan path in the scan mode.</p>
<p id="p-0135" num="0134">This configuration makes it possible to check efficiently for wiring defects or the like in the (I−J) output signals (Jth to Ith output signals) among the I output signals (first to Ith output signals) from the first macro block.</p>
<p id="p-0136" num="0135">In this configuration, the test circuit may further comprise: a test buffer which stores an M-bit test input signal for the second macro block by receiving a K-bit test input signal at a time via K test input terminals (where M&gt;K, and M and K are integers greater than or equal to two), and outputs the stored test input signal to the first selector.</p>
<p id="p-0137" num="0136">Note that test buffer could also output K bits at a time of a stored L-bit test output signal for the second macro block, K bits at a time (where L&gt;K, L is an integer greater than or equal to two) via K test output terminals.</p>
<p id="p-0138" num="0137">In this configuration, the second macro block may be a macro block that comprises a physical-layer circuit for data communications, the test circuit may comprise a communications sequencer for performing transmission and reception processing to and from the second macro block by a predetermined communications protocol, and in the second test mode, the communications sequencer may operate to perform processing to transmit a transmission data signal to the second macro block through the first selector, and processing to receive a reception data signal from the second macro block through the second selector.</p>
<p id="p-0139" num="0138">This configuration makes it possible to improve the test efficiency because the transmission and reception processing to and from the second macro block is done automatically by the communications sequencer. Note that the communications sequencer could be provided with only one of the transmission processing function and the reception processing function.</p>
<p id="p-0140" num="0139">In this configuration, the test circuit may further comprise: a test transmission buffer which stores the transmission data signal to the second macro block; and a test reception buffer which stores the reception data signal from the second macro block.</p>
<p id="p-0141" num="0140">This configuration also makes it possible to store the transmission data signal and the reception data signal at a lower clock frequency, by way of example, enabling the implementation of more reliable testing. Note that just one of the test transmission buffer and the test reception buffer could be provided.</p>
<p id="p-0142" num="0141">In this configuration, the test transmission buffer may store a transmission data signal that is input from a test input terminal, the communications sequencer may perform processing to transmit the stored transmission data signal through the first selector to the second macro block, after the storage of the transmission data signal by the test transmission buffer, and may perform processing to receive the reception data signal from the second macro block that has been set to loopback mode, and the test reception buffer may store the received reception data signal and may output the stored reception data signal to the test output terminal.</p>
<p id="p-0143" num="0142">This configuration makes it possible to-improve the test efficiency, enabling to perform automatically a sequence of transmission and reception processing of transmitting the transmission data signal of the test transmission buffer to the second macro block and receiving the reception data signal from the second macro block in the test reception buffer.</p>
<p id="p-0144" num="0143">In this configuration, the test transmission buffer may receive an N-bit transmission data signal for the second macro block by receiving a K-bit transmission data signal at a time via K test input terminals (where N&gt;K, and N and K are integers greater than or equal to two), and the test reception buffer may store an N-bit reception data signal from the second macro block and may output the stored reception data signal by outputting a K-bit reception data signal at a time to K test output terminals.</p>
<p id="p-0145" num="0144">According to another embodiment of the present invention, there is provided an integrated circuit comprising: one of the above described test circuits, the first macro block, and the second macro block.</p>
<p id="p-0146" num="0145">Note that the integrated circuit could comprise macro blocks other than the first and second macro blocks.</p>
<p id="p-0147" num="0146">According to further embodiment of the present invention, there is provided a test method that uses a test circuit comprising a first selector having a first input to which an output signal from a first macro block is input and a second input to which a test input signal for a second macro block is input, and a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input, wherein during a first test mode for testing the first macro block, the output signal from the first macro block that has been input to the first input of the first selector is output to the first input of the second selector, and the output signal from the first selector that has been input to the first input of the second selector is output to the first macro block, and wherein during a second test mode for testing the second macro block, the test input signal for the second macro block that has been input to the second input of the first selector is output to the second macro block, and the output signal from the second macro block that has been input to the second input of the second selector is output as a test output signal for the second macro block.</p>
<p id="p-0148" num="0147">In this configuration, a scan path may be set for the test circuit together with the first macro block, and testing may be performed in scan mode by a scan method that uses the scan path, in the first test mode.</p>
<p id="p-0149" num="0148">In this configuration, when the number of the output signals from the first macro block to the test circuit is I and the number of input signals from the test circuit to the first macro block is J (where I&gt;J, I and J are integers greater than or equal to two), (I−J) output signals among the I output signals from the first selector may be held, and the held output signals may be output through the scan path in the scan mode.</p>
<p id="p-0150" num="0149">In this configuration, the test circuit may comprise a communications sequencer for performing transmission and reception processing to and from the second macro block by a predetermined communications protocol, and in the second test mode, the communications sequencer may be used to transmit a transmission data signal to the second macro block through the first selector and receive a reception data signal from the second macro block through the second selector.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A test circuit for an integrated circuit comprising a plurality of macro blocks, the test circuit comprising:
<claim-text>a first selector having a first input to which an output signal from a first macro block is input and a second input to which a test input signal for a second macro block is input; and</claim-text>
<claim-text>a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input,</claim-text>
<claim-text>wherein during a first test mode for testing the first macro block, the first selector outputs to the first input of the second selector the output signal that has been input from the first macro block to the first input of the first selector, and the second selector outputs to the first macro block the output signal that has been input from the first selector to the first input of the second selector, and</claim-text>
<claim-text>wherein during a second test mode for testing the second macro block, the first selector outputs to the second macro block the test input signal for the second macro block that has been input to the second input of the first selector, and the second selector outputs the output signal from the second macro block that has been input to the second input of the second selector, as a test output signal for the second macro block.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The test circuit as defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein a scan path is set for the test circuit together with the first macro block, and</claim-text>
<claim-text>wherein the first test mode is a scan mode in which testing is performed by a scan method that uses the scan path.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The test circuit as defined in <claim-ref idref="CLM-00002">claim 2</claim-ref>,
<claim-text>wherein, when the number of the output signals from the first macro block to the test circuit is I and the number of input signals from the test circuit to the first macro block is J (where I&gt;J, and I and J are integers greater than or equal to two), the test circuit further comprises (I−J) dummy scan flip-flops to hold (I−J) output signals among the I output signals from the first selector, and</claim-text>
<claim-text>wherein the dummy scan flip-flops output the held output signals through the scan path in the scan mode.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The test circuit as defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising:
<claim-text>a test buffer which stores an M-bit test input signal for the second macro block by receiving a K-bit test input signal at a time via K test input terminals (where M&gt;K, and M and K are integers greater than or equal to two), and outputs the stored test input signal to the first selector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The test circuit as defined in <claim-ref idref="CLM-00001">claim 1</claim-ref>,
<claim-text>wherein the second macro block is a macro block that comprises a physical-layer circuit for data communications,</claim-text>
<claim-text>wherein the test circuit comprises a communications sequencer for performing transmission and reception processing to and from the second macro block by a predetermined communications protocol, and</claim-text>
<claim-text>wherein in the second test mode, the communications sequencer operates to perform processing to transmit a transmission data signal to the second macro block through the first selector, and processing to receive a reception data signal from the second macro block through the second selector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The test circuit as defined in <claim-ref idref="CLM-00005">claim 5</claim-ref>, further comprising:
<claim-text>a test transmission buffer which stores the transmission data signal to the second macro block; and</claim-text>
<claim-text>a test reception buffer which stores the reception data signal from the second macro block.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The test circuit as defined in <claim-ref idref="CLM-00006">claim 6</claim-ref>,
<claim-text>wherein the test transmission buffer stores a transmission data signal that is input from a test input terminal,</claim-text>
<claim-text>wherein the communications sequencer performs processing to transmit the stored transmission data signal through the first selector to the second macro block, after the storage of the transmission data signal by the test transmission buffer, and also performs processing to receive the reception data signal from the second macro block that has been set to loopback mode, and</claim-text>
<claim-text>wherein the test reception buffer stores the received reception data signal and outputs the stored reception data signal to the test output terminal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The test circuit as defined in <claim-ref idref="CLM-00006">claim 6</claim-ref>,
<claim-text>wherein the test transmission buffer receives an N-bit transmission data signal for the second macro block by receiving a K-bit transmission data signal at a time via K test input terminals (where N&gt;K, and N and K are integers greater than or equal to two), and</claim-text>
<claim-text>wherein the test reception buffer stores an N-bit reception data signal from the second macro block and outputs the stored reception data signal by outputting a K-bit reception data signal at a time to K test output terminals.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. A test method that uses a test circuit comprising a first selector having a first input to which an output signal from a first macro block is input and a second input to which a test input signal for a second macro block is input, and a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input,
<claim-text>wherein during a first test mode for testing the first macro block, the output signal from the first macro block that has been input to the first input of the first selector is output to the first input of the second selector, and the output signal from the first selector that has been input to the first input of the second selector is output to the first macro block, and</claim-text>
<claim-text>wherein during a second test mode for testing the second macro block, the test input signal for the second macro block that has been input to the second input of the first selector is output to the second macro block, and the output signal from the second macro block that has been input to the second input of the second selector is output as a test output signal for the second macro block.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The test method as defined in <claim-ref idref="CLM-00009">claim 9</claim-ref>,
<claim-text>wherein a scan path is set for the test circuit together with the first macro block, and</claim-text>
<claim-text>wherein testing is performed in scan mode by a scan method that uses the scan path, in the first test mode.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The test method as defined in <claim-ref idref="CLM-00010">claim 10</claim-ref>,
<claim-text>wherein, when the number of the output signals from the first macro block to the test circuit is I and the number of input signals from the test circuit to the first macro block is J (where I&gt;J, I and J are integers greater than or equal to two), (I−J) output signals among the I output signals from the first selector are held, and</claim-text>
<claim-text>wherein the held output signals are output through the scan path in the scan mode.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The test method as defined in <claim-ref idref="CLM-00009">claim 9</claim-ref>,
<claim-text>wherein the test circuit comprises a communications sequencer for performing transmission and reception processing to and from the second macro block by a predetermined communications protocol, and</claim-text>
<claim-text>wherein in the second test mode, the communications sequencer is used to transmit a transmission data signal to the second macro block through the first selector and receive a reception data signal from the second macro block through the second selector.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. An integrated circuit comprising a first macro block, a second macro block, and a test circuit, where the test circuit comprises:
<claim-text>a first selector having a first input to which an output signal from the first macro block is input and a second input to which a test input signal for the second macro block is input; and</claim-text>
<claim-text>a second selector having a first input to which an output signal from the first selector is input and a second input to which an output signal from the second macro block is input,</claim-text>
<claim-text>wherein during a first test mode for testing the first macro block, the first selector outputs to the first input of the second selector the output signal that has been input from the first macro block to the first input of the first selector, and the second selector outputs to the first macro block the output signal that has been input from the first selector to the first input of the second selector, and</claim-text>
<claim-text>wherein during a second test mode for testing the second macro block, the first selector outputs to the second macro block the test input signal for the second macro block that has been input to the second input of the first selector, and the second selector outputs the output signal from the second macro block that has been input to the second input of the second selector, as a test output signal for the second macro block.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
