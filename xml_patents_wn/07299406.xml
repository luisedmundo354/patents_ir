<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299406-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299406</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10857900</doc-number>
<date>20040602</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>406</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>G</section>
<class>06</class>
<subclass>F</subclass>
<main-group>17</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>715503</main-classification>
<further-classification>715504</further-classification>
<further-classification>715513</further-classification>
<further-classification>715856</further-classification>
<further-classification>715863</further-classification>
</classification-national>
<invention-title id="d0e53">Representing spreadsheet document content</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4945475</doc-number>
<kind>A</kind>
<name>Bruffey et al.</name>
<date>19900700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5533183</doc-number>
<kind>A</kind>
<name>Henderson et al.</name>
<date>19960700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715854</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5680557</doc-number>
<kind>A</kind>
<name>Karamchetty</name>
<date>19971000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715866</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5880742</doc-number>
<kind>A</kind>
<name>Rao et al.</name>
<date>19990300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345440</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5987481</doc-number>
<kind>A</kind>
<name>Michelman et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6006240</doc-number>
<kind>A</kind>
<name>Handley</name>
<date>19991200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715510</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6085202</doc-number>
<kind>A</kind>
<name>Rao et al.</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715509</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6088708</doc-number>
<kind>A</kind>
<name>Burch et al.</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715509</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6115759</doc-number>
<kind>A</kind>
<name>Sugimura et al.</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710 52</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6166734</doc-number>
<kind>A</kind>
<name>Nahi et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715748</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6185582</doc-number>
<kind>B1</kind>
<name>Zellweger et al.</name>
<date>20010200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6243093</doc-number>
<kind>B1</kind>
<name>Czerwinski et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715848</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6476831</doc-number>
<kind>B1</kind>
<name>Wirth et al.</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715784</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6523040</doc-number>
<kind>B1</kind>
<name>Lo et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707101</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6598076</doc-number>
<kind>B1</kind>
<name>Chang et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709206</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6625812</doc-number>
<kind>B2</kind>
<name>Abrams et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>725105</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>6674453</doc-number>
<kind>B1</kind>
<name>Schilit et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715810</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>6675351</doc-number>
<kind>B1</kind>
<name>Leduc</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>6704024</doc-number>
<kind>B2</kind>
<name>Robotham et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345581</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>6865720</doc-number>
<kind>B1</kind>
<name>Otani et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>6874131</doc-number>
<kind>B2</kind>
<name>Blumberg</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>6882755</doc-number>
<kind>B2</kind>
<name>Silverstein et al.</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>382282</main-classification></classification-national>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>6924822</doc-number>
<kind>B2</kind>
<name>Card et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345660</main-classification></classification-national>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>6941354</doc-number>
<kind>B2</kind>
<name>Odamura</name>
<date>20050900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709219</main-classification></classification-national>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>6976226</doc-number>
<kind>B1</kind>
<name>Strong et al.</name>
<date>20051200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715788</main-classification></classification-national>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2002/0016818</doc-number>
<kind>A1</kind>
<name>Kirani et al.</name>
<date>20020200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2002/0030699</doc-number>
<kind>A1</kind>
<name>Van Ee</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345810</main-classification></classification-national>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2002/0032722</doc-number>
<kind>A1</kind>
<name>Baynes et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709202</main-classification></classification-national>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2002/0047870</doc-number>
<kind>A1</kind>
<name>Carro</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345855</main-classification></classification-national>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2002/0052893</doc-number>
<kind>A1</kind>
<name>Grobler et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707509</main-classification></classification-national>
</citation>
<citation>
<patcit num="00031">
<document-id>
<country>US</country>
<doc-number>2002/0065842</doc-number>
<kind>A1</kind>
<name>Takagi et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707500</main-classification></classification-national>
</citation>
<citation>
<patcit num="00032">
<document-id>
<country>US</country>
<doc-number>2002/0087593</doc-number>
<kind>A1</kind>
<name>Rank</name>
<date>20020700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00033">
<document-id>
<country>US</country>
<doc-number>2002/0101447</doc-number>
<kind>A1</kind>
<name>Carro</name>
<date>20020800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345760</main-classification></classification-national>
</citation>
<citation>
<patcit num="00034">
<document-id>
<country>US</country>
<doc-number>2002/0169799</doc-number>
<kind>A1</kind>
<name>Voshell</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00035">
<document-id>
<country>US</country>
<doc-number>2002/0174141</doc-number>
<kind>A1</kind>
<name>Chen</name>
<date>20021100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00036">
<document-id>
<country>US</country>
<doc-number>2003/0018668</doc-number>
<kind>A1</kind>
<name>Britton et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00037">
<document-id>
<country>US</country>
<doc-number>2003/0023640</doc-number>
<kind>A1</kind>
<name>Challenger et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707530</main-classification></classification-national>
</citation>
<citation>
<patcit num="00038">
<document-id>
<country>US</country>
<doc-number>2003/0033329</doc-number>
<kind>A1</kind>
<name>Bergman et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00039">
<document-id>
<country>US</country>
<doc-number>2003/0093565</doc-number>
<kind>A1</kind>
<name>Berger et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709246</main-classification></classification-national>
</citation>
<citation>
<patcit num="00040">
<document-id>
<country>US</country>
<doc-number>2003/0097384</doc-number>
<kind>A1</kind>
<name>Hu et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707514</main-classification></classification-national>
</citation>
<citation>
<patcit num="00041">
<document-id>
<country>US</country>
<doc-number>2003/0226105</doc-number>
<kind>A1</kind>
<name>Waldau</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00042">
<document-id>
<country>US</country>
<doc-number>2004/0049737</doc-number>
<kind>A1</kind>
<name>Simon Hunt et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00043">
<document-id>
<country>US</country>
<doc-number>2004/0174398</doc-number>
<kind>A1</kind>
<name>Luke et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345856</main-classification></classification-national>
</citation>
<citation>
<patcit num="00044">
<document-id>
<country>US</country>
<doc-number>2004/0177323</doc-number>
<kind>A1</kind>
<name>Kaasila et al.</name>
<date>20040900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715513</main-classification></classification-national>
</citation>
<citation>
<patcit num="00045">
<document-id>
<country>US</country>
<doc-number>2004/0205524</doc-number>
<kind>A1</kind>
<name>Richter et al.</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715503</main-classification></classification-national>
</citation>
<citation>
<patcit num="00046">
<document-id>
<country>US</country>
<doc-number>2004/0250220</doc-number>
<kind>A1</kind>
<name>Kalenius</name>
<date>20041200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>715864</main-classification></classification-national>
</citation>
<citation>
<patcit num="00047">
<document-id>
<country>US</country>
<doc-number>2005/0050044</doc-number>
<kind>A1</kind>
<name>Takagi et al.</name>
<date>20050300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  6</main-classification></classification-national>
</citation>
<citation>
<patcit num="00048">
<document-id>
<country>US</country>
<doc-number>2006/0047855</doc-number>
<kind>A1</kind>
<name>Gurevich et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709247</main-classification></classification-national>
</citation>
<citation>
<patcit num="00049">
<document-id>
<country>US</country>
<doc-number>2006/0103665</doc-number>
<kind>A1</kind>
<name>Opala et al.</name>
<date>20060500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>345619</main-classification></classification-national>
</citation>
<citation>
<patcit num="00050">
<document-id>
<country>US</country>
<doc-number>2006/0168506</doc-number>
<kind>A1</kind>
<name>Endo et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>7155001</main-classification></classification-national>
</citation>
<citation>
<patcit num="00051">
<document-id>
<country>WO</country>
<doc-number>WO 02/44953</doc-number>
<kind>A2</kind>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00052">
<othercit>Research in Motion Limited, Attachment Service, www.blackberry.com, 2003, 9 pages, http://www.blackberry.com/knowledgeoontorpublic/livolink.exe/fetch/ . . . , Canada.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00053">
<othercit>Mittermeir R. et al., Finding High-Level Structures in Spreadsheet Programs, Ninth Working Conference on Reverse Engineering, Oct. 29-Nov. 1, 2002 Richmond USA.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00054">
<othercit>Ballinger D. et al., Spreadsheet Visualisation to Improve End-User Understanding, Proceedings of the Australian Symposium on Information Visualisation, vol. 24, Feb. 2004, pp. 99-109, Adelaide, Australia.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>22</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>715503</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715854-856</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715513</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>7155001</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715504</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715509</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>715863</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>709206</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>345440</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>382298</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050273695</doc-number>
<kind>A1</kind>
<date>20051208</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Schnurr</last-name>
<first-name>Jeffrey R.</first-name>
<address>
<city>Waterloo</city>
<country>CA</country>
</address>
</addressbook>
<nationality>
<country>CA</country>
</nationality>
<residence>
<country>CA</country>
</residence>
</applicant>
</applicants>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Research in Motion Limited</orgname>
<role>03</role>
<address>
<city>Waterloo, Ontario</city>
<country>CA</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Hutton</last-name>
<first-name>Doug</first-name>
<department>2176</department>
</primary-examiner>
<assistant-examiner>
<last-name>Blackwell</last-name>
<first-name>James H.</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">A representation of a spreadsheet is displayed on a mobile communication device after receiving a description of a spreadsheet. The description relates to a plurality of map cells, where each map cell corresponds to a cell block, and the description includes location information and primary data type information for each map cell. Based on the location and content-type information in the description, a pictorial representation of the spreadsheet may be generated and displayed to a user of the mobile communication device. A mobile device server may not only generate the description, but also may interpret the user's selection of a region of interest and transmit enough information about the region of interest for the mobile communication device to present the region of interest to the user in a conventional viewer.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="156.72mm" wi="243.25mm" file="US07299406-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="248.07mm" wi="180.85mm" orientation="landscape" file="US07299406-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="242.15mm" wi="160.27mm" orientation="landscape" file="US07299406-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="208.36mm" wi="159.26mm" orientation="landscape" file="US07299406-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="212.09mm" wi="164.00mm" orientation="landscape" file="US07299406-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="83.99mm" wi="161.88mm" orientation="landscape" file="US07299406-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="247.14mm" wi="160.61mm" orientation="landscape" file="US07299406-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="88.90mm" wi="165.27mm" orientation="landscape" file="US07299406-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">The present invention relates to displaying documents on mobile communication devices and, more particularly, to representing spreadsheet document content on such devices.</p>
<heading id="h-0002" level="1">BACKGROUND</heading>
<p id="p-0003" num="0002">Current wireless handheld mobile communication devices enable mobile professionals to stay current with information and communications, such as e-mail, corporate data and organizer information while they are away from their desks. A wireless connection to a server allows a mobile communication device to receive updates to previously received information and communications.</p>
<p id="p-0004" num="0003">Many mobile professionals also require access to e-mail attachments when they are away from their computers. According to Delphi Forums, 80 percent of all corporate knowledge is stored in documents, so access to e-mail attachments is important.</p>
<p id="p-0005" num="0004">Several solutions have been implemented to view attachments of various types on a mobile communication device. In one such implementation, a user may select to an attachment, say, by clicking on the attachment using a user interface input device (e.g., a thumbwheel) while viewing the e-mail message with which the attachment is associated. The user is then presented with a menu of options including an option to receive a “table of contents” and an option to receive the “full content”. Upon receiving an indication that the user has opted to receive the full content, the server transmits a scaled-down representation of the content of the document to the mobile communication device, where the representation is displayed by a viewer application. However, in such a representation, only an initial portion of the full content is displayed in the viewer application and, as the user navigates around the document, individual requests for further portions of the full content are transmitted to the server. The server transmits the further portions of the full content to the mobile communication device responsive to the receipt of each request.</p>
<p id="p-0006" num="0005">Viewing a spreadsheet (or other large document) on the small screen common to many mobile communication devices can be difficult when using this attachment viewing implementation, as it is often necessary to navigate past a large percentage of the document in order to find the content that is of particular relevance. Users are typically not interested in viewing an entire document on the mobile communication device, preferring a large screen at a desktop computer for such viewing, but, rather, are concerned with quickly zooming in on an area of interest.</p>
<p id="p-0007" num="0006">Spreadsheets can contain many rows and columns. Getting a sense for the scope and layout of the document using a small viewing device may be considered difficult and navigating to a region of interest can be slow and network-traffic intensive.</p>
<heading id="h-0003" level="1">SUMMARY</heading>
<p id="p-0008" num="0007">When an e-mail attachment of interest is a spreadsheet, a user of a mobile communication device is presented with an option to receive information summarizing the spreadsheet, from which a pictorial representation may be generated and displayed at the mobile communication device. Advantageously, such a pictorial representation presents the user with a high level perspective on the manner in which the data is laid out and provides a navigation interface that may be used to select a region of the document to be viewed. Responsive to the receipt of an indication of the selection of a region of interest, the server transmits the content applicable to that region to the mobile communication device. At the mobile communication device, the typical viewer application is then invoked to view the region of interest. Further advantageously, since the user is not required to scroll through several screens of the spreadsheet to get to the region of interest, which has associated sending of several requests and correspond receipt of data, network traffic required to view the region of interest is reduced.</p>
<p id="p-0009" num="0008">In accordance with an aspect of the present invention there is provided a method of displaying a representation of a spreadsheet on a mobile communication device. The method includes receiving a description of a spreadsheet, where the description relates to a plurality of map cells, where each map cell in the plurality of map cells corresponds to a cell block including at least two adjacent cells of the spreadsheet and the description includes location information and primary data type information for each map cell, generating a pictorial representation of the spreadsheet, based on the location information and the primary data type information in the description and displaying the pictorial representation of the spreadsheet. In other aspects of the invention, a mobile communication device is provided, which is adapted to perform this method, and a computer readable medium is provided to adapt a mobile communication device to perform this method.</p>
<p id="p-0010" num="0009">In accordance with an aspect of the present invention there is provided a method of preparing a description of a spreadsheet. The method includes analyzing each cell of a plurality of cells of a sheet of a spreadsheet: to determine whether each cell contains data; and, if the cell contains data, to determine a type for the data. The method also includes determining, from cell references of cells determined to contain data, sheet dimensions, where the sheet dimensions include a sheet length, expressed as a number of cells, and a sheet width, expressed as a number of cells and determining, from, at least in part, the sheet dimensions, cell block dimensions, where the cell block dimensions include a cell block length, expressed as a number of cells, and a cell block width, expressed as a number of cells. The method further includes considering the sheet divided into a plurality of cell blocks, each cell block of the plurality of cell blocks having the cell block dimensions and assigning a corresponding map cell to each cell block and assigning a corresponding map cell to said each cell block, thereby creating a plurality of corresponding map cells. The method further includes determining primary data type information and location information for each corresponding map cell of the plurality of corresponding map cells, where the primary data type information for each corresponding map cell is representative of a prevalent type of cell contents among cells in each cell block, and transmitting, to a mobile communication device, a description of the sheet including the primary data type information and the location information for each map cell. In other aspects of the invention, a mobile device server is provided, which is adapted to perform this method, and a computer readable medium is provided to adapt a mobile device server to perform this method.</p>
<p id="p-0011" num="0010">Other aspects and features of the present invention will become apparent to those of ordinary skill in the art upon review of the following description of specific embodiments of the invention in conjunction with the accompanying figures.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0012" num="0011">In the figures which illustrate example embodiments of this invention:</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a handheld mobile communication device suitable for employing embodiments of the present invention;</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a elements in an exemplary path from an e-mail server, through a mobile device server, to the mobile communication device of <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 3</figref> illustrates steps in an exemplary method of processing a spreadsheet according to an embodiment of the present invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 4</figref> illustrates steps in an exemplary method of processing a row of cells in the spreadsheet processed in the method of <figref idref="DRAWINGS">FIG. 3</figref>, according to an embodiment of the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 5</figref> illustrates steps in a method of presenting a pictorial representation to a user at the mobile communication device of <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a mobile communication device having a display displaying pictorial representation of a spreadsheet according to an embodiment of the present invention; and</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 7</figref> illustrates steps in a method of processing, at the mobile device server of <figref idref="DRAWINGS">FIG. 2</figref>, a request for a region of interest according to an embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a handheld mobile communication device <b>10</b> including a housing, an input device (a keyboard <b>14</b>), and an output device (a display <b>16</b>), which is preferably a full graphic Liquid Crystal Display (LCD). Other types of output devices may alternatively be utilized. A processing device (a microprocessor <b>18</b>) is shown schematically in <figref idref="DRAWINGS">FIG. 1</figref> as coupled between the keyboard <b>14</b> and the display <b>16</b>. The microprocessor <b>18</b> controls the operation of the display <b>16</b>, as well as the overall operation of the mobile device <b>10</b>, in response to actuation of keys on the keyboard <b>14</b> by a user.</p>
<p id="p-0021" num="0020">The housing may be elongated vertically, or may take on other sizes and shapes (including clamshell housing structures). The keyboard may include a mode selection key, or other hardware or software for switching between text entry and telephony entry.</p>
<p id="p-0022" num="0021">In addition to the microprocessor <b>18</b>, other parts of the mobile device <b>10</b> are shown schematically in <figref idref="DRAWINGS">FIG. 1</figref>. These include: a communications subsystem <b>100</b>; a short-range communications subsystem <b>102</b>; the keyboard <b>14</b> and the display <b>16</b>, along with other input/output devices including a set of auxiliary I/O devices <b>106</b>, a serial port <b>108</b>, a speaker <b>110</b> and a microphone <b>112</b>; as well as memory devices including a flash memory <b>116</b> and a Random Access Memory (RAM) <b>118</b>; and various other device subsystems <b>120</b>. The mobile device <b>10</b> is preferably a two-way radio frequency (RF) communication device having voice and data communication capabilities. In addition, the mobile device <b>10</b> preferably has the capability to communicate with other computer systems via the Internet.</p>
<p id="p-0023" num="0022">Operating system software executed by the microprocessor <b>18</b> is preferably stored in a computer readable medium, such as the flash memory <b>116</b>, but may be stored in other types of memory devices, such as a read only memory (ROM) or similar storage element. In addition, system software, specific device applications, or parts thereof, may be temporarily loaded into a volatile store, such as the RAM <b>118</b>. Communication signals received by the mobile device may also be stored to the RAM <b>118</b>.</p>
<p id="p-0024" num="0023">The microprocessor <b>18</b>, in addition to its operating system functions, enables execution of software applications on the mobile device <b>10</b>. A predetermined set of software applications that control basic device operations, such as a voice communications module <b>130</b>A and a data communications module <b>130</b>B, may be installed on the mobile device <b>10</b> during manufacture. A cell mapping module <b>130</b>C may also be installed on the mobile device <b>10</b> during manufacture, to implement aspects of the present invention. As well, additional software modules, illustrated as an other software module <b>130</b>N, which may be, for instance, a personal information manager (PIM) application, may be installed during manufacture. The PIM application is preferably capable of organizing and managing data items, such as e-mail messages, calendar events, voice mail messages, appointments, and task items. The PIM application is also preferably capable of sending and receiving data items via a wireless network <b>140</b>. Preferably, the data items managed by the PIM application are seamlessly integrated, synchronized and updated via the wireless network <b>140</b> with the device user's corresponding data items stored or associated with a host computer system.</p>
<p id="p-0025" num="0024">Communication functions, including data and voice communications, are performed through the communication subsystem <b>100</b>, and possibly through the short-range communications subsystem <b>102</b>. The communication subsystem <b>100</b> includes a receiver <b>150</b>, a transmitter <b>152</b> and one or more antennas, illustrated as a receive antenna <b>154</b> and a transmit antenna <b>156</b>. In addition, the communication subsystem <b>100</b> also includes a processing module, such as a digital signal processor (DSP) <b>158</b>, and local oscillators (LOs) <b>160</b>. The specific design and implementation of the communication subsystem <b>100</b> is dependent upon the communication network in which the mobile device <b>10</b> is intended to operate. For example, the communication subsystem <b>100</b> of the mobile device <b>10</b> may be designed to operate with the Mobitex™, DataTAC™ or General Packet Radio Service (GPRS) mobile data communication networks and also designed to operate with any of a variety of voice communication networks, such as Advanced Mobile Phone Service (AMPS), Time Division Multiple Access (TDMA), Code Division Multiple Access CDMA, Personal Communications Service (PCS), Global System for Mobile Communications (GSM), etc. Other types of data and voice networks, both separate and integrated, may also be utilized with the mobile device <b>10</b>.</p>
<p id="p-0026" num="0025">Network access requirements vary depending upon the type of communication system. For example, in the Mobitex™ and DataTAC™ networks, mobile devices are registered on the network using a unique Personal Identification Number (PIN) associated with each device. In GPRS networks, however, network access is associated with a subscriber or user of a device. A GPRS device therefore requires a subscriber identity module, commonly referred to as a Subscriber Identity Module (SIM) card, in order to operate on a GPRS network.</p>
<p id="p-0027" num="0026">When required network registration or activation procedures have been completed, the mobile device <b>10</b> may send and receive communication signals over the communication network <b>140</b>. Signals received from the communication network <b>140</b> by the receive antenna <b>154</b> are routed to the receiver <b>150</b>, which provides for signal amplification, frequency down conversion, filtering, channel selection, etc., and may also provide analog to digital conversion. Analog-to-digital conversion of the received signal allows the DSP <b>158</b> to perform more complex communication functions, such as demodulation and decoding. In a similar manner, signals to be transmitted to the network <b>140</b> are processed (e.g., modulated and encoded) by the DSP <b>158</b> and are then provided to the transmitter <b>152</b> for digital to analog conversion, frequency up conversion, filtering, amplification and transmission to the communication network <b>140</b> (or networks) via the transmit antenna <b>156</b>.</p>
<p id="p-0028" num="0027">In addition to processing communication signals, the DSP <b>158</b> provides for control of the receiver <b>150</b> and the transmitter <b>152</b>. For example, gains applied to communication signals in the receiver <b>150</b> and the transmitter <b>152</b> may be adaptively controlled through automatic gain control algorithms implemented in the DSP <b>158</b>.</p>
<p id="p-0029" num="0028">In a data communication mode, a received signal, such as a text message or web page download, is processed by the communication subsystem <b>100</b> and is input to the microprocessor <b>18</b>. The received signal is then further processed by the microprocessor <b>18</b> for an output to the display <b>16</b>, or alternatively to some other auxiliary I/O devices <b>106</b>. A device user may also compose data items, such as e-mail messages, using the keyboard <b>14</b> and/or some other auxiliary I/O device <b>106</b>, such as a touchpad, a rocker switch, a thumb-wheel, or some other type of input device. The composed data items may then be transmitted over the communication network <b>140</b> via the communication subsystem <b>100</b>.</p>
<p id="p-0030" num="0029">In a voice communication mode, overall operation of the device is substantially similar to the data communication mode, except that received signals are output to a speaker <b>110</b>, and signals for transmission are generated by a microphone <b>112</b>. Alternative voice or audio I/O subsystems, such as a voice message recording subsystem, may also be implemented on the device <b>10</b>. In addition, the display <b>16</b> may also be utilized in voice communication mode, for example, to display the identity of a calling party, the duration of a voice call, or other voice call related information.</p>
<p id="p-0031" num="0030">The short-range communications subsystem <b>102</b> enables communication between the mobile device <b>10</b> and other proximate systems or devices, which need not necessarily be similar devices. For example, the short-range communications subsystem may include an infrared device and associated circuits and components, or a Bluetooth™ communication module to provide for communication with similarly-enabled systems and devices.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a path from an e-mail server <b>202</b> to the mobile communication device <b>10</b>. A mobile device server <b>204</b> is communicatively connected to the e-mail server <b>202</b> for receiving and formatting PIM application data items, such as e-mail messages, e-mail attachments, calendar events, voice mail messages, appointments, and task items for use by the mobile communication device <b>10</b>. The mobile device server <b>204</b> connects to a Wide Area Network (WAN) <b>208</b>, such as the Internet, through a proxy server <b>206</b>. The WAN <b>208</b> and the proxy server <b>206</b> allow the mobile device server <b>204</b> to communicate with an antenna <b>140</b> that is in contact with the mobile communication device <b>10</b>.</p>
<p id="p-0033" num="0032">The mobile device server <b>204</b> may be loaded with a computer readable instruction for executing methods exemplary of this invention from a software medium <b>214</b> which could be a disk, a tape, a chip or a random access memory containing a file downloaded from a remote source.</p>
<p id="p-0034" num="0033">In a known manner of operation, the mobile device server <b>204</b> receives documents from the e-mail server <b>202</b> in a binary format. The documents may be distilled by the mobile device server <b>204</b> and the content information, original visual representation information and navigation information may be extracted by the mobile device server <b>204</b>. This information may then be organized, stored and linked together, by the mobile device server <b>204</b>, in an efficient Document Object Model (DOM) in a binary Extensible Markup Language (XML) format.</p>
<p id="p-0035" num="0034">The mobile device server <b>204</b> may then format documents for the mobile communication device <b>10</b> and then convert the documents to an efficient format for wireless delivery. Once in the efficient format, the documents are sent, by the mobile device server <b>204</b>, to the proxy server <b>206</b>, from which the documents are sent, over the WAN <b>208</b>, to the antenna <b>140</b> that is in contact with the mobile communication device <b>10</b>.</p>
<p id="p-0036" num="0035">When a user of the mobile communication device <b>10</b> indicates an interest in an attachment to an e-mail displayed on the mobile communication device <b>10</b>, a request for the attachment is sent, via the antenna <b>140</b> and the WAN <b>208</b>, to the mobile device server <b>204</b>. Responsive to receiving the request, the mobile device server <b>204</b> accesses the DOM and reconstructs the components of the original document that are required to satisfy the request. Based on the request for content (specifying, for example, page and paragraph information or search words) and available information about the mobile communication device (for example, screen size, display type), the mobile device server <b>204</b> generates an appropriate document portion from the reconstructed components and sends the appropriate document portion to the mobile communication device <b>10</b>.</p>
<p id="p-0037" num="0036">In a manner of operation proposed herein, the mobile communication device <b>10</b> presents an additional option responsive to the selection, by the user, of an attachment to an e-mail, where the attachment is a spreadsheet. The additional option allows the user of the mobile communication device <b>10</b> to request a description of the spreadsheet. Such a description may relate to a plurality of map cells, where each map cell corresponds to a cell block including at least two cells of said spreadsheet and where the description includes location information and primary data type information for each map cell. The description may be called a “cell map”. Responsive to receiving the request for the description at the mobile device server <b>204</b>, the spreadsheet is processed to generate the cell map, which is subsequently transmitted to the mobile communication device <b>10</b>. A viewer application at the mobile communication device <b>10</b> provides the user with a summary (pictorial) representation of the spreadsheet generated from the cell map and a navigation interface that may be used to select a region of interest within the pictorial representation of the spreadsheet. Responsive to the receipt of an indication of the selection of the region of interest from the mobile communication device <b>10</b>, the mobile device server <b>204</b> transmits a description of the region of interest to the mobile communication device <b>10</b>. At the mobile communication device <b>10</b>, a further viewer application (the typical viewer application) may then be invoked to interpret the description of the region of interest and display the region of interest.</p>
<p id="p-0038" num="0037">In operation, when the mobile device server <b>204</b> transmits an e-mail message having an attachment to the mobile communication device <b>10</b>, a menu of options is associated with the attachment. If the attachment is a word processing document, the options in the menu may include, as presented hereinbefore, an option to receive a table of contents for the word processing document and an option to receive the full content of word processing document. If the attachment is a spreadsheet however, the options in the menu may include, according to aspects of the present invention, an option to receive a cell map of the spreadsheet and an option to receive the full content of the spreadsheet.</p>
<p id="p-0039" num="0038">When the user selects a spreadsheet included as an attachment to an e-mail message, the user interface of the mobile communication device <b>10</b> presents the menu of options received from the mobile device server <b>204</b>. If the user selects the option to receive a cell map of the spreadsheet, the mobile communication device <b>10</b> transmits a request to the mobile device server <b>204</b> for the cell map.</p>
<p id="p-0040" num="0039">Responsive to receiving the request for the cell map, the mobile device server <b>204</b> processes the spreadsheet to generate the cell map. Steps in an exemplary method of such processing are presented in <figref idref="DRAWINGS">FIGS. 3 and 4</figref>.</p>
<p id="p-0041" num="0040">According to an exemplary method of processing a spreadsheet, steps of which are illustrated in <figref idref="DRAWINGS">FIG. 3</figref>, initially, the first sheet (if there are multiple sheets) is selected (step <b>302</b>). The first row of the selected sheet is then selected (step <b>304</b>) and each cell in the selected row is considered (step <b>306</b>) in a manner expanded upon in <figref idref="DRAWINGS">FIG. 4</figref>. The consideration of each cell in the selected row results in entries in an index for the selected sheet, as will be discussed in detail hereinafter.</p>
<p id="p-0042" num="0041">When the consideration of the cells in the row is complete, it is determined whether all rows have been selected (step <b>308</b>). If all rows have not been selected, the next sequential row is selected (step <b>310</b>) and each cell in the newly selected row is considered (step <b>306</b>). If all rows have been selected, the index for the selected sheet is processed, in manner that will be discussed in detail hereinafter, to generate the cell map of the selected sheet (step <b>312</b>). It is then determined whether all sheets have been selected (step <b>314</b>). If all sheets have not been selected, the next sequential sheet is selected (step <b>316</b>) and the first row in the newly selected sheet is selected (step <b>304</b>). If all sheets have been selected, the processing of the spreadsheet is considered complete.</p>
<p id="p-0043" num="0042">According to the exemplary method of <figref idref="DRAWINGS">FIG. 4</figref>, the consideration of a selected row begins with the selection of the first cell in the row (step <b>402</b>). It is then determined whether the selected cell contains data (step <b>404</b>). If it is determined that the selected cell contains data, the type of the data contained in the selected cell is determined (step <b>406</b>). Spreadsheet cells are known to contain many types of data including, for example, values, text and formulae.</p>
<p id="p-0044" num="0043">Determining the type of the data contained in the selected cell (step <b>406</b>) may rely on logic similar to the following:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0044">if the cell begins with “=”, the type of the data contained in the selected cell may be considered to be “formula”;</li>
    <li id="ul0001-0002" num="0045">if the cell begins with “′”, the type of the data contained in the selected cell may be considered to be “text”; and</li>
    <li id="ul0001-0003" num="0046">if the cell contains strictly numeric data, the type of the data contained in the selected cell may be considered to be “value”.
<br/>
Such rules for determining the type of the data contained in the selected cell may be called a typemask.
</li>
</ul>
</p>
<p id="p-0045" num="0047">Subsequent to the data type determination of the selected cell, the cell reference (e.g., A<b>1</b>) is stored (step <b>408</b>), in an index for the selected sheet, in association with an indication of the type of data contained in the cell. It is then determined whether all the cells of the row have been considered (step <b>410</b>). In the event that cells are yet to be considered, the next cell in the selected row, i.e., the cell in the adjacent column, to the right hand side of the most recently selected cell, is selected for consideration (step <b>412</b>). The selection of the next cell (step <b>412</b>) is also performed when it is determined (step <b>404</b>) that the selected cell does not contain any data. In the event that all cells in the row have been considered, the consideration of the selected row (step <b>306</b>, <figref idref="DRAWINGS">FIG. 3</figref>) is considered complete. For example, the cell references for the first row may follow the sequence A<b>1</b>, A<b>2</b>, . . . , those of the second row of the first sheet may follow the sequence B<b>1</b>, B<b>2</b>, . . . , and so on with the cell reference for the first row of the second sheet following that of the last row of the first sheet.</p>
<p id="p-0046" num="0048">Once each sheet of a spreadsheet has been processed to give a sheet-specific index, the indices are processed (step <b>312</b>, <figref idref="DRAWINGS">FIG. 3</figref>). The processing of a particular index under consideration begins with a determination of the size of the sheet to which the index corresponds. As the index under consideration only contains entries for cells which contain data, the index can be used to determine the size of the sheet, where the size of the sheet is considered to include sheet width, defined by the cell reference of the right-most cell containing data, and sheet length, defined by the cell reference of the bottom-most cell containing data.</p>
<p id="p-0047" num="0049">The cell references, which each have an alphabetic component and a numeric component, are evaluated. The alphabetic component and numeric component of each reference is separated. Two lists are then formed; one list of the alphabetic components and one list of the numeric components. The two lists are then sorted. The alphabetic component (which may be a single letter or a series of letters) which is last, alphabetically, indicates the right-most column. The highest numeric value indicates the bottom-most row. For example, if cell reference A<b>40</b> has the highest numeric value in the index and cell reference YY<b>1</b> is last, alphabetically, the sheet would be considered to be defined at least from cell A<b>1</b> through cell YY<b>40</b> (the sheet is always assumed to “begin” at cell A<b>1</b>, even if there is no data in that cell). Such a sheet would be considered to have a length of 40 cells and a width of 51 cells.</p>
<p id="p-0048" num="0050">As discussed briefly hereinbefore, the mobile device server <b>204</b> generates and transmits portions of content of attachments based on available information about the mobile communication device <b>10</b> including screen size and display type. It may be that the screen size and display type are suitable for displaying a 20 cell by 20 cell portion of a spreadsheet. As such, a target size for the cell map may be 20 cells wide and 20 cells long. In such a case, if the discovered length or width of the spreadsheet exceeds 20 cells, logic must be applied to generate a cell map that will lead to the generation of a pictorial representation that will fit on the display of the mobile communication device <b>10</b>.</p>
<p id="p-0049" num="0051">For sheets with a width of less than 21 cells and a length of less than 21 cells, a pictorial representation of the sheet may not be considered advantageous. If either length or width exceeds 20 cells, a number of cells to be aggregated into a single cell of the cell map is determined by first determining a Maplength parameter and a Mapwidth parameter. The Maplength parameter may be determined by dividing the length of the sheet to be displayed by the length of the display (in cells, 20 in our exemplary case). The Mapwidth parameter may be determined by dividing the width of the sheet to be displayed by the width of the display (in cells, 20 in our exemplary case). The result of the division is then rounded up to the nearest whole number.</p>
<p id="p-0050" num="0052">For example, if the sheet under consideration is 40 cells wide and 60 cells long, then the Maplength is three and the Mapwidth is two. Consequently, every cell in the pictorial representation may be arranged to represent the data contained in a three cells long by two cells wide area of cells on the sheet under consideration. In other words, the rectangle formed by cells A<b>1</b> through B<b>3</b> would be represented in the pictorial representation by a single cell, as would cells A<b>4</b> through B<b>6</b> and C<b>1</b> through D<b>3</b>. Each of these rectangles may be called a “cell block”.</p>
<p id="p-0051" num="0053">Cell blocks are then considered starting in the top left (e.g., the cell block containing cell A<b>1</b>) and considering, in order, the cell blocks to the right of the top left cell block. Subsequently, the cell blocks in the next row of cell blocks down from the top left cell block may be considered. In considering a cell block, the type of the cells within the cell block is determined (text, formula, value). The cell type that is most prevalent is deemed to be the “primary” cell type for the cell block. For example, if five of the eight cells in a cell block had the data type “value”, then “value” would be the primary data type. If there are two or more types with the same number of cells in the cell block, the primary cell type for the cell block may be “mixed”. For each cell block, the contents of the top-leftmost cell that is not empty may be considered to be the “data label” for the cell block. For example, in a cell block with the primary cell type “value”, the contents of the top-leftmost cell that is not empty may be “EMPLOYEE”. In which case, “EMPLOYEE” would be the data label for the cell block. Once determined, the data label and the primary cell type information for each cell block may be stored, along with location information, in the cell map as relating to the corresponding map cell.</p>
<p id="p-0052" num="0054">To maintain the association between a map cell and a cell block, the map cell may also be associated with an identity.</p>
<p id="p-0053" num="0055">When this process of associating a data label and primary cell type information with each map cell is completed, the resulting cell map may describe each map cell in terms of a primary type, a location and a data label. The location of a map cell may be expressed as a cell reference for the top-leftmost cell of the corresponding cell block.</p>
<p id="p-0054" num="0056">The completed cell map, which may include location information, primary data type information and a data label data for each of the map cells in the 20 map cell by 20 map cell cell map, may then be transmitted by the mobile device server <b>204</b> to the mobile communication device <b>10</b>.</p>
<p id="p-0055" num="0057"><figref idref="DRAWINGS">FIG. 5</figref> illustrates steps in a method of presenting the pictorial representation to the user at the mobile communication device <b>10</b>. When the mobile communication device <b>10</b> receives the cell map (step <b>502</b>), the mobile communication device <b>10</b> uses the cell map to generate a pictorial representation of the spreadsheet (step <b>504</b>). <figref idref="DRAWINGS">FIG. 6</figref> presents a simplified illustration of the mobile communication device <b>10</b> having the display <b>16</b>. The display <b>16</b> of the mobile communication device <b>10</b> in <figref idref="DRAWINGS">FIG. 6</figref> is illustrated to be displaying pictorial representation of a spreadsheet. In particular, map cells in the pictorial representation that correspond to cell blocks that contain data are illustrated with a fill pattern. The fill patterns used in <figref idref="DRAWINGS">FIG. 6</figref> include vertical lines for map cells corresponding to cell blocks for which text labels are prevalent, diagonal lines for map cells corresponding to cell blocks for which formulae are prevalent and horizontal lines for map cells corresponding to cell blocks for which values are prevalent. As will be understood by those skilled in the art, while fill patterns are suitable distinguishing markings for a pictorial representation on a monochrome display, fill colors may be used as distinguishing markings for a pictorial representation on a color display. Further alternatively, a character or characters may be used to identify the primary data type of each map cell, for example, “T” for Text Labels, “V” for Values and “F” for Formulae.</p>
<p id="p-0056" num="0058">The mobile communication device <b>10</b> may provide a navigation interface that may be used to select a region of the document to be viewed. In particular, the navigation interface may take the form of a frame <b>606</b> that may appear to overlay a single map cell of the pictorial representation. The user may employ an input interface (e.g., arrow keys, touch screen, joystick, thumbwheel, etc.) to position the frame <b>606</b> over a map cell in region of interest. As the user positions the frame <b>606</b> around the pictorial representation, the frame <b>606</b> may pass over a filled map cell, indicative of a correspondence to a cell block that includes data. When the frame <b>606</b> is positioned over a filled map cell, the data label for the corresponding cell block may be displayed, as a navigational aid for the user, who may, as a result, gain an idea of the data that is contained in the corresponding cell block. The data label may appear in a status bar (not shown) or appear in a text box (not shown) overlaying the pictorial representation. For example, when the frame <b>606</b> is positioned over a filled map cell at the top left edge of a “values” section, the text “451.1” may be displayed, if that were the data label for the corresponding cell block.</p>
<p id="p-0057" num="0059">After appropriately positioning the frame <b>606</b>, the user may select a map cell, thereby specifying a region of interest. Responsive to the receipt of an indication of the selection of a map cell (step <b>506</b>), the mobile communication device <b>10</b> may transmit to the mobile device server <b>204</b> a request including an indication of the region of interest (step <b>508</b>). In particular, the indication may be the identity of the selected map cell.</p>
<p id="p-0058" num="0060">Where the cell block corresponding to the selected map cell is smaller than the exemplary 20 cell by 20 cell display area, the region of interest may be defined to fit the display area of the mobile communication device <b>10</b> and be defined to include the cell block corresponding to the selected map cell as the top-leftmost cell block. Alternatively, the region of interest may be defined to fit the display area of the mobile communication device <b>10</b> and be defined to include the cell block corresponding to the selected map cell as the center cell block.</p>
<p id="p-0059" num="0061">Where the cell block corresponding to the selected map cell is larger than the exemplary 20 cell by 20 cell display area, the region of interest may be defined to fit the display area of the mobile communication device <b>10</b> and be defined to include the top-leftmost cell of the cell block corresponding to the selected map cell as the top-leftmost cell of the displayed region of interest. Alternatively, the region of interest may be defined to fit the display area of the mobile communication device <b>10</b> and be defined to include the top-leftmost cell in the cell block corresponding to the selected map cell as the center cell of the displayed region of interest.</p>
<p id="p-0060" num="0062">Steps of a method of processing, at the mobile device server <b>204</b>, a request for a region of interest are presented in <figref idref="DRAWINGS">FIG. 7</figref>. The method is initiated by receiving a request for a region of interest (step <b>702</b>). Responsive to the receipt of the request for the region of interest, the mobile device server <b>204</b> accesses the DOM of the spreadsheet and reconstructs the components of the spreadsheet (step <b>704</b>) that are required to satisfy the request. Based on the request for the region of interest (identifying, for example, the top-leftmost map cell) and available information about the mobile communication device, the mobile device server <b>204</b> generates information describing the region of interest (step <b>706</b>) from the reconstructed components and sends the information describing the region of interest to the mobile communication device <b>10</b> (step <b>708</b>).</p>
<p id="p-0061" num="0063">At the mobile communication device <b>10</b>, upon receipt of the information describing the region of interest, the viewer application for viewing attachments is invoked to interpret the information and display the region of interest, as the region of interest would normally be viewed.</p>
<p id="p-0062" num="0064">By way of example, consider a user of the mobile communication device <b>10</b> who receives a spreadsheet containing only two columns; text labels and values. The very last row contains totals for the columns. A pictorial representation of such a spreadsheet would quickly indicate to the user where to locate the totals. Responsive to the user employing the user interface to move the frame down to the bottom of the pictorial representation, the data label “Total” may be shown and the user may then select one of the map cells in the last row. In response to such a selection by the user, the mobile communication device <b>10</b> requests the region at the bottom of the spreadsheet, receives the requested region and initiates the attachment viewer to display the region including the bottom row cells in a view familiar to the user.</p>
<p id="p-0063" num="0065">Advantageously, according to aspects of the present invention, the user of the mobile communication device <b>10</b> may view a high-level pictorial representation of the contents of a spreadsheet, dynamically sized to present the entire spreadsheet. Additionally, the frame <b>606</b> (<figref idref="DRAWINGS">FIG. 6</figref>) can be scrolled around the pictorial representation horizontally and vertically. When the frame <b>606</b> passes over a filled map cell, some content from the spreadsheet may be displayed. Through user action to select a region of interest in the pictorial representation, a normal view of the region of interest of the spreadsheet may be requested and viewed without undue requesting and viewing of regions of the spreadsheet that are not of immediate interest.</p>
<p id="p-0064" num="0066">As will be apparent to those skilled in the art, the discussed typemask, type names and graphical representations of the types should be considered exemplary, not strictly the only types that may be defined not the manner in which the types may represented. A customer update table may be defined to contain the criteria by which a data item may be determined to match a given type (typemask), the name of the type to be used in the event that such a match is found, and a graphical representation (i.e., a color) to associate with the given type when representing the data visually.</p>
<p id="p-0065" num="0067">Other modifications will be apparent to those skilled in the art and, therefore, the invention is defined in the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>I claim:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method of displaying a representation of a spreadsheet on a mobile communication device, said method comprising:
<claim-text>receiving a description of said spreadsheet, where said description relates to a plurality of map cells, where each map cell in said plurality of map cells corresponds to a cell block, each cell block comprising at least two adjacent cells of said spreadsheet arid said description includes location information and primary data type information for said each map cell;</claim-text>
<claim-text>generating a summary representation of said spreadsheet, based on said location information and said primary data type information wherein each map cell is represented in said summary representation of said spreadsheet by an indicator of its primary data type; and</claim-text>
<claim-text>displaying said summary representation of said spreadsheet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising;
<claim-text>receiving notice of a selection of a region of interest by a user of said mobile communication device;</claim-text>
<claim-text>transmitting an indication of said region of interest to a server;</claim-text>
<claim-text>receiving information describing said region of interest from said sewer; and</claim-text>
<claim-text>invoking a viewer application to:
<claim-text>interpret said information describing said region of interest; and</claim-text>
<claim-text>display said region of interest.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00002">claim 2</claim-ref> wherein said receiving notice of said selection of said region of interest by said user comprises receiving an identity of a given map cell.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein said region of interest is defined to include a given cell block as the top-leftmost cell block, where said given cell block corresponds to said given map cell.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein said region of interest is defined to include a given cell block as the center cell block, where said given cell block corresponds to said given map cell.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein said description includes a data label for said each map cell in said plurality of map cells.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00006">claim 6</claim-ref> wherein said data label is derived from data contained by a given cell of said at least two adjacent cells in said cell block corresponding to said each map cell, which given cell is the topmost and leftmost cell having data content.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00003">claim 3</claim-ref> wherein said displaying said summary representation of said spreadsheet further comprises providing a navigation interface that may be used to select said region of interest.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising, before said receiving said description of said spreadsheet;
<claim-text>receiving an indication of an association or said spreadsheet with an e-mail message; and</claim-text>
<claim-text>displaying a menu including an option to display said summary representation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00009">claim 9</claim-ref> further comprising:
<claim-text>detecting selection of said option to display said summary representation; and</claim-text>
<claim-text>transmitting a request for said description of said spreadsheet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein said indicator is one of a fill pattern, fill colour, or a letter.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. A mobile communication device comprising a processor adapted to:
<claim-text>receive a description of a spreadsheet, where said description relates to a plurality of map cells, where each map cell in said plurality of map cells corresponds to a cell block, each cell block comprising at least two adjacent cells of said spreadsheet and said description includes location information and primary data type information for said each map cell;</claim-text>
<claim-text>generate a summary representation of said spreadsheet, based on said location information and said primary data type information wherein each map cell is represented in said summary representation of said spreadsheet by an indicator of its primary data type; and</claim-text>
<claim-text>display said summary representation of said spreadsheet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A computer readable medium containing computer-executable instructions that, when performed by a processor in a mobile communication device, cause said processor to:
<claim-text>receive a description of a spreadsheet, where said description relates to a plurality of map cells, where each map cell in said plurality of map cells corresponds to a cell block, each cell block comprising at least two adjacent cells of said spreadsheet and said description includes location information and primary data type information for said each map cell;</claim-text>
<claim-text>generate a summary representation of said spreadsheet, based on said location information and said primary data type information wherein each map cell is represented in said summary representation of said spreadsheet by an indicator of its primary data type; and</claim-text>
<claim-text>display said summary representation of said spreadsheet.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. A method of preparing a description of a spreadsheet, said method comprising:
<claim-text>analyzing each spreadsheet cell of a plurality of spreadsheet cells of a sheet of a spreadsheet:
<claim-text>to determine whether said each spreadsheet cell contains data; and</claim-text>
<claim-text>if said each spreadsheet cell contains data, to determine a type for said data;</claim-text>
</claim-text>
<claim-text>determining, from spreadsheet cells determined to contain data, sheet dimensions, where said sheet dimensions include a sheet length, expressed as a number of spreadsheet cells, and a sheet width, expressed as a number of spreadsheet cells wherein where said sheet width is greater than a first predetermined number of spreadsheet cells, dividing said sheet into a plurality of cell blocks, where each cell block of said plurality of cell blocks has identical cell block dimensions and where said cell block dimensions include a length, expressed as a number of spreadsheet cells, and a width, expressed as a number of spreadsheet cells, and choosing said cell block width as a width which is greater than one spreadsheet cell wide and where said sheet length is greater than a second predetermined number of spreadsheet cells, choosing said cell block length as a length which is greater than one spreadsheet cell long;</claim-text>
<claim-text>assigning a corresponding map cell to said each cell block, thereby creating a plurality of corresponding map cells;</claim-text>
<claim-text>determining primary data type information and location information for each map cell of said plurality of map cells, where said primary data type information for said each corresponding map cell is representative of a prevalent data type of spreadsheet cells in said each cell block; and</claim-text>
<claim-text>transmitting, to a mobile communication device, a description of said sheet including said primary data type information and said location information for said each map cell.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> further comprising:
<claim-text>receiving, from said mobile communication device, an indication of a region of interest; and</claim-text>
<claim-text>transmitting information describing said region of interest to said mobile communication device.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The method of <claim-ref idref="CLM-00015">claim 15</claim-ref> wherein said indication is an identity of a map cell.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein said description of said sheet further includes a data label for said each map cell.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The method of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein said data label for a given map cell is derived from data contained by a given spreadsheet cell among said at least two adjacent spreadsheet cells in a given cell block corresponding to said given map cell, which given spreadsheet cell is the topmost and leftmost cell having data content.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> where said determining said sheet dimensions comprises determining said sheet length from a numeric component of a given spreadsheet cell reference, where said given spreadsheet cell reference has a maximum numeric component among said spreadsheet cell references of said spreadsheet cells determined to contain data.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The method of <claim-ref idref="CLM-00014">claim 14</claim-ref> where said determining said sheet dimensions comprises determining said sheet width from an alphabetic component of a given spreadsheet cell reference, where said given spreadsheet cell reference has a maximum alphabetic component among said spreadsheet cell references of said spreadsheet cells determined to contain data.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A mobile device server comprising a processor adapted to:
<claim-text>analyze each cell of a plurality of spreadsheet cells of a sheet of a spreadsheet:
<claim-text>to determine whether said each spreadsheet cell contains data; and</claim-text>
<claim-text>if said each spreadsheet cell contains data, to determine a type for said data;</claim-text>
<claim-text>determine, from spreadsheet cells determined to contain data, sheet dimensions, where said sheet dimensions include a length, expressed as a number of spreadsheet cells, and a width, expressed as a number of spreadsheet cells;</claim-text>
<claim-text>determine cell block dimensions, where said cell block dimensions include a length, expressed as a number of spreadsheet cells, and a width, expressed as a number of spreadsheet cells such that, where said sheet width is greater than a first predetermined number of spreadsheet cells, said cell block width is chosen as a width which is greater than one spreadsheet cell wide, and where said sheet length is greater than a second predetermined number of spreadsheet cells, said cell block length is chosen as a length which is greater than one spreadsheet cell long,</claim-text>
<claim-text>divide said sheet into a plurality of cell blocks, where each cell block of said plurality of cell blocks has identical said cell block dimensions;</claim-text>
<claim-text>assign a corresponding map cell to said each cell block, thereby creating a plurality of corresponding map cells,</claim-text>
<claim-text>determine primary data type information and location information for each map cell of said plurality of map cells, where said primary data type information for said each corresponding map cell is representative of a prevalent data type of spreadsheet cells in said each cell block; and</claim-text>
<claim-text>transmit, to a mobile communication device, a description of said sheet including said primary data type in formation and said location information for said each map cell.</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A computer readable medium containing computer-executable instructions that, when performed by a processor in a mobile device server, cause said processor to:
<claim-text>analyze each cell of a plurality of spreadsheet cells of a sheet of a spreadsheet:
<claim-text>to determine whether said each spreadsheet cell contains data; and</claim-text>
<claim-text>if said each spreadsheet cell contains data, to determine a type for said data;</claim-text>
</claim-text>
<claim-text>determine, from spreadsheet cells determined to contain data, sheet dimensions, where said sheet dimensions include a length, expressed as a number of spreadsheet cells, and a width, expressed as a number of spreadsheet cells;</claim-text>
<claim-text>determine cell block dimensions, where said cell block dimensions include a length, expressed as a number of spreadsheet cells, and a width, expressed as a number of spreadsheet cells such that, where said sheet width is greater than a first predetermined number of spreadsheet cells, said cell block width is chosen as a width which is greater than one spreadsheet cell wide, and where said sheet length is greater than a second predetermined number of spreadsheet cells, said cell block length is chosen as a length which is greater than one spreadsheet cell long;</claim-text>
<claim-text>divide said sheet into a plurality of cell blocks, each cell block of said plurality of cell blocks having said cell block dimensions and assign a corresponding map cell to each cell block, determine primary data type information and location information for each corresponding map cell, where said primary data type information for said each corresponding map cell is representative of a prevalent data type of spreadsheet cell contents among spreadsheet cells in said each cell block; and</claim-text>
<claim-text>transmit, to a mobile communication device, a description of said sheet including said primary data type information and said location information for said each map cell.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
