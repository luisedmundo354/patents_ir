<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298208-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298208</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>11187185</doc-number>
<date>20050722</date>
</document-id>
</application-reference>
<us-application-series-code>11</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2004-216234</doc-number>
<date>20040723</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>152</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>03</class>
<subclass>G</subclass>
<main-group>3</main-group>
<subgroup>20</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>330141</main-classification>
<further-classification>330279</further-classification>
</classification-national>
<invention-title id="d0e71">Automatic level control circuit with improved recovery action</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5423081</doc-number>
<kind>A</kind>
<name>Thiele et al.</name>
<date>19950600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>330279</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6670849</doc-number>
<kind>B1</kind>
<name>Damgaard et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>7164315</doc-number>
<kind>B2</kind>
<name>Camnitz et al.</name>
<date>20070100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>330129</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>JP</country>
<doc-number>11-328855</doc-number>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00005">
<othercit>English Patent Abstract of JP11328855 from esp@cenet, published Nov. 30, 1999, 1 page.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00006">
<othercit>U.S. Office Action issued in U.S. Appl. No. 11/187,281 mailed on Feb. 21, 2007, 7 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>10</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>330129</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330141</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330279</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>330281</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552321</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552341</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>4552451</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>7</number-of-drawing-sheets>
<number-of-figures>7</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20060017501</doc-number>
<kind>A1</kind>
<date>20060126</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Nodake</last-name>
<first-name>Yasuhiro</first-name>
<address>
<city>Ora-gun</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Osha Liang LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Sanyo Electric Co., Ltd.</orgname>
<role>03</role>
<address>
<city>Osaka</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Nguyen</last-name>
<first-name>Khanh Van</first-name>
<department>2817</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">An automatic level control circuit comprises a level detection circuit which detects attack detection to sense a detection level greater than a predetermined level and recovery detection to sense a detection level smaller than the predetermined level, and a gain control circuit which outputs a gain adjustment control signal to regulate a gain of an variable gain amplifier such that an output signal from the variable gain amplifier is set to a predetermined signal level. The gain control circuit generates multiple candidate signals to change the gain at different response speeds, and selectively outputs, as a gain adjustment control signal, one of the candidate signals capable of providing the smallest value as the gain. Therefore, even when the gain is rapidly reduced by the attack action against a short-duration large signal, the gain can be returned to its original state at an appropriate speed.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="121.07mm" wi="191.09mm" file="US07298208-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="205.15mm" wi="143.59mm" orientation="landscape" file="US07298208-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="202.61mm" wi="173.48mm" orientation="landscape" file="US07298208-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="175.09mm" wi="114.38mm" orientation="landscape" file="US07298208-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="176.02mm" wi="157.48mm" orientation="landscape" file="US07298208-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="158.16mm" wi="104.56mm" orientation="landscape" file="US07298208-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="205.49mm" wi="148.00mm" orientation="landscape" file="US07298208-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="196.93mm" wi="110.91mm" orientation="landscape" file="US07298208-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">CROSS REFERENCE TO RELATED APPLICATIONS</heading>
<p id="p-0002" num="0001">The entire disclosure of Japanese Patent Application No. 2004-216234 including the specification, claims, drawings and abstract is incorporated herein by reference.</p>
<p id="p-0003" num="0002">This application contains subject matter that may be related to that contained in the following U.S. application Ser. No. 11/187,281 filed on Jul. 22, 2005, and assigned to the assignee of the instant application: “Automatic Level Control Circuit With Improved Attack Action”.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0004" num="0003">1. Field of the Invention</p>
<p id="p-0005" num="0004">The present invention relates to an ALC (Automatic Level Control) circuit for automatically adjusting the gain of an amplifier to establish an output signal level from the amplifier at a predetermined level.</p>
<p id="p-0006" num="0005">2. Description of the Related Art</p>
<p id="p-0007" num="0006">Many electronic cameras, such as a digital camera, a digital video camera, or the like, have a sound recording capability to record audio input through a microphone and a moving image recording capability to record moving images. Such an electronic camera having a sound recording capability generally includes a circuit for automatically adjusting the gain of an amplifier installed in a stage prior to a recording stage in accordance with a level of an input audio signal when the sound is recorded.</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> shows an automatic level control circuit in a digital detection system using a programmable gain amplifier. In the automatic level control circuit of <figref idref="DRAWINGS">FIG. 1</figref>, an input audio signal amplified by a programmable gain amplifier <b>10</b> is converted from an analog signal into a digital signal by an analog/digital converter (an A/D converter) <b>20</b> installed in a stage after the programmable gain amplifier <b>10</b>. Next, the level of the digital signal (an output signal level from the programmable gain amplifier <b>10</b>) is detected by a level detector <b>30</b> and then compared with a predetermined reference level. Based on the obtained comparison result, the gain of the programmable gain amplifier <b>10</b> is adjusted according to a control signal output from a gain controller <b>40</b> to the programmable gain amplifier <b>10</b> such that the output audio signal from the programmable gain amplifier <b>10</b> (i.e. the input audio signal having been amplified by the programmable gain amplifier <b>10</b>) is set to a predetermined audio signal level.</p>
<p id="p-0009" num="0008">More specifically, when the level of the digital signal detected by the level detector <b>30</b> is greater than the predetermined reference level, an operation for stepping down the gain of the programmable gain amplifier <b>10</b> by one step (an attack action) is performed, whereas an operation for stepping up the gain of the programmable gain amplifier <b>10</b> by one step (a recovery action) is performed when the level of the digital output signal is smaller than the predetermined reference level. By repeating such adjustment to the gain achieved by the attack and recovery actions until the level of the digital signal reaches the predetermined reference level, the amplifier gain can be automatically controlled in accordance with the level of the input audio signal at the predetermined reference level, which enables the recording of audio input at a desired audio signal level.</p>
<p id="p-0010" num="0009">The attack action performed in the automatic level control circuit is generally completed in a short time to minimize an adverse effect that an audio waveform loses its accurate shape due to an excessively large signal beyond a dynamic range. In contrast to this, the recovery action is completed over a relatively long time to prevent data concerning the sound intensity from being lost.</p>
<p id="p-0011" num="0010">However, when a short-duration large signal, such as a signal of the sound of a window pane breaking, is sporadically input, problems as described below are introduced. With such a short duration signal, there is no necessity to maintain the amplifier gain in a reduced state, in contrast to a situation where a large signal continues for a significant amount of time. Accordingly, after the amplifier gain is rapidly reduced by the attack action invoked by the input of the short-duration large signal, it is necessary to restore the amplifier gain to its original state as quickly as possible. However, because in related art the recovery action is normally performed over a long time, amplifier gain which has been rapidly reduced is not promptly restored to the original state. As a result, an insufficient sound level continues for a certain time period until the time when the rapidly reduced amplifier gain is restored to the original state by the recovery action.</p>
<p id="p-0012" num="0011">Although, in consideration of such insufficiency of the sound level, the operation time of the recovery action can be shortened, shortening the operation time of the recovery action results in a problematic deterioration in characteristics of a voice signal, including loss of the data on sound intensity, frequent occurrence of distortion in an audio waveform caused by frequent attack actions due to intermittent input of the large signal, and the like.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0013" num="0012">The present invention advantageously provides an automatic level control circuit comprising a level detection circuit which detects a level of an output signal from a variable gain amplifier for attack detection to sense a detection level being at a predetermined level or higher and recovery detection to sense the detection level being at the predetermined level or lower, and a gain control circuit which outputs, based on a detection result obtained by the level detection circuit, a gain adjustment control signal to regulate a gain of the variable gain amplifier such that the output signal from the variable gain amplifier is set to a predetermined signal level. The gain control circuit generates a plurality of candidate signals to change the gain at different response speeds, and selectively outputs, as a gain adjustment control signal, one of the candidate signals capable of providing a smallest value for the gain.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013">Preferred embodiments of the present invention will be described in detail based on the following figures, wherein:</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> is a circuit diagram of an automatic level control circuit in a digital detection system using a programmable gain amplifier according to a first embodiment of the present invention;</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram showing a configuration of a level detector and a gain controller in the automatic level control circuit of <figref idref="DRAWINGS">FIG. 1</figref>;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing transitions of an input signal level and gain values in gain registers during a recovery action invoked after a large signal continues for a long time in the automatic level control circuit according to the first embodiment of the present invention, and showing a state of a signal level varying in the attack and recovery actions;</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing transitions of an input signal level and gain values in gain registers during a recovery action invoked after the occurrence of a short-duration large signal in the automatic level control circuit according to the first embodiment of the present invention, and showing states of a signal level varying in the attack and recovery actions and a signal level varying in conventional attack and recovery actions;</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> is a diagram showing transitions of an input signal level and gain values in gain registers during a recovery action invoked after the occurrence of a medium-duration large signal in the automatic level control circuit according to the first embodiment of the present invention, and showing a state of a signal level varying in the attack and recovery actions;</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> is a schematic diagram showing a configuration of an automatic level control circuit in a digital detection system using a programmable gain amplifier according to a second embodiment of the present invention, and</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 7</figref> shows an example of a circuit configuration of a level detector in the automatic level control circuit of <figref idref="DRAWINGS">FIG. 6</figref>.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0022" num="0021">Referring now to the drawings, a first embodiment of the present invention will be described below.</p>
<p id="p-0023" num="0022">An automatic level control circuit according to the first embodiment has a configuration basically the same as that schematically shown in <figref idref="DRAWINGS">FIG. 1</figref>. <figref idref="DRAWINGS">FIG. 2</figref> is a schematic diagram showing a configuration of a level detector <b>30</b> and a gain controller <b>40</b> in the automatic level control circuit according to the present embodiment. <figref idref="DRAWINGS">FIG. 3</figref> is a diagram showing a recovery action invoked after a large signal continues for a long time in the automatic level control circuit according to this embodiment, and, in <figref idref="DRAWINGS">FIG. 3</figref>, an upper portion shows transitions of an input signal level and gain values in gain registers, and a lower portion shows a state of a signal level varying in the attack and recovery actions performed by the automatic level control circuit according to this embodiment. <figref idref="DRAWINGS">FIG. 4</figref> is a diagram showing a recovery action invoked after the occurrence of a short-duration large signal, and, in <figref idref="DRAWINGS">FIG. 4</figref>, an upper portion shows transitions of an input signal level and gain values in gain registers, a middle portion shows a state of a signal level varying in the attack and recovery actions performed by the automatic level control circuit according to this embodiment, and a lower portion shows a signal level varying in conventional attack and recovery actions.</p>
<p id="p-0024" num="0023">In the automatic level control circuit of <figref idref="DRAWINGS">FIG. 1</figref>, an A/D converter <b>20</b> is connected in a stage after a variable gain amplifier (for example, a programmable gain amplifier) <b>10</b>. The A/D converter <b>20</b> converts an input audio signal (an analog signal) which has been amplified in the programmable gain amplifier <b>10</b> into a digital signal and outputs the resultant digital signal to a level detector <b>30</b>.</p>
<p id="p-0025" num="0024">The level detector <b>30</b> detects the magnitude of the digital signal (an output level of the programmable gain amplifier <b>10</b>) and compares the detected level with predetermined reference levels (a relatively greater attack detection reference level and a relatively smaller recovery detection reference level). Then, from an obtained comparison result, a detection result indicating a one-step reduction of the gain of the programmable gain amplifier <b>10</b> (initiation of the attack action) or indicating a one-step increase of the gain (initiation of the recovery action) is obtained, as conventionally achieved in the related art. Based on the obtained detection result, a control signal to adjust the gain of the programmable gain amplifier <b>10</b> such that the output audio signal from the programmable gain amplifier <b>10</b> is set at a predetermined audio signal level is output from the gain controller <b>40</b>. Thus, according to the gain adjustment control signal from the gain controller <b>40</b>, the gain of the programmable gain amplifier <b>10</b> is established. In this manner, automatic adjustments to the gain of the programmable gain amplifier <b>10</b> are completed.</p>
<p id="p-0026" num="0025">In this embodiment, the gain controller <b>40</b> includes gain resistors (consisting of a first gain register <b>41</b> and a second gain register <b>42</b>) for storing two candidate signals each having a different attack/recovery time constant, and a selector <b>43</b> for selectively outputting one of output signals (candidate signals) which is obtained from either one of the gain registers <b>41</b> and <b>42</b>. Control signals are output from the gain registers <b>41</b> and <b>42</b> based on the detection result obtained from the level detector <b>30</b> as described below, and then one of the candidate signals selected by the selector <b>43</b> is output as a control signal from the selector <b>43</b>. Through the selection of the control signal in the selector <b>43</b>, the recovery action invoked after the short-duration large signal can be performed at a recovery speed different from that of the recovery action invoked after other signals (including a signal composed of successive short-duration large signals). The circuit configuration and action of the gain controller <b>40</b> which operates based on the detection result obtained from the level detector <b>30</b> will be described in accordance with <figref idref="DRAWINGS">FIG. 2</figref>.</p>
<p id="p-0027" num="0026">In this embodiment, the first gain register <b>41</b> in the gain controller <b>40</b> is configured to perform the attack action at high speed and perform the recovery action at medium speed. The second gain register <b>42</b>, on the other hand, is configured to gradually increase the gain at low speed in the recovery action, reduce the gain basically at medium speed in an action other than the recovery action, and stop the change in gain at the time when a value of the gain becomes equal to the value of the first gain register <b>41</b>.</p>
<p id="p-0028" num="0027">In the specific configuration, when a detection signal (an attack detection signal) which indicates initiation of the attack action is input from the level detector <b>30</b> to the gain controller <b>40</b>, KA<b>1</b> is subtracted from a value in the first gain register <b>41</b> at the timing according to a sampling clock signal. The KA<b>1</b> denotes that the gain is reduced by an amount equivalent to KA<b>1</b> steps once in every one sampling clock period. For example, KA<b>1</b> prestored in a register is read out according to the sampling clock and subtracted from the value stored in the first gain register <b>41</b>, thereby updating memory contents in the first gain register <b>41</b>.</p>
<p id="p-0029" num="0028">In this manner, the candidate signal which provides an instruction for reducing the amplifier gain by the amount equivalent to the KA<b>1</b> steps once in every one sampling clock period is repeatedly output from the first gain register <b>41</b> in succession for the duration of time that the attack detection signal is being sensed. Consequently, the amount totally subtracted at the timing of the sampling clock signal increases as the duration of time that the attack detection signal is being sensed becomes longer. Here, the attack action is set at high speed in the first gain register <b>41</b> in this embodiment, which means that the value of KA<b>1</b> is specified as a greater value.</p>
<p id="p-0030" num="0029">On the other hand, when a detection signal (a recovery detection signal) which instructs initiation of the recovery action is input from the level detector <b>30</b> to the gain controller <b>40</b>, KR<b>1</b> is added to the value in the first gain register <b>41</b> at the timing of the sampling clock signal. The KR<b>1</b> denotes that the gain is increased by an amount equivalent to KR<b>1</b> steps once in every one sampling clock period. For example, KR<b>1</b> prestored in a register is read out according, to the sampling clock and added to the value stored in the first gain register <b>41</b>, thereby updating the memory contents in the first gain register <b>41</b>. In this manner, the candidate signal which provides an instruction for increasing the amplifier gain by the amount equivalent to the KR<b>1</b> steps once in every one sampling clock period is repeatedly output from the first gain register <b>41</b> for the duration of time that the recovery detection signal is detected.</p>
<p id="p-0031" num="0030">Further, when the detection signal (a recovery detected signal) which instructs initiation of the recovery action is input from the level detector <b>30</b> to the gain controller <b>40</b>, KR<b>2</b> is added to a value in the second gain register <b>42</b> at the timing of the sampling clock signal simultaneously with the addition to the first gain register <b>41</b>. The KR<b>2</b> denotes that the gain is increased by an amount equivalent to KR<b>2</b> steps once in every one sampling clock period. In this manner, the candidate signal which provides an instruction for increasing the amplifier gain by the amount equivalent to the KR<b>2</b> steps once in every one sampling clock period is repeatedly output from the second gain register <b>42</b> for the duration of time that the attack detection signal is detected.</p>
<p id="p-0032" num="0031">In this embodiment, the first gain register <b>41</b> is configured to perform the recovery action at medium speed, while the second gain register <b>42</b> is configured to perform the recovery action at low speed. Accordingly, values of KR<b>1</b> and KR<b>2</b> are specified so as to satisfy a relationship of KR<b>2</b>&lt;KR<b>1</b>. It is preferable that these values are specified so as to have a significant difference between them (i.e. KR<b>2</b>&lt;&lt;KR<b>1</b>).</p>
<p id="p-0033" num="0032">During the interval that recovery detection does not occur (including the duration of time that the attack detection occurs), KA<b>2</b> is subtracted from the value in the second gain register <b>42</b> using a NOT circuit at the timing of the sampling clock signal. In other words, while sensing no recovery detection, the operation of subtracting KA<b>2</b> from the value of the second gain register <b>42</b> at every sampling clock period is enabled. Further, when the gain value of the second gain register <b>42</b> becomes equal to the value in the first gain register <b>41</b> as a result of the operation of subtracting KA<b>2</b> during the interval that recovery detection does not occur, the subtracting operation performed in the second gain register <b>42</b> is terminated. In this embodiment, for example, the value of (a signal from) the first gain register <b>41</b> is input in a negative input terminal of the comparator <b>44</b>, while the value of (a signal from) the second gain register <b>42</b> is input in a positive input terminal of the comparator <b>44</b>, to establish the setting that terminates the above-described subtracting operation when the output signal from the comparator <b>44</b> becomes zero (or negative). In other words, the operation of subtracting KA<b>2</b> from the value in the second gain register <b>42</b> at every sampling clock period is disabled even through the recovery detection does not occur. Because it is necessary to quickly reduce the gain at the occurrence of the attack detection regardless as to whether the signal is a short-duration large signal or a long-duration large signal, the values of KA<b>1</b> and KA<b>2</b> are assigned so as to fulfill the relationship of KA<b>2</b>&lt;KA<b>1</b>. However, the values are not limited to those satisfying the relationship of KA<b>2</b>&lt;KR<b>1</b>.</p>
<p id="p-0034" num="0033">After finishing the above-described subtracting or addition operation during attack or recovery detection, the selector <b>43</b> selects the smaller candidate signal from among the candidate signals output from the gain registers <b>41</b> and <b>42</b> to change the gain, and output the smaller of the candidate signals as a control signal to the programmable gain amplifier <b>10</b>. In other words, the smaller of the candidate signals is adopted as the gain. The selector <b>43</b> may have the structure including a comparator used for comparing values of the candidate signals from the first gain register <b>41</b> and the second gain register <b>42</b> in addition to a gate which opens for either one of the candidate signals from the first and second gain registers <b>41</b> and <b>42</b> based on the comparison result obtained from the comparator. When the candidate signals from the first and second gain registers <b>41</b> and <b>42</b> have the same value, either of the candidate signals may be selected.</p>
<p id="p-0035" num="0034">Through the use of the gain controller <b>40</b> configured as described above, the recovery action initiated after the short-duration large signal can be performed at a recovery speed different from that of the recovery action initiated after the other signals (including a signal composed of successive short-duration large signals), which will be described in detail below.</p>
<p id="p-0036" num="0035">Because the attack detection occurs when a long-duration large signal S<b>1</b> shown in <figref idref="DRAWINGS">FIG. 3</figref> is input, at the time immediately following the input, the first gain register <b>41</b> outputs the signal which provides the instruction for reducing the gain by the amount equivalent to the KA<b>1</b> steps once in every sampling clock period, and the second gain register <b>42</b> outputs the signal to provides the instruction for reducing the gain by the amount equivalent to the KA<b>2</b> steps once in every sampling clock period. Then, according to the relationship of KA<b>2</b>&lt;KA<b>1</b>, the selector <b>43</b> selects the smaller gain, i.e. the signal from the first gain register <b>41</b> is selected. Consequently, the attack action at high speed is performed at the time immediately following the input.</p>
<p id="p-0037" num="0036">Next, upon completion of input of the long-duration large signal S<b>1</b>, the recovery detection occurs, which initiates the recovery action to restore the original level. As described above, in the recovery action, the first gain register <b>41</b> outputs the signal to provide the instruction for increasing the gain by the amount equivalent to the KR<b>1</b> steps in each sampling clock period, and the second gain register <b>42</b> outputs the signal to provide the instruction for increasing the gain by the amount equivalent to the KR<b>2</b> steps in each sampling clock period. Then, taking into account a situation where the gain values from both the first and second gain registers <b>41</b> and <b>42</b> match with each other and KR<b>2</b> is less than KR<b>1</b>, the smaller gain value, i.e. the signal from the second gain register <b>42</b> is selected in the selector <b>43</b>. Therefore, after the input of the long-duration large signal S<b>1</b> is completed, the recovery action is performed at low speed, in a manner similar to a conventional recovery action.</p>
<p id="p-0038" num="0037">Further, when a short-duration large signal S<b>2</b> as shown in <figref idref="DRAWINGS">FIG. 4</figref> is input, the attack detection also occurs at the time immediately following the input, which triggers, as described above, the first gain register <b>41</b> to output the signal which provides the instruction for reducing the gain by the amount equivalent to the KA<b>1</b> steps in each sampling clock period, and triggers the second gain register <b>42</b> to output the signal which provides the instruction for reducing the gain by the amount equivalent to the KA<b>2</b> steps in each sampling clock period. Then, from the relationship of KA<b>2</b>&lt;KA<b>1</b>, the smaller gain value, i.e. the signal from the first gain register <b>41</b> is selected in the selector <b>43</b>. Accordingly, at the time immediately after the input, the attack action is performed at high speed.</p>
<p id="p-0039" num="0038">When the input of the short-duration large signal S<b>2</b> is completed, the recovery detection occurs, which triggers the recovery action to restore the original level as described above. In the recovery action, the first gain register <b>41</b> outputs the signal which provides the instruction for increasing the gain by the amount equivalent to the KR<b>1</b> steps in each sampling clock period, and the second gain register <b>42</b> outputs the signal which provides the instruction for increasing the gain by the amount equivalent to the KR<b>2</b> steps in each sampling clock period. Here, the attack actions are performed at different speeds in the gain registers <b>41</b> and <b>42</b>, which causes the gain value obtained from the first gain register <b>41</b> to be smaller than the gain value obtained from the second gain register <b>42</b> at the time when the recovery action is initiated. Because, based on this situation and the relationship that KR<b>2</b> is smaller than KR<b>1</b>, the smaller gain value, i.e. the signal from the first gain register <b>41</b> is selected in the selector <b>43</b>, the recovery action is performed at medium speed (faster than the speed of the conventional recovery action) after the input of the short-duration large signal S<b>2</b> is completed.</p>
<p id="p-0040" num="0039">Further, in the attack detection occurring when the short-duration large signal shown in <figref idref="DRAWINGS">FIG. 4</figref> (a series of short-duration large signals S<b>3</b>) is repeatedly input, similarly to the above-described signals, immediately following the first input of the series of short-duration large signals S<b>3</b>, the signal from the first gain register <b>41</b> is selected, thereby initiating the attack action at high speed.</p>
<p id="p-0041" num="0040">Then, the recovery detection occurs after the attack action is completed, which triggers the recovery action to restore the original level. In this recovery action, similarly to the above-described short-duration large signal S<b>2</b>, the signal from the first gain register <b>41</b> is selected, thereby initiating the recovery action at medium speed (faster than the speed of the conventional recovery action). Because, in this example of the series of short-duration large signals S<b>3</b>, a new short-duration large signal is input at some point in the course of the recovery action having been performed at medium speed, the recovery action at medium speed is switched to the attack action at that point. Then, at the start of the subsequent recovery action, the gain value in the first gain register <b>41</b> is smaller than that in the second register <b>42</b>. Based on this difference in value and on the relationship of KR<b>2</b>&lt;KR<b>1</b>, the smaller gain value, i.e. the signal from the first gain register <b>41</b> is selected in the selector <b>43</b>, thereby initiating the subsequent recovery action at medium speed (faster than the speed of the conventional recovery action).</p>
<p id="p-0042" num="0041">In this manner, when the series of short-duration large signals S<b>3</b> is input, the high-speed attack action and the medium-speed recovery action performed by the first gain register <b>41</b> are alternately repeated. Then, after the last input of the series of short-duration large signals S<b>3</b> is completed, if a state where both of the gain values of the gain registers <b>41</b> and <b>42</b> match each other is realized as depicted in <figref idref="DRAWINGS">FIG. 4</figref>, for example, the smaller gain value, i.e. the signal from the second gain register <b>42</b> is selected based on the relationship that KR<b>2</b> is smaller than KR<b>1</b>, thereby initiating the recovery action at low speed. Thus, when the series of short-duration large signals S<b>3</b> is input, the recovery action at low speed similar to the conventional recovery action is invoked assuming that the long-duration large signal S<b>1</b> is input.</p>
<p id="p-0043" num="0042">Because, in the case of a medium-duration large signal, of a duration between short and long, the recovery action starts before the gain value of the second gain register <b>42</b> is reduced to a value equal to the gain value of the first gain register <b>41</b> in this embodiment, the signal from the first gain register <b>41</b> is selected for the recovery gain. Therefore, the recovery action is performed at a speed faster than that of the conventional recovery action. Then, the recovery action according to the signal from the first gain register <b>41</b> continues in a state where the gain value of the first gain register <b>41</b> follows that of the second gain register <b>42</b> as shown in <figref idref="DRAWINGS">FIG. 5</figref>. After the gain value of the first register <b>41</b> reaches the other gain value, the signal from the first gain register <b>41</b> is switched to the signal from the second gain register <b>42</b> which provides slower recovery, thereby initiating the recovery action according to the signal from the second gain register <b>42</b>.</p>
<p id="p-0044" num="0043">As described above, after the medium-duration large signal, the recovery action at medium speed is initially performed, and then the recovery action at low speed is subsequently performed from some midpoint in the course. In such a case of the medium-duration large signal, the time when the gain value of the first gain register <b>41</b> reaches the gain value of the second gain register <b>42</b> varies depending on the length of a time interval during which the large signal continues. Accordingly, the time required for recovery after the medium-duration large signal varies in accordance with the length of the time interval of the large signal.</p>
<p id="p-0045" num="0044">As described above, through the use of the automatic level control circuit according to this embodiment, the smaller of the gain values from the two gain registers (the first gain register <b>41</b> and the second gain register <b>42</b>) each having a different attack/recovery time constant is selected to control the recovery action, thereby enabling the recovery action at medium speed (i.e. a faster recovery action as compared with the conventional recovery action) after the short-duration large signal. In this manner, the amplifier gain rapidly reduced by the attack action due to the short-duration large signal can be swiftly restored to the original gain, which provides a solution to the problematic situation in which the condition of the insufficient sound level is maintained over a certain period of time until the rapidly reduced amplifier gain recovers to its original state through the recovery action.</p>
<p id="p-0046" num="0045">Further, by selecting the smaller of the gain values from the two gain registers having different attack/recovery time constants to control the recovery action, repeated inputs of successive short-duration large signals are regarded as being processed in the same manner with the input of the large signal continuing for a long duration, thereby initiating the slow recovery action similarly to the conventional case. In this manner, when, for example, the sound of a drum (a short-duration large signal) continues intermittently over a long period time, the rapid increase of the amplifier in a short time is avoided, in spite of the fact that the signal is the short-duration large signal, thereby protecting data on sound intensity from being lost, which enables automatic control of level while maintaining an audio quality.</p>
<p id="p-0047" num="0046">On the other hand, in the case of the medium-duration large signal, the medium-speed recovery action (which is faster than the conventional recovery action) is initially performed, and then the slow recovery action is started from some point in the course of recovery. The time required for recovery thus varies according to the length of the interval that the medium-duration large signal continues as described above. Therefore, the automatic control of the level is achieved in accordance with the length of the interval that the medium-duration large signal continues while maintaining the audio quality without losing the data on sound intensity in addition to attempting to minimize the recovery time.</p>
<p id="p-0048" num="0047">Although KA<b>1</b>, KA<b>2</b>, KR<b>1</b>, and KR<b>2</b> in the above-described embodiment represent the number of steps in which the gain is changed in each sampling clock period, KA<b>1</b>, KA<b>2</b>, KR<b>1</b>, and KR<b>2</b> are not limited to the number of steps, and any values which indicate the speed of changing the gain in the attack and recovery actions may be adopted as KA<b>1</b>, KA<b>2</b>, KR<b>1</b>, and KR<b>2</b>.</p>
<p id="p-0049" num="0048">While an example illustrating an embodiment of the present invention has been described above, it is to be understood that the example is illustrative and not restrictive, and that any circuit configuration capable of realizing the technical concept of the present invention that, by selecting the smaller gain values from the two gain registers having different attack/recovery time coefficients, the attack/recovery action is controlled at different speeds may be adopted.</p>
<p id="p-0050" num="0049">In addition, although the automatic level control circuit according to this embodiment has the structure in which the analog output from the programmable gain amplifier <b>10</b> is converted into a digital output for level detection, and is provided to the stages after the programmable gain amplifier <b>10</b>, the circuit configuration of the automatic level control circuit is not limited to the structure. For example, the analog output may be supplied from the programmable gain amplifier <b>10</b> only to the A/D converter <b>20</b>, and the digital signal converted from the analog signal in the A/D converter <b>20</b> may be output from the A/D converter <b>20</b> to the level detector <b>30</b> and may be supplied to the stages after the A/D converter <b>20</b>.</p>
<p id="p-0051" num="0050">Further additionally, as shown in <figref idref="DRAWINGS">FIG. 6</figref>, for example, an automatic level control circuit in which an analog signal from the programmable gain amplifier <b>10</b> is input in the level detector <b>31</b> can also produce effects similar to those obtained by the automatic level control circuit according to the above-described embodiment.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 6</figref> shows a configuration of the automatic level control circuit in a digital detection system using a programmable gain amplifier according to a second embodiment of the present invention. In the automatic level control circuit of <figref idref="DRAWINGS">FIG. 6</figref>, an analog voltage level of an analog signal to be input is compared with a predetermined reference voltage level in the level detector <b>31</b> in which a first voltage comparator <b>32</b> and a second voltage comparator <b>33</b> are installed as shown in <figref idref="DRAWINGS">FIG. 7</figref>, for example. The first voltage comparator <b>32</b> compares the input analog voltage level with a predetermined reference voltage level (attack detection level), and, when the level of the input signal is higher than the attack detection level, outputs a signal of a comparison result (an attack detection signal) to the gain controller <b>40</b> provided in the subsequent stage. The second voltage comparator <b>33</b>, on the other hand, compares the level of the input signal with a predetermined reference voltage level (a recovery detection level), and, when the level of the input signal is lower than the recovery detection level, outputs a signal of the comparison result (a recovery detection signal) to the controller <b>40</b> provided in the subsequent stage. Then, similarly as in the previous embodiment, based on the obtained signal of the comparison results, a control signal to adjust the gain of the programmable gain amplifier <b>10</b> such that the output audio signal from the programmable gain amplifier <b>10</b> is established at a predetermined audio signal level is output from the gain controller <b>40</b>.</p>
<p id="p-0053" num="0052">By configuring the level detector <b>31</b> as described above, the automatic level control circuit in which the analog signal from the programmable gain amplifier <b>10</b> is input in the level detector <b>31</b> can produce the same effects as those obtained by the automatic level control circuit according to the first embodiment.</p>
<p id="p-0054" num="0053">Having been described above, according to the present invention, the recovery action invoked after the input of an isolated short-duration large signal enables quick recovery to the original gain even when the amplifier gain is rapidly reduced in the attack action invoked by the isolated large signal. It is therefore possible to avoid a problematic situation in which the condition of the insufficient sound level is maintained over a long time period until the steeply reduced amplifier gain is restored to its original state by the recovery action. On the other hand, the repeated successive inputs of the short-duration large signal are interpreted as the input of the large signal continuing for a long time, and the recovery action is performed at low speed, as in the related art. Therefore, because, when the short-duration large signal is repeatedly input over a relatively long period of time, the amplifier gain is not steeply increased in a short time in contrast to a case where a single short-time large signal is input, the data on sound intensity is protected from being lost, thereby enabling automatic control of level while maintaining the audio quality. Further, in the case of the medium-duration large signal, because the time required for completing the recovery action varies according to the length of time that the medium-duration large signal continues, it is possible that, in addition to enabling the automatic control of level while maintaining the audio quality without loss of sound intensity data in accordance with the length of time that the medium-duration large signal continues, the recovery time may be minimized.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. An automatic level control circuit comprising:
<claim-text>a level detection circuit which detects a level of an output signal from a variable gain amplifier for attack detection to sense a detected level greater than or equal to a predetermined level and for recovery detection to sense a detected level smaller than or equal to the predetermined level, and</claim-text>
<claim-text>a gain control circuit which outputs, based on a detection result obtained by the level detection circuit, a gain adjustment control signal to regulate a gain of the variable gain amplifier such that the output signal from the variable gain amplifier is set to a predetermined signal level; wherein</claim-text>
<claim-text>the gain control circuit generates a plurality of candidate signals to change the gain at different response speeds, and selectively outputs, as the gain adjustment control signal, one of the candidate signals which provides a smallest value as the gain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The automatic level control circuit according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein the gain control circuit further comprises:
<claim-text>two gain registers each individually storing one of the candidate signals which sequentially varies at a response speed different from that of the other candidate signals, and</claim-text>
<claim-text>a selector for selecting one of the candidate signals which provides the smallest value as the gain and then outputting the selected one of the candidate signals as the gain adjustment control signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The automatic level control circuit according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein
<claim-text>when the attack detection occurs in the level detection circuit, the gain control circuit sequentially subtracts setting values which are different between the two gain registers and stored in their respective gain registers from values of the two gain registers individually, and</claim-text>
<claim-text>when the recovery detection occurs in the level detection circuit, the gain control circuit sequentially adds the setting values which are different between the two registers and prestored in their respective gain registers from values of the two gain registers individually.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The automatic level control circuit according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein, when the attack detection occurs in the level detection circuit, one of the candidate signals capable of providing a smaller gain is selected to enable a rapid reduction of the gain after input of a large signal.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The automatic level control circuit according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein:
<claim-text>the two gain registers consists of a first gain register and a second gain register, the first gain register storing a candidate signal which yields a faster change of the gain than that achieved in the second gain register at both times when the attack detection occurs and times when the recovery detection occurs, and</claim-text>
<claim-text>the candidate signal stored in the first gain register is selected for an isolated input of a short-duration large signal, to thereby enable a rapid reduction of the gain when the attack detection occurs and enable a rapid increase of the gain when the recovery detection subsequent to the attack detection occurs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The automatic level control circuit according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein:
<claim-text>the two gain registers consists of a first gain register and a second gain register, the first gain register storing a candidate signal which yields a faster change of the gain than that achieved in the second gain register at both times when the attack detection occurs and times when the recovery detection occurs; and</claim-text>
<claim-text>the candidate signal stored in the first gain register is selected for an isolated input of a short-duration large signal, to thereby enable a rapid reduction of the gain when the attack detection occurs and enable a rapid increase of the gain when the recovery detection subsequent to the attack detection occurs.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The automatic level control circuit according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein:
<claim-text>the two gain registers consist of a first gain register and a second gain register, a candidate signal in the first gain register yields a faster change of the gain than that achieved in the second gain register at both times when the attack detection occurs and times when the recovery detection occurs is stored, and the change of the gain of the candidate signal generated when the attack detection occurs is greater than that of the candidate signal generated when the recovery detection occurs; and</claim-text>
<claim-text>when the short-duration large signal is repeatedly input in a short cycle, the first gain register is selected to set the gain to a low value, and, after the input of the short-duration large signal is completed, the second gain register is selected to increase the gain at a relatively slow transition speed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The automatic level control circuit according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein:
<claim-text>the two gain registers consists of a first gain register and a second gain register, a candidate signal in the first gain register yields a faster change of the gain than that achieved in the second gain register at both times when the attack detection occurs and times when the recovery detection occurs is stored, and the change of the gain of the candidate signal generated when the attack detection occurs is greater than that of the candidate signal generated when the recovery detection occurs; and</claim-text>
<claim-text>when the short-duration large signal is repeatedly input in a short cycle, the first gain register is selected to set the gain to a low value, and, after the input of the short-duration large signal is completed, the second gain register is selected to increase the gain at a relatively slow transition speed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The automatic level control circuit according to <claim-ref idref="CLM-00003">claim 3</claim-ref>, wherein:
<claim-text>the two gain registers consist of a first gain register and a second gain register, a candidate signal in the first gain register yields a faster change of the gain than that achieved in the second gain register at both times when the attack detection occurs and times when the recovery detection occurs is stored, and the change of the gain of the candidate signal generated when the attack detection occurs is greater than that of the candidate signal generated when the recovery detection occurs; and</claim-text>
<claim-text>when a medium-duration large signal is input, the first gain register is selected to quickly reduce the gain, and, after the input of the medium-duration large signal is completed, the first gain register is again selected and then the second gain register is subsequently selected to increase the gain at an appropriate speed.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The automatic level control circuit according to <claim-ref idref="CLM-00004">claim 4</claim-ref>, wherein:
<claim-text>the two gain registers consists of a first gain register and a second gain register, a candidate signal in the first gain register yields a faster change of the gain than that achieved in the second gain register at both times when the attack detection occurs and times when the recovery detection occurs is stored, and the change of the gain of the candidate signal generated when the attack detection occurs is greater than that of the candidate signal generated when the recovery detection occurs; and</claim-text>
<claim-text>when a medium-duration large signal is input, the first gain register is selected to quickly reduce the gain, and, after the input of the medium-duration large signal is completed, the first gain register is again selected and then the second gain register is subsequently selected to increase the gain at an appropriate speed.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
