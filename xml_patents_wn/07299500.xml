<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07299500-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07299500</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10621705</doc-number>
<date>20030717</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>845</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>29</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>726 26</main-classification>
</classification-national>
<invention-title id="d0e53">Method and apparatus for secure delivery and rights management of digital content at an unsecure site</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5742807</doc-number>
<kind>A</kind>
<name>Masinter</name>
<date>19980400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707  1</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5892900</doc-number>
<kind>A</kind>
<name>Ginter et al.</name>
<date>19990400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5949876</doc-number>
<kind>A</kind>
<name>Ginter et al.</name>
<date>19990900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5982891</doc-number>
<kind>A</kind>
<name>Ginter et al.</name>
<date>19991100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6112181</doc-number>
<kind>A</kind>
<name>Shear et al.</name>
<date>20000800</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6138119</doc-number>
<kind>A</kind>
<name>Hall et al.</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6157721</doc-number>
<kind>A</kind>
<name>Shear et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6253193</doc-number>
<kind>B1</kind>
<name>Ginter et al.</name>
<date>20010600</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6289452</doc-number>
<kind>B1</kind>
<name>Arnold et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713175</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6292569</doc-number>
<kind>B1</kind>
<name>Shear et al.</name>
<date>20010900</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6363488</doc-number>
<kind>B1</kind>
<name>Ginter et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6449721</doc-number>
<kind>B1</kind>
<name>Pensak et al.</name>
<date>20020900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713171</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6711594</doc-number>
<kind>B2</kind>
<name>Yano et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>707204</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6807632</doc-number>
<kind>B1</kind>
<name>Carpentier et al.</name>
<date>20041000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713165</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>7017188</doc-number>
<kind>B1</kind>
<name>Schmeidler et al.</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>7035826</doc-number>
<kind>B2</kind>
<name>Hamada et al.</name>
<date>20060400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 51</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>7073199</doc-number>
<kind>B1</kind>
<name>Raley</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>726 26</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>2002/0002541</doc-number>
<kind>A1</kind>
<name>Williams</name>
<date>20020100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>705 51</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>30</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>726 21</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>27</number-of-drawing-sheets>
<number-of-figures>29</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Klebe</last-name>
<first-name>Skott C.</first-name>
<address>
<city>Lexington</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Boyea</last-name>
<first-name>John</first-name>
<address>
<city>Alpharetta</city>
<state>GA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>The Law Offices of Paul E. Kudirka</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Copyright Clearance Center, Inc.</orgname>
<role>02</role>
<address>
<city>Danvers</city>
<state>MA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Smithers</last-name>
<first-name>Matthew B</first-name>
<department>2137</department>
</primary-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">At a publisher location, multiple encrypted documents are assembled into a distribution archive that is also encrypted. The distribution archive is then downloaded into a content server at an unsecure site. When the content server receives the distribution archive, it decrypts the archive file and unpacks the encrypted documents, which are then stored, in encrypted form, in a local document database. When a user logs into the local content server, a secure content viewer is downloaded to the user's browser. The content viewer requests a selected document from the local server, which then forwards the encrypted document to the viewer. The viewer then computes a document identifier from the encrypted document content and requests a key from the server with the identifier. The server then returns the requested key and the viewer decrypts that document and presents it in a display area controlled by the viewer.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="144.86mm" wi="241.89mm" file="US07299500-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="139.11mm" wi="168.99mm" orientation="landscape" file="US07299500-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="243.50mm" wi="172.55mm" orientation="landscape" file="US07299500-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="245.19mm" wi="157.82mm" orientation="landscape" file="US07299500-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="226.06mm" wi="140.46mm" file="US07299500-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="242.15mm" wi="90.59mm" file="US07299500-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="238.76mm" wi="164.76mm" file="US07299500-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="247.14mm" wi="160.44mm" file="US07299500-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="238.93mm" wi="172.55mm" orientation="landscape" file="US07299500-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="253.07mm" wi="164.51mm" file="US07299500-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="206.08mm" wi="79.42mm" file="US07299500-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="248.84mm" wi="171.96mm" file="US07299500-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="234.78mm" wi="170.69mm" orientation="landscape" file="US07299500-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="248.07mm" wi="159.51mm" file="US07299500-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="214.63mm" wi="135.89mm" file="US07299500-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="233.68mm" wi="92.20mm" file="US07299500-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00016" num="00016">
<img id="EMI-D00016" he="207.26mm" wi="156.21mm" file="US07299500-20071120-D00016.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00017" num="00017">
<img id="EMI-D00017" he="246.46mm" wi="167.05mm" orientation="landscape" file="US07299500-20071120-D00017.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00018" num="00018">
<img id="EMI-D00018" he="245.96mm" wi="112.86mm" file="US07299500-20071120-D00018.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00019" num="00019">
<img id="EMI-D00019" he="252.05mm" wi="122.43mm" file="US07299500-20071120-D00019.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00020" num="00020">
<img id="EMI-D00020" he="244.86mm" wi="169.67mm" orientation="landscape" file="US07299500-20071120-D00020.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00021" num="00021">
<img id="EMI-D00021" he="227.50mm" wi="77.13mm" file="US07299500-20071120-D00021.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00022" num="00022">
<img id="EMI-D00022" he="240.62mm" wi="167.39mm" orientation="landscape" file="US07299500-20071120-D00022.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00023" num="00023">
<img id="EMI-D00023" he="208.79mm" wi="76.79mm" file="US07299500-20071120-D00023.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00024" num="00024">
<img id="EMI-D00024" he="234.27mm" wi="174.07mm" orientation="landscape" file="US07299500-20071120-D00024.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00025" num="00025">
<img id="EMI-D00025" he="212.17mm" wi="157.06mm" orientation="landscape" file="US07299500-20071120-D00025.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00026" num="00026">
<img id="EMI-D00026" he="149.27mm" wi="163.24mm" orientation="landscape" file="US07299500-20071120-D00026.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00027" num="00027">
<img id="EMI-D00027" he="169.67mm" wi="169.33mm" orientation="landscape" file="US07299500-20071120-D00027.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">FIELD OF THE INVENTION</heading>
<p id="p-0002" num="0001">This invention relates to electronic commerce and to methods and apparatus for distributing secure digital content to an unsecure site.</p>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Global distribution systems, such as the Internet, are increasingly being used for distribution of digital content that includes text and graphic information encoded in a variety of formats. However, copyright holders and publishers of such digital content have been slow to embrace the use of the Internet for distribution of digital content because it has been difficult to control unauthorized copying and dissemination of the content once it has been delivered onto the Internet. In particular, once content has been placed in digital form and delivered to a user, it can easily be copied, printed or forwarded to other users.</p>
<p id="p-0004" num="0003">Thus, providers of digital content desire to establish a secure, global distribution system for digital content that protects the rights of the content's copyright holders. One prior art technique for controlling the distribution of digital content is shown in <figref idref="DRAWINGS">FIG. 1</figref>. In this technique, unencrypted content is placed in a server farm that is located behind a secure firewall. A user, such as user <b>100</b> desiring access to the content stored in database <b>106</b> logs in to the server <b>104</b> using a conventional authentication scheme, such as a password or subscription service. Once connected to the server <b>104</b>, an authorized user <b>100</b> can view content and request a copy of that content as indicated by arrow <b>108</b>. In response to this request, the server <b>104</b> retrieves the information from the database <b>104</b> as indicated schematically by arrow <b>110</b> and displays the content.</p>
<p id="p-0005" num="0004">This conventional protection technique has several drawbacks. First, many users prefer to view the content with a conventional web browser. In order to display the content in such a browser, it is necessary to download a digital version of the content, as indicated schematically by arrow <b>112</b>. This digital version is typically stored, at least temporarily, in the computer, and can be printed or forwarded to other users. Therefore, in accordance with another prior art technique, in order to view the content, the conventional browser must be equipped with a plug-in, ActiveX components or another program which controls the browser and disables the printing function and prevents forwarding the content to unauthorized users. However, in order to use this system, it is necessary to first download and install the plug-in, the ActiveX libraries or other program, before the content can be viewed. In addition, since the content is not encrypted when it is downloaded to the browser, it can still be stored and then later printed or forwarded to other users.</p>
<p id="p-0006" num="0005">Another conventional protection technique is called a “secure container” system. In this system, the content is delivered to the user in an encrypted form and is decrypted at the user's site by means of a decryption key. This technique provides a solution to protecting the document during delivery over insecure channels, but has the same drawback as the firewall system in that the content must still be decrypted in order to present it to the user. The decrypted content can be stored and then later printed or forwarded to other users.</p>
<p id="p-0007" num="0006">In both of these prior art systems, all of the content is located at the publisher's location. Thus, multiple and often substantial downloads from the publisher's location to the user's site are required for users to access the content. In many cases, the users are connected to an internal corporate network, or corporate intranet, that is, in turn, connected to the Internet by means of a firewall and this latter firewall often interferes with the content downloads. Further, many corporate entities find it desirable to manage the information at their own sites using their own hardware and, in many cases, proprietary software.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0008" num="0007">In accordance with the principles of the invention, a content server is located at the user's site. This server delivers content locally to users at the site and logs content access at the site. The server also provides additional content encryption, log authentication, key transfer and key management services to ensure the security and authenticity of content data without substantially interfering with the user access.</p>
<p id="p-0009" num="0008">Rather than downloading each content document on demand from the publisher location to the user site, at the publisher location, each content document is encrypted and then multiple encrypted documents are assembled into a distribution archive that is also encrypted. The distribution archive is then downloaded into the content server at the user site. When the content server receives the distribution archive, it decrypts the archive file and unpacks the encrypted documents, but does not decrypt each document. Instead, the encrypted documents are stored in encrypted form in a local document database.</p>
<p id="p-0010" num="0009">In one embodiment, when a user logs into the local content server with a conventional browser, a secure content viewer that consists of an applet is downloaded from the local content server to the user's browser. The content viewer requests a selected document from the local server by referring to the document name or URL. The server retrieves the encrypted document from the local document database and forwards it to the viewer in encrypted form. The viewer then computes a document identifier from the encrypted document content and uses the identifier to request a key from the server in order to decrypt the document. The document identifier is computed so that it identifies the encrypted file, but cannot be derived from the encrypted data in the file alone.</p>
<p id="p-0011" num="0010">The key is forwarded from the server to the viewer, which then decrypts the document and displays it in the viewer. Since the document is processed by the viewer and displayed only in a window associated with the viewer, none of the conventional browser functions has to be disabled. Further, since the document is downloaded in encrypted form, it cannot be stored or forwarded using the conventional browser.</p>
<p id="p-0012" num="0011">In another embodiment, a document identifier for each document is computed at the publisher's location from the encrypted document content and stored with the decryption key in an identifier/key list. The identifier/key list is stored in encrypted form in the distribution archive and sent to the local content server at the user site along with the encrypted document content.</p>
<p id="p-0013" num="0012">In still another embodiment, the local content server logs content access at the site including various user activities, such as login to the system, registration, creation of a user profile and the reading and printing of selected content documents. The logged activities are stored in a log file at the customer site. This log file is then sent to the publisher in return for a distribution archive containing new content. The contents of the log file can be extracted by a reporting server located at the publisher location, formatted and provided to a reporting client.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0014" num="0013">The above and further advantages of the invention may be better; understood by referring to the following description in conjunction with the accompanying drawings in which:</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a conventional content delivery system in which unencrypted content is located behind a firewall in a publisher server farm.</p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref> illustrates one embodiment of the invention in which a metrics server located at a publisher's site receives requests for content from the publisher's server and delivers encrypted content to a viewer located in a user browser.</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 3</figref> is a block schematic diagram that shows a more detailed view of the viewer and the architecture of the metrics server.</p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIGS. 4A and 4B</figref>, when placed together, form a flowchart showing the steps of an illustrative process by which a user logins into to a metrics server, downloads and views content.</p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 5</figref> is a block schematic diagram of apparatus for calculating an object identifier.</p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 6</figref> is a flowchart showing the steps of an illustrative process for calculating an object identifier using the apparatus of <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 7</figref> is a flowchart showing the steps of an illustrative process by which a metrics publishing tool prepares a single document for distribution.</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 8</figref> is a block schematic diagram illustrating the major components of a metrics publishing tool.</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 9</figref> is a block schematic diagram of apparatus for generating a scrambled text file.</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 10</figref> is a flowchart showing the steps of an illustrative process for generating a scrambled text file using the apparatus of <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIGS. 11A and 11B</figref> are separate flowcharts that respectively illustrate the operation of the fragmenter and the text assembler of <figref idref="DRAWINGS">FIG. 9</figref>.</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 12</figref> is a block schematic diagram of an inventive content distribution system operating in distributed mode.</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIGS. 13A and 13B</figref>, when placed together, form a flowchart showing the steps of an illustrative process performed by a metrics publishing tool for encrypting documents in the preparation of a distribution archive.</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIGS. 14A and 14B</figref>, when placed together, form a flowchart showing the steps of an illustrative process performed by a metrics publishing tool for packaging the encrypted documents and identifying information into a distribution archive.</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 15</figref> is a block schematic diagram illustrating the major components of an update manager in a customer site server.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIGS. 16A and 16B</figref>, when placed together, form a flowchart showing the steps of an illustrative process performed by the update manager in lading and unpacking a distribution archive received by a customer site server.</p>
<p id="p-0031" num="0030"><figref idref="DRAWINGS">FIG. 17</figref> is a block schematic diagram of the major components of a logging apparatus, illustrating the signing of log entries.</p>
<p id="p-0032" num="0031"><figref idref="DRAWINGS">FIG. 18</figref> is a flowchart showing the steps of an illustrative process for signing a log entry using the apparatus of <figref idref="DRAWINGS">FIG. 17</figref>.</p>
<p id="p-0033" num="0032"><figref idref="DRAWINGS">FIG. 19</figref> is a block schematic diagram illustrating the major components involved in creating a forwarding e-mail message and processing a URL received in a forwarding server.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 20</figref> is a flowchart showing the steps of an illustrative process for processing a URL received in a forwarding server using the apparatus of <figref idref="DRAWINGS">FIG. 19</figref>.</p>
<p id="p-0035" num="0034"><figref idref="DRAWINGS">FIG. 21</figref> is a block schematic diagram of an embodiment of the invention in which a metrics server located at an application service provider site receives content from several publishers and requests for content from the publisher's server and delivers encrypted content to a viewer located in a user browser.</p>
<p id="p-0036" num="0035"><figref idref="DRAWINGS">FIG. 22</figref> is a block schematic diagram of still another embodiment in which encrypted content data is stored locally on a user's computer and is decrypted and displayed in a secure viewer using decryption keys that are downloaded from a networked server.</p>
<p id="p-0037" num="0036"><figref idref="DRAWINGS">FIG. 23</figref> is a block schematic diagram of yet another embodiment in which encrypted content data, a secure viewer and encrypted decryption keys are stored locally on a user's computer.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0038" num="0037">The inventive content distribution system, which is called hereinafter a “metrics system”, can be configured to run in one of two modes, including a publisher-hosted mode and a distributed mode. In the publisher-hosted mode, the entire distribution system is located at the publisher's premises, whereas in the distributed mode portions of the distribution system are located-on the user's premises. These modes are described in more detail below. A content publisher chooses the configuration that best meets its desired business model, and deploys or configures the application software accordingly.</p>
<p id="p-0039" num="0038">A block schematic diagram of the content distribution system configured in the publisher-hosted mode is shown in <figref idref="DRAWINGS">FIG. 2</figref>. A user operating a workstation <b>200</b> accesses the distribution system over a network through a conventional browser program. Browser programs that are suitable for use with the invention include Microsoft Internet Explorer, Netscape, Opera or other Java 1.1 compatible browsers. Using the browser, the user requests a document either by a file name or by a URL as indicated schematically by arrow <b>208</b>. This request is received in the publisher's location <b>202</b> by the publisher's content server <b>204</b>. However, rather than accessing the content data <b>230</b> directly as in the prior art, the publisher's content server <b>204</b> refers the request to a metrics content server <b>214</b> as indicated schematically by arrow <b>210</b>. The metrics content server <b>214</b> provides access to the publisher's content stored in database <b>230</b>. It also creates a log file <b>216</b> that records various user activities, including login to the system, registration, creation of a user profile and the reading and printing of selected content.</p>
<p id="p-0040" num="0039">The contents of log file <b>216</b> can be extracted and formatted by a metrics reporting server <b>218</b> and provided to a reporting client <b>222</b> as indicated schematically by arrow <b>220</b>.</p>
<p id="p-0041" num="0040">More specifically, the first time a user <b>200</b> accesses the metrics contents server <b>214</b>, a registration file is created. This file includes user identifying information, such as a user ID, and a password, that the user will utilize to access the system. This information is stored in a metrics user database <b>226</b> as indicated schematically by arrow <b>224</b>. The information in the metrics user database <b>226</b> is used later to authenticate users who are requesting access to the publisher content.</p>
<p id="p-0042" num="0041">The metrics content server <b>214</b> interacts with a publisher content database <b>230</b> as indicated by arrow <b>228</b>. Each piece of content in the publisher content database <b>230</b> has been processed by encrypting the document and providing a unique identifier called an object identifier (OID) that uniquely identifies that piece of content. This processing is performed by a metrics publishing tool <b>232</b> that receives the output of the publisher's conventional publishing process <b>234</b>. The metrics publishing tool encrypts documents for distribution via the distribution system. The process takes content files (and optionally content metadata files) as input and generates an encrypted document package, document identifier and key data as output. The encrypted output is generated in one of two forms depending on the configuration of the distribution system.</p>
<p id="p-0043" num="0042">Document level encryption is used when the metrics content server is running at the publisher's own trusted site. In this case, the encryption can be performed in a batch process in order to protect entire collections of content in a single off-line operation. Alternatively, individual files can be dynamically encrypted as they are requested. Distribution level encryption can be used when a portion of the distribution system is running at a customer site. In the distribution-level encryption model, the publisher performs batch processing on content to prepare encrypted bundles or archives that contain document collections. The archives can then be distributed to customers either on portable media, such as compact disks, or via network downloads, for example, via the FTP protocol.</p>
<p id="p-0044" num="0043">In either the publisher-hosted or the distributed modes, a user accesses the content in the same manner. <figref idref="DRAWINGS">FIG. 3</figref> shows a more detailed schematic block diagram illustrating the system components involved in a typical request and delivery of content. In this figure, a user at user workstation <b>300</b> interacts with a metrics server <b>314</b> that could be located at a publisher or user premises by means of a conventional web browser <b>340</b> running the work station <b>300</b>. The steps involved in this process are illustrated in <figref idref="DRAWINGS">FIGS. 4A and 4B</figref> which, when placed together, form a flowchart illustrating the request and delivery of content with the inventive system.</p>
<p id="p-0045" num="0044">As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the metrics server <b>314</b> hosts a web server <b>352</b>, which actually performs the functions of login, registration and delivery of encrypted content and corresponding decryption keys. This web server can be a conventional web server that acts as a container for a collection of servlets that actually perform the processing. Web server software suitable for use with the present invention is the Tomcat web server available from the Apache Software Foundation, 1901 Munsey Drive, Forest Hills, Md. 21050-2747.</p>
<p id="p-0046" num="0045">Servlets are programs that run within the web server and process requests from an HTTP client. The servlet container that is bundled with the Tomcat web server supports all servlet activity. In this architecture, the servlet container provides the appropriate libraries to process requests. The servlet container contains four main servlets that perform login, registration and content transfer. These include the login servlet <b>354</b>, the register servlet <b>356</b>, the request content servlet <b>348</b> and the request key servlet <b>350</b>. The operation of these servlets is described in conjunction with the flowchart illustrated in <figref idref="DRAWINGS">FIGS. 4A and 4B</figref>.</p>
<p id="p-0047" num="0046">The content request and delivery process begins in step <b>400</b> and proceeds to step <b>402</b> where a user desiring a presentation of selected content contacts a publishing service or a web farm to request the content by means of a file name or URL or other identifier. In step <b>404</b>, this request is forwarded to the metrics server <b>314</b>. In step <b>406</b>, the metrics server uses the login servlet <b>354</b> to determine whether the user has previously registered with the system. If not, the register servlet <b>356</b> is used to update the user data files <b>326</b>, create a user profile and register the user as set forth in step <b>408</b>.</p>
<p id="p-0048" num="0047">After the user has been registered, the metrics server <b>314</b> downloads a metrics viewer applet to the web browser <b>340</b> operating in the user workstation <b>300</b>. The metrics viewer <b>342</b> is an applet that retrieves and displays secured contents from the metrics server <b>314</b>. In one embodiment, this applet is a Java applet that operates in conventional browsers. The metrics viewer allows users to access content as they do in their familiar browser environments including reading, printing and emailing of content to other users while retaining control of the content. In a preferred embodiment of the viewer, the list of content use features can be changed by customization. For example, publishers preferring not to allow printing can customize the viewer applet to disable or eliminate the printing feature. In general, the viewer prevents storage of content by preventing storage of the information to the user's storage devices, such as a hard drive.</p>
<p id="p-0049" num="0048">In one embodiment, the metrics viewer supports the following features: (1) navigation within individual articles and overall navigation from article to article, (2) setting bookmarks to favorite articles, (3) e-mailing an article to a list of e-mail addresses, (4) printing selected articles, (5) logging into the metrics server and registering with the server, and (6) searching by means of a search engine located within the metrics server in installations that support server searching. These operations are initiated by a viewer GUI that includes buttons for each operation. These buttons are trapped so that user activities can be logged as discussed below.</p>
<p id="p-0050" num="0049">It should be noted that the content is only displayed in a window that is controlled by the viewer and that the viewer does not use any of the standard browser functions. Therefore, the standard browser buttons or menu selections do not affect the display or manipulation of the displayed content and need not be disabled. For example, since the content is displayed only in a window controlled by the viewer, selection of the conventional print function in the browser will print only the content portion displayed in the viewer window and not the entire content document.</p>
<p id="p-0051" num="0050">After the viewer has been downloaded, the user can then use the viewer <b>342</b> to locate desired content. A content article could be identified, for example, by document name or URL. In step <b>412</b>, the metrics viewer <b>342</b> interacts with the request content servlet <b>348</b>, as indicated schematically by arrow <b>346</b>, to request a content document. The process then proceeds, via off-page connectors <b>414</b> and <b>416</b>, to step <b>418</b> where the request content servlet <b>348</b> uses the provided document name or URL to retrieve an encrypted content file from the content files database <b>330</b>. The metrics server then downloads the encrypted file to the metrics viewer <b>342</b>.</p>
<p id="p-0052" num="0051">As set forth in step <b>420</b>, after the encrypted file has been completely downloaded, the viewer <b>342</b> computes the OID for the document. This content identifier is calculated using the encrypted content itself. Although the content identifier can be calculated in many ways, it is important that the identifier cannot be calculated from the content alone. Therefore, the content identifier is related to the content, but not directly derivable from the content.</p>
<p id="p-0053" num="0052">An exemplary architecture and process for calculating the OID are shown in <figref idref="DRAWINGS">FIGS. 5 and 6</figref>, respectively. The process begins in step <b>600</b> and proceeds to step <b>602</b> where a hash of a secret string <b>500</b> is calculated with a one-way hashing mechanism <b>504</b>. The secret string is embedded in the viewer code so that it is downloaded when the viewer is downloaded. The secret string may be obfuscated in the viewer code in a conventional manner to deter reverse engineering of the viewer code.</p>
<p id="p-0054" num="0053">The one-way hashing algorithm used by mechanism <b>504</b> to create this hash, for example, may be an SHA-1 secure hashing algorithm as described in FIPS 180-1 at the web site located at URL http://www.itl.nist.gov/fipspubs/fip180-1.htm. Then, in step <b>604</b>, a hash of the encrypted content item <b>502</b> is computed, using, for example, the SHA-1 hashing algorithm in one-way hashing mechanism <b>506</b>. In step <b>606</b>, the hash computed in step <b>602</b> is hashed with the hash computed in step <b>604</b> using, for example, the SHA-1 algorithm again in hashing mechanism <b>508</b>. The process then ends in step <b>608</b>. The resulting OID value <b>510</b> is mathematically likely to be unique to the particular encrypted file, and cannot be derived from the data in the file alone.</p>
<p id="p-0055" num="0054">Returning to <figref idref="DRAWINGS">FIG. 4B</figref>, in step <b>422</b>, the viewer requests a key for decrypting the file using the OID computed from the encrypted content. In particular, the metrics viewer <b>342</b> sends the OID to the request key servlet <b>350</b> as indicated schematically by arrow <b>344</b>. The request key servlet <b>350</b> retrieves a decryption key from the key database <b>358</b> using the OID to access the database. As set forth in step <b>424</b>, the metric server then downloads the requested decryption key corresponding to the OID to the metrics viewer <b>342</b>. Next, as set forth in step <b>426</b>, the viewer <b>342</b> uses the key to decrypt the encrypted content file. Finally, as set forth in step <b>428</b>, the viewer <b>342</b> presents the plaintext content file in the web browser <b>340</b>. The process then finishes in step <b>430</b>.</p>
<p id="p-0056" num="0055">In order to operate in the manner set forth in <figref idref="DRAWINGS">FIGS. 4A and 4B</figref>, the content files must first be encrypted and the OIDs generated. As mentioned previously, the encryption is performed by a metrics publishing tool. The steps in this process are set forth in <figref idref="DRAWINGS">FIG. 7</figref> and the internal architecture of the tool is shown in <figref idref="DRAWINGS">FIG. 8</figref>. The metrics publishing tool is responsible for encrypting the publisher's content and packaging it for distribution. The publishing tool could consist of a command-line utility, controlled through configuration files. Alternatively, it is possible to customize the publisher's publishing environment so that the publishing tool is called through an application programming interface (API).</p>
<p id="p-0057" num="0056">The publishing process involves encrypting content and providing identifiers for the encrypted content, generating decryption keys and linking the identifiers and the decryption keys so that the decryption key for a requested content document can be located. In order to provide the greatest level of flexibility and the highest level of security the encryption and key management implementations obey the following principles:
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0057">1. All encryption algorithms used are established, popular algorithms that are well-understood and believed to be strong. Examples include the Blowfish algorithm, which is a symmetric block cipher that takes a variable-length key, from 32 bits to 448 bits. This algorithm is described in an article entitled “Description of a New Variable-Length Key, 64-Bit Block Cipher (Blowfish)”, B. Schneier, <i>Fast Software Encryption, Cambridge Security Workshop Proceedings </i>(December 1993), Springer-Verlag, 1994, pp. 191-204. Another example is the RSA public key algorithm of which details are available in the Public Key Cryptography Standard (PKCS #1) of RSA Laboratories at the web site located at URL http://www.rsasecurity.com/rsalabs/pkcs/. The encryption and key management implementation does not rely on particular assumptions about any of the algorithms that it uses; that is, another algorithm, such as the Advanced Encryption Standard (AES, details available at http://csrc.nist.gov/CryptoToolkit/aes/rijndael/), could be substituted for the Blowfish algorithm, an elliptical public key algorithm could be substituted for the RSA public key algorithm, and so on.</li>
        <li id="ul0002-0002" num="0058">2. All keys are exchanged with a secure protocol. Such a protocol is the Diffie-Hellman key exchange protocol that is described in PKCS #3 available at RSA Laboratories at the web site located at URL http:/www.rsasecurity.com/rsalabs/pkcs/.</li>
        <li id="ul0002-0003" num="0059">3. Encrypted content and its decryption key are never stored or delivered together in the same file or transmission. The decryption key for a content package is delivered either at a different time from the content package, or through a different channel.</li>
        <li id="ul0002-0004" num="0060">4. The relationship between an encrypted content item and its decryption key is never stored. If an encrypted object has an identifier, then the number for its decryption key is derived through a cryptographically strong algorithm. In one embodiment, this algorithm is a variant of a one-way hash such as the aforementioned SHA-1 hash.</li>
        <li id="ul0002-0005" num="0061">5. The system uses as few explicit identifiers as possible. For example, the identifier for a content item is not stored anywhere in the system; instead, the content identifier is calculated from a variant of the encrypted form of the content using a secure hash.</li>
        <li id="ul0002-0006" num="0062">6. There are no plaintext strings in the program object code that can be used directly to compromise the security of the content.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0058" num="0063"><figref idref="DRAWINGS">FIGS. 7 and 8</figref> illustrate the operation of a publishing tool <b>800</b> in the preparation of a content package that includes a single document for distribution. This process starts in step <b>700</b> and proceeds to step <b>702</b> where the publishing tool <b>800</b> receives a content document <b>802</b> as input. A determination is made whether the content document contains text. For content items containing text, in addition to performing the normal processing, the publishing tool <b>800</b> contains a text scrambler <b>812</b> that performs special processing to create a scrambled, indexable version of the content as set forth in step <b>706</b>. This processing is described in detail below. The process then continues with the remainder of the normal processing.</p>
<p id="p-0059" num="0064">Next, in step <b>704</b>, the publishing tool <b>800</b> uses a file compressor <b>806</b> to compress the content file using a conventional compression algorithm. For example, “Flate” compression is suitable for use with the invention and is described in detail at the website located at URL http://www.gzip.org/zlib/.</p>
<p id="p-0060" num="0065">After compressing the file, the publishing tool <b>800</b> uses a key generator <b>808</b> to generate a unique content key in step <b>708</b>. For example, in one embodiment, the key generator <b>808</b> could operate with the Blowfish algorithm and this key would be a 128-bit Blowfish key. Next, in step <b>710</b>, the publishing tool <b>800</b> uses an encryption engine <b>814</b> to encrypt the content item with this unique key. Then, in step <b>712</b>, the publishing tool <b>800</b> uses an OID calculator <b>816</b> to calculate a content identifier for the encrypted content item. This content identifier is calculated from the encrypted content by the same algorithm used by the viewer and described in connection with <figref idref="DRAWINGS">FIGS. 5 and 6</figref>. In this case, the same secret string embedded in the viewer code is also embedded in the server code.</p>
<p id="p-0061" num="0066">Returning to <figref idref="DRAWINGS">FIG. 7</figref>, the OID is stored with the decryption key for the content item. In step <b>714</b>, the content key is encrypted using the key encryptor <b>810</b> with a secret key that is unique to the server. This latter encryption prevents the content key from being discovered by searching the server files. The resulting outputs <b>804</b> are then stored in the content database <b>230</b> (<figref idref="DRAWINGS">FIG. 2</figref>). The process then finishes in step <b>716</b>.</p>
<p id="p-0062" num="0067">As mentioned above, an important feature of the inventive system is the ability to offer text content in a format in which it can be indexed by third-party search utilities and yet not be available as plaintext. The text scrambler <b>812</b> uses a process called “content scrambling” to produce an “indexable version” of a composite content file. This process is illustrated in <figref idref="DRAWINGS">FIGS. 9</figref>, <b>10</b>, <b>11</b>A and <b>11</b>B. The process starts in step <b>1000</b> and proceeds to step <b>1002</b> where the text scrambler receives a composite content file <b>900</b> that may contain text and graphics. The text scrambler uses a stripper <b>902</b> to remove any formatting information and graphics, producing a stream of plain text. Thus, the text scrambler can handle mixed text and graphic formats such as HTML, Adobe PDF, and Microsoft Office documents.</p>
<p id="p-0063" num="0068">Next, in step <b>1004</b>, the text scrambler uses a parser <b>904</b> to parse the plain text stream into words. The parsing can be performed in a known manner by using delimiters such as spaces, tabs, etc. to divide the text stream into words. The parser <b>904</b> then removes the most common words from the content stream. Such words include common articles, such as “the”, “a” and “an”, conjunctions, such as “and” and “or”, and other common words. In step <b>1006</b>, a fragmenter <b>906</b> breaks the parsed content stream up into random two to five word phrases.</p>
<p id="p-0064" num="0069">The operation of the fragmenter <b>906</b> is shown in <figref idref="DRAWINGS">FIG. 11A</figref>. This operation begins in step <b>1100</b> and proceeds to step <b>1101</b> where a determination is made whether there is more text to be processed. If not, the process ends in step <b>1109</b>. Assuming there is more text to be processed, then, in step <b>1102</b>, a pseudo random integer equal to, or greater than, two and less than, or equal to, five is generated in a conventional fashion. In step <b>1104</b>, a number of words equal to the generated pseudo random number are selected from the stream and the selected words are assembled into a phrase in step <b>1106</b>. The assembled phrase is streamed out in step <b>1108</b>. The process then returns to step <b>1102</b> where a new phrase is generated starting by generating a new pseudo random number in step <b>1102</b>. Steps <b>1104</b> to <b>1108</b> are then performed to generate a new phrase. Operation continues in this fashion until the entire text stream has been processed.</p>
<p id="p-0065" num="0070">Returning to <figref idref="DRAWINGS">FIG. 10</figref>, in step <b>1008</b>, the phrases generated by the fragmenter <b>906</b> are assembled by stream assembler <b>908</b> in random order into an unpunctuated text stream. The manner in which this text stream is assembled is shown in <figref idref="DRAWINGS">FIG. 11B</figref>.</p>
<p id="p-0066" num="0071">As illustrated in <figref idref="DRAWINGS">FIG. 11B</figref>, the incoming phrases are assembled into “blocks”, each of which comprises a fixed, predetermined number of phrases. In particular, the assembly process starts in step <b>1110</b> and proceeds to step <b>1112</b> where a fixed number of 2-5 word phrases generated by the fragmenter <b>906</b> are assembled into a first block.</p>
<p id="p-0067" num="0072">Proceeding to step <b>1114</b>, the process then shifts the first block into the second block. In step <b>1116</b>, the fixed number of phrases is again assembled into the first block. At this point there exist two blocks, both holding the same fixed number of phrases, although the phrases in each block could be of different word lengths. The phrases in the first block are then paired with the phrases in the second block. For example, a phase in the first block can be paired with a phrase in the corresponding location in the second block. Next, a check is made in step <b>1120</b> to determine whether all phrase pairs have been processed. If not, the process proceeds to step <b>1122</b> where the next unprocessed phrase pair is selected. In step <b>1124</b>, a pseudo random number is generated for the phrase pair.</p>
<p id="p-0068" num="0073">In step <b>1126</b>, the generated pseudo random number is compared to a predetermined threshold. If the generated pseudo random number is greater than the threshold, then, in step <b>1128</b>, the phrase in the first block is swapped with the phrase in the second block. The process then returns to step <b>1120</b> where a decision is made whether all pairs have been processed. Alternatively, if the generated pseudo random number is less than the threshold, then the process returns directly to step <b>1120</b>.</p>
<p id="p-0069" num="0074">If, as determined in step <b>1120</b>, all phrase pairs have been processed, then in step <b>1118</b>, the second block is streamed out. In step <b>1130</b>, a decision is made whether additional phrases remain to be processed. If not, the process finishes in step <b>1132</b>. Alternatively, if additional phrases remain to be processed, then the process returns to step <b>1114</b> in which the first block is shifted into the second block and, in step <b>1116</b>, the first block is filled with the predetermined number of phrases. Operation continues in this fashion until all text phrases have been processed.</p>
<p id="p-0070" num="0075">The resulting stream contains nearly all of the words in the original content, and most of the phrases, but cannot be read. This unpunctuated text stream is enclosed in a simple HTML file <b>910</b> and stored in unencrypted form on the content server where it will be exposed to third-party indexing utilities. These utilities are allowed to crawl the content distribution to build an index of the content. Searching on particular words or phrases will still return most of the same hits as the unscrambled content. However, simply navigating straight to the target file will display to the user a scrambled content file that cannot be read.</p>
<p id="p-0071" num="0076">When scrambled content is indexed by web-crawling search engines, such as Google™, the inventive distribution system returns the scrambled content. However, when a user uses a browser to link from the search engine to the indexed page, the publisher may prefer to present to the user an e-commerce page containing an unscrambled article extract and an offer to provide the entire, unscrambled article for a purchase price. There are a number of effective techniques to direct the user to the publisher when the user links to the page. For example, browsers and search engines requesting a resource typically supply to the web server a “user agent” parameter that specifies the browser that is requesting the resource. A web server can examine the user agent parameter, and supply the scrambled content to requests containing user agent values that correspond to search engines. Alternatively, the web server can return the publisher's e-commerce page to requests containing user agent values corresponding to browsers.</p>
<p id="p-0072" num="0077">It is also possible to accomplish the same result by ending the scrambled HTML page with a call to a JavaScript routine that loads the publisher's e-commerce page. In this case, a user at a browser will see the e-commerce page immediately after the scrambled page loads. On the other hand, a search engine will ignore the JavaScript and process only the scrambled page. For cosmetic reasons, the scrambled page in this approach can also be defined to hide the scrambled text from the end user.</p>
<p id="p-0073" num="0078">As previously mentioned, the inventive content distribution system can also operate in a distributed mode in which content is provided to users at a customer site from a content server that is also located at the customer site. Such a configuration is shown in <figref idref="DRAWINGS">FIG. 12</figref>. In this configuration, a content server <b>1204</b> is located at a corporate site <b>1202</b> attached to a corporate intranet or other corporate network. An additional content server <b>1206</b> may also be located at the publisher site <b>1200</b> to provide controllable and trackable content forwarding as will hereinafter be described. The customer site content server <b>1204</b> can also provide content searching capabilities using a conventional search engine such as the Apache Lucene open-source search engine. The content is indexed at load time, using the scrambled text files generated as described below.</p>
<p id="p-0074" num="0079">The content server <b>1204</b> at the customer site manages clients and users at the customer site, performs secure key exchanges with authenticated clients and logs all usage events for later upload to a metrics reporting server. Contrary to the publisher-hosted mode, content is distributed from the publisher's site to the user content server, as indicated schematically by arrow <b>1216</b>, in blocks of content documents called content distribution archives. Archives might be distributed to customer sites in return for log file information gathered at the customer site as indicated schematically by arrow <b>1218</b>. The return of log information from the customer site allows the publisher to track content usage at the customer site and to track content forwarding as described below.</p>
<p id="p-0075" num="0080">As well as containing encrypted documents, the distribution archive is itself encrypted. Consequently, the customer site content server <b>1204</b> must unpack the archive and store the encrypted content and keys in the encrypted content database <b>1234</b> as schematically indicated by arrow <b>1238</b>. In order to decrypt the archive during the content loading process, the customer site content server <b>1204</b> uses a “scheduled key” to decrypt the archive. The scheduled key for an archive is contained in a previous archive file that was received by the customer. The first time that content is loaded into the customer site server <b>1204</b>, the scheduled key must be obtained from the publisher, as described below.</p>
<p id="p-0076" num="0081">In addition to containing the encrypted content files, the archive contains various keys and an OID to decryption key mapping. The OID/Key mapping is also encrypted with the scheduled key. During the unloading process, the encrypted content files are extracted, but not decrypted. The encrypted files are stored in database <b>1234</b> and still bear the same names that they did before encryption, but there is no explicit cross-reference between the encrypted files and their decryption keys. In order to find the key that decrypts a given file name, the server receives an OID for the file from a client who is requesting content, then uses the received OID to look up the corresponding key in the OID/Key mapping. The unloading process is described in more detail below.</p>
<p id="p-0077" num="0082">The customer site server <b>1204</b> acts as a conventional server in a client/server application, performing password-based authentication and storing user data in the metrics user database <b>1232</b> as indicated schematically by arrow <b>1236</b>. Data is transferred from the client to the server using the regular HTTP protocol; in cases where the data is secure, encryption is applied to the HTTP payload, rather than using a secure protocol such as SSL. Each client, of which clients <b>1220</b>-<b>1224</b> are shown in <figref idref="DRAWINGS">FIG. 12</figref>, can contact the server <b>1204</b> as indicated schematically by arrows <b>1226</b>, <b>1228</b> and <b>1236</b>, respectively, and retrieve content using a process similar to that illustrated in <figref idref="DRAWINGS">FIGS. 4A and 4B</figref> and described in connection with the publisher-based system of <figref idref="DRAWINGS">FIGS. 2 and 3</figref>.</p>
<p id="p-0078" num="0083">In order to package content documents into a content archive, the publisher uses the publishing tool described above in connection with <figref idref="DRAWINGS">FIG. 8</figref> that follows the process set forth in <figref idref="DRAWINGS">FIGS. 13A</figref>, <b>13</b>B and <b>14</b>A, <b>14</b>B. The process set forth in <figref idref="DRAWINGS">FIGS. 13A and 13B</figref> illustrates an exemplary process for encrypting the content files. The process set forth in <figref idref="DRAWINGS">FIGS. 14A and 14B</figref> shows an exemplary process for packaging the encrypted content files into a distribution archive.</p>
<p id="p-0079" num="0084">Generally, the publisher's normal content preparation workflow results in a collection of content files, content files and directories, or compressed content file archives in a location known to the preparation program and specified in a configuration file. Publishers can elect to prepare separate distributions for every customer, with, if desired, different content subsets for each. In this case, a separate configuration file is maintained for each customer. The content preparation process starts in step <b>1300</b> and proceeds to step <b>1302</b> where the publishing tool examines each file in the content directories, or in the compressed content file archive in a location specified in the customer configuration file. In step <b>1304</b>, a determination is made whether any files remain to be processed. If all files have been processed, then the process ends in step <b>1306</b>.</p>
<p id="p-0080" num="0085">Alternatively, if files remain to be processed, for each content item in the content collection, the publishing tool extracts the file as set forth in step <b>1308</b>. Then the file is examined and, in step <b>1310</b>, a determination is made whether the file contains text. For content items containing text, in addition to performing the normal processing, the publishing tool contains a text scrambler <b>812</b> that performs special processing to create an indexable version of the content as set forth in step <b>1314</b>. This processing is described in detail above in connection with <figref idref="DRAWINGS">FIGS. 9</figref>, <b>10</b>, <b>11</b>A and <b>11</b>B. After generating the scrambled file, the process proceeds, via off-page connectors <b>1322</b> and <b>1328</b>, to step <b>1338</b> where the scrambled file is added to the distribution archive package as described below.</p>
<p id="p-0081" num="0086">Next, in step <b>1312</b>, the content file is compressed in the file compressor <b>806</b> using, for example, the aforementioned Flate compression algorithm. Then, in step <b>1316</b>, a key generator <b>808</b> in the publishing tool <b>800</b> generates a unique 128-bit content encryption key, using, for example, the aforementioned Blowfish algorithm. The process proceeds, via off-page connectors <b>1320</b> and <b>1326</b> to step <b>1330</b> where the publishing tool <b>800</b> encrypts the compressed content item with the unique content key generated in step <b>1316</b> using the encryption engine <b>814</b>.</p>
<p id="p-0082" num="0087">The publishing tool <b>800</b> then calculates a content identifier for the content item as set forth in step <b>1332</b> with the OID calculator <b>816</b>. This process is described above in connection with <figref idref="DRAWINGS">FIGS. 7 and 8</figref>. The resulting value is mathematically likely to be unique to the particular encrypted file, and cannot be derived from the data in the file alone. The OID is used as the content identifier, and is stored with an encrypted content key for the content item.</p>
<p id="p-0083" num="0088">Then, in step <b>1334</b>, the content key is encrypted with the key encryptor <b>810</b> using the aforementioned Blowfish algorithm. Then, in step <b>1336</b>, the computed OID and the encrypted content key are appended to a cache corresponding to the archive file. Specifically, the publishing tool caches a list of keys and OIDs as it encrypts every content file. This cache is called an OID/Key mapping.</p>
<p id="p-0084" num="0089">After each content item is encrypted in step <b>1330</b>, the resulting encrypted data is stored in a compressed file, the distribution archive, under the same name and in the same relative position: under the archive root as the position of the original file in the original content file. This is accomplished in step <b>1338</b>. The process then returns, via off-page connectors <b>1324</b> and <b>1318</b> back to step <b>1304</b> to determine if additional files need to be processed. Operation continues in this manner until all files have been processed. The result is an archive file containing encrypted content files and an OID/Key mapping for each file. These two files are then packaged into the final distribution archive by the process shown in <figref idref="DRAWINGS">FIGS. 14A and 14B</figref>.</p>
<p id="p-0085" num="0090">There are two slightly different processing flows for content packaging, depending on whether a particular subscription or distribution (to a particular customer or group of customers) is the first distribution to that customer or is a subsequent distribution to that customer. In particular, during the packaging process, the OID/Key mapping is encrypted with the aforementioned scheduled key. A new scheduled key is included with each distribution archive. This new key will be used to decrypt the next distribution archive received by the customer. Therefore, the first time a particular customer receives a distribution archive, the customer will not have the scheduled key and it will be necessary to send the required key to the customer. After the first distribution archive has been received, the customer will have the scheduled key that was delivered in the previous distribution archive.</p>
<p id="p-0086" num="0091">The packaging process begins in step <b>1400</b> and proceeds to step <b>1402</b> where a decision is made whether the customer to which the archive is being sent already has the scheduled key. If this is not the first distribution, then the process proceeds to step <b>1410</b>, which is discussed below. If the intended customer does not have the scheduled key, the process proceeds to step <b>1404</b> where the publishing tool <b>800</b> generates a new scheduled key using the key generator <b>808</b>. For example, this key may be a 128-bit Blowfish key. In step <b>1406</b>, this new scheduled key is encrypted using the key encryptor <b>810</b> and, for example, the Blowfish algorithm and a secret key internal to the server. This encrypted key is not added to the archive, but it is stored in a separate file. The encryption prevents the scheduled key from being discovered by searching the server files. The unencrypted key is also sent to the customer via a channel that is separate from the channel used to send the distribution archive. For example, the scheduled key may be e-mailed to the customer as set forth in step <b>1408</b>.</p>
<p id="p-0087" num="0092">When the distribution archive is to be packaged, in step <b>1410</b> the scheduled key is retrieved from storage and decrypted using the secret server key. The process then proceeds, via off-page connectors <b>1412</b> and <b>1414</b>, to step <b>1416</b> where the publishing tool <b>800</b> encrypts the OID/Key mapping using the encryption engine <b>814</b> with the scheduled key before adding the mapping to the distribution archive in step <b>1418</b>.</p>
<p id="p-0088" num="0093">The publishing tool in step <b>1420</b> generates yet another key using the key generator <b>808</b> (for example, a 128-bit Blowfish key), called the new scheduled key. This new scheduled key is stored in the distribution archive in step <b>1422</b> and will be used by the customer to decrypt the next distribution archive that is received. Next, in step <b>1424</b>, the scheduled key is used to encrypt the entire distribution archive using the encryption engine <b>814</b>. The new scheduled key is also encrypted with a secret server key in step <b>1426</b> and stored in a configuration file for the customer in step <b>1428</b>. The process then ends in step <b>1430</b>. At this point, the distribution archive is complete and ready for publication to its customer or customers.</p>
<p id="p-0089" num="0094">The use of the scheduled keys and next scheduled keys builds a chain of distribution files. However, if a customer misses a distribution or loses a distribution archive file, it will be impossible for the customer to load any subsequent distribution archive files. If this occurs, the customer must contact the publisher and request a new distribution. The publisher then creates a “first-time” distribution archive, with its explicit scheduled key, and transfers the archive and the scheduled key to the customer via separate channels (for example, the archive can be sent via FTP and the key can be sent via e-mail).</p>
<p id="p-0090" num="0095">Returning to <figref idref="DRAWINGS">FIG. 12</figref>, when the customer site server <b>1204</b> receives a distribution archive it must “unpack” the archive before users can access the content therein. The unpacking process is performed by an update manager and is illustrated in <figref idref="DRAWINGS">FIGS. 15</figref>, <b>16</b>A and <b>16</b>B. <figref idref="DRAWINGS">FIG. 15</figref> illustrates the internal architecture of the update manager <b>1500</b> in more detail. The process begins in step <b>1600</b> and proceeds to step <b>1602</b> where the update manager <b>1500</b> uses a key decryptor <b>1502</b> to decrypt the scheduled key received with the distribution archive file that was previously received. Then, in step <b>1604</b>, the decrypted new scheduled key is used in the decryption engine <b>1508</b> to decrypt the distribution archive file. The resulting decrypted file contains the encrypted content files, the scrambled content files, an encrypted OID/Key list and an encrypted new scheduled key.</p>
<p id="p-0091" num="0096">In step <b>1606</b>, the manager <b>1500</b> uses a file decompressor <b>1516</b> to extract the encrypted content files <b>1522</b>. These files <b>1522</b> are then stored in the content database <b>1234</b> located at the customer site. Next, as set forth in step <b>1608</b>, the file decompressor <b>1516</b> is used to extract the scrambled content files <b>1524</b>. These files <b>1524</b> are then stored in the customer site server in a location at the customer site that will be accessible to third party search engines.</p>
<p id="p-0092" num="0097">In step <b>1610</b>, the file decompressor <b>1516</b> is used to extract the encrypted OID/Key list <b>1526</b> from the distribution archive file. An OID/Key list decryptor <b>1528</b> decrypts the OID/Key list using the new scheduled key obtained in step <b>1602</b>. The process then proceeds, via off-page connectors <b>1614</b> and <b>1616</b>, to step <b>1618</b> where the OID/Key map <b>1506</b> already existing in the customer site server is checkpointed using checkpointer <b>1510</b>. The checkpointer <b>1510</b> establishes a base state of the map before changes are made so that the map can be returned to its original state if errors occur during the addition of the new OID/Key values received in the archive file.</p>
<p id="p-0093" num="0098">The existing OID/Key map is then cloned by cloner <b>1512</b> in step <b>1620</b> to produce a map clone <b>1518</b>. The new OID/Key entries produced by the OID/Key list decryptor <b>1528</b> are then added to the map clone <b>1518</b> in step <b>1622</b>. In step <b>1624</b>, the checkpointer <b>1510</b> is used to checkpoint the map clone <b>1518</b>. If the checkpointing succeeds, then, in step <b>1626</b>, the map clone with the added entries <b>1518</b> is adopted by overwriting the existing OID/Key map <b>1506</b> in step <b>1626</b> and as schematically illustrated by arrow <b>1514</b>. Finally, in step <b>1628</b>, the file decompressor <b>1516</b> is used to extract the new scheduled key <b>1520</b> from the distribution archive file for use in decrypting the next distribution archive file. The process then ends in step <b>1630</b>.</p>
<p id="p-0094" num="0099">Returning to <figref idref="DRAWINGS">FIG. 12</figref>, the client site server <b>1204</b> logs all client activity that occurs at the customer site in a plaintext log file <b>1240</b> as indicated schematically by arrow <b>1242</b>. Such activity could include accessing and opening a document, selecting a document, searching or printing a document. The log file <b>1240</b> is kept in plaintext so that privacy-conscious customers are able to verify that the log file does not report confidential data. In order to reduce the possibility of file corruption or deliberate modification, the logging apparatus in the server signs each log file entry according to the process illustrated in <figref idref="DRAWINGS">FIGS. 17 and 18</figref>. The process starts in step <b>1800</b> and proceeds to step <b>1802</b> where the logging apparatus <b>1700</b> generates a sequential sequence number by means of the sequence number generator <b>1702</b>. This number might be a sequential integer. Then, in step <b>1804</b>, the generated sequence number is appended to the current log record <b>1706</b>, (which includes the log record data <b>1706</b> and the timestamp <b>1708</b>) by the appender <b>1704</b>.</p>
<p id="p-0095" num="0100">Next, in step <b>1806</b>, the logging apparatus <b>1700</b> uses a signature generator <b>1720</b> to generate a message authentication code (MAC) <b>1718</b> based on the sequence number <b>1710</b> appended to the current log record <b>1712</b>, the current log record data <b>1712</b>, the timestamp <b>1716</b> of the current log record and the sequence number <b>1722</b> appended to the previous log record <b>1724</b>. This signature <b>1718</b> is then appended to the current log record <b>1712</b> in step <b>1808</b>. A MAC is an alternative to digital signatures for ensuring data integrity when the protected data is stored locally or when sender and recipient share a secret string or key. A MAC computation is similar to hashing, except that a key is used in the computation so that only someone who knows the key can create or verify a MAC.</p>
<p id="p-0096" num="0101">In a preferred embodiment, the MAC can be generated by an algorithm called a salted hash algorithm. A salted hash algorithm is a secure hash that has been pre-populated with a secret string. Illustratively, the secure hash algorithm can be the SHA-1 secure hash algorithm discussed above. Other algorithms, such as the SHA-256 or SHA-512 algorithms, could also be used. In addition, other alternative embodiments could use DSS or other signature standards, such as HMAC, instead of the salted hash algorithm. The secret string is known only to the publisher so that only the publisher can verify the MAC.</p>
<p id="p-0097" num="0102">Finally, the entire log entry <b>1714</b> is entered into the log in step <b>1810</b>. The process then finishes in step <b>1812</b>.</p>
<p id="p-0098" num="0103">In accordance with another aspect of the invention, in the distributed mode, a client can “forward” a content document to one or more recipient e-mail addresses, including addressees who are not part of the client's corporate network. This forwarding process allows the recipients to access the specified content without losing the content protection. It also allows the inventive distribution system to track usage activity of recipient users in the same fashion as previously-registered users. This process is illustrated in <figref idref="DRAWINGS">FIGS. 19 and 20</figref>. An overall view of the process is illustrated in <figref idref="DRAWINGS">FIG. 19</figref>. The steps in receiving and processing the content document identification information from the e-mail recipient are shown in <figref idref="DRAWINGS">FIG. 20</figref>.</p>
<p id="p-0099" num="0104">The process begins when a user logged into a customer site server (for example server <b>1204</b>, <figref idref="DRAWINGS">FIG. 12</figref>) at a customer site <b>1900</b> uses the metrics viewer operating in his browser to send an e-mail to another user in order to “forward” a selected content document. The metrics viewer communicates to the customer site server <b>1204</b> to prepare an email with a link to the original publisher site <b>1902</b>. The customer site server <b>1204</b> uses a sender ID generator <b>1904</b> to generate a sender ID. Generally, the sender ID would be a text string identifying the sender and the sender's corporate network. Next, the server <b>1204</b> uses a recipient ID generator <b>1906</b> to generate a recipient ID. Generally, the recipient ID would be a text string identifying the recipient and the recipient's corporate network.</p>
<p id="p-0100" num="0105">Then, the server <b>1204</b> uses a document ID generator <b>1908</b> to generate an ID identifying the content document that will be forwarded. This content ID might be the document name or URL. A concatentator <b>1910</b> concatenates the three IDs and the ID information is encrypted with an encryptor <b>1912</b>. In one embodiment, this latter encryption might be RSA public key encryption using the public key of the publisher site that originated the content document. The encrypted ID string is then inserted into a URL that appears as a link when the e-mail arrives in the recipient's e-mail program or browser Subsequently, the e-mail <b>1918</b> is sent to the recipient.</p>
<p id="p-0101" num="0106">When the recipient clicks on the link to the publisher in the e-mail, a supported browser is opened and the browser navigates to a “forwarding” metrics server in the publisher's site. This server might be server <b>1206</b> in publisher site <b>1200</b> as shown in <figref idref="DRAWINGS">FIG. 12</figref>. During this process, the URL in the e-mail is sent to the server and processed as set forth in <figref idref="DRAWINGS">FIG. 20</figref>. The server then downloads the metrics viewer described previously into the recipient's browser and launches the viewer as hosted by the server. The recipient then logs into the server <b>1206</b> and registers in the fashion described above.</p>
<p id="p-0102" num="0107">Processing of the URL received at the forwarding server <b>1206</b> starts in step <b>2100</b> and proceeds to step <b>2102</b> where the URL is received from the e-mail recipient. In step <b>2104</b>, the forwarding server at the publisher site <b>1902</b> uses an extractor <b>1920</b> to extract the ID information from the URL. Next, in step <b>2106</b>, a decryptor in the forwarding server decrypts the ID information using the private key of the public/private key pair in the publisher site. Then, in step <b>2108</b>, a document ID extractor extracts the document ID from the decrypted ID information. The forwarding server uses the document ID to locate the encrypted document information in the encrypted content database <b>1234</b>. The encrypted content information and accompanying OID are then sent to the e-mail recipient's metrics viewer as set forth in step <b>2110</b>. The process then finishes in step <b>2112</b>. Operation then proceeds as set forth in <figref idref="DRAWINGS">FIGS. 4A and 4B</figref>.</p>
<p id="p-0103" num="0108">The forwarding server <b>1206</b> can also log the sender's and recipient's ID information in a local log file <b>1208</b> as indicated schematically by arrow <b>1210</b>. In this manner the forwarding of content can be tracked. The information in log file <b>1208</b> and the information in log file <b>1240</b> can then be provided to a metrics reporting server (not shown in <figref idref="DRAWINGS">FIG. 12</figref>) that catalogs and formats the information to prepare reports.</p>
<p id="p-0104" num="0109">A block schematic diagram of another embodiment of the inventive content distribution system is shown in <figref idref="DRAWINGS">FIG. 21</figref>. In this embodiment, the metrics server <b>2206</b> is hosted by a third party, called an application service provider <b>2204</b>. One or more publishers, <b>2330</b>, <b>2232</b>, periodically upload new content to the application service provider <b>2204</b> using conventional means, such as CDs or network transfers, as indicated schematically by arrows <b>2226</b> and <b>2228</b>, respectively. Content received from the publishers at the application service provider <b>2204</b> is processed by a publishing tool <b>2224</b> located at the application service provider location <b>2204</b> in order to generate encrypted content. The encrypted content is stored in databases <b>2218</b> at the application service provider location <b>2204</b>, as indicated schematically by arrow <b>2222</b>.</p>
<p id="p-0105" num="0110">In this embodiment, a document identifier is computed by the metrics server <b>2206</b> at the application service provider site <b>2204</b> from the encrypted content and stored with a decryption key. Users <b>2200</b> and <b>2202</b> interested in receiving the content log into the metrics server <b>2206</b> at the application service provider site <b>2204</b> as indicated schematically by arrows <b>2208</b> and <b>2210</b>, respectively. As indicated schematically by arrow <b>2214</b>, the metrics server <b>2206</b> retrieves user information and profiles from the metrics user database <b>2212</b> located at the application service provider site <b>2204</b> and uses this information to log in the users as described above. During the login procedure, secure content viewer software (not shown in <figref idref="DRAWINGS">FIG. 21</figref>) is downloaded into the user's local browser. In order to access the content, the content viewer requests a selected document from the application service provider server <b>2206</b> by referring to a document name or URL. As indicated schematically by arrow <b>2216</b>, the server <b>2206</b> retrieves the document from the content database <b>2218</b> and forwards it to the viewer in encrypted form. The viewer then computes a document identifier from the encrypted document content and uses the identifier to request a key from the server <b>2206</b> in order to decrypt the document. The key is forwarded from the server <b>2206</b> to the viewer, which then decrypts the document and displays it in the viewer.</p>
<p id="p-0106" num="0111">The metrics server <b>2206</b> at the application service provider site <b>2204</b> can also generate a usage log <b>2220</b> in order to track login to the system, registration, creation of a user profile and the reading and printing of selected content.</p>
<p id="p-0107" num="0112">Still another embodiment is illustrated in <figref idref="DRAWINGS">FIG. 22</figref>. In this embodiment, a user can elect to store encrypted content in a database <b>2314</b> located on his or her computer <b>2304</b>. For example, the content may be delivered from a publisher site <b>2302</b> by conventional means, such as CDs or DVDs. In order to view the content, the user must log in to a metrics key server <b>2316</b> located at the publisher's site <b>2302</b> or another central location using a conventional browser <b>2304</b>, as indicated schematically by arrow <b>2308</b>. During the login procedure, the secure content viewer software <b>2306</b> is downloaded over the network into the user's browser <b>2306</b> as indicated schematically by arrow <b>2310</b>. In response to information from the user identifying a document, the content viewer <b>2306</b> reads the encrypted content from the local database <b>2314</b>, and computes a document identifier from the encrypted content in a manner previously discussed. The viewer <b>2306</b> then sends the document identifier to the key server <b>2316</b> in order to retrieve decryption keys from the key database <b>2318</b>. The decryption keys are then used to decrypt the encrypted content in the secure viewer software <b>2306</b>.</p>
<p id="p-0108" num="0113">Still another embodiment is illustrated in <figref idref="DRAWINGS">FIG. 23</figref> in which encrypted content data is stored in a local database <b>2410</b> on the user's computer <b>2400</b>. The secure content viewer software <b>2404</b> is also stored on the user's computer <b>2400</b>. Decryption keys along with document identifiers may also be stored in a key database <b>2412</b> in encrypted form on the user's computer. For example, the decryption keys may be encrypted with a key that is embedded in the viewer software <b>2404</b>. Alternatively, the decryption keys may be retrieved from a networked key server (not shown in <figref idref="DRAWINGS">FIG. 24</figref>) as described in the previous embodiment. In response to information from the user identifying a document, the content viewer <b>2404</b> reads the encrypted content from the local database <b>2410</b>, and computes a document identifier from the encrypted content in a manner previously discussed. The viewer <b>2404</b> then retrieves an encrypted decryption key from the local key database <b>2412</b>. The decryption keys are then used to decrypt the encrypted content in the secure viewer software <b>2404</b>.</p>
<p id="p-0109" num="0114">A software implementation of the above-described embodiment may comprise a series of computer instructions either fixed on a tangible medium, such as a computer readable media, for example, a diskette, a CD-ROM, a ROM, or a fixed disk, or transmittable to a computer system via a modem or other interface device over a transmission path. The transmission path either may be tangible lines, including but not limited to, optical or analog communications lines, or may be implemented with wireless techniques, including but not limited to microwave, infrared or other transmission techniques. The transmission path may also be the Internet. The series of computer instructions embodies all or part of the functionality previously described herein with respect to the invention. Those skilled in the art will appreciate that such computer instructions can be written in a number of programming languages for use with many computer architectures or operating systems. Further, such instructions may be stored using any memory technology, present or future, including, but not limited to, semiconductor, magnetic, optical or other memory devices, or transmitted using any communications technology, present or future, including but not limited to optical, infrared, microwave, or other transmission technologies. It is contemplated that such a computer program product may be distributed as a removable medium with accompanying printed or electronic documentation, e.g., shrink wrapped software, pre-loaded with a computer system, e.g., on system ROM or fixed disk, or distributed from a server or electronic bulletin board over a network, e.g., the Internet or World Wide Web.</p>
<p id="p-0110" num="0115">Although an exemplary embodiment of the invention has been disclosed, it will be apparent to those skilled in the art that various changes and modifications can be made which will achieve some of the advantages of the invention without departing from the spirit and scope of the invention. For example, it will be obvious to those reasonably skilled in the art that, in other implementations, process operations different from those shown may be performed. Other aspects, such as the specific process flow and the order of the illustrated steps, as well as other modifications to the inventive concept are intended to be covered by the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method for rights management of digital content and secure delivery of digital content documents from a publisher site to an unsecure site, the method comprising:
<claim-text>(a) encrypting each digital content document at the publisher site with a key to generate encrypted document content;</claim-text>
<claim-text>(b) computing for each document, from the encrypted document content for that document, a document identifier that cannot be derived solely from the encrypted version of the requested document;</claim-text>
<claim-text>(c) creating a list of document identifier and decryption key pairs;</claim-text>
<claim-text>(d) assembling the encrypted document content for each content document and the list into a distribution archive;</claim-text>
<claim-text>(e) encrypting the distribution archive with a scheduled key;</claim-text>
<claim-text>(f) installing a content server at the unsecure site; and</claim-text>
<claim-text>(g) sending the distribution archive from the publisher site to the content server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein step (a) comprises compressing each document before encrypting the document.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein step (b) comprises computing a document identifier from the encrypted document content and a text string at the publisher site.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>(h) at the unsecure site, decrypting the distribution archive with the scheduled key, extracting the encrypted document content and storing the encrypted document content in a storage located at the unsecure site.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00004">claim 4</claim-ref> wherein a user at the unsecure location accesses the content server from a browser and wherein the method further comprises:
<claim-text>(i) downloading a secure viewer program into the browser;</claim-text>
<claim-text>(j) using the viewer program to request a document from the content server;</claim-text>
<claim-text>(k) downloading an encrypted version of the requested document from the content server to the viewer; and</claim-text>
<claim-text>(l) using the viewer to calculate a document identifier from the encrypted version of the requested document and to send the document identifier to the content server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00005">claim 5</claim-ref> further comprising:
<claim-text>(m) using the document identifier in the content server to retrieve a decryption key from the list and downloading the decryption key to the viewer program; and</claim-text>
<claim-text>(n) using the downloaded key in the viewer program to decrypt the encrypted version of the document and present the document to the user.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>(h) monitoring content access at the unsecure site; and</claim-text>
<claim-text>(i) creating a log file at the unsecure site from the monitored activities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref> further comprising:
<claim-text>(j) sending the log file to the publisher site in return for a distribution archive containing new content.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method of <claim-ref idref="CLM-00008">claim 8</claim-ref> further comprising:
<claim-text>(k) extracting the contents of the log file at the publisher site;</claim-text>
<claim-text>(l) formatting the extracted contents and providing a report from the formatted contents to a reporting client.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method of <claim-ref idref="CLM-00007">claim 7</claim-ref> wherein step (h) comprises monitoring user activities including login to the system, registration, creation of a user profile and the reading and printing of selected content documents.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. Apparatus for rights management of digital content and secure delivery of digital content documents from a publisher site to an unsecure site, the apparatus comprising:
<claim-text>means for encrypting each digital content document at the publisher site with a key to generate encrypted document content;</claim-text>
<claim-text>an OID calculator that computes for each document, from the encrypted document content for that document, a document identifier that cannot be derived solely from the encrypted version of the requested document;</claim-text>
<claim-text>means for creating a list of document identifier and decryption key pairs;</claim-text>
<claim-text>means for assembling the encrypted document content for each content document and the list into a distribution archive;</claim-text>
</claim-text>
<claim-text>an encryptor that encrypts the distribution archive with a scheduled key;
<claim-text>means for installing a content server at the unsecure site; and</claim-text>
<claim-text>means for sending the distribution archive from the publisher site to the content server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the means for encrypting each digital content document comprises a compressor that compresses each document and an encryption engine that encrypts the compressed document.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref> wherein the OID calculator comprises means for computing a document identifier from the encrypted document content and a text string at the publisher site.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref> further comprising a decryption engine located at the unsecure site that decrypts the distribution archive with the scheduled key, a file decompressor that extracts the encrypted document content and stores the encrypted document content in a storage located at the unsecure site.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein a user at the unsecure location accesses the content server from a browser and wherein the apparatus further comprises means for downloading a secure viewer program into the browser, means for using the viewer program to request a document from the content server; means for downloading an encrypted version of the requested document from the content server to the viewer; an OID calculator in the viewer that calculates a document identifier from the encrypted version of the requested document and means for sending the document identifier to the content server.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The apparatus of <claim-ref idref="CLM-00015">claim 15</claim-ref> further comprising means for using the document identifier in the content server to retrieve a decryption key from the list, means for downloading the decryption key to the viewer program and means for using the downloaded key in the viewer program to decrypt the encrypted version of the document and present the document to the user.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The apparatus of <claim-ref idref="CLM-00011">claim 11</claim-ref> further comprising a log server that monitors content access at the unsecure site and means for creating a log file at the unsecure site from the monitored activities.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref> further comprising means for sending the log file to the publisher site in return for a distribution archive containing new content.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The apparatus of <claim-ref idref="CLM-00018">claim 18</claim-ref> further comprising a reporting server that extracts the contents of the log file at the publisher site, formats the extracted contents and provides a report from the formatted contents to a reporting client.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The apparatus of <claim-ref idref="CLM-00017">claim 17</claim-ref> wherein the log server comprises means for monitoring user activities including login to the system, registration, creation of a user profile and the reading and printing of selected content documents.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A computer program product for rights management of digital content and secure delivery of digital content documents from a publisher site to an unsecure site, the computer program product comprising a computer usable storage medium having computer readable program code thereon, including:
<claim-text>program code for encrypting each digital content document at the publisher site with a key to generate encrypted document content;</claim-text>
<claim-text>program code for computing for each document, from the encrypted document content for that document, a document identifier that cannot be derived solely from the encrypted version of the requested document;</claim-text>
<claim-text>program code for creating a list of document identifier and decryption key pairs;</claim-text>
<claim-text>program code for assembling the encrypted document content for each content document and the list into a distribution archive;</claim-text>
<claim-text>program code for encrypting the distribution archive with a scheduled key;</claim-text>
<claim-text>program code for installing a content server at the unsecure site; and</claim-text>
<claim-text>program code for sending the distribution archive from the publisher site to the content server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The computer program product of <claim-ref idref="CLM-00021">claim 21</claim-ref> wherein the program code for encrypting each digital content document at the publisher site comprises program code for compressing each document before encrypting the document.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The computer program product of <claim-ref idref="CLM-00021">claim 21</claim-ref> wherein the program code for computing a document identifier comprises program code for computing a document identifier from the encrypted document content and a text string at the publisher site.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The computer program product of <claim-ref idref="CLM-00021">claim 21</claim-ref> further comprising program code at the unsecure site, for decrypting the distribution archive with the scheduled key, extracting the encrypted document content and storing the encrypted document content in a storage located at the unsecure site.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The computer program product of <claim-ref idref="CLM-00024">claim 24</claim-ref> wherein a user at the unsecure location accesses the content server from a browser and wherein the computer program product further comprises:
<claim-text>program code for downloading a secure viewer program into the browser;</claim-text>
<claim-text>program code in the viewer program for requesting a document from the content server;</claim-text>
<claim-text>program code for downloading an encrypted version of the requested document from the content server to the viewer; and</claim-text>
<claim-text>program code in the viewer for calculating a document identifier from the encrypted version of the requested document and for sending the document identifier to the content server.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The computer program product of <claim-ref idref="CLM-00025">claim 25</claim-ref> further comprising:
<claim-text>program code for using the document identifier in the content server to retrieve a decryption key from the list and downloading the decryption key to the viewer program; and</claim-text>
<claim-text>program code for using the downloaded key in the viewer program to decrypt the encrypted version of the document and present the document to the user.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The computer program product of <claim-ref idref="CLM-00021">claim 21</claim-ref> further comprising:
<claim-text>program code for monitoring content access at the unsecure site; and</claim-text>
<claim-text>program code for creating a log file at the unsecure site from the monitored activities.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The computer program product of <claim-ref idref="CLM-00027">claim 27</claim-ref> further comprising:
<claim-text>program code for sending the log file to the publisher site in return for a distribution archive containing new content.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The computer program product of <claim-ref idref="CLM-00028">claim 28</claim-ref> further comprising:
<claim-text>program code for extracting the contents of the log file at the publisher site;</claim-text>
<claim-text>program code for formatting the extracted contents and providing a report from the formatted contents to a reporting client.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The computer program product of <claim-ref idref="CLM-00027">claim 27</claim-ref> wherein the program code for monitoring content access comprises program code for monitoring user activities including login to the system, registration, creation of a user profile and the reading and printing of selected content documents.</claim-text>
</claim>
</claims>
</us-patent-grant>
