<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298806-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298806</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10757934</doc-number>
<date>20040115</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>766</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>7</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>375354</main-classification>
</classification-national>
<invention-title id="d0e53">Method and system for data-aided timing offset estimation for frequency selective fading channels</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5363412</doc-number>
<kind>A</kind>
<name>Love et al.</name>
<date>19941100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6373858</doc-number>
<kind>B1</kind>
<name>Soleimani et al.</name>
<date>20020400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6400784</doc-number>
<kind>B1</kind>
<name>Ben-Eli</name>
<date>20020600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375365</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7016404</doc-number>
<kind>B2</kind>
<name>Yang</name>
<date>20060300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2001/0014114</doc-number>
<kind>A1</kind>
<name>Baltersee et al.</name>
<date>20010800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375148</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2003/0179813</doc-number>
<kind>A1</kind>
<name>Morita et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375148</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2005/0084025</doc-number>
<kind>A1</kind>
<name>Chen</name>
<date>20050400</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>375260</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>7</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>375354</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375371</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375316</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>375355</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>455516</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>6</number-of-drawing-sheets>
<number-of-figures>8</number-of-figures>
</figures>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Varma</last-name>
<first-name>Gottimukkala Narendra</first-name>
<address>
<city>Andhra Pradesh</city>
<country>IN</country>
</address>
</addressbook>
<nationality>
<country>IN</country>
</nationality>
<residence>
<country>IN</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Devesh</last-name>
<first-name>Kunwar</first-name>
<address>
<city>Andhra Pradesh</city>
<country>IN</country>
</address>
</addressbook>
<nationality>
<country>IN</country>
</nationality>
<residence>
<country>IN</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Yoganandam</last-name>
<first-name>Yeleswarapu</first-name>
<address>
<city>Andhra Pradesh</city>
<country>IN</country>
</address>
</addressbook>
<nationality>
<country>IN</country>
</nationality>
<residence>
<country>IN</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<last-name>Botjer</last-name>
<first-name>William L.</first-name>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Hellosoft Inc.</orgname>
<role>02</role>
<address>
<city>San José </city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Payne</last-name>
<first-name>David C.</first-name>
<department>2611</department>
</primary-examiner>
<assistant-examiner>
<last-name>Flores</last-name>
<first-name>Leon</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">The disclosed invention provides a system, a method and a computer program product for timing offset estimation for frequency selective fading channels in wireless communication systems. The disclosed invention first obtains a corrected received signal using the received signal and a pre-estimated timing offset. The pre-estimated timing offset is further tracked in two steps. In the first step a plurality of probable deviations in the pre-estimated timing offset are considered. Then a training sequence is used to determine an expected signal corresponding to each of the probable deviations. The corrected received signal is then shifted through the probable deviations. Thereafter error factor between the expected signals and corresponding shifted received signals is obtained. The probable deviation yielding optimum error factor is then identified as the first estimate of the deviation in timing offset. This first estimate is then refined using correlation techniques to obtain an improved estimate of the deviation.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="141.48mm" wi="227.08mm" file="US07298806-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="225.47mm" wi="138.94mm" file="US07298806-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="227.33mm" wi="141.73mm" orientation="landscape" file="US07298806-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="219.46mm" wi="139.53mm" file="US07298806-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="169.33mm" wi="132.16mm" file="US07298806-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="162.98mm" wi="135.04mm" file="US07298806-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="168.40mm" wi="121.07mm" orientation="landscape" file="US07298806-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND</heading>
<p id="p-0002" num="0001">The present invention relates to the field of timing offset estimation in wireless networks. More particularly, the invention relates to a method and system for data-aided timing offset estimation for frequency selective fading channels.</p>
<p id="p-0003" num="0002">In wireless communication, a timing offset is experienced between received and transmitted signals. The timing offset is caused by a number of distortions experienced in the channel due to factors such as multipath effects, frequency selective fading and unknown propagation delays. These timing offsets lead to errors in the channel response estimation and a consequent increase in the overall bit error rate (BER). Thus, timing offset estimation is an important aspect of wireless communication receivers.</p>
<p id="p-0004" num="0003">Various approaches addressing the problem of timing offset estimation are known in the art. These approaches can be broadly classified into two categories—data-aided and non data-aided approaches. In a data-aided approach, a predefined sequence of symbols is embedded in the transmitted signal to aid the timing offset estimation. The sequence is known as a training sequence. The receiver has prior knowledge of the training sequence. It thus compares the known training sequence with the received training sequence for estimating the timing offset. In a non data-aided approach, use of such a training sequence is avoided, and the receiver achieves synchronization by extracting the information necessary for timing offset estimation from the modulated signal. The data throughput efficiency of data-aided approaches is lower than that of non data-aided approaches as a certain portion of the transmitted signal is assigned to the predefined sequence. However, the time taken for achieving synchronization in data-aided methods is significantly less than non-data aided methods. As the data rates provided by mobile devices are increasing, it has become essential to achieve faster synchronization. Therefore data-aided methods are preferred for use with mobile devices. Consequently, most wireless communication standards, such as the Global System for Mobile communication (GSM), provide a training sequence in the transmitted signal to facilitate data-aided timing offset estimation. Further many of these standards perform the timing offset estimation in two stages—acquisition and tracking. The first occurrence of the training sequence in the received signal is used to obtain an estimate of the timing offset during acquisition. Thereafter, in the tracking stage, the change in this estimate is tracked at subsequent occurrences of the training sequence to account for the time varying characteristic of the channel.</p>
<p id="p-0005" num="0004">One approach of timing offset estimation is proposed in a research paper titled “A Fully Digital Feed forward MSK Demodulator with Joint Frequency Offset and Symbol Timing Estimation for Burst Mode Mobile Radio”, authored by Ralph Mehlan, Yong-En Chen and Heinrich Meyr, published in IEEE Transactions, Vehicular Technology, VOL 42, No.4, November 1993 Pages 434-443. The method proposed in the publication uses a differential phase technique for estimating the timing offset for minimum shift keying (MSK) modulated signals subjected to flat fading in the channel. However, the method is non data-aided and does not consider frequency selective fading in the channel.</p>
<p id="p-0006" num="0005">A data-aided method for timing offset estimation is proposed in the research paper “A Fully Digital Noncoherent and coherent GMSK Receiver Architecture with Joint Symbol Timing Error and Frequency Offset Estimation”, authored by Yung-liang Huang, Kong-Dar Fan and Chia-Chi Huang, published in IEEE Trans, Vehicular Technology, VOL.49, No 3, May 2000 pages 863-874. In accordance with this method, the received signal is first passed through a frequency discriminator. The frequency discriminator outputs a frequency discriminated signal whose instantaneous amplitude is proportional to the instantaneous frequency of the received signal. Thereafter, the frequency offset is estimated using the training sequence and the Fast Fourier transform (FFT) of the frequency discriminated signal. The estimated frequency offset is then used to find a timing offset estimate. Although the method is a data-aided one, it does not consider the multipath effects of the channel.</p>
<p id="p-0007" num="0006">In order to consider the multipath effects of the channel, data-aided methods use a correlation between the known training sequence and received signal for estimating the timing offset. Correlation-based techniques correlate the training sequence with the received signal shifted through various probable timing offsets and find out the offset value resulting in the maximum correlation. The maximum correlation point corresponds to the strongest multipath location. Thus the correlation-based techniques rely on the strongest multipath location and are suitable for use in a flat fading multipath channel environment.</p>
<p id="p-0008" num="0007">A correlation based data-aided timing offset synchronization approach is proposed in U.S. Pat. No. 6,373,858 titled “Method and Apparatus of Adaptive Maximum Likelihood Sequence Estimation Using Filtered Correlation Synchronization” and assigned to Hughes Electronics Corporation, El Segundo, Calif. The patent discloses a signal structure with a reference data burst (training sequence) embedded in it for timing and frequency offset estimation. The patent further proposes a correlation-based method of timing synchronization using the proposed signal structure. In accordance with the method, a burst detector determines an occurrence of a reference data burst in the received signals. A first estimate of the frequency and timing offset is obtained using the detected burst. Thereafter, the correlation value between the first estimate of the frequency offset and its neighbors is interpolated assuming the timing offset to be equal to the first estimate of timing offset. The interpolation is used to obtain a fine estimate of the frequency offset. This fine estimate of the frequency offset is used to correct the received signal. The frequency corrected received signal is used to refine the estimate of the timing offset. Thus the timing offset estimate is used to refine the frequency offset and vice-versa.</p>
<p id="p-0009" num="0008">The correlation-based data-aided method presented in U.S. Pat. No. 6,373,858 as discussed above relies on the strongest multipath location computed using correlation properties of the training sequence. In conditions with low signal to noise ratio, autocorrelation of these training sequences may be low. Also, the cross correlation of the training sequence with the data adjacent to the training sequence may be high. The problem is aggravated when the training sequences are short. For example, the training sequence provided by GSM systems for tracking are only 26-bits long. Considering the above facts, relying solely on correlation techniques for timing offset estimation does not achieve accurate results. Additionally, in frequency selective multipath conditions, the performance of equalizer depends on the exact knowledge of the delay profile rather than the strongest multipath location information. Consequently, various methods using the channel characteristic estimate for timing offset estimation have been developed.</p>
<p id="p-0010" num="0009">One such method is disclosed in European Patent Application No. EP1292063A1 titled “Frame Synchronization Apparatus and Frame Synchronization Method” and assigned to Matsushita Electric Industrial Co., Ltd. The method disclosed in the above patent application considers a channel environment in which the level fluctuation, noise, or delay wave occurring due to fading fluctuations, are assumed to be absent. Thereafter, a predetermined known signal, i.e. the training sequence, is filtered through the considered channel to obtain a filtered signal. An ideal correlation value is calculated between the filtered signal and the predetermined known signal. The ideal correlation value is then time shifted through a predetermined shifting time. Additionally, an actual correlation value is obtained between the received signal and the predetermined known signal. The actual correlation value is further multiplied by a magnification factor. Then the square error between the shifted ideal correlation value and the magnified actual correlation value is found out. The shifting time corresponding to ideal correlation value at which the calculated square error is minimum is identified as the synchronization time, i.e. the timing offset.</p>
<p id="p-0011" num="0010">The above method uses the channel transfer function for estimating the timing offset but assumes the channel transfer function to be constant over time. However, this assumption leads to inaccuracies in timing offset estimate as the actual channel characteristics vary with time. Various methods of obtaining dynamic channel estimate are known in the art. One such method, which obtains the channel dynamically and uses it for demodulation of the received signal, is described in U.S. Pat. No. 5,363,412 titled “Method and Apparatus of Adaptive Maximum Likelihood Sequence Estimation Using Filtered Correlation Synchronization”, assigned to Motorola Inc., Schaumburg, Ill. The method described in the above patent uses the correlation between the received signal and the known transmitted signal to obtain an initial estimate of the timing offset and the channel transfer function. A Viterbi decoder then uses these initial estimates to decode the received signal. Thereafter, the decoded signal is filtered through the estimated channel to obtain an estimated channel-impaired signal. The error between the estimated channel-impaired signal and the received signal is then used to improve the channel estimate. The improved channel estimate is then used for demodulating the received signal. Even though the method estimates the channel dynamically, it obtains the timing offset using correlation techniques and does not use the dynamically calculated channel for timing offset estimation.</p>
<p id="p-0012" num="0011">A method using dynamic channel estimation for timing offset estimation is described in WIPO Patent Application No. 0243271A2 titled “Joint Least-Square Synchronization, Channel Estimation and Noise Estimation” and assigned to Telefonaktiebolaget Lm Ericsson (Publ), Sweden. In accordance with the method disclosed in the above patent, a training sequence is received and the symbols in the received signal are divided into groups. For each of these groups, a set of linear equations is established. These equations estimate the channel using a least square error technique. The least square estimate thus calculated is used to determine a noise estimate for each group. The group having the least noise estimate is chosen as the synchronization group. Alternatively, the group with greatest signal to noise ratio can be selected as the synchronization group. The method performs dynamic channel estimation by calculating the least square error between the received and reference signal and use the channel estimate for achieving timing offset estimation. This makes the method suitable for frequency selective fading conditions. However, calculation of dynamic channel transfer function for a plurality of symbol groups is a computationally complex task. Therefore the method requires high processing power for execution. Mobile devices have limited processing resources. As a result, such computationally complex methods are not suitable for use with wireless receivers in mobile devices.</p>
<p id="p-0013" num="0012">From the discussion of the prior art above, it is evident that the correlation-based methods of timing offset estimation known in the art rely on the estimation of the strongest multipath location. However, the knowledge of the channel's delay profile is required to accurately determine the timing offset in frequency selective fading channels. Furthermore, the delay profile or the channel characteristics do not remain constant over time. Dynamic determination of the delay profile or channel characteristics is a computationally complex task. As a result the methods using dynamic channel characteristics require high processing power. Therefore there exists a need for an approach providing the high accuracy attained by dynamic channel estimation while still retaining the computational efficiency of correlation based techniques.</p>
<heading id="h-0002" level="1">SUMMARY</heading>
<p id="p-0014" num="0013">The disclosed invention is directed towards a method, a system and a computer program product for data-aided timing offset estimation for frequency selective fading channels in wireless communication systems. The synchronization point is defined with respect to the performance of the equalizer rather than based on the strongest multipath location (Conventional method). A point is chosen so as to capture as much multipath profile as possible to have efficient equalization.</p>
<p id="p-0015" num="0014">An objective of the disclosed invention is to estimate the timing offset encountered in channels exhibiting multipath effects and frequency selective fading.</p>
<p id="p-0016" num="0015">A further objective of the disclosed invention is to increase accuracy of timing offset estimation in frequency selective fading channels by using channel estimation.</p>
<p id="p-0017" num="0016">Another objective of the disclosed invention is to reduce the computational complexity involved in estimation of the timing offset.</p>
<p id="p-0018" num="0017">Yet another objective of the disclosed invention is to achieve accurate timing offset estimate in channel conditions with low signal to noise ratio (SNR).</p>
<p id="p-0019" num="0018">Still another objective of the disclosed invention is to increase the accuracy of data-aided timing offset estimation when short training sequences are used.</p>
<p id="p-0020" num="0019">The disclosed invention provides a system, a method and a computer program product for achieving the above-mentioned objectives. The disclosed invention first obtains a corrected received signal by shifting a received signal by a pre-estimated timing offset. The disclosed invention further tracks the pre-estimated timing offset in two steps: a coarse estimation step and a refinement step. In the coarse estimation step, a first estimate of the deviation in the pre-estimated timing offset is selected out of a plurality of probable deviations using an error factor corresponding to each probable deviation. The error factor corresponding to a probable deviation is a measure of the closeness between the corrected received signal shifted through the probable deviation and an expected signal corresponding to the probable deviation. The expected signal is calculated using an estimate of the channel and the training sequence. The deviation yielding the optimum value of the error factor is selected as the first estimate of the deviation in the pre-estimated timing offset. In the refinement step, a set of closely spaced probable deviations in the proximity of the first estimate is considered. Thereafter, the correlation values between the training sequence and the corrected received signal shifted through each of the closely spaced deviations are determined. The closely spaced deviation yielding the maximum of correlation peaks is identified as the improved estimate of the deviation in timing offset.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0021" num="0020">The preferred embodiments of the invention will hereinafter be described in conjunction with the appended drawings provided to illustrate and not to limit the invention, wherein like designations denote like elements, and in which:</p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 1A</figref> is a flowchart illustrating a data-aided method of tracking the timing offset in accordance with the disclosed invention;</p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 1B</figref> is a flowchart illustrating a method of obtaining the first estimate of deviation in a pre-estimated timing offset in accordance with the disclosed invention;</p>
<p id="p-0024" num="0023"><figref idref="DRAWINGS">FIG. 2</figref> is a block diagram illustrating a system for data-aided tracking of the timing offset in accordance with the disclosed invention;</p>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 3A</figref> is a flowchart illustrating a method of obtaining an expected signal for a probable deviation in pre-estimated timing offset;</p>
<p id="p-0026" num="0025"><figref idref="DRAWINGS">FIG. 3B</figref> is a block diagram illustrating a system for obtaining an expected signal for a probable deviation in pre-estimated timing offset;</p>
<p id="p-0027" num="0026"><figref idref="DRAWINGS">FIG. 4</figref> is a flowchart illustrating the method of estimating the channel transfer function;</p>
<p id="p-0028" num="0027"><figref idref="DRAWINGS">FIG. 5</figref> is a flowchart illustrating a method of obtaining an improved estimate of the deviation in pre-estimated timing offset; and</p>
<p id="p-0029" num="0028"><figref idref="DRAWINGS">FIG. 6</figref> is a block diagram illustrating a system for obtaining an improved estimate of the deviation in pre-estimated timing offset.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DESCRIPTION OF PREFERRED EMBODIMENTS</heading>
<p id="p-0030" num="0029">The disclosed invention provides a system, a method and a computer program product for data-aided timing offset estimation for frequency selective fading channels. The disclosed invention estimates the channel transfer function for accurate timing offset estimation for frequency selective fading channels. Further, as the estimation of the channel is a computationally complex task, the disclosed invention uses the channel estimation only for coarsely estimating of the timing offset. The coarse estimate of the timing offset is then refined using a computationally efficient synchronization technique.</p>
<p id="p-0031" num="0030">Referring now to <figref idref="DRAWINGS">FIG. 1A</figref>, a data-aided method of tracking the timing offset in accordance with the disclosed invention is hereinafter described. The method of obtaining a timing offset estimate at an occurrence of the training sequence is first described. At step <b>102</b>, the received signal is first shifted through the pre-estimated timing offset to obtain a corrected received signal r(n), where n denotes the discrete time instant under consideration. The method uses the timing offset value tracked at the previous occurrence of the training sequence as a pre-estimate of the timing offset. Alternatively, the method uses the timing offset estimate obtained during acquisition as the pre-estimate of the timing offset. The disclosed invention then accomplishes the task of tracking the pre-estimated timing offset using the corrected received signal in the following two steps. At the first step <b>104</b>, a plurality of probable deviations m in the pre-estimated timing offset is considered and one of the probable deviations is identified as a first estimate of the deviation in timing offset m<sub>opt</sub>. The plurality of probable deviations is contained in a possible range of values [−M,M]. To illustrate the disclosed invention with an example it is assumed that the probable deviations are spaced regularly in the above-mentioned range. Step <b>104</b> of obtaining a first estimate of the deviation is further explained with reference to <figref idref="DRAWINGS">FIG. 1B</figref>. Once a first estimate of the deviation is obtained, an improved estimate of the deviation is determined using the first estimate of the deviation at step <b>106</b>. The step <b>106</b> of obtaining an improved estimate of the deviation is further explained with reference to <figref idref="DRAWINGS">FIG. 5</figref>.</p>
<p id="p-0032" num="0031">Referring now primarily to <figref idref="DRAWINGS">FIG. 1B</figref>, a method of obtaining the first estimate of the deviation in accordance with the disclosed invention is hereinafter described. The method involves considering a plurality of probable deviations [−M, M]. At step <b>108</b>, an expected signal {circumflex over (r)}<sub>i</sub>(n) corresponding to a considered probable deviation m is obtained using a training sequence I<sub>tr</sub>(n) and a channel estimate ĥ<sub>m</sub>(n). The expected signal {circumflex over (r)}<sub>m</sub>(n) is the signal that should ideally be received if the deviation in timing offset is equal to the considered probable deviation m. The step <b>108</b> of obtaining expected signal {circumflex over (r)}<sub>m</sub>(n) is explained in detail with reference to <figref idref="DRAWINGS">FIG. 3A</figref>. Thereafter, an error factor E(m) between expected signal {circumflex over (r)}<sub>m</sub>(n) and the shifted received signal r(n−m) is obtained at step <b>110</b>, wherein r(n−m) denotes the received signal r(n) shifted by the considered probable deviation m. Error factor E(m) is a measure of closeness between these two signals. Hence, an optimal value of the error factor corresponds to the best estimate of the actual deviation in timing offset. In an embodiment of the disclosed invention, the square error between shifted received signal r(n−m) and expected signal {circumflex over (r)}<sub>m</sub>(n) is used as the error factor. This embodiment is further explained with reference to equation (1). The steps <b>108</b> and <b>110</b> are repeated for each of the probable deviations mε[−M, M]. In an alternative embodiment of the disclosed invention the steps <b>108</b> and <b>110</b> are performed for each of the probable deviations mε[−M,M] in parallel. Finally at step <b>112</b>, the probable deviation m yielding optimum error factor E(m) is identified as the first estimate of the deviation m<sub>opt</sub>.</p>
<p id="p-0033" num="0032">Referring now primarily to <figref idref="DRAWINGS">FIG. 2</figref>, a system for data-aided tracking of the timing offset in accordance with the disclosed invention, timing offset tracker <b>200</b>, is hereinafter described. The timing offset tracker <b>200</b> comprises a pre-corrector <b>202</b>, a coarse estimator <b>204</b> and a refiner <b>206</b>. Pre-corrector <b>202</b> shifts the received signal through the pre-estimated timing offset to obtain corrected received signal r(n). Coarse estimator <b>204</b> uses corrected received signal r(n) and training sequence I<sub>tr</sub>(n) to obtain a first estimate of the deviation m<sub>opt </sub>in the timing offset. Refiner <b>206</b> then obtains an improved estimate of the deviation m<sub>refined </sub>using the first estimate m<sub>opt</sub>.</p>
<p id="p-0034" num="0033"><figref idref="DRAWINGS">FIG. 2</figref> also shows a first deviation counter <b>208</b>, a shifter <b>210</b>, an expected signal calculator <b>212</b>, an error calculator <b>214</b> and a deviation selector <b>216</b> constituting coarse estimator <b>204</b>. Each count of first deviation counter <b>208</b> corresponds to a probable deviation. For each occurrence of the training sequence, first deviation counter <b>208</b> produces the count to consider all probable deviations. For a considered probable deviation m, shifter <b>210</b> shifts corrected received signal r(n) through probable deviation m to obtain a shifted received signal r(n−m). Expected signal calculator <b>212</b> calculates an expected signal {circumflex over (r)}<sub>m</sub>(n) for a considered probable deviation m using channel estimate ĥ<sub>m</sub>(n) and training sequence I<sub>tr</sub>(n). Once expected signal {circumflex over (r)}<sub>m</sub>(n) is calculated, error calculator <b>214</b> finds error factor E(m) between the shifted received signal r(n−m) and the expected signal {circumflex over (r)}<sub>m</sub>(n). Expected signal calculator <b>212</b> and error calculator <b>214</b> together with first deviation counter <b>208</b> obtain error factor E(m) corresponding to each of the considered probable deviations. Thereafter, deviation selector <b>216</b> identifies the probable deviation yielding the optimum value of error factor E(m) as the first estimate of the timing offset deviation m<sub>opt</sub>.</p>
<p id="p-0035" num="0034">In an alternative embodiment of the disclosed invention, coarse estimator <b>204</b> comprises a plurality of expected signal calculators <b>212</b> and corresponding error calculators <b>214</b>. Each expected signal calculator <b>212</b> calculates the expected signal corresponding to a probable deviation. Subsequently, the corresponding error calculator <b>214</b> calculates the error factor between the calculated expected signal and the corrected received signal shifted through the corresponding probable deviation. The plurality of expected signal calculators and corresponding error calculators operate in a manner such that the error factors are calculated for each of the probable deviation values in parallel.</p>
<p id="p-0036" num="0035">In accordance with an embodiment of the disclosed invention, step <b>108</b> of obtaining the error factor E(m) is performed by calculating the square error between the shifted received signal r(n−m) and the expected signal {circumflex over (r)}<sub>m</sub>(n). This is done using the following equation:</p>
<p id="p-0037" num="0036">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mi>E</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>m</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>=</mo>
        <mrow>
          <munder>
            <mo>∑</mo>
            <mi>n</mi>
          </munder>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <msup>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mi>r</mi>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>n</mi>
                      <mo>-</mo>
                      <mi>m</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                </mrow>
                <mo>-</mo>
                <mrow>
                  <msub>
                    <mover>
                      <mi>r</mi>
                      <mo>^</mo>
                    </mover>
                    <mi>m</mi>
                  </msub>
                  <mo>⁡</mo>
                  <mrow>
                    <mo>(</mo>
                    <mi>n</mi>
                    <mo>)</mo>
                  </mrow>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mn>2</mn>
          </msup>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>1</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
</p>
<p id="p-0038" num="0037">In accordance with this embodiment of the disclosed invention error calculator <b>214</b> comprises a square error calculating block, which calculates the square error between shifted received signal r(n−m) and expected signal {circumflex over (r)}<sub>m</sub>(n) using equation (1).</p>
<p id="p-0039" num="0038">Referring now primarily to <figref idref="DRAWINGS">FIG. 3A</figref>, a method of obtaining an expected signal {circumflex over (r)}<sub>m</sub>(n), corresponding to the considered probable deviation m in accordance with an embodiment of the disclosed invention is hereinafter described. To account for the frequency selective fading in the channel, expected signal {circumflex over (r)}<sub>m</sub>(n) is calculated using a channel estimate. At step <b>302</b>, a transfer function ĥ<sub>m</sub>(n) of the channel is estimated assuming the deviation in timing offset to be equal to considered probable deviation m. Various methods of estimating the channel are known in the art and can be used for channel estimation at step <b>302</b>. An embodiment of the invention using one such approach is described with reference to <figref idref="DRAWINGS">FIG. 4</figref>. Thereafter, at step <b>304</b>, training sequence I<sub>tr</sub>(n) is filtered through estimated channel transfer function ĥ<sub>m</sub>(n) to obtain expected signal {circumflex over (r)}<sub>m</sub>(n) corresponding to the probable deviation m:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>{circumflex over (r)}</i><sub>m</sub>(<i>n</i>)=<i>ĥ</i><sub>m</sub>(<i>n</i>)*<i>I</i><sub>tr</sub>(<i>n</i>)  (2)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0040" num="0039">Referring now primarily to <figref idref="DRAWINGS">FIG. 3B</figref>, expected signal calculator <b>212</b> is hereinafter described in accordance with an embodiment of the disclosed invention. Expected signal calculator <b>212</b> comprises a channel estimator <b>306</b> and a channel filter <b>308</b>. Channel estimator <b>306</b> estimates the channel transfer function ĥ<sub>m</sub>(n) corresponding to a probable deviation m being considered using training sequence I<sub>tr</sub>(n). Channel filter <b>308</b> then filters training sequence I<sub>tr</sub>(n) through estimated channel transfer function ĥ<sub>m</sub>(n). The output of channel filter <b>308</b> is the expected signal {circumflex over (r)}<sub>m</sub>(n) corresponding to the considered probable deviation m.</p>
<p id="p-0041" num="0040">Referring now primarily to <figref idref="DRAWINGS">FIG. 4</figref> a method of estimating the channel transfer function in accordance with an embodiment of the disclosed invention is hereinafter described. At step <b>402</b>, corrected received signal r(n) is shifted through probable deviation m being considered to obtain shifted received signal r(n−m). At step <b>404</b>, shifted received signal r(n−m) is de-convolved with training sequence I<sub>tr</sub>(n) to obtain estimated channel transfer function ĥ<sub>m</sub>(n) corresponding to probable deviation m being considered. In one embodiment of the disclosed invention, the channel is modeled as a 2P+1 coefficient finite impulse response (FIR) filter for de-convolving. In this channel model, the channel taps are obtained in de-convolving step <b>404</b> using the following equation:</p>
<p id="p-0042" num="0041">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mtable>
  <mtr>
    <mtd>
      <mrow>
        <mrow>
          <mrow>
            <msub>
              <mover>
                <mi>h</mi>
                <mo>^</mo>
              </mover>
              <mi>m</mi>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>p</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>=</mo>
          <mrow>
            <munderover>
              <mo>∑</mo>
              <mrow>
                <mi>k</mi>
                <mo>=</mo>
                <mn>0</mn>
              </mrow>
              <mrow>
                <msub>
                  <mi>L</mi>
                  <mi>tr</mi>
                </msub>
                <mo>-</mo>
                <mn>1</mn>
              </mrow>
            </munderover>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mrow>
                <msubsup>
                  <mi>I</mi>
                  <mi>tr</mi>
                  <mo>*</mo>
                </msubsup>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mi>k</mi>
                  <mo>)</mo>
                </mrow>
              </mrow>
              <mo>*</mo>
              <mrow>
                <msub>
                  <mi>r</mi>
                  <mi>tr</mi>
                </msub>
                <mo>⁡</mo>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>k</mi>
                    <mo>+</mo>
                    <mi>m</mi>
                    <mo>+</mo>
                    <mi>p</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
              </mrow>
            </mrow>
          </mrow>
        </mrow>
        <mo>,</mo>
        <mrow>
          <mi>p</mi>
          <mo>∈</mo>
          <mrow>
            <mo>[</mo>
            <mrow>
              <mrow>
                <mo>-</mo>
                <mi>P</mi>
              </mrow>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
            <mo>]</mo>
          </mrow>
        </mrow>
      </mrow>
    </mtd>
    <mtd>
      <mrow>
        <mo>(</mo>
        <mn>3</mn>
        <mo>)</mo>
      </mrow>
    </mtd>
  </mtr>
</mtable>
</math>
</maths>
<br/>
In accordance with this embodiment of the disclosed invention, channel estimator <b>306</b> comprises a de-convolving block. The de-convolving block determines the channel transfer function ĥ<sub>m</sub>(n), corresponding to the probable deviation m being considered, using the equation (3). The method of obtaining the channel transfer function disclosed here is for illustrating the disclosed invention and in no way limits the scope of the invention, which can be implemented with various other methods of obtaining the channel transfer function.
</p>
<p id="p-0043" num="0042">Referring now primarily to <figref idref="DRAWINGS">FIG. 5</figref> a method of obtaining the improved estimate m<sub>refined </sub>of the deviation in accordance with an embodiment of the disclosed invention is hereinafter described. After first estimate of the deviation m<sub>opt </sub>is obtained in step <b>104</b>, a plurality of closely spaced probable deviations in the pre-estimated timing offset are considered in the proximity of first estimate m<sub>opt</sub>. Corrected received signal r(n) is then shifted through each of the closely spaced probable deviations to obtain a plurality of closely shifted received signals. Thereafter at step <b>502</b>, correlations between each of the closely shifted received signals and training sequence I<sub>tr</sub>(n) is determined for each of the closely spaced probable deviations. The closely spaced probable deviation that yields maximum of correlation peaks is identified as the improved estimate m<sub>refined </sub>of the deviation at step <b>504</b>. The closely spaced probable deviations are chosen depending on the accuracy desired for improved estimate m<sub>refined</sub>. For example, an accuracy of ½Q is attained by performing the step of fine estimation at an over sampling rate of Q i.e. by choosing the closely spaced probable deviations at an interval of 1/Q. The above-mentioned method of obtaining an improved estimate of the deviation is described for illustrating the disclosed invention and in no way limit the scope of the invention, which can be implemented with any other computationally efficient method of timing offset estimation. In an alternative embodiment least square error, least mean square error and recursive least square error techniques can be optionally used for obtaining the improved estimate of the timing offset.</p>
<p id="p-0044" num="0043">Referring now primarily to <figref idref="DRAWINGS">FIG. 6</figref>, refiner <b>206</b> in accordance with the disclosed invention is hereinafter described. Refiner <b>206</b> comprises a second deviation counter <b>602</b>, a correlator <b>604</b> and a maximum correlation identifier <b>606</b>. Each count of second deviation counter <b>602</b> corresponds to a probable closely spaced deviation. For each occurrence of the training sequence, second deviation counter <b>602</b> produces the count to consider all probable closely spaced deviations. Correlator <b>604</b> calculates the correlation between corrected received signal r(n) shifted through a closely spaced probable deviation, and the training sequence I<sub>tr</sub>(n). These correlation values are then used by maximum correlation identifier <b>606</b> to find the closely spaced probable deviation yielding the maximum correlation as the improved estimate m<sub>refined </sub>of the deviation.</p>
<p id="p-0045" num="0044">The disclosed invention may be implemented using a dedicated Application Specific Integrated Circuit (ASIC). Alternately, it may be implemented using a Digital Signal Processor (DSP) chip or a Field Programmable Gate Array (FPGA). It would be apparent to anyone skilled in the art that the disclosed invention may also be embodied in a computer program product using either a processor specific assembly language or a high-level language such as C. The computer program product embodiment of the disclosed invention can be used for either the implementation of a timing offset estimator, or for implementation of a simulation model of the timing offset estimator.</p>
<p id="p-0046" num="0045">The disclosed system, method and computer program product achieve accurate timing offset estimation in frequency selective fading environment while retaining computational efficiency. The calculation of channel transfer function in the timing offset estimation process results in high accuracy in frequency selective fading conditions. As the method of channel estimation is a computationally complex one, the timing estimation is performed in two steps. The first step estimates the timing offset using the channel transfer function while the second step uses the relatively faster correlation technique. The interval between the probable timing offsets used in first step can be chosen depending on the desired accuracy level and available processing resources. For example, in a GSM receiver timing offset estimate at an accuracy of ±½ symbol can be carried out in the first step while achieving finer estimation in the relatively faster second step. Thus, the disclosed invention achieves a high level of accuracy in timing offset estimation while still retaining computational efficiency.</p>
<p id="p-0047" num="0046">While the preferred embodiments of the invention have been illustrated and described, it will be clear that the invention is not limited to these embodiments only. Numerous modifications, changes, variations, substitutions and equivalents will be apparent to those skilled in the art without departing from the spirit and scope of the invention as described in the claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298806-20071120-M00001.NB">
<img id="EMI-M00001" he="7.03mm" wi="76.20mm" file="US07298806-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298806-20071120-M00002.NB">
<img id="EMI-M00002" he="9.14mm" wi="76.20mm" file="US07298806-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A data-aided method of tracking the timing offset between a transmitted signal having a training sequence and a received signal using a pre-estimated timing offset, the method comprising the steps of:
<claim-text>a. obtaining a corrected received signal using the received signal and the pre-estimated timing offset;</claim-text>
<claim-text>b. obtaining a first estimate of the deviation in the pre-estimated timing offset out of a plurality of probable deviations by performing the steps of:
<claim-text>i. de-convolving the corrected received signal shifted through the first probable deviation with the training sequence to obtain an estimated channel transfer function;</claim-text>
<claim-text>ii. filtering the training sequence through the estimated transfer function to obtain an expected signal corresponding to the first probable deviation;</claim-text>
<claim-text>iii. calculating an error factor between the expected signal and the corrected received signal shifted through the first probable deviation; performing steps i-iii for each probable deviation; and</claim-text>
<claim-text>iv. identifying the probable deviation yielding the optimum value of error factor as the first estimate of the deviation; and</claim-text>
</claim-text>
<claim-text>c. obtaining an improved estimate of the deviation using the corrected received signal and the first estimate of the deviation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the step of obtaining an improved estimate of the deviation comprises the steps of:
<claim-text>a. calculating the correlation between the training sequence and the corrected received signal shifted through a plurality of closely-spaced probable deviations, the plurality of probable deviations selected in proximity to the first estimate of the deviation; and</claim-text>
<claim-text>b. identifying the closely-spaced probable deviation yielding the maximum correlation as the improved estimate of the deviation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the step of calculating the error factor is performed by calculating the square error between the expected signal corresponding to the probable deviation and corrected received signal shifted through the probable deviation.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein at least one of the steps is embodied in a computer program product.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A system for data-aided tracking of the timing offset between a transmitted signal having a training sequence and a received signal using a pre-estimated timing offset, the system comprising:
<claim-text>a. a pre-corrector obtaining a corrected received signal using the received signal and the pre-estimated timing offset;</claim-text>
<claim-text>b. a coarse estimator obtaining a first estimate of the deviation in the pre-estimated timing offset out of a plurality of probable deviations, the coarse estimator comprising:
<claim-text>i. de-convolving block de-convolving the corrected received signal shifted through a probable deviation with the training sequence to obtain an estimated channel transfer function corresponding to the probable deviation;</claim-text>
<claim-text>ii. a channel filter filtering the training sequence through the estimated channel transfer function to obtain an expected signal corresponding to the probable deviation;</claim-text>
<claim-text>iii. an error calculator calculating an error factor between the expected signal corresponding to a probable deviation and the corrected received signal shifted through the probable deviation; and</claim-text>
<claim-text>iv. a deviation selector identifying the probable deviation yielding the optimum value of error factor as the first estimate of the deviation; and</claim-text>
</claim-text>
<claim-text>c. a refiner obtaining an improved estimate of the deviation using the corrected received signal and the first estimate of the deviation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The system as recited in <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the refiner comprises:
<claim-text>a. a correlator calculating correlation between the training sequence and the corrected received signal shifted through a plurality of closely-spaced probable deviations in the proximity of the first estimate of the deviation; and</claim-text>
<claim-text>b. a maximum correlation identifier identifying the closely-spaced deviation yielding the maximum correlation as the improved estimate of the deviation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The system as recited in <claim-ref idref="CLM-00005">claim 5</claim-ref> wherein the error calculator comprises a square error calculating block calculating the square error between the expected signal corresponding to a probable deviation and the corrected received signal shifted through the probable deviation.</claim-text>
</claim>
</claims>
</us-patent-grant>
