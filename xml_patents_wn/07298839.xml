<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298839-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298839</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10626948</doc-number>
<date>20030725</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>849</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>9</main-group>
<subgroup>30</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>380 30</main-classification>
<further-classification>380 28</further-classification>
<further-classification>380277</further-classification>
</classification-national>
<invention-title id="d0e53">Squared Weil and Tate pairing techniques for use with elliptic curves</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>5272755</doc-number>
<kind>A</kind>
<name>Miyaji et al.</name>
<date>19931200</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6968354</doc-number>
<kind>B2</kind>
<name>Kaminaga et al.</name>
<date>20051100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6986054</doc-number>
<kind>B2</kind>
<name>Kaminaga et al.</name>
<date>20060100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>7079650</doc-number>
<kind>B1</kind>
<name>Knudsen</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>2003/0072443</doc-number>
<kind>A1</kind>
<name>Harley et al.</name>
<date>20030400</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>2003/0081785</doc-number>
<kind>A1</kind>
<name>Boneh et al.</name>
<date>20030500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>380277</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>2003/0182554</doc-number>
<kind>A1</kind>
<name>Gentry et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>713171</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00008">
<othercit>J. Manoharmayum, on the Modularity of Certain GL2 (F7) Galois Representations, Mathematical Reasearch Letters 8, 703-712 (2001). and Revised version Retrieved date Oct. 25, 2006.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>IEEE Transactions on Information Theory, vol. 45, No. 5, Jul. 1999, pp. 1717-1719, Retrieved date Oct. 25, 2006.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Eisentrager, Kirsten et al., “Fast Elliptic Curve Arithmetic and Improved Weil Pairing Evaluation,” Topics in Cryptology, CT-RSA 2003, Marc Joye (Ed), pp. 343-354, LNCS 2612, Springer-Verlag, 2003.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Boneh, Dan, et al., “Identity-Based Encryption from the Weil Pairing,” Siam J. Comput., vol. 32, No. 3, pp. 586-615, 2003 Society for Industrial and Applied Mathematics.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Menezes, Alfred J., et al., “Reducing Elliptic Curve Logarithms to Logarithms in a Finite Field,” (0018-9448/93 1993 IEEE, IEEE Transactions on Information . . . ), 8 pages.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>Frey, Gerhard et al., “A Remark Concerning m-Divisibility and the Discrete Logarithm in the Divisor Class Group of Curves,” Mathematics of Computation, vol. 62, No. 206, Apr. 1994, pp. 865-874.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>Hess, Florian et al., “Two Topics in Hyperelliptic Cryptography,” S. Vaudenay &amp; A. Youssef (Eds.): SAC 2001, LNCS 2259, pp. 181-189, 2001.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Boneh, Dan, et al., “Short signatures from the Weil pairing,” pp. 1-17.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>Galbraith, Steven D. et al., “Implementing the Tate Pairing,” Mathematics Dept., Royal Holloway, University of London, Egham, Surrey, UK &amp; Hewlett-Packard Laboratories, Bristol, Filton Road, Stoke Gifford, Bristol, UK, pp. 1-14.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>Cantor, David G., “Computing in the Jacobian of a Hyperelliptic Curve,” Mathematics of Computation, vol. 48, No. 177, Jan. 1987, pp. 95-101.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00018">
<othercit>Barreto, Paulo S.L.M., et al., “Efficient Algorithms for Pairing-Based Cryptosystems,” Universidade de Sao Paulo, Escola Politecnica, Sao Paulo (SP), Brazil &amp; Computer Science Department, Stanford University, USA, pp. 1-16.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00019">
<othercit>Joux, Antoine, “The Weil and Tate Pairings as Building Blocks for Public Key Cryptosystems (Survey),”C. Fieker and D.R. Kohel (eds.): ANTS 2002, LNCS 2369, pp. 20-32, 2002 (Springer-Verlag Berlin Heidelberg 2002).</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00020">
<othercit>Frey, et al., “The Tate Pairing and the Discrete Logarithm Applied to Elliptic Curve Cryptosystems”, IEEE Transactions on Information Theory, vol. 45, No. 5, Jul. 1999, pp. 1717-1719.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00021">
<othercit>Koblitz, “Elliptic Curve Cryptography”, Jan. 5, 2007, at &lt;&lt;http://www.msri.org/publications/ln/msri/1998/crypt/koblitz/1/banner/01.html&gt;&gt;, MSRI, Jan. 11, 1998, pp. 1-34.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>48</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>380 30</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>380 28</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>4</number-of-drawing-sheets>
<number-of-figures>4</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20050036609</doc-number>
<kind>A1</kind>
<date>20050217</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Eisentraeger</last-name>
<first-name>Anne Kirsten</first-name>
<address>
<city>Pasadena</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Lauter</last-name>
<first-name>Kristin E.</first-name>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Montgomery</last-name>
<first-name>Peter L.</first-name>
<address>
<city>San Rafael</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Lee &amp; Hayes, PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>MIcrosoft Corporation</orgname>
<role>02</role>
<address>
<city>Redmond</city>
<state>WA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Barron, Jr.</last-name>
<first-name>Gilberto</first-name>
<department>2132</department>
</primary-examiner>
<assistant-examiner>
<last-name>Lemma</last-name>
<first-name>Samson</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Methods and apparati are provided for use in determining “Squared Weil pairings” and/or “Squared Tate Pairing” based on an elliptic curve, for example, and which are then used to support cryptographic processing of selected information. Significant improvements are provided in computing efficiency over the conventional implementation of the Weil and Tate pairings. The resulting Squared Weil and/or Tate pairings can be substituted for conventional Weil or Tate pairings in a variety of applications.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="157.65mm" wi="104.90mm" file="US07298839-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="199.05mm" wi="106.34mm" file="US07298839-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="235.97mm" wi="168.23mm" file="US07298839-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="114.38mm" wi="129.29mm" file="US07298839-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="267.55mm" wi="196.77mm" file="US07298839-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">RELATED PATENT APPLICATIONS</heading>
<p id="p-0002" num="0001">This patent application is related to co-pending U.S. patent application Ser. No. 10/627,281, titled “Improved Weil and Tate Pairing Techniques Using Parabolas”, filed on Jul. 25, 2003.</p>
<heading id="h-0002" level="1">TECHNICAL FIELD</heading>
<p id="p-0003" num="0002">This invention relates to cryptography, and more particularly to methods and apparati that implement improved processing techniques for Weil and Tate pairings using elliptic curves.</p>
<heading id="h-0003" level="1">BACKGROUND</heading>
<p id="p-0004" num="0003">As computers have become increasingly commonplace in homes and businesses throughout the world, and such computers have become increasingly interconnected via networks (such as the Internet), security and authentication concerns have become increasingly important. One manner in which these concerns have been addressed is the use of a cryptographic technique involving a key-based cipher. Using a key-based cipher, sequences of intelligible data (typically referred to as plaintext) that collectively form a message are mathematically transformed, through an enciphering process, into seemingly unintelligible data (typically referred to as ciphertext). The enciphering can be reversed, allowing recipients of the ciphertext with the appropriate key to transform the ciphertext back to plaintext, while making it very difficult, if not nearly impossible, for those without the appropriate key to recover the plaintext.</p>
<p id="p-0005" num="0004">Public-key cryptographic techniques are one type of key-based cipher. In public-key cryptography, each communicating party has a public/private key pair. The public key of each pair is made publicly available (or at least available to others who are intended to send encrypted communications), but the private key is kept secret. In order to communicate a plaintext message using encryption to a receiving party, an originating party encrypts the plaintext message into a ciphertext message using the public key of the receiving party and communicates the ciphertext message to the receiving party. Upon receipt of the ciphertext message, the receiving party decrypts the message using its secret private key, and thereby recovers the original plaintext message.</p>
<p id="p-0006" num="0005">The RSA (Rivest-Shamir-Adleman) method is one well-known example of public/private key cryptology. To implement RSA, one generates two large prime numbers p and q and multiplies them together to get a large composite number N, which is made public. If the primes are properly chosen and large enough, it will be practically impossible (i.e., computationally infeasible) for someone who does not know p and q to determine them from knowing only N. However, in order to be secure, the size of N typically needs to be more than 1,000 bits. In some situations, such a large size makes the numbers too long to be practically useful.</p>
<p id="p-0007" num="0006">One such situation is found in authentication, which can be required anywhere a party or a machine must prove that it is authorized to access or use a product or service. An example of such a situation is in a product ID system for a software program(s), where a user must hand-enter a product ID sequence stamped on the outside of the properly licensed software package as proof that the software has been properly paid for. If the product ID sequence is too long, then it will be cumbersome and user unfriendly.</p>
<p id="p-0008" num="0007">Additionally, not only do software manufacturers lose revenue from unauthorized copies of their products, but software manufacturers also frequently provide customer support, of one form or another, for their products. In an effort to limit such support to their licensees, customer support staffs often require a user to first provide the product ID associated with his or her copy of the product for which support is sought as a condition for receiving support. Many current methods of generating product IDs, however, have been easily discerned by unauthorized users, allowing product IDs to be generated by unauthorized users.</p>
<p id="p-0009" num="0008">Given the apparent ease with which unauthorized users can obtain valid indicia, software manufacturers are experiencing considerable difficulty in discriminating between licensees and such unauthorized users in order to provide support to the former while denying it to the latter. As a result, manufacturers often unwittingly provide support to unauthorized users, thus incurring additional and unnecessary support costs. If the number of unauthorized users of a software product is sufficiently large, then these excess costs associated with that product can be quite significant.</p>
<p id="p-0010" num="0009">New curve-based cryptography techniques have recently been employed to allow software manufacturers to appreciably reduce the incidence of unauthorized copying of software products. For example, product IDs have been generated using elliptic curve cryptographic techniques. The resulting product IDs provide improved security. Curve-based cryptographic techniques may also be used to perform other types of cryptographic services.</p>
<p id="p-0011" num="0010">As curve-based cryptosystems grow in popularity, it would be useful to have new and improved techniques for performing the computations associated with the requisite mathematical operations. Hence, there is a continuing need for improved mathematical and/or computational methods and apparati in curve-based cryptosystems.</p>
<heading id="h-0004" level="1">SUMMARY</heading>
<p id="p-0012" num="0011">Methods and apparati are provided for determining “Squared Weil pairings” and/or “Squared Tate pairings” based on an elliptic curve, for example, and which are then used to support cryptographic processing of selected information. Significant improvements are provided in computing efficiency over conventional implementations of the Weil and Tate pairings. The resulting Squared Weil and/or Tate pairings can be substituted for conventional Weil or Tate pairings in a variety of applications.</p>
<p id="p-0013" num="0012">The above stated needs and/or others are met, for example, by a method that includes selecting an elliptic curve, determining a Squared Weil pairing based on the elliptic curve, and cryptographically processing selected information based on the Squared Weil pairing.</p>
<p id="p-0014" num="0013">Here, for example, an elliptic curve E over a field K may be used, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b. The method may then include establishing a point id that is defined as a point at infinity on E, and wherein P, Q, R, X are points on E wherein X is an indeterminate denoting an independent variable of a function, and wherein x(X), y(X) are functions mapping the point X on E to its affine x and y coordinates, and wherein a line passes through any three points P, Q, R which satisfy P+Q+R=id. Note, as used herein, a bold + or − operator denotes arithmetic in the elliptic curve group, whereas a normal + or − operator denotes arithmetic in the field K or in the integers.</p>
<p id="p-0015" num="0014">In certain implementations, P and Q are m-torsion points on E and m is an odd prime, and the method further includes determining the squared Weil pairing based on</p>
<p id="p-0016" num="0015">
<maths id="MATH-US-00001" num="00001">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
      <mo>-</mo>
      <msup>
        <mrow>
          <msub>
            <mi>e</mi>
            <mi>m</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>P</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mn>2</mn>
      </msup>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
where e<sub>m </sub>denotes the Weil-pairing.
</p>
<p id="p-0017" num="0016">Another exemplary method includes determining a Squared Weil Pairing e<sub>m</sub>(P, Q)<sup>2 </sup>by establishing an odd prime m and a curve E; and based on two m-torsion points P and Q on E, computing e<sub>m</sub>(P, Q)<sup>2</sup>. In certain further implementations, the method also includes forming a mathematical chain for m. For example, an addition chain or an addition-subtraction chain may be formed such that every element in the mathematical chain is a sum or difference of two earlier elements in the mathematical chain, which continues until m is included.</p>
<p id="p-0018" num="0017">Then, for example, for each j in the mathematical chain, a tuple
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0018">t<sub>j</sub>=[jP, jQ, n<sub>j</sub>, d<sub>j</sub>] is formed such that</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0019" num="0019">
<maths id="MATH-US-00002" num="00002">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>j</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0020" num="0020">In accordance with still other exemplary implementations, another method includes determining a Squared Weil pairing (m, P, Q), where m is an odd prime number, by setting t<sub>1</sub>=[P, Q, 1, 1], using an addition-subtraction chain to determine t<sub>m</sub>=[mP, mQ, n<sub>m</sub>, d<sub>m</sub>], and if n<sub>m </sub>and d<sub>m </sub>are nonzero, then determining:</p>
<p id="p-0021" num="0021">
<maths id="MATH-US-00003" num="00003">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>m</mi>
      </msub>
      <msub>
        <mi>d</mi>
        <mi>m</mi>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<br/>
and cryptographically processing selected information based on the Squared Weil pairing.
</p>
<p id="p-0022" num="0022">Another exemplary method includes selecting an elliptic curve, determining Squared Tate pairing based on the elliptic curve, and cryptographically processing selected information based on the Squared Tate pairing. Here, for example, an elliptic curve E over a field K with q=p<sup>n </sup>elements may be used, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b. Letting m be an odd prime dividing q−1 and P be an m-torsion point on E. Let Q≠id be a point on E. If P is not equal to a multiple of Q, the method may further include determining</p>
<p id="p-0023" num="0023">
<maths id="MATH-US-00004" num="00004">
<math overflow="scroll">
<mrow>
  <mrow>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>Q</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo>-</mo>
                <mi>Q</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mrow>
          <mi>q</mi>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mi>m</mi>
      </mfrac>
    </msup>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>v</mi>
        <mi>m</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>P</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<br/>
where ν<sub>m </sub>denotes the squared Tate-pairing.
</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0005" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0024" num="0024">The present invention is illustrated by way of example and not limitation in the figures of the accompanying drawings. The same numbers are used throughout the figures to reference like components and/or features.</p>
<p id="p-0025" num="0025"><figref idref="DRAWINGS">FIG. 1</figref> is a block diagram illustrating an exemplary cryptosystem in accordance with certain implementations of the present invention.</p>
<p id="p-0026" num="0026"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an exemplary system using a product identifier to validate software in accordance with certain implementations of the present invention.</p>
<p id="p-0027" num="0027"><figref idref="DRAWINGS">FIG. 3</figref> illustrates an exemplary process for use in curve-based cryptosystems in accordance with certain implementations of the present invention.</p>
<p id="p-0028" num="0028"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a more general exemplary computer environment which can be used in various implementations of the invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0006" level="1">DETAILED DESCRIPTION</heading>
<p id="h-0007" num="0000">Introduction</p>
<p id="p-0029" num="0029">The discussions herein assume a basic understanding of cryptography by the reader. For a basic introduction to cryptography, the reader is directed to a book written by Bruce Schneier and entitled “Applied Cryptography: Protocols, Algorithms, and Source Code in C,” published by John Wiley &amp; Sons with copyright 1994 (or second edition with copyright 1996).</p>
<p id="p-0030" num="0030">Described herein are techniques that can be used with a curve-based cryptosystem, and in particular elliptic curve-based cryptosystems. In certain examples, the techniques take the form of methods and apparati that can be implemented in logic within one or more devices. One such device, for example, is a computing device that is configured to perform at least a portion of the processing required for a particular cryptographic capability or application.</p>
<p id="p-0031" num="0031">The techniques provided herein can be implemented and/or otherwise adapted for use in a variety of cryptographic capabilities and applications. By way of example, the techniques may be employed to support: key generation logic, e.g., for one-round three-way key establishment applications; identity-based encryption logic; short signature logic, e.g., product identifier logic; and/or other like cryptographic logic.</p>
<p id="p-0032" num="0032">The term logic as used herein is meant to include any suitable form of logic that may be employed. Thus, for example, logic may include hardware, firmware, software, or any combination thereof.</p>
<p id="p-0033" num="0033">The term curve-based cryptosystem as used herein refers to logic that at least partially provides for curve-based encryption and/or decryption using key(s) that are generated based at least partially on aspects or characteristics of an elliptic curve or other like curve.</p>
<p id="p-0034" num="0034">Such curve-based cryptosystems can be used to encrypt any of a wide variety of information. Here, for example, one exemplary cryptosystem is described primarily with respect to generation of a short signature or product identifier, which is a code that allows validation and/or authentication of a machine, program, user, etc. The signature is a “short” signature in that it uses a relatively small number of characters.</p>
<p id="p-0035" num="0035">With this in mind, attention is drawn to <figref idref="DRAWINGS">FIG. 1</figref>, which is a block diagram illustrating an exemplary cryptosystem <b>100</b> in accordance with certain implementations of the present invention. Cryptosystem <b>100</b> includes an encryptor <b>102</b> and a decryptor <b>104</b>. A plaintext message <b>106</b> is received at an input module <b>108</b> of encryptor <b>102</b>, which is a curve-based encryptor that encrypts message <b>106</b> based on a public key generated based on a secret known by decryptor <b>104</b>. Plaintext message <b>106</b> is typically an unencrypted message, although encryptor <b>102</b> can encrypt any type of message/data. Thus, message <b>106</b> may alternatively be encrypted or encoded by some other component (not shown) or a user.</p>
<p id="p-0036" num="0036">An output module <b>110</b> of encryptor <b>102</b> outputs the encrypted version of plaintext message <b>106</b>, which is ciphertext <b>112</b>. Ciphertext <b>112</b> can then be communicated to decryptor <b>104</b>, which can be implemented, for example, on a computer system remote from a computer system on which encryptor <b>102</b> is implemented. Given the encrypted nature of ciphertext <b>112</b>, the communication link between encryptor <b>102</b> and <b>104</b> need not be secure (it is typically presumed that the communication link is not secure). The communication link can be any of a wide variety of public and/or private networks implemented using any of a wide variety of conventional public and/or proprietary protocols, and including both wired and wireless implementations. Additionally, the communication link may include other non-computer network components, such as hand-delivery of media including ciphertext or other components of a product distribution chain.</p>
<p id="p-0037" num="0037">Decryptor <b>104</b> receives ciphertext <b>112</b> at input module <b>114</b> and, being aware of the secret used to encrypt message <b>106</b>, is able to readily decrypt ciphertext <b>112</b> to recover the original plaintext message <b>106</b>, which is output by output module <b>116</b> as plaintext message <b>118</b>. Decryptor <b>104</b> is a curve-based decryptor that decrypts the message based on the same curve as was used by encryptor <b>102</b>.</p>
<p id="p-0038" num="0038">Encryption and decryption are performed in cryptosystem <b>100</b> based on a secret, such as points on the elliptic curve. This secret is known to decryptor <b>104</b>, and a public key generated based on the secret is known to encryptor <b>102</b>. This knowledge allows encryptor <b>102</b> to encrypt a plaintext message that can be decrypted only by decryptor <b>104</b>. Other components, including encryptor <b>102</b>, which do not have knowledge of the secret cannot decrypt the ciphertext (although decryption may be technically possible, it is not computationally feasible). Similarly, decryptor <b>104</b> can also generate a message using the secret and based on a plaintext message, a process referred to as digitally signing the plaintext message. This signed message can then be communicated to other components, such as encryptor <b>102</b>, which can in turn verify the digital signature based on the public key.</p>
<p id="p-0039" num="0039"><figref idref="DRAWINGS">FIG. 2</figref> illustrates an exemplary system using a product identifier to validate software in accordance with certain implementations of the present invention. FIG. illustrates a software copy generator <b>120</b> including a product identifier (ID) generator <b>122</b>. Software copy generator <b>120</b> produces software media <b>124</b> (e.g., a CD-ROM, DVD (Digital Versatile Disk)) that contains typically all the files needed to collectively implement a complete copy of one or more application programs, (e.g., a word processing program, a spreadsheet program, an operating system, a suite of programs). These files are received from source files <b>126</b>, which may be a local source (e.g., a hard drive internal to generator <b>120</b>), a remote source (e.g., coupled to generator <b>120</b> via a network), or a combination thereof. Although only a single generator <b>120</b> is illustrated in <figref idref="DRAWINGS">FIG. 2</figref>, typically multiple such generators operate individually and/or cooperatively to increase the rate at which software media <b>124</b> can be generated.</p>
<p id="p-0040" num="0040">Product ID generator <b>122</b> generates a product ID <b>128</b> that can include numbers, letters, and/or other symbols. Generator <b>122</b> generates product ID <b>128</b> using the curve-based encryption techniques described herein. The product ID <b>128</b> is typically printed on a label and affixed to either a carrier containing software media <b>124</b> or a box into which software media <b>124</b> is placed. Alternatively, the product ID <b>128</b> may be made available electronically, such as a certificate provided to a user when receiving a softcopy of the application program via an on-line source (e.g., downloading of the software via the Internet). The product ID can serve multiple functions. First, the product ID can be cryptographically validated in order to verify that the product ID is a valid product ID (and thus allowing, for example, the application program to be installed). Additionally, the product ID can optionally serve to authenticate the particular software media <b>124</b> to which it is associated.</p>
<p id="p-0041" num="0041">The generated software media <b>124</b> and associated product ID <b>128</b> are then provided to a distribution chain <b>130</b>. Distribution chain <b>130</b> represents any of a variety of conventional distribution systems and methods, including possibly one or more “middlemen” (e.g., wholesalers, suppliers, distributors, retail stores (either on-line or brick and mortar), etc.). Regardless of the manner in which media <b>124</b> and the associated product ID <b>128</b> are distributed, eventually media <b>124</b> and product ID <b>128</b> are purchased (e.g., licensed), by the user of a client computer <b>132</b>.</p>
<p id="p-0042" num="0042">Client computer <b>132</b> includes a media reader <b>134</b> capable of reading software media <b>124</b> and installing the application program onto client computer <b>132</b> (e.g., installing the application program on to a hard disk drive (not shown) of client computer <b>132</b>). Part of this installation process involves entry of the product ID <b>128</b>. This entry may be a manual entry (e.g., the user typing in the product ID via a keyboard), or alternatively an automatic entry (e.g., computer <b>132</b> automatically accessing a particular field of a license associated with the application program and extracting the product ID there from). Client computer <b>132</b> also includes a product ID validator <b>136</b> which validates, during installation of the application program, the product ID <b>128</b>. This validation is performed using the curve-based decryption techniques.</p>
<p id="p-0043" num="0043">If validator <b>136</b> determines that the product ID is valid, then an appropriate course of action is taken (e.g., an installation program on software media <b>124</b> allows the application to be installed on computer <b>132</b>). However, if validator <b>136</b> determines that the product ID is invalid, then a different course of action is taken (e.g., the installation program terminates the installation process preventing the application program from being installed).</p>
<p id="p-0044" num="0044">Product ID validator <b>136</b> also optionally authenticates the application program based on the product ID <b>128</b>. This authentication verifies that the product ID <b>128</b> entered at computer <b>132</b> corresponds to the particular copy of the application being accessed. The authentication can be performed at different times, such as during installation, or when requesting product support or an upgrade. Alternatively, this authentication may be performed at a remote location (e.g., at a call center when the user of client computer <b>132</b> calls for technical support, the user may be required to provide the product ID <b>128</b> before receiving assistance).</p>
<p id="p-0045" num="0045">If the application program manufacturer desires to utilize the authentication capabilities of the product ID, then the product ID generated by generator <b>122</b> for each copy of an application program is unique. This uniqueness is created by assigning a different initial number or value to each copy of the application program. This initial value can then be used as a basis for generating the product ID.</p>
<p id="p-0046" num="0046">The unique value associated with the copy of the application program can be optionally maintained by the manufacturer as an authentication record <b>138</b> (e.g., a database or list) along with an indication of the particular copy of the application program. This indication can be, for example, a serial number embedded in the application program or on software media <b>124</b>, and may be hidden in any of a wide variety of conventional manners.</p>
<p id="p-0047" num="0047">Alternatively, the individual number itself may be a serial number that is associated with the particular copy, thereby allowing the manufacturer to verify the authenticity of an application program by extracting the initial value from the product ID and verifying that it is the same as the serial number embedded in the application program or software media <b>124</b>.</p>
<p id="p-0048" num="0048">Appropriate action can be taken based on whether the product ID is authenticated. These actions can vary, depending on the manufacturer's desires and/or action being taken at computer <b>132</b> that caused the authentication check to occur. For example, if a user is attempting to install an application program then installation of the program may be allowed only if the authentication succeeds. By way of another example, the manufacturer's support technicians may provide assistance to a user of computer <b>132</b> only if the authentication succeeds, or an upgrade version of the application program may be installed only if authentication of the previous version of the application program succeeds.</p>
<p id="p-0049" num="0049">The logic of certain curve-based cryptosystems utilizes what are commonly referred to as “Weil and Tate pairings” during a signature verification process when using elliptic curves. The Weil and Tate pairings have been proposed for use in many aspects of cryptography. They may be used, for example, to form efficient protocols to do one-round three-way key establishment, identity-based encryption, short signatures, and the like.</p>
<p id="p-0050" num="0050">It is important, however, given the amount of processing to have efficient implementations of the Weil and Tate pairings to cut down on the cost of implementing these protocols. Computation of the Weil or Tate pairing in conventional cryptosystems typically follows “Miller's algorithm”, which is described, for example, in “Identity-Based Encryption From The Weil Pairing”, by Dan Boneh and Matthew Franklin, published in SIAM J. of Computing, Vol. 32, No. 3, pp. 586-615, 2003.</p>
<p id="p-0051" num="0051">As is well-known, for a fixed positive integer m, the Weil pairing e<sub>m </sub>is a bilinear map that takes as input two m-torsion points on an elliptic curve, and outputs an m<sup>th </sup>root of unity. For elliptic curves, as is well-known, the Tate pairing is related to the Weil pairing by the fact that the Weil pairing is a quotient of the output of two applications of the Tate pairing. The algorithms for these pairings depend on constructing rational functions with a prescribed pattern of poles and zeros.</p>
<p id="p-0052" num="0052">The Miller algorithm as typically implemented in conventional curve-based cryptosystems calls for the evaluation of the Weil or Tate pairing by evaluating a function at two selected points on the elliptic curve, wherein one of the points is formed from a “random” point selected using a randomly generated input. Unfortunately, there is a chance that the Miller algorithm will essentially fail with some random input values, due to a division by zero. When the Miller algorithm fails, then the logic will usually need to rerun the Miller algorithm using a different random input value. Although the failure rate of the Miller algorithm tends to be fairly low, if it is required to be run thousands or millions of times, eventually the processing delays may become significant. Also, if the computations are performed in a parallel processing environment, the completions may be slowed or delayed as some of the processing pipelines or the like are required to rerun the Miller algorithm. Real-time applications, which have rigid bounds on maximum computation time rather than average computation time, may not be able to afford the reruns.</p>
<p id="p-0053" num="0053">The improved techniques described herein provide increased efficiency and an alternative method to the standard methods which have been proposed. For example, in accordance with certain aspects of the present invention, the improved techniques do not require a randomly chosen m-torsion point as described above and as such always generate a correct answer.</p>
<p id="p-0054" num="0054">With this exemplary improvement in mind, in the following sections an improved algorithm is described for computing what is hereby referred to as the “squared Weil pairing”, e<sub>m</sub>(P, Q)<sup>2</sup>. With the squared Weil pairing, one may obtain a significant speed-up over the standard implementation of the Weil pairing (Miller's algorithm). While the Tate pairing is already more efficient to implement than the Weil pairing, the improved techniques herein can also be employed in an improved algorithm for computing the “squared Tate pairing” for elliptic curves. The squared Weil pairing and/or the squared Tate pairing can be substituted for the Weil or Tate pairings in any of the above applications.</p>
<p id="p-0055" num="0055">By way of further reference, other exemplary curve-based cryptosystems are provided in the following references: “Short Signatures from the Weil Pairing”, by Dan Boneh, et al., in <i>Advances in Cryptography—Asiacrypt </i>2001, Lecture Notes in Computer Science, Vol. 2248, Springer-Verlag, pp. 514-532; and, “The Weil and Tate Pairings as Building Blocks for Public Key Cryptosystems (Survey)”, by Antoine Joux, in <i>Algorithmic Number Theory, </i>5<sup>th </sup><i>International Symposium ANTS</i>-<i>V, Sydney, Australia, July </i>2002 <i>proceedings, Claus Fieker and David R. Kohel </i>(<i>Eds</i>), Lecture Notes in Computer Science, Vol. 2369, Springer-Verlag, pp. 20-32.</p>
<p id="p-0056" num="0056">Attention is now drawn to <figref idref="DRAWINGS">FIG. 3</figref>, which is a flow diagram illustrating an exemplary process <b>150</b> for use in comparing the Weil and Tate pairings for elliptic curves. In act <b>152</b>, an addition chain, addition-subtraction chain, or the like, is formed for m, wherein m is an integer greater than zero and an m-torsion point P is fixed on an elliptic curve E. In act <b>154</b>, ((j+k)P, ƒ<sub>j+k,P</sub>(X)) is determined using (jP, ƒ<sub>j,P</sub>(X)) and (kP, ƒ<sub>j,P</sub>(X)), wherein j and k are integers, jP, kP and (j+k)P are multiples of point P and ƒ<sub>j,P</sub>(X), ƒ<sub>k,P</sub>(X) and ƒ<sub>j+k,P</sub>(X) are functions in the indeterminate X, and ((j+k)P, ƒ<sub>j+k,P</sub>(X)) represents an iterative building block for forming the output of the pairing via a chain. With Weil pairing, for example, ((j+k)P, ƒ<sub>j+k,P</sub>(X)) can also be run with P replaced by another m-torstion point Q, i.e., ((j+k)Q, ƒ<sub>j+k,Q</sub>(X)). In act <b>156</b>, h<sub>j+k </sub>is determined given h<sub>j </sub>and h<sub>k</sub>, wherein h<sub>j</sub>, h<sub>k </sub>and h<sub>j+k </sub>are field elements and for example,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>h</i><sub>j</sub>=ƒ<sub>j,P</sub>(<i>Q</i><sub>1</sub>)/ƒ<sub>j,P</sub>(<i>Q</i><sub>2</sub>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
for certain points Q<sub>1 </sub>and Q<sub>2 </sub>(independent of j) on E and the goal is to compute h<sub>m</sub>. In conventional Miller algorithms Q<sub>1 </sub>and Q<sub>2 </sub>are random value inputs.
</p>
<p id="p-0057" num="0057">In certain improvements provided herein, for example, an improved algorithm essentially produces:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>h′</i><sub>j</sub>:=ƒ<sub>jP</sub>(<i>Q</i>)/ƒ<sub>jP</sub>(−<i>Q</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
wherein −Q=id−Q is the complement of Q. When the elliptic curve is given as E:y<sup>2</sup>=x<sup>3</sup>+ax+b, then the complement of a point is the reflection of the point over the x-axis, which for an elliptic curve is the additive inverse of the point.
</p>
<p id="p-0058" num="0058">In accordance with certain aspects of the present invention, an improvement is made to act <b>156</b> wherein squared Weil pairing is introduced. In accordance with certain further aspects of the present invention, an improvement is made to a subprocess of act <b>154</b> wherein a parabola is introduced for computing Weil and Tate pairings in a manner that reduces the number of computation steps required. Improved cryptosystems may implement either one or both of these aspects of the present invention.</p>
<p id="h-0008" num="0000">Squared Weil Pairing for Elliptic Curves</p>
<p id="p-0059" num="0059">The purpose of this section is to construct a new pairing, referred to as squared Weil pairing, which has the advantage of being more efficient to compute than Miller's algorithm for the original Weil pairing. The improved algorithm presented herein has the advantage that it is guaranteed to output the correct answer since it does not depend on inputting a randomly chosen m-torsion point. As mentioned earlier, certain conventional implementations of Miller's algorithm sometimes require more than one iteration of the algorithm, since the randomly chosen m-torsion point may cause the algorithm to fail at times.</p>
<p id="p-0060" num="0060">Let E: y<sup>2</sup>=x<sup>3</sup>+ax+b be an elliptic curve over a field K, not of characteristic 2 or 3. Characteristic 2 and 3 can be handled by introducing the more general equation for an elliptic curve.</p>
<p id="p-0061" num="0061">Introducing some further notation, let:
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0000">
    <ul id="ul0004" list-style="none">
        <li id="ul0004-0001" num="0062">id be the point at infinity on E;</li>
        <li id="ul0004-0002" num="0063">P, Q, R, X (capitals) be points on E, wherein X is an indeterminate denoting the (main) independent variable of a function;</li>
        <li id="ul0004-0003" num="0064">x(X), y(X) be (rational) functions mapping a point X on E to its (affine) x and y-coordinates;</li>
        <li id="ul0004-0004" num="0065">Let line (P, Q, R)(X) denote the equation of the line (linear in x(X) and y(X)) passing through three points P, Q, R on E, which satisfy P+Q+R=id, and wherein when two of P, Q, R are equal, this is a tangent line at that common point.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0062" num="0066">Function ƒ<sub>j,P </sub>and its Construction</p>
<p id="p-0063" num="0067">If j is an integer and P a point on E, then ƒ<sub>j,P </sub>and ƒ<sub>j,P</sub>(X) will refer to a rational function on E whose divisor of zeros and poles is:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>(ƒ<sub>j,P</sub>)=<i>j</i>(<i>P</i>)−(<i>jP</i>)−(<i>j−</i>1)(<i>id</i>),<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
where parentheses around a point on E indicate that it is being considered formally as a point on E. If j&gt;1 and P, jP, and id are distinct, then ƒ<sub>j,P</sub>(X) has a j-fold zero at X=P, a simple pole at X=jP, a (j−1)-fold pole at infinity (i.e., at X=id), and no other poles or zeros.
</p>
<p id="p-0064" num="0068">The theory of divisors states that ƒ<sub>j,P </sub>exists and is unique up to a nonzero scale factor (multiplicative constant). If Q<sub>1 </sub>and Q<sub>2 </sub>are given, then the quotient ƒ<sub>j,P</sub>(Q<sub>1</sub>)/ƒ<sub>j,P</sub>(Q<sub>2</sub>) is well-defined unless a division by zero occurs.</p>
<p id="p-0065" num="0069">When j=0 or j=1, ƒ<sub>j,P </sub>can be any nonzero constant.</p>
<p id="p-0066" num="0070">If one knows ƒ<sub>j,P </sub>and ƒ<sub>j,P </sub>for two integers j and k, then a simple, well-known, construction gives ƒ<sub>−j−k,P</sub>. One wants ƒ<sub>−j−k,P </sub>to satisfy
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>(ƒ<sub>−j−k,P</sub>ƒ<sub>j,P</sub>ƒ<sub>k,P</sub>)=(ƒ<sub>−j−k,P</sub>)+(ƒ<sub>j,P</sub>)+(ƒ<sub>k,P</sub>)=3(<i>id</i>)−((−<i>j−k</i>)<i>P</i>)−(<i>jP</i>)−(<i>kP</i>).<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
This will be satisfied if we choose ƒ<sub>−j−k,P </sub>so that:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>ƒ<sub>−j−k,P</sub>(<i>X</i>)ƒ<sub>j,P</sub>(<i>X</i>)ƒ<sub>k,P</sub>(<i>X</i>)line(<i>jP, kP</i>, (−<i>j−k</i>)<i>P</i>)(<i>X</i>)=constant.<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Then repeating this construction on ƒ<sub>0,P </sub>and ƒ<sub>−j−k,P </sub>gives ƒ<sub>j+k,P</sub>. The line through 0P=id, (−j−k)P, and (j+k)P is vertical (i.e., its equation does not reference the y-coordinate). This results in the useful constructions
</p>
<p id="p-0067" num="0071">
<maths id="MATH-US-00005" num="00005">
<math overflow="scroll">
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mrow>
            <mi>j</mi>
            <mo>+</mo>
            <mi>k</mi>
          </mrow>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>k</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mfrac>
        <mrow>
          <mi>line</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.3em" height="0.3ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>jP</mi>
              <mo>,</mo>
              <mi>kP</mi>
              <mo>,</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mrow>
                      <mo>-</mo>
                      <mi>j</mi>
                    </mrow>
                    <mo>-</mo>
                    <mi>k</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>⁢</mo>
                <mi>P</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <mrow>
            <mi>line</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>id</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>j</mi>
                      <mo>+</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
    </mrow>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00005-2" num="00005.2">
<math overflow="scroll">
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mrow>
            <mi>j</mi>
            <mo>-</mo>
            <mi>k</mi>
          </mrow>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.6em" height="0.6ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.6em" height="0.6ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>id</mi>
            <mo>,</mo>
            <mi>jP</mi>
            <mo>,</mo>
            <mrow>
              <mo>-</mo>
              <mi>jP</mi>
            </mrow>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.6em" height="0.6ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mi>line</mi>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mrow>
                <mo>-</mo>
                <mi>jP</mi>
              </mrow>
              <mo>,</mo>
              <mi>kP</mi>
              <mo>,</mo>
              <mrow>
                <mrow>
                  <mo>(</mo>
                  <mrow>
                    <mi>j</mi>
                    <mo>-</mo>
                    <mi>k</mi>
                  </mrow>
                  <mo>)</mo>
                </mrow>
                <mo>⁢</mo>
                <mi>P</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
</math>
</maths>
</p>
<p id="p-0068" num="0072">Other possibly useful formulae include:
<ul id="ul0005" list-style="none">
    <li id="ul0005-0001" num="0000">
    <ul id="ul0006" list-style="none">
        <li id="ul0006-0001" num="0073">ƒ<sub>j,id</sub>=constant;</li>
        <li id="ul0006-0002" num="0074">ƒ<sub>j,−P</sub>(X)=ƒ<sub>j,P</sub>(−X)*(constant);</li>
        <li id="ul0006-0003" num="0075">If (P+Q+R=id), then:</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0069" num="0076">
<maths id="MATH-US-00006" num="00006">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>R</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>P</mi>
            <mo>,</mo>
            <mi>Q</mi>
            <mo>,</mo>
            <mi>R</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
          <mi>j</mi>
        </msup>
      </mrow>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>jP</mi>
            <mo>,</mo>
            <mi>jQ</mi>
            <mo>,</mo>
            <mi>jR</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0070" num="0077">Squared Weil-Pairing Formula</p>
<p id="p-0071" num="0078">Let m be an odd prime. Suppose P and Q are m-torsion points on E, with neither being the identity and P not equal to ±Q.</p>
<p id="p-0072" num="0079">Then</p>
<p id="p-0073" num="0080">
<maths id="MATH-US-00007" num="00007">
<math overflow="scroll">
<mrow>
  <mfrac>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>Q</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>P</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>Q</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>P</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mfrac>
  <mo>-</mo>
  <msup>
    <mrow>
      <msub>
        <mi>e</mi>
        <mi>m</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>P</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mn>2</mn>
  </msup>
</mrow>
</math>
</maths>
<br/>
where e<sub>m </sub>denotes the Weil-pairing.
<br/>
Exemplary Algorithm for e<sub>m</sub>(P, Q)<sup>2 </sup>
</p>
<p id="p-0074" num="0081">Fix an odd prime m and the curve E. Given two m-torsion points P and Q on E, one needs to compute e<sub>m</sub>(P, Q)<sup>2</sup>.</p>
<p id="p-0075" num="0082">In accordance with certain exemplary implementations of the present invention, the algorithm includes forming an addition or addition-subtraction chain for m. That is, after an initial 1, every element in the chain is a sum or difference of two earlier elements in the chain, until an m appears. Well-known techniques, give a chain of length O(log(m)).</p>
<p id="p-0076" num="0083">For each j in the addition-subtraction chain, form a tuple
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>t<sub>j</sub>=[jP, jQ, n<sub>j</sub>, d<sub>j</sub>]<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
such that n<sub>j </sub>and d<sub>j </sub>are field elements such that
</p>
<p id="p-0077" num="0084">
<maths id="MATH-US-00008" num="00008">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>j</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
<br/>
Keeping track of the numerators and denominators separately until the end is optional.
<br/>
To do this, start with t<sub>1</sub>=[P, Q, 1, 1]. Given t<sub>j </sub>and t<sub>k</sub>, this procedure gets t<sub>j+k</sub>:
<ul id="ul0007" list-style="none">
    <li id="ul0007-0001" num="0000">
    <ul id="ul0008" list-style="none">
        <li id="ul0008-0001" num="0085">form elliptic curve sums: jP+kP=(j+k)P and jQ+kQ=(j+k)Q;</li>
        <li id="ul0008-0002" num="0086">find line: line(jP, kP, (−j−k)P)(X)=c<b>0</b>+c<b>1</b>*x(X)+c<b>2</b>*y(X);</li>
        <li id="ul0008-0003" num="0087">find line: line(jQ, kQ, (−j−k)Q)(X)=c<b>0</b>′+c<b>1</b>′*x(X)+c<b>2</b>′*y(X).</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0078" num="0088">Set:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>n</i><sub>j+k</sub><i>=n</i><sub>j</sub><i>*n</i><sub>k</sub>*(<i>c</i>0+<i>c</i>1*<i>x</i>(<i>Q</i>)+<i>c</i>2*<i>y</i>(<i>Q</i>))*(<i>c</i>0′+<i>c</i>1′*<i>x</i>(<i>P</i>)−<i>c</i>2′*<i>y</i>(<i>P</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>and<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>d</i><sub>j+k</sub><i>=d</i><sub>j</sub><i>*d</i><sub>k</sub>*(<i>c</i>0+<i>c</i>1*<i>x</i>(<i>Q</i>)−<i>c</i>2*<i>y</i>(<i>Q</i>))*(<i>c</i>0′+<i>c</i>1′*<i>x</i>(<i>P</i>)+<i>c</i>2′*<i>y</i>(<i>P</i>)).<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0079" num="0089">A similar construction gives t<sub>j−k </sub>from t<sub>j </sub>and t<sub>k</sub>. Observe that the vertical lines through (j+k)P and (j+k)Q do not appear in the formulae for n<sub>j+k </sub>and d<sub>j+k, </sub>this is because the contributions from Q and −Q (or from P and −P) are equal. Here −Q is the complement of Q and −P is the complement of P.</p>
<p id="p-0080" num="0090">When j+k=m, one can further simplify this to n<sub>j+k</sub>=n<sub>j</sub>*n<sub>k </sub>and d<sub>j+k</sub>=d<sub>j</sub>*d<sub>k</sub>, since c<b>2</b> and c<b>2</b>′ will be zero.</p>
<p id="p-0081" num="0091">Pseudocode may take the following form, for example:</p>
<p id="p-0082" num="0092">
<tables id="TABLE-US-00001" num="00001">
<table frame="none" colsep="0" rowsep="0">
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="35pt" align="left"/>
<colspec colname="1" colwidth="182pt" align="left"/>
<thead>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</thead>
<tbody valign="top">
<row>
<entry/>
<entry>procedure Squared_Weil_Pairing(m, P, Q)</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="49pt" align="left"/>
<colspec colname="1" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>issue an error if m is not an odd prime.</entry>
</row>
<row>
<entry/>
<entry>if (P = id or Q = id or P = ±Q) then</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="63pt" align="left"/>
<colspec colname="1" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>return 1;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="49pt" align="left"/>
<colspec colname="1" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>else</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="63pt" align="left"/>
<colspec colname="1" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>t<sub>1 </sub>= [P, Q, 1, 1];</entry>
</row>
<row>
<entry/>
<entry>use an addition-subtraction chain to get</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="77pt" align="left"/>
<colspec colname="1" colwidth="140pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>t<sub>m</sub>=[mP, mQ, n<sub>m</sub>, d<sub>m</sub>].</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="63pt" align="left"/>
<colspec colname="1" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>issue an error if mP or mQ is not id.</entry>
</row>
<row>
<entry/>
<entry>if (n<sub>m </sub>= 0 or d<sub>m </sub>= 0) then</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="77pt" align="left"/>
<colspec colname="1" colwidth="140pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>return 1;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="63pt" align="left"/>
<colspec colname="1" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>else</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="77pt" align="left"/>
<colspec colname="1" colwidth="140pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>return −n<sub>m</sub>/d<sub>m</sub>;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="63pt" align="left"/>
<colspec colname="1" colwidth="154pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>end if;</entry>
</row>
</tbody>
</tgroup>
<tgroup align="left" colsep="0" rowsep="0" cols="2">
<colspec colname="offset" colwidth="49pt" align="left"/>
<colspec colname="1" colwidth="168pt" align="left"/>
<tbody valign="top">
<row>
<entry/>
<entry>end if;</entry>
</row>
<row>
<entry/>
<entry namest="offset" nameend="1" align="center" rowsep="1"/>
</row>
</tbody>
</tgroup>
</table>
</tables>
</p>
<p id="p-0083" num="0093">When n<sub>m </sub>and d<sub>m </sub>are nonzero, then the computation</p>
<p id="p-0084" num="0094">
<maths id="MATH-US-00009" num="00009">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>m</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>m</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>Q</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>P</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>⁢</mo>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>Q</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>P</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
has been successful, and the output is correct. If, however, some n<sub>m </sub>or d<sub>m </sub>is zero, then some factor such as c<b>0</b>+c<b>1</b>*x(Q)+c<b>2</b>*y(Q) must have vanished. That line was chosen to pass through jP, kP, and (−j−k)P, for some j and k.
</p>
<p id="p-0085" num="0095">This factor does not vanish at any other point on the elliptic curve. Therefore this factor can vanish only if Q=jP or Q=kP or Q=(−j−k)P for some j and k. In all of these cases Q will be a multiple of P, ensuring that
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>e<sub>m</sub>(P, Q)=1.<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
Squared Tate Pairing For Elliptic Curves
</p>
<p id="p-0086" num="0096">Squared Tate Pairing Formula</p>
<p id="p-0087" num="0097">Let m be an odd prime. Suppose P is an m-torsion point on E, and Q is a point on the curve, with neither being the identity and P not equal to a multiple of Q. Assume that E is defined over K, where K has q=p<sup>n </sup>elements and suppose m divides q−1. Then</p>
<p id="p-0088" num="0098">
<maths id="MATH-US-00010" num="00010">
<math overflow="scroll">
<mrow>
  <msup>
    <mrow>
      <mo>(</mo>
      <mfrac>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
      <mo>)</mo>
    </mrow>
    <mfrac>
      <mrow>
        <mi>q</mi>
        <mo>-</mo>
        <mn>1</mn>
      </mrow>
      <mi>m</mi>
    </mfrac>
  </msup>
  <mo>=</mo>
  <mrow>
    <msub>
      <mi>v</mi>
      <mi>m</mi>
    </msub>
    <mo>⁡</mo>
    <mrow>
      <mo>(</mo>
      <mrow>
        <mi>P</mi>
        <mo>,</mo>
        <mi>Q</mi>
      </mrow>
      <mo>)</mo>
    </mrow>
  </mrow>
</mrow>
</math>
</maths>
<br/>
where ν<sub>m </sub>denotes the squared Tate-pairing.
</p>
<p id="p-0089" num="0099">Exemplary Algorithm For ν<sub>m</sub>(P, Q)</p>
<p id="p-0090" num="0100">Fix an odd prime m and the curve E. Given an m-torsion point P on E and a point Q on E, one needs to compute ν<sub>m</sub>(P, Q).</p>
<p id="p-0091" num="0101">As before, one starts with an addition or addition-subtraction chain for m.</p>
<p id="p-0092" num="0102">For each j in the addition-subtraction chain, one then forms a tuple
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>t<sub>j</sub>=[jP, n<sub>j</sub>, d<sub>j</sub>]<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
such that
</p>
<p id="p-0093" num="0103">
<maths id="MATH-US-00011" num="00011">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>j</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</p>
<p id="p-0094" num="0104">Keeping track of the numerators and denominators separately until the end is optional.</p>
<p id="p-0095" num="0105">Start with t<sub>1</sub>=[P, 1, 1]. Given t<sub>j </sub>and t<sub>k</sub>, to get t<sub>j+k</sub>:
<ul id="ul0009" list-style="none">
    <li id="ul0009-0001" num="0000">
    <ul id="ul0010" list-style="none">
        <li id="ul0010-0001" num="0106">form the elliptic curve sum jP+kP=(j+k)P;</li>
        <li id="ul0010-0002" num="0107">find line(jP, kP, (−j−k)P)(X)=c<b>0</b>+c<b>1</b>*x(X)+c<b>2</b>*y(X);</li>
        <li id="ul0010-0003" num="0108">set:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>n</i><sub>j+k</sub><i>=n</i><sub>j</sub><i>*n</i><sub>k</sub>*(<i>c</i>0+<i>c</i>1*<i>x</i>(.)+<i>c</i>2*<i>y</i>(<i>Q</i>))<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>and<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>d</i><sub>j+k</sub><i>=d</i><sub>j</sub><i>*d</i><sub>k</sub>*(<i>c</i>0+<i>c</i>1*<i>x</i>(<i>Q</i>)−<i>c</i>2*<i>y</i>(<i>Q</i>)).<?in-line-formulae description="In-line Formulae" end="tail"?>
</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0096" num="0109">A similar construction gives t<sub>j−k </sub>from t<sub>j </sub>and t<sub>k</sub>. Observe that the vertical lines through (j+k)P and (j+k)Q do not appear in the formulae for n<sub>j+k </sub>and d<sub>j+k</sub>, because the contributions from Q and −Q are equal. When j+k=m, one can further simplify this to:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>n</i><sub>j+k</sub><i>=n</i><sub>j</sub><i>*n</i><sub>k </sub>and <i>d</i><sub>j+k</sub><i>=d</i><sub>j</sub><i>*d</i><sub>k</sub>,<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
since c<b>2</b> will be zero.
</p>
<p id="p-0097" num="0110">When n<sub>m </sub>and d<sub>m </sub>are nonzero, then the computation</p>
<p id="p-0098" num="0111">
<maths id="MATH-US-00012" num="00012">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>m</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>m</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>m</mi>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>Q</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>m</mi>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mo>-</mo>
          <mi>Q</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mfrac>
</mrow>
</math>
</maths>
<br/>
has been successful, and after raising to the (q−1)/m power, one will have the correct output. If, however, some n<sub>m </sub>or d<sub>m </sub>is zero, then some factor such as c<b>0</b>+c<b>1</b>*x(Q)+c<b>2</b>*y(Q) must have vanished. That line was chosen to pass through jP, kP, and (−j−k)P, for some j and k. It does not vanish at any other point on the elliptic curve. Therefore this factor can vanish only if Q=jP or Q=kP or Q=(−j−k)P for some j and k. In all of these cases Q will be a multiple of P.
</p>
<p id="p-0099" num="0112">The above techniques may be implemented through various forms of logic, including, for example, a programmed computer. Hence, <figref idref="DRAWINGS">FIG. 4</figref> illustrates a more general exemplary computer environment <b>400</b>, which can be used in various implementations of the invention. The computer environment <b>400</b> is only one example of a computing environment and is not intended to suggest any limitation as to the scope of use or functionality of the computer and network architectures. Neither should the computer environment <b>400</b> be interpreted as having any dependency or requirement relating to any one or combination of components illustrated in the exemplary computer environment <b>400</b>.</p>
<p id="p-0100" num="0113">Computer environment <b>400</b> includes a general-purpose computing device in the form of a computer <b>402</b>. Computer <b>402</b> can implement, for example, encryptor <b>102</b> or decryptor <b>104</b> of <figref idref="DRAWINGS">FIG. 1</figref>, generator <b>120</b> or client computer <b>132</b> of <figref idref="DRAWINGS">FIG. 2</figref>, either or both of modules <b>152</b> and <b>153</b> of <figref idref="DRAWINGS">FIG. 3</figref>, and so forth. Computer <b>402</b> represents any of a wide variety of computing devices, such as a personal computer, server computer, hand-held or laptop device, multiprocessor system, microprocessor-based system, programmable consumer electronics (e.g., digital video recorders), gaming console, cellular telephone, network PC, minicomputer, mainframe computer, distributed computing environment that include any of the above systems or devices, and the like.</p>
<p id="p-0101" num="0114">The components of computer <b>402</b> can include, but are not limited to, one or more processors or processing units <b>404</b>, a system memory <b>406</b>, and a system bus <b>408</b> that couples various system components including the processor <b>404</b> to the system memory <b>406</b>. The system bus <b>408</b> represents one or more of any of several types of bus structures, including a memory bus or memory controller, a peripheral bus, an accelerated graphics port, and a processor or local bus using any of a variety of bus architectures. By way of example, such architectures can include an Industry Standard Architecture (ISA) bus, a Micro Channel Architecture (MCA) bus, an Enhanced ISA (EISA) bus, a Video Electronics Standards Association (VESA) local bus, and a Peripheral Component Interconnects (PCI) bus also known as a Mezzanine bus.</p>
<p id="p-0102" num="0115">Computer <b>402</b> typically includes a variety of computer readable media. Such media can be any available media that is accessible by computer <b>402</b> and includes both volatile and non-volatile media, removable and non-removable media.</p>
<p id="p-0103" num="0116">The system memory <b>406</b> includes computer readable media in the form of volatile memory, such as random access memory (RAM) <b>410</b>, and/or non-volatile memory, such as read only memory (ROM) <b>412</b>. A basic input/output system (BIOS) <b>414</b>, containing the basic routines that help to transfer information between elements within computer <b>402</b>, such as during start-up, is stored in ROM <b>412</b>. RAM <b>410</b> typically contains data and/or program modules that are immediately accessible to and/or presently operated on by the processing unit <b>404</b>.</p>
<p id="p-0104" num="0117">Computer <b>402</b> may also include other removable/non-removable, volatile/non-volatile computer storage media. By way of example, <figref idref="DRAWINGS">FIG. 4</figref> illustrates a hard disk drive <b>416</b> for reading from and writing to a non-removable, non-volatile magnetic media (not shown), a magnetic disk drive <b>418</b> for reading from and writing to a removable, non-volatile magnetic disk <b>420</b> (e.g., a “floppy disk”), and an optical disk drive <b>422</b> for reading from and/or writing to a removable, non-volatile optical disk <b>424</b> such as a CD-ROM, DVD-ROM, or other optical media. The hard disk drive <b>416</b>, magnetic disk drive <b>418</b>, and optical disk drive <b>422</b> are each connected to the system bus <b>408</b> by one or more data media interfaces <b>425</b>. Alternatively, the hard disk drive <b>416</b>, magnetic disk drive <b>418</b>, and optical disk drive <b>422</b> can be connected to the system bus <b>408</b> by one or more interfaces (not shown).</p>
<p id="p-0105" num="0118">The disk drives and their associated computer-readable media provide non-volatile storage of computer readable instructions, data structures, program modules, and other data for computer <b>402</b>. Although the example illustrates a hard disk <b>416</b>, a removable magnetic disk <b>420</b>, and a removable optical disk <b>424</b>, it is to be appreciated that other types of computer readable media which can store data that is accessible by a computer, such as magnetic cassettes or other magnetic storage devices, flash memory cards, CD-ROM, digital versatile disks (DVD) or other optical storage, random access memories (RAM), read only memories (ROM), electrically erasable programmable read-only memory (EEPROM), and the like, can also be utilized to implement the exemplary computing system and environment.</p>
<p id="p-0106" num="0119">Any number of program modules can be stored on the hard disk <b>416</b>, magnetic disk <b>420</b>, optical disk <b>424</b>, ROM <b>412</b>, and/or RAM <b>410</b>, including by way of example, an operating system <b>426</b>, one or more application programs <b>428</b>, other program modules <b>430</b>, and program data <b>432</b>. Each of such operating system <b>426</b>, one or more application programs <b>428</b>, other program modules <b>430</b>, and program data <b>432</b> (or some combination thereof) may implement all or part of the resident components that support the distributed file system.</p>
<p id="p-0107" num="0120">A user can enter commands and information into computer <b>402</b> via input devices such as a keyboard <b>434</b> and a pointing device <b>436</b> (e.g., a “mouse”). Other input devices <b>438</b> (not shown specifically) may include a microphone, joystick, game pad, satellite dish, serial port, scanner, and/or the like. These and other input devices are connected to the processing unit <b>404</b> via input/output interfaces <b>440</b> that are coupled to the system bus <b>408</b>, but may be connected by other interface and bus structures, such as a parallel port, game port, or a universal serial bus (USB).</p>
<p id="p-0108" num="0121">A monitor <b>442</b> or other type of display device can also be connected to the system bus <b>408</b> via an interface, such as a video adapter <b>444</b>. In addition to the monitor <b>442</b>, other output peripheral devices can include components such as speakers (not shown) and a printer <b>446</b> which can be connected to computer <b>402</b> via the input/output interfaces <b>440</b>.</p>
<p id="p-0109" num="0122">Computer <b>402</b> can operate in a networked environment using logical connections to one or more remote computers, such as a remote computing device <b>448</b>. By way of example, the remote computing device <b>448</b> can be a personal computer, portable computer, a server, a router, a network computer, a peer device or other common network node, and the like. The remote computing device <b>448</b> is illustrated as a portable computer that can include many or all of the elements and features described herein relative to computer <b>402</b>.</p>
<p id="p-0110" num="0123">Logical connections between computer <b>402</b> and the remote computer <b>448</b> are depicted as a local area network (LAN) <b>450</b> and a general wide area network (WAN) <b>452</b>. Such networking environments are commonplace in offices, enterprise-wide computer networks, intranets, and the Internet.</p>
<p id="p-0111" num="0124">When implemented in a LAN networking environment, the computer <b>402</b> is connected to a local network <b>450</b> via a network interface or adapter <b>454</b>. When implemented in a WAN networking environment, the computer <b>402</b> typically includes a modem <b>456</b> or other means for establishing communications over the wide network <b>452</b>. The modem <b>456</b>, which can be internal or external to computer <b>402</b>, can be connected to the system bus <b>408</b> via the input/output interfaces <b>440</b> or other appropriate mechanisms. It is to be appreciated that the illustrated network connections are exemplary and that other means of establishing communication link(s) between the computers <b>402</b> and <b>448</b> can be employed.</p>
<p id="p-0112" num="0125">In a networked environment, such as that illustrated with computing environment <b>400</b>, program modules depicted relative to the computer <b>402</b>, or portions thereof, may be stored in a remote memory storage device. By way of example, remote application programs <b>458</b> reside on a memory device of remote computer <b>448</b>. For purposes of illustration, application programs and other executable program components such as the operating system are illustrated herein as discrete blocks, although it is recognized that such programs and components reside at various times in different storage components of the computing device <b>402</b>, and are executed by the data processor(s) of the computer.</p>
<p id="p-0113" num="0126">Computer <b>402</b> typically includes at least some form of computer readable media. Computer readable media can be any available media that can be accessed by computer <b>402</b>. By way of example, and not limitation, computer readable media may comprise computer storage media and communication media. Computer storage media includes volatile and nonvolatile, removable and non-removable media implemented in any method or technology for storage of information such as computer readable instructions, data structures, program modules or other data. Computer storage media include, but are not limited to, RAM, ROM, EEPROM, flash memory or other memory technology, CD-ROM, digital versatile disks (DVD) or other optical storage, magnetic cassettes, magnetic tape, magnetic disk storage or other magnetic storage devices, or any other media which can be used to store the desired information and which can be accessed by computer <b>402</b>. Communication media typically embody computer readable instructions, data structures, program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term “modulated data signal” means a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal. By way of example, and not limitation, communication media include wired media such as wired network or direct-wired connection, and wireless media such as acoustic, RF, infrared and other wireless media. Combinations of any of the above should also be included within the scope of computer readable media.</p>
<p id="p-0114" num="0127">The invention has been described herein in part in the general context of computer-executable instructions, such as program modules, executed by one or more computers or other devices. Generally, program modules include routines, programs, objects, components, data structures, etc. that perform particular tasks or implement particular abstract data types. Typically the functionality of the program modules may be combined or distributed as desired in various implementations.</p>
<p id="p-0115" num="0128">For purposes of illustration, programs and other executable program components such as the operating system are illustrated herein as discrete blocks, although it is recognized that such programs and components reside at various times in different storage components of the computer, and are executed by the data processor(s) of the computer.</p>
<p id="p-0116" num="0129">Alternatively, the invention may be implemented in hardware or a combination of hardware, software, smartcard, and/or firmware. For example, one or more application specific integrated circuits (ASICs) could be designed or programmed to carry out the invention.</p>
<p id="h-0009" num="0000">Conclusion</p>
<p id="p-0117" num="0130">Although the description above uses language that is specific to structural features and/or methodological acts, it is to be understood that the invention defined in the appended claims is not limited to the specific features or acts described. Rather, the specific features and acts are disclosed as exemplary forms of implementing the invention.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-math idrefs="MATH-US-00001" nb-file="US07298839-20071120-M00001.NB">
<img id="EMI-M00001" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00001.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00002" nb-file="US07298839-20071120-M00002.NB">
<img id="EMI-M00002" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00002.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00003" nb-file="US07298839-20071120-M00003.NB">
<img id="EMI-M00003" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00003.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00004" nb-file="US07298839-20071120-M00004.NB">
<img id="EMI-M00004" he="8.13mm" wi="76.20mm" file="US07298839-20071120-M00004.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00005 MATH-US-00005-2" nb-file="US07298839-20071120-M00005.NB">
<img id="EMI-M00005" he="14.14mm" wi="76.20mm" file="US07298839-20071120-M00005.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00006" nb-file="US07298839-20071120-M00006.NB">
<img id="EMI-M00006" he="7.45mm" wi="76.20mm" file="US07298839-20071120-M00006.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00007" nb-file="US07298839-20071120-M00007.NB">
<img id="EMI-M00007" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00007.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00008" nb-file="US07298839-20071120-M00008.NB">
<img id="EMI-M00008" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00008.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00009" nb-file="US07298839-20071120-M00009.NB">
<img id="EMI-M00009" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00009.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00010" nb-file="US07298839-20071120-M00010.NB">
<img id="EMI-M00010" he="8.13mm" wi="76.20mm" file="US07298839-20071120-M00010.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00011" nb-file="US07298839-20071120-M00011.NB">
<img id="EMI-M00011" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00011.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00012" nb-file="US07298839-20071120-M00012.NB">
<img id="EMI-M00012" he="6.69mm" wi="76.20mm" file="US07298839-20071120-M00012.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00013 MATH-US-00013-2" nb-file="US07298839-20071120-M00013.NB">
<img id="EMI-M00013" he="14.14mm" wi="76.20mm" file="US07298839-20071120-M00013.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00014" nb-file="US07298839-20071120-M00014.NB">
<img id="EMI-M00014" he="7.45mm" wi="76.20mm" file="US07298839-20071120-M00014.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00015" nb-file="US07298839-20071120-M00015.NB">
<img id="EMI-M00015" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00015.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00016 MATH-US-00016-2" nb-file="US07298839-20071120-M00016.NB">
<img id="EMI-M00016" he="14.14mm" wi="76.20mm" file="US07298839-20071120-M00016.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00017" nb-file="US07298839-20071120-M00017.NB">
<img id="EMI-M00017" he="7.45mm" wi="76.20mm" file="US07298839-20071120-M00017.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00018" nb-file="US07298839-20071120-M00018.NB">
<img id="EMI-M00018" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00018.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00019 MATH-US-00019-2" nb-file="US07298839-20071120-M00019.NB">
<img id="EMI-M00019" he="14.14mm" wi="76.20mm" file="US07298839-20071120-M00019.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00020" nb-file="US07298839-20071120-M00020.NB">
<img id="EMI-M00020" he="7.45mm" wi="76.20mm" file="US07298839-20071120-M00020.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00021" nb-file="US07298839-20071120-M00021.NB">
<img id="EMI-M00021" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00021.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00022" nb-file="US07298839-20071120-M00022.NB">
<img id="EMI-M00022" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00022.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00023" nb-file="US07298839-20071120-M00023.NB">
<img id="EMI-M00023" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00023.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00024" nb-file="US07298839-20071120-M00024.NB">
<img id="EMI-M00024" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00024.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00025" nb-file="US07298839-20071120-M00025.NB">
<img id="EMI-M00025" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00025.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00026" nb-file="US07298839-20071120-M00026.NB">
<img id="EMI-M00026" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00026.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00027" nb-file="US07298839-20071120-M00027.NB">
<img id="EMI-M00027" he="8.13mm" wi="76.20mm" file="US07298839-20071120-M00027.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00028" nb-file="US07298839-20071120-M00028.NB">
<img id="EMI-M00028" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00028.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00029" nb-file="US07298839-20071120-M00029.NB">
<img id="EMI-M00029" he="6.69mm" wi="76.20mm" file="US07298839-20071120-M00029.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00030" nb-file="US07298839-20071120-M00030.NB">
<img id="EMI-M00030" he="8.13mm" wi="76.20mm" file="US07298839-20071120-M00030.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00031" nb-file="US07298839-20071120-M00031.NB">
<img id="EMI-M00031" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00031.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00032" nb-file="US07298839-20071120-M00032.NB">
<img id="EMI-M00032" he="8.13mm" wi="76.20mm" file="US07298839-20071120-M00032.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-math idrefs="MATH-US-00033" nb-file="US07298839-20071120-M00033.NB">
<img id="EMI-M00033" he="7.03mm" wi="76.20mm" file="US07298839-20071120-M00033.TIF" alt="embedded image " img-content="math" img-format="tif"/>
</us-math>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method comprising:
<claim-text>selecting an elliptic curve;</claim-text>
<claim-text>determining a Squared Weil pairing based on the elliptic curve, wherein the elliptic curve includes an elliptic curve E over a field K, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b;</claim-text>
<claim-text>wherein determining the Squared Weil pairing based on the elliptic curve further includes establishing a point id that is defined as a point at infinity on E, and wherein P, Q, R, X are points on E wherein X is an indeterminate denoting an independent variable of a function, and wherein x(X), y(X) are functions mapping the point X on E to its affine x and y coordinates, and wherein a line passes through the points P, Q, R if P+Q+R=id;</claim-text>
<claim-text>wherein determining the Squared Weil pairing based on the elliptic curve further includes:</claim-text>
<claim-text>with a first function ƒ<sub>j,P </sub>and a second function ƒ<sub>k,P </sub>for two integers j and k, deriving a third function ƒ<sub>−j−k,P </sub>based on the first and second functions;</claim-text>
<claim-text>cryptographically processing selected information based on the Squared Weil pairing;</claim-text>
<claim-text>outputting validation of selected information based on the Squared Weir pairing; and</claim-text>
<claim-text>determining a course of action in response to validation of selected information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein when at least two of said P, Q, R points are equal, said line is a tangent line at a common point.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein (ƒ<sub>−j−k,P</sub>ƒ<sub>j,P</sub>ƒ<sub>k,P</sub>)=(ƒ<sub>−j−k,P</sub>)+(ƒ<sub>j,P</sub>)+(ƒ<sub>k,P</sub>)=3(id)−((−j−k)P)−(jP)−(kP).</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein ƒ<sub>−j−k,P</sub>(X)ƒ<sub>j,P</sub>(X)ƒ<sub>k,P</sub>(X)line(jP, kP, (−j−k)P)(X)=a constant.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein if j is an integer and P a point on E, then said first and second functions are rational functions on E whose divisor of zeros and poles is (ƒ<sub>j,P</sub>)=j(P)−(jP)−(j−1)(id).</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method as recited in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein if j&gt;1 and P, jP, and id are distinct, then said first function has a j-fold zero at X=P, a simple pole at X=jP, a (j−1)-fold pole at infinity, and no other poles or zeros.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method as recited in <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein if j equals 0 or 1 then said first function is a nonzero constant.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising determining ƒ<sub>0,P </sub>such that a line through 0P=id, (−j−k)P, and (j+k)P is vertical in that its equation does not reference a y-coordinate.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The method as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein:</claim-text>
<claim-text>
<maths id="MATH-US-00013" num="00013">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mrow>
              <mi>j</mi>
              <mo>+</mo>
              <mi>k</mi>
            </mrow>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <mi>line</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>jP</mi>
                <mo>,</mo>
                <mi>kP</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <mrow>
              <mi>line</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>id</mi>
                  <mo>,</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mrow>
                          <mo>-</mo>
                          <mi>j</mi>
                        </mrow>
                        <mo>-</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>P</mi>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>+</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>P</mi>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mi>and</mi>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00013-2" num="00013.2">
<math overflow="scroll">
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mrow>
            <mi>j</mi>
            <mo>-</mo>
            <mi>k</mi>
          </mrow>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>j</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>line</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>id</mi>
              <mo>,</mo>
              <mi>jP</mi>
              <mo>,</mo>
              <mrow>
                <mo>-</mo>
                <mi>jP</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>line</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>jP</mi>
                </mrow>
                <mo>,</mo>
                <mi>kP</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>j</mi>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
      <mo>.</mo>
    </mrow>
  </mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The method as recited in <claim-ref idref="CLM-00008">claim 8</claim-ref>, wherein:
<claim-text>ƒ<sub>j,id</sub>=constant;</claim-text>
<claim-text>ƒ<sub>j,−P</sub>(X)=ƒ<sub>j,P</sub>(−X)*(constant); and</claim-text>
<claim-text>if (P+Q+R=id), then:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00014" num="00014">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>R</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>P</mi>
            <mo>,</mo>
            <mi>Q</mi>
            <mo>,</mo>
            <mi>R</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
          <mi>j</mi>
        </msup>
      </mrow>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>jP</mi>
            <mo>,</mo>
            <mi>jQ</mi>
            <mo>,</mo>
            <mi>jR</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The method as recited in <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein P and Q are m-torsion points on E and m is an odd prime, and wherein determining said Squared Weil pairing further includes:
<claim-text>determining said squared Weil pairing based on</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00015" num="00015">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>-</mo>
    <msup>
      <mrow>
        <msub>
          <mi>e</mi>
          <mi>m</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>P</mi>
            <mo>,</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mn>2</mn>
    </msup>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where e<sub>m </sub>denotes the Weil-pairing.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The method as recited in <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein neither P nor Q is an identity and P is not equal to ±Q.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. A computer storage media having computer-implementable instructions for causing at least one processing unit to perform acts comprising:
<claim-text>determining a Squared Weil pairing based on an elliptic curve, wherein said elliptic curve includes an elliptic curve E over a field K, wherein F can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b;</claim-text>
<claim-text>determining the Squared Weil pairing based on the elliptic curve further includes establishing a point id that is defined as a point at infinity on E, and wherein P, Q, R, X are points on E wherein X is an indeterminate denoting an independent variable of a function, and wherein x(X), y(X) are functions mapping said point X on E to its affine x and y coordinates, and wherein a line passes through said points P, Q, R if P+Q+R=id;</claim-text>
<claim-text>wherein determining the Squared Weil pairing based on the elliptic curve further includes:</claim-text>
<claim-text>determining a first function ƒ<sub>j,P </sub>and a second function ƒ<sub>k,P </sub>for two integers j and k; and</claim-text>
<claim-text>determining a third function ƒ<sub>−j−k,P </sub>based on the first and second functions
<claim-text>cryptographically processing selected information based on the Squared Weil pairing;</claim-text>
</claim-text>
<claim-text>outputting validation of selected information based on the Squared Weil pairing and determining a course of action in response to the validation of selected information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The computer storage media as recited in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein (ƒ<sub>−j−k,P</sub>ƒ<sub>j,P</sub>ƒ<sub>k,P</sub>)=(ƒ<sub>−j−k,P</sub>)+(ƒ<sub>j,P</sub>)+(ƒ<sub>k,P</sub>)=3(id)−((−j−k)P)−(jP)−(kP).</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The computer storage media as recited in <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein ƒ<sub>−j−k,P</sub>(X)ƒ<sub>j,P</sub>(X)ƒ<sub>k,P</sub>(X)line(jP, kP, (−j−k)P)(X)=a constant.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The computer storage media as recited in <claim-ref idref="CLM-00014">claim 14</claim-ref>, wherein if j is an integer and P a point on E, then said first and second functions are rational functions on E whose divisor of zeros and poles is (ƒ<sub>j,P</sub>)=j(P)−(jP)−(j−1)(id).</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer storage media as recited in <claim-ref idref="CLM-00014">claim 14</claim-ref>, further comprising determining ƒ<sub>0,P </sub>such that a line through 0P=id, (−j−k)P, and (j+k)P is vertical in that it does not reference a y-coordinate.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer storage media as recited in <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein:</claim-text>
<claim-text>
<maths id="MATH-US-00016" num="00016">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mrow>
              <mi>j</mi>
              <mo>+</mo>
              <mi>k</mi>
            </mrow>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <mi>line</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>jP</mi>
                <mo>,</mo>
                <mi>kP</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <mrow>
              <mi>line</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>id</mi>
                  <mo>,</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mrow>
                          <mo>-</mo>
                          <mi>j</mi>
                        </mrow>
                        <mo>-</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>P</mi>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>+</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>P</mi>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mi>and</mi>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00016-2" num="00016.2">
<math overflow="scroll">
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mrow>
            <mi>j</mi>
            <mo>-</mo>
            <mi>k</mi>
          </mrow>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>j</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>line</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>id</mi>
              <mo>,</mo>
              <mi>jP</mi>
              <mo>,</mo>
              <mrow>
                <mo>-</mo>
                <mi>jP</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>line</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>jP</mi>
                </mrow>
                <mo>,</mo>
                <mi>kP</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>j</mi>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
      <mo>.</mo>
    </mrow>
  </mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer storage media as recited in <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein:
<claim-text>ƒ<sub>j,id</sub>=constant;</claim-text>
<claim-text>ƒ<sub>j,−P</sub>(X)=ƒ<sub>j,P</sub>(−X)*(constant); and</claim-text>
<claim-text>if (P+Q+R=id), then:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00017" num="00017">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>R</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>P</mi>
            <mo>,</mo>
            <mi>Q</mi>
            <mo>,</mo>
            <mi>R</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
          <mi>j</mi>
        </msup>
      </mrow>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>jP</mi>
            <mo>,</mo>
            <mi>jQ</mi>
            <mo>,</mo>
            <mi>jR</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer storage media as recited in <claim-ref idref="CLM-00013">claim 13</claim-ref>, wherein P and Q are m-torsion points on E and m is an odd prime, and wherein determining said Squared Weil pairing further includes:
<claim-text>determining said squared Weil pairing based on</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00018" num="00018">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>-</mo>
    <msup>
      <mrow>
        <msub>
          <mi>e</mi>
          <mi>m</mi>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>P</mi>
            <mo>,</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mn>2</mn>
    </msup>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where e<sub>m </sub>denotes the Weil-pairing.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. An apparatus comprising:
<claim-text>memory configured to store information suitable for use with using a cryptographic process;</claim-text>
<claim-text>a logic operatively coupled to the memory and configured to determine a Squared Weil pairing based on at least one elliptic curve;</claim-text>
<claim-text>wherein the logic is further configured to establishing a point id that is defined as a point at infinity on E, and wherein P, Q, R, X are points on E wherein X is an indeterminate denoting an independent variable of a function, and wherein x(X), y(X) are functions mapping the point X on E to its affine x and y coordinates, and wherein a line passes through the points P, Q, R if P+Q+R=id;</claim-text>
<claim-text>wherein the logic is further configured to determine a first function ƒ<sub>j,P </sub>and a second function ƒ<sub>k,P </sub>for two integers j and k, and a third function ƒ<sub>−j−k,P </sub>based on the first and second functions;</claim-text>
<claim-text>cryptographically process selected information stored in the memory based on the Squared Weil pairing;</claim-text>
<claim-text>a display device coupled to the logic for outputting validation of selected information; and</claim-text>
<claim-text>the logic determining a course of action in response to validation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The apparatus as recited in <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein said logic is further configured to determine an elliptic curve E over a field K, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The apparatus as recited in <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein (ƒ<sub>−j−k,P</sub>ƒ<sub>j,P</sub>ƒ<sub>k,P</sub>,)=(ƒ<sub>−j−k,P</sub>)+(ƒ<sub>k,P</sub>)+(ƒ<sub>k,P</sub>)=3(id)−((−j−k)P)−(jP)−(kP).</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The apparatus as recited in <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein ƒ<sub>−j−k,P</sub>(X)ƒ<sub>j,P</sub>(X)ƒ<sub>k,P</sub>(X)line(jP, kP, (−j−k)P)(X)=a constant.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The apparatus as recited in <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein if j is an integer and P a point on E, then the first and second functions are rational functions on E whose divisor of zeros and poles is (ƒ<sub>j,P</sub>)=j(P)−(jP)−(j−1)(id).</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The apparatus as recited in <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein the logic is further configured to determine ƒ<sub>0,P </sub>such that a line through 0P=id, (−j−k)P, and (j+k)P is vertical in that it does not reference a y-coordinate.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. The apparatus as recited in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein:</claim-text>
<claim-text>
<maths id="MATH-US-00019" num="00019">
<math overflow="scroll">
  <mrow>
    <mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mrow>
              <mi>j</mi>
              <mo>+</mo>
              <mi>k</mi>
            </mrow>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mo>=</mo>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>k</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mfrac>
          <mrow>
            <mi>line</mi>
            <mo>⁢</mo>
            <mstyle>
              <mspace width="0.3em" height="0.3ex"/>
            </mstyle>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mi>jP</mi>
                <mo>,</mo>
                <mi>kP</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mrow>
                        <mo>-</mo>
                        <mi>j</mi>
                      </mrow>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <mrow>
              <mi>line</mi>
              <mo>⁡</mo>
              <mrow>
                <mo>(</mo>
                <mrow>
                  <mi>id</mi>
                  <mo>,</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mrow>
                          <mo>-</mo>
                          <mi>j</mi>
                        </mrow>
                        <mo>-</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>P</mi>
                  </mrow>
                  <mo>,</mo>
                  <mrow>
                    <mrow>
                      <mo>(</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>+</mo>
                        <mi>k</mi>
                      </mrow>
                      <mo>)</mo>
                    </mrow>
                    <mo>⁢</mo>
                    <mi>P</mi>
                  </mrow>
                </mrow>
                <mo>)</mo>
              </mrow>
            </mrow>
            <mo>⁢</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
      </mrow>
    </mrow>
    <mo>,</mo>
    <mi>and</mi>
  </mrow>
</math>
</maths>
<maths id="MATH-US-00019-2" num="00019.2">
<math overflow="scroll">
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mrow>
            <mi>j</mi>
            <mo>-</mo>
            <mi>k</mi>
          </mrow>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>=</mo>
    <mrow>
      <mfrac>
        <mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>j</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mi>line</mi>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>id</mi>
              <mo>,</mo>
              <mi>jP</mi>
              <mo>,</mo>
              <mrow>
                <mo>-</mo>
                <mi>jP</mi>
              </mrow>
            </mrow>
            <mo>)</mo>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>k</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>X</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mstyle>
            <mspace width="0.6em" height="0.6ex"/>
          </mstyle>
          <mo>⁢</mo>
          <mrow>
            <mi>line</mi>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mrow>
                  <mo>-</mo>
                  <mi>jP</mi>
                </mrow>
                <mo>,</mo>
                <mi>kP</mi>
                <mo>,</mo>
                <mrow>
                  <mrow>
                    <mo>(</mo>
                    <mrow>
                      <mi>j</mi>
                      <mo>-</mo>
                      <mi>k</mi>
                    </mrow>
                    <mo>)</mo>
                  </mrow>
                  <mo>⁢</mo>
                  <mi>P</mi>
                </mrow>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mo>⁢</mo>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mfrac>
      <mo>.</mo>
    </mrow>
  </mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The apparatus as recited in <claim-ref idref="CLM-00026">claim 26</claim-ref>, wherein:
<claim-text>ƒ<sub>j,id</sub>=constant;</claim-text>
<claim-text>ƒ<sub>j,P</sub>)(X)=ƒ<sub>j,P</sub>(−X)*(constant); and</claim-text>
<claim-text>if (P+Q+R=id), then:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00020" num="00020">
<math overflow="scroll">
<mrow>
  <mrow>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>P</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
    <mo>⁢</mo>
    <mrow>
      <msub>
        <mi>f</mi>
        <mrow>
          <mi>j</mi>
          <mo>,</mo>
          <mi>R</mi>
        </mrow>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mi>X</mi>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>P</mi>
            <mo>,</mo>
            <mi>Q</mi>
            <mo>,</mo>
            <mi>R</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <msup>
          <mrow>
            <mo>(</mo>
            <mi>X</mi>
            <mo>)</mo>
          </mrow>
          <mi>j</mi>
        </msup>
      </mrow>
      <mrow>
        <mi>line</mi>
        <mo>⁢</mo>
        <mstyle>
          <mspace width="0.8em" height="0.8ex"/>
        </mstyle>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mi>jP</mi>
            <mo>,</mo>
            <mi>jQ</mi>
            <mo>,</mo>
            <mi>jR</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <mo>(</mo>
          <mi>X</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The apparatus as recited in <claim-ref idref="CLM-00021">claim 21</claim-ref>, wherein P and Q are m-torsion points on E and m is an odd prime, and wherein the logic is further configured to determine said squared Weil pairing based on</claim-text>
<claim-text>
<maths id="MATH-US-00021" num="00021">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
    <mo>=</mo>
    <mrow>
      <mo>-</mo>
      <msup>
        <mrow>
          <msub>
            <mi>e</mi>
            <mi>m</mi>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mi>P</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mn>2</mn>
      </msup>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where e<sub>m </sub>denotes the Weil-pairing.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. A computer storage media having computer-implementable instructions for causing at least one processing unit to perform acts comprising:
<claim-text>determining a Squared Weil Pairing e<sub>m</sub>(P,Q)<sup>2 </sup>by:
<claim-text>establishing an odd prime m on a curve E;</claim-text>
<claim-text>based on two m-torsion points P and Q on E, computing e<sub>m</sub>(P, Q)<sup>2</sup>;</claim-text>
</claim-text>
<claim-text>further comprising forming a mathematical chain for m selected from a group of mathematical chains comprising an addition chain and an addition-subtraction chain, such that every element in the mathematical chain is a sum or difference of two earlier elements in the mathematical chain, which continues until m is included in the mathematical chain;</claim-text>
<claim-text>wherein for each j in the mathematical chain, a tuple t<sub>j</sub>=[jP, jQ, n<sub>j</sub>, d<sub>j</sub>] is formed such that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00022" num="00022">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>j</mi>
      </msub>
      <msub>
        <mi>d</mi>
        <mi>j</mi>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>outputting validation of mathematical chain and</claim-text>
<claim-text>determining a course of action in response to validation of mathematical chain.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. An apparatus comprising:
<claim-text>memory configured to store information suitable for use with using a cryptographic process;</claim-text>
<claim-text>a processor logic operatively coupled to the memory and configured to determine a Squared Weil Pairing e<sub>m</sub>(P, Q)<sup>2 </sup>by establishing an odd prime m on a curve E, and based on two m-torsion points P and Q on E, computing e<sub>m</sub>(P, Q)<sup>2</sup>;</claim-text>
<claim-text>wherein the processor logic is further configured to form a mathematical chain for m that is selected from a group of mathematical chains comprising an addition chain and an addition-subtraction chain;</claim-text>
<claim-text>wherein for each j in the mathematical chain, the logic is further configured to form a tuple t<sub>j</sub>=[jP, jQ, n<sub>j</sub>, d<sub>j</sub>] such that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00023" num="00023">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>j</mi>
      </msub>
      <msub>
        <mi>d</mi>
        <mi>j</mi>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>j</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>a display device coupled to the processor logic for outputting validation of cryptographic process; and</claim-text>
<claim-text>the processor logic determining a course of action in response to cryptographic process.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. A method comprising:
<claim-text>determining a Squared Weil pairing (m, P, Q), where m is an odd prime number, by setting t<sub>1</sub>=[P, Q, 1, 1], using an addition-subtraction chain to determine t<sub>m</sub>=[mP, mQ, n<sub>m</sub>, d<sub>m</sub>], and if n<sub>m </sub>and d<sub>m </sub>are nonzero, then determining:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00024" num="00024">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>m</mi>
      </msub>
      <msub>
        <mi>d</mi>
        <mi>m</mi>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>cryptographically processing selected information based on the Squared Weil pairing by:
<claim-text>generating product identification for selected information;</claim-text>
<claim-text>validating product identification for selected information;</claim-text>
</claim-text>
<claim-text>outputting validation of product identification; and</claim-text>
<claim-text>determining a course of action in response to the validation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. A computer storage media having computer-implementable instructions for causing at least one processing unit to perform acts comprising:
<claim-text>determining a Squared Weil pairing (m, P, Q), where m is an odd prime number, by setting t<sub>1</sub>=[P, Q, 1, 1], using an addition-subtraction chain to determine t<sub>m</sub>=[mP, mQ, n<sub>m</sub>, d<sub>m</sub>], and if n<sub>m </sub>and d<sub>m </sub>are nonzero, then determining:</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00025" num="00025">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>m</mi>
      </msub>
      <msub>
        <mi>d</mi>
        <mi>m</mi>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>cryptographically processing selected information based on the Squared Weil pairing,</claim-text>
<claim-text>using the algorithm to encrypt, decrypt and validate product identification for selected information;</claim-text>
<claim-text>outputting validation of product identification for selected information; and</claim-text>
<claim-text>determining a course of action in response to the validation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. An apparatus comprising:
<claim-text>memory configured to store information suitable for use with using a cryptographic process;</claim-text>
<claim-text>a processor logic operatively coupled to said memory and configured to:
<claim-text>determine a Squared Weil pairing (m, P, Q), where m is an odd prime number, by setting t<sub>1</sub>=[P, Q, 1, 1],</claim-text>
<claim-text>use an addition-subtraction chain to determine t<sub>m</sub>=[mP, mQ, n<sub>m</sub>, d<sub>m</sub>],</claim-text>
<claim-text>if n<sub>m </sub>and d<sub>m </sub>are nonzero, then determine</claim-text>
</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00026" num="00026">
<math overflow="scroll">
<mrow>
  <mrow>
    <mfrac>
      <msub>
        <mi>n</mi>
        <mi>m</mi>
      </msub>
      <msub>
        <mi>d</mi>
        <mi>m</mi>
      </msub>
    </mfrac>
    <mo>=</mo>
    <mfrac>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>Q</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>P</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
      <mrow>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>P</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mrow>
              <mo>-</mo>
              <mi>Q</mi>
            </mrow>
            <mo>)</mo>
          </mrow>
        </mrow>
        <mo>⁢</mo>
        <mrow>
          <msub>
            <mi>f</mi>
            <mrow>
              <mi>m</mi>
              <mo>,</mo>
              <mi>Q</mi>
            </mrow>
          </msub>
          <mo>⁡</mo>
          <mrow>
            <mo>(</mo>
            <mi>P</mi>
            <mo>)</mo>
          </mrow>
        </mrow>
      </mrow>
    </mfrac>
  </mrow>
  <mo>;</mo>
</mrow>
</math>
</maths>
<claim-text>
<claim-text>cryptographically process selected information based on the Squared Weil pairing by using the algorithm to encrypt, decrypt and validate selected information;</claim-text>
</claim-text>
<claim-text>a display device coupled to the processor for outputting validation of selected information; and</claim-text>
<claim-text>the processor determining a course of action in response to the validation.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. A method comprising:
<claim-text>selecting an elliptic curve;</claim-text>
<claim-text>determining a Squared Tate pairing based on the elliptic curve,</claim-text>
<claim-text>cryptographically processing selected information based on the Squared Tate pairing;</claim-text>
<claim-text>wherein m is an odd prime on K and P is an m-torsion point on E, Q is a point on E, with neither P nor Q being the identity and wherein P is not equal to a multiple of Q, and wherein E is defined over K, K has q=p<sup>n </sup>elements, and m divides q−1, then determining that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00027" num="00027">
<math overflow="scroll">
<mrow>
  <mrow>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>Q</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo>-</mo>
                <mi>Q</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mrow>
          <mi>q</mi>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mi>m</mi>
      </mfrac>
    </msup>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>v</mi>
        <mi>m</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>P</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where ν<sub>m </sub>denotes the squared Tate-pairing;</claim-text>
<claim-text>outputting validation of selected information; and</claim-text>
<claim-text>determining a course of action in response to validation of selected information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The method as recited in <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein said elliptic curve includes an elliptic curve E over a field K, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. The method as recited in <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein determining said Squared Tate pairing includes determining ν<sub>m</sub>(P, Q) by:
<claim-text>establishing an odd prime m and said elliptic curve E;</claim-text>
<claim-text>given an m-torsion point P on E and a point Q on E, determining a mathematical chain for m; and</claim-text>
<claim-text>for each j in said mathematical chain, forming a tuple t<sub>j</sub>=[jP, n<sub>j</sub>, d<sub>j</sub>] such that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00028" num="00028">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>j</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The method as recited in <claim-ref idref="CLM-00037">claim 37</claim-ref>, further comprising:
<claim-text>starting with t<sub>1</sub>=[P, 1, 1], given t<sub>j </sub>and t<sub>k</sub>, determining t<sub>j+k </sub>by:
<claim-text>forming an elliptic curve sum jP+kP=(j+k)P,</claim-text>
<claim-text>determining line(jP,kP,(−j−k)P)(X)=c<b>0</b>+c<b>1</b>*x(X)+c<b>2</b>*y(X), and</claim-text>
<claim-text>setting: n<sub>j+k</sub>=n<sub>j</sub>*n<sub>k</sub>*(c<b>0</b>+c<b>1</b>*x(Q)+c<b>2</b>*y(Q)) and
<claim-text>d<sub>j+k</sub>=d<sub>j</sub>*d<sub>k</sub>*(c<b>0</b>+c<b>1</b>*x(Q)−c<b>2</b>*y(Q)).</claim-text>
</claim-text>
</claim-text>
</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. The method as recited in <claim-ref idref="CLM-00038">claim 38</claim-ref> further comprising determining t<sub>j−k </sub>from t<sub>j </sub>and t<sub>k</sub>.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The method as recited in clam <b>39</b>, wherein if j+k=m, then:
<claim-text>n<sub>j+k</sub>=n<sub>j</sub>*n<sub>k </sub>and d<sub>j+k</sub>=d<sub>j</sub>*d<sub>k</sub>.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. The method as recited in <claim-ref idref="CLM-00039">claim 39</claim-ref>, wherein if n<sub>m </sub>and d<sub>m </sub>are nonzero, then:</claim-text>
<claim-text>
<maths id="MATH-US-00029" num="00029">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>m</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>m</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>m</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. The method as recited in <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein said mathematical chain is selected from a group of mathematical chains comprising an addition chain and an addition-subtraction chain.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. A computer storage media having computer-implementable instructions for causing at least one processing unit to perform acts comprising:
<claim-text>determining a Squared Tate pairing based on an elliptic curve;</claim-text>
<claim-text>cryptographically processing selected information based on the Squared Tate pairing;</claim-text>
<claim-text>wherein m is an odd prime on K and P is an m-torsion point on E, Q is a point on E, with neither P nor Q being the identity and wherein P is not equal to a multiple of Q, and wherein E is defined over K, K has q=p<sup>n </sup>elements, and m divides q−1, then determining that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00030" num="00030">
<math overflow="scroll">
<mrow>
  <mrow>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>Q</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo>-</mo>
                <mi>Q</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mrow>
          <mi>q</mi>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mi>m</mi>
      </mfrac>
    </msup>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>v</mi>
        <mi>m</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>P</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where ν<sub>m </sub>denotes the squared Tate-pairing;</claim-text>
<claim-text>outputting validation of selected information; and</claim-text>
<claim-text>identifying a course of action in response to validation of selected information.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. The computer storage media as recited in <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein said elliptic curve includes an elliptic curve E over a field K, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b.</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. The computer storage media as recited in <claim-ref idref="CLM-00043">claim 43</claim-ref>, wherein determining said Squared Tate pairing includes determining ν<sub>m</sub>(P, Q) by:
<claim-text>establishing an odd prime m and said elliptic curve E;</claim-text>
<claim-text>given an m-torsion point P on E and a point Q on E, determining a mathematical chain for m; and</claim-text>
<claim-text>for each j in said mathematical chain, forming a tuple t<sub>j</sub>=[jP, n<sub>j</sub>, d<sub>j</sub>] such that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00031" num="00031">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>j</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. An apparatus comprising:
<claim-text>memory configured to store information suitable for use with using a cryptographic process;</claim-text>
<claim-text>a logic operatively coupled to the memory and configured to determine a Squared Tate pairing based on an elliptic curve; and cryptographically processing selected information based on the Squared Tate pairing;</claim-text>
<claim-text>wherein m is an odd prime on K and P is an m-torsion point on E, Q is a point on E, with neither P nor Q being the identity and wherein P is not equal to a multiple of Q, and wherein E is defined over K, K has q=p<sup>n </sup>elements, and m divides q−1, then determining that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00032" num="00032">
<math overflow="scroll">
<mrow>
  <mrow>
    <msup>
      <mrow>
        <mo>(</mo>
        <mfrac>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mi>Q</mi>
              <mo>)</mo>
            </mrow>
          </mrow>
          <mrow>
            <msub>
              <mi>f</mi>
              <mrow>
                <mi>m</mi>
                <mo>,</mo>
                <mi>P</mi>
              </mrow>
            </msub>
            <mo>⁡</mo>
            <mrow>
              <mo>(</mo>
              <mrow>
                <mo>-</mo>
                <mi>Q</mi>
              </mrow>
              <mo>)</mo>
            </mrow>
          </mrow>
        </mfrac>
        <mo>)</mo>
      </mrow>
      <mfrac>
        <mrow>
          <mi>q</mi>
          <mo>-</mo>
          <mn>1</mn>
        </mrow>
        <mi>m</mi>
      </mfrac>
    </msup>
    <mo>=</mo>
    <mrow>
      <msub>
        <mi>v</mi>
        <mi>m</mi>
      </msub>
      <mo>⁡</mo>
      <mrow>
        <mo>(</mo>
        <mrow>
          <mi>P</mi>
          <mo>,</mo>
          <mi>Q</mi>
        </mrow>
        <mo>)</mo>
      </mrow>
    </mrow>
  </mrow>
  <mo>,</mo>
</mrow>
</math>
</maths>
<claim-text>where ν<sub>m </sub>denotes the squared Tate-pairing;</claim-text>
<claim-text>a display device coupled to the logic for outputting cryptographic process; and</claim-text>
<claim-text>the logic determining a course of action in response to cryptographic process.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. The apparatus as recited in <claim-ref idref="CLM-00046">claim 46</claim-ref>, wherein wherein said elliptic curve includes an elliptic curve E over a field K, wherein E can be represented as an equation y<sup>2</sup>=x<sup>3</sup>+ax+b.</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. The apparatus as recited in <claim-ref idref="CLM-00046">claim 46</claim-ref>, wherein said logic is further configured to:
<claim-text>establish an odd prime m and said elliptic curve E;</claim-text>
<claim-text>given an m-torsion point P on E and a point Q on E, determine a mathematical chain for m; and</claim-text>
<claim-text>for each j in said mathematical chain, form a tuple t<sub>j</sub>=[jP, n<sub>j</sub>, d<sub>j</sub>] such that</claim-text>
</claim-text>
<claim-text>
<maths id="MATH-US-00033" num="00033">
<math overflow="scroll">
<mrow>
  <mfrac>
    <msub>
      <mi>n</mi>
      <mi>j</mi>
    </msub>
    <msub>
      <mi>d</mi>
      <mi>j</mi>
    </msub>
  </mfrac>
  <mo>=</mo>
  <mrow>
    <mfrac>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mi>Q</mi>
          <mo>)</mo>
        </mrow>
      </mrow>
      <mrow>
        <msub>
          <mi>f</mi>
          <mrow>
            <mi>j</mi>
            <mo>,</mo>
            <mi>P</mi>
          </mrow>
        </msub>
        <mo>⁡</mo>
        <mrow>
          <mo>(</mo>
          <mrow>
            <mo>-</mo>
            <mi>Q</mi>
          </mrow>
          <mo>)</mo>
        </mrow>
      </mrow>
    </mfrac>
    <mo>.</mo>
  </mrow>
</mrow>
</math>
</maths>
</claim-text>
</claim>
</claims>
</us-patent-grant>
