<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298694-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298694</doc-number>
<kind>B2</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10022594</doc-number>
<date>20011220</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<priority-claims>
<priority-claim sequence="01" kind="national">
<country>JP</country>
<doc-number>2000-396290</doc-number>
<date>20001226</date>
</priority-claim>
</priority-claims>
<us-term-of-grant>
<us-term-extension>697</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>1</main-group>
<subgroup>00</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>56</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>00</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>J</subclass>
<main-group>3</main-group>
<subgroup>24</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370218</main-classification>
<further-classification>370242</further-classification>
<further-classification>370401</further-classification>
<further-classification>370474</further-classification>
<further-classification>370476</further-classification>
</classification-national>
<invention-title id="d0e71">Apparatus and method for GFP frame transfer</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>4638477</doc-number>
<kind>A</kind>
<name>Okada et al.</name>
<date>19870100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370400</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>6014767</doc-number>
<kind>A</kind>
<name>Glaise</name>
<date>20000100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>714776</main-classification></classification-national>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>6134245</doc-number>
<kind>A</kind>
<name>Scarmalis</name>
<date>20001000</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370474</main-classification></classification-national>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>6330248</doc-number>
<kind>B1</kind>
<name>Krishna et al.</name>
<date>20011200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370447</main-classification></classification-national>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>6510156</doc-number>
<kind>B1</kind>
<name>Brock et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3703951</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>6516003</doc-number>
<kind>B1</kind>
<name>Nonaka et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370474</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6735219</doc-number>
<kind>B1</kind>
<name>Clauberg</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370474</main-classification></classification-national>
</citation>
<citation>
<nplcit num="00008">
<othercit>Enrique Hernandez-Valencia, Lucent Technologies, “Generic Framing Procedure (GFP) Specification,” Oct. 9-13, 2000.</othercit>
</nplcit>
<category>cited by examiner</category>
</citation>
<citation>
<nplcit num="00009">
<othercit>Enrique Hernandez-Valencia, Lucent Technologies, “A Proposed Format for the GFP Type Field”, T1X1.5/2000-210, pp. 1-4, Oct. 9-13, 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00010">
<othercit>Tim Armstrong et al., Nortel Networks—Lucent Technologies, “Transparent GFP Mappings for Fibre Channel and ESCON”, T1X1.5/2000-197, pp. 1-23, Oct. 10-13, 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00011">
<othercit>Enrique Hernandez-Valencia, Lucent Technologies, “Generic Framing Procedure (GFP) Specification”, T1X1.5/2000-209, pp. i-20, Oct. 9-13, 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00012">
<othercit>Ludovico Prattico, Nortel Networks, “Report of the Breakout Group on Data over SONET”, T1X1.5/2000-127R1, pp. 1-6, Mar. 21-24, 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00013">
<othercit>American National Standard for Telecommunications, “Synchronous Optical Network (SONET)—Payload Mappings”, ANSI T1.105.02-1995, pp. i-21, 1995.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00014">
<othercit>American National Standard for Telecommunications, Synchronous Optical Network (SONET)—Basic Description including Multiplex Structure, Rates, and Formats, ANSI T1.105-1995, pp. i-79, 1995.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00015">
<othercit>Telecommunication Standardization Sector—International Telecommunication Union, Study Period 1997-2000, “Draft Recommendation G.709 for Approval”, COM 15-,No..-E—Feb. 2001, pp. 1-79.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00016">
<othercit>International Telecommunication Union, ITU-T—Telecommunication Standardization Sector of ITU, Network node interface for the Synchronous Digital Hierarchy (SDH), pp. i-164, Feb. 2001.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
<citation>
<nplcit num="00017">
<othercit>American National Standard for Telecommunications, Synchronous Optical Network (SONET)—Basic Description including Multiplex Structure, Rates and Formats, ANSI T1.105-200x, pp. i-123, Oct. 20, 2000.</othercit>
</nplcit>
<category>cited by other</category>
</citation>
</references-cited>
<number-of-claims>52</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370218</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370242</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370243</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370244</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370245</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370401</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3703953</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3703955</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37039551</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>37039553</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>3703956</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370402</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370403</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370470</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370474</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370476</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370903</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370906</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370907</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>15</number-of-drawing-sheets>
<number-of-figures>21</number-of-figures>
</figures>
<us-related-documents>
<related-publication>
<document-id>
<country>US</country>
<doc-number>20020090007</doc-number>
<kind>A1</kind>
<date>20020711</date>
</document-id>
</related-publication>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Kamiya</last-name>
<first-name>Satoshi</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="002" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Nishihara</last-name>
<first-name>Motoo</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
<applicant sequence="003" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Ikematsu</last-name>
<first-name>Ryuichi</first-name>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
<nationality>
<country>JP</country>
</nationality>
<residence>
<country>JP</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>McGinn IP Law Group, PLLC</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>NEC Corporation</orgname>
<role>03</role>
<address>
<city>Tokyo</city>
<country>JP</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Rao</last-name>
<first-name>Seema S.</first-name>
<department>2616</department>
</primary-examiner>
<assistant-examiner>
<last-name>Hom</last-name>
<first-name>Shick</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">To allow performance monitoring of the end-to-end path from the Ingress node to the Egress node of the GFP network by an FCS (Frame Check Sequence) check in a GFP (Generic Frame Procedure) frame, the FCS generation target area is set in the payload field of the GFP frame, no FCS recalculation is performed at the relay node and the GFP frame is transferred to the next node with the FCS added when the GFP frame is received even if an error is detected by the FCS check.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="80.77mm" wi="140.46mm" file="US07298694-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="210.40mm" wi="139.78mm" file="US07298694-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="202.01mm" wi="121.75mm" file="US07298694-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="206.84mm" wi="127.76mm" file="US07298694-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="202.35mm" wi="116.76mm" file="US07298694-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="95.84mm" wi="141.48mm" file="US07298694-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="225.30mm" wi="174.16mm" orientation="landscape" file="US07298694-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="202.52mm" wi="133.01mm" file="US07298694-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="234.44mm" wi="172.89mm" orientation="landscape" file="US07298694-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00009" num="00009">
<img id="EMI-D00009" he="252.31mm" wi="106.34mm" file="US07298694-20071120-D00009.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00010" num="00010">
<img id="EMI-D00010" he="221.74mm" wi="110.24mm" file="US07298694-20071120-D00010.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00011" num="00011">
<img id="EMI-D00011" he="198.63mm" wi="152.57mm" file="US07298694-20071120-D00011.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00012" num="00012">
<img id="EMI-D00012" he="254.59mm" wi="162.22mm" file="US07298694-20071120-D00012.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00013" num="00013">
<img id="EMI-D00013" he="81.11mm" wi="149.01mm" file="US07298694-20071120-D00013.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00014" num="00014">
<img id="EMI-D00014" he="249.26mm" wi="137.16mm" orientation="landscape" file="US07298694-20071120-D00014.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00015" num="00015">
<img id="EMI-D00015" he="218.86mm" wi="154.52mm" file="US07298694-20071120-D00015.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0001" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0002" num="0001">1. Field of the Invention</p>
<p id="p-0003" num="0002">The present invention relates to a GFP (Generic Frame Procedure) frame transfer apparatus and GFP frame transfer method for transferring GFP frames, and more particularly, to a GFP frame transfer apparatus and GFP frame transfer method enabling performance monitoring of an end-to-end path in a GFP frame transfer.</p>
<p id="p-0004" num="0003">2. Description of the Prior Art</p>
<p id="p-0005" num="0004">With the rapid spread of the Internet, traffic of data systems such as IP (Internet Protocol) packets is expanding drastically in recent years. Realizing an efficient transfer of such data system traffic requires a network configuration and equipment designed in conformance with a conventional voice network such as a telephone network to be changed to a mode suitable for transferring data system traffic, above all, a mode suitable for transferring variable-length packets.</p>
<p id="p-0006" num="0005">Conventionally, there is SONET/SDH (Synchronous Optical NETwork/Synchronous Digital Hierarchy) as a digital network for WAN (Wide Area Network). The SONET/SDH adopts a data structure suitable for accommodating voice signals, and with the expansion of data system traffic in recent years, technologies for efficient transfers of data system traffic on the SONET/SDH are under study.</p>
<p id="p-0007" num="0006">One of such technologies is GFP (Generic Frame Procedure). This GFP is a general-purpose encapsulation technology or adaptation technology to accommodate variable-length packets with various protocols in an OTN (Optical Transport Network) using WDM (Wavelength Division Multiplexing) in addition to SONET/SDH. The technical content of the GFP is disclosed in a document “T1X1.5/2000-209 “Generic Framing Procedure (GFP) Specification” (hereinafter referred to as “document (1)”), by T1X1.5, one of the technical committees of the U.S.A. T1 Committee.</p>
<p id="p-0008" num="0007"><figref idref="DRAWINGS">FIG. 1</figref> shows a protocol stack of the GFP. The GFP consists of a GFP payload dependent sub-layer and a GFP payload independent sub-layer, and is a technology for accommodating various user protocols (user network protocols: Ethernet, HDLC, Token Ring, etc.) at edge nodes that interface with this user network and transferring these user protocols transparently.</p>
<p id="p-0009" num="0008"><figref idref="DRAWINGS">FIG. 2</figref> shows a basic frame format of the GFP. The GFP frame shown in <figref idref="DRAWINGS">FIG. 2</figref> consists of a 4-byte core header field, a variable-length (4 to 65535 bytes) payload area field and a 4-byte FCS (Frame Check Sequencer) field.</p>
<p id="p-0010" num="0009">As shown in <figref idref="DRAWINGS">FIG. 3</figref>, the above-described core header includes two PLI (PDU Length Indicator) fields each having two bytes and two cHECs (core Header Error Control) fields. The PLI indicates the length (number of bytes) of the above-described payload area and the cHEC indicates the result of a CRC16 calculation carried out on the PLI field and is intended for protecting integrity of the information in the core header.</p>
<p id="p-0011" num="0010">As shown in <figref idref="DRAWINGS">FIG. 4</figref>, the payload area consists of a payload header and payload field (hereinafter simply referred to as “payload”). The payload header has a variable length of 4 to 64 bytes and the payload has a variable length of 0 to 65535 bytes. The payload in this payload area stores information to be transferred.</p>
<p id="p-0012" num="0011">The FCS field is a 4-byte fixed length field shown in <figref idref="DRAWINGS">FIG. 5</figref>. The FCS field indicates the result of an FCS calculation (a kind of CRC32 calculation) conducted on the whole of the above-described payload area and used to protect the content of the payload area.</p>
<p id="p-0013" num="0012"><figref idref="DRAWINGS">FIG. 6</figref> illustrates the payload header in a GFP point-to-point frame (linear frame) (GFP frame used in a point-to-point connection (connection between two nodes)). The payload header of the linear frame has Type fields, tHEC (type Header Error Control) fields, DP (Destination Port) and SP (Source Port) as extension headers and eHEC (extension Header Error Control) fields. The Type indicates the type of a GFP frame format and the type of protocol of a higher layer of data stored in the payload field. The tHEC indicates the result of a CRC16 calculation on the Type field and is used to protect integrity of information in the Type field. The DP (destination port number) indicates one of 16 ports owned by the GFP edge node on the Egress side and indicates the output destination from the GFP edge node on the Egress side of a user packet stored in the relevant GFP frame. The SP (source port number) indicates one of 16 ports owned by the GFP edge node on the Ingress side and indicates the output destination from the GFP edge node on the Egress side of a user packet stored in the relevant GFP frame. The eHEC indicates the result of a CRC16 calculation carried out on the above-described extension header (Type and tHEC are not included) and is used to protect integrity of information in the extension header.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 7</figref> illustrates the payload header in a GFP ring frame (GFP frame used in a ring connection). The payload header in the GFP ring frame includes Type fields, tHEC fields, a DP field, an SP field and eHEC fields as in the case of the payload header of the linear frame in <figref idref="DRAWINGS">FIG. 6</figref> and further includes in its extension header (octet #<b>5</b> to #<b>20</b> in <figref idref="DRAWINGS">FIG. 7</figref>), DE (Discard Eligibility) as a Priority field and COS (Class Of Service), TTL (Time To Live) field, destination MAC (Destination Media Access Control) address (DST MAC) and source MAC (Source Media Access Control) address (SRC MAC). The above-described DE indicates priority in discarding the GFP frame. The specific method of use of COS (Class Of Service) is under study. The TTL is an 8-bit area indicating the remaining count of GFP transfers (GFP hops) and, for example, TTL=0 indicates that the GFP frame is terminated at the next GFP node. The destination MAC address is a 6-byte field indicating the address of the destination GFP node and the source MAC address is a 6-byte field indicating the address of the source GFP node.</p>
<p id="p-0015" num="0014">In the GFP, the type of adaptation is specified by the Type field in the payload header and it is also possible to define information according to individual adaptations in the payload header. Adaptations assuming a point-to-point frame and ring frame are currently proposed as shown above these adaptations include features as shown below.
<ul id="ul0001" list-style="none">
    <li id="ul0001-0001" num="0000">
    <ul id="ul0002" list-style="none">
        <li id="ul0002-0001" num="0015">Point-to-point frame . . . Multiplexes streams of a plurality of user protocols at the SONET node of Ingress and transfers it to the SONET node of Egress. To identify the multiplexing of streams, port addresses (SP, DP) are provided in the payload header. Since no address information to identify the SONET nodes exists in the payload header, at the relay node routing cannot be performed in GFP frame units.</li>
        <li id="ul0002-0002" num="0016">Ring frame . . . Constructs a ring similar to a shared bus on the topology of the SONET ring and provides the client with an Ethernet-like packet transfer. To provide a transfer within the ring, MAC addresses to identify SONET nodes are provided in the payload header.</li>
    </ul>
    </li>
</ul>
</p>
<p id="p-0016" num="0017">The adaptation method for accommodating Gigabit Ethernet, ESCON, Fiber Channel, FICON, etc. in the above-described GFP is reported in the above document (1) and document: “T1X1.5/2000-210, A Proposed Format for the GFP Type Field, October 2000” (hereinafter referred to as “document (2)”) and document “T1X1.5/2000-197, Transparent GFP Mappings For Fiber Channel and ESCON, October 2000” (hereinafter referred to as “document (3)”).</p>
<p id="p-0017" num="0018">As a method for carrying out performance monitoring of a path to be set between two nodes in a ring connection, a method whereby a node, which has received a GFP frame, uses an FCS field check at the end of the GFP frame may be available. <figref idref="DRAWINGS">FIG. 8</figref> illustrates a conventional target area for generating an FCS. As described above, the FCS field (4 bytes) added at the end of this GFP frame is the result of an FCS calculation (a kind of CRC32 calculation) carried out on the whole payload area and as a generating function G(X) in a CRC32 calculation, the following is used:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>G</i>(<i>X</i>)=1<i>+X+X</i><sup>2</sup><i>+X</i><sup>4</sup><i>+X</i><sup>5</sup><i>+X</i><sup>7</sup><i>+X</i><sup>8</sup><i>+X</i><sup>10</sup><i>+X</i><sup>11</sup><i>+X</i><sup>12</sup><i>+X</i><sup>16</sup><i>+X</i><sup>22</sup><i>+X</i><sup>23</sup><i>+X</i><sup>26</sup><i>+X</i><sup>32 </sup><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0018" num="0019">The fields of TTL and congestion control/priority (DE, COS) in the payload header of the ring frame are rewritten for every SONET node that terminates the GFP frame. Furthermore, in a “GFP bypass frame” that the present inventor et al. are proposing as a mode of the GFP frame in order to provide flexible routing, etc. in the GFP, some of labels in the payload header and control fields may be rewritten for every SONET node that terminates the GFP frame. That is, in many cases, in the SONET node, part of the payload header is updated and FCS recalculated. Therefore, it is possible to perform monitoring in ring units using the FCS field, but it is not possible to perform monitoring of the end-to-end path from the SONET node of Ingress to the SONET node of Egress. For example, when an error occurs in the data of the payload area, the node that has received this GFP frame can detect the error by an FCS field check, but if this node discards the GFP frame, the GFP frame and FCS are not transmitted to the subsequent nodes and it is impossible to perform performance monitoring of the above-described end-to-end path using the FCS field. Even if the node cannot discard the GFP frame containing the error, FCS is recalculated (re-created) and the GFP frame with the recalculated FCS added will be transmitted to the subsequent nodes, which causes the next node to judge the FCS check result as “correct”, making it impossible to realize performance monitoring of the end-to-end path using the FCS field.</p>
<p id="p-0019" num="0020">The present invention is intended to solve the above-described problems and it is an object of the present invention to provide a GFP frame transfer apparatus and GFP frame transfer method capable of providing performance monitoring of an end-to-end path using the FCS field of a GFP frame in a GFP frame transfer.</p>
<heading id="h-0002" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0020" num="0021">It is an object of the present invention to provide a GFP frame transfer apparatus and GFP frame transfer method capable of providing performance monitoring of an end-to-end path using the FCS field of a GFP frame in a GFP frame transfer.</p>
<p id="p-0021" num="0022">The GFP frame transfer apparatus of the present invention is a GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network and is provided with an FCS (Frame Check Sequence) generation section that generates, when a GFP frame is generated and sent by the GFP frame transfer apparatus, an FCS using the payload of the GFP frame as the generation target area and adds this to the FCS field of the GFP frame.</p>
<p id="p-0022" num="0023">The GFP frame transfer apparatus in another configuration of the present invention is a GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network and is provided with an FCS recalculation section that recalculates, when the GFP frame transfer apparatus receives a GFP frame and transfers it to the next GFP frame transfer apparatus, the FCS of the GFP frame output from the GFP frame transfer apparatus based on the extension header area of the GFP frame, a difference in the eHEC (extension Header Error Control) field before and after an update in the GFP frame transfer apparatus and FCS (Frame Check Sequence) of the GFP frame when input to the GFP frame transfer apparatus, and adds this recalculation result to the FCS field of the GFP frame.</p>
<p id="p-0023" num="0024">The GFP frame transfer apparatus in a further configuration of the present invention is a GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network and is provided with an FCS check/error notification bit setting section that carries out, when the GFP frame transfer apparatus receives a GFP frame, an error check using the FCS (Frame Check Sequence) of the GFP frame and sets, if an error is detected by this FCS check, an error notification bit in a predetermined field in the extension header area of the GFP frame.</p>
<p id="p-0024" num="0025">The GFP frame transfer method of the present invention is a GFP frame transfer method for the GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network and is provided with an FCS generating step of generating, when the GFP frame transfer apparatus generates a GFP frame and transfers it to the next GFP frame transfer apparatus, an FCS (Frame Check Sequence) using the payload field of the GFP frame as the generation target area and adding this to the FCS field of the GFP frame.</p>
<p id="p-0025" num="0026">The GFP frame transfer method in another configuration of the present invention is a GFP frame transfer method for the GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network and is provided with an FCS recalculating step of recalculating, when the GFP frame transfer apparatus receives a GFP frame and transfers it to the next GFP frame transfer apparatus, the FCS of the GFP frame output from the GFP frame transfer apparatus based on the extension header area of the GFP frame, a difference in the eHEC (extension Header Error Control) field before and after an update in the next GFP frame transfer apparatus and FCS (Frame Check Sequence) of the GFP frame when input to the GFP frame transfer apparatus, and adding this to the FCS field of the GFP frame.</p>
<p id="p-0026" num="0027">The GFP frame transfer method in a further configuration of the present invention is a GFP frame transfer method for the GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network and is provided with an FCS check/error notification bit setting step of carrying out, when the GFP frame transfer apparatus receives a GFP frame, an error check using the FCS (Frame Check Sequence) of the GFP frame and setting, if an error is detected by this FCS check, an error notification bit in a predetermined field in the extension header area of the GFP frame.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0003" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0027" num="0028">The above-mentioned and other objects, features and advantages of this invention will become more apparent by reference to the following detailed description of the invention taken in conjunction with the accompanying drawings, wherein:</p>
<p id="p-0028" num="0029"><figref idref="DRAWINGS">FIG. 1</figref> illustrates a protocol stack of a GFP;</p>
<p id="p-0029" num="0030"><figref idref="DRAWINGS">FIG. 2</figref> illustrates a basic frame format of the GFP;</p>
<p id="p-0030" num="0031"><figref idref="DRAWINGS">FIG. 3</figref> illustrates a format of a core header of the GFP frame;</p>
<p id="p-0031" num="0032"><figref idref="DRAWINGS">FIG. 4</figref> illustrates a format of a payload area of the GFP frame;</p>
<p id="p-0032" num="0033"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a format of an FCS field of the GFP frame;</p>
<p id="p-0033" num="0034"><figref idref="DRAWINGS">FIG. 6</figref> illustrates a payload header in a GFP point-to-point frame;</p>
<p id="p-0034" num="0035"><figref idref="DRAWINGS">FIG. 7</figref> illustrates a payload header of a GFP ring frame;</p>
<p id="p-0035" num="0036"><figref idref="DRAWINGS">FIG. 8</figref> illustrates a conventional FCS generation target area;</p>
<p id="p-0036" num="0037"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram showing an example of a GFP network made up of a GFP frame transfer apparatus according to a first embodiment of the present invention;</p>
<p id="p-0037" num="0038"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram showing an outlined configuration of the GFP frame transfer apparatus according to the first embodiment of the present invention;</p>
<p id="p-0038" num="0039"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing an example of a detailed configuration of a GFP node in the first embodiment of the present invention;</p>
<p id="p-0039" num="0040"><figref idref="DRAWINGS">FIG. 12</figref> is a flow chart showing a main operation of a GFP node when a user packet arrives from a subscriber network and a GFP frame in which this user packet is stored is sent to the GFP network;</p>
<p id="p-0040" num="0041"><figref idref="DRAWINGS">FIG. 13</figref> is a flow chart showing a main operation of a GFP node when a GFP frame arrives from the GFP network and a user packet stored in this GFP frame is sent to a subscriber network;</p>
<p id="p-0041" num="0042"><figref idref="DRAWINGS">FIG. 14</figref> illustrates an FCS generation target area according to the first embodiment of the present invention;</p>
<p id="p-0042" num="0043"><figref idref="DRAWINGS">FIG. 15</figref> is a schematic view showing performance monitoring of an end-to-end path using the FCS field in the first embodiment of the present invention;</p>
<p id="p-0043" num="0044"><figref idref="DRAWINGS">FIG. 16</figref> illustrates an outline of an FCS recalculation method according to a second embodiment of the present invention;</p>
<p id="p-0044" num="0045"><figref idref="DRAWINGS">FIG. 17</figref> is a schematic view showing generation of an FCS using an information polynomial F(x) showing the content of the FCS generation target area of the GFP frame and inversion polynomial L(x);</p>
<p id="p-0045" num="0046"><figref idref="DRAWINGS">FIG. 18</figref> is a circuit diagram showing a CRC operation circuit used in an FCS calculations;</p>
<p id="p-0046" num="0047"><figref idref="DRAWINGS">FIG. 19</figref> illustrates an FCS recalculation method according to the second embodiment of the present invention;</p>
<p id="p-0047" num="0048"><figref idref="DRAWINGS">FIG. 20</figref> illustrates an error notification bit used in a third embodiment of the present invention; and</p>
<p id="p-0048" num="0049"><figref idref="DRAWINGS">FIG. 21</figref> is a schematic view showing performance monitoring of an end-to-end path using the FCS field and error notification bit in the third embodiment of the present invention.</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<heading id="h-0004" level="1">DETAILED DESCRIPTION OF THE PREFERRED EMBODIMENTS</heading>
<p id="p-0049" num="0050">With reference now to the attached drawings, embodiments of the present invention will be explained in detail below.</p>
<heading id="h-0005" level="1">First Embodiment</heading>
<p id="p-0050" num="0051"><figref idref="DRAWINGS">FIG. 9</figref> is a block diagram showing an example of a network (called a “GFP network”) made up of GFP frame transfer apparatuses according to a first embodiment of the present invention. This embodiment will be explained by taking a ring connection GFP network formed as a SONET ring as an example. For this effect, suppose a GFP ring frame having the payload header configuration shown in <figref idref="DRAWINGS">FIG. 7</figref> is used as the GFP frame to be transferred within this GFP network.</p>
<p id="p-0051" num="0052">According to <figref idref="DRAWINGS">FIG. 9</figref>, the ring-shaped GFP network in this embodiment is constructed of a plurality of GFP nodes <b>1</b> (N<b>1</b>, N<b>2</b>, . . . N<b>7</b>) connected in a ring shape. Each GFP node <b>1</b> is connected to 1 or a plurality of subscriber networks. For simplicity, suppose each GFP node <b>1</b> is connected to and accommodates one subscriber network in the following explanations. Each GFP node <b>1</b> has a plurality of ports and each port is provided with a port number. Suppose, for example, the west side port is assigned port number “1”, the east side port, port number “2” and the subscriber network side, port number “3”.</p>
<p id="p-0052" num="0053"><figref idref="DRAWINGS">FIG. 10</figref> is a block diagram showing an outlined configuration of a GFP frame transfer apparatus according to the first embodiment of the present invention. According to <figref idref="DRAWINGS">FIG. 10</figref>, the GFP node <b>1</b> of the first embodiment of the present invention is constructed of one subscriber protocol termination section <b>4</b> and two GFP frame termination sections <b>5</b>. Each termination section (<b>4</b>, <b>5</b>) is mounted as, for example, a line card (LC).</p>
<p id="p-0053" num="0054">The subscriber protocol termination section <b>4</b> is the part that terminates a network protocol used in the subscriber network. The configuration and function of the subscriber protocol termination section <b>4</b> are changed according to the type of the subscriber network as appropriate. For example, when it is connected to a giga-bit Ethernet (GbE), the subscriber protocol termination section <b>4</b> performs frame termination processing of the giga-bit Ethernet. Furthermore, when it is connected to a POS (Packet over SONET) network, the subscriber protocol termination section <b>4</b> performs termination processing of a SONET frame and HDLC-like frame with a point-to-point protocol stored in this SONET frame.</p>
<p id="p-0054" num="0055">The GFP frame termination section <b>5</b> is the part that terminates a first layer (physical layer) of an OSI reference model that accommodates the GFP frame in the above-described GFP network. The configuration and function of the GFP frame termination section <b>5</b> are changed according to the type of the first layer of the OSI reference model of the GFP network as appropriate. For example, when SONET is used as the first layer of the OSI reference model and the GFP frame is mapped to the payload of the SONET frame (SPE (Synchronous Payload Envelope)), the GFP frame termination section <b>5</b> performs processing such as termination of the SONET frame, extraction and mapping of the GFP frame. Furthermore, an OTN (Optical Transport Network) using a WDM (Wavelength Division Multiplex) is used as the first layer of the OSI reference model and when the GFP frame is mapped to an optical channel payload unit (OPUk) which is a payload of this OTN frame (digital wrapper), the GFP frame termination section <b>5</b> performs processing such as termination of the digital wrapper frame and extraction and mapping of the GFP frame for the OPUk.</p>
<p id="p-0055" num="0056">The SONET standard is described in ANSI T1.105 and ANSI T1.105.02 or ITU-T G.707, while OPUk of OTN is described in ITU-T G.709.</p>
<p id="p-0056" num="0057"><figref idref="DRAWINGS">FIG. 11</figref> is a block diagram showing an example of a detailed configuration of GFP node <b>1</b> in the first embodiment of the present invention. The GFP node <b>1</b> includes a monitoring control processing section <b>16</b> in addition to the sections described in <figref idref="DRAWINGS">FIG. 10</figref>. For brevity, the GFP node <b>1</b> in <figref idref="DRAWINGS">FIG. 11</figref> shows one subscriber protocol termination section <b>4</b> and one GFP frame termination section <b>5</b>. However, one or more subscriber protocol termination sections <b>4</b> are provided for 1 or more subscriber network side ports of the GFP node <b>1</b> and two GFP frame termination sections <b>5</b> are provided for two GFP (ring) network side ports (East, West) and each termination section (<b>4</b>, <b>5</b>) is connected to a packet switch <b>3</b>. As described above, since this embodiment assumes that each GFP node <b>1</b> accommodates one subscriber network, this embodiment will be explained assuming that the number of the subscriber protocol termination sections <b>4</b> is one.</p>
<p id="p-0057" num="0058">The subscriber protocol termination sections <b>4</b> includes a subscriber network interface section <b>6</b>, a reception adaptation processing section <b>7</b>, an address resolution section <b>8</b>, a traffic meter <b>9</b>, a packet switch interface section <b>10</b>, a memory <b>11</b> and a transmission adaptation processing section <b>12</b>.</p>
<p id="p-0058" num="0059">The subscriber network interface section <b>6</b> transmits/receives a user packet (a subscriber network frame storing a user packet) to/from the subscriber network. When a subscriber network frame storing a user packet is received from the subscriber network, the subscriber network interface section <b>6</b> terminates this subscriber network frame, removes unnecessary overhead for the subscriber network from this subscriber network frame, extracts the user packet and sends this user packet to reception adaptation processing section <b>7</b>. Furthermore, the subscriber network interface section <b>6</b> also sends a user packet to the subscriber network as will be described later.</p>
<p id="p-0059" num="0060">Reception adaptation processing section <b>7</b> adds “Type” which is the field of the GFP frame for adaptation to the user packet received from the subscriber network interface section <b>6</b>, performs a CRC16 calculation of this Type, adds “tHEC” and secures an area for the extension header. Hereafter, a GFP frame being formed based on the user packet will also be referred to as “GFP frame”.</p>
<p id="p-0060" num="0061">The address resolution section <b>8</b> refers to the memory <b>11</b> based on the destination address (User Destination Address) of the subscriber network stored in the user packet stored in the payload field of this GFP frame and identifies the destination MAC address indicating the destination node in this GFP network, output port (DP) at the destination GFP node and output port (Egress Port) of the packet switch <b>3</b> at this GFP node <b>1</b>. The destination address of the subscriber network (User Destination Address) denotes the “Destination address (DA)” when, for example, the above-described user packet is an Ethernet MAC frame or IP packet extracted from the payload of the HDLC frame of POS. Furthermore, since the source MAC address (SRC MAC) indicating the source node in this GFP network and input port (SP) at the source GFP node (this GFP node <b>1</b>) are the MAC address of the own node and the port number (“3” in this embodiment) corresponding to this subscriber protocol termination section <b>4</b> of the packet switch <b>3</b>, these are automatically identified. Then, this DP, SP, destination MAC address (DST MAC) and source MAC address (SRC MAC) are added to the extension header area of the GFP (ring) frame and a CRC16 calculation is performed on this extension header area and to add “eHEC”.</p>
<p id="p-0061" num="0062">The traffic meter <b>9</b> monitors a flow of excessive traffic that exceeds a band set for each source address (User source Address) of the subscriber network stored in the user packet by the monitoring control processing section <b>16</b>. As a result, if the band is exceeded, the traffic meter <b>9</b> instructs the section that controls a GFP frame read (packet switch interface section <b>10</b>) to discard the GFP frame or carry out polishing control to reduce the read priority order.</p>
<p id="p-0062" num="0063">The packet switch interface section <b>10</b> has the function of controlling the packet switch <b>3</b> according to the scheduling function that changes the transfer frequency depending on the amount of network resource assigned for each source address (User source Address) of the subscriber network, for example.</p>
<p id="p-0063" num="0064">The memory <b>11</b> stores destination MAC address (DST MAC) indicating the destination node in the GFP network, output port (DP) at the destination GFP node and output port at the GFP node <b>1</b> (Egress Port) for each destination address (User Destination Address) of the subscriber network. This information is set from the monitoring control processing section <b>16</b>.</p>
<p id="p-0064" num="0065">The transmission adaptation processing section <b>12</b> removes the payload header (Type, tHEC, extension header, eHEC) from the GFP frame which is switched by the packet switch <b>3</b>, transferred to the subscriber protocol termination section <b>4</b> and supplied via the packet switch interface section <b>10</b> and transfers it to the subscriber network interface section <b>6</b>.</p>
<p id="p-0065" num="0066">The subscriber network interface section <b>6</b> that has received the packet (hereinafter referred to as “user packet”) stored in the payload of the payload area of the GFP frame from the transmission adaptation processing section <b>12</b> adds overhead for the subscriber network to this user packet, stores this in the frame of the subscriber network and sends the frame storing this user packet to the subscriber network.</p>
<p id="p-0066" num="0067">On the other hand, the GFP frame termination section <b>5</b> has a GFP frame interface section <b>13</b>, a GFP frame forwarding resolution section <b>14</b>, a packet switch interface section <b>10</b>, a traffic meter <b>19</b> and a memory <b>15</b>.</p>
<p id="p-0067" num="0068">The GFP frame interface section <b>13</b> transmits/receives the GFP frame (SONET frame that stores the GFP frame) to/from the GFP network. When the GFP frame interface section <b>13</b> receives the SONET frame that stores the GFP frame, the GFP frame interface section <b>13</b> extracts the GFP frame from the SONET frame, removes the core header from the GFP frame, performs descrambling processing and carries out an FCS field check, and transfers this GFP frame to the GFP frame forwarding resolution section <b>14</b>. Even if an error is detected in an FCS check, the GFP frame is not discarded and the fact that an error has been detected is notified to the monitoring control processing section <b>16</b>. The monitoring control processing section <b>16</b> notifies this error detection to the control system of the GFP network. Furthermore, the GFP frame is also sent to the GFP network as will be described later.</p>
<p id="p-0068" num="0069">The GFP frame forwarding resolution section <b>14</b> compares the destination MAC address (Dest MAC) in the extension header of the GFP frame received from the GFP frame interface section <b>13</b> with the MAC address of the own node, and if both are different, determines the output port of the packet switch <b>3</b> so that this GFP frame is transferred to the other GFP frame termination section <b>5</b>. For example, if the GFP frame termination section <b>5</b> is the GFP frame termination section <b>5</b> on the west side, the GFP frame forwarding resolution section <b>14</b> determines the output port “2” corresponding to the GFP frame termination section <b>5</b> on the east side as the output port of the packet switch <b>3</b> so that this GFP frame is transferred to the GFP frame termination section <b>5</b> on the east side. If both match, the GFP frame forwarding resolution section <b>14</b> refers to the destination port (DP) within the extension header and determines the DP as the output of the packet switch <b>3</b>. In this embodiment, only one subscriber network is connected to each GFP node <b>1</b>, and therefore the output destination from the packet switch <b>3</b> is fixed at one subscriber protocol termination section <b>4</b> (port “3”), but if a plurality of subscriber networks are connected to the GFP node <b>1</b>, this destination port (DP) determines the subscriber network at the output destination.</p>
<p id="p-0069" num="0070">The packet switch interface section <b>10</b> has almost the same function as that of the packet switch interface section <b>10</b> in the subscriber protocol termination section <b>4</b>.</p>
<p id="p-0070" num="0071">The memory <b>15</b> stores the MAC address of the own node and this own node MAC address is used for a comparison by the GFP frame forwarding resolution section <b>14</b>. This information is set from the monitoring control processing section <b>16</b>.</p>
<p id="p-0071" num="0072">The traffic meter <b>19</b> monitors a flow of excessive traffic that exceeds a band set for each destination MAC address (DST MAC) by the monitoring control processing section <b>16</b>. As a result, if the band is exceeded, the traffic meter <b>19</b> instructs the section that controls a GFP frame read (GFP frame interface section <b>13</b>) to discard the GFP frame or carry out polishing control to reduce the read priority order.</p>
<p id="p-0072" num="0073">The GFP frame interface section <b>13</b> that has received the GFP frame which is switched by the packet switch <b>3</b>, transferred to the GFP frame termination section <b>5</b> and supplied via the packet switch interface section <b>10</b> and the traffic meter <b>19</b> adds the FCS field to the GFP frame as will be described later, adds the core header, performs scrambling processing, then stores this GFP frame in the payload of the SONET frame and sends the SONET frame in which this GFP frame is stored to the GFP network.</p>
<p id="p-0073" num="0074">Then, an operation in the GFP node <b>1</b> according to this embodiment will be explained in detail using <figref idref="DRAWINGS">FIG. 11</figref>, etc.</p>
<p id="p-0074" num="0075">First, an operation of the GFP node <b>1</b> when a user packet arrives from the subscriber network and the GFP frame storing this user packet is sent to the GFP network will be explained using <figref idref="DRAWINGS">FIG. 11</figref> and <figref idref="DRAWINGS">FIG. 12</figref>. <figref idref="DRAWINGS">FIG. 12</figref> is a flow chart showing a main operation of the GFP node <b>1</b> in the above-described case.</p>
<p id="p-0075" num="0076">When a user packet (subscriber network frame storing a user packet) arrives at the subscriber protocol termination section <b>4</b> of the GFP node <b>1</b>, the subscriber network interface section <b>6</b> performs termination processing on this subscriber network frame (step S<b>1</b>) and extracts the user packet (step S<b>2</b>). In this case, the subscriber network interface section <b>6</b> extracts the user packet by removing unnecessary overhead for the subscriber network from the subscriber network frame. This unnecessary overhead indicates, for example, when the subscriber network frame is an Ethernet MAC frame, its “Preamble” and “Start of Frame Delimiter”.</p>
<p id="p-0076" num="0077">When this user packet is transferred to the reception adaptation processing section <b>7</b>, the reception adaptation processing section <b>7</b> sets a value indicating the protocol type (Ethernet, Token Ring, HDLC, etc.) of this packet or a value indicating that a ring frame will be used in the Type field of GFP, secures an area necessary for the extension header and adds it to this packet (step S<b>3</b>) (hereinafter a GFP frame being formed based on the user packet will also be referred to as “GFP frame”).</p>
<p id="p-0077" num="0078">Then, when the GFP frame is transferred to the address resolution section <b>8</b>, the address resolution section <b>8</b> refers to the memory <b>11</b> based on the destination address information (User Destination Address) in the user packet stored in the payload field of this GFP frame and identifies the corresponding destination MAC address (DST MAC), destination GFP node output port (DP) and output port (Egress Port) of the packet switch <b>3</b> of the own node (step S<b>4</b>). Furthermore, as described above, the source MAC address (SRC MAC) and source node input port (SP) are automatically identified. Then, the address resolution section <b>8</b> adds this DP, SP, destination MAC address (DST MAC) and source MAC address (SRC MAC) to the extension header area of the GFP (ring) frame (step S<b>5</b>), sets a predetermined GFP transfer (GFP hops) remaining count (initial value) in the TTL field of the extension header area (step S<b>6</b>), performs a CRC16 calculation on this extension header area to add “eHEC” (step S<b>7</b>).</p>
<p id="p-0078" num="0079">Then, when the GFP frame is transferred to the traffic meter <b>9</b>, the traffic meter <b>9</b> monitors a flow of excessive traffic that exceeds the band set for every source address (User source Address) of the subscriber network, for example. As a result, if the band is exceeded, the traffic meter <b>9</b> instructs the packet switch interface section <b>10</b> to discard the GFP frame or perform polishing control to reduce the read priority order.</p>
<p id="p-0079" num="0080">Then, when the GFP frame is transferred to the packet switch interface section <b>10</b>, the packet switch interface section <b>10</b> controls the packet switch <b>3</b> according to the scheduling function to change the transfer frequency depending on the amount of network resources assigned to each source address (User source Address) of the subscriber network, for example, and transfers the GFP frame from the subscriber protocol termination section <b>4</b> to the packet switch <b>3</b>.</p>
<p id="p-0080" num="0081">The GFP frame is switched by the packet switch <b>3</b>, transferred to the GFP frame termination section <b>5</b> (on the west side or east side corresponding to the output port of the packet switch <b>3</b> of the own node (Egress Port)) which is the switch destination (step S<b>8</b>). The GFP frame arrives at the traffic meter <b>19</b> via the packet switch interface section <b>10</b> inside the GFP frame termination section <b>5</b> and the traffic meter <b>19</b> performs the above-described band monitoring, flow rate restriction and priority control.</p>
<p id="p-0081" num="0082">When the GFP frame is transferred to the GFP frame interface section <b>13</b>, the GFP frame interface section <b>13</b> performs an FCS (Frame Check Sequence) calculation as will be described later, adds an FCS field showing the result (step S<b>9</b>), generates a core header (step S<b>10</b>), performs scrambling processing (step S<b>11</b>) and maps the GFP frame to the SONET payload (payload of SONET frame) used in this GFP network (step S<b>12</b>). Then, the SONET frame storing this GFP frame is sent from the GFP frame termination section <b>5</b> to the GFP network (step S<b>13</b>).</p>
<p id="p-0082" num="0083">In this embodiment, suppose the GFP frame interface section <b>13</b> adds/removes the core header of the GFP frame in the GFP node <b>1</b> and the GFP frame without the core header is transferred or processed within the GFP node <b>1</b>. As the method of transmitting information showing the length (delimitation) of the GFP frame within the GFP node <b>1</b>, various methods can be used such as transferring a length-related numerical value added to the GFP frame (transferred multiplexed or as a different signal) as control information, adding a flag (Flag Bits) indicating the start and end of the GFP frame, sending a signal (Enable signal etc.) indicating the signal part in which the GFP frame exists in parallel, etc. It is also possible to transfer and process the GFP frame with the core header added thereto within the GFP node <b>1</b>.</p>
<p id="p-0083" num="0084">Then, an operation of the GFP node <b>1</b> when the GFP frame arrives from the GFP network and the user packet stored in this is sent to the subscriber network will be explained using <figref idref="DRAWINGS">FIG. 11</figref> and <figref idref="DRAWINGS">FIG. 13</figref>. <figref idref="DRAWINGS">FIG. 13</figref> is a flowchart showing a main operation of the GFP node <b>1</b> in the above-described case.</p>
<p id="p-0084" num="0085">When the GFP frame (SONET frame storing the GFP frame) arrives at the GFP frame termination section <b>5</b> on the west side or east side in the GFP node <b>1</b>, the GFP frame interface section <b>13</b> in the GFP frame termination section <b>5</b> terminates the SONET frame (step T<b>1</b>) and extracts the GFP frame (delineation) (step T<b>2</b>). The GFP frame termination section <b>5</b> also removes the core header from the GFP frame (step T<b>3</b>), performs descrambling processing (step T<b>4</b>) and carries out an FCS field check for the GFP frame (FCS check) (step T<b>5</b>). Even if an error is detected by this FCS check, GFP frame termination section <b>5</b> does not discard the GFP frame, but notifies the fact of error detection to the monitoring control processing section <b>16</b>. The monitoring control processing section <b>16</b> notifies the GFP network control system of this error detection.</p>
<p id="p-0085" num="0086">When the GFP frame is transferred to the GFP frame forwarding resolution section <b>14</b>, the GFP frame forwarding resolution section <b>14</b> compares the destination MAC address (DST MAC) in the extension header of the GFP frame with the MAC address of the own node and if these two are different, determines the output port of the packet switch <b>3</b> so that this GFP frame is transferred to the other (west side→east side, east side→west side) GFP frame termination section <b>5</b>. In this case, when the TTL field of the GFP (ring) frame is checked and if TTL=0 is already set, this GFP frame is discarded. If TTL is 1 or greater, TTL is decremented, eHEC is recalculated and added and this GFP frame is output to the packet switch interface section <b>10</b>. On the other hand, if the destination MAC address matches the MAC address of the own node, the output port of the packet switch <b>3</b> is determined as the DP with reference to the destination port (DP) in the extension header and this GFP frame is output to the packet switch interface section <b>10</b> (step T<b>6</b>).</p>
<p id="p-0086" num="0087">Then, when the GFP frame is transferred to the packet switch interface section <b>10</b>, the packet switch interface section <b>10</b> controls the packet switch <b>3</b> according to the scheduling function that changes the transfer service frequency depending on the amount of network resources assigned for each destination MAC address (DST MAC), for example, and transfers the GFP frame from the GFP frame termination section <b>5</b> to the packet switch <b>3</b>.</p>
<p id="p-0087" num="0088">The GFP frame is switched by the packet switch <b>3</b> and transferred to the subscriber protocol termination section <b>4</b> (step T<b>7</b>). In the subscriber protocol termination section <b>4</b>, the GFP frame arrives at the transmission adaptation processing section <b>12</b> via the packet switch interface section <b>10</b>. The transmission adaptation processing section <b>12</b> deletes the payload header (Type field, tHEC, extension header area, eHEC), forms a user packet (step T<b>8</b>) and transfers this user packet to the subscriber network interface section <b>6</b>.</p>
<p id="p-0088" num="0089">The subscriber network interface section <b>6</b> maps (addition of overhead etc.) the user packet stored in this payload field and transferred to the payload of the subscriber network frame (step T<b>9</b>). Then, the subscriber network frame storing this user packet is sent from the subscriber protocol termination section <b>4</b> to the subscriber network connected thereto (step T<b>10</b>).</p>
<p id="p-0089" num="0090">Then, an operation of the GFP node <b>1</b> when the GFP frame arrives from the GFP network or the GFP frame is sent to the GFP network (when the GFP frame arrives on the west side or east side of the GFP node <b>1</b> and is sent to the opposite side (east side or west side)) will be explained.</p>
<p id="p-0090" num="0091">When the GFP frame (SONET frame storing the GFP frame) arrives at the GFP frame termination section <b>5</b> on the west side or east side in the GFP node <b>1</b>, the GFP frame interface section <b>13</b> in the GFP frame termination section <b>5</b> terminates the SONET frame and extracts the GFP frame (delineation). It also removes the core header from the GFP frame, performs descrambling processing and carries out a GFP frame FCS check.</p>
<p id="p-0091" num="0092">Then, the same processing as that of the GFP frame termination section <b>5</b> in the above-described case of GFP frame reception is performed and this GFP frame is switched by the packet switch <b>3</b> and transferred to the other GFP frame termination section <b>5</b> corresponding to the output destination port (Egress Port).</p>
<p id="p-0092" num="0093">The GFP frame termination section <b>5</b> at the switching destination then carries out almost the same processing as that of the GFP frame termination section <b>5</b> in the above-described case of GFP frame transmission and this GFP frame (SONET frame storing the GFP frame) is sent to the GFP network. The processing related to the FCS field in this case will be performed as will be described later.</p>
<p id="p-0093" num="0094"><figref idref="DRAWINGS">FIG. 14</figref> illustrates the target area when the GFP frame interface section <b>13</b> in the GFP frame termination section <b>5</b> according to the first embodiment of the present invention checks/generates an FCS field.</p>
<p id="p-0094" num="0095">The target area for a conventional FCS calculation (generation) corresponds to the entire payload area of the GFP frame as shown in <figref idref="DRAWINGS">FIG. 8</figref>, while in this first embodiment, the target area corresponds to the payload (field) part which is the payload area without the payload header.</p>
<p id="p-0095" num="0096">In each GFP node <b>1</b> that terminates and relays the GFP frame, the content of the payload field is not changed. Therefore, in this first embodiment in which the payload is considered as the FCS generation target area, it is not necessary to recalculate this FCS for every link. Thus, in the operation of the GFP node <b>1</b> when the GFP frame arrives from the GFP network and the GFP frame is sent to the GFP network, the GFP frame interface section <b>13</b> in the GFP frame termination section <b>5</b> on the GFP frame transmitting side carries out no FCS recalculation and sends this GFP frame with the same FCS added when the GFP frame arrived at the GFP node <b>1</b>. If the GFP frame interface section <b>13</b> recalculates the FCS, even if there is mismatch between the payload area and FCS field when the GFP frame arrives, an FCS recalculation solves this mismatch and the FCS check result will be regarded as “correct” in the subsequent GFP nodes <b>1</b>, and it is not possible to perform performance monitoring of the end-to-end path using the FCS field. For this reason, even if a mismatch occurs between the payload area and FCS field due to an error and the FCS check results in an error, this first embodiment does not perform any FCS recalculation, but transfers the GFP frame up to the Egress node.</p>
<p id="p-0096" num="0097"><figref idref="DRAWINGS">FIG. 15</figref> is a schematic view showing performance monitoring of an end-to-end path using the FCS field in the first embodiment of the present invention. <figref idref="DRAWINGS">FIG. 15</figref> shows part of the ring-shaped GFP network shown in <figref idref="DRAWINGS">FIG. 9</figref> and shows an example of transfer of the GFP frame when the GFP node N<b>2</b> in <figref idref="DRAWINGS">FIG. 9</figref> is regarded as the Ingress node of this GFP network and the GFP node N<b>5</b> is regarded as the Egress node of this GFP network.</p>
<p id="p-0097" num="0098">As shown in <figref idref="DRAWINGS">FIG. 15</figref>, performance monitoring (PM) by an FCS check is performed at each GFP node for every link. As described above, no FCS recalculation is performed at intermediate nodes. This makes it possible to detect deterioration/error generated on the path between the Ingress node and Egress node by an FCS check at the Egress node.</p>
<p id="p-0098" num="0099">As shown above, the GFP frame transfer apparatus and GFP frame transfer method in the first embodiment of the present invention sets the FCS generation target area in the payload field of the payload area and performs no FCS recalculation when the GFP frame is received from the GFP network and sent to the GFP network. For this reason, if an error occurs on the path, the error is detected by an FCS check at the Egress node and this makes it possible to realize performance monitoring of the end-to-end path using the FCS field.</p>
<p id="p-0099" num="0100">Furthermore, the monitoring control processing section <b>16</b> of the GFP node <b>1</b> that has detected an error by an FCS check notifies the error detection to the control system of the GFP network, and can thereby easily identify the error location in the path.</p>
<heading id="h-0006" level="1">Second Embodiment</heading>
<p id="p-0100" num="0101">Then, a second embodiment of the present invention will be explained.</p>
<p id="p-0101" num="0102">This second embodiment uses the conventional FCS generation target area without changing it as the FCS generation target area and adopts a different calculation method as the FCS recalculation method. It carries out FCS generation (calculation) at the GFP node <b>1</b> of Ingress and an FCS check at the intermediate GFP node <b>1</b> and GFP node <b>1</b> of Egress according to the conventional specification. On the other hand, when an FCS is recalculated at the intermediate GFP node <b>1</b>, this embodiment uses the changed difference of the payload header and original FCS to calculate a new FCS.</p>
<p id="p-0102" num="0103">The second embodiment calculates a difference between the original (when the GFP node <b>1</b> is input) payload header and new (when the GFP node <b>1</b> is output) payload header and performs a division by a generating function G(x) of CRC32 calculation with respect to this difference. The exclusive OR between the remainder in the division result and original FCS becomes a new FCS (see <figref idref="DRAWINGS">FIG. 16</figref>).</p>
<p id="p-0103" num="0104">The FCS generation method by the GFP frame interface section <b>13</b> and recalculation method when the GFP frame termination section <b>5</b> of the GFP node <b>1</b> sends a GFP frame will be explained in detail below. In the following explanations, all mathematical expressions correspond to operations using modulo<b>2</b> and in operations using modulo<b>2</b>, a subtraction is equivalent to an addition.</p>
<p id="p-0104" num="0105">The following expression is used to generate an FCS.</p>
<p id="p-0105" num="0106">Information polynomial F(x): An expression that expresses k-bit information of the FCS generation target area with a (k−1) order polynomial of x and is expressed as:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>F</i>(<i>x</i>)=<i>c</i><sub>1</sub><i>+c</i><sub>2</sub><i>x+c</i><sub>3</sub><i>x</i><sup>2</sup><i>+ . . . +c</i><sub>k</sub><i>x</i><sup>k−1 </sup><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0106" num="0107">In the FCS generation target area, the first bit to be sent is coefficient c<sub>k </sub>of the highest order ((k−1) order) term and the last bit to be sent is coefficient c<sub>1 </sub>of the lowest order (0 order) term.</p>
<p id="p-0107" num="0108">By the way, in the GFP, SONET sends information to the transmission path in Network Byte Order (Most Significant Octet first) MSB-first. Thus, in the case of the second embodiment where the FCS calculation target is the entire payload area (from the next octet of cHEC of the core header to the final octet of the payload), the MSB of the Type field is coefficient c<sub>k </sub>of the highest order (x<sup>k−1</sup>) of F(x) and the LSB of the final octet of the payload is coefficient c<sub>1 </sub>of the lowest order (x<sup>0</sup>).</p>
<p id="p-0108" num="0109">Generating function G(x): For FCS generation, the following generating function is used as the generating function of CRC32:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>G</i>(<i>x</i>)=1<i>+x+x</i><sup>2</sup><i>+x</i><sup>4</sup><i>+x</i><sup>5</sup><i>+x</i><sup>7</sup><i>+x</i><sup>8</sup><i>+x</i><sup>10</sup><i>+x</i><sup>11</sup><i>+x</i><sup>12</sup><i>+x</i><sup>16</sup><i>+x</i><sup>22</sup><i>+x</i><sup>23</sup><i>+x</i><sup>26</sup><i>+x</i><sup>32 </sup><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0109" num="0110">Of the coefficients of the respective terms, the coefficients of the order <b>0</b>, order <b>1</b>, order <b>2</b>, order <b>4</b>, order <b>5</b>, order <b>7</b>, order <b>8</b>, order <b>10</b>, order <b>11</b>, order <b>12</b>, order <b>16</b>, order <b>22</b>, order <b>23</b>, order <b>26</b> and order <b>32</b> are 1 and the coefficients of other orders are 0.</p>
<p id="p-0110" num="0111">Inversion polynomial L(x): A 31-order polynomial with all coefficients being 1:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>L</i>(<i>x</i>)=1<i>+x+x</i><sup>2</sup><i>+ . . . x</i><sup>31 </sup><?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0111" num="0112">is used for bit inversion.</p>
<p id="p-0112" num="0113">The FCS is calculated by expressing a sum of two expressions (values) in 32 bits and taking its 1's complement.
<ul id="ul0003" list-style="none">
    <li id="ul0003-0001" num="0114">1) Remainder when dividing x<sup>32</sup>F(x) ((k+31) order expression) by G(x) (the order is 31 or lower)</li>
    <li id="ul0003-0002" num="0115">2) Remainder when dividing x<sup>k</sup>L(x) ((k+31) order expression) by G(x) (the order is 31 or lower)</li>
</ul>
</p>
<p id="p-0113" num="0116">Suppose the quotient when dividing x<sup>32</sup>F(x)+x<sup>k</sup>L(x) by G(x) is Q(x) and the remainder is R(x),
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)=<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>R</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0114" num="0117">Therefore,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>FCS=˜R</i>(<i>x</i>) (1's complement of <i>R</i>(<i>x</i>) (bit inversion))=<i>R</i>(<i>x</i>)+<i>L</i>(<i>x</i>)=<i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)−<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>L</i>(<i>x</i>)=<i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)+<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>L</i>(<i>x</i>)  (1)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0115" num="0118">In a transfer of the GFP frame, coefficients c<sub>1</sub>, c<sub>2</sub>, c<sub>3</sub>, . . . , c<sub>k </sub>of F(x) are sent sequentially starting with the coefficient with the highest order (in order of c<sub>k</sub>, c<sub>k−1</sub>, . . . c<sub>2</sub>, c<sub>1</sub>) followed by the coefficients of the FCS starting with the highest order.</p>
<p id="h-0007" num="0000">That is,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>FCS=x</i><sup>32</sup><i>F</i>(<i>x</i>)+˜<i>R</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0116" num="0119">is transferred.</p>
<p id="p-0117" num="0120"><figref idref="DRAWINGS">FIG. 17</figref> shows a schematic view of generation of the FCS using the information polynomial F(x) that expresses the content of the FCS generation target area of the GFP frame and inversion polynomial L(x).</p>
<p id="p-0118" num="0121">In an actual calculation of the FCS, the CRC operation circuit shown in <figref idref="DRAWINGS">FIG. 18</figref> is used. This CRC operation circuit is constructed of 32 remainder registers (D-FF) D<sub>0 </sub>to D<sub>31 </sub>and of coefficient gi of each order i of the generating function G(x), and feedback is provided only for the part corresponding to coefficient gi which is 1. That is, of the part gi in <figref idref="DRAWINGS">FIG. 18</figref>, only the part whose corresponding coefficient gi is 1 is connected and the part whose corresponding coefficient gi is 0 is not connected. The generating function G(x) is generally invariable and therefore each part gi can be provided with fixed wiring. In the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref>, each EXOR circuit performs an operation equivalent to an addition of expressions, and by feedback of each coefficient gi of the generating function G(x), an operation corresponding to a division by the generating function G(x) is performed.</p>
<p id="p-0119" num="0122">At the start of the calculation, all remainder registers D<sub>0 </sub>to D<sub>31 </sub>of the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref> are preset to 1 and information bit (x<sup>32</sup>F(x)) is input to this. After all bits are input, when the next clock is input, bit-inverted outputs of the remainder registers D<sub>0 </sub>to D<sub>31 </sub>become FCS. The above-described xkL(x) is equivalent to presetting all 32-bit remainder registers to 1 in the initial state when the calculation is started and an addition of L(x) is equivalent to bit inversion of the lower 32 bits.</p>
<p id="p-0120" num="0123">An FCS check is performed using the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref> as follows. When x32F(x)+FCS is input to the CRC operation circuit with all remainder registers D<sub>0 </sub>to D<sub>31 </sub>of the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref> preset to 1, all remainder registers D<sub>0 </sub>to D<sub>31 </sub>become 1 at the next clock input after the final bit is input if no error occurs. Because,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>FCS+x</i><sup>k</sup><i>L</i>(<i>x</i>)=<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>R</i>(<i>x</i>)+<i>FCS=G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>R</i>(<i>x</i>)+<i>R</i>(<i>x</i>)+<i>L</i>(<i>x</i>)=<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>L</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0121" num="0124">and, if the remainder obtained by dividing x<sup>32</sup>F(x)+FCS+x<sup>k</sup>L(x) by G(x) is L(x), all remainder registers D<sub>0 </sub>to D<sub>31 </sub>become 1 in the above-described input result. If all remainder registers D<sub>0 </sub>to D<sub>31 </sub>do not become 1 in the above-described input result, this means that an error has been detected.</p>
<p id="p-0122" num="0125">An FCS recalculation at an intermediate node is performed as follows.</p>
<p id="p-0123" num="0126">Suppose F′(x) is an information polynomial that expresses the content of the new FCS generation target area of the GFP frame at the intermediate node and FCSnew is a new FCS. Suppose the quotient obtained by dividing x<sup>32</sup>F′(x)+x<sup>k</sup>L(x) by G(x) is Q′(x) and the remainder is R′(x) (the order is 31 or lower). In a normal FCS recalculation method, FCSnew is calculated by dividing x<sup>32</sup>F′(x)+x<sup>k</sup>L(x) by G(x) and taking 1's complement of the remainder R′(x) according to the definition.
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sup>32</sup><i>F</i>′(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)=<i>G</i>(<i>x</i>)<i>Q</i>′(<i>x</i>)+<i>R</i>′(<i>x</i>)<i>FCS</i>new=˜<i>R</i>′(<i>x</i>)(=<i>R</i>′(<i>x</i>)+<i>L</i>(<i>x</i>))=<i>x</i><sup>32</sup><i>F</i>′(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)+<i>G</i>(<i>x</i>)<i>Q</i>′(<i>x</i>)+<i>L</i>(<i>x</i>)  (2)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0124" num="0127">At this time, the following expression is set up from expressions (1) and (2).
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>FCS</i>new=<i>FCS+{x</i><sup>32</sup><i>F</i>′(<i>x</i>)−<i>x</i><sup>32</sup><i>F</i>(<i>x</i>)}+<i>G</i>(<i>x</i>){<i>Q</i>′(<i>x</i>)−<i>Q</i>(<i>x</i>)}  (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0125" num="0128">Expression (3) above can be proven as follows (in the following expressions, “≡” means “defines”).</p>
<p id="p-0126" num="0129">From the definition of FCS and FCSnew,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>FCS</i>new≡R′(<i>x</i>)+<i>L</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0127" num="0130">and
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>FCS≡R</i>(<i>x</i>)+<i>L</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0128" num="0131">Subtracting the second expression from the first expression gives:
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>FCS</i>new−<i>FCS=R</i>′(<i>x</i>)−<i>R</i>(<i>x</i>)∴<i>FCS</i>new=<i>FCS+R</i>′(<i>x</i>)−<i>R</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0129" num="0132">Here, from the definition of Q(x), R(x), Q′(x) and R′(x)
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)≡<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)+<i>R</i>(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>x</i><sup>32</sup><i>F</i>′(<i>x</i>)+<i>x</i><sup>k</sup><i>L</i>(<i>x</i>)≡<i>G</i>(<i>x</i>)<i>Q</i>′(<i>x</i>)+<i>R</i>′(<i>x</i>)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0130" num="0133">However,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?><i>R</i>′(<i>x</i>)−<i>R</i>(<i>x</i>)=<i>x</i><sup>32</sup><i>F</i>′(<i>x</i>)+<i>G</i>(<i>x</i>)<i>Q</i>′(<i>x</i>)−{<i>x</i><sup>32</sup><i>F</i>(<i>x</i>)+<i>G</i>(<i>x</i>)<i>Q</i>(<i>x</i>)}={<i>x</i><sup>32</sup><i>F</i>′(<i>x</i>)−<i>x</i><sup>32</sup><i>F</i>(<i>x</i>)}+<i>G</i>(<i>x</i>){<i>Q</i>′(<i>x</i>)−<i>Q</i>(<i>x</i>)}∴<i>FCS</i>new=<i>FCS+{x</i><sup>32</sup><i>F</i>′(<i>x</i>)−<i>x</i><sup>32</sup><i>F</i>(<i>x</i>)}+<i>G</i>(<i>x</i>){<i>Q</i>′(<i>x</i>)−<i>Q</i>(<i>x</i>)}  (3)<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0131" num="0134">Here, since R(x), R′(x) are both order 31 or lower,
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>{x<sup>32</sup>F′(x)−x<sup>32</sup>F(x)}+G(x){Q′(x)−Q(x)}<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0132" num="0135">is also order 31 or lower, and so
<br/>
<?in-line-formulae description="In-line Formulae" end="lead"?>{x<sup>32</sup>F′(x)−x<sup>32</sup>F(x)}+G(x){Q′(x)−Q(x)}<?in-line-formulae description="In-line Formulae" end="tail"?>
</p>
<p id="p-0133" num="0136">is equivalent to the remainder obtained by dividing x<sup>32</sup>F′(x)−x<sup>32</sup>F(x) by G(x).</p>
<p id="p-0134" num="0137">That is, the new FCS is calculated by adding the original FCS to the remainder obtained by dividing the information polynomial that expresses a difference between the new information and original information at the intermediate node {x<sup>32</sup>F′(x)−x<sup>32</sup>F(x)} by G(x).</p>
<p id="p-0135" num="0138">According to this new calculation method, processing like presetting all 32-bit remainder registers D<sub>0 </sub>to D<sub>31 </sub>to 1 or bit inversion of the lower 32 bits is not necessary in the division by G(x).</p>
<p id="p-0136" num="0139">In an inter-node transfer of the GFP frame, the content of the payload field in which the higher protocol data is stored does not change, and therefore the difference between the new information and original information corresponds to the extension header area and the eHEC section. Therefore, suppose the information polynomial of the extension header area and the eHEC section before an update is E(x) and after an update is E′(x) and the number of bits of the payload field is p. Then, as shown in <figref idref="DRAWINGS">FIG. 19</figref>, the sum of the remainder obtained by dividing x<sup>32</sup>F′(x)−x<sup>32</sup>F(x)=x<sup>32+p</sup>{E′(x)−E(x)} by G(x) and the original FCS becomes a new FCS (FCSnew).</p>
<p id="p-0137" num="0140">At this time, the division by G(x) does not require:
<ul id="ul0004" list-style="none">
    <li id="ul0004-0001" num="0141">(1) Processing of presetting all 32-bit remainder registers to 1</li>
    <li id="ul0004-0002" num="0142">(2) Processing of bit inversion of lower 32 bits</li>
</ul>
</p>
<p id="p-0138" num="0143">Thus, a new FCS (FCSnew) is obtained by initializing all remainder registers to “0”, entering the bit string of E′(x)−E(x) and entering “0” for the 32 bits in the CRC operation circuit and then adding this to the original FCS.</p>
<p id="p-0139" num="0144">In summary, the various FCS calculation methods are as follows.</p>
<p id="h-0008" num="0000">[During FCS Generation]</p>
<p id="p-0140" num="0145">(1) Presetting all remainder registers of the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref> to 1</p>
<p id="p-0141" num="0146">(2) Inputting from Type field of GFP frame to CRC operation circuit</p>
<p id="p-0142" num="0147">(3) The bit-inverted outputs of the remainder registers are sent as FCS at the clock following the clock at which the free FCS 32 bits are input.</p>
<p id="h-0009" num="0000">[During FCS Check]</p>
<p id="p-0143" num="0148">(1) Presetting all remainder registers of the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref> to 1</p>
<p id="p-0144" num="0149">(2) Inputting from Type field of GFP frame to CRC operation circuit</p>
<p id="p-0145" num="0150">(3) If all remainder registers are 1 at the clock following the clock at which the final bit of the FCS is input, there is no error in the payload area. If all remainder registers are other than 1, an error is detected.</p>
<p id="h-0010" num="0000">[During FCS Recalculation]</p>
<p id="p-0146" num="0151">(1) Initializing all remainder registers of the CRC operation circuit in <figref idref="DRAWINGS">FIG. 18</figref> to 0</p>
<p id="p-0147" num="0152">(2) Inputting a difference of the extension header area and eHEC before and after an update to the CRC operation circuit</p>
<p id="p-0148" num="0153">(3) Adding the original FCS to the outputs of the remainder registers at the clock following the clock at which “0” is input by the number of bits (p) of the payload field+32.</p>
<p id="p-0149" num="0154">Then, a new FCS (FCSnew) is generated (bit inversion is not required).</p>
<p id="p-0150" num="0155">The difference of the extension header area and eHEC before and after an update during an FCS recalculation (2) above is calculated, for example, from a subtraction circuit made up of a plurality of EXOR circuits that carry out a subtraction (equivalent to an addition in a calculation by modulo<b>2</b>) for every bit. Furthermore, an addition of the original FCS to the outputs of the remainder registers during the FCS recalculation (3) above is carried out by an addition circuit made up of a plurality of EXOR circuits that carry out an addition for every bit.</p>
<p id="p-0151" num="0156">In the second embodiment, even if an error is detected through an FCS check by the GFP frame interface section <b>13</b>, the GFP frame is not discarded, but the fact of the error detection is notified to the monitoring control processing section <b>16</b>. The monitoring control processing section <b>16</b> notifies the GFP network control system of this error detection.</p>
<p id="p-0152" num="0157">As shown above, the GFP frame transfer apparatus and GFP frame transfer method according to the second embodiment of the present invention uses the same conventional FCS generation target area as the FCS target area and calculates a new FCS using the changed difference of the payload header and the original FCS when recalculating the FCS at the intermediate GFP node <b>1</b>. Thus, when an error occurs on the path, the error is detected by an FCS check at the Egress node and this allows performance monitoring of the end-to-end path using the FCS field as in the case of the first embodiment. Furthermore, the monitoring control processing section <b>16</b> of the GFP node <b>1</b> in which an error is detected by an FCS check notifies the GFP network control system of the error, which facilitates the identification of the error location in the path. Therefore, while using a calculation method not considering the payload field which is basically not changed in each GFP node <b>1</b>, this embodiment makes it possible to perform performance monitoring of an end-to-end path and identify the error location using the FCS field as in the case of the first embodiment.</p>
<heading id="h-0011" level="1">Third Embodiment</heading>
<p id="p-0153" num="0158">Next, a third embodiment of the present invention will be explained.</p>
<p id="p-0154" num="0159">As shown in <figref idref="DRAWINGS">FIG. 20</figref>, as the FCS generation target area, this third embodiment uses the conventional FCS generation target area without any modification thereto and defines a new error notification bit in the payload header. This error notification bit can be defined, for example, in part of the Spare field of the payload header in the case of the GFP ring frame.</p>
<p id="p-0155" num="0160"><figref idref="DRAWINGS">FIG. 21</figref> is a schematic view showing performance monitoring of an end-to-end path using the FCS field and error notification bit in the third embodiment of the present invention. <figref idref="DRAWINGS">FIG. 21</figref> is an example of transfer of a GFP frame in part (N<b>2</b>→N<b>5</b>) of the ring-shaped GFP network in <figref idref="DRAWINGS">FIG. 9</figref> as in the case of <figref idref="DRAWINGS">FIG. 15</figref>.</p>
<p id="p-0156" num="0161">As shown in <figref idref="DRAWINGS">FIG. 21</figref>, when an error occurs in a GFP link and the error is detected by an FCS check at the GFP node <b>1</b> that has received this GFP frame, the GFP frame interface section <b>13</b> of the GFP frame termination section <b>5</b> of the GFP node <b>1</b> that has detected the error sets the error notification bit to 1. An FCS recalculation is performed by each GFP node <b>1</b> in GFP link units as in the case of the conventional art. Since the error notification bit in the GFP frame which arrived at the GFP node <b>1</b> on the Egress side is a logical sum of the performance monitoring results in all links in the path, the GFP node <b>1</b> on the Egress side can perform performance monitoring of the end-to-end path using the error notification bit. Furthermore, each GFP node <b>1</b> that terminates the GFP layer can detect deterioration/error (degradation) link by link through an FCS field check. Therefore, it is possible to detect all trouble on the path through this error notification bit and FCS check.</p>
<p id="p-0157" num="0162">As shown above, the GFP frame transfer apparatus and GFP frame transfer method according to the third embodiment of the present invention uses as the FCS generation target area the same conventional FCS generation target area and defines a new error notification bit in the payload header. Since this embodiment performs an FCS recalculation at each GFP node <b>1</b> and sets this error notification bit at the GFP node <b>1</b> that has detected the error through an FCS check, it is possible to detect all trouble (end-to-end path performance monitoring and deterioration/error detection in link units) on the path through the error notification bit and FCS check.</p>
<p id="p-0158" num="0163">The foregoing embodiments have described the GFP ring frame which is transferred on the ring-shaped connection GFP network as an example, but the foregoing embodiments are also applicable to other GFP frame formats such as “GFP path frame” which is being currently proposed by the present inventor et al. This GFP path frame is a frame compliant with the basic frame format of the GFP frame shown in <figref idref="DRAWINGS">FIG. 2</figref> to <figref idref="DRAWINGS">FIG. 5</figref>, stores a label corresponding to a path ID defined to uniquely specify the path from the Ingress node to Egress node within the GFP network in a predetermined field of the extension header area and is routed according to this label. The GFP path frame is also available to complicated network topologies such as mesh-shaped and multi-ring-shaped topologies in addition to the ring-shaped connection GFP network and the above-described embodiments are also applicable to GFP networks in those complicated modes. Thus, it is possible, using the FCS field of the GFP path frame, to realize end-to-end path performance monitoring which is particularly important in frame transfers in the GFP network in a complicated mode.</p>
<p id="p-0159" num="0164">Furthermore, the above-described embodiments assume that an FCS check is performed by each GFP node <b>1</b> on the path, but it is of course possible to perform the FCS check only at some specific intermediate nodes. FCS recalculations in the second and third embodiments need to be performed at each intermediate node because the content of the payload header is changed at each intermediate node due to a TTL rewrite etc.</p>
<p id="p-0160" num="0165">As described above, according to the GFP frame transfer apparatus according to the first embodiment of the present invention, when generating and sending the GFP frame, the GFP frame transfer apparatus that transfers a GFP (Generic Frame Procedure) frame over a GFP network comprises an FCS generation section that generates an FCS (Frame Check Sequence) using the payload field of the GFP frame as the generation target area and adds this FCS to the FCS field of the GFP frame, which basically prevents the content of the payload field of the GFP frame from being changed at a relay node and thereby basically eliminates the need to recalculate the FCS for every link at each relay node, allowing each relay node to send the GFP frame with the same FCS added when the GFP frame is received without recalculating the FCS.</p>
<p id="p-0161" num="0166">Furthermore, since this GFP frame transfer apparatus further comprises an FCS check section to perform an FCS check using the payload field and FCS field of the GFP frame when this GFP frame transfer apparatus receives the GFP frame, it is possible to determine whether an error has occurred or not in the GFP frame which is transferred from another GFP frame transfer apparatus. If the FCS check by the FCS check section detects an error in the GFP frame to be transferred to the next GFP frame transfer apparatus, it is desirable not to discard this GFP frame but to transfer it with the same FCS added when the error is detected to the next GFP frame transfer apparatus. By transferring the GFP frame up to the Egress node in the GFP network, it is possible to detect an error that occurs on the path between the Ingress node and Egress node through an FCS check at the Egress node and thereby realize end-to-end path performance monitoring using the FCS field.</p>
<p id="p-0162" num="0167">Furthermore, since the monitoring control processing section of the GFP frame transfer apparatus which has detected an error through an FCS check notifies the GFP network control system of the error detection, it is also possible to facilitate identification of the error location in the path in addition to the above-described end-to-end path performance monitoring.</p>
<p id="p-0163" num="0168">According to the GFP frame transfer apparatus according to the second embodiment, when receiving GFP frame and transferring it to the next GFP frame transfer apparatus, the GFP frame transfer apparatus comprises an FCS recalculation section that recalculates the FCS of the GFP frame output from the GFP frame transfer apparatus based on the difference of the extension header area of the GFP frame and eHEC (extension Header Error Control) field before and after an update in the GFP frame transfer apparatus and the FCS (Frame Check Sequence) of the GFP frame when input to the GFP frame transfer apparatus, and adds this FCS to the FCS field of the GFP frame, and can thereby take the difference only for the extension header area and eHEC field which may be changed at each relay node and recalculate the FCS using this difference and using the calculation method not considering the payload field which is basically not changed by each GFP frame transfer apparatus.</p>
<p id="p-0164" num="0169">Furthermore, since the GFP frame transfer apparatus is further provided with an FCS check section for, when this GFP frame transfer apparatus receives the GFP frame, carrying out an FCS check using the payload area of the GFP frame and FCS field, it is possible to decide whether an error has occurred or not in the GFP frame which has been transferred from another GFP frame transfer apparatus. When the FCS check by the FCS check section detects an error in the GFP frame to be transferred to the next GFP frame transfer apparatus, it is desirable not to discard this GFP frame but to transfer it with the FCS recalculated by the FCS recalculation section to the next GFP frame transfer apparatus. By transferring the GFP frame up to the Egress node, it is possible to detect, through an FCS check at the Egress node, an error that occurs on the path between the Ingress node and Egress node and thereby realize end-to-end path performance monitoring using the FCS field.</p>
<p id="p-0165" num="0170">Furthermore, since the monitoring control processing section of the GFP frame transfer apparatus which has detected an error through an FCS check notifies the GFP network control system of the error detection, it is also possible to facilitate identification of the error location in the path in addition to the above-described end-to-end path performance monitoring.</p>
<p id="p-0166" num="0171">The FCS recalculation section can be implemented by a subtraction circuit that calculates a difference of the extension header area of the GFP frame and the eHEC field before and after an update in the GFP frame transfer apparatus, a CRC operation circuit that includes a plurality of remainder registers, provides feedback corresponding to the generating function G(x) of the FCS for the plurality of remainder registers and receives the above-described difference as input, and an addition circuit that calculates a sum of the outputs of the plurality of remainder registers of the CRC operation circuit and the FCS bits of the GFP frame when input to the GFP frame transfer apparatus. In this case, the FCS recalculation section recalculates FCS by calculating the above-described difference by the subtraction circuit, initializing all of the plurality of remainder registers of the CRC operation circuit to 0, inputting the above-described difference to the CRC operation circuit, inputting 0 by the number of bits of the payload field+32 to the CRC operation circuit, and adding up the outputs of the above-described plurality of remainder registers and the above-described FCS bits of the GFP frame when input to the GFP frame transfer apparatus through the addition circuit at the next clock.</p>
<p id="p-0167" num="0172">According to the GFP frame transfer apparatus according to the third embodiment, when receiving a GFP frame, the GFP frame transfer apparatus comprises an FCS check/error notification bit setting section that performs an error check using the FCS (Frame Check Sequence) of the above-described GFP frame and sets an error notification bit in a predetermined field of the extension header area of the GFP frame when this FCS check detects an error, and can thereby notify the subsequent GFP frame transfer apparatuses through the error notification bit whether an error has occurred or not in the GFP frame transfer apparatus. When the FCS check by the above-described FCS check/error notification bit setting section detects an error in the GFP frame to be transferred to the next GFP frame transfer apparatus, it is desirable not to discard the GFP frame but to transfer it with the FCS recalculated by the GFP frame transfer apparatus to the next GFP frame transfer apparatus. This allows the GFP frame transfer apparatus on the Egress side to realize end-to-end path performance monitoring with reference to the error notification bit, detect deterioration/error in link units at each intermediate node through an FCS check and detect all trouble on the path through the error notification bit and FCS check.</p>
<p id="p-0168" num="0173">As the above-described GFP frame, the conventional GFP ring frame can be used and in this case it is possible to provide the above-described predetermined field in which the error notification bit is set, for example, in part of the Spare field in the extension header area.</p>
<p id="p-0169" num="0174">As the GFP frame, it is also possible to use the GFP path frame which stores the label corresponding to the path ID defined to uniquely specify the path from the Ingress node to Egress node in the GFP network in a predetermined field of the extension header area. This GFP path frame is a frame also available to complicated network topologies such as mesh-shaped, multi-ring-shaped topologies in addition to the ring-shaped connection GFP network and it is possible to realize end-to-end path performance monitoring which is particularly important in frame transfers in the GFP network in a complicated mode using the FCS field of the GFP path frame.</p>
<p id="p-0170" num="0175">Furthermore, it is also possible to allow the above-described GFP frame transfer apparatus to accommodate a subnetwork such as Ethernet, POS (Packet Over SONET). When Ethernet is accommodated as a subnetwork, the packet extraction section of the GFP frame transfer apparatus can terminate this Ethernet frame, extract a packet from the payload of this Ethernet frame, store this packet in the payload field of the GFP frame and send to the GFP network. Furthermore, when the POS is accommodated as the subnetwork, the packet extraction section of the GFP frame transfer apparatus can terminate the HDLC frame of this POS, extract a packet from the payload of this HDLC frame, store this packet in the payload field of the GFP frame and send to the GFP network. The packet extraction section extracts the packet, for example, by removing unnecessary overhead for the subnetwork from the frame of the subnetwork.</p>
<p id="p-0171" num="0176">Furthermore, when the GFP frame transmission section of the above-described GFP frame transfer apparatus sends a GFP frame to the GFP network, the GFP network can store the above-described GFP frame in the layer <b>1</b> frame which is the first layer frame of the OSI reference model that accommodates the GFP frame in the GFP network and send the layer <b>1</b> frame that stores this GFP frame from an appropriate output port of the GFP frame transfer apparatus to the GFP network. As the first layer of this OSI reference model, it is possible to use SONET (Synchronous Optical NETwork), OTN (Optical Transport Network), etc. When SONET is used as the above-described first layer, the GFP frame transmission section can store the GFP frame in the payload of the SONET frame of the SONET and send the SONET frame that stores this GFP frame to the GFP network. Furthermore, when the OTN is used as the above-described first layer, the GFP frame transmission section can store the GFP frame in the OPUk (Optical channel payload unit) which is the payload of the digital wrapper frame of the OTN and send the digital wrapper frame that stores this GFP frame to the GFP network. Furthermore, each GFP frame transfer method of the present invention can also obtain an effect similar to the effect of each GFP frame transfer apparatus of the present invention described above.</p>
<p id="p-0172" num="0177">While this invention has been described in connection with certain preferred embodiments, it is to be understood that the subject matter encompassed by way of this invention is not to be limited to those specific embodiments. On the contrary, it is intended for the subject matter of the invention to include all alternative, modification and equivalents as can be included within the spirit and scope of the following claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>The invention claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A GFP frame transfer apparatus for transferring a GFP (Generic Frame Procedure) frame over a GFP network, comprising an FCS generation section that generates, when said GFP frame is generated and sent by said GFP frame transfer apparatus, an FCS (Frame Check Sequence) using a payload field, without a payload header, of said GFP frame as a generation target area and adds this FCS to an FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising an FCS check section that carries out, when said GFP frame transfer apparatus receives said GFP frame, an FCS check using said payload field and said FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, wherein when said FCS check by said FCS check section detects an error of the GFP frame to be transferred to a next GFP frame transfer apparatus, said GFP frame is not discarded, but transferred to the next GFP frame transfer apparatus with a same FCS added when said error is detected.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00002">claim 2</claim-ref>, further comprising a monitoring control processing section that is notified, when said FCS check by said FCS check section detects an error, of this error detection from said FCS check section and notifies this error detection to a control system of said GFP network.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. A GFP frame transfer apparatus for transferring a GFP (Generic Frame Procedure) frame over a GFP network, comprising an FCS recalculation section that recalculates, when said GFP frame transfer apparatus receives said GFP frame and transfers to a next GFP frame transfer apparatus, the FCS of said GFP frame output from said GFP frame transfer apparatus based on a difference of an extension header area of said GFP frame and an eHEC (extension Header Error Control) field before and after an update in said GFP frame transfer apparatus and the FCS (Frame Check Sequence) of said GFP frame when input to said GFP frame transfer apparatus, and adds this FCS to an FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, further comprising an FCS check section that carries out, when said GFP frame transfer apparatus receives said GFP frame, an FCS check using said payload area and said FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, wherein when said FCS check by said FCS check section detects an error of the GFP frame to be transferred to the next GFP frame transfer apparatus, said GFP frame is not discarded, but transferred to said next GFP frame transfer apparatus with said FCS recalculated by said FCS recalculation section added.</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00006">claim 6</claim-ref>, further comprising a monitoring control processing section that is notified, when said FCS check by said FCS check section detects an error, of this error detection from said FCS check section and notifies this error detection to a control system of said GFP network.</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00005">claim 5</claim-ref>, wherein said FCS recalculation section comprises:
<claim-text>a subtraction circuit that calculates a difference of said extension header area of said GFP frame and said eHEC field before and after an update in said GFP frame transfer apparatus;</claim-text>
<claim-text>a CRC operation circuit that includes a plurality of remainder registers, provides a feedback corresponding to a generating function G(x) of said FCS for said plurality of remainder registers and receives said difference as an input; and</claim-text>
<claim-text>an addition circuit that calculates a sum of outputs of said plurality of remainder registers of said CRC operation circuit and bits of said FCS of said GFP frame when input to said GFP frame transfer apparatus.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00009">claim 9</claim-ref>, wherein the FCS recalculation by said FCS recalculation section is performed by calculating said difference by said subtraction circuit, initializing all said plurality of remainder registers of said CRC operation circuit to 0, inputting said difference to said CRC operation circuit, inputting 0 by a number of bits of said payload field +32 to said CRC operation circuit and adding up outputs of said plurality of remainder registers and said bits of said FCS of said GFP frame when input to said GFP frame transfer apparatus using said addition circuit at a next clock.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. A GFP frame transfer apparatus for transferring a GFP (Generic Frame Procedure) frame over a GFP network, comprising an FCS check/error notification bit setting section that, when said GFP frame transfer apparatus receives said GFP frame, carries out an error check using an FCS (Frame Check Sequence) of said GFP frame, and when this FCS check detects an error, sets an error notification bit in a predetermined field in an extension header area of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein, when said FCS check by said FCS check/error notification bit setting section detects an error of the GFP frame to be transferred to a next GFP frame transfer apparatus, said GFP frame is not discarded, but transferred to the next GFP frame transfer apparatus with the FCS recalculated by said GFP frame transfer apparatus added.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00011">claim 11</claim-ref>, wherein said GFP frame comprises a GFP ring frame and said predetermined field in which said error notification bit is set is provided in a part of a Spare field in an extension header area of said GFP ring frame.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said GFP frame comprises a GFP ring frame.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, wherein said GFP frame comprises a GFP path frame that stores a label corresponding to a path identification (ID) defined to uniquely specify a path from an Ingress node to an Egress node in said GFP network in a predetermined field of an extension header area.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a packet extraction section that terminates a frame of a subnetwork that stores a packet to be stored in the payload field of said GFP frame and extracts said packet from the frame of said subnetwork.</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein said packet extraction section extracts said packet by removing an unnecessary overhead for said subnetwork from a frame of said subnetwork.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00016">claim 16</claim-ref>, wherein said subnetwork comprises Ethernet.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00018">claim 18</claim-ref>, wherein said packet extraction section extracts said packet from a payload of an Ethernet frame of said Ethernet.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00016">claim 16</claim-ref> or <claim-ref idref="CLM-00017">claim 17</claim-ref>, wherein said subnetwork comprises a POS (Packet Over SONET).</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00020">claim 20</claim-ref>, wherein said packet extraction section extracts said packet from a payload of an HDLC frame of said POS.</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00001">claim 1</claim-ref>, further comprising a GFP frame transmission section that stores said GFP frame in a layer <b>1</b> frame which comprises a first layer frame of an OSI reference model accommodating said GFP frame in said GFP network and sends said layer <b>1</b> frame storing said GFP frame from an appropriate output port of said GFP frame transfer apparatus to said GFP network.</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein a SONET (Synchronous Optical NETwork) is used as the first layer of said OSI reference model.</claim-text>
</claim>
<claim id="CLM-00024" num="00024">
<claim-text>24. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00023">claim 23</claim-ref>, wherein said GFP frame transmission section stores said GFP frame in a payload of a SONET frame of said SONET and sends said SONET frame storing said GFP frame to said GFP network.</claim-text>
</claim>
<claim id="CLM-00025" num="00025">
<claim-text>25. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00022">claim 22</claim-ref>, wherein an OTN (Optical Transport Network) is used as the first layer of said OSI reference model.</claim-text>
</claim>
<claim id="CLM-00026" num="00026">
<claim-text>26. The GFP frame transfer apparatus according to <claim-ref idref="CLM-00025">claim 25</claim-ref>, wherein said GFP frame transmission section stores said GFP frame in an OPUk (Optical channel payload unit) which comprises a payload of a digital wrapper frame of said OTN and sends said digital wrapper frame that stores said GFP frame to said GFP network.</claim-text>
</claim>
<claim id="CLM-00027" num="00027">
<claim-text>27. A GFP frame transfer method for transferring a GFP (Generic Frame Procedure) frame over a GFP network, comprising an FCS generating step of generating, when said GFP frame is generated and sent by said GFP frame transfer apparatus, an FCS (Frame Check Sequence) using a payload field, without a payload header, of said GFP frame as a generation target area and adding this FCS to an FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00028" num="00028">
<claim-text>28. The GFP frame transfer method according to <claim-ref idref="CLM-00027">claim 27</claim-ref>, further comprising an FCS checking step of carrying out, when said GFP frame transfer apparatus receives said GFP frame, an FCS check using said payload field and said FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00029" num="00029">
<claim-text>29. The GFP frame transfer method according to <claim-ref idref="CLM-00028">claim 28</claim-ref>, wherein when said FCS check in said FCS checking step detects an error of a GFP frame to be transferred to a next GFP frame transfer apparatus, said GFP frame is not discarded, but transferred to the next GFP frame transfer apparatus with a same FCS added when said error is detected.</claim-text>
</claim>
<claim id="CLM-00030" num="00030">
<claim-text>30. The GFP frame transfer method according to <claim-ref idref="CLM-00028">claim 28</claim-ref>, further comprising a monitoring control processing step of notifying, when said FCS check in said FCS checking step detects an error, of this error detection to a control system of said GFP network.</claim-text>
</claim>
<claim id="CLM-00031" num="00031">
<claim-text>31. A GFP frame transfer method with a GFP frame transfer apparatus for transferring a GFP (Generic Frame Procedure) frame over a GFP network, comprising an FCS recalculating step of recalculating, when said GFP frame transfer apparatus receives a GFP frame and transfers said GFP frame to a next GFP frame transfer apparatus, an FCS of said GFP frame output from said GFP frame transfer apparatus, based on a difference of an extension header area of said GFP frame and an eHEC (extension Header Error Control) field before and after an update in said GFP frame transfer apparatus and the FCS (Frame Check Sequence) of said GFP frame when input to said GFP frame transfer apparatus, and adding this FCS to an FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00032" num="00032">
<claim-text>32. The GFP frame transfer method according to <claim-ref idref="CLM-00031">claim 31</claim-ref>, further comprising an FCS checking step of carrying out, when said GFP frame transfer apparatus receives said GFP frame, an FCS check using said payload area and said FCS field of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00033" num="00033">
<claim-text>33. The GFP frame transfer method according to <claim-ref idref="CLM-00032">claim 32</claim-ref>, wherein, when said FCS check in said FCS checking step detects an error of the GFP frame to be transferred to the next GFP frame transfer apparatus, said GFP frame is not discarded, but transferred to said next GFP frame transfer apparatus with said FCS recalculated in said FCS recalculating step added.</claim-text>
</claim>
<claim id="CLM-00034" num="00034">
<claim-text>34. The GFP frame transfer method according to <claim-ref idref="CLM-00032">claim 32</claim-ref>, further comprising a monitoring control processing step of notifying, when said FCS check in said FCS checking step detects an error, this error detection to a control system of said GFP network.</claim-text>
</claim>
<claim id="CLM-00035" num="00035">
<claim-text>35. The GFP frame transfer method according to <claim-ref idref="CLM-00031">claim 31</claim-ref>, wherein said FCS recalculating step comprises:
<claim-text>a subtraction circuit that calculates said difference of said extension header area of said GFP frame and said eHEC field before and after an update in said GFP frame transfer apparatus;</claim-text>
<claim-text>a CRC operation circuit that includes a plurality of remainder registers, provides feedback corresponding to a generating function G(x) of said FCS for said plurality of remainder registers and receives said difference as input; and</claim-text>
<claim-text>an addition circuit that calculates a sum of outputs of said plurality of remainder registers of said CRC operation circuit and bits of said FCS of said GFP frame when input to said GFP frame transfer apparatus.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00036" num="00036">
<claim-text>36. The GFP frame transfer method according to <claim-ref idref="CLM-00035">claim 35</claim-ref>, wherein the FCS recalculation in said FCS recalculating step is performed by calculating said difference by said subtraction circuit, initializing all said plurality of remainder registers of said CRC operation circuit to 0, inputting said difference to said CRC operation circuit, inputting 0 by a number of bits of said payload field +32 to said CRC operation circuit and adding up said outputs of said plurality of remainder registers and said bits of said FCS of said GFP frame when input to said GFP frame transfer apparatus, using said addition circuit at a next clock.</claim-text>
</claim>
<claim id="CLM-00037" num="00037">
<claim-text>37. A GFP frame transfer method with a GFP frame transfer apparatus for transferring a GFP (Generic Frame Procedure) frame over a GFP network, comprising an FCS check/error notification bit setting step of carrying out, when said GFP frame transfer apparatus receives said GFP frame, an error check using an FCS (Frame Check Sequence) of said GFP frame, and when this FCS check detects an error, setting an error notification bit in a predetermined field in an extension header area of said GFP frame.</claim-text>
</claim>
<claim id="CLM-00038" num="00038">
<claim-text>38. The GFP frame transfer method according to <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein, when said FCS check in said FCS check/error notification bit setting step detects an error of the GFP frame to be transferred to a next GFP frame transfer apparatus, said GFP frame is not discarded, but transferred to the next GFP frame transfer apparatus with the FCS recalculated by said GFP frame transfer apparatus added.</claim-text>
</claim>
<claim id="CLM-00039" num="00039">
<claim-text>39. The GFP frame transfer method according to <claim-ref idref="CLM-00037">claim 37</claim-ref>, wherein said GFP frame comprises a GFP ring frame and said predetermined field in which said error notification bit is set is provided in a part of a Spare field in an extension header area of said GFP ring frame.</claim-text>
</claim>
<claim id="CLM-00040" num="00040">
<claim-text>40. The GFP frame transfer method according to <claim-ref idref="CLM-00027">claim 27</claim-ref>, wherein said GFP frame comprises a GFP ring frame.</claim-text>
</claim>
<claim id="CLM-00041" num="00041">
<claim-text>41. The GFP frame transfer method according to <claim-ref idref="CLM-00027">claim 27</claim-ref>, wherein said GFP frame comprises a GFP path frame that stores a label corresponding to a path identification (ID) defined to uniquely specify a path from an Ingress node to an Egress node in said GFP network in a predetermined field in an extension header area.</claim-text>
</claim>
<claim id="CLM-00042" num="00042">
<claim-text>42. The GFP frame transfer method according to <claim-ref idref="CLM-00027">claim 27</claim-ref>, further comprising a packet extracting step of terminating a frame of a subnetwork that stores a packet to be stored in the payload field of said GFP frame and extracting said packet from the frame of said subnetwork.</claim-text>
</claim>
<claim id="CLM-00043" num="00043">
<claim-text>43. The GFP frame transfer method according to <claim-ref idref="CLM-00042">claim 42</claim-ref>, wherein in said packet extracting step, said packet is extracted by removing an unnecessary overhead for said subnetwork from the frame of said subnetwork.</claim-text>
</claim>
<claim id="CLM-00044" num="00044">
<claim-text>44. The GFP frame transfer method according to <claim-ref idref="CLM-00042">claim 42</claim-ref>, wherein said subnetwork comprises Ethernet.</claim-text>
</claim>
<claim id="CLM-00045" num="00045">
<claim-text>45. The GFP frame transfer method according to <claim-ref idref="CLM-00044">claim 44</claim-ref>, wherein in the packet extracting step, said packet is extracted from a payload of an Ethernet frame of said Ethernet.</claim-text>
</claim>
<claim id="CLM-00046" num="00046">
<claim-text>46. The GFP frame transfer method according to <claim-ref idref="CLM-00042">claim 42</claim-ref>, wherein said subnetwork comprises a POS (Packet Over SONET).</claim-text>
</claim>
<claim id="CLM-00047" num="00047">
<claim-text>47. The GFP frame transfer method according to <claim-ref idref="CLM-00046">claim 46</claim-ref>, wherein in said packet extracting step, said packet is extracted from a payload of an HDLC frame of said POS.</claim-text>
</claim>
<claim id="CLM-00048" num="00048">
<claim-text>48. The GFP frame transfer method according to <claim-ref idref="CLM-00027">claim 27</claim-ref>, further comprising a GFP frame transmitting step of storing said GFP frame in a layer <b>1</b> frame which is a first layer frame of an OSI reference model accommodating said GFP frame in said GFP network and sending said layer <b>1</b> frame storing said GFP frame from an appropriate output port of said GFP frame transfer apparatus to said GFP network.</claim-text>
</claim>
<claim id="CLM-00049" num="00049">
<claim-text>49. The GFP frame transfer method according to <claim-ref idref="CLM-00048">claim 48</claim-ref>, wherein a SONET (Synchronous Optical NETwork) is used as the first layer of said OSI reference model.</claim-text>
</claim>
<claim id="CLM-00050" num="00050">
<claim-text>50. The GFP frame transfer method according to <claim-ref idref="CLM-00049">claim 49</claim-ref>, wherein in said GFP frame transmitting step, said GFP frame is stored in a payload of a SONET frame of said SONET and said SONET frame storing said GFP frame is sent to said GFP network.</claim-text>
</claim>
<claim id="CLM-00051" num="00051">
<claim-text>51. The GFP frame transfer method according to <claim-ref idref="CLM-00048">claim 48</claim-ref>, wherein an OTN (Optical Transport Network) is used as the first layer of said OSI reference model.</claim-text>
</claim>
<claim id="CLM-00052" num="00052">
<claim-text>52. The GFP frame transfer method according to <claim-ref idref="CLM-00051">claim 51</claim-ref>, wherein in said GFP frame transmitting step, said GFP frame is stored in an OPUk (Optical channel payload unit) which is a payload of a digital wrapper frame of said OTN and said digital wrapper frame that stores said GFP frame is sent to said GFP network.</claim-text>
</claim>
</claims>
</us-patent-grant>
