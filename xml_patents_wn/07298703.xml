<us-patent-grant lang="EN" dtd-version="v4.2 2006-08-23" file="US07298703-20071120.XML" status="PRODUCTION" id="us-patent-grant" country="US" date-produced="20071106" date-publ="20071120">
<us-bibliographic-data-grant>
<publication-reference>
<document-id>
<country>US</country>
<doc-number>07298703</doc-number>
<kind>B1</kind>
<date>20071120</date>
</document-id>
</publication-reference>
<application-reference appl-type="utility">
<document-id>
<country>US</country>
<doc-number>10210149</doc-number>
<date>20020731</date>
</document-id>
</application-reference>
<us-application-series-code>10</us-application-series-code>
<us-term-of-grant>
<us-term-extension>1221</us-term-extension>
</us-term-of-grant>
<classifications-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>54</subgroup>
<symbol-position>F</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
<classification-ipcr>
<ipc-version-indicator><date>20060101</date></ipc-version-indicator>
<classification-level>A</classification-level>
<section>H</section>
<class>04</class>
<subclass>L</subclass>
<main-group>12</main-group>
<subgroup>64</subgroup>
<symbol-position>L</symbol-position>
<classification-value>I</classification-value>
<action-date><date>20071120</date></action-date>
<generating-office><country>US</country></generating-office>
<classification-status>B</classification-status>
<classification-data-source>H</classification-data-source>
</classification-ipcr>
</classifications-ipcr>
<classification-national>
<country>US</country>
<main-classification>370236</main-classification>
<further-classification>3702301</further-classification>
<further-classification>370255</further-classification>
<further-classification>370358</further-classification>
<further-classification>370416</further-classification>
<further-classification>370429</further-classification>
</classification-national>
<invention-title id="d0e53">Hysteresis method for reducing control code transmission between a line card and a switching fabric</invention-title>
<references-cited>
<citation>
<patcit num="00001">
<document-id>
<country>US</country>
<doc-number>3775566</doc-number>
<kind>A</kind>
<name>Akimaru et al.</name>
<date>19731100</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>179 18</main-classification></classification-national>
</citation>
<citation>
<patcit num="00002">
<document-id>
<country>US</country>
<doc-number>5179552</doc-number>
<kind>A</kind>
<name>Chao</name>
<date>19930100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00003">
<document-id>
<country>US</country>
<doc-number>5197064</doc-number>
<kind>A</kind>
<name>Chao</name>
<date>19930300</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00004">
<document-id>
<country>US</country>
<doc-number>5361255</doc-number>
<kind>A</kind>
<name>Diaz et al.</name>
<date>19941100</date>
</document-id>
</patcit>
<category>cited by other</category>
</citation>
<citation>
<patcit num="00005">
<document-id>
<country>US</country>
<doc-number>5539747</doc-number>
<kind>A</kind>
<name>Ito et al.</name>
<date>19960700</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370235</main-classification></classification-national>
</citation>
<citation>
<patcit num="00006">
<document-id>
<country>US</country>
<doc-number>5673253</doc-number>
<kind>A</kind>
<name>Shaffer</name>
<date>19970900</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00007">
<document-id>
<country>US</country>
<doc-number>6091729</doc-number>
<kind>A</kind>
<name>Dove</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370395</main-classification></classification-national>
</citation>
<citation>
<patcit num="00008">
<document-id>
<country>US</country>
<doc-number>6094692</doc-number>
<kind>A</kind>
<name>Kalkunte</name>
<date>20000700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710 34</main-classification></classification-national>
</citation>
<citation>
<patcit num="00009">
<document-id>
<country>US</country>
<doc-number>6122251</doc-number>
<kind>A</kind>
<name>Shinohara</name>
<date>20000900</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370231</main-classification></classification-national>
</citation>
<citation>
<patcit num="00010">
<document-id>
<country>US</country>
<doc-number>6147997</doc-number>
<kind>A</kind>
<name>Holden et al.</name>
<date>20001100</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>3703951</main-classification></classification-national>
</citation>
<citation>
<patcit num="00011">
<document-id>
<country>US</country>
<doc-number>6157643</doc-number>
<kind>A</kind>
<name>Ma</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370389</main-classification></classification-national>
</citation>
<citation>
<patcit num="00012">
<document-id>
<country>US</country>
<doc-number>6167030</doc-number>
<kind>A</kind>
<name>Kilkki et al.</name>
<date>20001200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370236</main-classification></classification-national>
</citation>
<citation>
<patcit num="00013">
<document-id>
<country>US</country>
<doc-number>6356548</doc-number>
<kind>B1</kind>
<name>Nellenbach et al.</name>
<date>20020300</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370362</main-classification></classification-national>
</citation>
<citation>
<patcit num="00014">
<document-id>
<country>US</country>
<doc-number>6636949</doc-number>
<kind>B2</kind>
<name>Barroso et al.</name>
<date>20031000</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>711141</main-classification></classification-national>
</citation>
<citation>
<patcit num="00015">
<document-id>
<country>US</country>
<doc-number>6700869</doc-number>
<kind>B1</kind>
<name>Falco et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370230</main-classification></classification-national>
</citation>
<citation>
<patcit num="00016">
<document-id>
<country>US</country>
<doc-number>6715007</doc-number>
<kind>B1</kind>
<name>Williams et al.</name>
<date>20040300</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710 52</main-classification></classification-national>
</citation>
<citation>
<patcit num="00017">
<document-id>
<country>US</country>
<doc-number>6732209</doc-number>
<kind>B1</kind>
<name>Cherukuri et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>710240</main-classification></classification-national>
</citation>
<citation>
<patcit num="00018">
<document-id>
<country>US</country>
<doc-number>6839768</doc-number>
<kind>B2</kind>
<name>Ma et al.</name>
<date>20050100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>709235</main-classification></classification-national>
</citation>
<citation>
<patcit num="00019">
<document-id>
<country>US</country>
<doc-number>6937568</doc-number>
<kind>B1</kind>
<name>Nicholl et al.</name>
<date>20050800</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370236</main-classification></classification-national>
</citation>
<citation>
<patcit num="00020">
<document-id>
<country>US</country>
<doc-number>7068602</doc-number>
<kind>B2</kind>
<name>Davari et al.</name>
<date>20060600</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370232</main-classification></classification-national>
</citation>
<citation>
<patcit num="00021">
<document-id>
<country>US</country>
<doc-number>7072299</doc-number>
<kind>B2</kind>
<name>Bass et al.</name>
<date>20060700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370235</main-classification></classification-national>
</citation>
<citation>
<patcit num="00022">
<document-id>
<country>US</country>
<doc-number>7145904</doc-number>
<kind>B2</kind>
<name>Zhao et al.</name>
<date>20061200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370371</main-classification></classification-national>
</citation>
<citation>
<patcit num="00023">
<document-id>
<country>US</country>
<doc-number>2002/0057712</doc-number>
<kind>A1</kind>
<name>Moriwaki et al.</name>
<date>20020500</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>370463</main-classification></classification-national>
</citation>
<citation>
<patcit num="00024">
<document-id>
<country>US</country>
<doc-number>2003/0007452</doc-number>
<kind>A1</kind>
<name>Gorti et al.</name>
<date>20030100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370229</main-classification></classification-national>
</citation>
<citation>
<patcit num="00025">
<document-id>
<country>US</country>
<doc-number>2003/0035373</doc-number>
<kind>A1</kind>
<name>Bass et al.</name>
<date>20030200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>3702301</main-classification></classification-national>
</citation>
<citation>
<patcit num="00026">
<document-id>
<country>US</country>
<doc-number>2003/0128703</doc-number>
<kind>A1</kind>
<name>Zhao et al.</name>
<date>20030700</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370392</main-classification></classification-national>
</citation>
<citation>
<patcit num="00027">
<document-id>
<country>US</country>
<doc-number>2003/0165150</doc-number>
<kind>A1</kind>
<name>Zimmerman et al.</name>
<date>20030900</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370412</main-classification></classification-national>
</citation>
<citation>
<patcit num="00028">
<document-id>
<country>US</country>
<doc-number>2003/0231593</doc-number>
<kind>A1</kind>
<name>Bauman et al.</name>
<date>20031200</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370235</main-classification></classification-national>
</citation>
<citation>
<patcit num="00029">
<document-id>
<country>US</country>
<doc-number>2004/0004961</doc-number>
<kind>A1</kind>
<name>Lakshmanamurthy et al.</name>
<date>20040100</date>
</document-id>
</patcit>
<category>cited by examiner</category>
<classification-national><country>US</country><main-classification>370364</main-classification></classification-national>
</citation>
<citation>
<patcit num="00030">
<document-id>
<country>US</country>
<doc-number>2004/0085967</doc-number>
<kind>A1</kind>
<name>Boduch et al.</name>
<date>20040500</date>
</document-id>
</patcit>
<category>cited by other</category>
<classification-national><country>US</country><main-classification>37039542</main-classification></classification-national>
</citation>
</references-cited>
<number-of-claims>23</number-of-claims>
<us-exemplary-claim>1</us-exemplary-claim>
<us-field-of-classification-search>
<classification-national>
<country>US</country>
<main-classification>370230-232</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370235</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370236</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370254</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370255</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370357-358</main-classification>
<additional-info>unstructured</additional-info>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370360</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370412</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370415</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370416</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370419</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370428</main-classification>
</classification-national>
<classification-national>
<country>US</country>
<main-classification>370429</main-classification>
</classification-national>
</us-field-of-classification-search>
<figures>
<number-of-drawing-sheets>8</number-of-drawing-sheets>
<number-of-figures>10</number-of-figures>
</figures>
<us-related-documents>
<continuation-in-part>
<relation>
<parent-doc>
<document-id>
<country>US</country>
<doc-number>09978475</doc-number>
<kind>00</kind>
<date>20011016</date>
</document-id>
<parent-status>PENDING</parent-status>
</parent-doc>
<child-doc>
<document-id>
<country>US</country>
<doc-number>10210149</doc-number>
</document-id>
</child-doc>
</relation>
</continuation-in-part>
</us-related-documents>
<parties>
<applicants>
<applicant sequence="001" app-type="applicant-inventor" designation="us-only">
<addressbook>
<last-name>Rose</last-name>
<first-name>Kenneth M.</first-name>
<address>
<city>Palo Alto</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
<nationality>
<country>omitted</country>
</nationality>
<residence>
<country>US</country>
</residence>
</applicant>
</applicants>
<agents>
<agent sequence="01" rep-type="attorney">
<addressbook>
<orgname>Campbell Stephenson LLP</orgname>
<address>
<country>unknown</country>
</address>
</addressbook>
</agent>
</agents>
</parties>
<assignees>
<assignee>
<addressbook>
<orgname>Cisco Technology, Inc.</orgname>
<role>02</role>
<address>
<city>San Jose</city>
<state>CA</state>
<country>US</country>
</address>
</addressbook>
</assignee>
</assignees>
<examiners>
<primary-examiner>
<last-name>Pham</last-name>
<first-name>Chi</first-name>
<department>2616</department>
</primary-examiner>
<assistant-examiner>
<last-name>Elallam</last-name>
<first-name>Ahmed</first-name>
</assistant-examiner>
</examiners>
</us-bibliographic-data-grant>
<abstract id="abstract">
<p id="p-0001" num="0000">Disclosed is a circuit and method for reducing control code transmission between a line card and a switching fabric. One embodiment includes a memory receiving (and storing) data transmitted at a second rate during a first period of time. A quantity of data in the memory at time t, q(t), is compared with first, second, third, and fourth quantity values. The memory may receive data transmitted at the first rate if q(t) is less than the second, third and fourth values but greater than the first value. The memory may receive data transmitted at the third rate if q(t) is greater than the first, second, and third values but less than the fourth value. The memory may receive data transmitted at the second rate if q(t) is greater than the first and second values but less than the third and fourth values.</p>
</abstract>
<drawings id="DRAWINGS">
<figure id="Fig-EMI-D00000" num="00000">
<img id="EMI-D00000" he="122.17mm" wi="75.52mm" file="US07298703-20071120-D00000.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00001" num="00001">
<img id="EMI-D00001" he="227.67mm" wi="151.98mm" file="US07298703-20071120-D00001.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00002" num="00002">
<img id="EMI-D00002" he="222.42mm" wi="152.06mm" file="US07298703-20071120-D00002.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00003" num="00003">
<img id="EMI-D00003" he="176.19mm" wi="117.43mm" orientation="landscape" file="US07298703-20071120-D00003.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00004" num="00004">
<img id="EMI-D00004" he="232.66mm" wi="157.82mm" file="US07298703-20071120-D00004.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00005" num="00005">
<img id="EMI-D00005" he="229.79mm" wi="173.91mm" file="US07298703-20071120-D00005.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00006" num="00006">
<img id="EMI-D00006" he="247.90mm" wi="182.12mm" file="US07298703-20071120-D00006.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00007" num="00007">
<img id="EMI-D00007" he="254.51mm" wi="175.01mm" file="US07298703-20071120-D00007.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
<figure id="Fig-EMI-D00008" num="00008">
<img id="EMI-D00008" he="135.30mm" wi="77.13mm" file="US07298703-20071120-D00008.TIF" alt="embedded image" img-content="drawing" img-format="tif"/>
</figure>
</drawings>
<description id="description">
<?RELAPP description="Other Patent Relations" end="lead"?>
<heading id="h-0001" level="1">RELATED APPLICATION</heading>
<p id="p-0002" num="0001">This application is a continuation in part and claims priority to patent application Ser. No. 09/978,475, filed Oct. 16, 2001, pending.</p>
<?RELAPP description="Other Patent Relations" end="tail"?>
<?BRFSUM description="Brief Summary" end="lead"?>
<heading id="h-0002" level="1">BACKGROUND OF THE INVENTION</heading>
<p id="p-0003" num="0002">Local switching networks (e.g., a switching network contained within an office building) may include a switching fabric coupling end devices via line cards. The term switching fabric is a term that describes a distributed switching matrix that establishes a circuit through which data may be transmitted between end devices. A switching fabric may include a stored program control that seeks out a suitable combination of time-slots and multiplexed highways to establish the circuit between the end devices. Multiple highways can co-exist simultaneously being exclusive from/to end devices. The term end device may include desktop computers, printers, routers, or other networking equipment, etc.</p>
<p id="p-0004" num="0003"><figref idref="DRAWINGS">FIG. 1</figref><i>a </i>illustrates, in block diagram form, an exemplary local switching network <b>100</b>. Local switch network <b>100</b> includes a switching fabric <b>102</b> (e.g., a cross-bar switching fabric) coupled to line cards <b>104</b> through <b>108</b>. Each of the line cards may be coupled to one or more end devices or other networks. <figref idref="DRAWINGS">FIG. 1</figref><i>a </i>shows line card <b>104</b> coupled to end devices <b>110</b> through <b>114</b> via common bus <b>140</b>, line card <b>106</b> coupled to end devices <b>116</b> through <b>120</b> via common bus <b>142</b>, and line card <b>108</b> coupled to end devices <b>122</b> through <b>126</b> via common bus <b>144</b>.</p>
<p id="p-0005" num="0004">The local switching network <b>100</b> shown in <figref idref="DRAWINGS">FIG. 1</figref><i>a </i>may employ one of many different communication protocols enabling data communication between one or more end devices <b>110</b> through <b>126</b> via line cards <b>104</b> through <b>108</b> and switching fabric <b>102</b>. <figref idref="DRAWINGS">FIG. 1</figref><i>a </i>will be described with reference to a communications protocol in which end devices communicate by transferring data frames or packets to each other via line cards and the switching fabric. Each data packet includes one or more lines of data. The lines of the data packet may be transmitted during consecutive data transmission cycles of the link between the line card and the switching fabric. Lines of the data packet may also be transmitted during non-consecutive transmission cycles of the link between the line card and the switching fabric. Line cards <b>104</b> through <b>108</b> are coupled to switching fabric <b>102</b> via one or more data links. In <figref idref="DRAWINGS">FIG. 1</figref><i>a</i>, line card <b>104</b> is coupled switching fabric <b>102</b> via downlink and uplink <b>128</b> and <b>130</b>, respectively, line card <b>106</b> is coupled switching fabric <b>102</b> via downlink and uplink <b>132</b> and <b>134</b>, respectively, and line card <b>108</b> is coupled switching fabric <b>102</b> via downlink and uplink <b>136</b> and <b>138</b>, respectively.</p>
<p id="p-0006" num="0005"><figref idref="DRAWINGS">FIG. 1</figref><i>b </i>illustrates in block diagram form, relevant portions of a line card <b>104</b>. As shown in <figref idref="DRAWINGS">FIG. 1</figref><i>b</i>, line card <b>104</b> includes a receiving data buffer <b>150</b>, a formatter <b>152</b>, a control circuit <b>154</b>, and a multiplexer <b>156</b>. Multiplexer <b>156</b> selectively couples an output of formatter <b>152</b> and common bus <b>140</b> to uplink <b>130</b> in response to a control signal generated by control circuit <b>154</b>. Formatter generates control codes to be transmitted to switching fabric <b>102</b>. Control circuit <b>154</b> couples the output of formatter <b>152</b> to uplink <b>130</b> in response to formatter generating a control code. Otherwise, control circuit <b>154</b> couples common bus <b>140</b> to uplink <b>130</b> thereby allowing data to be transmitted to switching fabric <b>102</b>. It is noted that the contents of packets received by line cards are optionally modified by a separate formatter (not shown) before being sent through the multiplexer <b>156</b> to fabric <b>102</b>. For example, the contents of first lines of selected packets may be modified before passing through the multiplexer <b>156</b>.</p>
<p id="p-0007" num="0006">Data buffer <b>150</b> typically is a first in first out (FIFO) buffer. Buffer <b>150</b> is configured to receive and store lines of data received from switching fabric <b>102</b> via downlink <b>128</b>. The data is stored within buffer <b>150</b> until it is transmitted to one of the end devices <b>110</b> through <b>114</b> (not shown in <figref idref="DRAWINGS">FIG. 1</figref><i>b</i>) via common bus <b>140</b>. Common bus <b>140</b> may take form in a bi-directional bus. In this embodiment, a switch may be provided (not shown) for selectively coupling the data buffer <b>150</b> or the multiplexer <b>156</b> to the bi-directional bus. In the alternative, common bus <b>140</b> may take form in a pair of unidirectional buses respectively coupled to buffer <b>150</b> and multiplexer <b>156</b>.</p>
<p id="p-0008" num="0007">Formatter <b>152</b> provides a plurality of functions. One function is to monitor buffer <b>150</b>. Often times, buffer <b>150</b> cannot output data to end devices <b>110</b> through <b>114</b> as fast as data is input to buffer <b>150</b> from switching fabric. In this situation, buffer <b>150</b> may completely fill as new data is sent from switching fabric <b>102</b> for storage therein. Because the buffer has no room for storing the new data, the new data may be lost.</p>
<p id="p-0009" num="0008">Formatter <b>152</b> monitors the quantity of data stored in buffer <b>150</b> on an ongoing basis. To this end, formatter <b>152</b> receives information from data buffer <b>150</b> which identifies the quantity of data stored therein. Formatter compares this data against a single programmable threshold value (e.g., 80% of the full storage capacity of buffer <b>150</b>). If the quantity of data stored in buffer <b>150</b> exceeds this threshold value, formatter <b>152</b> generates a stop-transmit control code instructing the switching fabric <b>102</b> to stop transmitting data for storage in buffer <b>150</b>. Once generated, the stop-transmit control code is transmitted to switching fabric via multiplexer <b>156</b> and uplink <b>130</b>. The switching fabric <b>102</b> stops sending data to line card <b>104</b> for storage in buffer <b>150</b> in response to receiving the stop-transmit control code, thereby decreasing the chances of buffer <b>150</b> overflow. However, it is noted that switching fabric may continue to send new data to line card <b>104</b> until the switching fabric receives the stop-transmit control code.</p>
<p id="p-0010" num="0009">As buffer <b>150</b> outputs data to one of the end devices <b>110</b> through <b>114</b> while the switching fabric is in stop-transmit mode of operation, the quantity of data stored therein will decrease. Once formatter <b>152</b> detects that the contents of buffer <b>150</b> is below the single programmable threshold value, formatter <b>152</b> will generate a start-transmit control code instructing the switching fabric <b>102</b> to again start transmitting data to line card <b>104</b>. The start-transmit control code is transmitted to switching fabric <b>102</b> via multiplexer <b>156</b> and uplink <b>130</b>. When the start-transmit control code is received by the switching fabric <b>102</b>, switching fabric starts to transmit data at the full rate to line card <b>104</b> for storage in buffer <b>104</b>.</p>
<p id="p-0011" num="0010">Thus, in the system shown in <figref idref="DRAWINGS">FIGS. 1</figref><i>a </i>and <b>1</b><i>b</i>, data transmitted by switching fabric <b>102</b> is controlled by a simple stop/start control code received from formatter <b>152</b>; either data is received within data buffer <b>150</b> at the full data transmit rate or no data is received at all. The above described method of monitoring buffers in line cards should not to be considered prior art to the claims herein.</p>
<heading id="h-0003" level="1">SUMMARY OF THE INVENTION</heading>
<p id="p-0012" num="0011">Disclosed is a circuit and method for reducing control code transmission between a line card and a switching fabric. In one embodiment, the method includes a first memory receiving and storing data transmitted by a data transmitting device at a first data transmit rate during a first period of time. The second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate. Comparing q(t), a quantity of data in the first memory at time t, with first, second, third, and fourth data quantity values wherein first data quantity value is less than the second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value. Thereafter, the first memory may receive and store data transmitted by the transmitting device at the first data transmit rate if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value. The first memory may receive and store data transmitted by the transmitting device at the third data transmit rate if q(t) is determined to be greater than the first, second, and third data quantity values but less than the fourth data quantity value. The first memory may receive and store data transmitted by the transmitting device at the second data transmit rate if q(t) is determined to be greater than the first and second data quantity values but less than the third and fourth data quantity values. The second data quantity value stored in memory may be replaced with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value. The third data quantity value stored in memory may be replaced with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</p>
<?BRFSUM description="Brief Summary" end="tail"?>
<?brief-description-of-drawings description="Brief Description of Drawings" end="lead"?>
<description-of-drawings>
<heading id="h-0004" level="1">BRIEF DESCRIPTION OF THE DRAWINGS</heading>
<p id="p-0013" num="0012">The present invention may be better understood, and it's numerous objects, features and advantages made apparent to those skilled in the art by referencing the accompanying drawings. The use of the same reference number throughout the figures designates a like or similar element.</p>
<p id="p-0014" num="0013"><figref idref="DRAWINGS">FIG. 1</figref><i>a </i>illustrates, in block diagram form, an exemplary local switching network;</p>
<p id="p-0015" num="0014"><figref idref="DRAWINGS">FIG. 1</figref><i>b </i>illustrates, in block diagram form, an exemplary line card employed in the local switching network of <figref idref="DRAWINGS">FIG. 1</figref><i>a; </i></p>
<p id="p-0016" num="0015"><figref idref="DRAWINGS">FIG. 2</figref><i>a </i>illustrates, in block diagram form, an exemplary local switching network employing the present invention;</p>
<p id="p-0017" num="0016"><figref idref="DRAWINGS">FIG. 2</figref><i>b </i>illustrates, in block diagram form, an exemplary line card employed in the local switching network of <figref idref="DRAWINGS">FIG. 2</figref><i>a; </i></p>
<p id="p-0018" num="0017"><figref idref="DRAWINGS">FIG. 2</figref><i>c </i>illustrates, in block diagram form, an exemplary line card employable in the local switching network of <figref idref="DRAWINGS">FIG. 1</figref><i>a; </i></p>
<p id="p-0019" num="0018"><figref idref="DRAWINGS">FIG. 3</figref><i>a </i>illustrates, in block diagram form, an exemplary formatter employed in the line card of <figref idref="DRAWINGS">FIG. 2</figref><i>a; </i></p>
<p id="p-0020" num="0019"><figref idref="DRAWINGS">FIG. 3</figref><i>b </i>illustrates, in block diagram form, an exemplary formatter employed in the line card of <figref idref="DRAWINGS">FIG. 2</figref><i>a; </i></p>
<p id="p-0021" num="0020"><figref idref="DRAWINGS">FIG. 4</figref><i>a </i>is a flow chart illustrating operational aspects of the formatter shown in <figref idref="DRAWINGS">FIG. 3</figref><i>a; </i></p>
<p id="p-0022" num="0021"><figref idref="DRAWINGS">FIG. 4</figref><i>b </i>is a flow chart illustrating operational aspects of the formatter shown in <figref idref="DRAWINGS">FIG. 3</figref><i>b; </i></p>
<p id="p-0023" num="0022"><figref idref="DRAWINGS">FIG. 5</figref> illustrates a programmable memory for storing transmit rate values TR(<b>1</b>)-TR(n).</p>
</description-of-drawings>
<?brief-description-of-drawings description="Brief Description of Drawings" end="tail"?>
<?DETDESC description="Detailed Description" end="lead"?>
<p id="p-0024" num="0023">While the invention is susceptible to various modifications and alternative forms, specific embodiments thereof are shown by way of example in the drawings and will herein be described in detail, it should be understood, however, that the drawings and detailed description thereto are not intended to limit the invention to the particular form disclosed but on the contrary, the intention is to cover all modifications, equivalents, and alternatives falling within the spirit and scope of the present invention as defined by the appended claims.</p>
<heading id="h-0005" level="1">DETAILED DESCRIPTION</heading>
<p id="p-0025" num="0024"><figref idref="DRAWINGS">FIG. 2</figref><i>a </i>illustrates, in block diagram form, a local switching network <b>200</b> employing the present invention. Local switch network <b>200</b> includes a switching fabric <b>202</b> (e.g., a cross-bar switching fabric) coupled to line cards <b>204</b> through <b>208</b>. Line card <b>204</b> is coupled to end devices <b>210</b> through <b>214</b>, line card <b>206</b> is coupled to end devices <b>216</b> through <b>220</b>, and line card <b>208</b> is coupled to end devices <b>224</b> through <b>226</b>.</p>
<p id="p-0026" num="0025">Devices or circuits can be coupled together either directly, i.e., without any intervening device or circuit, or indirectly, with one or more intervening devices or circuits. As used herein the term connected devices or circuits means two or more devices or circuits directly connected together without any intervening device or circuit via one or more conductors, links, transmission lines, etc. The term coupled includes the term connected within its definition.</p>
<p id="p-0027" num="0026">The local switching network <b>200</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>a </i>may employ one of many different communication protocols enabling data communication between one or more end devices <b>210</b> through <b>226</b> via line cards <b>204</b> through <b>208</b> and switching fabric <b>202</b>. <figref idref="DRAWINGS">FIG. 2</figref><i>a </i>will be described with reference to a communications protocol in which end devices communicate with each other by transferring data frames or packets via line cards and the switching fabric. It is noted end devices (e.g., end devices <b>210</b> and <b>212</b>) can locally communicate with each other without having to transmit data packets via fabric <b>202</b>. The present invention will be described with reference to end devices communicating with each other via fabric <b>202</b>.</p>
<p id="p-0028" num="0027">Each data packet in a data communication includes one or more lines of data. The lines of the data packet may be transmitted during consecutive data transmission cycles of the link between the line card and the switching fabric. Lines of the data packet may also be transmitted during non-consecutive transmission cycles of the link between the line card and the switching fabric.</p>
<p id="p-0029" num="0028">Line cards <b>204</b> through <b>208</b> are coupled to switching fabric <b>202</b> via one or more data links. In <figref idref="DRAWINGS">FIG. 2</figref><i>a</i>, line card <b>204</b> is coupled to switching fabric <b>202</b> via downlink and uplink <b>228</b> and <b>230</b>, respectively, line card <b>206</b> is coupled to switching fabric <b>202</b> via downlink and uplink <b>232</b> and <b>234</b>, respectively, and line card <b>208</b> is coupled to switching fabric <b>202</b> via downlink and uplink <b>236</b> and <b>238</b>, respectively. Data is transferred between line card <b>204</b> and end devices <b>210</b> through <b>214</b> via common bus <b>240</b>, between line card <b>206</b> and end devices <b>216</b> through <b>220</b> via common bus <b>242</b>, and between line card <b>208</b> and end devices <b>222</b> through <b>226</b> via common bus <b>244</b>.</p>
<p id="p-0030" num="0029"><figref idref="DRAWINGS">FIG. 2</figref><i>b </i>illustrates one embodiment of line card <b>204</b>. Line cards <b>206</b> and <b>208</b> may take similar form as that shown in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>. In <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>, line card <b>204</b> includes a data buffer <b>250</b>, a formatter <b>252</b>, a control circuit <b>254</b>, and a multiplexer <b>256</b>. Multiplexer <b>256</b> selectively couples an output of formatter <b>252</b> or common bus <b>240</b> to uplink <b>230</b> in response to a control signal generated by control circuit <b>254</b>. Formatter <b>252</b> generates control codes to be transmitted to switching fabric <b>202</b>. Although not shown, a separate formatter may be present in line card <b>204</b>. The separate formatter may be provided to modify the contents of the first line of one or more data packets of a stream of packets received from common bus <b>240</b> before the data packets are transmitted to the fabric via multiplexer <b>256</b>.</p>
<p id="p-0031" num="0030">Control circuit <b>254</b> couples the output of formatter <b>252</b> to uplink <b>230</b> in response to formatter <b>252</b> generating a control code. Otherwise, control circuit <b>254</b> couples common bus <b>240</b> to uplink <b>230</b> thereby allowing data to be transmitted to switching fabric <b>202</b> with or without first line modification.</p>
<p id="p-0032" num="0031">Common bus <b>240</b> may take form in a bi-directional bus. In this embodiment, a switch may be provided (not shown) for selectively coupling the data buffer <b>250</b> or the multiplexer <b>256</b> to the bi-directional bus. In the alternative, common bus <b>240</b> may take form in a pair of unidirectional buses respectively coupled to buffer <b>250</b> and multiplexer <b>256</b>.</p>
<p id="p-0033" num="0032">Data buffer <b>250</b> may take form in a FIFO buffer. Buffer <b>250</b> receives and stores data transmitted from switching fabric <b>202</b> via downlink <b>228</b>. Data is stored within data buffer <b>250</b> prior to output on to common bus <b>240</b> for subsequent delivery to one of the end devices <b>210</b> through <b>214</b>. Although not shown, a second buffer may be present in line card <b>204</b>. The second buffer may store data packets received from common bus <b>240</b> before they are transmitted to fabric <b>202</b> via multiplexer.</p>
<p id="p-0034" num="0033">Data buffer <b>250</b>, in one embodiment, may include circuitry for generating information relating to the quantity of data stored therein. This information may be generated in any one of a number of different methods. For example, circuitry in buffer <b>250</b> may keep a running total of the data lines input to buffer and a running total of the data lines output from buffer <b>250</b>. During each cycle of a system clock (not shown in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>) the circuitry may subtract the running total of data lines output from the running total of data lines input, the difference provided to formatter <b>252</b> as q(t), the quantity of data lines stored in buffer <b>250</b> at time t. Alternatively, buffer <b>250</b> may provide the running totals to formatter <b>252</b> for subsequent calculation of q(t).</p>
<p id="p-0035" num="0034">Formatter <b>252</b>, in one embodiment, receives information relating to the quantity of data stored within buffer <b>250</b>. For purposes of explanation, formatter <b>252</b> will be described as receiving q(t), the quantity of data lines in buffer <b>250</b> at time t. In one embodiment, formatter <b>252</b> receives q(t) with each cycle of the system clock provided to line card <b>204</b>. In this embodiment, q(t) increases or decreases by no more than one data line per clock cycle. In another embodiment, q(t) may increase or decrease by more than one data line per clock cycle.</p>
<p id="p-0036" num="0035">Formatter <b>252</b> is configured to generate a plurality of control codes for transmission to switching fabric <b>202</b> via multiplexer <b>256</b> and uplink <b>230</b>. As will be more fully described below, one of the control codes, a variable data transmit rate control code (hereinafter referred to as variable-rate control code), is used to variably control the rate at which data is transmitted from switching fabric <b>202</b> for storage within data buffer <b>250</b>. In contrast to the prior art described above, formatter <b>252</b>, through generation and transmission of the variable-rate control code, may vary the rate at which data is transmitted to buffer <b>250</b>. The rate may vary from a full data transmit rate to zero data transmit rate, and at rates therebetween. For example, formatter <b>252</b> may generate a variable-rate control code instructing switching fabric <b>202</b> to transmit data at 0%, 10%, 20%, . . . 100% of the full rate.</p>
<p id="p-0037" num="0036">Formatter <b>252</b> generates the variable-rate control code in response to receiving q(t). Accordingly, line card <b>204</b> may signal switching fabric <b>202</b> the status of its data buffer <b>250</b> by adjusting the rate at which data is transmitted to buffer <b>250</b> for storage therein. In one embodiment, the rates of the variable-rate control codes are fixed. In another embodiment, the rates of the variable-rate control codes may be changed. In this latter embodiment, the rates of the variable-rate control codes may be set by software operating in, for example, formatter <b>252</b>.</p>
<p id="p-0038" num="0037">Formatter <b>252</b> monitors the quantity of data stored within buffer <b>250</b> using q(t) provided therefrom. Although not shown in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>, circuitry for monitoring buffer <b>250</b> in formatter <b>252</b> may take form in hardware, software, or a combination of hardware and software. Formatter <b>252</b>, in one embodiment, compares q(t) against several programmable thresholds Q(<b>1</b>)-Q(n) during each cycle of the system clock provided to line card <b>204</b>. Thresholds Q(<b>1</b>)-Q(n) are stored in one or more memories of formatter <b>252</b> and represent increasing quantities of data lines ranging from Q(<b>1</b>) equal to zero to Q(n) equal to a percentage (e.g., 98%) of the total amount of data lines capable of being stored in buffer <b>250</b>. When q(t) increases to Q(x), one of the thresholds Q(<b>1</b>)-Q(n), then formatter <b>252</b> generates and sends a variable-rate control code to switching fabric <b>202</b> instructing it to slow the rate at which it transmits data for storage in buffer <b>250</b>. For example, if Q(t) increases to Q(<b>5</b>), then formatter <b>252</b> generates and sends a variable-rate control code to switching fabric <b>202</b> instructing it to slow the rate at which it transmits data. Conversely, when q(t) decreases to Q(x), formatter <b>252</b> generates and sends a variable-rate control code to switching fabric <b>202</b> instructing it to increase the rate at which it transmits data for storage in buffer <b>250</b>. For example, if q(t) decreases to Q(<b>2</b>), then formatter <b>252</b> generates and sends a variable-rate control code to switching fabric <b>202</b> instructing it to increase the rate at which it transmits data to buffer <b>250</b>.</p>
<p id="p-0039" num="0038">The foregoing presumes the embodiment where q(t) will increase or decrease by no more than one line of data per clock cycle. In the alternative embodiment where q(t) increases or decreases by more than one line of data per system clock cycle, formatter <b>252</b> may compare q(t) with ranges R(<b>1</b>)-R(n−1) of data line quantities in order to determine whether to adjust the rate at which data is transmitted to buffer <b>250</b>. In this embodiment, the ranges R(<b>1</b>)-R(n−1) of data line quantities are defined by Q(<b>1</b>)-Q(n). More particularly, R(x) equates to the range of data lines between R(x) and R(x+1), with R(x+1) but not R(x) included therein.</p>
<p id="p-0040" num="0039">When formatter <b>252</b> receives q(t), formatter compares q(t) with R(<b>1</b>)-R(n−1) to identify the range R(x) in which q(t) is contained. Formatter <b>252</b> compares the range in which q(t) is contained with the range in which q(t−1), the quantity of data lines in buffer <b>250</b> at the previous clock cycle, is contained. If ranges for q(t) and q(t−1) are different, then formatter <b>252</b> generates and sends a variable-rate control code to fabric <b>202</b> instructing it to increase or decrease the rate at which it sends data to buffer <b>250</b>. For example, if the range in which q(t) is contained is greater than the range in which q(t−1) is contained, then formatter <b>252</b> generates and sends a variable-rate control code to fabric <b>202</b> instructing it to decrease the rate at which it sends data to buffer <b>250</b>. If the range in which q(t) is contained is less than the range in which q(t−1) is contained, then formatter <b>252</b> generates and sends a variable-rate control code to fabric <b>202</b> instructing it to increase the rate at which it sends data to buffer <b>250</b>. If the range in which q(t) is contained is the same as than the range in which q(t−1) is contained, then no variable-rate control code is generated and sent.</p>
<p id="p-0041" num="0040">Before any variable-rate control code is sent to switching fabric <b>202</b>, control <b>254</b> instructs multiplexer <b>256</b> to couple formatter <b>252</b> to uplink <b>230</b>. Once the variable-rate control code is transmitted to fabric <b>202</b>, control <b>254</b> instructs multiplexer to recouple uplink <b>230</b> to common bus <b>240</b>.</p>
<p id="p-0042" num="0041">In the method described above, the rate at which data is transmitted between switching fabric <b>202</b> and line card <b>204</b>, may be decreased one or more times to arrive at the maximum sustainable level to accommodate, for example, a burst of locally switched traffic on bus <b>240</b> that causes data buffer <b>250</b> to fill quickly. It is noted that in this context, maximum sustainable level does not necessarily equate to 100% of the full transmit rate. In the example, when the local burst subsides, data can flow out of buffer <b>250</b> at a rate greater than the rate at which buffer <b>250</b> receives data, thereby lowering the quantity of data stored within data buffer <b>250</b>. In response to receiving a lowered q(t), formatter <b>252</b> may generate one or more variable-rate control codes instructing switching fabric <b>202</b> to increase its data transmit rate one or more times. In this fashion, the data transmit rate is adjusted up to the maximum sustainable level.</p>
<p id="p-0043" num="0042">In contrast to the prior art, should line card <b>204</b> be unable to accept data at high rates, the data transmit rate will quickly lower to a sustainable rate instead of continuously cycling the fabric with start/stop control codes. In this configuration no guess or permanent setting need be made as to the initial rate at which data is transferred to line card <b>204</b>. Rather, as buffer <b>250</b> begins to backup with data, formatter <b>252</b> will send one or more variable-rate control codes to the switching fabric <b>202</b> instructing it to lower its data transmit rate one or more times. As the buffer <b>250</b> empties, formatter <b>252</b> will send one or more variable-rate control codes to switching fabric <b>202</b> instructing it to increase its data transmit rate one or more times.</p>
<p id="p-0044" num="0043">Frequent generation and transmission of variable-rate control codes can reduce data throughput between fabric <b>202</b> and line card <b>204</b>. To illustrate this problem, suppose Q(<b>1</b>)-Q(n) are fixed. Further suppose that q(t) increases to Q(<b>5</b>) in the embodiment where q(t) increases or decreases by no more than one line of data per clock cycle. In response, formatter <b>252</b> generates and sends a variable-rate control code instructing fabric <b>202</b> to decrease the rate at which it transmits data to buffer <b>250</b>. Suppose at time t+1 a line arrives in buffer <b>250</b> which raises q(t+1) to Q(<b>5</b>)+1, and then one clock later at time t+2 a line is taken from buffer <b>250</b> which reduces q(t+2) back to Q(<b>5</b>). Because the quantity of data in buffer <b>250</b> decreases back to Q(<b>5</b>), formatter <b>252</b> will again generate and send a variable-rate control code instructing fabric to increase the rate at which it sends data to the buffer <b>250</b>. Accordingly, formatter <b>252</b> sends two variable-rate control codes to fabric <b>202</b> within two clock cycles. One variable-rate control code was sent at time t when the quantity in buffer <b>250</b> hit the limit Q(<b>5</b>) from below, and another was sent at time t+2 when the quantity hit the limit Q(<b>5</b>) from above. During these two clock cycles, data cannot be transmitted from line card <b>204</b> to fabric <b>202</b>. This problem also occurs in the embodiment where q(t) can increase or decrease by more than one line of data.</p>
<p id="p-0045" num="0044">The formatter <b>252</b> of <figref idref="DRAWINGS">FIG. 2</figref><i>b </i>may include circuitry and/or an algorithm which prevents frequent generation and transmission of variable-rate control codes to fabric <b>202</b> when the contents q(t) of buffer <b>250</b> oscillates around one of the predefined quantities Q(<b>1</b>)-Q(n). More particularly, formatter <b>252</b> may be configured to dynamically modify one of the programmed quantities Q(<b>1</b>)-Q(n) each time a variable-rate control code is generated and sent to fabric <b>202</b>. Suppose that q(t) increases to Q(<b>5</b>) in the embodiment where q(t) increases or decreases by no more than one line of data per clock cycle. In addition to generating a variable-rate control code, formatter <b>252</b> decreases the value of the Q(x) that was just crossed by, for example, 3%. The actual amount of the change can be a programmable value. Suppose q(t) decreases to the value of Q(x). In addition to generating a variable-rate control code, formatter <b>252</b> would increase the value of the Q(x) that was just crossed by, for example, 3%. By changing the values of Q(<b>1</b>)-Q(n) in this fashion, formatter <b>252</b> eliminates the problem of frequently sending variable-rate control codes when q(t) oscillates around a set quantity of data lines. This solution to the problem described above works equally well in the embodiment where q(t) can increase or decrease by more than one data line per clock cycle. Suppose q(t) increases to be within range R(x+1). In addition to generating a variable-rate control code, formatter <b>252</b> decreases the value of Q(x+1) by, for example, 3%. Or, suppose q(t) decreases to be within range R(x+1). In addition to generating a variable-rate control code, formatter <b>252</b> would increase the value of Q(x) by, for example, 3%.</p>
<p id="p-0046" num="0045">The present invention is described above as being embodied in line a card. The present invention should not be limited thereto. The present invention may be embodied in any device that has a buffer for temporarily storing data received from a transmitting device. For example, the present invention may be embodied in switching fabric <b>202</b>. Although not shown in the figures, switching fabric <b>202</b> may include first, second, and third input FIFO buffers for receiving and storing data from line cards <b>204</b>, <b>206</b>, and <b>208</b>, respectively. The first, second, and third input FIFO buffers may be capable of generating q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>) representing the quantity data lines in the first, second, and third buffers, respectively, at time t. Switching fabric <b>202</b> may include first, second and third formatters configured receive q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>), respectively, and configured to generate and send control codes, including variable-rate control codes, to line cards <b>204</b>, <b>206</b>, and <b>208</b>, respectively in a fashion similar to the formatter <b>252</b> described in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>. Since switching fabric <b>202</b> is coupled to line cards <b>204</b>, <b>206</b>, and <b>208</b> via downlinks <b>228</b>, <b>232</b>, and <b>236</b>, respectively, two or more of the first, second, and third variable-rate control codes may be transmitted simultaneously.</p>
<p id="p-0047" num="0046">The first, second, and third formatters employed in switching fabric <b>202</b> may store separate quantity values Q<b>1</b>(<b>1</b>)-Q<b>1</b>(<i>n</i>), Q<b>2</b>(<b>1</b>)-Q<b>2</b>(<i>n</i>), and Q<b>3</b>(<b>1</b>)-Q<b>3</b>(<i>n</i>) in their respective memories. For purposes of explanation, switching fabric <b>202</b> will be described as having one formatter that receives q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>). In response to receiving q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>), the fabric formatter is capable of generating and sending first, second, and third variable-rate control codes to line cards <b>204</b>, <b>206</b>, and <b>208</b>, respectively, for variably controlling the rate at which line cards <b>204</b>, <b>206</b>, and <b>208</b> respectively transmit data to switching fabric <b>202</b> for storage in the first, second, and third buffers, respectively, of switching fabric <b>202</b>. This fabric formatter stores in one or more of its memories three sets of quantity values Q<b>1</b>(<b>1</b>)-Q<b>1</b>(<i>n</i>), Q<b>2</b>(<b>1</b>)-Q<b>2</b>(<i>n</i>), and Q<b>3</b>(<b>1</b>)-Q<b>3</b>(<i>n</i>) corresponding to line cards <b>204</b>, <b>206</b>, and <b>208</b>, respectively. Lastly, the fabric formatter is capable of adjusting Q<b>1</b>(<b>1</b>)-Q<b>1</b>(<i>n</i>), Q<b>2</b>(<b>1</b>)-Q<b>2</b>(<i>n</i>), and Q<b>3</b>(<b>1</b>)-Q<b>3</b>(<i>n</i>) upward or downward in the same fashion that formatter <b>252</b> adjusts Q(<b>1</b>)-Q(n) described above.</p>
<p id="p-0048" num="0047">The fabric formatter of switching fabric <b>202</b>, in a manner similar to formatter <b>252</b> described above, is capable of generating the first, second, and/or third variable-rate control codes after comparing q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>) against Q<b>1</b>(<b>1</b>)-Q<b>1</b>(<i>n</i>), Q<b>2</b>(<b>1</b>)-Q<b>2</b>(<i>n</i>), and Q<b>3</b>(<b>1</b>)-Q<b>3</b>(<i>n</i>), respectively. When q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) increases to Q<b>1</b>(<i>x</i>), Q<b>2</b>(<i>x</i>), or Q<b>3</b>(<i>x</i>), respectively, then the fabric formatter generates and sends first, second, or third variable-rate control code to line cards <b>204</b>, <b>206</b>, or <b>208</b> respectively, instructing them to decrease the rate at which it transmits data for storage in the first, second, or third buffer, respectively, of switching fabric <b>202</b>. Additionally, if q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) increases to Q<b>1</b>(<i>x</i>), Q<b>2</b>(<i>x</i>), or Q<b>3</b>(<i>x</i>), respectively, the fabric formatter reduces the value of Q<b>1</b>(<i>x</i>), Q<b>2</b>(<i>x</i>), or Q<b>3</b>(<i>x</i>) by, for example, 3% to avoid frequent generation and transmission of first, second, or third variable-rate control codes if the value of q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) hovers around a set number. Conversely, when q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) decreases to Q<b>1</b>(<i>x</i>), Q<b>2</b>(<i>x</i>), or Q<b>3</b>(<i>x</i>), respectively, then the fabric formatter generates and sends first, second, or third variable-rate control code to line cards <b>204</b>, <b>206</b>, or <b>208</b> respectively, instructing them to increase the rate at which it transmits data for storage in the first, second, or third buffer, respectively, of switching fabric <b>202</b>. Likewise, if q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) decreases to Q<b>1</b>(<i>x</i>), Q<b>2</b>(<i>x</i>), or Q<b>3</b>(<i>x</i>), respectively, the fabric formatter increases the value of Q<b>1</b>(<i>x</i>), Q<b>2</b>(<i>x</i>), or Q<b>3</b>(<i>x</i>) by, for example, 3% to avoid frequent generation and transmission of first, second, or third variable-rate control codes if the value of q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) hovers around a set number.</p>
<p id="p-0049" num="0048">The foregoing presumes the embodiment where q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) increases or decreases by no more than one line of data per clock cycle. In the alternative embodiment where q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) increases or decreases by more than one line of data per system clock cycle, the fabric formatter of fabric <b>202</b> may compare q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) with ranges R<b>1</b>(<b>1</b>)-R<b>1</b>(<i>n−</i>1), R<b>2</b>(<b>1</b>)-R<b>2</b>(<i>n−</i>1), or R<b>3</b>(<b>1</b>)-R<b>3</b>(<i>n−</i>1), respectively, of data line quantities in order to determine when first, second, or third variable-rate control codes are to be generated and sent to line cards <b>204</b>, <b>206</b>, or <b>208</b>, respectively. In this embodiment, the ranges R<b>1</b>(<b>1</b>)-R<b>1</b>(<i>n</i>−1), R<b>2</b>(<b>1</b>)-R<b>2</b>(<i>n−</i>1), and R<b>3</b>(<b>1</b>)-R<b>3</b>(<i>n−</i>1), respectively, of data line quantities are defined by Q<b>1</b>(<b>1</b>)-Q<b>1</b>(<i>n</i>), Q<b>2</b>(<b>1</b>)-Q<b>2</b>(<i>n</i>), and Q<b>2</b>(<b>1</b>)-Q<b>2</b>(<i>n</i>), respectively. More particularly: R<b>1</b>(<i>x</i>) equates to the range of data lines between R<b>1</b>(<i>x</i>) and R<b>1</b>(<i>x+</i>1), with R<b>1</b>(<i>x+</i>1) but not R<b>1</b>(<i>x</i>) included therein; R<b>2</b>(<i>x</i>) equates to the range of data lines between R<b>2</b>(<i>x</i>) and R<b>2</b>(<i>x+</i>1), with R<b>2</b>(<i>x+</i>1) but not R<b>2</b>(<i>x</i>) included therein, and; R<b>3</b>(<i>x</i>) equates to the range of data lines between R<b>3</b>(<i>x</i>) and R<b>3</b>(<i>x+</i>1), with R<b>3</b>(<i>x+</i>1) but not R<b>3</b>(<i>x</i>) included therein.</p>
<p id="p-0050" num="0049">When the fabric formatter receives q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>), the fabric formatter compares q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>) with R<b>1</b>(<b>1</b>)-R<b>1</b>(<i>n−</i>1), R<b>2</b>(<b>1</b>)-R<b>2</b>(<i>n−</i>1), and R<b>3</b>(<b>1</b>)-R<b>3</b>(<i>n−</i>1), respectively, to identify the range R<b>1</b>(<i>x</i>), R<b>2</b>(<i>x</i>), and R<b>2</b>(<i>x</i>) in which q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>) are respectively contained. The fabric formatter compares the ranges in which q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), and q<b>3</b>(<i>t</i>) are contained with the respective ranges in which q<b>1</b>(<i>t−</i>1), q<b>2</b>(<i>t−</i>1), and q<b>3</b>(<i>t−</i>1) are contained. If the ranges for q<b>1</b>(<i>t</i>), q<b>2</b>(<i>t</i>), or q<b>3</b>(<i>t</i>) are different from the ranges for q<b>1</b>(<i>t−</i>1), q<b>2</b>(<i>t−</i>1), and q<b>3</b>(<i>t−</i>1), respectively, then the fabric formatter generates and sends first, second, or third variable-rate control codes to cards <b>204</b>, <b>206</b>, or <b>208</b>, respectively, instructing them to increase or decrease the rate at which it sends data to fabric <b>202</b>. For example, if the range in which q<b>1</b>(<i>t</i>) is contained is greater than the range in which q<b>1</b>(<i>t−</i>1) is contained, then the fabric formatter generates and sends a first variable-rate control code to card <b>204</b> instructing it to decrease the rate at which it sends data to fabric <b>202</b>. If the range in which q<b>1</b>(<i>t</i>) is contained is less than the range in which q<b>1</b>(<i>t−</i>1) is contained, then the fabric formatter generates and sends a first variable-rate control code to card <b>204</b> instructing it to increase the rate at which it sends data to fabric <b>202</b>. If the range in which q<b>1</b>(<i>t</i>) is contained is the same as than the range in which q<b>1</b>(<i>t−</i>1) is contained, then no first variable-rate control code is generated and sent.</p>
<p id="p-0051" num="0050">Fabric <b>202</b> as shown in <figref idref="DRAWINGS">FIG. 2</figref><i>a </i>may support two or more types of data transmission to the line cards. For example, switching fabric <b>202</b> may support high and low priority data traffic in a non-blocking manner where high priority traffic can pass low priority traffic. High priority traffic passing low priority traffic should not be limited to discrete packets. For example, suppose end device <b>222</b> (<figref idref="DRAWINGS">FIG. 2</figref><i>a</i>) is sending low priority traffic to end device <b>210</b> via fabric <b>202</b> when end device <b>216</b> begins sending high priority traffic to end device <b>210</b> via fabric <b>202</b>. Initially, fabric <b>202</b> chooses to send packets from line card <b>208</b> since no high priority traffic is being sent to end device <b>210</b>. But, when the high priority traffic appears from end device <b>216</b>, fabric <b>202</b> can interrupt a low priority packet sent from line card <b>222</b> and send the entire high priority packet from end device <b>216</b>, then resume transmission of the low priority packet.</p>
<p id="p-0052" num="0051"><figref idref="DRAWINGS">FIG. 2</figref><i>c </i>shows a line card <b>204</b> that may find use in the system <b>200</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>a</i>. In contrast to the line card <b>204</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>, line card <b>204</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>c </i>includes two data buffers <b>260</b> and <b>262</b> which may be used to store distinct types of data transmitted from switching fabric <b>202</b>. More particularly, data buffer <b>260</b> may be used to store data transmitted from switching fabric <b>202</b> having the high priority, while data buffer <b>262</b> may store data transmitted from switching fabric <b>202</b> having the low priority. It is noted that the line card shown in <figref idref="DRAWINGS">FIG. 2</figref><i>c </i>may include further receiving buffers for storing data having priority which lies between the high and low priorities mentioned above.</p>
<p id="p-0053" num="0052">Line card <b>204</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>c </i>includes a formatter <b>268</b> coupled to a control circuit <b>270</b> and multiplexer <b>272</b>. Formatter <b>268</b> is configured to generate control codes, including high and low priority variable-rate control codes, for controlling operational aspects of the switching fabric <b>202</b>. The high and low priority variable-rate control codes are used to control the rate at which high and low priority data is transmitted to the first data buffer <b>260</b> and second data buffer <b>262</b>, respectively. Multiplexer <b>272</b>, in response to control circuit <b>270</b>, couples the output of formatter <b>268</b> to uplink <b>230</b> when formatter <b>268</b> generates one of its control codes. Otherwise, multiplexer <b>272</b> couples local bus <b>240</b> to uplink <b>230</b> so that data may be transmitted to switching fabric <b>202</b>. Although not shown in <figref idref="DRAWINGS">FIG. 2</figref><i>c</i>, line card <b>204</b> includes a switch for selectively coupling the inputs of buffers <b>260</b> and <b>262</b> to downlink <b>228</b> depending on whether data received by the switch is designated high priority or low priority.</p>
<p id="p-0054" num="0053">In <figref idref="DRAWINGS">FIG. 2</figref><i>c</i>, formatter <b>268</b> is configured to receive information relating to the quantity of data stored within the buffers <b>260</b> and <b>262</b>. For purposes of explanation formatter <b>268</b> will be described as receiving qh(t) and q<b>1</b>(<i>t</i>) from buffers <b>260</b> and <b>262</b>, respectively, where qh(t) and q<b>1</b>(<i>t</i>) represent the quantity of data lines stored in buffers <b>260</b> and <b>262</b>, respectively, at time t, it being understood that formatter may be configured to generate qh(t) and q<b>1</b>(<i>t</i>) based on information provided by buffers <b>260</b> and <b>262</b>. In response to receiving qh(t) and q<b>1</b>(<i>t</i>), formatter <b>268</b> compares qh(t) and q<b>1</b>(<i>t</i>) to programmable quantities QH(<b>1</b>)-QH(n) and QL(<b>1</b>)-QL(n), respectively. If qh(t) or q<b>1</b>(<i>t</i>) increases to QH(x) or QL(x), respectively, of QH(<b>1</b>)-QH(n) and QL(<b>1</b>)-QL(n), respectively, then formatter <b>268</b> generates and sends a high or low priority variable-rate control code to switching fabric <b>202</b>, instructing it to decrease the rate at which it transmits high or low priority data for storage in buffer <b>260</b> or <b>262</b>, respectively. Additionally, if qh(t) or q<b>1</b>(<i>t</i>) increases to QH(x) or QL(x), respectively, the formatter <b>268</b> reduces the value of the QH(x) or QL(x) for the threshold that was just crossed by, for example, 3% to avoid frequent generation and transmission of high or low variable-rate control codes if the value of qh(t) or q<b>1</b>(<i>t</i>) hovers around a set number. Conversely, when qh(t) or q<b>1</b>(<i>t</i>) decreases to QH(x) or QL(x), respectively, of QH(<b>1</b>)-QH(n) and QL(<b>1</b>)-QL(n), respectively, then formatter <b>268</b> generates and sends a high or low priority variable-rate control code to switching fabric <b>202</b>, instructing it to increase the rate at which it transmits high or low priority data for storage in buffer <b>260</b> or <b>262</b>, respectively. If qh(t) or q<b>1</b>(<i>t</i>) decreases to QH(x) or QL(x), respectively, the formatter <b>268</b> increases the value of QH(x) or QL(x) by, for example, 3% to avoid frequent generation and transmission of high or low variable-rate control codes if the value of qh(t) or q<b>1</b>(<i>t</i>) hovers around a set number.</p>
<p id="p-0055" num="0054">Obviously, it is possible that qh(t) and q<b>1</b>(<i>t</i>) may both increase beyond or decrease to QH(x) or QL(x), respectively, around the same time. Line card <b>204</b> is coupled to switching fabric <b>202</b> by a single uplink <b>230</b>. As a result, only one of the high and low priority variable-rate control codes may be transmitted to switching fabric <b>202</b> during a transmission cycle on uplink <b>230</b>. In this situation, the formatter <b>268</b> may send the high and low priority variable-rate control codes in consecutive transmit cycles on uplink <b>230</b>. Alternatively, where qh(t) and q<b>1</b>(<i>t</i>) both increase beyond or decrease below programmable thresholds QH(x) or QL(x), respectively, formatter <b>268</b> may generate and send a single control code that contains first and second variable-rate control codes, where the first control variable-rate code instructs fabric <b>202</b> to increase or decrease the rate at rate at which it transmits high priority data for storage in buffer <b>260</b>, and where the second control variable-rate code instructs fabric <b>202</b> to increase or decrease the rate at rate at which it transmits low priority data for storage in buffer <b>262</b>. This control word may be sent to the fabric in a single cycle thereby eliminating the need to send separate control codes in succeeding cycles.</p>
<p id="p-0056" num="0055"><figref idref="DRAWINGS">FIG. 3</figref><i>a </i>illustrates relevant components of one embodiment of formatter <b>252</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>. It is noted that formatter <b>252</b> of <figref idref="DRAWINGS">FIG. 3</figref><i>a </i>may include additional circuitry for performing other functions. Formatter <b>252</b> is shown to include a clocked register <b>280</b>, compare circuit <b>282</b>, memory <b>284</b>, compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>), memory devices <b>300</b>(<b>1</b>)-<b>300</b>(<i>n</i>), and control code generator <b>312</b>.</p>
<p id="p-0057" num="0056">Operational aspects of formatter <b>252</b> of <figref idref="DRAWINGS">FIG. 3</figref><i>a </i>will be described with reference to the flow chart shown in <figref idref="DRAWINGS">FIG. 4</figref><i>a</i>. Q(t), the quantity of data stored in buffer <b>250</b> at time t, is provided to clocked register <b>280</b>, compare circuit <b>282</b>, and compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>). Q(t) provided to formatter <b>252</b> of <figref idref="DRAWINGS">FIG. 3</figref><i>a </i>increases or decreases by no more than one data line per clock cycle. The quantity of data stored in buffer <b>250</b> in the previous clock cycle t−1, is provided by clocked register <b>280</b> to compare circuit <b>282</b>. At step <b>318</b>, compare circuit <b>282</b> compares q(t) to q(t−1). If q(t) is equal to q(t−1), then the process ends with step <b>320</b> where q(t) is clocked into clocked register <b>280</b>. However, if q(t) does not equal q(t−1), then, compare circuit <b>282</b> generates a signal, which is provided to compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>), indicating that q(t) is either greater than or less than q(t−1).</p>
<p id="p-0058" num="0057">The process proceeds to step <b>322</b>, where compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>) compare q(t) to thresholds Q(<b>1</b>)-Q(n), respectively, stored in memories <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>), respectively. If q(t) does not equal any of the thresholds Q(<b>1</b>)-Q(n), then the process ends with step <b>320</b>. However, if q(t) equals one of the thresholds Q(<b>1</b>)-Q(n), then one of the compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>) generates either a rate change signal indicating that the data transmit rate between line card <b>204</b> and switching fabric <b>202</b> should be increased or decreased depending on whether the signal provided by compare circuit <b>282</b> indicates q(t) is greater than q(t−1) or less than q(t−1), respectively. More particularly, when one of the compare circuits <b>290</b>(<i>x</i>) detects equality between q(t) and its corresponding Q(x), compare circuit <b>290</b>(<i>x</i>) generates the rate change signal indicating that the data transmit rate between line card <b>204</b> and switching fabric <b>202</b> should be increased if q(t) is greater than q(t−1) as shown in step <b>324</b> or decreased if q(t) is less than q(t−1) as shown in step <b>326</b>, respectively.</p>
<p id="p-0059" num="0058">The contents Q(<b>1</b>)-Q(n) of memories <b>300</b>(<b>1</b>)-<b>300</b>(<i>n</i>), respectively, are provided to the control code generator <b>312</b>. When compare circuit <b>290</b>(<i>x</i>) indicates a match between q(t) and Q(x) and when compare circuit <b>282</b> indicates that q(t) is greater than or less than q(t−1) stored in clocked register <b>280</b>, then control code generator <b>312</b> replaces the value of Q(x) with either Q(x) less the contents of memory <b>284</b> or Q(x) plus the contents of memory <b>284</b> depending on whether q(t) is greater than q(t−1) or q(t) is less than q(t−1), respectively, as shown in steps <b>332</b> or <b>334</b>, respectively. For example, if compare circuit <b>282</b> indicates that q(t) is less than q(t−1), and compare circuit <b>290</b>(<b>2</b>) indicates that q(t) is equal to Q(<b>2</b>) stored in memory <b>300</b>(<b>2</b>), then control code generator <b>312</b> generates a new Q(<b>2</b>) which equals the previous Q(<b>2</b>) plus the contents of memory <b>284</b>, and control code generator <b>312</b> stores the new Q(<b>2</b>) in memory <b>300</b>(<b>2</b>). None of the other contents of memory <b>300</b>(<b>1</b>) and <b>300</b>(<b>3</b>)-<b>300</b>(<i>n</i>) are changed. It is noted that the new Q(<b>2</b>) is compared with q(t+1) in the next clock cycle t+1.</p>
<p id="p-0060" num="0059">Control code generator <b>312</b> receives the rate change signal from one of the compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>). Although not shown within the figures, control code generator <b>312</b> may include a programmable memory storing data transmit rate values TR(<b>1</b>)-TR(n) corresponding to the threshold values Q(<b>1</b>)-Q(n), respectively. Data transmit rate values TR(<b>1</b>)-TR(n) define differing rates for transmitting data between switching fabric <b>202</b> and line card <b>204</b>. Data transmit rate values TR(<b>1</b>)-TR(n) vary between TR(<b>1</b>) which may equal the fullest possible rate at which data can be transmitted between switching fabric <b>202</b> and line card <b>204</b>, to TR(n) which may equal zero transmission rate. Moreover, control code generator <b>312</b> is configured to “remember” the current transmit rate, i.e., the rate at which data is being transmitted between switching fabric <b>202</b> and line card <b>204</b> at time t. In one embodiment, control code generator <b>312</b> remembers the current transmit rate using a pointer pointing to one of the data transmit rate values TR(<b>1</b>)-TR(n). In this embodiment, the data transmit rate value currently being pointed to by the pointer at time t is defined as the current data transmit rate.</p>
<p id="p-0061" num="0060"><figref idref="DRAWINGS">FIG. 5</figref> illustrates, in block diagram form, an exemplary programmable memory <b>350</b> storing data transmit rate values TR(<b>1</b>)-TR(n) with a pointer <b>352</b> pointing to current data transmit rate TR(<b>4</b>). With continuing reference to <figref idref="DRAWINGS">FIGS. 3</figref><i>a </i>and <b>4</b><i>a</i>, when control code generator <b>312</b> receives a rate change signal from one of the compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>), control code generator, in one embodiment, moves the position of pointer <b>352</b> up one or down one position depending on whether signal from one of the compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>) indicates that the data transmit rate should be increased or decreased, respectively. For example, if the rate change signal from one of the compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>) indicates that the data transmit rate should be increased, then control code generator <b>312</b> moves the pointer <b>352</b> down to TR(<b>3</b>) in <figref idref="DRAWINGS">FIG. 5</figref>. If, on the other hand, the rate change signal from one of the compare circuits <b>290</b>(<b>1</b>)-<b>290</b>(<i>n</i>) indicates that the data transmit rate should be decreased, then control code generator <b>312</b> moves the pointer <b>352</b> up to TR(<b>5</b>) in <figref idref="DRAWINGS">FIG. 5</figref>. Further, in response to receiving the rate change signal, control code generator <b>312</b> generates and sends a variable-rate control code to switching fabric <b>202</b> as shown in step <b>328</b> or <b>330</b> of <figref idref="DRAWINGS">FIG. 4</figref><i>a</i>. This variable-rate control code includes the data transmit rate value (e.g., TR(<b>3</b>) or TR(<b>5</b>)) newly pointed to by pointer <b>352</b>. Switching fabric <b>202</b> receives the variable-rate control code and adjusts the data transmission rate between it and the line card <b>204</b> in accordance with the data transmit rate value contained in the received variable-rate control code.</p>
<p id="p-0062" num="0061"><figref idref="DRAWINGS">FIG. 3</figref><i>b </i>shows another embodiment of the formatter <b>252</b> shown in <figref idref="DRAWINGS">FIG. 2</figref><i>b</i>. It is noted that formatter <b>252</b> of <figref idref="DRAWINGS">FIG. 3</figref><i>b </i>may include additional circuitry for performing other functions. Formatter <b>252</b> shown in <figref idref="DRAWINGS">FIG. 3</figref><i>b </i>includes memory devices <b>300</b>(<b>1</b>)-<b>300</b>(<i>n</i>), memory <b>284</b>, range compare circuits <b>360</b>(<b>1</b>)-<b>360</b>(<i>n−</i>1), a clocked register <b>362</b>, compare circuit <b>364</b>, and control code generator <b>366</b>. Each of the compare circuits <b>360</b>(<b>1</b>)-<b>360</b>(<i>n−</i>1) receive data line quantity values from two of the memories <b>300</b>(<b>1</b>)-<b>300</b>(<i>n</i>) coupled thereto. Compare circuits <b>360</b>(<b>1</b>)-<b>360</b>(<i>n−</i>1) store programmable data transmit rates TR(<b>1</b>)-TR(n−1), respectively. Control code generator <b>366</b> is coupled to memories <b>300</b>(<b>1</b>)-<b>300</b>(<i>n</i>) and <b>284</b>. Control code generator <b>366</b> is configured to selectively increase or decrease the contents of each of memories <b>300</b>(<b>1</b>)-<b>300</b>(<i>n</i>) by the number of data lines stored in memory <b>284</b> as will be more fully described below.</p>
<p id="p-0063" num="0062">Operational aspects of formatter <b>252</b> shown in <figref idref="DRAWINGS">FIG. 3</figref><i>b </i>will be described with reference to the flow chart shown in <figref idref="DRAWINGS">FIG. 4</figref><i>b</i>. At step <b>370</b>, q(t) is provided to each of the range compare circuits <b>360</b>(<b>1</b>)-<b>360</b>(<i>n−</i>1). The compare circuit <b>360</b>(<i>x</i>) that detects q(t) is greater than Q(x) (provided by memory <b>300</b>(<i>x</i>)) and less than or equal to Q(x+1) (provided by memory <b>300</b>(<i>x+</i>1)) transmits TR(x) to rate compare circuit <b>364</b> and to control code generator <b>366</b>. Rate compare circuit compares the transmit rate TR(x) provided thereto with the transmit rate stored in clocked register <b>362</b>. If the transmit rate stored in register <b>362</b> equals TR(x), than no variable-rate control code need be sent to fabric <b>202</b>, and the process proceeds to step <b>376</b> where the system clock is advanced and TR(x) is stored in the clocked register <b>362</b>. If, however, TR(x) does not equal the contents of clocked register <b>362</b>, then a variable-rate control is generated by control code generator <b>366</b> and transmitted to fabric <b>202</b> a tstep <b>380</b>. It is noted that this variable-rate control code includes TR(x) or a translation thereof.</p>
<p id="p-0064" num="0063">Rate compare circuit determines whether TR(x) is greater or less than the transmit rate stored in clocked register <b>362</b>. If TR(x) is greater than the transmit rate stored at time t in clocked register <b>362</b>, than at step <b>384</b> control code generator decreases the value of Q(x+1) by the value in memory <b>284</b>. If TR(x) is less than the transmit rate stored at time t in clocked register <b>362</b>, than at step <b>384</b> control code generator increases the value of Q(x) by the value in memory <b>284</b>.</p>
<p id="p-0065" num="0064">The present invention may implemented as a computer readable medium storing instructions executable by a computer system to implement a method. In one embodiment, the method includes a first memory of the computer system receiving and storing data transmitted by a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate. The method also includes comparing g(t), a quantity of data in the first memory at time t, with first, second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value. The first memory receives and stores data transmitted by the transmitting device at the first data transmit rate during a second period of time if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the second period of time is subsequent to the first period of time. The first memory receives and stores data transmitted by the transmitting device at the third data transmit rate during the second period of time if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value. The first memory receives and stores data transmitted by the transmitting device at the second data transmit rate during the second period of time if q(t) is determined to be greater than the first and second data quantity values but less than the third and fourth data quantity values. The second data quantity value is replaced in memory with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value. The third data quantity value is replaced in memory with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</p>
<p id="p-0066" num="0065">Although the present invention have been described in connection with several embodiments, the invention is not intended to be limited to the specific forms set forth herein, but on the contrary, it is intended to cover such alternatives, modifications, and equivalents as can be reasonably included with in the spirit and scope of the invention as defined by the appended claims.</p>
<?DETDESC description="Detailed Description" end="tail"?>
</description>
<us-claim-statement>What is claimed is:</us-claim-statement>
<claims id="claims">
<claim id="CLM-00001" num="00001">
<claim-text>1. A method comprising:
<claim-text>a first memory receiving and storing data transmitted by a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate;</claim-text>
<claim-text>comparing q(t), a quantity of data in the first memory at time t, with first, second, third, and fourth data quantity values wherein first data quantity value is less than the second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value;</claim-text>
<claim-text>the first memory receiving and storing data transmitted by the transmitting device at the first data transmit rate during a second period of time if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the second period of time is subsequent to the first period of time;</claim-text>
<claim-text>the first memory receiving and storing data transmitted by the transmitting device at the third data transmit rate during the second period of time if q(t) is determined to be greater than the first, second, and third data quantity values but less than the fourth data quantity value;</claim-text>
<claim-text>the first memory receiving and storing data transmitted by the transmitting device at the second data transmit rate during the second period of time if q(t) is determined to be greater than the first and second data quantity values but less than the third and fourth data quantity values;</claim-text>
<claim-text>replacing the second data quantity value stored in memory with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>replacing the third data quantity value stored in memory with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00002" num="00002">
<claim-text>2. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the first memory comprises a FIFO buffer.</claim-text>
</claim>
<claim id="CLM-00003" num="00003">
<claim-text>3. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the new second data quantity value is greater than the second data quantity value.</claim-text>
</claim>
<claim id="CLM-00004" num="00004">
<claim-text>4. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the new second data quantity value is less than the second data quantity value.</claim-text>
</claim>
<claim id="CLM-00005" num="00005">
<claim-text>5. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the new third data quantity value is less than the third data quantity value.</claim-text>
</claim>
<claim id="CLM-00006" num="00006">
<claim-text>6. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> wherein the new third data quantity value is greater than the third data quantity value.</claim-text>
</claim>
<claim id="CLM-00007" num="00007">
<claim-text>7. The method of <claim-ref idref="CLM-00001">claim 1</claim-ref> further comprising:
<claim-text>generating a first rate control signal if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>sending the first rate control signal to the transmitting device transmitting, wherein the transmitting device stops transmitting data at the second data transmit rate and starts transmitting data at the first data transmit rate in response to receiving the first rate control signal;</claim-text>
<claim-text>generating a third rate control signal if q(t) is determined to be greater than the first, second, and third data quantity values but greater than the fourth data quantity value;</claim-text>
<claim-text>sending the third rate control signal to the transmitting device transmitting, wherein the transmitting device stops transmitting data at the second data transmit rate and starts transmitting data at the third data transmit rate in response to receiving the third rate control signal.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00008" num="00008">
<claim-text>8. A apparatus comprising:
<claim-text>a first memory for receiving and storing data transmitted from a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate;</claim-text>
<claim-text>a memory for storing first, second, third, and fourth data quantity values, wherein the first data quantity value is less than the second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity value is less than the fourth data quantity value;</claim-text>
<claim-text>a first circuit configured receive and compare q(t), a quantity of data in the first memory at time t, with the first, second, third, and fourth data quantity values stored in the memory;</claim-text>
<claim-text>wherein the first circuit is configured to generate and send to the data transmitting device a first rate control signal if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the transmitting device transmits data to the first memory at the first data transmit rate for storage therein during a second period of time in response to receiving the first rate control signal, wherein the second period of time is subsequent to the first period of time;</claim-text>
<claim-text>wherein the first circuit is configured to generate and send to the data transmitting device a third rate control signal if q(t) is determined to be greater than the first, second, and third data quantity values but less than the fourth data quantity value, wherein the transmitting device transmits data to the first memory at the third data transmit rate for storage therein during the second period of time in response to receiving the third rate control signal;</claim-text>
<claim-text>wherein the first circuit is coupled to the memory and configured to replace the second data quantity value therein with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>wherein the first circuit is configured to replace the third data quantity value in the memory with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00009" num="00009">
<claim-text>9. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the first memory comprises a FIFO buffer.</claim-text>
</claim>
<claim id="CLM-00010" num="00010">
<claim-text>10. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the new second data quantity value is greater than the second data quantity value.</claim-text>
</claim>
<claim id="CLM-00011" num="00011">
<claim-text>11. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the new second data quantity value is less than the second data quantity value.</claim-text>
</claim>
<claim id="CLM-00012" num="00012">
<claim-text>12. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the new third data quantity value is less than the third data quantity value.</claim-text>
</claim>
<claim id="CLM-00013" num="00013">
<claim-text>13. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> wherein the new third data quantity value is greater than the third data quantity value.</claim-text>
</claim>
<claim id="CLM-00014" num="00014">
<claim-text>14. The apparatus of <claim-ref idref="CLM-00008">claim 8</claim-ref> further comprising the transmitting device.</claim-text>
</claim>
<claim id="CLM-00015" num="00015">
<claim-text>15. The apparatus of <claim-ref idref="CLM-00014">claim 14</claim-ref> wherein the transmitting device is contained in a switching fabric, wherein the first memory is contained in a line card coupled to the switching fabric via a data link, and wherein the transmitting device transmits data via the data link to the first memory for storage therein.</claim-text>
</claim>
<claim id="CLM-00016" num="00016">
<claim-text>16. A computer readable medium storing instructions executable by a computer system to implement a method, the method comprising:
<claim-text>a first memory of the computer system receiving and storing data transmitted by a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate;</claim-text>
<claim-text>comparing q(t), a quantity of data in the first memory at time t, with first, second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value;</claim-text>
<claim-text>the first memory receiving and storing data transmitted by the transmitting device at the first data transmit rate during a second period of time if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the second period of time is subsequent to the first period of time;</claim-text>
<claim-text>the first memory receiving and storing data transmitted by the transmitting device at the third data transmit rate during the second period of time if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value;</claim-text>
<claim-text>the first memory receiving and storing data transmitted by the transmitting device at the second data transmit rate during the second period of time if q(t) is determined to be greater than the first and second data quantity values but less than the third and fourth data quantity values;</claim-text>
<claim-text>replacing the second data quantity value in memory with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>replacing the third data quantity value in memory with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00017" num="00017">
<claim-text>17. The computer readable medium of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the new second data quantity value is greater than the second data quantity value.</claim-text>
</claim>
<claim id="CLM-00018" num="00018">
<claim-text>18. The computer readable medium of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the new second data quantity value is less than the second data quantity value.</claim-text>
</claim>
<claim id="CLM-00019" num="00019">
<claim-text>19. The computer readable medium of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the new third data quantity value is less than the third data quantity value.</claim-text>
</claim>
<claim id="CLM-00020" num="00020">
<claim-text>20. The computer readable medium of <claim-ref idref="CLM-00016">claim 16</claim-ref> wherein the new third data quantity value is greater than the third data quantity value.</claim-text>
</claim>
<claim id="CLM-00021" num="00021">
<claim-text>21. A apparatus comprising:
<claim-text>a memory for receiving and storing data transmitted from a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate;</claim-text>
<claim-text>first, second, third, and fourth memories for storing first, second, third, and fourth data quantity values, respectively, wherein the first data quantity value is less than the second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value;</claim-text>
<claim-text>a circuit configured receive and compare q(t), a quantity of data in the memory at time t, with the first, second, third, and fourth data quantity values stored in the first, second, third, and fourth memories, respectively;</claim-text>
<claim-text>wherein the circuit is configured to generate and send to the data transmitting device a first rate control signal if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the transmitting device transmits data to the memory at the first data transmit rate for storage therein during a second period of time in response to receiving the first rate control signal, wherein the second period of time is subsequent to the first period of time;</claim-text>
<claim-text>wherein the circuit is configured to generate and send to the data transmitting device a third rate control signal if q(t) is determined to be greater than the first, second, and third data quantity values but less than the fourth data quantity value, wherein the transmitting device transmits data to the memory at the third data transmit rate for storage therein during the second period of time in response to receiving the third rate control signal;</claim-text>
<claim-text>wherein the circuit is coupled to the second memory and configured to replace the second data quantity value therein with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>wherein the circuit is coupled to the third memory and configured to replace the third data quantity value therein with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00022" num="00022">
<claim-text>22. A apparatus comprising:
<claim-text>a memory for receiving and storing data transmitted from a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate;</claim-text>
<claim-text>first, second, third, and fourth memories for storing first, second, third, and fourth data quantity values, respectively, wherein the first data quantity value is less than the second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value;</claim-text>
<claim-text>a means for receiving and comparing q(t), a quantity of data in the memory at time t, with the first, second, third, and fourth data quantity values stored in the first, second, third, and fourth memories, respectively;</claim-text>
<claim-text>wherein the means is configured to generate and send to the data transmitting device a first rate control signal if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the transmitting device transmits data to the memory at the first data transmit rate for storage therein during a second period of time in response to receiving the first rate control signal, wherein the second period of time is subsequent to the first period of time;</claim-text>
<claim-text>wherein the means is configured to generate and send to the data transmitting device a third rate control signal if q(t) is determined to be greater than the first, second, and third data quantity values but less than the fourth data quantity value, wherein the transmitting device transmits data to the memory at the third data transmit rate for storage therein during the second period of time in response to receiving the third rate control signal;</claim-text>
<claim-text>wherein the means is coupled to the second memory and configured to replace the second data quantity value therein with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>wherein the means is coupled to the third memory and configured to replace the third data quantity value therein with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</claim-text>
</claim-text>
</claim>
<claim id="CLM-00023" num="00023">
<claim-text>23. A apparatus comprising:
<claim-text>a memory for receiving and storing data transmitted from a data transmitting device at a second data transmit rate during a first period of time, wherein the second data transmit rate is greater than a third data transmit rate but less than a first data transmit rate;</claim-text>
<claim-text>first, second, third, and fourth memories for storing first, second, third, and fourth data quantity values, respectively, wherein the first data quantity value is less than the second, third, and fourth data quantity values, wherein the second data quantity value is less than the third and fourth data quantity values, and wherein the third data quantity is less than the fourth data quantity value;</claim-text>
<claim-text>a means for receiving and comparing q(t), a quantity of data in the memory at time t, with the first, second, third, and fourth data quantity values stored in the first, second, third, and fourth memories, respectively;</claim-text>
<claim-text>wherein the means is configured to generate and send to the data transmitting device a first rate control signal if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value, wherein the transmitting device transmits data to the memory at the first data transmit rate for storage therein during a second period of time in response to receiving the first rate control signal, wherein the second period of time is subsequent to the first period of time;</claim-text>
<claim-text>wherein the means is configured to generate and send to the data transmitting device a third rate control signal if q(t) is determined to be greater than the first, second, and third data quantity values but less than the fourth data quantity value, wherein the transmitting device transmits data to the memory at the third data transmit rate for storage therein during the second period of time in response to receiving the third rate control signal;</claim-text>
<claim-text>wherein the means is coupled to the second memory and configured to replace the second data quantity value therein with a new second data quantity value if q(t) is determined to be less than the second, third and fourth data quantity values but greater than the first data quantity value;</claim-text>
<claim-text>wherein the means is coupled to the third memory and configured to replace the third data quantity value therein with a new third data quantity value if q(t) is determined to be greater than the first second, and third data quantity values but less than the fourth data quantity value.</claim-text>
</claim-text>
</claim>
</claims>
</us-patent-grant>
