{
    "title": "System, and associated method, for facilitating broadband multi-carrier transmission",
    "abstract": "A method for facilitating broadband multi-carrier wireless transmission, whereby a plurality of transmit antennas are divided into two or more transmit antenna groups of transmit antennas so that the correlation between antennas in each group is minimized, and each group of antennas transmits on a predetermined frequency with a different time periodicity, and each transmit antenna in each group transmits training sequences which are reciprocally time-orthogonal. Each of a plurality of receive antennas receives signals from each transmit antenna group. The signals from each group are separated via a band-pass filter, and a maximum estimation range of a frequency offset estimation algorithm is determined by the group having the shortest time period, and the accuracy of the frequency offset estimation algorithm is determined by the group having the longest time period. The received signal is corrected with the frequency offset.",
    "inventors": [
        "Priotti"
    ],
    "document_number": "07298787",
    "publication_date": "20071120",
    "assignees": [
        "Nokia Corporation"
    ],
    "claims": [
        {
            "claim_number": "CLM-00001",
            "preamble": "1. A method for facilitating broadband multi-carrier wireless transmission, the method comprising:",
            "components": [
                {
                    "component": "dividing a plurality of transmit antennas into two or more transmit antenna groups so that the correlation between antennas in each group is minimized, and each group of antennas transmits on a predetermined frequency with a different time periodicity, and each transmit antenna in each group transmits training sequences which are reciprocally time-orthogonal;",
                    "subcomponents": []
                },
                {
                    "component": "receiving by each of a plurality of receive antennas signals from each transmit antenna group;",
                    "subcomponents": []
                },
                {
                    "component": "separating the signal from each transmit antenna group via a band-pass filter;",
                    "subcomponents": []
                },
                {
                    "component": "determining a maximum estimation range of a frequency offset estimation algorithm by the group having the shortest time period;",
                    "subcomponents": []
                },
                {
                    "component": "determining the accuracy of the frequency offset estimation algorithm by the group having the longest time period; and",
                    "subcomponents": []
                },
                {
                    "component": "correcting said received signal with a frequency offset estimation.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00002",
            "preamble": "2. The method of claim 1 wherein said band-pass filter is an FFT filter.",
            "components": []
        },
        {
            "claim_number": "CLM-00003",
            "preamble": "3. The method of claim 1 wherein the received signal is received in a MIMO system.",
            "components": []
        },
        {
            "claim_number": "CLM-00004",
            "preamble": "4. The method of claim 1 wherein the received signal is received in a SISO system.",
            "components": []
        },
        {
            "claim_number": "CLM-00005",
            "preamble": "5. The method of claim 1 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00006",
            "preamble": "6. The method of claim 1 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00007",
            "preamble": "7. The method of claim 1 wherein the autocorrelation of the received signal is given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00008",
            "preamble": "8. The method of claim 1 wherein the autocorrelation of the received signal is given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00009",
            "preamble": "9. A method for facilitating broadband multi-carrier wireless transmission, the method comprising:",
            "components": [
                {
                    "component": "dividing a plurality of transmit antennas into two or more transmit antenna groups so that the correlation between antennas in each group is minimized, and each group of antennas transmits on a predetermined frequency with a different time periodicity, and each transmit antenna in each group transmits training sequences which are reciprocally time-orthogonal;",
                    "subcomponents": []
                },
                {
                    "component": "receiving by each of a plurality of receive antennas signals from each transmit antenna group;",
                    "subcomponents": []
                },
                {
                    "component": "separating out the received signal from each transmit antenna group via a band-pass filter,",
                    "subcomponents": []
                },
                {
                    "component": "for each received signal separated out from each transmit antenna group, computing the autocorrelation and phase of each received signal, and, based on the autocorrelation and phase of each received signal, computing a frequency offset estimate of each received signal;",
                    "subcomponents": []
                },
                {
                    "component": "computing the average of said frequency offset estimates computed for each received signal; and",
                    "subcomponents": []
                },
                {
                    "component": "correcting said received signal with said average of said frequency offset estimates.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00010",
            "preamble": "10. The method of claim 9 wherein said band-pass filter is an FFT filter.",
            "components": []
        },
        {
            "claim_number": "CLM-00011",
            "preamble": "11. The method of claim 9 wherein the received signal is received in a MIMO system.",
            "components": []
        },
        {
            "claim_number": "CLM-00012",
            "preamble": "12. The method of claim 9 wherein the received signal is received in a SISO system.",
            "components": []
        },
        {
            "claim_number": "CLM-00013",
            "preamble": "13. The method of claim 9 wherein the step of computing frequency offset estimate of each received signal further comprises the step of estimating frequency offset of each received signal with reference to a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00014",
            "preamble": "14. The method of claim 9 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00015",
            "preamble": "15. The method of claim 9 wherein the autocorrelation of the received signal is given substantially by:",
            "components": []
        },
        {
            "claim_number": "CLM-00016",
            "preamble": "16. The method of claim 9 wherein the autocorrelation of the received signal is given substantially by:",
            "components": []
        },
        {
            "claim_number": "CLM-00017",
            "preamble": "17. A system for facilitating broadband multi-carrier wireless transmission, the system comprising:",
            "components": [
                {
                    "component": "a plurality of transmit antennas divided into two or more transmit antenna groups so that the correlation between antennas in each transmit antenna group is minimized, and each transmit antenna group transmits on a predetermined frequency with a different time periodicity, and each transmit antenna in each group transmits training sequences which are reciprocally time-orthogonal;",
                    "subcomponents": []
                },
                {
                    "component": "a plurality of receive antennas configured for receiving a signal from each antenna group and separating the signal from each group via a band-pass filter, wherein a maximum estimation range of a frequency offset estimation algorithm is determined by the group having the shortest time period, and the accuracy of the frequency offset estimation algorithm is determined by the group having the longest time period; and",
                    "subcomponents": []
                },
                {
                    "component": "a processor for executing said frequency offset estimation algorithm, and applying frequency offset to said received signal.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00018",
            "preamble": "18. The system of claim 17 wherein said band-pass filter is an FFT filter.",
            "components": []
        },
        {
            "claim_number": "CLM-00019",
            "preamble": "19. The system of claim 17 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to the maximum estimation range and the autocorrelation of the received signal in a MIMO system.",
            "components": []
        },
        {
            "claim_number": "CLM-00020",
            "preamble": "20. The system of claim 17 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to the maximum estimation range and the autocorrelation of the received signal in a MIMO system, and a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00021",
            "preamble": "21. The system of claim 17 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00022",
            "preamble": "22. The system of claim 17 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to the maximum estimation range and the autocorrelation of the received signal in a MIMO system, and a training sequence given by:",
            "components": []
        },
        {
            "claim_number": "CLM-00023",
            "preamble": "23. The system of claim 17 wherein the frequency offset estimation algorithm comprises a formula for estimating frequency offset with reference to the maximum estimation range and the autocorrelation of the received signal in a MIMO system, a training sequence given by:",
            "components": []
        }
    ],
    "description": [
        "The invention is related to the field of wireless transmission in general and, more specifically, to broadband multicarrier wireless transmission links. Still more specifically, the invention is related to a system and associated method for utilizing a frequency offset estimation algorithm and training sequence having improved accuracy for MIMO and SISO broadband multicarrier wireless transmission links.",
        "In multicarrier wireless transmission, a difference in the carrier frequency between a transmitter and a receiver causes overlapping of different subcarriers and, as such, interference, and performance degradation. In systems such as Orthogonal Frequency Division Multiplexing (OFDM), this may result in a loss of orthogonality between subcarriers. It is thus necessary to precisely estimate at the receiver the carrier frequency offset and correct it in the receiver itself (or via feedback at the transmitter). The correction can be made acting directly on the control signal of a voltage-controlled oscillator (VCO) or alternatively by signal processing. Frequency offset correction is usually followed by a phase tracking process, to compensate residual constellation rotation. Frequency offset estimation may be data-aided (e.g., based on a training sequence or on pilot tones) or non data-aided (e.g., based on the statistical properties of the data signal).",
        "Conventional frequency offset estimation algorithms that achieve the foregoing are often based on the phase of the auto-correlation of the received signal. Such algorithms require a time periodicity in the signal. In practice, the periodicity may be designed in the training sequence, or the periodicity may be naturally present between cyclic prefix (CP) and the data portion of an OFDM signal. The phase of the auto-correlation is linearly proportional to the offset, and the maximum offset estimation range is inversely proportional to the time period of the received signal. This limits the maximum estimation range for algorithms based on the CP to half the inter-carrier spacing.",
        "For a number of reasons, it is preferable to use a training sequence rather than CP. For example, the precision of frequency offset estimation depends on the number of samples used to compute the auto-correlation. With a single CP the number of samples does not guarantee a good estimation performance for a low signal-to-noise ratio (SNR), especially if the number of subcarriers is less than 100. So if the CP is used, it is necessary to take an average over several CPs. In packet-based systems, however, there is typically little time available for synchronization processing; thus, an a-priori known training sequence proves to be more efficient and better performing. Another reason why it is preferable to use a training sequence rather than CP, particularly germane in systems with a carrier frequency of several GHz and relatively narrow inter-carrier spacing, the use of commercial oscillators with a long-term accuracy of around 20 parts per million (PPM) results in a maximum offset that is well above the half inter-carrier spacing. It is thus necessary to make available a signal with a time period shorter than the distance from the CP to the tail of a data block.",
        "In a packet-based, broadband multi-carrier system, where a training sequence is adopted, several frequency offset estimation algorithms have been developed, but, in systems wherein the training sequence should be as short as possible, no such systems allow a wide offset estimation range to be combined with high estimation accuracy. Moreover, no such systems guarantee high estimation accuracy for low SNR or SIR, especially in multipath fading channel condition. Finally, it should be noted that in such systems, the estimation of a frequency offset performed with a MIMO antenna system has been utilized to improve the robustness against multipath fading, but has not been fully utilized yet to improve offset estimation accuracy.",
        "Accordingly, a continuing search has been directed to the development of an approach which improves frequency offset estimation accuracy without reducing the estimation range. Such frequency offset estimation would preferably be performed using algorithms which (1) are of limited computational complexity to allow for fast processing, (2) feature a detection range able to cover all practical frequency offsets, (3) maintain a given accuracy even at the lower edge of the operating SNR region, and (4), if based on a training sequence, then the same sequence has to be bandwidth-efficient and with a low Peak-to-Average Power Ratio (PAPR).",
        "The present invention, accordingly, provides a carrier frequency offset estimation and correction algorithm, based on the phase of the auto-correlation of the received signal in a MIMO system, after proper signal processing. The algorithm is based on the adoption of a training sequence wherein different transmit (TX) antennas are divided into groups. The TX antenna groupings are made in such a way that antenna correlation for every group is minimized (i.e., antennas belonging to the same group are chosen so that transmit signals from different antennas have a minimal amount of spatial correlation). Each group performs transmission on a specific frequency band and with a time periodicity different from other groups. Sequences transmitted by every antenna in a given group are reciprocally time-orthogonal to guarantee uniform synchronization performance, even in low channel rank condition.",
        "At each receive (RX) antenna, the signal due to different transmission groups may be separated via fast Fourier transform (FFT) processing or other type of band-pass filtering. The group with the shortest time period determines the maximum estimation range of a frequency offset estimation algorithm. Conversely, the group with longest time period determines the accuracy of the algorithm.",
        "As discussed below, for systems having four or more TX antennas, the training sequence of the invention guarantees high synchronization reliability, while the algorithm has clearly better accuracy than is provided by conventional technology.",
        "The algorithm of the present invention is also applicable to the case of two and three TX antennas and for SISO systems. For a SISO system, the group of antennas is configured from a single element.",
        "For a more complete understanding of the present invention, and the advantages thereof, reference is now made to the following descriptions taken in conjunction with the accompanying drawings, in which:",
        "FIG. 1 exemplifies a system that embodies features of the present invention;",
        "FIG. 2 exemplifies periodicity for two antenna groups, wherein a first antenna transmits with period N/16, and a second antenna transmits with a period N/2, and then the pattern is repeated, and wherein different sequences are all reciprocally orthogonal in the time domain, and after the training symbols, other sequences can follow such as symbol timing recovery and channel estimation;",
        "FIG. 3 exemplifies spectral mapping of signals in the training sequence, wherein a signal is set to a zero level in the guard bands and in the central position (because of base-band processing needs);",
        "FIG. 4 is a block-diagram representation of the offset estimation algorithm, it being understood that, while not explicitly shown in FIG. 4, a similar processing block to the one used for RX antenna 1 is necessary for each RX antenna;",
        "FIG. 5 depicts the performance of the invention against the conventional approach, exemplified for two cases of single and double correlation window, it being understood that for high SNR, the performance gain in the simulations is limited by a noise floor due to non-ideal filtering with FFT;",
        "FIG. 6 exemplifies a training sequence for a case of three TX antennas, wherein a first group comprises one antenna, and a second group comprises two antennas with low mutual correlation, and are time-wise orthogonal;",
        "FIG. 7 exemplifies a training sequence for a case of three TX antennas, wherein every antenna transmits a combination of long-time period and short-time period training symbols, and are time-wise orthogonal;",
        "FIG. 8 exemplifies alternative training sequence for a case of four TX antennas, wherein every TX antenna transmits a sum of short time period and long time period training symbols;",
        "FIG. 9 exemplifies a training sequence for system with eight TX antennas, having a group 1 formed by antennas {1, 3, 5, 7}, while a group 2 is formed by antennas {2, 4, 6, 8}; and",
        "FIG. 10 presents a spectral representation for the sequence shown in FIG. 8.",
        "In the following discussion, numerous specific details are set forth to provide a thorough understanding of the present invention. However, it will be obvious to those skilled in the art that the present invention may be practiced without such specific details. In other instances, well-known elements have been illustrated in schematic or block diagram form in order not to obscure the present invention in unnecessary detail. Additionally, for the most part, details concerning wireless transmission, MIMO and SISO broadband multicarrier transmission links, frequency offsets, training sequences, and the like, have been omitted inasmuch as such details are not considered necessary to obtain a complete understanding of the present invention, and are considered to be within the skills of persons of ordinary skill in the relevant art.",
        "It is noted that, unless indicated otherwise, all functions described herein are performed by a processor such as a microprocessor, a microcontroller, an application-specific integrated circuit (ASIC), an electronic data processor, a computer, or the like, in accordance with code, such as program code, software, integrated circuits, and/or the like that are coded to perform such functions. Furthermore, it is considered that the design, development, and implementation details of all such code would be apparent to a person having ordinary skill in the art based upon a review of the present description of the invention.",
        "The invention can operate in all multi-carrier systems having one or more TX antennas. However, the case of four TX antennas is well-suited to the invention and, as such is described in particular detail herein. It is understood, though, that the algorithm described herein is applicable to all types of MIMO, MISO and SIMO systems.",
        "The simulations exemplified herein utilize an MC-MIMO system, and hence the notation used in the following refers to a system with N subcarriers, M TX antennas, and P RX antennas. In particular, the system of the invention can provide benefits in future cellular communication systems that are likely to be based on MC-CDMA or OFDM modulation.",
        "Accordingly, let the OFDM signal at the m-th TX antenna be:",
        "x\n                    m\n                  \n                  \u2061\n                  \n                    (\n                    t\n                    )\n                  \n                \n                =\n                \n                  \n                    1\n                    N\n                  \n                  \u2062\n                  \n                    \n                      \u2211\n                      \n                        n\n                        =\n                        0\n                      \n                      \n                        N\n                        -\n                        1\n                      \n                    \n                    \u2062\n                    \n                      \n                        \n                          X\n                          m\n                        \n                        \u2061\n                        \n                          (\n                          n\n                          )\n                        \n                      \n                      \u2062\n                      \n                        \u2147\n                        \n                          j2\u03c0\n                          \u2062\n                          \n                            \n                          \n                          \u2062\n                          n\n                          \u2062\n                          \n                            \n                          \n                          \u2062\n                          \n                            t\n                            /\n                            N\n                          \n                        \n                      \n                    \n                  \n                \n              \n              ,\n            \n          \n          \n            \n              m\n              =\n              \n                1\n                \u2062\n                \n                  \n                \n                \u2062\n                \u2026\n                \u2062\n                \n                  \n                \n                \u2062\n                M\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        1\n        )\n      \n    \n  \n\n\n\n\nThen let the received signal at the p-th RX antenna be:",
        "r\n                    p\n                  \n                  \u2061\n                  \n                    (\n                    t\n                    )\n                  \n                \n                =\n                \n                  \n                    \n                      \u2211\n                      \n                        m\n                        =\n                        1\n                      \n                      M\n                    \n                    \u2062\n                    \n                      \n                        \u2211\n                        \n                          l\n                          =\n                          1\n                        \n                        \n                          \u0394\n                          -\n                          1\n                        \n                      \n                      \u2062\n                      \n                        \n                          \n                            c\n                            l\n                            mp\n                          \n                          \u2061\n                          \n                            (\n                            t\n                            )\n                          \n                        \n                        \u2062\n                        \n                          \n                            x\n                            m\n                          \n                          \u2061\n                          \n                            (\n                            \n                              t\n                              -\n                              l\n                            \n                            )\n                          \n                        \n                      \n                    \n                  \n                  +\n                  \n                    \n                      v\n                      p\n                    \n                    \u2061\n                    \n                      (\n                      t\n                      )\n                    \n                  \n                \n              \n              ,\n            \n          \n          \n            \n              p\n              =\n              \n                1\n                \u2062\n                \n                  \n                \n                \u2062\n                \u2026\n                \u2062\n                \n                  \n                \n                \u2062\n                P\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        2\n        )\n      \n    \n  \n\n\n\n\nwhere \u0394 represents the maximum delay spread of the channel (i.e., the time unit is the sampling time), clmp is the l-th tap of the mp MIMO subchannel, and the first tap is placed in the time origin. vp is an additive noise contribution.",
        "The M TX antennas are divided in \u03b2 different groups \u0393l, l=1 . . . \u03b2. If \u0393m is the group containing the m-th TX antenna, let Rm be the number of its elements. Moreover, to each group a set of subcarriers \u03a9m is assigned.",
        "Antenna assignment to groups has to be carried out such that the reciprocal correlation between antennas in the same group is minimized. If, by way of example, M=4 and \u03b2=2, then antennas {1, 3} should be assigned to the first group and {2, 4} to the second group. Choosing different groups, such as {1, 2}, brings a drop of performance especially for highly-correlated channels and/or a small number of RX antennas.",
        "If the total length of the sequence is given by an integer number S of OFDM symbols without CP, then, during the transmission interval of the training sequence, the following time-domain signal is transmitted from the m-th TX antenna:",
        "x\n                      ~\n                    \n                    m\n                  \n                  \u2061\n                  \n                    (\n                    t\n                    )\n                  \n                \n                =\n                \n                  \n                    \u2211\n                    \n                      k\n                      =\n                      0\n                    \n                    \n                      \n                        S\n                        \u2062\n                        \n                          \n                        \n                        \u2062\n                        \n                          \u03be\n                          m\n                        \n                      \n                      -\n                      1\n                    \n                  \n                  \u2062\n                  \n                    \n                      C\n                      m\n                      \n                        D\n                        m\n                      \n                    \n                    \u2061\n                    \n                      (\n                      \n                        t\n                        -\n                        \n                          kD\n                          m\n                        \n                      \n                      )\n                    \n                  \n                \n              \n              ,\n            \n          \n          \n            \n              t\n              =\n              \n                \n                  0\n                  \u2062\n                  \n                    \n                  \n                  \u2062\n                  \u2026\n                  \u2062\n                  \n                    \n                  \n                  \u2062\n                  \n                    S\n                    \u00b7\n                    N\n                  \n                \n                -\n                1\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        3\n        )\n      \n    \n  \n\n\n\n\nwhere Dm=N/\u03bem represents the time period of the training sequence relative to the group \u0393m. This corresponds, in the frequency domain, to use one subcarrier every \u03bem subcarriers in the set \u03a9m, while the remaining subcarriers are set to zero. CmDm is a pseudo-random sequence of length Dm.",
        "It should be noted that a significant difference between the invention and the prior art is that the former assigns a different time period to signals transmitted from different TX antennas.",
        "The various CmDm are chosen so that a pseudo-orthogonality condition between different TX antennas is achieved:",
        "\u2200\n                \n                  m\n                  \u2032\n                \n              \n              ,\n              \n                \n                  m\n                  \u2032\u2032\n                \n                \u2208\n                \n                  {\n                  \n                    1\n                    \u2062\n                    \n                      \n                    \n                    \u2062\n                    \u2026\n                    \u2062\n                    \n                      \n                    \n                    \u2062\n                    M\n                  \n                  }\n                \n              \n              ,\n            \n          \n        \n        \n          \n            \n              \n                \n                  \u2211\n                  \n                    t\n                    =\n                    0\n                  \n                  \n                    SN\n                    -\n                    1\n                  \n                \n                \u2062\n                \n                  \n                    \n                      \n                        x\n                        ~\n                      \n                      \n                        m\n                        \u2032\n                      \n                    \n                    \u2061\n                    \n                      (\n                      t\n                      )\n                    \n                  \n                  \u00b7\n                  \n                    \n                      \n                        x\n                        ~\n                      \n                      \n                        m\n                        \u2032\u2032\n                      \n                      *\n                    \n                    \u2061\n                    \n                      (\n                      \n                        t\n                        +\n                        k\n                      \n                      )\n                    \n                  \n                \n              \n              =\n              \n                {\n                \n                  \n                    \n                      \n                        \u03b1\n                        m\n                      \n                    \n                    \n                      \n                        \n                          if\n                          \u2062\n                          \n                            \n                          \n                          \u2062\n                          \n                            m\n                            \u2032\n                          \n                        \n                        =\n                        \n                          \n                            m\n                            \u2032\u2032\n                          \n                          =\n                          \n                            \n                              m\n                              \u2062\n                              \n                                \n                              \n                              \u2062\n                              AND\n                              \u2062\n                              \n                                \n                              \n                              \u2062\n                              k\n                            \n                            =\n                            0\n                          \n                        \n                      \n                    \n                  \n                  \n                    \n                      \n                        \u2248\n                        0\n                      \n                    \n                    \n                      otherwise\n                    \n                  \n                \n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        4\n        )",
        "The pseudo-orthogonality condition is broader than the orthogonality condition and, as such, is inclusive of cases in which the random sequences used to build the training sequence are orthogonal codes, such as Walsh-Hadamard codes.",
        "In the practical design of the training sequence, S will typically be on the order of 1 or 2. CmDm can be produced in the time domain and then filtered to eliminate subcarriers not belonging to \u03a9m. In the simulations exemplified herein, the signal has been produced in the frequency domain, and then transformed to the time domain via IFFT, as discussed in further detail below. The training sequence proposed here is also compatible with the packet detection technique proposed in co-pending patent application entitled \u201cRobust Packet Detection System and Training Sequence for SISO and MIMO Broadband Multicarrier Transmission\u201d Ser. No. PCT/US03/41506, filed Dec. 29, 2003, and the group with longest time period can be used for time synchronization.",
        "The training symbols defined above in equation (3) may conveniently be utilized for a multi-step frequency offset estimation process as discussed in the following. For example, if \u03b2=2, then the offset estimation is performed in two steps.",
        "As a preliminary step, let D1<D2, such that \u03931 is the group of TX antennas performing transmission with the shortest time period. The received signal relative to \u03931 will be processed first and then be followed by \u03932. The signal in equation (2) is filtered so that rp\u03a9l (t) contains only the subcarriers belonging to the set \u03a9l.",
        "The first offset estimation step (coarse estimation) is based on the following auto-correlation:",
        "\u03a8\n                    p\n                  \n                  \u2061\n                  \n                    (\n                    k\n                    )\n                  \n                \n                =\n                \n                  \uf603\n                  \n                    \n                      \u2211\n                      \n                        t\n                        =\n                        0\n                      \n                      LN\n                    \n                    \u2062\n                    \n                      \n                        \n                          r\n                          p\n                          \n                            \u03a9\n                            l\n                          \n                        \n                        \u2061\n                        \n                          (\n                          t\n                          )\n                        \n                      \n                      \u2062\n                      \n                        \n                          r\n                          p\n                          \n                            \u03a9\n                            l\n                            *\n                          \n                        \n                        \u2061\n                        \n                          (\n                          \n                            t\n                            +\n                            \n                              kD\n                              l\n                            \n                          \n                          )\n                        \n                      \n                    \n                  \n                  \uf604\n                \n              \n              ,\n            \n          \n          \n            \n              L\n              \u2264\n              S\n            \n          \n        \n      \n    \n    \n      \n        (\n        5\n        )",
        "In the case considered here with \u03b2=2, it is assumed in equation (5) that l=1.",
        "If fs is the sampling frequency, the coarse estimated frequency offset on the p-th RX antenna is given by:",
        "f\n          \n            coarse\n            ,\n            p\n          \n        \n        =\n        \n          \n            -\n            \n              f\n              s\n            \n          \n          \u2062\n          \n            \n              \u2220\n              \u2062\n              \n                \n                  \u2211\n                  \n                    k\n                    =\n                    1\n                  \n                  \n                    k\n                    max\n                  \n                \n                \u2062\n                \n                  (\n                  \n                    \n                      \n                        \u03a8\n                        p\n                      \n                      \u2061\n                      \n                        (\n                        k\n                        )\n                      \n                    \n                    \u2062\n                    \n                      \u2147\n                      \n                        \n                          -\n                          \n                            \n                              \u2220\u03a8\n                              p\n                            \n                            \u2061\n                            \n                              (\n                              k\n                              )\n                            \n                          \n                        \n                        /\n                        k\n                      \n                    \n                  \n                  )\n                \n              \n            \n            \n              2\n              \u2062\n              \u03c0\n              \u2062\n              \n                \n              \n              \u2062\n              \n                D\n                l\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        6\n        )",
        "The coarse estimate has a detection range of \u03be/(2kmax) inter-carrier spacings.",
        "In the hypothesis that all RX antennas are subject to the same frequency offset (that applies in case a single local oscillator is used), the frequency offset estimation can be averaged:",
        "f\n          coarse\n        \n        =\n        \n          \n            1\n            P\n          \n          \u2062\n          \n            \n              \u2211\n              \n                p\n                =\n                1\n              \n              P\n            \n            \u2062\n            \n              f\n              \n                coarse\n                ,\n                p\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        7\n        )",
        "A coarse frequency adjustment is then applied to the received signal for every RX antenna:\n\nr{circumflex over (r)}p(t)=rp(t)\u00b7e\u22122\u03c0fcoarset, p=1 . . . P\u2003\u2003(8)",
        "Further offset estimation steps are based again on equation (5), performed on a different group \u03a9l, where the time period is longer than in the previous step. For the case of \u03b2=2, the second offset estimation step is also the final one (fine estimation). This step is performed with l=2:",
        "\u03a8\n                      ^\n                    \n                    p\n                  \n                  \u2061\n                  \n                    (\n                    k\n                    )\n                  \n                \n                =\n                \n                  \uf603\n                  \n                    \n                      \u2211\n                      \n                        t\n                        =\n                        0\n                      \n                      LN\n                    \n                    \u2062\n                    \n                      \n                        \n                          \n                            r\n                            ^\n                          \n                          p\n                          \n                            \u03a9\n                            l\n                          \n                        \n                        \u2061\n                        \n                          (\n                          t\n                          )\n                        \n                      \n                      \u2062\n                      \n                        \n                          \n                            r\n                            ^\n                          \n                          p\n                          \n                            \u03a9\n                            l\n                            *\n                          \n                        \n                        \u2061\n                        \n                          (\n                          \n                            t\n                            +\n                            \n                              kD\n                              l\n                            \n                          \n                          )\n                        \n                      \n                    \n                  \n                  \uf604\n                \n              \n              ,\n            \n          \n          \n            \n              L\n              \u2264\n              S\n            \n          \n        \n      \n    \n    \n      \n        (\n        9\n        )",
        "Based on equations (6) and (7) it is, as such, possible to compute a fine offset estimate:",
        "f\n          fine\n        \n        =\n        \n          \n            1\n            P\n          \n          \u2062\n          \n            \n              \u2211\n              \n                p\n                =\n                1\n              \n              P\n            \n            \u2062\n            \n              f\n              \n                fine\n                ,\n                p\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        10\n        )",
        "Finally, the fine correction is applied to the received signal for every RX antenna:\n\n{hacek over (r)}p(t)={circumflex over (r)}p(t)\u00b7e\u22122\u03c0ffinet, p=1 . . . P\u2003\u2003(11)",
        "It is noted that the overall above estimation process corresponds to an estimated frequency offset of:\n\n\u0394fest=fcoarse+ffine\u2003\u2003(12)",
        "The invention may be generalized to any number of TX antennas. For example, for a case of three TX antennas, there are at least two possible implementations, as discussed further below. For a case of SISO and two TX antennas, the invention may be implemented using a single group (i.e., \u03b2=1 ) with respectively one or two elements. Such a group \u0393l may not use a single set of subcarriers, but preferably two sets which may be designated as \u03a91 and \u03a92.",
        "The definition from equation (3) of the training sequence is modified as follows:",
        "x\n                      ~\n                    \n                    m\n                  \n                  \u2061\n                  \n                    (\n                    t\n                    )\n                  \n                \n                =\n                \n                  \n                    \n                      \u2211\n                      \n                        k\n                        =\n                        0\n                      \n                      \n                        \n                          S\n                          \u2062\n                          \n                            \n                          \n                          \u2062\n                          \n                            \u03be\n                            \n                              m\n                              ,\n                              1\n                            \n                          \n                        \n                        -\n                        1\n                      \n                    \n                    \u2062\n                    \n                      \n                        C\n                        m\n                        \n                          D\n                          \n                            m\n                            ,\n                            1\n                          \n                        \n                      \n                      \u2061\n                      \n                        (\n                        \n                          t\n                          -\n                          \n                            kD\n                            \n                              m\n                              ,\n                              1\n                            \n                          \n                        \n                        )\n                      \n                    \n                  \n                  +\n                  \n                    \n                      \u2211\n                      \n                        k\n                        =\n                        0\n                      \n                      \n                        \n                          S\n                          \u2062\n                          \n                            \n                          \n                          \u2062\n                          \n                            \u03be\n                            \n                              m\n                              ,\n                              2\n                            \n                          \n                        \n                        -\n                        1\n                      \n                    \n                    \u2062\n                    \n                      \n                        C\n                        m\n                        \n                          D\n                          \n                            m\n                            ,\n                            2\n                          \n                        \n                      \n                      \u2061\n                      \n                        (\n                        \n                          t\n                          -\n                          \n                            kD\n                            \n                              m\n                              ,\n                              2\n                            \n                          \n                        \n                        )\n                      \n                    \n                  \n                \n              \n              ,\n            \n          \n        \n        \n          \n            \n              t\n              =\n              \n                \n                  0\n                  \u2062\n                  \n                    \n                  \n                  \u2062\n                  \u2026\n                  \u2062\n                  \n                    \n                  \n                  \u2062\n                  \n                    S\n                    \u00b7\n                    N\n                  \n                \n                -\n                1\n              \n            \n          \n        \n      \n    \n    \n      \n        (\n        13\n        )\n      \n    \n  \n\n\n\n\nwhere CmDm,1 is a sequence with time period",
        "D\n      \n        m\n        ,\n        1\n      \n    \n    =\n    \n      N\n      \n        \u03be\n        \n          m\n          ,\n          1\n        \n      \n    \n  \n  ,\n\n\n\n\nusing the subcarriers in \u03a91, and CmDm,2 is a sequence with time period",
        "D\n      \n        m\n        ,\n        2\n      \n    \n    =\n    \n      N\n      \n        \u03be\n        \n          m\n          ,\n          2\n        \n      \n    \n  \n  ,\n\n\n\n\nusing the subcarriers in \u03a92.",
        "Thus, the signal transmitted from every TX antenna is the sum of two signals with different periods and different spectral bands. By adopting this kind of training sequence, it is possible to process the algorithm of the invention embodied in equations (5) through (12) without any modification.",
        "Referring to FIG. 1 of the drawings, the reference numeral 100 generally designates a system embodying one preferred implementation of the present invention, which is directed to use in next-generation broadband multi-carrier systems, such as beyond-3G cellular systems and next-generation wireless local area networks (W-LANs). Accordingly, the system includes four transmit (TX) antennas TX 1, TX 2, TX 3, and TX 4, though the system may be adapted for 2 or 3 TX antennas, or more than 4 TX antennas, as discussed further below. Each of the transmit antennas TX 1, TX 2, TX 3, and TX 4 is configured for transmitting a signal wirelessly to each of a number P of receive (RX) antennas, exemplified as RX antennas 1 through P. Each RX antenna 1 and P is provided with a processor, such as a processor designated by the reference numerals 102 and 124, respectively, each of which processors is effective for executing the logic discussed below with respect to FIG. 4.",
        "A simulation environment for a system such as the system 100 features a wide bandwidth (BW) of 100 MHz, subdivided into 2048 subcarriers (of which 1664 active and 384 fixed to zero value for compliance to a spectral mask with lateral guard bands and no signal in the central position). The channel model is a METRA (see: MIMO Channel Characterisation, METRA Project Deliverable D2 AAU-WP2-D2-V1.1, December 2000, available at http://www.ist-metra.org. IST 1999-11729 METRA project, IST-2000-30148 I METRA Project) channel with re-sampled ITU Pedestrian-A delay profile. The mobile speed is 3 km/h. Noise is injected at the receiver as Additive White Gaussian Noise (AWGN).",
        "The suggested implementation covers specifically the case of a MIMO system having four TX antennas, and P RX antennas, where there are no constraints on P. In the following, some practical training sequences are suggested also for the case where there are two or three TX antennas, or more than four TX antennas.",
        "Simulations have been run with M=P=4, \u03b2=2, L=S=1, \u03be1=16, \u03be2=2, kmax=2 for the case l=1, and kmax=1 for the case l=2. The adopted training sequence is shown in FIG. 2, wherein a first antenna transmits with a period of N/16, and a second antenna transmits with period of N/2, and then the pattern is repeated. Different cross-hatchings show that the different sequences are all reciprocally orthogonal in the time domain. Dashed lines show that after these training symbols, other sequences can follow, such as, for example, symbol timing recovery and channel estimation.",
        "Filtering has been effectuated by FFT. Ad-hoc filters may be used to further improve performance by a fraction of dB.",
        "The foregoing parameters substantially guarantee a maximum estimation range of \u00b14 inter-carrier spacings. This is a design specification in the case that in both TX and RX oscillators with long-term stability of 20 ppm are used and the carrier frequency is in the 5 GHz band.",
        "It is understood that a number of different sets of parameters may be used, such as, by way of example, M=P=4, \u03b2=2, L=S=1, \u03be1=8, \u03be2=2, kmax=1 for the case l=1, and also kmax=1 for the case l=2. While this set of parameters is not simulated herein, it has been adopted in the training symbols of FIG. 10, discussed below.",
        "The spectral representation of the training sequence shown in FIG. 2 is mapped in FIG. 3. The signal is set to a zero level in the guard bands and in the central position, due to base-band processing needs.",
        "The implementation of the offset estimation algorithm (e.g., equations 5-12) is shown in the block diagram of FIG. 4. With respect to each RX processors 102 and 104, in step 404, the signals from each group are separated via FFT processing. In step 406, the autocorrelation (equations 5 and 9) of each signal is computed, and in step 408, the phase (as used in equation 6) of each signal is computed and transmitted to the central processor 106. In step 410, the central processor 106 receives the autocorrelation and phase from each receiver and computes a frequency offset estimate for each receiver, and an average offset estimate across all receivers, using equation 7 (in the first cycle) or equation 10 (in the second cycle). In step 412, the frequency offset correction is calculated from the average frequency offset estimation calculated in step 410, using equation 8 in the first cycle, and equation 11 in the second cycle, and is applied to the signal received from each respective antenna. In step 414, a determination is made whether every group of transmitted signals has been analyzed and, if not, then execution returns to step 404 wherein extraction of a next TX group is performed by FFT filtering using the offset correction last calculated in step 412; otherwise, execution proceeds to step 416, in which further processing, such as symbol timing, channel estimation, and the like, are performed using the offset-corrected receive signal calculated in step 412, and the resulting signal is then processed and used in a conventional manner which is considered to be well-known in that art and will, therefore, not be described in further detail herein.",
        "In accordance with the foregoing, it will be apparent to one skilled in the art that, in the example shown with \u03b2=2, the algorithm would be performed by the receivers 1 through P and the central processor 106 in the order of steps 404, 406, 408, 410, 412, 414, 404, 406, 408, 410, 412, 414, and 416.",
        "Concerning the implementation of the algorithm, it should be noted that, after the signal belonging to different groups has been separated with a filter, it is also possible to compute the auto-correlation in the frequency domain, as shown in P. Moose, A technique for orthogonal frequency division multiplexing frequency offset correction, IEEE Trans. Commun., vol. 42, pp. 2908-2914, October 1994.",
        "The performance of this algorithm may be compared to a traditional implementation transmitting signals having the same time period from every TX antenna. To perform a fair comparison, the traditional implementation has been designed with the same detection range of the proposed approach.",
        "The simulation results for both the traditional method and the method embodied by the invention are shown in FIG. 5. Performance of the proposed approach and the traditional approach (for the two cases of single and double correlation window). For a high SNR the performance gain in the simulations is limited by a noise floor due to non-ideal filtering with FFT.",
        "From FIG. 5, it can be seen that the proposed approach has a performance advantage on the order of 5 to 6 dB in comparison to the traditional approach based on auto-correlation. The traditional approach can be made more accurate by using two correlation windows instead of one and summing the average phase of the correlation after proper normalization; however, even in such a case, the performance advantage of the approach embodied by the invention is still on the order of 3 dB.",
        "FIG. 6 exemplifies a preferred training sequence suitable for implementation of the invention using three TX antennas. The first group is formed by just one antenna (TX 2), and the second group contains two antennas (TX 1 and TX 3) with low mutual correlation. Different cross-hatchings indicate temporal orthogonality.",
        "Provided that the coarse estimation with the first group (TX 2) is able to give an estimate with error below the half inter-carrier spacing, the type of training sequence shown in FIG. 6 has a final estimation precision equivalent to the case of four TX antennas. The total algorithm performance is slightly worse than the four TX antenna case because in some cases the fading condition on the signal transmitted from TX 2 will be too severe to permit a correct coarse synchronization.",
        "Taking into account this possibility (i.e., that the fading condition on the signal transmitted from TX 2 of FIG. 6 will be too severe to permit a correct coarse synchronization), an alternative preferred training sequence depicted in FIG. 7 may be used. Every antenna (i.e., TX 1, TX 2, and TX 3) transmits a combination of long-time period and short-time period training symbols. As discussed above, different cross-hatchings indicate temporal orthogonality.",
        "The training sequence detailed in FIG. 7 guarantees a better degree of spatial diversity protection in a deep fading condition. In this case, the training symbols are expressed not according to equation (3), but according to equation (13).",
        "Similarly, as depicted in FIG. 8, alternative training sequences may be used in the case of four TX antennas, wherein every TX antenna transmits a sum of short-time period and long-time period training symbols.",
        "FIG. 9 gives a proposal of a training sequence for the case of eight TX antennas, showing a training sequence for a system with eight TX antennas. Group 1 is formed by antennas {1, 3, 5, 7}, while group 2 is formed by {2, 4, 6, 8}. The method of implementation utilized in FIG. 8 may also be used in the case of eight or more TX antennas, wherein all groups include all TX antennas. Combinations of the foregoing are also possible, such as, for example, the transmission of signals with one time period on a given set of antennas and superposition of signals with different periods on other antennas.",
        "The present invention can also be conveniently applied in the case of cellular systems with heavy co-channel interference. In such cases, the total available BW is divided so that directly interfering base stations use different frequency bands for the transmission of their respective training sequences. FIG. 10 depicts a spectral representation for the first part of the sequence shown in FIG. 3. The letters A, B, C indicate frequency packets transmitted by the up to three interfering BTS. With proper network planning, direct co-channel interference is avoided because of frequency multiplexing. This principle can be immediately extended to the case of four directly interfering BTS.",
        "By the use of the present invention, for a given training sequence, the offset estimation accuracy is directly proportional to three factors, namely, (1) the total number of samples in the correlation window, (2) the SNIR at the receiver, and (3) the time period of the training sequence.",
        "If a practical example is considered, where M=4, \u03b2=2, \u03be1=16, \u03be2=2, it is apparent that compared to the prior art, the received SNIR decreases by 3 dB (two times), but the period is increased by eight times, meaning that the average error in the estimation will be roughly four times smaller with the proposed approach.",
        "In formulas, the variance of frequency offset estimators for high SNR in both time domain and frequency domain is given by:",
        "\u03c3\n        =\n        \n          1\n          \n            \n              \u03c0\n              2\n            \n            \u2062\n            \n              N\n              \u00b7\n              SNIR\n            \n          \n        \n      \n    \n    \n      \n        (\n        14\n        )",
        "for the case of a correlation window of length N samples.",
        "In the above case the proposed approach reduces the ratio of the estimate variance to the estimate average by 6 dB. In the simulations, a performance advantage may be slightly below 6 dB because of non-ideal filtering in the process of deriving rp\u03a9l(t).",
        "The proposed approach, including training sequence and algorithm, improves considerably the estimation accuracy of the carrier frequency offset. The advantage in performance is several dBs over prior art methods, as shown in FIG. 5.",
        "A further advantage of the invention is that space diversity is utilized to reduce the total time length of the training sequence for frequency offset estimation, for a given detection range and estimation accuracy. This in turn improves the spectrum utilization of the packet. The invention is also well-suited for implementation in the presence of a packet detection system that operates with large time variance for low SNIR scenarios. This is a further advantage over possible implementations where different types of short training symbols are inserted consecutively in the training sequence. The proposed training sequence may also be exploited for MIMO symbol timing recovery (the group with the longest time period), and this could result in further optimization of the spectrum usage.",
        "Having thus described the present invention by reference to certain of its preferred embodiments, it is noted that the embodiments disclosed are illustrative rather than limiting in nature and that a wide range of variations, modifications, changes, and substitutions are contemplated in the foregoing disclosure and, in some instances, some features of the present invention may be employed without a corresponding use of the other features. Many such variations and modifications may be considered obvious and desirable by those skilled in the art based upon a review of the foregoing description of preferred embodiments. Accordingly, it is appropriate that the appended claims be construed broadly and in a manner consistent with the scope of the invention."
    ],
    "citations": [
        "2002/0118724",
        "2003/0002471",
        "2003/0235238"
    ],
    "us_classification": "375267",
    "international_classifications": [
        {
            "classification_level": "A",
            "section": "H",
            "classification_class": "04",
            "subclass": "B",
            "main_group": "7",
            "subgroup": "02"
        }
    ]
}