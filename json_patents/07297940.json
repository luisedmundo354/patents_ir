{
    "title": "Method, apparatus, and program product for classifying ionized molecular fragments",
    "abstract": "Apparatus, methods, and program products are disclosed that classify spectral peaks in dissociation spectrum data and thereby improves the efficiency of molecular sequencing.",
    "inventors": [
        "Bern"
    ],
    "document_number": "07297940",
    "publication_date": "20071120",
    "assignees": [
        "Palo Alto Research Center Incorporated"
    ],
    "claims": [
        {
            "claim_number": "CLM-00001",
            "preamble": "1. A computer controlled method comprising:",
            "components": [
                {
                    "component": "accessing dissociation spectrum data comprising a plurality of spectral peaks representing a plurality of fragments of a parent molecule, said parent molecule comprising a plurality of molecular subunits and a plurality of cleavage sites, each of said plurality of cleavage sites connecting a first one of said plurality of molecular subunits and a second one of said plurality of molecular subunits, said plurality of spectral peaks associated with a respective plurality of peak intensities;",
                    "subcomponents": []
                },
                {
                    "component": "representing a portion of said plurality of spectral peaks as a plurality of vertices;",
                    "subcomponents": []
                },
                {
                    "component": "assigning a plurality of weighted edges to said plurality of vertices;",
                    "subcomponents": []
                },
                {
                    "component": "applying a confidence-weighted classification to said plurality of vertices responsive to said plurality of weighted edges;",
                    "subcomponents": []
                },
                {
                    "component": "adjusting said respective plurality of peak intensities responsive to the step of applying;",
                    "subcomponents": []
                },
                {
                    "component": "and presenting said respective plurality of peak intensities.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00002",
            "preamble": "2. The computer controlled method of claim 1 , wherein the step of presenting further comprises determining at least one possible molecular subunit sequence for a portion of said parent molecule.",
            "components": []
        },
        {
            "claim_number": "CLM-00003",
            "preamble": "3. The computer controlled method of claim 2 , wherein the step of applying classifies said portion of said plurality of vertices into a plurality of classes, said plurality of classes representing a first class of spectral peaks and a second class of spectral peaks;",
            "components": [
                {
                    "component": "and wherein the step of presenting further comprises complementing the first class relative to the mass of said parent molecule that yielded said dissociation spectrum data.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00004",
            "preamble": "4. The computer controlled method of claim 1 , wherein the step of presenting further comprises:",
            "components": [
                {
                    "component": "generating a processed spectrum responsive to the step of adjusting;",
                    "subcomponents": []
                },
                {
                    "component": "and providing said processed spectrum to at least a portion of a sequencing program.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00005",
            "preamble": "5. The computer controlled method of claim 1 , wherein the step of presenting further comprises identifying one or more of said plurality of spectral peaks in accordance with the step of adjusting.",
            "components": []
        },
        {
            "claim_number": "CLM-00006",
            "preamble": "6. The computer controlled method of claim 1 , wherein said parent molecule is one or more selected from a group consisting of a polymer, a lipid, a protein, a peptide and a glycan.",
            "components": []
        },
        {
            "claim_number": "CLM-00007",
            "preamble": "7. The computer controlled method of claim 1 , wherein said parent molecule is a protein or peptide and said plurality of molecular subunits are amino acids.",
            "components": []
        },
        {
            "claim_number": "CLM-00008",
            "preamble": "8. The computer controlled method of claim 1 , wherein the step of applying further comprises:",
            "components": [
                {
                    "component": "generating a graph comprising said plurality of vertices representing said portion of said plurality of spectral peaks and including at least one artificial vertex;",
                    "subcomponents": []
                },
                {
                    "component": "said graph further comprising said plurality of weighted edges wherein said plurality of weighted edges represent a plurality of affinities between said plurality of vertices.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00009",
            "preamble": "9. The computer controlled method of claim 8 , wherein said graph is represented by a matrix wherein said plurality of weighted edges of the graph are off-diagonal values of said matrix and the diagonal values of said matrix are the sums of the absolute values of the corresponding rows of said matrix;",
            "components": [
                {
                    "component": "and wherein the step of applying further comprises:",
                    "subcomponents": []
                },
                {
                    "component": "computing a plurality of eigenvectors for the generalized eigenvector problem represented by said matrix;",
                    "subcomponents": []
                },
                {
                    "component": "and weighting the i",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00010",
            "preamble": "10. A computer program product comprising:",
            "components": [
                {
                    "component": "a computer-usable data carrier storing instructions that, when executed by a computer, cause said computer to perform a method comprising:",
                    "subcomponents": []
                },
                {
                    "component": "accessing dissociation spectrum data comprising a plurality of spectral peaks representing a plurality of fragments of a parent molecule, said parent molecule comprising a plurality of molecular subunits and a plurality of cleavage sites, each of said plurality of cleavage sites connecting a first one of said plurality of molecular subunits and a second one of said plurality of molecular subunits, said plurality of spectral peaks associated with a respective plurality of peak intensities;",
                    "subcomponents": []
                },
                {
                    "component": "representing a portion of said plurality of spectral peaks as a plurality of vertices;",
                    "subcomponents": []
                },
                {
                    "component": "assigning a plurality of weighted edges to said plurality of vertices;",
                    "subcomponents": []
                },
                {
                    "component": "applying a confidence-weighted classification to said plurality of vertices responsive to said plurality of weighted edges;",
                    "subcomponents": []
                },
                {
                    "component": "adjusting said respective plurality of peak intensities responsive to the step of applying;",
                    "subcomponents": []
                },
                {
                    "component": "and presenting said respective plurality of peak intensities.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00011",
            "preamble": "11. The computer program product of claim 10 , wherein the step of presenting further comprises determining at least one possible molecular subunit sequence for a portion of said parent molecule.",
            "components": []
        },
        {
            "claim_number": "CLM-00012",
            "preamble": "12. The computer program product of claim 11 , wherein the step of applying classifies said portion of said plurality of vertices into a plurality of classes, said plurality of classes representing a first class of spectral peaks and a second class of spectral peaks;",
            "components": [
                {
                    "component": "and wherein the step of presenting further comprises complementing the first class relative to the mass of said parent molecule that yielded said dissociation spectrum data.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00013",
            "preamble": "13. The computer program product of claim 10 , wherein the step of presenting further comprises:",
            "components": [
                {
                    "component": "generating a processed spectrum responsive to the step of adjusting;",
                    "subcomponents": []
                },
                {
                    "component": "and providing said processed spectrum to at least a portion of a sequencing program.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00014",
            "preamble": "14. The computer program product of claim 10 , wherein the step of presenting further comprises identifying one or more of said plurality of spectral peaks in accordance with the step of adjusting.",
            "components": []
        },
        {
            "claim_number": "CLM-00015",
            "preamble": "15. The computer program product of claim 10 , wherein said parent molecule is one or more selected from a group consisting of a polymer, a lipid, a protein, a peptide and a glycan.",
            "components": []
        },
        {
            "claim_number": "CLM-00016",
            "preamble": "16. The computer program product of claim 10 , wherein said parent molecule is a protein or peptide and said plurality of molecular subunits are amino acids.",
            "components": []
        },
        {
            "claim_number": "CLM-00017",
            "preamble": "17. The computer program product of claim 10 , wherein the step of applying further comprises:",
            "components": [
                {
                    "component": "generating a graph comprising said plurality of vertices representing said portion of said plurality of spectral peaks and including at least one artificial vertex;",
                    "subcomponents": []
                },
                {
                    "component": "said graph further comprising said plurality of weighted edges wherein said plurality of weighted edges represent a plurality of affinities between said plurality of vertices.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00018",
            "preamble": "18. The computer program product of claim 17 , wherein said graph is represented by a matrix wherein said plurality of weighted edges of the graph are off-diagonal values of said matrix and the diagonal values of said matrix are the sums of the absolute values of the corresponding rows of said matrix;",
            "components": [
                {
                    "component": "and wherein the step of applying further comprises:",
                    "subcomponents": []
                },
                {
                    "component": "computing a plurality of eigenvectors for the generalized eigenvector problem represented by said matrix;",
                    "subcomponents": []
                },
                {
                    "component": "and weighting the i",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00019",
            "preamble": "19. An apparatus comprising:",
            "components": [
                {
                    "component": "a spectrum access logic configured to access dissociation spectrum data comprising a plurality of spectral peaks representing a plurality of fragments of a parent molecule, said parent molecule comprising a plurality of molecular subunits and a plurality of cleavage sites, each of said plurality of cleavage sites connecting a first one of said plurality of molecular subunits and a second one of said plurality of molecular subunits, said plurality of spectral peaks associated with a respective plurality of peak intensities;",
                    "subcomponents": []
                },
                {
                    "component": "a peak selection logic configured to represent a portion of said plurality of spectral peaks accessed by the spectrum access logic as a plurality of vertices;",
                    "subcomponents": []
                },
                {
                    "component": "an edge weight assignment logic configured to assign a plurality of weighted edges to said plurality of vertices selected by the peak selection logic;",
                    "subcomponents": []
                },
                {
                    "component": "a classification logic configured to apply a confidence-weighted classification to said plurality of vertices responsive to said plurality of weighted edges;",
                    "subcomponents": []
                },
                {
                    "component": "an adjustment logic configured to adjust said respective plurality of peak intensities responsive to the classification logic;",
                    "subcomponents": []
                },
                {
                    "component": "and a presentation logic configured to present said respective plurality of peak intensities by storing representations of a spectrum with spectral peaks identified by the use of the technology or displaying data from such a spectrum; displaying or storing molecular sequences identified by the use of the technology; passing data representing or derived from the use of the technology to another system (for example, a computer via use of a computer-usable data carrier such as tangible storage devices or a network\u2014and/or using remote procedure call protocols), to another procedure, and/or to a programmed routine.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00020",
            "preamble": "20. The apparatus of claim 19 , wherein the presentation logic further comprises a sequence logic configured to determine at least one possible molecular subunit sequence for a portion of said parent molecule.",
            "components": []
        },
        {
            "claim_number": "CLM-00021",
            "preamble": "21. The apparatus of claim 20 , wherein the classification logic classifies said portion of said plurality of vertices into a plurality of classes, said plurality of classes representing a first class of spectral peaks and a second class of spectral peaks;",
            "components": [
                {
                    "component": "and wherein the presentation logic further comprises a complementation logic configured to complement the first class relative to the mass of said parent molecule that yielded said dissociation spectrum data.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00022",
            "preamble": "22. The apparatus of claim 19 , wherein the presentation logic further comprises:",
            "components": [
                {
                    "component": "a regeneration logic configured to generate a processed spectrum responsive to the adjustment logic;",
                    "subcomponents": []
                },
                {
                    "component": "and an output logic configured to provide said processed spectrum to at least a portion of a sequencing program.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00023",
            "preamble": "23. The apparatus of claim 19 , wherein the presentation logic further comprises an ion identification logic configured to identify one or more of said plurality of spectral peaks in accordance with the adjustment logic.",
            "components": []
        },
        {
            "claim_number": "CLM-00024",
            "preamble": "24. The apparatus of claim 19 , wherein said parent molecule is one or more selected from a group consisting of a polymer, a lipid, a protein, a peptide and a glycan.",
            "components": []
        },
        {
            "claim_number": "CLM-00025",
            "preamble": "25. The apparatus of claim 19 , wherein said parent molecule is a protein or peptide and said plurality of molecular subunits are amino acids.",
            "components": []
        },
        {
            "claim_number": "CLM-00026",
            "preamble": "26. The apparatus of claim 19 , wherein the classification logic further comprises:",
            "components": [
                {
                    "component": "a graph generation logic configured to generate a graph comprising said plurality of vertices representing said portion of said plurality of spectral peaks and including at least one artificial vertex;",
                    "subcomponents": []
                },
                {
                    "component": "said graph further comprising said plurality of weighted edges wherein said plurality of weighted edges represent a plurality of affinities between said plurality of vertices.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00027",
            "preamble": "27. The apparatus of claim 26 , wherein said graph is represented by a matrix wherein said plurality of weighted edges of the graph are off-diagonal values of said matrix and the diagonal values of said matrix are the sums of the absolute values of the corresponding rows of said matrix;",
            "components": [
                {
                    "component": "and wherein the classification logic further comprises:",
                    "subcomponents": []
                },
                {
                    "component": "an eigenvector solution logic configured to compute a plurality of eigenvectors for the generalized eigenvector problem represented by said matrix;",
                    "subcomponents": []
                },
                {
                    "component": "and a vertex evaluation logic configured to weight the i",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00028",
            "preamble": "28. The apparatus of claim 19 , further comprising a tandem mass spectrometer.",
            "components": []
        }
    ],
    "description": [
        "1. Field",
        "This technology relates to the field of identifying a complex molecule having a structure that includes molecular subunits bound together at cleavage sites through the analysis of fragmentation spectra of the complex molecule.",
        "2. Background",
        "There are a number of techniques that can be used to identify complex molecules. Some of these techniques use fragmentation spectra of the complex molecules. Such fragmentation spectra can be generated by Tandem Mass Spectrometry (\u201cMS/MS\u201d) techniques as is well known in the art. Analysis of the fragmentation spectra can provide clues to the structure and the sequence of molecular subunits that make up the complex molecule.",
        "An ideal spectrum would contain a complete \u201cladder\u201d of b-ions or y-ions from which we could simply read off the molecular subunit sequence or its reversal. Hence generation of candidate sequences is usually formulated as a longest (or best) path problem in a peak graph, which has a vertex for each peak in the spectrum and an edge connecting two peaks if they differ by the mass of a possible molecular subunit. Due to missed cleavages, peak graphs might use vertices corresponding to small mass ranges rather than peaks, and/or include edges between vertices differing by the mass of a pair of residues.",
        "One way to identify the structure of a complex molecule is to identify and score candidate sequences for the complex molecule in light of the fragmentation spectra. In one approach, the candidates can be found in a database of known molecules. U.S. Pat. No. 5,538,897 to Yates, III et al. (hereby incorporated by reference in its entirety) teaches such a method where the complex molecule is a protein or peptide. The difficulty with this approach is that the complex molecule needs to have been previously identified or predicted and its characteristics stored in the database. Thus, a fragmentation spectrum for a complex molecule that has not been previously characterized and entered into the database will not be identified.",
        "Another way to identify the structure of a complex molecule is to use the de novo sequencing approach. A method for sequencing peptides or proteins taking this approach is disclosed by U.S. Pat. No. 6,582,965 to Townsend et al. (hereby incorporated by reference in its entirety). In the de novo sequencing approach, the method attempts to generate all possible sequences of molecular subunits that could be consistent with the fragmentation spectrum. One problem with the de novo sequencing approach for proteins and peptides is that it is difficult to determine which peaks are y-ions (c-terminus fragments) and which peaks are b-ions (n-terminus fragments). The term \u201cb/y ambiguity\u201d identifies this difficulty. This difficulty is compounded because the fragmentation spectrum includes spectral peaks for noise (ions that are not fragments of the parent molecule) as well as spectral peaks for signals (ions that are fragments of the parent molecule). Noise in the fragmentation spectra decreases the probability of correctly sequencing a complex molecule from fragmentation spectra.",
        "Furthermore, it is very rare for a peptide spectrum to have a complete ladder of b- or y-ions, and hence most sequencers attempt to form a ladder from a mixture of the two types. Lutefisk (see Implementation anduUses of Automated De Novo Peptide Sequencing by Tandem Mass Spectrometry, by Taylor et al. (Anal. Chem., 73 (2001), 2594-2604)) turns each peak into two vertices, one at the observed mass and the other at the complementary mass. Such complementation has two drawbacks: in effect it adds many noise peaks, and it allows the use of a single peak as both a b- and a y-ion. A paper entitled A Dynamic Programming Approach to De Novo Peptide Sequencing by Mass Spectrometry, by Chen et al. (J. Computational Biology, 8 (2001), 325-337) showed how to correct the latter drawback with a longest-path algorithm that disallows the simultaneous use of both vertices from a single peak. A paper entitled An Effective Algorithm for the Peptide De Novo Sequencing from MS/MS Spectrum, by Ma et al. (Symp. Comb. Pattern Matching, 2003, 266-278) teaches a more subtle fix; they allow the simultaneous use of both vertices, but do not score the peak twice. None of these solutions, however, addresses the larger drawback\u2014doubling the number of noise peaks.",
        "A paper entitled New Computational Approaches for De Novo Peptide Sequencing from MS/MS Experiments, by Lubeck et al., (Proc. IEEEV 90, (2002), 1868-1874) proposed the idea of classifying peaks as b-, y-, or \u201cother\u201d prior to running the longest-path algorithm. The longest-path algorithm would use the peak classifications and would avoid complementing every peak. Lubeck did not disclose algorithms or results.",
        "A paper entitled PPM-Chain\u2014De Novo Peptide Identification Program Comparable in Performance to Sequest, by Day et al., (Proc. IEEE Computational Systems Bioinformatics, 2004, 505-508) independently proposed peak classification (as an alternative rather than as an adjunct to the longest-path algorithm), and built a three-class classifier keying on b/y pairs and the \u201cneutral loss neighborhood\u201d (about 30 Daltons) around each peak.",
        "A paper entitled Separation of Ion Types in Tandem Mass Spectrometry Data Interpretation\u2014A Graph-Theoretic Approach, by Yan et al., (Proc. IEEE Computational Systems Bioinformatics, 2004, 236-244) disclosed the same idea and formulated the classification problem as a graph tripartition problem. They disclosed an exponential-time algorithm for an exact solution to the problem.",
        "Thus, it would be advantageous to find a method that is able to classify spectral peaks in the fragmentation spectra as b-ions and y-ions with weights for classification confidence, without increasing the noise in the fragmentation spectra and that uses a less computationally demanding algorithm than Yan et al.",
        "FIG. 1 Illustrates a molecular sequencing system;",
        "FIG. 2 illustrates a computer system in accordance with a preferred embodiment;",
        "FIG. 3 illustrates a histogram of an example dissociation spectrum that can be produced by a tandem mass spectrometer and that indicates the number of ions observed at each m/z value;",
        "FIG. 4 illustrates one embodiment of a molecular fragment classification process;",
        "FIG. 5 illustrates one embodiment of a process that initializes a spring system responsive to dissociation spectrum data;",
        "FIG. 6 illustrates one embodiment of an \u2018apply confidence-weighted classification\u2019 process;",
        "FIG. 7 illustrates one embodiment of an \u2018adjust spectral peak intensities\u2019 process;",
        "FIG. 8 illustrates a \u2018determine possible sequence of molecular subunits\u2019 process;",
        "FIG. 9 illustrates a first portion of an edge-weighting process for the spring system;",
        "FIG. 10 illustrates a second portion of the edge-weighting process for the spring system;",
        "FIG. 11 illustrates a partitioned and classified two dimensional eigenspace resulting from the spectrum represented by FIG. 3;",
        "FIG. 12 illustrates a partitioned and identified two dimensional eigenspace resulting from the sequencing of the vertices classified as shown in FIG. 11; and",
        "FIG. 13 illustrates a sequenced dissociation spectrum data that can result from a tandem mass spectrometer spectrum that has been analyzed by the process of FIG. 4 and that generated the eigenspace of FIG. 11.",
        "The following \u2018notations and nomenclature\u2019 are provided to assist in the understanding of the presented technology and embodiments thereof.",
        "Programmed routine or function\u2014A programmed routine or a programmed function is a sequence of program code, in any programming methodology, that can be invoked, with or without parameters, to perform its designed operation responsive to any provided parameters, accessible state, and/or accessible data. A programmed routine or function can be instructions that are processed by general purpose CPU or other electronics. A programmed function generally returns a value. A programmed routine or function can often be implemented in electronics designed to perform the designated operation and can provide result values either with digital values, analog values, or a combination of digital and analog values.",
        "Present, presented, presenting\u2014The result of the operation of embodiments of the technology described herein can be \u201cpresented\u201d by the embodiment. This can include storing representations of a spectrum with spectral peaks identified by the use of the technology or displaying data from such a spectrum; displaying or storing molecular sequences identified by the use of the technology; passing data representing or derived from the use of the technology to another system (for example, a computer via use of a computer-usable data carrier such as tangible storage devices or a network\u2014and/or using remote procedure call protocols), to another procedure, and/or to a programmed routine.",
        "Procedure\u2014A procedure is a self-consistent sequence of computerized steps that lead to a desired result. These steps can be defined by one or more computer instructions. These steps can be performed by a computer executing the instructions that define the steps. Thus, the term \u201cprocedure\u201d can refer (for example, but without limitation) to a sequence of instructions, a sequence of instructions organized within a programmed-procedure or programmed-function, or a sequence of instructions organized within programmed-processes executing in one or more computers. Such a procedure can also be implemented directly in specialized circuitry that performs the steps.",
        "The inventor has developed apparatus, methods, and program products that classify spectral peaks in dissociation spectrum data and thereby improves the efficiency of molecular sequencing. This is accomplished by accessing dissociation spectrum data that includes spectral peaks representing fragments of a parent molecule. The parent molecule includes molecular subunits and cleavage sites wherein each of the cleavage sites connects a first one of the molecular subunits and a second one of the molecular subunits. The spectral peaks are associated with peak intensities. Some of the spectral peaks are selected to be represented by corresponding vertices. Weighted edges are assigned to the corresponding vertices and then a confidence-weighted classification is applied to corresponding vertices responsive to the weighted edges. Once the vertices are classified, the peak intensities can be adjusted responsive to the classification and the peak intensities are presented.",
        "The inventor has realized that classifying peaks as b-ions, y-ions and \u201cothers\u201d, is unnecessary to improve de novo analysis. When using classification in conjunction with the longest-path algorithm, it suffices to solve a much easier problem: divide the peaks into two groups, such that one group contains all the b-ions and the other contains all the y-ions. Such a bipartition allows one group to be complemented (subtracted from the parent ion mass) and thereby removes the b/y ambiguity of peaks without doubling the number of noise peaks. The inventor applies spectral graph partitioning\u2014a polynomial-time algorithm\u2014to this bipartition problem. By using a polynomial-time algorithm instead of an exponential-time algorithm, much more complex spectra can be classified.",
        "FIG. 1 illustrates operation of a molecular sequencing system 100. In such a system, a chemical sample 101 is input to a tandem mass spectrometer 103 that generates a dissociation spectrum 105 (see FIG. 3). The dissociation spectrum 105 can be filtered by an optional spectrum filter 107 to pass high quality spectra to a de novo sequencer 109 that processes the dissociation spectrum 105 to determine a possible sequence of chemical subunits 111 of the chemical sample 101 that can be presented.",
        "One skilled in the art will understand that a tandem mass spectrometer generates the dissociation spectrum data by selecting parent molecules having a specific molecular mass (within a tolerance) in a first stage of the tandem mass spectrometer, causing the selected parent molecules to be fragmented at cleavage sites (using methods known to one skilled in the art), and accumulating the count of the resulting fragments in m/z histogram bins. A number of bins can represent a single spectral peak. Either the height or the area of the spectral peak will be referred to as the spectral peak's \u201cintensity\u201d.",
        "FIG. 2 illustrates a computer system 200 that can incorporate the disclosed technology. The computer system 200 includes a computer 201 that incorporates a CPU 203, a memory 205, and, in some embodiments, a network interface 207. The network interface 207 provides the computer 201 with access to a network 209. The computer 201 also includes an I/O interface 211 that can be connected to a user interface device(s) 213, a storage system 215, and a removable data device 217. The removable data device 217 can read a tangible computer-usable data carrier 219 that typically contains a program product 221. The storage system 215 (along with the removable data device 217), the tangible computer-usable data carrier 219 and any network file storage comprise a file storage mechanism. The tangible computer-usable data carrier 219 can be a ROM within the computer system 200, within replaceable ROM, a memory stick, CD, floppy, DVD or any other tangible media. The program product 221 accessed from the tangible computer-usable data carrier 219 is generally read into the memory 205 as a program 223 that instructs the CPU to perform the processes described herein as well as other processes. In addition, the program product 221 can be provided from the network (generally encoded within an electromagnetic carrier wave\u2014including light, radio, and electronic signaling) through the network interface 207. One skilled in the art will understand that the network 209 is another computer-usable data carrier.",
        "A tandem mass spectrometer 225 can be in direct communication with the I/O interface 211 and can provide dissociation spectrum data directly to the computer 201 (for example, by using a data bus (for example a USB, FireWire\u00ae, or custom connection). In addition, the tandem mass spectrometer 225 can provide dissociation spectrum data over the network 209, or via the tangible computer-usable data carrier 219. One skilled in the art will understand that not all of the displayed features of the computer 201 need to be present for all embodiments.",
        "FIG. 3 illustrates an example tandem mass spectrometer dissociation spectrum 300 of a parent molecule plotted on an x-axis in m/z 301 and a y-axis in intensity 303. The parent molecule generally includes a number of molecular subunits connected by cleavage sites. The tandem mass spectrometer generally disassociates many of the parent molecules into at least two fragments at any of the cleavage sites. The dissociation spectrum data indicate the number of fragments produced having similar m/z. The location of the spectral peak on the x-axis in m/z 301 represents the mass of a singly charged ion. The term intensity refers to the height or area of the spectral peak. The intensity of a spectral peak indicates how often the parent molecules have been fragmented at a particular cleavage site. The m/z, intensity, structure, and shape of the spectral peak are some of the characteristics of the spectral peak.",
        "The tandem mass spectrometer often provides annotation information for the spectral peaks such as the m/z for selected intense spectral peaks. It can also detect doubly charged parent molecules. As previously discussed, one difficulty with this representation is that it is very difficult to determine noise peaks from dissociation (or fragmentation) spectral peaks. In the case of peptides and proteins, it is very difficult to determine which spectral peaks indicate b-ions, y-ions, a-ions, or noise. One skilled in the art will understand one of the very significant problems in protein and/or peptide sequencing is that of determining whether a spectral peak represents a y-ion, a b-ion, or noise. This is the b/y ambiguity problem.",
        "FIG. 4 illustrates a molecular fragment classification process 400 that can be used as, or by the de novo sequencer 109 to determine one or more possible sequences of molecular subunits that make up a parent molecule. The molecular fragment classification process 400 initiates at a \u2018start\u2019 terminal 401 and continues to an \u2018access dissociation spectrum data\u2019 procedure 403 that accesses the dissociation spectrum data. The dissociation spectrum data can be accessed from the storage system 215, the network 209, the tangible computer-usable data carrier 219, or directly from the tandem mass spectrometer 225 or by any other data access technique or technology. The dissociation spectrum data includes spectral peaks. The spectral peaks have intensities, which are initially related to ion counts but may be changed responsive to subsequent computations.",
        "The parent molecule may be a protein, peptide, lipid, polymer (composed of a single monomer, or multiple monomers), glycan, etc. Much of the rest of this description is cast in the context of peptides and amino acids. However, one skilled in the art will understand that the techniques taught herein can be applied to other molecules that have molecular subunits connected by cleavage sites.",
        "Once the dissociation spectrum data is accessed, an \u2018assign ranking and weighted edges to spectral peaks\u2019 procedure 405 processes the dissociation spectrum data to identify the m/z (mass) and intensity of the spectral peaks, select the relevant spectral peaks, and ranks the spectral peaks in intensity order (irank). One skilled in the art will understand that the spectral peak data in the dissociation spectrum data is generally not directly manipulated, but rather the spectral peaks' characteristics are obtained from the dissociation spectrum data and used to establish values in data structures (often termed vertices herein) that represent the characteristics of the spectral peaks.",
        "The \u2018assign ranking and weighted edges to spectral peaks\u2019 procedure 405 also initializes a data structure called a spring system that establishes weighted edges between the vertices that represent the spectral peaks. Some embodiments can insert artificial vertices into the array and provide weighted edges between the artificial peaks and some or all of the spectral peak vertices. The array created by the \u2018assign ranking and weighted edges to spectral peaks\u2019 procedure 405 is analogous to a physical spring system in which the intensity of a peak is analogous to a mass and the weighted edge is analogous to a spring that provides a repulsion/attraction force between the peaks connected by the weighted edge. The inventor believes that this is the first application of a spring system to dissociation spectrum data. The \u2018assign ranking and weighted edges to spectral peaks\u2019 procedure 405 is subsequently described with respect to FIG. 5.",
        "Once the spring system data structure is created, an \u2018apply confidence-weighted classification to the spectral peaks\u2019 procedure 407 applies a confidence-weighted classification process to the spring system represented by the data structure. This generates two eigenvectors that establish a two-dimensional eigenspace. The vertices that represent the spectral peaks are projected into the eigenspace and used to fit a line. In some embodiments, a second line, orthogonal to the first line, can be used to partition the eigenspace. Thus, the spectral peaks selected from the dissociation spectrum data can be classified into two or more classifications responsive to the weighted edges between the vertices representing the selected peaks.",
        "While one skilled in the art could believe that the classification of vertices is accomplished by determining the distance between the vertices representing the spectral peaks and the artificial peaks, such a one, after reading and understanding the disclosure herein described (for example that associated with FIG. 7), will appreciate that the partitioning of the spectral peaks instead depends on the partitioning of the eigenspace responsive to the projection of the vertices within the eigenspace. The \u2018apply confidence-weighted classification to the spectral peaks\u2019 procedure 407 is subsequently described with respect to FIG. 6.",
        "Next an \u2018adjust spectral peak intensities\u2019 procedure 409 adjusts the spectral peak intensities responsive to the results of the \u2018apply confidence-weighted classification to the spectral peaks\u2019 procedure 407 and, in some embodiments, responsive to the intensity ranking of the spectral peaks. This is subsequently described with respect to FIG. 7.",
        "Once the spectral peak intensities in the vertices have been adjusted, an optional \u2018determine possible sequence of molecular subunits\u2019 procedure 411 can be applied to the adjusted spectral peak intensities to create possible sequences of molecular subunits that are consistent with the mass of the parent molecule and the dissociation spectrum data. In addition, or separately, an optional \u2018recreate spectrum\u2019 procedure 412 can recreate a mass-over-charge spectrum based on the adjusted peak intensities, which then can be used by other sequencing processes. Regardless of which combination of the optional \u2018determine possible sequence of molecular subunits\u2019 procedure 411 or the optional \u2018recreate spectrum\u2019 procedure 412 (if any) is used, a \u2018present data\u2019 procedure 413 can be used to present the adjusted peak intensities, the classification of the vertices, the adjusted dissociation spectrum data, and/or results of the optional processes for subsequent processing by other sequencing programs, to store, display, or otherwise present the results; or to present the results of the sequencing of the molecular subunits. One skilled in the art will understand that such a sequencer can generate more than one possible molecular subunit sequence for the parent molecule. Such a one will also understand that adjusted dissociation spectrum data can be generated from the characteristics of the vertices.",
        "The molecular fragment classification process 400 completes through an \u2018end\u2019 terminal 415. One skilled in the art will understand that another spectrum can be processed by restarting the molecular fragment classification process 400. Furthermore, such a one will understand that the molecular fragment classification process 400 lends itself to parallel processor architectures.",
        "FIG. 5 illustrates a \u2018spring system initialization\u2019 process 500 that is one embodiment of the \u2018assign ranking and weighted edges to spectral peaks\u2019 procedure 405 of FIG. 4. The \u2018spring system initialization\u2019 process 500 operates on the spectral data characteristics that have been extracted from the data accessed by the \u2018access dissociation spectrum data\u2019 procedure 403. The \u2018spring system initialization\u2019 process 500 can also include an \u2018estimate parent ion mass\u2019 procedure 503 that estimates the mass of the parent ion using spectral peaks that appear to be complementary pairs. This estimation includes locating the nominal mass of the complex molecule as determined by the tandem mass spectrometer from data provided in the spectral data, summing spectral peak pairs, and if the sum of the spectral peak pair is within a tolerance of the nominal mass, accumulating that sum of the spectral peak pair. Once all relevant spectral peak pair sums are accumulated, a statistical analysis is performed on the accumulated spectral peak pair sums to estimate the mass of the complex molecule.",
        "A \u2018select spectral peaks for spring system vertices\u2019 procedure 505 selects spectral peaks from the spectral data that have a high intensity (relative to those of similar m/z) and that do not appear to be isotopes, doubly charged, or the result of water losses (determined by the spectral peak mass and intensity relationships to nearby spectral peaks). These techniques are known to one skilled in the art.",
        "An \u2018initialize spring system\u2019 procedure 507 allocates sufficient memory to represent a spring system between vertices that represent the spectral peaks selected by the \u2018select spectral peaks for spring system vertices\u2019 procedure 505 as well as any artificial-vertices used in the spring system. An \u2018assign weighted edge between adjacent vertices\u2019 procedure 509 assigns weighted edges between the vertices as is subsequently described with respect to FIG. 9 and FIG. 10.",
        "FIG. 6 illustrates an \u2018apply confidence-weighted classification\u2019 process 600 that applies a confidence-weighted classification process (such as a spectral clustering algorithm) to the spring system that was initialized by the \u2018initialize spring system\u2019 procedure 507. A \u2018create eigenspace\u2019 procedure 603 determines the first two eigenvectors, corresponding to the smallest eigenvalues for the spring system. The first eigenvector is a solution to a least-squares problem of minimizing the potential energy of the spring system in accordance with:",
        "1\n      \n        \n          x\n          t\n        \n        \u2062\n        Dx\n      \n    \n    \u2062\n    \n      (\n      \n        \n          \u2211\n          \n            i\n            ,\n            j\n          \n        \n        \u2062\n        \n          \n            \n              (\n              \n                \n                  x\n                  i\n                \n                -\n                \n                  x\n                  j\n                \n              \n              )\n            \n            2\n          \n          \u2062\n          \n            a\n            ij\n          \n        \n      \n      )\n    \n  \n  =\n  \n    \n      \n        \n          x\n          t\n        \n        \u2061\n        \n          (\n          \n            A\n            -\n            D\n          \n          )\n        \n      \n      \u2062\n      x\n    \n    \n      \n        x\n        t\n      \n      \u2062\n      Dx\n    \n  \n\n\n\n\nwhere A is the matrix of edge weights and D is a diagonal matrix containing the row sums of the absolute values of A's entries.",
        "The second eigenvector is a vibrational mode of the spring system. In one embodiment, the inventors use the first and second eigenvectors to establish a two dimensional eigenspace R that represents the spring system. A \u2018project vertices into eigenspace\u2019 procedure 605 then maps the vertices of the spring system into R. We next fit a reference line L to the vertices in R using, for example, a least squares fit, and then use a line P, orthogonal to L, that passes through the origin of R as a partitioning line. An example R is illustrated in FIG. 11.",
        "Once the partitioning line P is established, an optional \u2018group vertices by partitioning the eigenspace\u2019 procedure 607 can classify the vertices in R into two groups (say as groups S and T) depending on which side of line P the vertex falls. For peptide spectra, vertices in the same group are likely to be the same type (for example, b-ions or y-ions). Although the vertices are separated into S and T groups, it is not known which group contains the y-ions and which group contains the b-ions. In some embodiments (for example those that sequence glycans), the eigenspace need not be partitioned because the rank of the vertex with respect to the reference line L can be sufficient to assist in the sequencing.",
        "FIG. 7 illustrates an \u2018adjust spectral peak intensities\u2019 process 700 that can be one embodiment of the \u2018adjust spectral peak intensities\u2019 procedure 409. The \u2018adjust spectral peak intensities\u2019 process 700 first applies a \u2018complement mass for one group\u2019 procedure 701 to complement each vertex in one of the groups by subtracting the vertex's mass from the parent molecule's mass (and optionally adjusting for any appropriate reaction mass loss/gain). Thus we can complement S to produce S\u2032. Once we have S\u2032, a \u2018rank vertices with respect to fit\u2019 procedure 703 ranks the vertices with respect to line L (lrank\u2014which is the position of the vertex projected along line L). Next, a \u2018reweight spectral peak\u2019 procedure 705 re-weights the spectral peaks responsive to the intensity rank (irank) and lrank:",
        "Intensity\n    \u2061\n    \n      (\n      \n        v\n        i\n      \n      )\n    \n  \n  =\n  \n    \n      1\n      \n        (\n        \n          \n            2\n            \u00b7\n            \n              lrank\n              \u2061\n              \n                (\n                \n                  v\n                  i\n                \n                )\n              \n            \n          \n          +\n          \n            irank\n            \u2061\n            \n              (\n              \n                v\n                i\n              \n              )\n            \n          \n        \n        )\n      \n    \n    .",
        "In protein and peptide analysis (where the spectra often only have two classifications (for example, y-ion and other; or b-ion and other) the \u2018rank vertices with respect to fit\u2019 procedure 703 limits the maximum lrank to that of the maximum lrank resulting from vertices on the positive side of L. Other types of parent molecules may not need this constraint.",
        "In protein and peptide analysis y-ions are often preferred. Thus, additional information can be developed by including the artificial B and Y vertices (see the subsequent discussion with respect to FIG. 9) in the spring system. The half of the eigenspace that contains the artificial B vertex is the half that probably includes the b-ions, while the eigenspace half that contains the artificial Y vertex is probably the half that contains the y-ions. If the artificial B and artificial Y vertices end up in the same eigenspace partition, one can determine the distance from the partition line P to the vertices to break the tie. The inventor has determined that this method correctly identifies b-ions and y-ions at least 70% of the time. While this provides a high probability of resolution for the b/y ambiguity problem, one embodiment will still try both \u201cy-ion half\u201d and \u201cb-ion half\u201d assignments of S and T in order to capture all possible sequences (for example, see the subsequent description with respect to FIG. 8.",
        "Next, a \u2018construct peak graph\u2019 procedure 707 builds a Peak graph from the vertices in S\u2032 and T with edges between two peaks that differ by the mass of one or two amino acid residues (larger amino acid masses are allowed for the initial and final gaps). The Peak graph can be presented to storage, for display, or to another procedure for subsequent processing.",
        "FIG. 8 illustrates a \u2018determine possible sequence of molecular subunits\u2019 process 800 that can use the Peak graph generated by the \u2018construct peak graph\u2019 procedure 707 to determine possible sequences for the parent molecule. A \u2018compute longest path in the Peak graph\u2019 procedure 801 uses well-known techniques for determining the longest path in the Peak graph. Once the longest path is determined, a \u2018generate candidate sequences\u2019 procedure 803 converts the path into candidate sequences for the complex molecule. A subsequent scoring procedure (not shown) can use techniques that are well known to one skilled in the art to rank the candidate sequences with respect to the likelihood that the sequence is correct for the parent molecule. In one embodiment, at least six sequences are generated. These six sequences result from: 1) using S as y-ions and where the sequence ends in R; 2) using S as y-ions and assuming the sequence ends in K; 3) using S as y-ions and assuming the sequence ends in an unknown letter; 4) using T as y-ions and assuming the sequence ends in R; 5) using T as y-ions and assuming the sequence ends in K; and 6) using T as y-ions and assuming the sequence ends in an unknown letter. The sequences can be presented to storage, for display, or to another procedure for subsequent processing.",
        "FIG. 9 illustrates an edge-weighting process 900 that can be invoked at the \u2018assign weighted edge between adjacent vertices\u2019 procedure 509 of FIG. 5 to establish the edge weights for the spring system prior to application of the confidence-weighted classification.",
        "The edge-weighting process 900 is illustrated by pseudocode. Pseudocode is a generic way of describing an algorithm without use of any specific programming language syntax. Pseudocode cannot be executed on a real computer, but it models and resembles real programming code. The pseudocode is provided to aid one skilled in the art understand details of the algorithms. One skilled in the art would understand how to implement these steps using any programming language or methodology. Such a one will also understand that equivalent electronics can embody the techniques described herein. Sections of the pseudocode are extracted into Tables 1-10 and some aspects of the \u201csyntax\u201d of the pseudocode become more clear when the code is combined from the tables.",
        "The weighted edges establish affinities between the vertices in the spring system that represents the spectral peak intensities in the dissociation spectrum data. The edge-weighting process 900 initiates at a start terminal 901 and continues to a \u2018spectral peak\u2019 iteration procedure 903 that traverses the dissociation spectrum data and recognizes each relevant spectral peak. Relevant spectral peaks are, for example, those with an intensity that is above a particular threshold and/or within a range of m/z values. Once a spectral peak is recognized, an \u2018initialize spectral peak vertex\u2019 procedure 905 can allocate storage for the vertex and can assign the spectral peak intensity to the vertex as illustrated in Table 1.",
        "TABLE 1\n\n\n\n\n\n\n\n\n\nFor each peak in spectrum { //extract peak info from spectrum\n\n\n\n\u2003\u2003New vert mz;\n\n\n\n\u2003\u2003mz.intensity = peakvalue;\n\n\n\n\u2003\u2003mz.mass = peakXposition;\n\n\n\n}\n\n\n\nFor each mz in spectrum {mz.irank=irank(mz)}",
        "Once all the spectral peaks are detected from the dissociation spectrum data, a \u2018rank spectral peaks by intensity\u2019 procedure 906 provides an intensity ranking order for each spectral peak wherein, in one embodiment, the most intense spectral peak is given the intensity rank of one, the second most intense spectral peak is given the intensity rank of two, etc.",
        "TABLE 2\n\n\n\n\n\n\n\n\n\nNew vert Art_B;\n// add artificial peaks\n\n\n\nNew vert Art_Y;\n\n\n\nNew vert Art_N;\n\n\n\n\n// init artificial peak edges\n\n\n\n\n\n\n\n\n\nEdge(Art_B, Art_Y).weight = \u22122*Strong;\n\n\n\nEdge(Art_B, Art_N).weight = \u2212Strong;\n\n\n\nEdge(Art_Y, Art_N).weight = \u2212Strong;",
        "An \u2018initialize artificial vertices\u2019 procedure 907 (as illustrated in Table 2) allocates at least two artificial vertices that will be associated with the two classes of ions that we are interested in. In protein and peptide analysis the two classes of ions are b-ions and y-ions. Some embodiments (such as this one) may add another vertex to help attract noise peaks. Edges are established between the artificial vertices. In one embodiment, the edge between the two classification vertices is set to repel each other. Each of the classification vertices also has repelling edges to the noise vertex if it is used.",
        "TABLE 3\n\n\n\n\n\n\n\n\n\nFor any two mz Vsmaller and Vlarger in spectrum {\n\n\n\n\u2003\u2003deltaMass = Vlarger.mass \u2212 Vsmaller.mass;\n\n\n\n\u2003\u2003if (compareMasses(DeltaMass, AminoAcids,Quality)) {\n\n\n\n\u2003\u2003\u2003\u2003edge(Vlarger, Vsmaller).weight += Strong*Quality;\n\n\n\n\u2003\u2003}\n\n\n\n\u2003\u2003if(compareMasses(Vlarger+Vsmaller,ParentMass,Quality)){\n\n\n\n\u2003\u2003\u2003\u2003edge(Vlarger, Vsmaller).weight += \u2212Strong*Quality;\n\n\n\n\u2003\u2003}\n\n\n\n\u2003\u2003if (compareMasses(DeltaMass,AminoAcidpairs,Quality)){\n\n\n\n\u2003\u2003\u2003\u2003edge (Vlarger, Vsmaller).weight += Weak*Quality;\n\n\n\n\u2003\u2003}\n\n\n\n\u2003\u2003if (impossible(deltaMass)) {\n\n\n\n\u2003\u2003\u2003\u2003edge(Vlarger, Vsmaller).weight += \u2212Strong;\n\n\n\n\u2003\u2003}\n\n\n\n}",
        "A \u2018spectral peak pair\u2019 iteration procedure 909 (as illustrated in Table 3) then iterates once over each pair of vertices that correspond to spectral peaks in the dissociation spectrum data. As each pair of vertices is iterated, the edges between the pair are adjusted responsive to a number of conditions. For example, but without limitation, the inventors have determined that good results can be obtained for peptides by weighting the edge between the two vertices in accordance with the following.",
        "An \u2018amino acid residue edge\u2019 check procedure 911 determines how closely the difference in m/z between the spectral peak pairs matches an amino acid residue. If there is a close match, a Strong edge is added between the two spectral peaks. The strength of the edge can be modified by a Quality value that represents how closely the m/z difference between the spectral peaks matches the mass of an amino acid. In the following tables, the Quality variable gives the closeness of the match between the two masses. In one embodiment, Quality equals 1.0 for a perfect match, and decreases to 0.0 at a user-defined tolerance. An appropriate tolerance for an ion-trap mass spectrometer could be 0.4 daltons while an appropriate tolerance for a QTOF instrument could be 0.1 Daltons. In the pseudocode used herein, the edge programmed-method establishes an edge with the specified weight between two vertices if no edge exists. Subsequent edge programmed-method invocations add the specified weight to the existing edge. In both cases the edge weight operand can be indicated by \u201c+=\u201d in the pseudocode. One skilled in the art will understand that there are many different, but equivalent, ways of weighting the edges.",
        "A \u2018complementary spectral peaks edge\u2019 check procedure 913 determines whether sum of the m/z are about the same as the mass of the parent molecule. If so, the weight of the edge is reduced by \u2212Strong (that can be modified by Quality) because the spectral peaks are likely to not have the same classification (that is, it is very likely that one spectral peak represents a b-ion and the other represents a y-ion; thus the two spectral peaks should be encouraged to be in different classifications and this is accomplished by adjusting the edge by a repulsive amount.",
        "An \u2018amino acid pair\u2019 check procedure 915 determines whether the difference in m/z between the spectral peaks matches a pair of amino acid residues. If this is true, the edge is increased by Weak as adjusted by Quality.",
        "An \u2018impossible mass\u2019 check procedure 917 determines whether the difference in m/z between the spectral peaks is not a residue mass or a sum of residue masses. If the difference in m/z between the spectral peaks is not a residue mass or a sum of residue masses, the edge is made less attractive by \u2212Strong.",
        "One skilled in the art will understand that other embodiments can use methods for defining edges other than the establishment of the weighted edge followed by modifications to that edge that are based on characteristics of the spectral peak pair. In addition, other characteristics of the spectral peak pair, or relationships to a third spectral peak, can also be incorporated into the weighted edge between the spectral peak pair.",
        "Once the edges for all spectral peak pairs have been established, the edge-weighting process 900 continues to adjust the edges for each spectral peak (see FIG. 10) as follows:",
        "TABLE 4\n\n\n\n\n\n\n\n\n\nFor each mz Vthis in spectrum {\n\n\n\n\u2003\u2003NoiseEdge=(Strong/rankMax)*min(Vthis.irank\u22121,rankMax);\n\n\n\n\u2003\u2003edge(Vthis, Art_N).weight += NoiseEdge;",
        "Table 4 illustrates a \u2018spectral peak\u2019 iteration procedure 919 that establishes an iteration over vertices that represent the spectral peaks in the dissociation spectrum data. After all selected vertices have been processed, the edge-weighting process 900 completes through an \u2018end\u2019 terminal 921. As each vertex is processed, a \u2018noise edge\u2019 procedure 923 adds an edge between the processed vertex representing a spectral peak and the artificial vertex for noise. The strength of the edge is Strong divided by the maximum intensity rank as adjusted by the rank of the spectral peak. Thus, (assuming rankMax is 100) the highest intensity spectral peak has no edge to noise. While the second highest intensity spectral peak has an edge to noise of 1/100 Strong and the nth intense spectral peak (where n is rankMax+1 or higher) would be Strong.",
        "TABLE 5\n\n\n\n\n\n\n\n\n\nIf (compareMasses(Vthis.mass\u2212protonMass,\n\n\n\n\u2003\u2003\u2003\u2003AminoAcidpairs,Quality)){\n\n\n\n\u2003\u2003edge(Vthis, Art_B).weight += Quality*Weak;\n\n\n\n}",
        "Next, a \u2018b-ion residue pair\u2019 check procedure 925 (illustrated by Table 5) determines whether the spectral peak's m/z minus the proton mass matches an amino acid pair. If so, the weighted edge to Art_B is increased by Weak as adjusted by the mass accuracy (Quality) which is how closely the peak's m/z matches the mass of a pair of amino acids.",
        "TABLE 6\n\n\n\n\n\n\n\n\n\nIf (compareMasses(ParentMass\u2212Vthis.mass,\n\n\n\n\u2003\u2003\u2003\u2003AminoAcidpairs,Quality)) {\n\n\n\n\u2003\u2003edge(Vthis, Art_Y).weight += Quality*Weak;\n\n\n\n}",
        "Next, a \u2018y-ion residue pair\u2019 check procedure 927 (illustrated by Table 6) determines whether the peak's m/z subtracted from the parent molecule's mass matches an amino acid pair. If this is true, the edge weight to Art_Y is increased by Weak as adjusted by Quality.",
        "TABLE 7\n\n\n\n\n\n\n\n\n\nIf (peakExists(Vthis.mass \u2212 27.995,quality)) {\n\n\n\n\u2003\u2003if(compareMasses(Vthis.mass\u2212protonMass,\n\n\n\n\u2003\u2003\u2003\u2003\u2003\u2003AminoAcidpairs,Quality)) {\n\n\n\n\u2003\u2003\u2003\u2003edge(Vthis, Art_B).weight += Strong*Quality;\n\n\n\n\u2003\u2003} else {\n\n\n\n\u2003\u2003\u2003\u2003edge(Vthis,Art_B).weight += Quality*Weak;\n\n\n\n\u2003\u2003}\n\n\n\n}",
        "An \u2018a-ion detection\u2019 conditional procedure 928 (illustrated by Table 7) first determines if a peak exists that is 27.995 less than the current peak (thus indicating that the current spectral peak is a result of an additional carbon monoxide attached to the fragment). If so, a \u2018residue Pair\u2019 conditional procedure 929 determines if the spectral peak mass minus a proton matches the mass of an amino acid pair and if so a \u2018strong edge\u2019 procedure 930 increases the edge between the spectral peak and Art_B by Strong as adjusted by Quality to the mass of a pair of amino acids.",
        "If the \u2018residue Pair\u2019 conditional procedure 929 determines that the spectral peak's mass minus a proton mass does not match an amino acid pair, then a \u2018weak edge\u2019 procedure 931 increases the edge between the spectral peak and Art_B by Weak as adjusted by the Quality of the spectral peak to the mass of a pair of amino acids.",
        "TABLE 8\n\n\n\n\n\n\n\n\n\nif (impossible(Vthis.mass\u2212protonMass)){\n\n\n\n\u2003\u2003edge(Vthis,Art_B).weight += \u2212Strong;\n\n\n\n}",
        "An \u2018impossible b-ion\u2019 check procedure 933 (illustrated by Table 8) determines whether the m/z of the spectral peak minus the mass of a proton is not the mass of a low mass ion. If this is so, the edge's attraction between this vertex and Art_B is reduced by Strong.",
        "TABLE 9\n\n\n\n\n\n\n\n\n\nif (impossible(ParentMass\u2212Vthis.mass)){\n\n\n\n\u2003\u2003edge(Vthis,Art_Y).weight += \u2212Strong\n\n\n\n}",
        "An \u2018impossible y-ion\u2019 check procedure 935 (illustrated by Table 9) determines whether the complement of the m/z of the spectral peak is not the mass of a low mass ion. If so, the attraction of the edge between the vertex and Art_Y is reduced by Strong.",
        "A \u2018double charge ion\u2019 check procedure 937 (illustrated by Table 10) determines if a spectral peak exists at the m/z that is half of the m/z of the spectral peak mass plus the proton mass. If such a spectral peak exists, then the edge from the vertex to Art_Y is increased by Weak.",
        "TABLE 10\n\n\n\n\n\n\n\n\n\n\u2003\u2003if (peakexists((Vthis.mass+protonMass)/2,quality)) {\n\n\n\n\u2003\u2003\u2003\u2003edge(Vthis,Art_Y).weight += Weak;\n\n\n\n\u2003\u2003}\n\n\n\n}",
        "One skilled in the art would understand that additional edge adjustments could be made depending on how well the spectral peak's mass matches the mass of an amino acid triple.",
        "How do we set Weak and Strong? We set Strong to be 6 times Weak, because (at 0.2 Dalton resolution) there are about 6 times as many distinct residue-pair masses as distinct residue masses. In addition, we have determined that graph partitioning is very robust under different weights and that the results are not very sensitive to changes in the weights.",
        "Finally, why is the negative weight between two peaks separated by an impossible mass only Strong rather than much stronger or even infinite? If we use extremely strong impossible edges, then a chemical noise peak with, for example, 3 impossible edges to y-ion peaks and 5 impossible edges to b-ion peaks will be pushed far to the T side (where it will then push away some real y-ions).",
        "FIG. 11 illustrates a two dimensional eigenspace R 1100 using a first eigenvector coordinate 1101 as one coordinate of the eigenspace and a second eigenvector coordinate 1103 as the other coordinate. As was described with respect to FIG. 6, a line L 1105 fit to the vertices' locations in the eigenspace is created and a partitioning line P 1107 orthogonal to the line L 1105 is located at the origin of the two dimensional eigenspace R 1100. Groups S and T are assigned to either side of the partitioning line P 1107.",
        "FIG. 12 illustrates the identification of the vertices resulting from sequencing the spectrum using the techniques disclosed herein for classifying the spectrum's spectral peaks.",
        "FIG. 13 illustrates an analyzed dissociation spectrum data of the peptide KQEYDEAGPSIVHRK 1300. As in FIG. 3, the spectrum includes a plurality of m/z mass spectral peaks 1301. However, now the spectral peaks can be further identified as (for example) a b-ion spectral peak 1303, a y-ion spectral peak 1305, and a noise peak 1307",
        "One skilled in the art will understand that the edge method will create an edge of the specified weight if no edge previously existed between the vertices or will modify an existing edge by the supplied weight.",
        "One skilled in the art will understand that the techniques described herein apply generally to a parent molecule and molecular subunits as well as the peptides and amino acids used to illustrate one embodiment. In particular, a parent molecule can be at least one of a polymer, a lipid, a protein, a peptide and a glycan as well as other molecules that comprise a number of molecular subunits separated by cleavage sites each of which connect one molecular subunit with another molecular subunit.",
        "One skilled in the art will understand that the disclosed technology allows provides advances in the sequencing of complex molecules. Furthermore, from the foregoing, it will be appreciated that the efficient classification or partial classification of spectral peaks has (without limitation) the following advantages:",
        "1) A de novo sequencer can now generate fewer candidate sequences (thus the probability of each sequence being correct can be much higher);",
        "2) Because fewer sequences are generated, a de novo sequencer using the disclosed technology provides a faster generation of a set of sequences that is likely to contain the correct sequence;",
        "3) Because a de novo sequencer using the disclosed technology is faster and more accurate than the existing techniques, such a de novo sequencer can now sequence much longer peptides and even complete proteins;",
        "4) One embodiment modifies spectral peak intensities responsive to the peak classification. This modified spectrum can be presented to existing sequencing programs for processing. Because the modified spectrum is less ambiguous, these programs will be more likely to generate a correct sequence;",
        "5) Increased accuracy of de novo sequencers because of the remarkable success at solving the b/y ambiguity problem associated with dissociation spectra of proteins and peptides.",
        "6) Provides a computationally efficient and robust solution to the peak classification problem.",
        "7) The strongest class (largest number of intense peaks) repels all the others, and the attraction between noise peaks (such as internal fragments that are separated by residue masses) aids in the classification of the peaks.",
        "8) Some spectra have more than three classes; this can occur if there is more than one peptide or if there are many internal fragments (contiguous subsequences from the middle of the residue sequence). Such spectra are difficult for the pure longest-path prior approaches, which can easily \u201cjump tracks\u201d from one peptide to another. This problem is reduced by robust classification of the spectral peaks.",
        "Although the claimed technology has been described in terms of the presently preferred embodiments, one skilled in the art will understand that various modifications and alterations may be made without departing from the scope of the claims. Accordingly, the claims are not to be limited to the particular embodiments discussed herein."
    ],
    "citations": [
        "5538897",
        "6017693",
        "6582965",
        "6963807",
        "2006/0136158"
    ],
    "us_classification": "250282",
    "international_classifications": [
        {
            "classification_level": "A",
            "section": "B",
            "classification_class": "01",
            "subclass": "D",
            "main_group": "59",
            "subgroup": "44"
        }
    ]
}