{
    "title": "Method and apparatus for removing flicker from images",
    "abstract": "Method and apparatus for removing image artifacts from an image of a scene illuminated by a periodically varying light source such as a fluorescent light source. The image is represented by image data, and the method has the steps of determining a flicker function and processing the image data using the flicker function to remove the image artifacts from the image. The method and apparatus operate on data of a single image, do not require any additional input other than values of the flicker and frame periods, and do not require that the flicker be independently monitored. The method and apparatus is suitable for removing image artifacts from an image represented by image data collected by a CMOS image sensor utilizing a rolling shutter.",
    "inventors": [
        "Baer"
    ],
    "document_number": "07298401",
    "publication_date": "20071120",
    "assignees": [
        "Micron Technology, Inc."
    ],
    "claims": [
        {
            "claim_number": "CLM-00001",
            "preamble": "1. A method for removing image artifacts from an image of a scene illuminated by a light source, said image represented by image data, the method comprising;",
            "components": [
                {
                    "component": "determining a flicker function, wherein said flicker function is a function of flicker frequency, determined from a product of the frame period and a line frequency in cycles per image frame of said light source, flicker amplitude and flicker phase of said light source, and",
                    "subcomponents": []
                },
                {
                    "component": "processing said image data using said flicker function so as to remove image artifacts from said image, wherein said image data comprises an image data array comprised of a plurality of rows of image data, and wherein said processing step comprises dividing said image data by said flicker function on a row-by-row basis.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00002",
            "preamble": "2. The method according to claim 1 , wherein said step of determining a flicker function includes determining the flicker frequency from a product of frame period and AC line frequency in cycles per image frame.",
            "components": []
        },
        {
            "claim_number": "CLM-00003",
            "preamble": "3. The method according to claim 2 , wherein said step of determining a flicker function further includes summing pixels of said image data array along every row of said array to create a column vector, and further includes determining said flicker phase and said flicker amplitude by minimizing flicker energy in a corrected column vector.",
            "components": []
        },
        {
            "claim_number": "CLM-00004",
            "preamble": "4. The method according to claim 3 , wherein said step of minimizing flicker energy in a corrected column vector comprises:",
            "components": [
                {
                    "component": "making an estimate of flicker amplitude and phase;",
                    "subcomponents": []
                },
                {
                    "component": "computing a corrected column vector by dividing the created column vector by a flicker function calculated using the determined flicker frequency and the estimated flicker amplitude and phase;",
                    "subcomponents": []
                },
                {
                    "component": "calculating the flicker energy in the corrected column vector;",
                    "subcomponents": []
                },
                {
                    "component": "determining whether the flicker energy can be further reduced; and",
                    "subcomponents": []
                },
                {
                    "component": "if the flicker energy cannot be further reduced, using the estimated flicker amplitude and phase to determine the flicker function, and, if the flicker energy can be further reduced, repeating the steps of making an estimate of flicker amplitude and phase, computing a corrected column vector and calculating the flicker energy until the flicker energy cannot be reduced any further.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00005",
            "preamble": "5. The method according to claim 1 , wherein said light source comprises a periodically varying light source.",
            "components": []
        },
        {
            "claim_number": "CLM-00006",
            "preamble": "6. The method according to claim 5 , wherein said periodically varying light source comprises a fluorescent light source.",
            "components": []
        },
        {
            "claim_number": "CLM-00007",
            "preamble": "7. The method according to claim 6 , wherein said flicker function, expressed in terms of row number of the rows of said image data array, is:",
            "components": [
                {
                    "component": "",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00008",
            "preamble": "8. The method according to claim 1 , wherein said image data is collected from a CMOS image sensor utilizing a rolling shutter to provide exposure control.",
            "components": []
        },
        {
            "claim_number": "CLM-00009",
            "preamble": "9. A method for removing image artifacts from an image of a scene illuminated by a periodically varying light source, said image represented by an image data array comprising a plurality of rows of image data, the method comprising:",
            "components": [
                {
                    "component": "determining a flicker function that models light emission of the periodically varying light source, wherein said flicker function is a function of flicker amplitude, flicker frequency and flicker phase of the periodically varying light source, and",
                    "subcomponents": []
                },
                {
                    "component": "processing said image data using said flicker function so as to remove said image artifacts from said image, wherein said step of determining a flicker function includes summing pixels along every row of the image data array to create a column vector, determining the flicker frequency from a product of frame period and AC line frequency in cycles per image frame, and determining flicker amplitude and phase by minimizing flicker energy in a corrected column vector.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00010",
            "preamble": "10. The method according to claim 9 , wherein said step of minimizing flicker energy in a corrected column vector comprises:",
            "components": [
                {
                    "component": "making an estimate of flicker amplitude and phase;",
                    "subcomponents": []
                },
                {
                    "component": "computing a corrected column vector by dividing the created column vector by a flicker function calculated using the determined flicker frequency and the estimated flicker amplitude and phase;",
                    "subcomponents": []
                },
                {
                    "component": "calculating the flicker energy in the corrected column vector;",
                    "subcomponents": []
                },
                {
                    "component": "determining whether the flicker energy can be further reduced; and",
                    "subcomponents": []
                },
                {
                    "component": "if the flicker energy cannot be further reduced, using the estimated flicker amplitude and phase to determine the flicker function, and, if the flicker energy can be further reduced, repeating the steps of making an estimate of flicker amplitude and phase, computing a corrected column vector and calculating the flicker energy until the flicker energy cannot be reduced any further.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00011",
            "preamble": "11. The method according to claim 9 , wherein said image data is collected from a CMOS image sensor utilizing a rolling shutter to provide image control.",
            "components": []
        },
        {
            "claim_number": "CLM-00012",
            "preamble": "12. A method for removing image artifacts from an image of a scene illuminated by a periodically varying light source, said image represented by an image data array comprising a plurality of rows of image data, the method comprising:",
            "components": [
                {
                    "component": "determining a flicker function that models light emission of the periodically varying light source, wherein said flicker function is a function of flicker amplitude, flicker frequency and flicker phase of the periodically varying light source, and",
                    "subcomponents": []
                },
                {
                    "component": "processing said image data using said flicker function so as to remove said image artifacts from said image, wherein said periodically varying light source comprises a fluorescent light source, and wherein said flicker function, expressed in terms of row number of the rows of said image data array is:",
                    "subcomponents": [
                        ""
                    ]
                },
                {
                    "component": "",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00013",
            "preamble": "13. Apparatus for removing image artifacts from an image of a scene illuminated by a light source, comprising:",
            "components": [
                {
                    "component": "a unit for providing image data representing said scene:",
                    "subcomponents": []
                },
                {
                    "component": "a flicker function determiner for determining a flicker function, wherein said flicker function is a function of flicker frequency, determined from a product of the frame period and a line frequency in cycles per image frame of said light source, flicker amplitude and flicker phase of said light source, and wherein said flicker function determiner includes means for determining said flicker frequency, said flicker amplitude and said flicker phase; and",
                    "subcomponents": []
                },
                {
                    "component": "an image data processor that processes said image data using said flicker function to remove said image artifacts from said image, wherein said image data comprises an image data array comprised of a plurality of rows of image data, and wherein said image data processor processes said image data by dividing said image data by said flicker function on a row-by-row basis.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00014",
            "preamble": "14. The apparatus according to claim 13 , wherein said light source comprises a fluorescent light source.",
            "components": []
        },
        {
            "claim_number": "CLM-00015",
            "preamble": "15. A digital imaging method comprising the steps of:",
            "components": [
                {
                    "component": "determining a flicker function by analyzing a digital image; and",
                    "subcomponents": []
                },
                {
                    "component": "processing said digital image using said flicker function so as to reduce image artifacts from said digital image, wherein said determining step involves determining values of parameters associated with an a priori flicker model, wherein said parameters comprise a flicker frequency, determined from a product of the frame period and a line frequency in cycles per image frame, a flicker amplitude and a flicker phase, and wherein said processing step involves dividing said digital image by said flicker function.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00016",
            "preamble": "16. The digital imaging method according to claim 15 , wherein said step of determining flicker frequency, flicker amplitude and flicker phase comprises summing pixels along every row of the image data array to create a column vector, determining the flicker frequency from a product of frame period and AC line frequency in cycles per image frame; and determining flicker amplitude and phase by minimizing flicker energy in a corrected column vector.",
            "components": []
        },
        {
            "claim_number": "CLM-00017",
            "preamble": "17. The digital imaging method according to claim 16 , wherein said step of minimizing flicker energy in a corrected column vector comprises:",
            "components": [
                {
                    "component": "making an estimate of flicker amplitude and phase;",
                    "subcomponents": []
                },
                {
                    "component": "computing a corrected column vector by dividing the created column vector by a flicker function calculated using the determined flicker frequency and the estimated flicker amplitude and phase;",
                    "subcomponents": []
                },
                {
                    "component": "calculating the flicker energy in the corrected column vector;",
                    "subcomponents": []
                },
                {
                    "component": "determining whether the flicker energy can be further reduced; and",
                    "subcomponents": []
                },
                {
                    "component": "if the flicker energy cannot be further reduced, using the estimated flicker amplitude and phase to determine the flicker function, and, if the flicker energy can be further reduced, repeating the steps of making an estimate of flicker amplitude and phase, computing a corrected column vector calculating the flicker energy until the flicker energy cannot be reduced any further.",
                    "subcomponents": []
                }
            ]
        }
    ],
    "description": [
        "1. Technical Field of the Invention",
        "The present invention relates generally to the image processing field; and, more particularly, to a method and apparatus for removing image artifacts from images that are produced by a periodically varying light source.",
        "2. Description of Related Art",
        "In a CMOS (Complementary Metal Oxide Semiconductor) active-pixel image sensor, a rolling shutter is commonly used to provide exposure control. A rolling shutter may be implemented by sequentially resetting each row of sensors in an image sensor array and sequentially reading the values of each row at a later time. The exposure period is equal to the interval between reset and read out, and the frame period is the time required to read the values of every row in the array.",
        "FIG. 1 is a diagram that schematically illustrates the operation of a rolling shutter to assist in providing a clear understanding of the present invention. Consider an image data array having 100 rows (for clarity, only 9 rows are illustrated in FIG. 1). Assume that the time required to read out a single row, i.e., the row period, is T; and that the exposure period, illustrated by arrow 10 in FIG. 1, is set to n*T. The exposure of row 1 will begin at time t=0, and the row will be read out at time t=n*T. The exposure of row 2 will begin at time t=T, and row 2 will be read out at time t=(n+1)*T. Row 100 of the array will begin exposure at time t=99*T, and that row will be read out at time t=(n+99)*T.",
        "One characteristic of a rolling shutter is that the exposure for each row occurs over a different time interval as is shown in FIG. 1. Accordingly, if the illumination of a scene varies with time, the brightness of the captured image will vary from row to row. If the period of the variation in the illumination level of the scene is longer than the integration period of the rolling shutter and shorter than the frame period, the variation will result in the appearance of image artifacts in the form of horizontal bands in the image. The number of bands in the image will be equal to a flicker period divided by the frame period.",
        "These variations in the illumination level of a light source over time are known as \u201cflicker\u201d, and the horizontal bands in the image are referred to as image artifacts or as a \u201cflicker pattern\u201d. Fluorescent lamps, for example, have very strong flicker. The phosphors in the lamp are excited at each peak of the power line frequency and decay between peaks. The light pulses that are produced have a flicker frequency that is twice that of the AC power line. Incandescent bulbs do not exhibit flicker because the thermal masses of their filaments are sufficiently large to prevent the filaments from cooling significantly between AC peaks. The effect of flicker on the output of a CMOS image sensor is illustrated in the schematic image 14 of FIG. 2 in which the periodic horizontal bars 16 are quite apparent and significantly detract from the overall quality of the image.",
        "The number of horizontal bars in an image such as shown in FIG. 2 is equal to the ratio of the frame period to the flicker period. The amplitude of the horizontal bars depends on characteristics of the particular light source and on the integration period of the rolling shutter of the CMOS image sensor.",
        "Several methods have been devised to remove frame-to-frame flicker. For example, U.S. Pat. No. 5,793,886 discloses a method in which the histograms of different image frames are compared so that the variation in the mean illumination level as a function of time can be removed. The method described, however, does not apply to a situation wherein only a single image frame is available and wherein the flicker is manifested as a series of horizontal bands in the resulting image.",
        "In other known methods to remove frame-to-frame flicker, the light level of the illuminant is monitored during the frame exposure. For example, in the method described in U.S. Pat. No. 6,208,433; a separate sensor is used to monitor the fluctuations of the illuminant; and the output of this sensor is used to correct the image. In U.S. Pat. No. 5,960,153, a linear image sensor is used to both capture the image and to measure the illuminant variation. The illuminant variation is used to control the exposure timing so that flicker does not appear in the final image.",
        "In yet another known method, flicker is avoided by restricting the exposure period to integer multiples of the flicker period. Under such circumstances, each row integrates light over an integer number of complete cycles of the illuminant's fluctuation. As a result, the integrated light level is caused to be the same for each row, and bands are prevented from appearing in the image. A disadvantage of this method is that the exposure period cannot be reduced below the flicker period. If the illuminant is very bright, and the exposure period cannot be reduced; the resulting image will be overexposed. Such a problem may occur when a scene is illuminated with bright fluorescent lights or when the camera is pointed directly at a fluorescent light.",
        "In general, known methods for removing frame-to-frame flicker from an image require several successive image frames for processing, require that the flicker be independently monitored, or require additional inputs. Accordingly, known methods for removing flicker are not fully satisfactory. What is needed is a method and apparatus for removing flicker produced by a periodically varying light source that operates on a single image, that does not require any additional input, other than values of the flicker and frame periods, and that does not require that the flicker be independently monitored. What is also needed is a method and apparatus that can be effectively used to capture images with greatly reduced flicker even under very bright fluorescent illumination.",
        "The present invention provides a method and apparatus for removing image artifacts from an image produced by a periodically varying light source, such as a fluorescent light source. A method according to the invention provides for removing image artifacts from an image represented by image data. In the method, a flicker function is determined; and the image data is processed using the flicker function to remove the image artifacts.",
        "In the course of the present invention, it has been discovered that image artifacts can be removed from or greatly reduced in an image by processing the image data with a flicker function that models light emission of the light source that illuminates a scene being imaged. The invention is particularly suitable for removing image artifacts from images represented by image data collected from a CMOS image sensor utilizing a rolling shutter.",
        "According to an embodiment of the present invention, the image data representing the image comprises an image data array comprised of a plurality of rows of image data, and the step of processing the image data comprises dividing the image data by the flicker function on a row-by-row basis.",
        "Determining the flicker function of the image data involves determining values of parameters associated with an a priori flicker model. In particular, to determine the flicker function, the flicker frequency, flicker amplitude and flicker phase of the light source are determined. According to an embodiment of the invention, the flicker frequency, flicker amplitude and flicker phase are determined by summing the pixels along every row of the image data array to create a column vector, determining the flicker frequency from the product of the frame period and the AC line frequency in cycles per image frame, and determining the flicker amplitude and phase by minimizing flicker energy in a corrected column vector.",
        "More particularly, the flicker amplitude and phase are determined, according to a further embodiment of the invention, by making an initial estimate of the flicker amplitude and phase, computing a corrected column vector by dividing the created column vector by a flicker function computed from the determined flicker frequency and the estimated flicker amplitude and phase, and calculating the flicker energy in the corrected column vector. It is then determined if the flicker energy can be further reduced. If not, the estimated flicker amplitude and phase are used to determine the flicker function. If yes, the estimates of the flicker amplitude and phase are improved, a further corrected column vector is computed, and the flicker energy is calculated using the further corrected column vector. The procedure is repeated until the flicker energy cannot be further reduced.",
        "Once the flicker energy has been minimized, the flicker can be removed from the image data by dividing the image data by the determined flicker function.",
        "The method of the present invention has the advantage of being effective in removing flicker produced by any periodically varying light source such as a fluorescent light source. Any exposure period can be used with the method of the invention; and, as a result, the method can be used to capture images with greatly reduced flicker under even bright fluorescent illumination. The present invention provides a method and apparatus for removing image artifacts from images that operate on a single image, that do not require any additional input other than values of the flicker and frame periods, and that do not require that the flicker be independently monitored. Furthermore, the invention provides embodiments with other features and advantages in addition to or in lieu of those described above. Many of these features and advantages are apparent hereinafter in conjunction with the following drawings and detailed description of exemplary embodiments of the invention.",
        "FIG. 1 is a diagram that schematically illustrates the operation of a rolling shutter to assist in providing a clear understanding of the present invention;",
        "FIG. 2 is a schematic image that illustrates the effect of flicker on the output of a CMOS image sensor utilizing a rolling shutter;",
        "FIG. 3 is a graph that illustrates the emission characteristics of a fluorescent tube;",
        "FIG. 4 is a graph that illustrates a flicker correction according to an embodiment of the present invention;",
        "FIGS. 5 and 6 are images that demonstrate the effectiveness of a method and apparatus according to an embodiment of the present invention. FIG. 5 is an image of raw data from a single color plane of a CMOS image sensor utilizing a rolling shutter, and FIG. 6 is an image achieved as a result of applying a flicker correction according to an embodiment of the present invention;",
        "FIG. 7 is a flow chart illustrating steps of a method for removing image artifacts from an image according to an embodiment of the present invention;",
        "FIG. 8A is a flow chart illustrating the step of determining flicker function in FIG. 7 in greater detail, according to another embodiment of the present invention;",
        "FIG. 8B is a flow chart illustrating the step of determining flicker phase and amplitude in FIG. 8A in greater detail, according to another embodiment of the present invention; and",
        "FIG. 9 schematically illustrates an apparatus for removing image artifacts from an image according to another embodiment of the present invention.",
        "In a CMOS image sensor operating in a rolling shutter mode, the exposure interval of an image data array varies from row to row in the array as shown in FIG. 1 (although within a particular row, all pixels are exposed over the same interval). If the intensity of the light source illuminating a scene being imaged varies over time, row-to-row light intensity variations may result in the image data. If the row interval is fixed and the intensity of the light source varies periodically with time, the intensity variations will appear as image artifacts in the form of periodic horizontal bars in an image created from the image data.",
        "If the integration period is made equal to an integer multiple of the flicker period, the amplitude of the horizontal bars will be zero. An a priori determination of the amplitude of the bars is generally not possible, however, because the characteristics of the light source are not known. In addition, the vertical alignment of the horizontal bar pattern with respect to the image is dependent on the phase of the light flicker at the beginning of the exposure interval; however, similar to the amplitude, the phase also cannot be determined in advance.",
        "The flickering of a fluorescent light is caused by the alternation of the power supply of the light. A fluorescent tube contains a filament that emits electrons into a cloud of mercury vapor atoms. The vapor atoms become excited and emit ultraviolet (UV) light. When the UV light strikes the envelope of the fluorescent tube, the UV light excites phosphors on the inside surface of the tube. The phosphors then fluoresce and emit white light.",
        "The emission of electrons is maximized at the peaks of the drive voltage of the power source. Since there are two peaks per cycle, the flicker frequency becomes twice the drive voltage frequency. Accordingly, a fluorescent tube that is powered by a 60 Hz electrical system will flicker at 120 Hz.",
        "The function (1+\u03b1 sin2(\u03c9t+\u03a6)) can be used to model the emission of a fluorescent tube. In this expression, a is the flicker amplitude, \u03c9 is the flicker frequency, and \u03a6 is the flicker phase. The flicker function can also be expressed in terms of the row number of the rows in an image array as follows:\n\nf(j)=1+\u03b1 sin2(j\u03c9Tf/N+\u03a6)\u2003\u20031\n\nIn this expression, Tf is the frame period, and N is the number of lines per frame. The actual emission of a fluorescent tube has a more complicated time variation as illustrated by the curve 20 in FIG. 3 which is a graph in which the x-axis represents a time sample and the y-axis represents illumination. This function decays slowly because of the characteristics of the phosphors and the filament in the fluorescent tube. Accordingly, a more complicated flicker function than given in Equation (1) above could be created, if desired, to better match the curve.",
        "According to an embodiment of the present invention, the image artifacts are removed from an image by dividing the image data representing the image by the flicker function on a row-by-row basis. If the image is represented by the two-dimensional data array I[i, j], the operation of removing the image artifacts is described by:\n\nI\u2032[I,j]=I[i,j]/f(j).\u2003\u20032",
        "The flicker function, according to an embodiment of the invention, is determined by determining the flicker frequency, flicker amplitude and flicker phase of the of the illuminating light source. The flicker frequency, flicker amplitude and flicker phase are determined, according to an embodiment of the invention, by summing pixels along every row of the digital image to create a column vector, determining the flicker frequency from the product of the frame period and the AC line frequency in cycles per image frame, and determining the flicker amplitude and phase by minimizing flicker energy in a corrected column vector.",
        "More particularly, to create a column vector, all of the columns of the image data array are added together to produce a column average. This operation collapses the two-dimensional image data array into a one-dimensional vector. The operation can be described by the following equation:",
        "C\n          \u2061\n          \n            [\n            j\n            ]\n          \n        \n        =\n        \n          \n            1\n            M\n          \n          \u2062\n          \n            \n              \u2211\n              i\n            \n            \u2062\n            \n              I\n              \u2061\n              \n                [\n                \n                  i\n                  ,\n                  j\n                \n                ]\n              \n            \n          \n        \n      \n    \n    \n      3\n    \n  \n\n\n\n\nIn this equation, M is the number of columns in the image data.",
        "To minimize the flicker energy in a corrected column vector in order to determine the flicker amplitude and phase, an initial estimate is first made of the flicker amplitude and phase. A corrected column vector is then computed by dividing the created column vector by a flicker function calculated from the determined flicker frequency and the estimated flicker amplitude and phase. The flicker energy is then calculated in the corrected column vector, and a determination is made whether the flicker energy can be reduced any further. If not, the estimated flicker amplitude and phase are used to determine the flicker function. If yes, an improved estimate of the flicker amplitude and phase are made, and the process is repeated until the flicker energy cannot be reduced any further.",
        "The flicker energy in the corrected column vector is determined by computing the sine and cosine transforms of C[j]/f(j). The energy is the square root of the square of the two terms, normalized by the mean value of the image data.",
        "Xs\n        =\n        \n          \n            \u2211\n            j\n          \n          \u2062\n          \n            \n              A\n              \u2061\n              \n                (\n                j\n                )\n              \n            \n            \u2062\n            \n              sin\n              \u2061\n              \n                (\n                \n                  j\u03c9\n                  \u2062\n                  \n                    \n                  \n                  \u2062\n                  \n                    \n                      T\n                      f\n                    \n                    /\n                    N\n                  \n                \n                )\n              \n            \n            \u2062\n            \n              \n                C\n                \u2061\n                \n                  [\n                  j\n                  ]\n                \n              \n              /\n              \n                f\n                \u2061\n                \n                  (\n                  j\n                  )\n                \n              \n            \n          \n        \n      \n    \n    \n      4\n    \n  \n  \n    \n      \n        Xc\n        =\n        \n          \n            \u2211\n            j\n          \n          \u2062\n          \n            \n              A\n              \u2061\n              \n                (\n                j\n                )\n              \n            \n            \u2062\n            \n              cos\n              \u2061\n              \n                (\n                \n                  j\u03c9\n                  \u2062\n                  \n                    \n                  \n                  \u2062\n                  \n                    \n                      T\n                      f\n                    \n                    /\n                    N\n                  \n                \n                )\n              \n            \n            \u2062\n            \n              \n                C\n                \u2061\n                \n                  [\n                  j\n                  ]\n                \n              \n              /\n              \n                f\n                \u2061\n                \n                  (\n                  j\n                  )\n                \n              \n            \n          \n        \n      \n    \n    \n      5",
        "In equations (4) and (5), A(j) is an apodization function that is used to prevent discontinuities at the edges of the image frame from contributing to the energy value. Examples of such functions include the Hanning and Hamming functions.",
        "The flicker energy is:",
        "E\n          f\n        \n        =\n        \n          \n            \n              Xs\n              +\n              Xc\n            \n          \n          /\n          \n            \u2329\n            C\n            \u232a\n          \n        \n      \n    \n    \n      6\n    \n  \n\n\n\n\nIn equation (6), the image data mean has been determined from the column averages.",
        "The surface defined by the variation of the flicker energy as a function of amplitude and phase is plotted in FIG. 4 in which the x-axis represents magnitude and the y-axis represents phase. As illustrated in FIG. 4, the function is smooth with a well-defined, unique minimum.",
        "Once the flicker energy has been minimized, image artifacts can be removed from the entire image by dividing the image data by the determined flicker function, using the calculated values of flicker frequency and the values of flicker phase and amplitude that result from the minimization.",
        "FIGS. 5 and 6 are images that demonstrate the effectiveness of the method according to an embodiment of the present invention. The image of FIG. 5 consists of raw data from a single color plane of a CMOS image sensor, i.e, an original image. The image of FIG. 6 is the result of applying the flicker correction according to an embodiment of the present invention, i.e., a flicker corrected image. As is apparent from examining FIGS. 5 and 6, the horizontal lines present in the image of FIG. 5 have been eliminated in the image of FIG. 6.",
        "FIG. 7 is a flow chart that generally illustrates a method for removing image artifacts from an image of a scene according to an embodiment of the invention. As shown in FIG. 7, the method comprises determining a flicker function that models light emission of a light source that illuminates the scene in step 30; and, thereafter, processing the image data that represents the image of the scene using the flicker function in step 40.",
        "FIG. 8A is a flow chart that illustrates the step of determining the flicker function in FIG. 7 in greater detail according to another embodiment of the invention. In particular, as discussed previously, to determine the flicker function of a light source that illuminates a scene being imaged, the flicker frequency, the flicker amplitude and the flicker phase of the light source are determined. This is accomplished as disclosed in FIG. 8A by first summing the pixels of the image array along every row of the image array to create a column vector as illustrated in step 50. The flicker frequency is determined from the product of the frame period and the AC line frequency in cycles per image frame as shown in step 60. The flicker phase and the flicker amplitude are determined by minimizing flicker energy in a corrected column vector as shown in step 70.",
        "The step of determining flicker phase and amplitude shown in FIG. 8A is described in greater detail in FIG. 8B. Specifically, an initial estimate of the flicker amplitude and phase is made as shown in step 72. Thereafter, a corrected column vector is computed by dividing the column vector created in step 50 of FIG. 8A by an estimated flicker function in step 74. The estimated flicker function is computed using the flicker frequency determined in step 60 of FIG. 8A and the flicker amplitude and flicker phase estimated in step 72 of FIG. 8B. The flicker energy in the corrected column vector is then calculated in step 76, and a determination is made whether the flicker energy can be further reduced in step 78. If no, the initial estimate of flicker amplitude and phase made in step 72 is used to determine the flicker function. If yes, an improved estimate of the flicker amplitude and phase is made in step 80, a further corrected column vector is computed in step 74, and a new flicker energy is calculated in step 76. The procedure is repeated until the flicker energy cannot be reduced any further, i.e., a no determination is made in step 78.",
        "FIG. 9 schematically illustrates an apparatus for removing image artifacts from an image of a scene according to an embodiment of the present invention. The apparatus comprises an imaging device, such as a digital camera, generally designated by reference number 100. The imaging device includes optical system 102, represented by a lens in FIG. 9, for receiving light from a scene and for focussing the light on an image sensing unit 104, such as a CMOS image sensor. The image sensing unit converts the light pattern thereon into an array of voltage samples that are digitized by an analog-to-digital converter that may be included in the image sensing unit.",
        "A flicker function determiner 106, determines the flicker function of the light source from the digital image data by determining the flicker frequency, flicker amplitude and flicker phase of the light source as described previously; and an image data processor 108 processes the image data using the flicker function to remove image artifacts from a resultant image of the scene.",
        "While what has been described constitutes exemplary embodiments of the invention, it should be recognized that the invention can be varied in numerous ways without departing from the scope thereof. Accordingly, it should be understood that the invention should be limited only insofar as is required by the scope of the following claims."
    ],
    "citations": [
        "4774588",
        "5293238",
        "5793886",
        "5960153",
        "6208433",
        "6271884",
        "6295085",
        "6507365",
        "6573933",
        "6710818",
        "6882363",
        "1 324 598",
        "11-252446",
        "2000004382",
        "2000165752"
    ],
    "us_classification": "3482261",
    "international_classifications": [
        {
            "classification_level": "A",
            "section": "H",
            "classification_class": "04",
            "subclass": "N",
            "main_group": "9",
            "subgroup": "73"
        }
    ]
}