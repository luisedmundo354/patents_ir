{
    "title": "Process method about the service connection between the wireless local area network and user terminal",
    "abstract": "Disclosed is a method for processing the service connection between a user terminal and a Wireless Local Area Network (WLAN) applicable to a WLAN interactive network that at least comprises: a WLAN user terminal, a WLAN access unit, a service control unit and a user information storage unit. The method comprises: setting flags that represent the attached or detached status of the service connection between the user terminal and the WLAN in the WLAN user terminal and the service control unit respectively; establishing or canceling the connection between the user terminal and the network through the interaction between the WLAN user terminal and the WLAN, meanwhile modifying the corresponding flags.",
    "inventors": [
        "Zhang",
        "Duan"
    ],
    "document_number": "07298726",
    "publication_date": "20071120",
    "assignees": [
        "Huawei Technologies Co., Ltd."
    ],
    "claims": [
        {
            "claim_number": "CLM-00001",
            "preamble": "1. A method for processing a service connection between a WLAN and a WLAN user terminal, applicable to a WLAN interactive network at least including the WLAN user terminal, a WLAN access unit, a service control unit and a user information storage unit, comprising:",
            "components": [
                {
                    "component": "setting a first flag and a second flag representing either an attached status or a detached status for the service connection between the user terminal and the WLAN respectively in the WLAN user terminal and the service control unit; and",
                    "subcomponents": []
                },
                {
                    "component": "establishing or canceling the service connection between the user terminal and the WLAN based on at least an interaction between the WLAN user terminal and the WLAN, and modifying the first flag and the second flag;",
                    "subcomponents": []
                },
                {
                    "component": "wherein the process for establishing the service connection between the user terminal and the WLAN includes attaching the WLAN user terminal to the WLAN, the process for attaching the WLAN user terminal to the WLAN further comprising:",
                    "subcomponents": []
                },
                {
                    "component": "a",
                    "subcomponents": []
                },
                {
                    "component": "a",
                    "subcomponents": []
                },
                {
                    "component": "wherein said attach request includes a permanent or temporary identification of the WLAN user terminal; on receiving the attach request, the service control unit determining whether the permanent or temporary identification of the user terminal in the attach request is valid; if not, the service control unit initiating a request procedure to the user terminal to fetch a valid flag of the user terminal; otherwise, the service control unit determining whether itself has stored user information of the user terminal sending the attach request; if there is no such information, the service control unit sending a request for the user information of the user terminal to the user information storage unit; otherwise, performing the process a",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00002",
            "preamble": "2. The method according to claim 1 , wherein said process for determining whether to allow the WLAN user terminal to establish the service connection is implemented by an authentication procedure.",
            "components": []
        },
        {
            "claim_number": "CLM-00003",
            "preamble": "3. The method according to claim 1 , further comprising: on receiving the access response sent by the service control unit, the WLAN user terminal modifying the first flag, indicating that the service connection between the WLAN user terminal and the WLAN has been successfully established.",
            "components": []
        },
        {
            "claim_number": "CLM-00004",
            "preamble": "4. The method according to claim 1 , further comprising: setting in the user information storage unit a third flag that indicates the service connection status between the WLAN user terminal and the WLAN; the service control unit recording the service connection stabs of the WLAN user terminal and then sending a user data updating instruction to the user information storage unit; the user information storage unit updating the service connection status of the user terminal on receiving the instruction, and then returning a user data updating response to the service control unit.",
            "components": []
        },
        {
            "claim_number": "CLM-00005",
            "preamble": "5. The method according to claim 4 , when the service connection status of the user terminal is changed to WLAN attached, the method further comprising:",
            "components": [
                {
                    "component": "c",
                    "subcomponents": []
                },
                {
                    "component": "c",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00006",
            "preamble": "6. The method according to claim 4 , when the service connection status of the user is changed to WLAN detached, the method further comprising:",
            "components": [
                {
                    "component": "c",
                    "subcomponents": []
                },
                {
                    "component": "c",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00007",
            "preamble": "7. The method according to claim 4 , when the service connection status of the user is changed to WLAN detached, the method further comprising:",
            "components": [
                {
                    "component": "c",
                    "subcomponents": []
                },
                {
                    "component": "c",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00008",
            "preamble": "8. The method according to claim 7 , wherein the process for deleting user data comprises deleting information of the WLAN user terminal from the service control unit immediately after the WLAN user terminal is disconnected from the WLAN.",
            "components": []
        },
        {
            "claim_number": "CLM-00009",
            "preamble": "9. The method according to claim 7 , wherein the process for deleting user data comprises keeping, after the WLAN user terminal is disconnected from the WLAN, information of the WLAN user terminal in the service control unit for a certain period of time before deleting the information.",
            "components": []
        },
        {
            "claim_number": "CLM-00010",
            "preamble": "10. A method for processing a service connection between a WLAN and a WLAN user terminal, applicable to a WLAN interactive network at least including the WLAN user terminal, a WLAN access unit, a service control unit and a user information storage unit, comprising:",
            "components": [
                {
                    "component": "setting a first flag and a second flag representing either an attached status or a detached status for the service connection between the user terminal and the WLAN respectively in the WLAN user terminal and the service control unit; and",
                    "subcomponents": []
                },
                {
                    "component": "establishing or canceling the service connection between the user terminal and the WLAN based on at least an interaction between the WLAN user terminal and the WLAN, and modifying the first flag and the second flag;",
                    "subcomponents": []
                },
                {
                    "component": "wherein said process for canceling the service connection between the user terminal and the WLAN includes detaching the WLAN user terminal from the WLAN, and",
                    "subcomponents": []
                },
                {
                    "component": "the process for detaching the WLAN user terminal from the WLAN further comprising: the WLAN user terminal detaching from the WLAN, canceling the service connection, and the service control unit recording the service connection status of the WLAN user terminal as WLAN detached; the process for detaching the WLAN user terminal from the WLAN can include an Explicit WLAN detach and/or an Implicit WLAN detach;",
                    "subcomponents": []
                },
                {
                    "component": "if said Explicit WLAN detach is initiated by the WLAN, the method further comprising:",
                    "subcomponents": []
                },
                {
                    "component": "the service control unit sending a detach request that includes at least one reason why the WLAN user terminal is detached from the WLAN; and the service control unit recording the service connection status of the WLAN user terminal as WLAN detached.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00011",
            "preamble": "11. The method according to claim 10 , if said Explicit WLAN detach is initiated by the WLAN user terminal, the method further comprising:",
            "components": [
                {
                    "component": "a",
                    "subcomponents": []
                },
                {
                    "component": "a",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00012",
            "preamble": "12. The method according to claim 11 , further comprising: the service control unit returning a response message to the WLAN user terminal, indicating the WLAN user terminal has been detached from the WLAN.",
            "components": []
        },
        {
            "claim_number": "CLM-00013",
            "preamble": "13. The method according to claim 10 , if said process for detaching the WLAN user terminal from the WLAN includes the Implicit WLAN detach, the method further comprising:",
            "components": [
                {
                    "component": "if there is no response from the WLAN user terminal after the WLAN initiates at least one contact attempt to the WLAN user terminal, the service control unit directly recording the service connection status of the WLAN user terminal as WALN detached.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00014",
            "preamble": "14. The method according to claim 13 , further comprising: if the time period during which there is no contact between the WLAN user terminal and the WLAN exceeds a predetermined duration, the WLAN initiating at least one contact operation to contact the WLAN user terminal.",
            "components": []
        },
        {
            "claim_number": "CLM-00015",
            "preamble": "15. The method according to claim 10 , further comprising: setting in the user information storage unit a third flag that indicates the service connection status between the WLAN user terminal and the WLAN; the service control unit recording the service connection status of the WLAN user terminal and then sending a user data updating instruction to the user information storage unit; the user information storage unit updating the service connection status of the user terminal on receiving the instruction, and then returning a user data updating response to the service control unit.",
            "components": []
        },
        {
            "claim_number": "CLM-00016",
            "preamble": "16. The method according to claim 15 , when the service connection status of the user is changed to WLAN attached, the method further comprising:",
            "components": [
                {
                    "component": "c",
                    "subcomponents": []
                },
                {
                    "component": "c",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00017",
            "preamble": "17. The method according to claim 15 , when the service connection status of the user is changed to WLAN detached, the method further comprising:",
            "components": [
                {
                    "component": "c",
                    "subcomponents": []
                },
                {
                    "component": "c",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00018",
            "preamble": "18. The method according to claim 15 , when the service connection status of the user is changed to WLAN detached, the method further comprising:",
            "components": [
                {
                    "component": "c",
                    "subcomponents": []
                },
                {
                    "component": "c",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00019",
            "preamble": "19. The method according to claim 18 , wherein the process for deleting user data comprises deleting information of the WLAN user terminal from the service control unit immediately after the WLAN user terminal is disconnected from the WLAN.",
            "components": []
        },
        {
            "claim_number": "CLM-00020",
            "preamble": "20. The method according to claim 1 , wherein the process for deleting user data comprises keeping, after the WLAN user terminal is disconnected from the WLAN, information of the WLAN user terminal in the service control unit for a certain period of time before deleting the information.",
            "components": []
        },
        {
            "claim_number": "CLM-00021",
            "preamble": "21. The method according to claim 1 , wherein said first flag and the second flag set in the WLAN user terminal and the service control unit comprise newly-defined specific flags or are implemented by re-using existing flags.",
            "components": []
        },
        {
            "claim_number": "CLM-00022",
            "preamble": "22. The method according to claim 1 , wherein messages to support the interaction between the WLAN user terminal and the WLAN are implemented by independently defined special messages or by using the messages in existing procedures.",
            "components": []
        },
        {
            "claim_number": "CLM-00023",
            "preamble": "23. The method according to claim 1 , wherein said service control unit an Authentication, Authorization and Accounting (AAA) server.",
            "components": []
        },
        {
            "claim_number": "CLM-00024",
            "preamble": "24. The method according to claim 1 , wherein said user information storage unit includes a Home Subscriber Server (HSS) or a Home Location Register (HLR).",
            "components": []
        }
    ],
    "description": [
        "This application is a continuation International Application No. PCT/CN2003/000921 filed on Oct. 30, 2003. This application claims the benefit of Chinese Application No. 02154432.8 filed on Dec. 12, 2002. The disclosures of the above applications are incorporated herein by reference.",
        "The present invention relates to user information processing, and more particularly, to a method for processing a service connection between a WLAN (Wireless Local Area Network) and a user terminal.",
        "As the requirement for the wireless access rate is becoming higher and higher, the WLAN that can provide a higher wireless access rate within a smaller area has seen in fast development. Nowadays, there are many available technologies for WLAN, one widely applied technical standard of which is IEEE 802.11b that uses the frequency band of 2.4 GHz; another alternative that uses the same frequency band is the Bluetooth. All other new technologies, such as IEEE 802.11a and ETSI BRAN Hiperlan2, use the frequency band of 5 GHz.",
        "Although there are many different kinds of radio access technologies, most WLANs are used to bear IP (Internet Protocol) data packets. In a wireless IP network, the WLAN access technology specific is usually transparent to the upper layer, e.g. IP layer or upper. All these IP networks are of the similar basic architecture which implements the wireless access of a user via the Access Point (AP) and builds an IP transmission network through the connection of the network control and connection devices.",
        "Along with the springing up and development of the WLAN, how to implement the interworking between the WLAN and various mobile communication networks, such as GSM, CDMA (Code-Division Multiple Access) system, WCDMA (Wideband Code Division Multiple Access) system, TD-SCDMA (Time Division-Synchronize Code Division Multiple Access) system and CDMA2000 system, has become one of the highlights of current research. In the scope of 3rd Generation Partnership Project (3GPP) standard organization, simplified network architecture for interworking between a WLAN system and a 3GPP system is shown in FIG. 1. A user terminal can communicate with not only the Internet and Intranet but also the packet domain network of the 3GPP network via WLAN access networks. It is obvious that, as a wireless access technology that provides IP bearer, the WLAN can be interconnected with many other networks.",
        "Generally, while the WLAN connects with other networks, the authentication, authorization and accounting operation for the connection are controlled by an appropriate application server, for instance, the AAA (Authentication, Authorization and Accounting) server in a 3GPP system; and the subscriber information is managed by an information storage unit, for example, the HSS (Home Subscriber Server) or the HLR (Home Location Register) in the 3GPP system. Therefore, when the authentication, authorization and accounting processes is performed, the corresponding application server will request the user profile from the information storage unit, and store it temporarily in itself. The application server will not release the information stored until the service is terminated, wherein the so-called release refers to the step that the application server deletes the relevant data of the user who is not access the service any more. In specific implementation, the data can be deleted immediately after the user is offline, or be kept for a certain period of time before being deleted so that when the user logs in once again, the application server can use the stored data again without downloading it from the information storage unit. Once the subscriber information in the information storage unit is changed, the information storage unit will notify the corresponding application server to update the data.",
        "In practice, there is no corresponding mechanism in the 3GPP standard supporting the attach process by which a WLAN user requests to access WLAN, i.e. the WLAN attach process. As a result, a WLAN user cannot know whether he/she has successfully accessed the WLAN, and whether he is able to use the services provided by the WLAN. In addition, the AAA server cannot determine whether the WLAN based services are available to the user. Similarly, there also is no corresponding mechanism in the 3GPP standard supporting the detach process by which a WLAN user stops using the services and is detached from the WLAN, i.e. the WLAN detach process. Consequently, the WLAN user cannot make sure whether he has successfully been detached from the WLAN, and furthermore, the AAA server is also unable to determine whether the user is still able to enjoy the WLAN based services.",
        "In addition, in order to prevent unnecessary signaling delivery, it is necessary to synchronize the user information stored in the application server and that in the information storage unit. For instance, in existing specifications, when a user is attached or detached in a WLAN, the information about user connection can be updated only in the service control unit, i.e. the user information application server, such as the AAA server, without notification of the information storage unit for the user, such as the HLR/HSS. The direct consequence of this mechanism is that the information storage unit will not know the accurate status information of the user, which makes the user information stored in the information storage unit unreliable. It is also possible that even after the user's disconnection from a WLAN, the information storage unit continues to ask for the user information, such as the service connection status of the user and the user data, from the service control unit in subsequent processing, which results in unnecessary signaling burden and meaningless system resource occupation. When there is a large amount of such signaling, negative affects may be brought to the normal operations of the system.",
        "In view of the above, it is the primary object of the present invention to provide a method for processing the user connection between the WLAN and the user terminal, by which the WLAN and the user terminal can confirm the current service connection status of the WLAN user terminal, in order to achieve effective interactions and controls between the WLAN user terminal and the service control unit.",
        "Another object of the present invention is to provide such a method for processing the service connection between the WLAN and the user terminal that can synchronize the user information stored in the user information storage unit and the user information in the service control unit so as to avoid redundant message delivery and further improve the efficiency of the system.",
        "In order to achieve the above objects, the present invention is implemented as follows:",
        "A method for processing the user connection between the WLAN and the user terminal is applicable to a WLAN consisting of a WLAN user terminal, a WLAN access unit, a service control unit and a user information storage unit, the method comprising:",
        "Setting flags in the user terminal and the service control unit of a WLAN respectively, which represent the status of the connection between the user terminal and the WLAN, e.g. attached or detached; establishing or canceling the connection between the user terminal and the WLAN by means of interaction between the WLAN user terminal and the WLAN, and meanwhile modifying the corresponding flags.",
        "Wherein, the said service control unit may be a 3GPP AAA Server and the said user information storage unit can be a HSS or a HLR.",
        "The said step of establishing the connection between the user terminal and the network refers to attaching the WLAN user terminal to the WLAN, which further includes:\n\n    \n    \n        a11. when a WLAN user terminal accesses the WLAN, the WLAN user terminal sending an attach request message to the service control unit via the WLAN access unit;\n        a12. on receiving the attach request, the service control unit judging whether to allow the current WLAN user terminal to establish a service connection, if not, the service control unit denying the attach request sent by the user terminal and ending this procedure; otherwise, the service control unit recording the service connection status of the WLAN user terminal as WLAN attached, then returning an access response message to the WLAN user terminal.",
        "Wherein, the said attach request message in Step a11 contains a permanent or temporary identification of the WLAN user terminal. On receiving the attach request, the service control unit first determines whether the permanent or temporary identification of the user in the attach request message is valid. If not, the service control unit initiates a request procedure to the user terminal to fetch a valid flag of the user terminal; otherwise, the service control unit determines whether having stored in itself the user information of the user terminal that sent the current request. If there is no such information, the service control unit sends a request for the data information of the user terminal to the corresponding user information storage unit; otherwise, goes to Step a12 directly.",
        "The said determination on whether to allow the current WLAN user terminal to establish the service connection in Step a12 is implemented by the existing authentication procedure.",
        "The said method further includes: on receiving the access response message sent by the service control unit, the WLAN user terminal modifying the relevant service connection flag in itself, indicating that the service connection between the WLAN user terminal and the WLAN has been successfully established.",
        "The said step of canceling the service connection between the user terminal and the network refers to detaching the WLAN user terminal from the WLAN, the process of which further includes: the WLAN user terminal detaching from the WLAN, canceling the relevant service connection, and the service control unit recording the service connection of the WLAN user terminal as WLAN detached. The said detach procedure can be an Explicit WLAN detach or an Implicit WLAN detach.",
        "When the said Explicit WLAN detach process is initiated by the WLAN user terminal, the method further comprises:",
        "a21. the WLAN user terminal sending to the network a detach request that contains the reason that the WLAN user terminal is detached from the WLAN;",
        "a22. on receiving the detach request, the service control unit recording the current service connection status of the WLAN user terminal as WLAN detached.",
        "The said detach process further comprises: the service control unit returning a response message to the WLAN user terminal, indicating that the WLAN user terminal has successfully been detached from the WLAN.",
        "When the said Explicit WLAN detach procedure is initiated by the WLAN, the method further comprises:",
        "The service control unit sending to the WLAN user terminal a detach request that contains the reasons that the WLAN user terminal is detached from the WLAN; meanwhile, the service control unit recording the service connection status of the current WLAN user terminal as WLAN detached.",
        "When the said detach is an Implicit WLAN detach, the method further comprises: if there is no response from the WLAN user terminal after the WLAN initiates at least one contact operation with the WLAN user terminal, the service control unit directly recording the service connection status of the WLAN user terminal as WLAN detached. The said process of Implicit WLAN detach further comprises: when the time during which there is no contact between the relevant WLAN user terminal and the WLAN exceeds a predetermined threshold, the WLAN initiating at least one contact process to contact with the WLAN user terminal.",
        "The said flags set in the WLAN user terminal and the service control unit can be new-defined specific flags or are implemented by re-using existing flags. The messages bearing the interactive procedures are implemented by new-defined specific messages or by re-using the messages in existing procedures.",
        "The attach or detach procedure mentioned above further includes: setting a flag that indicates the service connection status between the WLAN user terminal and the WLAN in the user information storage unit; the service control unit sending a user-data updating instruction to the user information storage unit, after recording the service connection status of the current WLAN user terminal; the user information storage unit updating the service connection status of the current user terminal after receiving the instruction, and then returning a user data updating response to the service control unit after updating the user's service connection information.",
        "Therefore, when the current service connection status of a user is changed to WLAN attached, the method further comprises:",
        "c11. the service control unit setting the service connection status of the current WLAN user terminal as WLAN attached and simultaneously sending an attach request to the user information storage unit;",
        "c12. on receiving the attach request, the user information storage unit setting the service connection status of the relevant WLAN user terminal as WLAN attached, and then returning a response message to the service control unit.",
        "When the service connection status of a user is changed to WLAN detached, the method further comprises:",
        "c21. the service control unit setting the service connection status of the current WLAN user terminal as WLAN detached, and simultaneously sending a detach request to the user information storage unit;",
        "c22. on receiving the detach request, the user information storage unit sets the service connection status of the relevant WLAN user terminal as WLAN detached, and then returning a response message to the service control unit.",
        "When the user information is changed to WLAN detached, the method may as well further comprises:",
        "c31. the service control unit deleting the stored user data of the current WLAN user terminal, and simultaneously sending a user information delete request to the user information storage unit;",
        "c32. on receiving the delete request, the user information storage unit recording that the user data of the current WLAN user terminal has been deleted from the service control unit, and then returning a response message to the service control unit.",
        "Wherein deleting the user data in Step c31 comprises deleting the information of the WLAN user terminal from the service control unit immediately after the WLAN user terminal disconnects from the WLAN; or keeping, after the WLAN user terminal disconnects from the WLAN, the information of the WLAN user terminal in the service control unit for a certain period of time before deleting the information.",
        "As described above, the method provided by this invention for processing the service connection of a user in a WLAN clearly defines a WLAN attach procedure by which the WLAN user terminal accesses the WLAN and a WLAN detach procedure by which the WLAN user terminal detaches from the WLAN so as to enable the service connection status (attach or detach) of the WLAN user terminal to be controlled interactively and effectively at the user terminal and the service control unit. Moreover, the method makes it possible to clearly indicate whether the current user terminal has successfully connected to the network and been able to enjoy the WLAN based services; or whether the current user terminal has smoothly been detached from the WLAN and terminated the WLAN based services.",
        "In addition, when the user accesses the WLAN or is detached from the WLAN, the user information storage unit or the service control unit will send relevant messages each other in time so as to update simultaneously the user data in both the user information storage unit and the service control unit. Using the said method of the present invention can avoid redundant signaling burden and unnecessary occupation of the system resource caused by the lost of synchronization of the user data, improve the working efficiency of the system and the effectiveness of message transmission, and further provide more convenient and diversified services for the WLAN user.",
        "Further areas of applicability of the present invention will become apparent from the detailed description provided hereinafter. It should be understood that the detailed description and specific examples, while indicating the preferred embodiment of the invention, are intended for purposes of illustration only and are not intended to limit the scope of the invention.",
        "The present invention will become more fully understood from the detailed description and the accompanying drawings, wherein:",
        "FIG. 1 shows a simplified network architecture for the interworking between the WLAN and 3GPP system;",
        "FIG. 2 shows the system structure in the WLAN for processing changes of the service connection between the user and the WLAN;",
        "FIG. 3 shows a flowchart for implementing the method in accordance with the present invention;",
        "FIG. 4 shows a flowchart of the interactive procedure when a user accesses the WLAN;",
        "FIG. 5 shows a flowchart of the interactive procedure of the Explicit WLAN detach initiated by a user terminal;",
        "FIG. 6 shows a flowchart of the interactive procedure of the Explicit WLAN detach initiated by the WLAN;",
        "FIG. 7 shows a flowchart of the interactive procedure of the Implicit WLAN detach initiated by the WLAN;",
        "FIG. 8 shows an embodiment of the interactive operation between the service control unit and the user information storage unit in a WLAN detach process according to the present invention;",
        "FIG. 9 shows another embodiment of the interactive operation between the service control unit and the user information storage unit in a WLAN detach process according to the present invention.",
        "The following description of the preferred embodiment(s) is merely exemplary in nature and is in no way intended to limit the invention, its application, or uses.",
        "The present invention will be described in detail hereinafter with references to the accompanying drawings and the preferred embodiments.",
        "In view of the current WLAN technologies, the present invention provides an interactive method for various parts relating to the information of user service connection, such as the service control unit and the user information storage unit to process changes of the statuses of the WLAN user service connection when the connection is changed. There are two kinds of service connections statuses between the user terminal and the network, attached and detached. The present invention, by means of tracing the change in the service connection between the WLAN user and the service control unit which takes place when the WLAN user accesses to or disconnects from the WLAN, provides a method to enable both the user terminal and the WLAN to know whether the user has successfully accessed the WLAN and the WLAN service is available or whether the user terminal has successfully been disconnected from the WLAN and the WLAN service needs to be terminated.",
        "The structure of the WLAN system implementing the above interactive method proposed by the present invention is shown in FIG. 2, comprising: a WLAN user terminal 201, a WLAN access unit 202, a service control unit 203 and a user information storage unit 204. The WLAN access unit 202 is responsible for the accessing and routing management of the user terminal, enabling the user terminals therein to communicate with each other using IP protocol and to connect and communicate with other IP networks. Generally speaking, the WLAN access unit mainly comprises Access Points (AP) and Access Controllers (AC), and may also comprises routers for providing the network connectivity and relevant servers for network control. The service control unit 203, which functions as a user control center in the WLAN system, controls the users' access to the WLAN by means of authentication, and accounts for every user terminal in the network. This service control unit can be a subscription information application unit. In practical applications, the AAA server is one example of the service control unit. The user information storage unit 204 is used for storing the information of all users and can be implemented by the HSS/HLR.",
        "The implementation process of the method in the present invention is shown in FIG. 3, which comprises the steps of:\n\n    \n    \n        preset, respectively in the WLAN user terminal and the service control unit, flags that represent the attached or detached status of the service connection between the user terminal and WLAN. The flags can be new-defined specific flags or can be implemented by re-using the flags that have already existed in the user terminal or the service control unit.",
        "a. Perform the attach procedure when a service connection between the WLAN user terminal and the WLAN is to be established and set the flags in the WLAN user terminal and the service control unit as WLAN attached after the WLAN user has successfully attached the WLAN.",
        "b. Cancel the service connection between the user terminal and the network through the interactions between the WLAN user terminal and the WLAN when the WLAN user terminal detaches from the WLAN and simultaneously modify the relevant flags. It is also possible to modify the flags of the service connection without the interactive procedure; for instance, when the wireless connection is interrupted resulting in that the connection is unable to be established, the WLAN user terminal can directly set the flag of the service connection as WLAN detached.",
        "The causes for canceling the service connection between the WLAN user terminal and the network without notifying the network may also include an exceptional power off of the user terminal, a direct plug-off of the WLAN card from the computer, or a crashing down of the system, etc. The network will also set the flag of the service connection between the user and the WLAN as WLAN detached after detecting that it is unable to connect with the user terminal.",
        "Take the AAA server as an example of the service control unit. When a user terminal accesses the WLAN, the AAA server determines whether there is the user's information in itself. If there is no such information, the AAA server downloads the relevant user data from the user information storage unit (e.g. HSS/HLR) and stores it. After the user has been successfully authenticated, the AAA server records the service connection status between the current user and the WLAN as WLAN attached, and at the same time sends a corresponding instruction to the user, indicating that the user has already attached to the WLAN. The user terminal then indicates that the WLAN based services are available through the proper change of the service connection or the corresponding flag.",
        "The WLAN attach procedure of the user terminal is shown in FIG. 4. In this embodiment, the HSS/HLR acts as a user information storage unit. The procedure comprises the following steps:",
        "Step 401: Establish a wireless connection between the user terminal and the WLAN when the user needs to access the WLAN. After the wireless connection is successfully established, the WLAN user terminal sends a WLAN access request to the AAA server through the WLAN access unit. The request needs to identify clearly the type of network the user requests to access is a WLAN and to contain a permanent or temporary identification of the user.",
        "Step 402: On receiving the request, the AAA server determines if there is a permanent or temporary identification in the access request message sent from the user terminal. If not, the network needs to initiate a request procedure to the user terminal to obtain the valid identification of the user terminal; otherwise, the AAA server continues to determine whether there is in itself the user information of the user terminal that sends the request. If there is no such information in the AAA server, go to Step 403; otherwise, go to Step 405 directly.",
        "Step 403\u02dc404: The AAA server sends a request to the relevant HLR/HSS for the data of the user terminal; and the HLR/HSS sends the data of user terminal to the AAA server.",
        "Step 405: The WLAN initiates an authentication procedure for the current WLAN user terminal.",
        "Step 406: After the authentication procedure completes successfully, the AAA server records the service connection between the user and the WLAN as WLAN attached, and then go to Step 407; if the authentication procedure fails, the AAA server denies the access request of the user and ends the procedure.",
        "Step 407\u02dc408: The AAA server sends a user data updating request to the HLR/HSS, and the HLR/HSS updates user status information of the current WLAN user terminal; after the updating process, the HLR/HSS sends a data updating response message to the AAA server. This step can be optional to avoid frequent updating of the user service connection status information in the HLR/HSS.",
        "Step 409: The AAA server returns an access response message to the WLAN user, indicating that the user has already been attached to the WLAN and the WLAN is available. On receiving the message, the user terminal needs to modify the relevant flag, indicating that the WLAN service is available. For example, a flag of the WLAN service connection can be set and is switched to the active status at the moment.",
        "The WLAN detach procedure of a user terminal falls into two groups depending on the detaching mode: Explicit WLAN detach and Implicit WLAN detach. The Explicit WLAN detach can be further divided into two subgroups based on the initiator: the Explicit WLAN detach initiated by the WLAN user terminal, and that initiated by the WLAN. In an Explicit WLAN detach procedure initiated by a user terminal, the user terminal needs to identify the reason for the detachment in the detach request message sent to the WLAN; similarly, in an Explicit WLAN detach procedure initiated by the WLAN, it is also necessary for the network to identify the reason for the detachment in the detach request message sent to the user. On the other hand, the Implicit WALN detach procedure is initiated by the network performed when the user has not contacted with the WLAN for a long time. In this case, the network does not need to inform the user terminal after the detach procedure is completed.",
        "Hereinafter is the detailed description on the above mentioned modes of the detach procedures:",
        "1) When it is the WLAN user terminal that initiates a detach procedure from the WLAN, the user terminal informs the AAA server to terminate the WLAN service, and the service control unit, i.e. the AAA server, updates the corresponding service connection status to WLAN detached. As shown in FIG. 5, the procedure comprises the following steps:",
        "Step 501: When a WLAN user terminal requests to detach from the WLAN, the WLAN user terminal sends a detach request to the network. The request message contains the reason for the detachment as well as the type of the network the WLAN user terminal detaches from, i.e. WLAN.",
        "Step 502: On receiving the detach request, the AAA server records the service connection status of the user terminal as WLAN detached.",
        "Step 503: The AAA server returns a response message to the current WLAN user terminal. This step is optional, the AAA server may decide based on the actual situation whether or not to return to the user terminal the response message, indicating that the user has already detached from the WLAN. For instance, it may be only needed to set the corresponding flags in the AAA server and the HLR/HSS in a WLAN detach procedure while not necessary to inform the user terminal for the convenience of operation and maintenance. Moreover, the AAA server will change the service connection status to WLAN detached when detecting there is no response sent by the user terminal. At this time, the AAA server does not need to send the notification to the user terminal, but simply sets the flag of the service connection status as WLAN detached.",
        "2) It is possible for the WLAN to initiate a WLAN detach procedure for a user out of a reason from the network. In this case, the detach procedure may be initiated by the AAA server or the HSS/HLR. In this embodiment, the procedure is initiated by the AAA server, and the AAA server updates the relevant service connection status of the current user terminal to WLAN detached. As shown in FIG. 6, the procedure comprises the following steps:",
        "Step 601: When the WLAN requests the WLAN user terminal to detach from the WLAN, the AAA server sends a detach request to the user terminal. The request message contains the type of the network to be detached from, i.e. WLAN as well as the reason for the detachment.",
        "Step 602: Simultaneously, the AAA server records the service connection status of the WLAN user terminal as WLAN detached.",
        "Step 603: The current WLAN user terminal returns a response message to the AAA server, indicating the user has already detached from the WLAN and the WLAN based service for the user has been terminated. This step is optional. The user terminal may decide based on the actual situation whether or not to return the response message to the AAA server.",
        "3) Implicit WLAN detach procedure. When the user has not contacted with the WLAN for a long time, a WLAN detach procedure will be initiated by the AAA server. The AAA server will update the WLAN service connection status of the user to WLAN detached, indicating that the WLAN service is no longer available to the user. In this case, the AAA server does not need to send any notification to the user. As shown in FIG. 7, the procedure comprises the following steps:",
        "Step 701\u02dc702: After the AAA server has initiated a certain times of contacts with the WLAN user terminal, if there is still no response from the user terminal, the AAA server will directly record the service connection status of the WLAN user terminal as WALN detached. The times of contacts initiated by the AAA server before a detach procedure can be configured according to the actual situation. There are many reasons that the AAA server may initiate contacts with the user terminal: it may be that the user has not contacted with the WLAN for a long time, then relevant timer in AAA server is expired, which may result in the AAA server initiating the contact procedure with the user terminal. Other user applications may also request the AAA server to contact with the user terminal.",
        "In the Implicit and Explicit WLAN detach procedure mentioned above, in order to guarantee that the data in the service control unit and in the user information storage unit are consistent, the service control unit will perform the detach procedures in two ways: {circle around (1)} records the service connection status of user as WLAN detached, sends a user detach notification to the user information storage unit, and then the user information storage unit sets a corresponding flag for the current service connection status of the user; {circle around (2)} directly deletes the user information without setting a flag for the service connection of the user, sends a notification to the user information storage unit indicating that the user information has been deleted, and then the user information storage unit records that the user information has been deleted in the service control unit.",
        "The interactive process between the service control unit and the user information storage unit based on the method {circle around (1)} is shown in FIG. 8, comprising the following steps:",
        "Step 801\u02dc802: While performing the detach procedure, the AAA server sets the current service connection status of the user terminal as WLAN detached and sends a detach notification to the HSS/HLR simultaneously, indicating that the user has been detached form the WLAN;",
        "Step 803\u02dc804: On receiving the notification, the HSS/HLR sets the current service connection status of the relevant user terminal as WLAN detached, then returns a response message to the AAA server, indicating that the service connection status of the user has been correctly updated.",
        "The interactive process between the service control unit and the user information storage unit based on the method {circle around (2)} is shown in FIG. 9, comprising the following steps:",
        "Step 901\u02dc902: While performing the detach procedure, the AAA server deletes the user data of the user terminal stored in itself and sends a user information delete notification to the HSS/HLR simultaneously, indicating that the data of the user terminal has been deleted in the AAA server;",
        "Step 903\u02dc904: On receiving the notification, the HSS/HLR records that the user data of the corresponding WLAN user terminal has been deleted from the AAA server, then returns a response message to the AAA server, indicating that the HSS/HLR has set a flag indicating the user data has been deleted.",
        "In the attach or detach procedure mentioned above, it is also necessary for the user information storage unit to preset a flag representing the service connection status between the WLAN user terminal and the WLAN.",
        "The messages to support the above various interactive procedures can be implemented by new-defined specific messages, for example, defined by Mobile Application Part (MAP) protocol, Remote Authentication Dial in User Service (RADIUS) protocol, or DIAMETER protocol. The interactive procedure can also be implemented by adding parameters to the existing messages. The user information mentioned in the above solutions could be the Subscription Information.",
        "In summary, the above description is only preferable embodiments of the present invention and is not to be construed as limits to the protection scope of the present invention.",
        "The description of the invention is merely exemplary in nature and, thus, variations that do not depart from the gist of the invention are intended to be within the scope of the invention. Such variations are not to be regarded as a departure from the spirit and scope of the invention."
    ],
    "citations": [
        "6058308",
        "6104929",
        "6259925",
        "6505044",
        "6877104",
        "7107055",
        "7116970",
        "7142875",
        "7155526",
        "2002/0085540",
        "2002/0098840",
        "2002/0123346",
        "2003/0142641",
        "2004/0066769",
        "2004/0203732",
        "2005/0239461",
        "2006/0245399",
        "1365580",
        "10327199",
        "2001274809",
        "2000-349787",
        "2002198971",
        "WO 99/16266",
        "WO 02/073892",
        "WO 02/093689"
    ],
    "us_classification": "370338",
    "international_classifications": [
        {
            "classification_level": "A",
            "section": "H",
            "classification_class": "04",
            "subclass": "Q",
            "main_group": "7",
            "subgroup": "24"
        }
    ]
}