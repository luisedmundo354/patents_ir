{
    "title": "Methods, systems, and computer program products for neural channel selection in a multi-channel system",
    "abstract": "Methods, systems, and computer program products for transmitting neural signal information. Methods, systems, and computer programs products are disclosed for neural channel selection in a multi-channel system. A method according to one embodiment can include a step for receiving a plurality of neural signals on a first plurality of channels. The method can also include a step for calculating criterion variable value for the neural signal on each of the channels. In addition, the method can include a step for ranking the channels by the criterion variable value. The method can also include a step for calculating mutual information between a measured output and a total population activity for the first plurality of channels. Further, the method can include a step for determining a second plurality of channels that encodes a predetermined amount of the mutual information.",
    "inventors": [
        "Wolf",
        "Won"
    ],
    "document_number": "07299089",
    "publication_date": "20071120",
    "assignees": [
        "Duke University"
    ],
    "claims": [
        {
            "claim_number": "CLM-00001",
            "preamble": "1. A method for neural channel selection in a multi-channel system, the method comprising:",
            "components": [
                {
                    "component": "(a) receiving a plurality of neural signals on a first plurality of channels;",
                    "subcomponents": []
                },
                {
                    "component": "(b) calculating criterion variable value for the neural signal on each of the channels;",
                    "subcomponents": []
                },
                {
                    "component": "(c) ranking the channels by the criterion variable value;",
                    "subcomponents": []
                },
                {
                    "component": "(d) calculating mutual information between a measured output and a total population activity for the first plurality of channels; and",
                    "subcomponents": []
                },
                {
                    "component": "(e) determining a second plurality of channels that encodes a predetermined amount of the mutual information, wherein the second plurality of channels is a subset of the first plurality of channels.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00002",
            "preamble": "2. The method according to claim 1 , wherein receiving the plurality of neural signals comprises receiving the neural signals from a plurality of neural sensors for detecting the neural signals from neurons.",
            "components": []
        },
        {
            "claim_number": "CLM-00003",
            "preamble": "3. The method according to claim 1 , wherein receiving the plurality of neural signals comprises conditioning the neural signals.",
            "components": []
        },
        {
            "claim_number": "CLM-00004",
            "preamble": "4. The method according to claim 1 , wherein calculating criterion variable value comprises calculating criterion variable value for between about 2 minutes and 10 minutes.",
            "components": []
        },
        {
            "claim_number": "CLM-00005",
            "preamble": "5. The method according to claim 1 , wherein calculating criterion variable value comprises determining principle components of neural signal activity of the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00006",
            "preamble": "6. The method according to claim 5 , wherein calculating criterion variable value comprises determining variance of the neural signal activity of each channel of the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00007",
            "preamble": "7. The method according to claim 1 , wherein calculating mutual information comprises determining Shannon mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00008",
            "preamble": "8. The method according to claim 7 , wherein the Shannon mutual information is defined by the following equation:",
            "components": []
        },
        {
            "claim_number": "CLM-00009",
            "preamble": "9. The method according to claim 8 , comprising determining maximum likelihood estimates of entropies, wherein a raw estimate of information is provided by the following equation:",
            "components": []
        },
        {
            "claim_number": "CLM-00010",
            "preamble": "10. The method according to claim 1 , wherein calculating mutual information comprises determining a best upper bounds estimate.",
            "components": []
        },
        {
            "claim_number": "CLM-00011",
            "preamble": "11. The method according to claim 1 , wherein calculating mutual information comprises utilizing a Strong method.",
            "components": []
        },
        {
            "claim_number": "CLM-00012",
            "preamble": "12. The method according to claim 1 , wherein the predetermined amount is greater than about 90%.",
            "components": []
        },
        {
            "claim_number": "CLM-00013",
            "preamble": "13. The method according to claim 1 , wherein determining the second plurality of channels comprises searching the ranked channels for the channels that encode the predetermined amount of the mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00014",
            "preamble": "14. The method according to claim 1 , comprising determining whether the second plurality of channels are stable.",
            "components": []
        },
        {
            "claim_number": "CLM-00015",
            "preamble": "15. The method according to claim 1 , comprising selectively enabling or disabling channels from among the first plurality of channels such that the first plurality of channels includes the same channels as the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00016",
            "preamble": "16. The method according to claim 1 , comprising selectively conditioning only the neural signals on the second plurality of channels from among the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00017",
            "preamble": "17. The method according to claim 1 , comprising selectively transmitting only the neural signals on the second plurality of channels from among the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00018",
            "preamble": "18. The method according to claim 17 , comprising providing a controller for receiving neural signals on the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00019",
            "preamble": "19. The method according to claim 18 , comprising operating the controller to transmit control signals for controlling the actuator, wherein the control signals are based on the received neural signals on the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00020",
            "preamble": "20. A system for neural channel selection in a multi-channel system, the system comprising:",
            "components": [
                {
                    "component": "(a) a signal receiver for receiving a plurality of neural signals on a first plurality of channels; and",
                    "subcomponents": []
                },
                {
                    "component": "(b) a controller operable for the following operations:",
                    "subcomponents": [
                        "(i) calculate criterion variable value for the neural signal on each of the channels;",
                        "(ii) rank the channels by the criterion variable value;",
                        "(iii) calculate mutual information between a measured output and a total population activity for the first plurality of channels; and",
                        "(iv) determining a second plurality of channels that encodes a predetermined amount of the mutual information, wherein the second plurality of channels is a subset of the first plurality of channels."
                    ]
                },
                {
                    "component": "(i) calculate criterion variable value for the neural signal on each of the channels;",
                    "subcomponents": []
                },
                {
                    "component": "(ii) rank the channels by the criterion variable value;",
                    "subcomponents": []
                },
                {
                    "component": "(iii) calculate mutual information between a measured output and a total population activity for the first plurality of channels; and",
                    "subcomponents": []
                },
                {
                    "component": "(iv) determining a second plurality of channels that encodes a predetermined amount of the mutual information, wherein the second plurality of channels is a subset of the first plurality of channels.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00021",
            "preamble": "21. The system according to claim 20 , wherein the signal receiver is operable to receive the neural signals from a plurality of neural sensors for detecting the neural signals from neurons.",
            "components": []
        },
        {
            "claim_number": "CLM-00022",
            "preamble": "22. The system according to claim 20 , wherein the signal receiver is operable to condition the neural signals.",
            "components": []
        },
        {
            "claim_number": "CLM-00023",
            "preamble": "23. The system according to claim 20 , wherein the controller is operable to calculate criterion variable value for between about 2 minutes and 10 minutes.",
            "components": []
        },
        {
            "claim_number": "CLM-00024",
            "preamble": "24. The system according to claim 20 , wherein the controller is operable to determine principle components of neural signal activity of the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00025",
            "preamble": "25. The system according to claim 24 , wherein the controller is operable to determine the variance of the neural signal activity of each channel of the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00026",
            "preamble": "26. The system according to claim 20 , wherein the controller is operable to determine Shannon mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00027",
            "preamble": "27. The system according to claim 26 , wherein the Shannon mutual information is defined by the following equation:",
            "components": []
        },
        {
            "claim_number": "CLM-00028",
            "preamble": "28. The system according to claim 27 , wherein the controller is operable to maximum likelihood estimates of entropies, wherein a raw estimate of information is provided by the following equation:",
            "components": []
        },
        {
            "claim_number": "CLM-00029",
            "preamble": "29. The system according to claim 20 , wherein the controller is operable to determine a best upper bounds estimate to calculate mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00030",
            "preamble": "30. The system according to claim 20 , wherein the controller is operable to utilize a Strong method to calculate mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00031",
            "preamble": "31. The system according to claim 20 , wherein the predetermined amount is greater than about 90%.",
            "components": []
        },
        {
            "claim_number": "CLM-00032",
            "preamble": "32. The system according to claim 20 , wherein the controller is operable to search the ranked channels for the channels that encode the predetermined amount of the mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00033",
            "preamble": "33. The system according to claim 20 , wherein the controller is operable to determine whether the second plurality of channels are stable.",
            "components": []
        },
        {
            "claim_number": "CLM-00034",
            "preamble": "34. The system according to claim 20 , wherein the controller is operable to selectively enable or disable channels from among the first plurality of channels such that the first plurality of channels includes the same channels as the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00035",
            "preamble": "35. The system according to claim 20 , wherein the controller is operable to selectively condition only the neural signals on the second plurality of channels from among the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00036",
            "preamble": "36. The system according to claim 20 , wherein the controller is operable to selectively transmit only the neural signals on the second plurality of channels from among the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00037",
            "preamble": "37. The system according to claim 36 , comprising a controller for receiving neural signals on the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00038",
            "preamble": "38. The system according to claim 37 , wherein the controller is operable to transmit control signals for controlling the actuator, wherein the control signals are based on the received neural signals on the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00039",
            "preamble": "39. A computer program product comprising computer-executable instructions embodied in a computer-readable medium for performing steps comprising:",
            "components": [
                {
                    "component": "(a) receiving a plurality of neural signals on a first plurality of channels;",
                    "subcomponents": []
                },
                {
                    "component": "(b) calculating criterion variable value for the neural signal on each of the channels;",
                    "subcomponents": []
                },
                {
                    "component": "(c) ranking the channels by the criterion variable value;",
                    "subcomponents": []
                },
                {
                    "component": "(d) calculating mutual information between a measured output and a total population activity for the first plurality of channels; and",
                    "subcomponents": []
                },
                {
                    "component": "(e) determining a second plurality of channels that encodes a predetermined amount of the mutual information, wherein the second plurality of channels is a subset of the first plurality of channels.",
                    "subcomponents": []
                }
            ]
        },
        {
            "claim_number": "CLM-00040",
            "preamble": "40. The computer program product according to claim 39 , wherein receiving the plurality of neural signals comprises receiving the neural signals from a plurality of neural sensors for detecting the neural signals from neurons.",
            "components": []
        },
        {
            "claim_number": "CLM-00041",
            "preamble": "41. The computer program product according to claim 39 , wherein receiving the plurality of neural signals comprises conditioning the neural signals.",
            "components": []
        },
        {
            "claim_number": "CLM-00042",
            "preamble": "42. The computer program product according to claim 39 , wherein calculating criterion variable value comprises calculating criterion variable value for between about 2 minutes and 10 minutes.",
            "components": []
        },
        {
            "claim_number": "CLM-00043",
            "preamble": "43. The computer program product according to claim 39 , wherein calculating criterion variable value comprises determining principle components of neural signal activity of the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00044",
            "preamble": "44. The computer program product according to claim 43 , wherein calculating criterion variable value comprises determining variance of the neural signal activity of each channel of the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00045",
            "preamble": "45. The computer program product according to claim 39 , wherein calculating mutual information comprises determining Shannon mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00046",
            "preamble": "46. The computer program product according to claim 45 , wherein the Shannon mutual information is defined by the following equation:",
            "components": []
        },
        {
            "claim_number": "CLM-00047",
            "preamble": "47. The computer program product according to claim 46 , comprising determining maximum likelihood estimates of entropies, wherein a raw estimate of information is provided by the following equation:",
            "components": []
        },
        {
            "claim_number": "CLM-00048",
            "preamble": "48. The computer program product according to claim 39 , wherein calculating mutual information comprises determining a best upper bounds estimate.",
            "components": []
        },
        {
            "claim_number": "CLM-00049",
            "preamble": "49. The computer program product according to claim 39 , wherein calculating mutual information comprises utilizing a Strong method.",
            "components": []
        },
        {
            "claim_number": "CLM-00050",
            "preamble": "50. The computer program product according to claim 39 , wherein the predetermined amount is greater than about 90%.",
            "components": []
        },
        {
            "claim_number": "CLM-00051",
            "preamble": "51. The computer program product according to claim 39 , wherein determining the second plurality of channels comprises searching the ranked channels for the channels that encode the predetermined amount of the mutual information.",
            "components": []
        },
        {
            "claim_number": "CLM-00052",
            "preamble": "52. The computer program product according to claim 39 , comprising determining whether the second plurality of channels are stable.",
            "components": []
        },
        {
            "claim_number": "CLM-00053",
            "preamble": "53. The computer program product according to claim 39 , comprising selectively enabling or disabling channels from among the first plurality of channels such that the first plurality of channels includes the same channels as the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00054",
            "preamble": "54. The computer program product according to claim 39 , comprising selectively conditioning only the neural signals on the second plurality of channels from among the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00055",
            "preamble": "55. The computer program product according to claim 39 , comprising selectively transmitting only the neural signals on the second plurality of channels from among the first plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00056",
            "preamble": "56. The computer program product according to claim 55 , comprising providing a controller for receiving neural signals on the second plurality of channels.",
            "components": []
        },
        {
            "claim_number": "CLM-00057",
            "preamble": "57. The computer program product according to claim 56 , comprising operating the controller to transmit control signals for controlling the actuator, wherein the control signals are based on the received neural signals on the second plurality of channels.",
            "components": []
        }
    ],
    "description": [
        "The subject matter disclosed herein was supported by DARPA grant BAA01-42 and a National Science Foundation Graduate Research Fellowship Program grant. Thus, the Government has certain rights in the subject matter disclosed herein.",
        "The subject matter disclosed herein relates generally to neural signal processing. Specifically, the subject matter disclosed herein relates to methods, systems, and computer program products for neural channel selection in a multi-channel system.",
        "The human brain is an exceedingly complex processing system, which integrates continual streams of incoming sensory input data with stored memories, uses the input data and memories in complex decision processes at both conscious and unconscious levels and, on the basis of these processes, generates observable behaviors by activation of its motor or movement control pathways and the muscles which these innervate. The neurons of the nervous system propagate input data by generating characteristic electrical pulses called action potentials (APs), or neural spikes, that can travel along nerve fibers in the form of neural signals. A single neuron or a group of neurons represent and transmit information by firing sequences of APs in various temporal patterns. Information is carried in the AP arrival times and spike counts.",
        "In certain cases of traumatic injury or neurological disease, the brain can be partially isolated from the periphery. Input data from certain senses are thus lost, at least for a portion of the body, as are many voluntary movements. Spinal cord injury is a well-known example of traumatic injury. With spinal cord injury, the pathways that link higher motor centers in the brain with the spinal cord and that are used for control of voluntary movements can be functionally transected at the site of the injury. As a result, the patient is paralyzed, and can no longer voluntarily activate muscles that are innervated by regions of the spinal cord below the level of the injury. Despite the injury to their long fibers, however, many of the cells in these higher brain regions that control voluntary movement will survive and can still be activated voluntarily to generate electric signals for controlling voluntary movement. By recording the electrical activities produced from these cells with implantable neural sensors (e.g., a microwire electrode array, a microwire, a magnetic field detector, chemical sensor, or other neural sensor), a decoding algorithm can be applied to interpret and reproduce the user's intended movements for the control of external prostheses, such as an assist robot or an artificial limb, or functional electrical stimulation of paralyzed muscles. Additionally, these generated signals can be used for control of computer operations such as the movement of a cursor on a computer display. Current equipment allows extracellular records of hundreds of cortical neurons in primate subjects to be acquired onto a plurality of neural channels and processed to make predictions of hand position during a target tracking task. These predicted motor outputs can be used to control a multi-jointed robotic limb.",
        "Current devices for obtaining neural signals employ hundreds of neural sensors and neural signals to obtain predictions of the user's intended movements. Generally, it has been assumed to require as many neural signals as can be recorded that are distributed across different areas of the frontal and parietal cortices in order to obtain the best predictions. However, even using hundreds of neural signals that are currently recorded places a significant burden on neural signal acquisition and processing equipment. It is possible that different groups of neural signals carry redundant information. If this is the case, a subset of the neural signal population may provide as much information as the whole population for prediction purposes.",
        "Accordingly, there exists a need for improved and more efficient methods, systems, and computer program products for neural channel selection in a multi-channel system.",
        "Methods, systems, and computer programs products are disclosed for neural channel selection in a multi-channel system. A method according to one embodiment can include a step for receiving a plurality of neural signals on a first plurality of channels. The method can also include a step for calculating criterion variable value for the neural signal on each of the channels. In addition, the method can include a step for ranking the channels by the criterion variable value. The method can also include a step for calculating mutual information between a measured output and a total population activity for the first plurality of channels. Further, the method can include a step for determining a second plurality of channels that encodes a predetermined amount of the mutual information. The second plurality of channels can be a subset of the first plurality of channels.",
        "Some of the objects having been stated hereinabove, and which are achieved in whole or in part by the present subject matter, other objects will become evident as the description proceeds when taken in connection with the accompanying drawings as best described hereinbelow.",
        "Exemplary embodiments of the subject matter will now be explained with reference to the accompanying drawings, of which:",
        "FIG. 1 is an exemplary graph showing hypothetical curves of channel population information versus channel population size;",
        "FIG. 2 is an exemplary graph showing experimental curves of R2 for predictions of x position versus channel population size according to one embodiment;",
        "FIG. 3 is a schematic diagram of a neural channel selection system;",
        "FIG. 4 is a flow chart illustrating an exemplary process for selecting neural channels in a multi-channel system;",
        "FIG. 5 is a flow chart illustrating an exemplary process for operation in a continuous update mode; and",
        "FIG. 6 is a flow chart illustrating an exemplary process for determining the PEA via a Newton method.",
        "I. Definitions",
        "Following long-standing patent law convention, the terms \u201ca\u201d and \u201can\u201d mean \u201cone or more\u201d when used in this application, including the claims.",
        "As used herein, the terms \u201caction potential\u201d, \u201cAP\u201d, and \u201cneural spike\u201d mean the characteristic electrical pulses that can travel along nerve fibers.",
        "As used herein, the terms \u201cactuator\u201d, \u201cexternal device\u201d and \u201cprosthetic limb\u201d are used interchangeably and mean any kind of device adapted to perform a movement or receive a command for controlling a system, such as a computer system. Although an actuator preferably performs a movement in three dimensions, an actuator can also be limited to performing movements in two dimensions. Thus, an actuator can be a manipulandum confined to two-dimensional motion. A representative actuator comprises a prosthetic limb, which can be fitted on, or integrated into, the body of a subject. An actuator can also be associated with machinery and/or circuitry that allow the actuator to respond to one or more forms of input with one or more movements. In one example, the range of motion of an actuator designated as a substitute for a patient's lost or paralyzed limb is limited to the range of motion of the limb for which the actuator is substituting.",
        "As used herein, the term \u201clocation source\u201d means a position wherein a neural sensor can detect one or more neural signals.",
        "As used herein, the term \u201cneural channel\u201d means a medium operable to carry a representation of a neural signal recorded from a location source. For example, an electrical conduit is a medium capable of carrying an electrically-based representation of a neural signal.",
        "As used herein, the term \u201cneural signal\u201d means a signal, which can take any form, originating in the nervous system of an organism. Neural signals typically include neural spike signals that carry information in their arrival times at destination neurons.",
        "As used herein, the term \u201cneural sensor\u201d means an implantable device for sensing neural signals. Examples of neural sensors include microwire electrode arrays, optical sensors, microwires, magnetic field detectors, chemical sensors, and other suitable neural sensors which are known to those of skill in the art upon consideration of the present disclosure.",
        "As used herein, the terms \u201coperator,\u201d \u201cpatient\u201d and \u201csubject\u201d are used interchangeably and mean any individual monitoring or employing the subject matter described herein, or an element thereof. Operators can be, for example, researchers gathering data from an individual, an individual who determines the parameters of operation of the present invention or the individual in or on which a high-density multichannel microelectrode array is disposed. Broadly, then, an \u201coperator,\u201d \u201cpatient\u201d or \u201csubject\u201d is one who is employing the present invention for any purpose. As used herein, the terms \u201coperator,\u201d \u201cpatient\u201d and \u201csubject\u201d need not refer exclusively to human beings, but rather the terms encompass all organisms having neural tissue, such as monkeys, dogs, cats, rodents, etc.",
        "II. General Considerations",
        "Through the years there has been significant research in the area of detecting and observing various electric potentials generated within the human body for medical diagnosis, biofeedback control of mental and physical states, and control of external devices. It is known that different regions of the brain are used to control different parts of the body and to process different sensory inputs. It is also known that when a human performs a certain function, such as moving an extremity or listening to a particular sound, multiple regions of the brain generate electrical action potentials to accomplish that function. It is also known that direct electrical stimulation of a particular region of the brain can reproduce, at least partially, the functions or sensory input normally associated with that region of the brain.",
        "The methods, systems, and computer program products disclosed herein are operable to obtain neural signals on a plurality of neural channels for determining predictions of a user's intended movements. Hundreds of neural signals can be acquired simultaneously from neural sensors, conditioned, and processed to obtain predictions of the user's intended movements for the control of external devices. In one embodiment, 320 microwires are distributed across six different areas in the frontal and parietal cortices. The methods and systems disclosed herein can select channels to utilize the prediction algorithm. Utilizing neural signals on all channels is not necessary for accurately decoding hand position. A subset of the channel population can provide as much information as the whole channel population for accurate prediction purposes in a neural prothesis, actuator, or another external device. The methods and systems disclosed herein can determine a subset of the channel population for accurate prediction purposes.",
        "It can be shown that a subset of the total neural channel population can attain prediction accuracy as measured by the coefficient of determination (R2) that is comparable to or in some cases higher than using the entire neural channel population. For example, a linear prediction method can be applied to hand position in each of two dimensions and R2 can be measured as groups of randomly selected channels are used to make predictions. FIG. 1 is an exemplary graph showing hypothetical curves of channel population information versus channel population size. The broken line represents the projected behavior of information as neural channels are randomly selected to be included in a subset channel population. The solid line represents the projected behavior of information as neural channels are added to a population in rank order of a criterion variable.",
        "FIG. 2 illustrates an exemplary graph showing experimental curves of R2 for predictions of x position versus channel population size according to one embodiment. Analysis of the experimental results shown in FIG. 2 reveals that as the number of channels utilized increases, the coefficient of determination of hand position typically increases. However, random neuron dropping curves do not reveal as steep an increase in coefficient of determination as curves for selective channel populations do. Thus, FIG. 2 indicates that information can increase at a higher rate for smaller channel population sizes when channels are selectively included in the channel population in a selective order by rank order of a criterion variable rather than a random order.",
        "III. Configuration and Operation of the Neural Channel Selection System",
        "Methods, systems, and computer program products are disclosed herein for neural channel selection in a multi-channel system. A subset of neural channels can be selected from a neural channel population to achieve suitable neural signals for processing. Initially, neural action potentials can be detected in signals received on a plurality of neural channels from neural tissues. The system can include neural sensors for detecting the neural signals on a plurality of neural channels. In addition, the system can include conditioning circuitry for conditioning the neural signals and a transmitter for transmitting the signals on each neural channel to a host station or computer for processing and storage. The host computer can implement a process to determine an optimal subset of the channels to enable or disable based on the neural signal information carried in the neural channels. The selected neural signals can be used in controlling an external device, such as an actuator, prosthetic device, or computer system, or to treat a neurological condition. Enabling and disabling appropriate channels can improve efficiency in the transmission and processing of neural signals.",
        "The methods, systems, and computer program products will be explained in the context of flow charts and diagrams. It is understood that the flow charts and diagrams can be implemented in hardware, software, or a combination of hardware and software. Thus, the subject matter disclosed herein can include computer program products comprising computer-executable instructions embodied in computer-readable media for performing the steps illustrated in each of the flow charts or implementing the devices illustrated in each of the diagrams.",
        "III. A. Neural Channel Selection System",
        "FIG. 3 is a schematic diagram of a neural channel selection system, generally designated 300, according to one embodiment. System 300 can include a plurality of microelectrodes 302 for detecting neural signals. Microelectrodes 302 can be implanted in different location sources in a subject's brain or nervous system. Neural signals detected on microelectrodes 302 can then be buffered, amplified, and filtered with amplifier and filtering circuitry 304. Selected channels can be serially digitized by an analog-to-digital (A/D) converter 306 and stored in a first-in first-out (FIFO) buffer 308 for wireless transmission through a radio frequency (RF) telemetry link 310. A complex programmable logic device (CPLD) 312 can control the timing and status of various operations through status signals sent to amplifying/filtering circuitry 304, A/D converter 306, and data transmission components 308 and 310.",
        "The digitized data can be wirelessly transmitted to a host computer (or controller) 314 and stored in a memory 316. Host computer 314 can perform neural spike sorting on the multi-channel neural signals and apply signal processing to predict desired actuator position from the spike activity of the discriminated channels. The predicted position can be utilized to control the movements of an actuator 318. Thus, the neural signals can include data intended by the subject to control actuator 318. Actuator 318 can feedback its actual position to host computer 314.",
        "Host computer 314 can also implement a selection process for selecting a subset of the channel population and indicating the selected channels to CPLD 312. CPLD 312 can then enable the selected subset of the channel population for conditioning and A/D conversion by circuitry 304 and A/D converter 306, respectively. CPLD 312 can indicate the selected subset of channels to enable by transmitting control signals to circuitry 304 and A/D converter 306 via control lines 320 and 322, respectively.",
        "III. B. Neural Channel Selection Process",
        "FIG. 4 is a flow chart illustrating an exemplary process for selecting neural channels in a multi-channel system. The exemplary process of FIG. 4 is described with respect to system 300 (shown in FIG. 3) but can also be applied to various other suitable neural systems for selecting channels. Referring to FIG. 4, the process can start at step 400. Next, at step 402, system 300 can collect neural signals on a plurality of channels and output data from actuator 318 (FIG. 3). The neural signals can contain neural activity information and can be acquired from all available neural sensors 302. The number of neural channels can range on the order of hundreds to thousands. The data can be collected for a time period between approximately 2 and 10 minutes. The neural signals can include neural population activity (designated P for equations provided herein) such as temporal sequences of spike occurrences, spike counts over relatively long bins, or interspike intervals.",
        "Neural signal collection can include detecting the neural signals with microelectrodes 302 (FIG. 3) and conditioning and digitizing the neural signals with circuitry 304, A/D converter 306, and FIFO 308 (FIG. 3). In addition, the digitized neural signals can be transmitted to host computer 314 (FIG. 3) via telemetry link 310 (FIG. 3) and stored in memory 316 (FIG. 3).",
        "Step 402 can also include collecting output target data (designated M for equations provided herein) from a task generator (not shown). Output data M can include features such as joint angular velocity, EMG amplitude, 3-dimentional hand position or velocity in external or body-centric coordinates, or 3-dimensional hand velocity. Alternatively, any suitable type of output data indicating the efforts of the subject to control an actuator can be recorded for comparison to neural output/activity resulting from the subject attempting to control the actuator. Further, for research purposes, the limb position of the subject (e.g., arm or leg position of the subject) can be recorded for comparison to the neural data collected when the subject is attempting to move the limb.",
        "According to one embodiment, the task generator can train or calibrate host computer 314 before full autonomous use. During this time, a motor task simulator can be presented to a subject. Next, a target (such as a computer-animated object on a display) can move according to a computer process. The subject can attempt to move a cursor using brain control to track the object. In this case, the subject can be used to train or calibrate host computer 314.",
        "As data is collected in step 402, host computer 314 can calculate the criterion variable value (CW) on each neural channel (step 404). The CW can be calculated for predetermined time segments for PC weights or variance. CVV calculations can include computing the principle components of the population neural signal activity and variance on the activity of each channel",
        "(\n  \n    \n      spike\n      \u2062\n      \n        \n      \n      \u2062\n      counts\n    \n    =\n    \n      \n        1\n        N\n      \n      \u2062\n      \n        \u2211\n        \n          \n            (\n            \n              \n                n\n                i\n              \n              -\n              n\n            \n            )\n          \n          2\n        \n      \n    \n  \n  )\n\n\n\n\n(designated herein as M) collected from actuator 318. In addition, the neural channels can be ranked by CVV and stored in memory 316 (step 406).",
        "Concurrently, with steps 404 and 406, host computer 314 can calculate the total mutual information between a measured actuator output M and the total neural channel population activity or control data intended for actuator 318 (step 408). In general, the neural population activity P and the actuator output data M is n-dimensional. For example, M can equal the EMG amplitude from n muscles or joint angular velocity at n different joints, and P can represent the activity of n neural channels.",
        "The channel selection process can optimize information obtained about output data M from the neural population activity P. In one embodiment, Shannon mutual information is the primary quantity of interest for optimizing information obtained about output data M. Shannon mutual information is defined by the equation below, which shows the mutual information between two signals M and P, where H is the entropy of a stochastic signal.",
        "I\n    \u2061\n    \n      (\n      \n        P\n        ,\n        M\n      \n      )\n    \n  \n  =\n  \n    \n      \n        H\n        \u2061\n        \n          (\n          P\n          )\n        \n      \n      -\n      \n        \u2329\n        \n          H\n          \u2061\n          \n            (\n            \n              P\n              |\n              M\n            \n            )\n          \n        \n        \u232a\n      \n    \n    \u2062\n    \n      \n\n    \n    \u2062\n    \n      \n    \n    =\n    \n      \n        \u222b\n        M\n      \n      \u2062\n      \n        \n          \u222b\n          P\n        \n        \u2062\n        \n          \n            \u03c1\n            \u2061\n            \n              (\n              \n                m\n                ,\n                p\n              \n              )\n            \n          \n          \u2062\n          \n            \n              log\n              2\n            \n            \u2061\n            \n              (\n              \n                \n                  \u03c1\n                  \u2061\n                  \n                    (\n                    \n                      p\n                      ,\n                      m\n                    \n                    )\n                  \n                \n                \n                  \n                    \u03c1\n                    \u2061\n                    \n                      (\n                      p\n                      )\n                    \n                  \n                  \u2062\n                  \n                    \u03c1\n                    \u2061\n                    \n                      (\n                      m\n                      )\n                    \n                  \n                \n              \n              )\n            \n          \n          \u2062\n          \n            \n          \n          \u2062\n          \n            \u2146\n            P\n          \n          \u2062\n          \n            \n          \n          \u2062\n          \n            \u2146\n            M",
        "Mutual information can be calculated by computing the maximum likelihood estimates of entropies, HML, such that the raw estimate of information, IML, is given by the equation below.",
        "I\n      ML\n    \n    \u2061\n    \n      (\n      \n        P\n        ;\n        M\n      \n      )\n    \n  \n  =\n  \n    \n      \u2211\n      M\n    \n    \u2062\n    \n      \n        \u2211\n        P\n      \n      \u2062\n      \n        \n          \n            \u03c1\n            emp\n          \n          \u2061\n          \n            (\n            \n              p\n              ,\n              m\n            \n            )\n          \n        \n        \u2062\n        \n          \n            log\n            2\n          \n          \u2061\n          \n            (\n            \n              \n                \n                  \u03c1\n                  emp\n                \n                \u2061\n                \n                  (\n                  \n                    \n                      p\n                      |\n                      M\n                    \n                    =\n                    m\n                  \n                  )\n                \n              \n              \n                \n                  \u03c1\n                  emp\n                \n                \u2061\n                \n                  (\n                  p\n                  )\n                \n              \n            \n            )\n          \n        \n      \n    \n  \n\n\n\n\nIn the above equation, pemp is the empirical measure of the probability, given by the equation below for pemp. To calculate pemp of a variable X, the sample space of X is first quantized into q levels and the frequency of each quantized value x tabulated to calculate the empirical probability of X taking on the value x. An equation for determining pemp follows:",
        "\u03c1\n      emp\n    \n    \u2061\n    \n      (\n      \n        X\n        =\n        x\n      \n      )\n    \n  \n  =\n  \n    \n      1\n      N\n    \n    \u2062\n    \n      \n        \u2211\n        \n          i\n          =\n          1\n        \n        N\n      \n      \u2062\n      \n        \n      \n      \u2062\n      \n        \n          \u2211\n          \n            j\n            =\n            1\n          \n          k\n        \n        \u2062\n        \n          \u03b4\n          \u2061\n          \n            (\n            \n              \n                t\n                i\n              \n              -\n              \n                \u03c4\n                j\n              \n            \n            )\n          \n        \n      \n    \n  \n\n\n\n\nIn the above equation, N equals the number of samples, \u03b4(t) is the Kronecker delta function, and {\u03c4j} denotes the k occurrences of the variable X taking on the value x. A co-occurrence matrix is constructed from the frequency of joint occurrences of {m,p} to calculate Inaive(P,M), as provided in the equation above for IML.",
        "Alternative implementations for information include the best upper bounds (BUB) estimate (developed by Liam Paninski) for both total and conditional entropies, and the Strong estimate. The BUB estimate (\u0124BUB) is provided by the following equation.",
        "H\n        ^\n      \n      BUB\n    \n    =\n    \n      \n        \u2211\n        \n          j\n          =\n          0\n        \n        N\n      \n      \u2062\n      \n        \n      \n      \u2062\n      \n        \n          a\n          \n            j\n            ,\n            N\n          \n        \n        \u2062\n        \n          h\n          j\n        \n      \n    \n  \n\n\n\n\n  \n    \n      h\n      j\n    \n    =\n    \n      \n        \u2211\n        \n          i\n          =\n          1\n        \n        q\n      \n      \u2062\n      \n        (\n        \n          \n            N\n            \u2062\n            \n              \n            \n            \u2062\n            \n              p\n              \n                N\n                ,\n                i\n              \n            \n          \n          ==\n          j\n        \n        )\n      \n    \n  \n\n\n\nIn the above equation, == denotes a logical test of equality and aj,N can be selected to minimize",
        "sup\n      x\n    \n    \u2061\n    \n      (\n      \n        q\n        |\n        \n          \n            H\n            \u2061\n            \n              (\n              x\n              )\n            \n          \n          -\n          \n            \n              \u2211\n              j\n            \n            \u2062\n            \n              \n                a\n                \n                  j\n                  ,\n                  N\n                \n              \n              \u2062\n              \n                \n                  B\n                  \n                    j\n                    ,\n                    N\n                  \n                \n                \u2061\n                \n                  (\n                  x\n                  )\n                \n              \n            \n          \n        \n        |\n      \n      )\n    \n  \n  .",
        "In the Strong method, many trials of the same time-varying motor task can be performed. The spike trains can be time-aligned and segmented into words of varying length Tword ranging from 5 milliseconds to 75 milliseconds. The maximum likelihood entropy rates are computed at the varying word lengths for all the data, and for data at each time bin across trials. Both the total entropy rate and the noise, or conditional, entropy rate can be extrapolated using a least squares regression fit to find H0 H(Tword\u2192\u221e) and Hn0= Hn(Tword\u2192\u221e). The difference in these extrapolated points gives the Strong information rate estimate.",
        "Referring again to FIG. 4, the calculated mutual information for the total population Imax can be stored in memory 316 (step 410). Alternative to the concurrent implementation of steps 404 and 406 with steps 408 and 410, the steps can be carried out at different times. The total population Imax and the rank order of each neural unit can be calculated and stored in memory before the PEA search process begins. The sequence of steps 404/406 and 408/410 can vary based on the particular implementation.",
        "Referring to step 412, host computer 314 implements a process by which the primary encoding subassembly (PEA) is identified. In other words, the PEA is the set of neural channels which most efficiently encodes most of the channel population information. In one embodiment, the PEA process identifies the smallest group of neural channels that encodes 90% of the total channel population information. Alternatively, the PEA process can identify the smallest group of neural channels that encodes 80%-98% of the total channel population information or another suitable percentage.",
        "Next, the identified channel IDs from step 412 can be transmitted via host computer 314 to CPLD 312 (step 414). CPLD 312 can then enable the identified neural channels via control lines 318 and 320 to circuitry 304 and A/D converter 306, respectively. By only enabling the identified neural channels, the transmission of neural signal data between telemetry link 310 and host computer 314 is reduced, and the processing load for FIFO 308 and host computer 314 is reduced.",
        "Host computer 214 can perform PEA identification steps 402-412 a predetermined number of times. According to one embodiment, step 416 includes determining whether the PEA identification steps have been performed twenty (20) times. The first session of steps 402-412 performed by host computer 314 is referred to as a training session.",
        "Next, the PEA identified from the training session can be analyzed for stability (step 418) and determine whether the selected neural channels are stable (step 420). If the selected neural channels are determined to be stable, system 300 can enter a pre-set channel selection mode (step 422).",
        "As noted above, step 420 includes determining whether the selected neural channels are stable. The consistency with which a neural channel is extracted into the PEA is quantified by calculating the frequency with which that neural channel is included in the PEA and comparing it to the expected frequency of a neural channel being included by chance. The proportion of the total number of time segments for which the PEA is defined can be considered equal to the proportion of the total population size that is included in the PEA. The chance frequency is defined as",
        "f\n        _\n      \n      \n        j\n        ,\n        0\n      \n    \n    =\n    \n      \n        \n          \n            n\n            PEA\n          \n          _\n        \n        n\n      \n      \u2062\n      T\n    \n  \n  ,\n\n\n\n\nwhere T is the number of time segments used, nPEA is the number of channels in the PEA, and n is the total number of channels. The \u03c72 statistic, adjusted by the Yates correction for continuity, can be calculated according to the equation below for those channels whose frequency fj exceeded f0 to test significance of fj as an indicator of the stability of inclusion in the PEA.",
        "\u03c7\n    \u2061\n    \n      (\n      \n        f\n        j\n      \n      )\n    \n  \n  =\n  \n    \n      \n        \n          \n            \n              f\n              j\n            \n            -\n            \n              \n                f\n                _\n              \n              \n                j\n                ,\n                0\n              \n            \n            -\n            0.5\n          \n          )\n        \n        2\n      \n      \n        \n          f\n          _\n        \n        \n          j\n          ,\n          0\n        \n      \n    \n    +\n    \n      \n        \n          (\n          \n            \n              \n                f\n                _\n              \n              \n                j\n                ,\n                0\n              \n            \n            =\n            \n              \n                f\n                j\n              \n              -\n              0.5\n            \n          \n          )\n        \n        2\n      \n      \n        (\n        \n          T\n          -\n          \n            \n              f\n              _\n            \n            \n              j\n              ,\n              0\n            \n          \n        \n        )",
        "The probability with which a channel is considered a unit in the PEA is provided by the proportion of time segments used in which channels with statistically significant frequencies of inclusion are included in the PEA, and is provided by the following equation:\n\n\u03ba=<fj*>j*/T \n\nIn the above equation, j* is the identifier of channels whose frequency of inclusion is significantly greater than f0. In the pre-set channel mode, the neural channels with a stability measure above a number \u03ba are found, and once identified, the neural channels remain stored as the selected PEA neural channels for enablement by CPLD 312. According to one embodiment, the predetermined number \u03ba is 0.5 but can alternatively be another suitable value. Otherwise, if the selected neural channels are determined to be unstable, system 300 can enter a continuous update mode (step 424).\n\nIII. C. Channel Selection Modes",
        "As noted above, the channel selection can operate in two modes: (1) continuous update mode; and (2) pre-set channel selection mode. During the first twenty minutes, the device operates in continuous update mode and the appropriate neural channels are enabled according to the PEA identification output, which is continually being recalculated. Meanwhile, the mode for the remainder of the operating session is determined based on stability of the PEAs determined during that training period. The end of an operating session can be the time when the device is turned off or reset.",
        "In the continuous update mode, a process is run for monitoring the channels to determine whether any of the currently enabled channels should be disabled or currently disabled should be enabled. FIG. 5 is a flow chart illustrating an exemplary process for operation in a continuous update mode. For example, the flow chart shows steps that can be implemented when system 300 (FIG. 3) enters the continuous update mode (step 424 shown in FIG. 4). Referring to FIG. 5, the process can start at step 500. Next, the process implements steps 502-514 which are similar to steps 402-414 of FIG. 4. Step 502 can collect neural signals on channels and output data from actuator 318 (FIG. 3). The data can be collected for two (2) minutes or another suitable time period. Neural signal collection can include detecting the neural signals with microelectrodes 302 (FIG. 3) and conditioning and digitizing the neural signals with circuitry 304, A/D converter 306, and FIFO 308. In addition, the digitized neural signals can be transmitted to host computer 314 via telemetry link 310 and stored in memory 316. According to one embodiment, the continuous update mode returns to step 502 periodically (e.g., once every 10 minutes).",
        "As data is collected in step 502, host computer 314 can calculate the criterion variable value (CVV) for predetermined time segments of the neural signal on each neural channel (step 504). In addition, the neural channels can be ranked by value and stored in memory 316 (step 506).",
        "Concurrently, with steps 504 and 506, host computer 314 can calculate the mutual information between the actuator output (designated herein as M) and the total neural channel population activity (step 508). The calculated mutual information (designated herein as Imax) can be stored in memory 316 (step 510). Alternative to the concurrent implementation of steps 504 and 506 with steps 508 and 510, the steps can be carried out at different times. Referring to step 512, host computer 314 implements a process by which the primary encoding subassembly (PEA) is identified.",
        "Next, the identified channel IDs from step 512 can be transmitted via host computer 314 to CPLD 312 (step 514). CPLD 312 can then enable the identified neural channels via control lines 318 and 320 to circuitry 304 and A/D converter 306, respectively. By only enabling the identified neural channels, the transmission of neural signal data between telemetry link 310 and host computer 314 is reduced, and the processing load for FIFO 308 and host computer 314 is reduced.",
        "III. D. Determining PEA",
        "FIG. 6 is a flow chart illustrating an exemplary process for determining the PEA via a Newton method. This exemplary process can be used by host computer 314 (FIG. 3) in the PEA search process of steps 412 and 512 of FIGS. 4 and 5, respectively, for determining PEA. The process can identify the smallest group of neurons that encodes a predetermined threshold (e.g., 90%). Generally, the neural channels are ordered in descending order by CVV, and the rank ordering is stored in memory. The number of neural channels (n) to be included in the PEA can be determined by searching iteratively along the information versus sub-population size I(Pselj, M) curve.",
        "Referring to FIG. 6, the process can start at step 600. At step 602, initial values for the process are set before implementing an iterative search along the information versus sub-population size (I(Pselj, M) curve. In one embodiment, the first estimate of required number of channels to reach the predetermined mutual information threshold no is initialized to 0, the second estimate of n, n1, is initialized to 1, and mutual information lo is set to 0. At each iteration of the process, nj can be updated, while information is calculated for those nj neural channels.",
        "At step 604, mutual information Ij can be determined for the current iteration j. At step 606, as noted above memory 316 (FIG. 3) can store neural channels that are rank ordered by CVV. This ordering by CVV can occur, for example, in steps 404 and 504 of FIGS. 4 and 5, respectively. Next, at step 606, the mutual information Ij current iteration is stored for comparison to the mutual information Ij+1 determined in the next iteration.",
        "At step 608, the process determines whether the new estimate of mutual information meets a predetermined mutual information threshold. According to one embodiment, this can be determined based on the following equation, wherein Imax is maximum mutual information for the total channel population:\n\n0.90<Ij/Imax \n\nIf the above equation is true, the process proceeds to step 610. At step 610, the identified PEA channels are the first nj channels by rank order of CVV. Otherwise, the process proceeds to step 612 for another iteration.",
        "Next, the number of channels added on the jth iteration can be determined in steps 612 and 614. At step 612, the next estimate nj+1 can be identified by determining the point of intersection between a line connecting two currently known points (i.e., Ij\u22121 and Ij) and threshold. The two points known on the curve are one of the points from the previous iteration (mutual information Ij\u22121 from step 606) and the newly computed mutual information at the new estimate (Ij) According to one embodiment, the next estimate can be determined with the following equations (where j=1, 2, . . . Psel, j is the subassembly of units selected by the criterion on the jth iteration, no=0, n1=1, and I(Psel, 0, M)=0):",
        "\u0394\n    j\n  \n  =\n  \n    \n      \n        I\n        \u2061\n        \n          (\n          \n            \n              P\n              \n                sel\n                ,\n                j\n              \n            \n            ,\n            M\n          \n          )\n        \n      \n      -\n      \n        I\n        \u2061\n        \n          (\n          \n            \n              P\n              \n                sel\n                ,\n                \n                  j\n                  -\n                  1\n                \n              \n            \n            ,\n            M\n          \n          )\n        \n      \n    \n    \n      \n        n\n        j\n      \n      -\n      \n        n\n        \n          j\n          -\n          1\n        \n      \n    \n  \n\n\n\n\nNext, at step 614, the next estimate nj+1 can be updated with the following equation:",
        "n\n    \n      j\n      +\n      1\n    \n  \n  =\n  \n    \n      n\n      j\n    \n    +\n    \n      \n        \n          0.90\n          \u2062\n          \n            I\n            max\n          \n        \n        -\n        \n          I\n          \u2061\n          \n            (\n            \n              \n                P\n                \n                  sel\n                  ,\n                  j\n                \n              \n              ,\n              M\n            \n            )\n          \n        \n      \n      \n        \u0394\n        j\n      \n    \n  \n\n\n\n\nThe process can continue to step 604 for another iteration.",
        "The selection methods, systems, and computer program products described herein can be useful for improving the efficiency of neural data systems. In addition, the subject matter described herein can provide an improved method for studying the importance of individual neural channels in neural population encoding. The results of these studies can direct electrode implantation procedures to target areas found to contain most frequently extracted into the PEA.",
        "It will be understood that various details of the subject matter disclosed herein may be changed without departing from the scope of the subject. Furthermore, the foregoing description is for the purpose of illustration only, and not for the purpose of limitation."
    ],
    "citations": [
        "4610259",
        "7120486"
    ],
    "us_classification": "600545",
    "international_classifications": [
        {
            "classification_level": "A",
            "section": "A",
            "classification_class": "61",
            "subclass": "F",
            "main_group": "2",
            "subgroup": "70"
        }
    ]
}